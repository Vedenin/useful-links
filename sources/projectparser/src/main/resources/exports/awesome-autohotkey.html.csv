"category"	"name"	"url"	"description"	"star"	"stackOverflow"	"stackOverflowUrl"	"license"	"licenseUrl"	"site"	"userGuide"	"newStars"	"newWatchs"	"newForks"	"pageText"	"newStackOverflow"	"github"	"allText"	"isExist"
"Awesome AutoHotkey"	"AutoHotkey"	"https://autohotkey.com/"	""	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"103"	"17"	"26"	"GitHub - fincs/Ahk2Exe: Official AutoHotkey script compiler - written itself in AutoHotkey Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 17 Star 103 Fork 26 fincs/Ahk2Exe Code Issues 0 Pull requests 1 Pulse Graphs Official AutoHotkey script compiler - written itself in AutoHotkey http://ahkscript.org/ 97 commits 2 branches 2 releases 4 contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags edge master Nothing to show r3 r2 Nothing to show New pull request Latest commit 2648891 Jan 20, 2016 fincs Regression: UTF-8 *must* always be used to encode the compiled script Permalink Failed to load latest commit information. Lib AutoHotkey v1.1 is now the Official version, see details Oct 26, 2012 .gitignore Fix typo in %A_LineFile% support Jun 28, 2013 Ahk2Exe.ahk /cp : default is A_FileEncoding \nSee #41 (comment) Dec 6, 2015 COPYING Add license Aug 12, 2012 Compiler.ahk Regression: UTF-8 *must* always be used to encode the compiled script Jan 20, 2016 ErrorCodes.md add error detection for CP, plus bugfix Dec 3, 2015 IconChanger.ahk Do not use outdated built-in object method syntax Dec 6, 2012 README.md change 'autohotkey.com' to 'ahkscript.org' Aug 2, 2014 ScriptParser.ahk Fix #35 - ""escape-comma"" support in FileInstall Oct 21, 2015 logo.png AutoHotkey v1.1 is now the Official version, see details Oct 26, 2012 README.md Ahk2Exe Ahk2Exe is the official AutoHotkey script to EXE converter, which is written itself in AutoHotkey. http://www.ahkscript.org/ How to Compile Ahk2Exe can compile itself, just be sure to use a recent AutoHotkey self-contained binary. To do Handle FileInstall on same-line If* commands. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/fincs/Ahk2Exe"	""	"true"
"Clipboard"	"WinClip"	"http://www.apathysoftworks.com/ahk/WinClip.zip"	"by Deo - WinClip is a clipboard manipulation class extending AutoHotkey's clipboard capabilities including support for RTF, HTML and images. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"by Deo - WinClip is a clipboard manipulation class extending AutoHotkey's clipboard capabilities including support for RTF, HTML and images. Forum thread:."	"false"
"Clipboard"	"link"	"https://autohotkey.com/board/topic/74670-class-winclip-direct-clipboard-manipulations/"	"by Deo - WinClip is a clipboard manipulation class extending AutoHotkey's clipboard capabilities including support for RTF, HTML and images. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[Class] WinClip - direct clipboard manipulations - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. [Class] WinClip - direct clipboard manipulations Started by Deo , Dec 15 2011 11:31 AM Page 1 of 7 1 2 3 Next » Please log in to reply 94 replies to this topic Deo Members 199 posts Last active: Jan 31 2014 03:19 PM Joined: 16 May 2010 Hello WinClip is a clipboard manipulation class which allow you to do a bit more than the common ahk clipboard can intended for: [*:3kwk6bth] AHK_L unicode x32/x64 Download Documentation include WinClipAPI.ahk before WinClip.ahk! Features: [*:3kwk6bth] Change clipboard directly or operate on in-memory copy of it [*:3kwk6bth] Ready-to-use methods to keep and maintain any number of clipboards at once [*:3kwk6bth] Big number of functions to get different types of data from clipboard [*:3kwk6bth] Possibility to get/change text on clipboard without touching other formats [*:3kwk6bth] Easy way to get picture from clipboard and use it on your needs [*:3kwk6bth] And other cookies... Tips: [*:3kwk6bth]You can use Markdown2HTML.ahk from fincs' GenDocs v3 viewtopic.php?p=555703#p555703 script to transform Markdown text to html format + WinClip.SetHTML(html) to be able to paste it directly in say your Office documents or an rich text email. Full list of methods: Snap( ByRefdata ) Restore( ByRefdata ) Clear() GetFormats() Save( filePath ) Load( filePath ) Copy() Paste( plainText = """" ) GetFiles() SetFiles( files, isCut = 0 ) AppendFiles( files, isCut = 0 ) GetBitmap() SetBitmap( bitmap ) SaveBitmap( filePath, format ) GetText() SetText( textData ) AppendText( textData ) GetHTML() SetHTML( html, source = """" ) IsEmpty() HasFormat( fmt ) Here is a small example of how to use it in the similar way you do with common ahk's ""clipboardall"" and ""clipboard"": Getting data from clipboard: clipData := clipboardall clipSize := WinClip.Snap( clipData ) Restoring it up:  clipboard := clipData bytesRestored := WinClip.Restore( clipData ) Getting plain text from clipboard: plainText = %clipboard% plainText := WinClip.GetPlainText() filesList := WinClip.GetFilesList() Well, if you don't need anything besides that, it's best to keep up with standard clipboard. Here is what it can do above basic stuff: Get html format: rawHTML := WinClip.GetHTML() Get all formats currently on clipboard: objFormats := WinClip.GetFormats() list = for nFmt, params in objFormats { ; format_number : format_name : data_size : data_size again ; the ""buffer"" is an object member containing actual format data   list .= ""`n"" nFmt "" : "" params.name "" : "" params.size "" : "" params.GetCapacity( ""buffer "" ) } msgbox % list GetBitmap and use it as picture in GUI: ;copy any picture first hBitmap := WinClip.GetBitmap() Gui, Add, Picture,% ""hwndPicHwnd +"" SS_BITMAP := 0xE SendMessage,% STM_SETIMAGE := 0x0172,% IMAGE_BITMAP := 0,% hBitmap,, ahk_id %PicHwnd% DllCall(""DeleteObject"", ""Ptr"", hBitmap ) Gui, Show, w1000 h700 Set or append text without changing whole clipboard into plain text: WinClip.SetText( ""hey, you!"" ) WinClip.AppendText( ""`nand you!"" ) + Copy, Paste, Clear methods. !!! Make attention, that data from clipboardall, and WinClip.Snap() is not compatible Another part of the WinClip class is the all the same function with ""i"" prefix which work with instantiated copy of WinClip class. It allows you to manipulate with in-memory copy of clipboard without changing the main one. Or you can just keep any number of different clipboards. Prefect for clipboards managers kind. Here is an example: wc := new WinClip clipSize := wc.iSnap() ;copies clip data into inner buffer for later using wc.Clear() ;clears Windows clipboard bytesRestored := wc.iRestore() ;restores data back to clipboards All this described better in documentation test.ahk inside downloadable .zip also offer some easy tutorial survey Update 20/03/2012 Fixed SetHTML() function to use UTF-8 Update 7/02/2012 Added following methods to retrieve or set RTF format: GetRTF(),iGetRTF SetRTF( text ),iSetRTF( text ) Update 31/01/2012 Class name shortened to WinClip all functions used by WinClip moved to another class, so you don't need to care about any similar you may have in your script (you must inlcude WinClipAPI.ahk first though ) Methods added ( check documentation for info ): SetHTML,iSetHTML iSetData IsEmpty,iIsEmpty HasFormat,iHasFormat SaveBitmap,iSaveBitmap Update 12/20/2011 Renamed methods: GetPlainText() -> GetText() iGetPlainText() -> iGetText() GetFilesList() -> GetFiles() iGetFilesList() -> iGetFiles() Added methods: SetFiles( files, isCut = 0 ) iSetFiles( .. ) AppendFiles( .. ) iAppendFiles( .. ) SetBitmap( bitmapPath or hBitmap ) iSetBitmap( .. ) iGetData( Data ) WinClipboard.Paste( plainText = """" ) method now can be called with parameter to paste raw text without changing actual clipboard data (iPaste does not support this) Improved Copy/Paste methods so they work more reliable/faster now Functiona added to WinClipboard_foos.ahk: RemoveDubls RegisterClipboardFormat GetOpenClipboardWindow StrSplit Attached Files  WinClip.zip   10.88KB   531 downloads #1 - Posted 15 December 2011 - 11:31 AM Crypt|QMsgBox|PUM|Quick Cliq|WinClipboard Back to top capitalH Members 64 posts Last active: Apr 05 2012 05:18 AM Joined: 23 Apr 2010 Some recommendations 1) WinClipboard_foos.ahk and PUM_foos.ahk share: ErrorFormat IsInteger LoadDllFunction Gdip_Shutdown Gdip_Startup Since I am now using PUM and WinClipBoard in a single project - this cause duplicate functions. I moved these to Deo_foos.ahk - but if I were to update it would be there again. Can you consider doing something similar please? 2) I am not an OOP expert - but I would expect that WinClipboard.SetText(""hello"") WinClipboard.Paste() and  WinClipboard.SetText(""hello"").Paste() should both work (second version does not work) (3) Currently pasting plaintext saved internal buffer seems to be done via  oldClipboard:= new WinClipboard oldClipboard.iSnap()  ;Stuff happens here  TempClipBoard := new WinClipboard TempClipBoard.iSnap()  WinClipboard.clear() WinClipboard.SetText(oldClipboard.iGetPlainText()) WinClipboard.Paste() TempClipBoard.iRestore()  Consider:  oldClipboard:= new WinClipboard oldClipboard.iSnap()  ;Stuff happens here oldClipboard.Paste(""PlainText"")  Unless I am missing something (open for suggestions) 4) Not a recommendation, but I love it that it does not trigger OnClipBoardChange! Edit: added (2) , (3) and (4) [/code] #2 - Posted 15 December 2011 - 01:21 PM Back to top fragman Members 1591 posts Last active: Nov 12 2012 08:51 PM Joined: 13 Oct 2009 You can probably use the gdip library as a prerequisite for your functions and call those directly, unless you use other gdi+ functions that are not covered. This is a nice library, may I suggest expanding it to support copied files from explorer like regular text? That is, being able to write or append copied files. You can take a look at 7plus source (<!-- m -->http://code.google.com/p/7plus/<!-- m -->, clipboard.ahk) for some pointers on how to do this. #3 - Posted 15 December 2011 - 02:41 PM Back to top Guests Last active: Joined: -- I'll try this later, looks interesting. Two links for reference Need to save clipboard with formatting to rtf file <!-- m -->http://www.autohotke...topic65944.html<!-- m --> (see script by SKAN) SetClipboardData and GetClipboardData functions by PhiLho <!-- m -->http://www.autohotke.../topic8402.html<!-- m --> (see various formats) #4 - Posted 15 December 2011 - 05:11 PM Back to top Deo Members 199 posts Last active: Jan 31 2014 03:19 PM Joined: 16 May 2010 thank you for interest to this proj, guys Since I am now using PUM and WinClipBoard in a single project - this cause duplicate functions. I moved these to Deo_foos.ahk - but if I were to update it would be there again. Can you consider doing something similar please?i think it is best for you to spend 10 mins and compile all the functions you need together as you did. Because someone may not need all the bunch in one place. For example, PUM has far more functions than WinClip, and only few of them are similar. If any func will be added, you will know about this at startup from ahk, if anything will be changed, i'll write about this in change log. WinClipboard.SetText(""hello"").Paste()good example of functional programming would be, but you'll not be able determine then if SetText() was successful or not. btw, to shorten the code, you can do the following: ;define WinClipboard instance as super-global var global wc := new WinClipboard ;you can then use static function as well as instance ;wc can be accessible from any function as well wc.SetText( ""some text"" ) wc.Paste()  oldClipboard:= new WinClipboard oldClipboard.iSnap()  ;Stuff happens here  TempClipBoard := new WinClipboard TempClipBoard.iSnap()  WinClipboard.clear() WinClipboard.SetText(oldClipboard.iGetPlainText()) WinClipboard.Paste() TempClipBoard.iRestore() oldClipboard:= new WinClipboard oldClipboard.iSnap()  ;Stuff happens here oldClipboard.Paste(""PlainText"") you mean paste some text without changing the original clipboard? Good idea, i'll make it You can probably use the gdip library as a prerequisite for your functions and call those directly, unless you use other gdi+ functions that are not covered.i actually use Gdip_Startup & Shutdown only as functions and few others directly through DllCall, so don't think ppl really needs whole library for this This is a nice library, may I suggest expanding it to support copied files from explorer like regular text? That is, being able to write or append copied files.good idea, will make this I love it that it does not trigger OnClipBoardChange!i didn't know it doesn't #5 - Posted 16 December 2011 - 10:14 AM Crypt|QMsgBox|PUM|Quick Cliq|WinClipboard Back to top ParticleMan Members 32 posts Last active: Jan 22 2013 03:40 AM Joined: 04 Dec 2011 Does this paste function buffer when the keyboard caret is not ready? I use multiple clipboards in basically the following ways, for instance: * PasteClip(1) * SendInput Clip%1% In my simplistic implementation, the issue of requiring a fixed Sleep duration after SendInput and before restoring the previously backed up Clipboard is my biggest battle. Problems: 1. Copying: ClipWait is useless when the string is null (ClipWait ,,1 would be ideal). 2. ClipboardAll does not work as expected in at least one case. Text with formatting will paste into Word but not in a Firefox textbox, while it will paste in Firefox when using "":= Clipboard"" (not "":= %Clipboard%""). 3. Increasing Sleep to thousands of ms is not a solution (unless of course it were possible to make the Sleep and Clipboard restore threaded to the background after SendInput completes, or check an ErrorLevel of SendInput, or something). Would it work to use a DllCall to the Win32 API to paste instead of using SendInput? Or would this be too complex? My original thread on this issue is here: <!-- m -->http://www.autohotke...ic.php?p=497325<!-- m --> #6 - Posted 16 December 2011 - 01:04 PM Back to top Deo Members 199 posts Last active: Jan 31 2014 03:19 PM Joined: 16 May 2010 ParticleMan by digging a bit i think i found a solution: WaitClipReady( timeout = 10000 )   {     start_time := A_TickCount     while ( GetOpenClipboardWindow() && ( A_TickCount - start_time < timeout ) )       sleep 100   }  GetOpenClipboardWindow() {   return DllCall( ""GetOpenClipboardWindow"" ) } just call WaitClipReady after each paste/copy operation to make sure application where you paste data finished processing it: SendInput, ^{vk56sc02F} ;ctrl+v WaitClipReady()i've done a bit testing on it, - if you trying to paste a big piece of text into MS Word 2010 - it works instantly, but if in notepad - it cause run of few loops waiting. Let me know if you'll notice any problems using this method also, i get rid of using ""clipwait"" in this module ( starting from next update ) and replaced it with following set of functions: SendInput, ^{vk43sc02E} ;ctrl+c WaitClipReady() if !isClipEmpty() { ;do some stuff }  isClipEmpty()   {     return !CountClipboardFormats()   }  CountClipboardFormats() {   return DllCall( ""CountClipboardFormats"" ) }should work much faster if you got nothing after copying #7 - Posted 16 December 2011 - 06:35 PM Crypt|QMsgBox|PUM|Quick Cliq|WinClipboard Back to top ParticleMan Members 32 posts Last active: Jan 22 2013 03:40 AM Joined: 04 Dec 2011 by digging a bit i think i found a solution Wow, thanks for looking into this, and so fast! However, it doesn't seem to work at all for me in any app. Even after the caret has been delayed: * GetOpenClipboardWindow() is always 0 * A_TickCount, start_time are always equal Thus it never gets a chance to sleep. SendInput, ^{vk56sc02F} ;ctrl+v What is the benefit of using this method over a regular ^v? should work much faster if you got nothing after copying Excellent, although I have been making sure the variable isn't null at the outset. #8 - Posted 17 December 2011 - 12:00 AM Back to top Deo Members 199 posts Last active: Jan 31 2014 03:19 PM Joined: 16 May 2010 it doesn't seem to work at all for me in any app. Even after the caret has been delayed: * GetOpenClipboardWindow() is always 0 * A_TickCount, start_time are always equalit solves the problem when after pasting you got old clipboard pasted instead of required one because of lagging (this was mentioned in your topic) What is the benefit of using this method over a regular ^v?it multilingual Excellent, although I have been making sure the variable isn't null at the outset.sry, i don't understand #9 - Posted 17 December 2011 - 02:43 AM Crypt|QMsgBox|PUM|Quick Cliq|WinClipboard Back to top nimda Members 4368 posts Last active: Aug 09 2015 02:36 AM Joined: 26 Dec 2010 The solution to the dupe functions is to internalize them,e.g., WinClip._IsInteger() And a request: WinClip.SetBitmap() -- would call DllCall(""SetClipboardData"", UInt, 8 ...) and accept either a filename or hBitmap. #10 - Posted 17 December 2011 - 04:19 AM Autofire, AutoClick, Toggle, Spam • Window Control Tools Back to top Guests Last active: Joined: -- it doesn't seem to work at all for me in any app. Even after the caret has been delayed: * GetOpenClipboardWindow() is always 0 * A_TickCount, start_time are always equal it solves the problem when after pasting you got old clipboard pasted instead of required one because of lagging (this was mentioned in your topic) I understand that that is what your WaitClipReady() is supposed to do--which is exactly what I am looking for (and AHK needs to have natively!)--but ""my mileage is varying."" By using WaitClipReady() instead of a fixed Sleep, it never sleeps because of what I reported above (having attempted to debug it). You get different results, apparently? Could there be a problem on my end? Excellent, although I have been making sure the variable isn't null at the outset.sry, i don't understand See below. PasteClip(num, fmt) {     Global      If (Clip%num% != """") {         ; proceed with processing     } }According to my function above, included in its entirety in my original thread, there is no need to check for an empty variable after SendInput ^v, such as with your isClipEmpty(), because there is no reason to process null data. But the larger issue is WaitClipReady() not working for me as you say it does for you. #11 - Posted 18 December 2011 - 06:09 AM Back to top Deo Members 199 posts Last active: Jan 31 2014 03:19 PM Joined: 16 May 2010 I understand that that is what your WaitClipReady() is supposed to do--which is exactly what I am looking for (and AHK needs to have natively!)--but ""my mileage is varying."" By using WaitClipReady() instead of a fixed Sleep, it never sleeps because of what I reported above (having attempted to debug it). You get different results, apparently? Could there be a problem on my end?yep, it works for me. Sleep either may or may not be called depending on the speed at which application operates data. As i said, try to paste big piece of text into common Windows notepad and use following function to check what happening. _waitClipReady( timeout = 10000 )   {     start_time := A_TickCount     while ( GetOpenClipboardWindow() && ( A_TickCount - start_time < timeout ) )     {       tooltip % ""wait""       sleep 100     }   } #12 - Posted 18 December 2011 - 11:04 AM Crypt|QMsgBox|PUM|Quick Cliq|WinClipboard Back to top Deo Members 199 posts Last active: Jan 31 2014 03:19 PM Joined: 16 May 2010 this module has been updated check the first post for info & docs #13 - Posted 19 December 2011 - 09:44 PM Crypt|QMsgBox|PUM|Quick Cliq|WinClipboard Back to top ParticleMan Members 32 posts Last active: Jan 22 2013 03:40 AM Joined: 04 Dec 2011 yep, it works for me. Sleep either may or may not be called depending on the speed at which application operates data. As i said, try to paste big piece of text into common Windows notepad and use following function to check what happening.On rare occasion GetOpenClipboardWindow() will be > 0, and on even more rare occasion will it show it's working by displaying the ""wait"" message. But because WaitClipReady() doesn't execute with every paste, the approach doesn't quite work because I still need a Sleep before restoring the original clipboard. How else might it be possible to detect whether the window or control is ready to paste into but without getting excessively complex with exceptions? #14 - Posted 20 December 2011 - 01:55 AM Back to top Deo Members 199 posts Last active: Jan 31 2014 03:19 PM Joined: 16 May 2010 On rare occasion GetOpenClipboardWindow() will be > 0, and on even more rare occasion will it show it's working by displaying the ""wait"" messagewell, if GetOpenClipboardWindow() returned anything != 0, the tooltip will be shown 100%, it can't be any rarely How else might it be possible to detect whether the window or control is ready to paste into but without getting excessively complex with exceptions?i have no ideas right now it would be nice if you can describe any way to reproduce your problem on practice with code example #15 - Posted 20 December 2011 - 10:00 AM Crypt|QMsgBox|PUM|Quick Cliq|WinClipboard Back to top Page 1 of 7 1 2 3 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"by Deo - WinClip is a clipboard manipulation class extending AutoHotkey's clipboard capabilities including support for RTF, HTML and images. Forum thread:."	"true"
"Console"	"AHKonsole"	"https://github.com/G33kDude/Console"	"by G33kdude - Class based AutoHotkey library for console support. This library enables you to create an object representing a console to interact with, as well as multiple console buffer objects to facilitate in double buffering. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"8"	"3"	"2"	"GitHub - G33kDude/Console: AutoHotkey Win32 console wrapper Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 3 Star 8 Fork 2 G33kDude/Console Code Issues 0 Pull requests 0 Pulse Graphs AutoHotkey Win32 console wrapper 36 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit 176c90e Mar 19, 2015 G33kDude Working on snake clone Permalink Failed to load latest commit information. lib Moved Commands.ahk to the lib folder Nov 16, 2014 .gitignore Ignoring files I didn't mean to push Nov 16, 2014 Cookie.ahk Another attempt at adding images to the README Nov 16, 2014 Embed.ahk Added new sample script, Embed.ahk Nov 3, 2014 IRC.ahk Populating repository Oct 23, 2014 LICENSE Initial commit Oct 23, 2014 README.md Actual attempt to fix images Nov 16, 2014 Snake.ahk Working on snake clone Mar 19, 2015 Syntax.ahk Moved Commands.ahk to the lib folder Nov 16, 2014 Tetris.ahk Made hyper-speed stop when you get a new piece. Nov 16, 2014 README.md Console AutoHotkey Win32 console wrapper Syntax highlighter: IRC client: Tetris clone: Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/G33kDude/Console"	"by G33kdude - Class based AutoHotkey library for console support. This library enables you to create an object representing a console to interact with, as well as multiple console buffer objects to facilitate in double buffering. Forum thread:."	"true"
"Console"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=4955"	"by G33kdude - Class based AutoHotkey library for console support. This library enables you to create an object representing a console to interact with, as well as multiple console buffer objects to facilitate in double buffering. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"AHKonsole - Class Based Console Library - Tetris! - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:26 All times are UTC-05:00 AHKonsole - Class Based Console Library - Tetris! Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 12 posts • Page 1 of 1 GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 AHKonsole - Class Based Console Library - Tetris! Report this post Quote 23 Oct 2014, 21:21 I present https://github.com/G33kDude/Console It's a wrapper for the win32 console. Currently pretty small, but still very flexible. Examples: A syntax highlighter proof of concept: A (working) IRC client: Spoiler Tetris clone!: Spoiler Last edited by GeekDude on 17 Nov 2014, 09:53, edited 3 times in total. AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: Win32 Console Wrapper Library Report this post Quote 23 Oct 2014, 21:30 Very nice! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Win32 Console Wrapper Library Report this post Quote 30 Oct 2014, 14:36 Hey @Lexikos, Would it be possible to add a #directive that would make AHK not detach from the command line? So that something like this won't look so odd, and that the attachconsole call won't be necessary Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus DllCall(""AttachConsole"", ""UInt"", -1) FileOpen(""CONOUT$"", ""w"").Write(""Test"") MsgBox AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: Win32 Console Wrapper Library Report this post Quote 30 Oct 2014, 15:20 Well i'm not lexikos but, i can tell you that ahk is compiled as a GUI application.. What you probably want is the Console Subsystem. In the preview2 of ahk2exe there is a compile directive that can set the subsystem to console. I made a little ahk2exe wrapper that compiles ahk scripts to exe with the console subsystem.... I could probably make it a lot better.. But What you really want to look at here is this script by Lexikos that changes it for you: https://github.com/joedf/LibCon.ahk/blo ... hk2CLI.ahk Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Win32 Console Wrapper Library Report this post Quote 31 Oct 2014, 10:42 That script turns a gui application into a console application? Neato! Any reason you're not in the IRC channel joedf? AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: Win32 Console Wrapper Library Report this post Quote 31 Oct 2014, 12:29 Sometimes I'm there but no so much recently.. I'll try to pop on more often then Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Win32 Console Wrapper Library Report this post Quote 01 Nov 2014, 18:22 I've gotten palette swapping to work! http://i.imgur.com/FH0DG5x.gif AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: Win32 Console Wrapper Library Report this post Quote 01 Nov 2014, 18:23 Bejeebus.... Dats Awesome. Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Win32 Console Wrapper Library Report this post Quote 03 Nov 2014, 20:44 I've updated the palette in Syntax.ahk slightly, and fixed a bug in the hex detection (it didn't used to detect hex numbers with 0s in them). Also, I added a new example script, Embed.ahk. It's a proof of concept for embedding a console as a control in your own gui. I wasn't sure how to fix a rendering issue until I saw @Ronin 's code that had a style which I did not (WS_CLIPCHILDREN). So, thanks Ronins! If you want, I can put you in the ReadMe AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Win32 Console Wrapper Library - Tetris! Report this post Quote 10 Nov 2014, 23:59 Added a new sample script, Tetris.ahk! I added some methods for creating and manipulating console buffers, thus allowing me to double buffer my output. This means I can output (in color) the Tetris game screen seamlessly. AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: Win32 Console Wrapper Library - Tetris! Report this post Quote 11 Nov 2014, 09:28 Shizzle! At this rate, I'll just deprecated Libcon.ahk Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: AHKonsole - Class Based Console Library - Tetris! Report this post Quote 24 Nov 2014, 20:26 I gotz an Idea, Now as a class it will be much easier! Console GUI! lol AHKonsole.GUI() Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 12 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: pondermatic and 14 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by G33kdude - Class based AutoHotkey library for console support. This library enables you to create an object representing a console to interact with, as well as multiple console buffer objects to facilitate in double buffering. Forum thread:."	"true"
"Console"	"LibCon"	"https://github.com/joedf/LibCon.ahk"	"by joedf - AutoHotkey Library For Console Support. This library enables you to write console applications and interact with other console instances. Basically, this library facilitates anything that has to do with writing and interacting with consoles. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"26"	"5"	"4"	"GitHub - joedf/LibCon.ahk: LibCon - AutoHotkey Library For Console Support Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 5 Star 26 Fork 4 joedf/LibCon.ahk Code Issues 2 Pull requests 0 Pulse Graphs LibCon - AutoHotkey Library For Console Support http://joedf.github.io/libcon/ 116 commits 1 branch 0 releases 1 contributor AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit aa2b399 Jul 4, 2016 joedf bugfix for example3 Permalink Failed to load latest commit information. LibCon_Class Update Readme.md Oct 31, 2014 LibCon_Compiler update AHK_CLI bin files to v1.1.22.09 Dec 7, 2015 .gitignore typo fix - ""!toggles"" Nov 2, 2013 Example.ahk Small changes: compiler + Examples Oct 18, 2013 Example2.ahk Small changes: compiler + Examples Oct 19, 2013 Example3.ahk bugfix for example3 Jul 4, 2016 Examples.md add ReadConsoleInput() + SetConsoleIcon() Mar 29, 2014 LibCon.ahk v1.0.6.2 : fix typo in LibConError function Dec 13, 2014 LibCon_docs.md LibCon Update to v1.0.6.1 Jul 25, 2014 License.md docs examples ,info, etc... Nov 15, 2013 Readme.md Update Readme.md Jul 20, 2014 preview.png optipng -o7 on preview.png Sep 30, 2013 preview2.png optipng -o7 preview2.png Nov 16, 2013 Readme.md LibCon AutoHotkey Library For Console Support The main goal of this library is to maintain simplicity, so that the common AutoHotkey user may use it and integrate it easily. ;) I know that this is probably considered far from complete, but just to get things started, here it is! See the Documentation here. See some Examples here. View the Discussion here. LibCon is proudly under the MIT License. Contact Me for Requests, Comments, Contributions, etc. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/joedf/LibCon.ahk"	"by joedf - AutoHotkey Library For Console Support. This library enables you to write console applications and interact with other console instances. Basically, this library facilitates anything that has to do with writing and interacting with consoles. Forum thread:."	"true"
"Console"	"link"	"https://autohotkey.com/boards/viewtopic.php?t=17"	"by joedf - AutoHotkey Library For Console Support. This library enables you to write console applications and interact with other console instances. Basically, this library facilitates anything that has to do with writing and interacting with consoles. Forum thread:."	"null"	"null"	"null"	"null"	"null"	""	"null"	"null"	"null"	"null"	"LibCon - AutoHotkey Library For Console Support - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:26 All times are UTC-05:00 LibCon - AutoHotkey Library For Console Support Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 13 posts • Page 1 of 1 joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter LibCon - AutoHotkey Library For Console Support Report this post Quote 30 Sep 2013, 07:51  LibCon - AutoHotkey Library For Console Support __________________________________________________________________________________________________ The main goal of this library is to maintain simplicity, so that the common AutoHotkey user may use it and integrate it easily.  I know that this is probably considered far from complete, but just to get things started, here it is! See the Documentation here. See some Examples here. LibCon is proudly under the MIT License. Contact Me for Requests, Comments, Contributions, etc. __________________________________________________________________________________________________ Get it from GitHub Here or Direct Download Last edited by joedf on 19 Nov 2013, 00:54, edited 3 times in total. Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Alibaba Posts: 427 Joined: 29 Sep 2013, 16:15 Location: Germany Re: LibCon - AutoHotkey Library For Console Support Report this post Quote 30 Sep 2013, 12:49 Wow, this looks awesome! I never saw it in the old forum... ""Nothing is quieter than a loaded gun."" - Heinrich Heine Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: LibCon - AutoHotkey Library For Console Support Report this post Quote 30 Sep 2013, 19:57 Oh! Really! Oh well there you go! Hope you enjoy it as much as I do Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Alibaba Posts: 427 Joined: 29 Sep 2013, 16:15 Location: Germany Re: LibCon - AutoHotkey Library For Console Support Report this post Quote 01 Oct 2013, 11:38 joedf wrote:Oh! Really! Oh well there you go! Hope you enjoy it as much as I do Currently i don't have any usage for it sadly. But few months ago i exactly looked for something like this. Well let's see. If i need it, i know where it is. ""Nothing is quieter than a loaded gun."" - Heinrich Heine Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: LibCon - AutoHotkey Library For Console Support Report this post Quote 01 Oct 2013, 17:20 im open to all suggestions ^__^ Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top BGM Posts: 315 Joined: 20 Nov 2013, 20:56 GitHub: bgmCoder Contact: Contact BGM ICQ Website Re: LibCon - AutoHotkey Library For Console Support Report this post Quote 05 Mar 2015, 21:12 JoeDF, I'm trying to figure this out. Say I want to send the ""dir"" command. So I use puts(""dir"") and it prints ""dir"" in the console, now My Stuff: mousey; volume; ahkinfo; instantbirder; npp highlighter; Dynamic File Menu; tv - a treeview library; Top BGM Posts: 315 Joined: 20 Nov 2013, 20:56 GitHub: bgmCoder Contact: Contact BGM ICQ Website Re: LibCon - AutoHotkey Library For Console Support Report this post Quote 05 Mar 2015, 21:25 Joe, I want to send text to the console and read back the results. So if I send ""ping outlook.com -n 1"" - I want to see that in the console and fetch back the output to display in my edit box. It seems that libCon does not contain a wrapper for WriteConsoleInput. https://msdn.microsoft.com/en-us/librar ... 03(v=vs.85).aspx My Stuff: mousey; volume; ahkinfo; instantbirder; npp highlighter; Dynamic File Menu; tv - a treeview library; Top Soft Posts: 147 Joined: 07 Jan 2015, 13:18 GitHub: visionary1 Location: Seoul Contact: Contact Soft Website Re: LibCon - AutoHotkey Library For Console Support Report this post Quote 06 Mar 2015, 01:00 niceeeeeee!! AutoHotkey & AutoHotkey_H v1.1.22.07 Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: LibCon - AutoHotkey Library For Console Support Report this post Quote 06 Mar 2015, 02:04 You can use ReadConsoleOutput( x, y, w, h ) http://joedf.github.io/libcon/LibCon_do ... t-x-y-w-h- Let me know if you need an example. Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top BGM Posts: 315 Joined: 20 Nov 2013, 20:56 GitHub: bgmCoder Contact: Contact BGM ICQ Website Re: LibCon - AutoHotkey Library For Console Support Report this post Quote 06 Mar 2015, 09:26 Joe, well, I can't get to the point of using ReadConsoleOutput because I can't figure out how to get the CLI to run the command I send it. All I can get it to do is to print text in the window. How can I send the console a command to run? I would be wont to look for SetConsoleInput or something.... but there is only SetConsoleInputCP. My Stuff: mousey; volume; ahkinfo; instantbirder; npp highlighter; Dynamic File Menu; tv - a treeview library; Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: LibCon - AutoHotkey Library For Console Support Report this post Quote 06 Mar 2015, 17:15 here's an example : Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #SingleInstance,Off #Include LibCon.ahk ;Needed #NoTrayIcon ;Suggested SetBatchLines,-1 ;suggested LibConDebug:=1 ;let the user know about errors   SmartStartConsole() ;Shows the Console and 'initializes' the library ;<<<<<<<<  HEADER END  >>>>>>>>>   runwait, ping 8.8.8.8 newline(2) string := ReadConsoleOutput(0,0,79,12) MsgBox % string exitapp Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top T_Lube Posts: 67 Joined: 22 Oct 2014, 00:57 Re: LibCon - AutoHotkey Library For Console Support Report this post Quote 03 Jul 2015, 02:58 Would this work in a SQLite3 shell window? How I just posted a topic on this and i would really like to figure out how to do it as quickly as possible. I know that this is an old post, but hopefully this gets eom hits again. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: LibCon - AutoHotkey Library For Console Support Report this post Quote 03 Jul 2015, 09:52 The point of the library is that you have the power of actually creating the shell window itself! So you could combine an SQL library and libcon.ahk and recreate the mysql prompt if you wanted Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 13 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: pondermatic and 14 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by joedf - AutoHotkey Library For Console Support. This library enables you to write console applications and interact with other console instances. Basically, this library facilitates anything that has to do with writing and interacting with consoles. Forum thread:."	"true"
"Data format"	"AutoHotkey-JSON"	"https://github.com/cocobelgica/AutoHotkey-JSON"	"by cocobelgica - JSON lib for AutoHotkey. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"28"	"9"	"10"	"GitHub - cocobelgica/AutoHotkey-JSON: JSON module for AutoHotkey Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 9 Star 28 Fork 10 cocobelgica/AutoHotkey-JSON Code Issues 0 Pull requests 2 Pulse Graphs JSON module for AutoHotkey 68 commits 2 branches 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master v2 Nothing to show Nothing to show New pull request Latest commit 5d0ca05 Apr 19, 2016 cocobelgica Minor refactoring. Permalink Failed to load latest commit information. .gitignore Added .gitignore. Branch 'v2' not created yet. Apr 14, 2014 Example_JSON.ahk Update example script Nov 7, 2015 JSON.ahk Minor refactoring. Apr 19, 2016 Jxon.ahk Fix parser to return unquoted floating point numbers as is. Apr 7, 2016 README.md Update version no. and date of last update Jan 30, 2016 README.md JSON and Jxon JSON lib for AutoHotkey Requirements: Latest version of AutoHotkey (v1.1+ or v2.0-a+) Version: v2.1.1 (updated 01/30/2016) License: WTFPL JSON.ahk (class) Works on both AutoHotkey v1.1 and v2.0a Installation Use #Include JSON.ahk or copy into a function library folder and use #Include <JSON>. .Load() Parses a JSON string into an AHK value Syntax: value := JSON.Load( text [, reviver ] )  Return Value: An AutoHotkey value (object, string, number) Parameter(s): text [in] - JSON formatted string reviver [in, opt] - function object, prescribes how the value originally produced by parsing is transformed, before being returned. Similar to JavaScript's JSON.parse() reviver parameter. .Dump() Converts an AHK value into a JSON string Syntax: str := JSON.Dump( value, [, replacer, space ] )  Return Value: A JSON formatted string Parameter(s): value [in] - AutoHotkey value (object, string, number) replacer [in, opt] - function object, alters the behavior of the stringification process. Similar to JavaScript's JSON.stringify() replacer parameter. space [in, opt] -if space is a non-negative integer or string, then JSON array elements and object members will be pretty-printed with that indent level. Blank( """" ) (the default) or 0 selects the most compact representation. Using a positive integer space indents that many spaces per level, this number is capped at 10 if it's larger than that. If space is a string (such as ""`t""), the string (or the first 10 characters of the string, if it's longer than that) is used to indent each level. Jxon.ahk (function) Similar to the JSON class above just implemented as a function. Unlike JSON (class) above, this implementation provides reading from and writing to file(Removed Jxon_Read and Jxon_Write). Works on both AutoHotkey v1.1 and v2.0a Installation Use #Include Jxon.ahk or #Include <Jxon>. Must be copied into a function library folder for the latter. Jxon_Load() Deserialize src (a JSON formatted string) to an AutoHotkey object Syntax: obj := Jxon_Load( ByRef src [ , object_base := """", array_base := """" ] )  Parameter(s): src [in, ByRef] - JSON formatted string or path to the file containing JSON formatted string. object_base [in, opt] - an object to use as prototype for objects( {} ) created during parsing. array_base [in, opt] - an object to use as prototype for arrays( [] ) created during parsing. Jxon_Dump() Serialize obj to a JSON formatted string Syntax: str := Jxon_Dump( obj [ , indent := """" ] )  Return Value: A JSON formatted string. Parameter(s): obj [in] - this argument has the same meaning as in JSON.Dump() indent [in, opt] - this argument has the same meaning as in JSON.Dump() Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/cocobelgica/AutoHotkey-JSON"	"by cocobelgica - JSON lib for AutoHotkey. Forum thread:."	"true"
"Data format"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=627"	"by cocobelgica - JSON lib for AutoHotkey. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"28"	"9"	"10"	"GitHub - cocobelgica/AutoHotkey-JSON: JSON module for AutoHotkey Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 9 Star 28 Fork 10 cocobelgica/AutoHotkey-JSON Code Issues 0 Pull requests 2 Pulse Graphs JSON module for AutoHotkey 68 commits 2 branches 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master v2 Nothing to show Nothing to show New pull request Latest commit 5d0ca05 Apr 19, 2016 cocobelgica Minor refactoring. Permalink Failed to load latest commit information. .gitignore Added .gitignore. Branch 'v2' not created yet. Apr 14, 2014 Example_JSON.ahk Update example script Nov 7, 2015 JSON.ahk Minor refactoring. Apr 19, 2016 Jxon.ahk Fix parser to return unquoted floating point numbers as is. Apr 7, 2016 README.md Update version no. and date of last update Jan 30, 2016 README.md JSON and Jxon JSON lib for AutoHotkey Requirements: Latest version of AutoHotkey (v1.1+ or v2.0-a+) Version: v2.1.1 (updated 01/30/2016) License: WTFPL JSON.ahk (class) Works on both AutoHotkey v1.1 and v2.0a Installation Use #Include JSON.ahk or copy into a function library folder and use #Include <JSON>. .Load() Parses a JSON string into an AHK value Syntax: value := JSON.Load( text [, reviver ] )  Return Value: An AutoHotkey value (object, string, number) Parameter(s): text [in] - JSON formatted string reviver [in, opt] - function object, prescribes how the value originally produced by parsing is transformed, before being returned. Similar to JavaScript's JSON.parse() reviver parameter. .Dump() Converts an AHK value into a JSON string Syntax: str := JSON.Dump( value, [, replacer, space ] )  Return Value: A JSON formatted string Parameter(s): value [in] - AutoHotkey value (object, string, number) replacer [in, opt] - function object, alters the behavior of the stringification process. Similar to JavaScript's JSON.stringify() replacer parameter. space [in, opt] -if space is a non-negative integer or string, then JSON array elements and object members will be pretty-printed with that indent level. Blank( """" ) (the default) or 0 selects the most compact representation. Using a positive integer space indents that many spaces per level, this number is capped at 10 if it's larger than that. If space is a string (such as ""`t""), the string (or the first 10 characters of the string, if it's longer than that) is used to indent each level. Jxon.ahk (function) Similar to the JSON class above just implemented as a function. Unlike JSON (class) above, this implementation provides reading from and writing to file(Removed Jxon_Read and Jxon_Write). Works on both AutoHotkey v1.1 and v2.0a Installation Use #Include Jxon.ahk or #Include <Jxon>. Must be copied into a function library folder for the latter. Jxon_Load() Deserialize src (a JSON formatted string) to an AutoHotkey object Syntax: obj := Jxon_Load( ByRef src [ , object_base := """", array_base := """" ] )  Parameter(s): src [in, ByRef] - JSON formatted string or path to the file containing JSON formatted string. object_base [in, opt] - an object to use as prototype for objects( {} ) created during parsing. array_base [in, opt] - an object to use as prototype for arrays( [] ) created during parsing. Jxon_Dump() Serialize obj to a JSON formatted string Syntax: str := Jxon_Dump( obj [ , indent := """" ] )  Return Value: A JSON formatted string. Parameter(s): obj [in] - this argument has the same meaning as in JSON.Dump() indent [in, opt] - this argument has the same meaning as in JSON.Dump() Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/cocobelgica/AutoHotkey-JSON"	"by cocobelgica - JSON lib for AutoHotkey. Forum thread:."	"true"
"Data format"	"ObjDump/ObjLoad"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=3573"	"by HotKeyIt - Serialize/deserialize object to/from variable/memory."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[Lib] ObjDump / ObjLoad - Object Backup - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:26 All times are UTC-05:00 [Lib] ObjDump / ObjLoad - Object Backup Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 47 posts 1 2 3 Next HotKeyIt Posts: 993 Joined: 29 Sep 2013, 18:35 Contact: Contact HotKeyIt Website [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 18 May 2014, 05:48 Note! Only standard objects are supported, ComObject, RegExMatchObject, FileObject, Func and DynaCall (AutoHotkey_H only) objects are not supported. Struct (AutoHotkey_H only) object can be dumped but ObjLoad will restore a normal object instead of Struct object. When value is of type string or raw data, ObjDump will dump only the string by default and always for keys, so StrPut(key)*(A_IsUnicode?2:1) is used. Additional parameter DumpBuffer can be used to force dumping obj.GetCapacity(value) instead of StrPut(value)*(A_IsUnicode?2:1) for values. Numbers consume only required bytes using NumSize/NumType. A small drawback is that resulting file might get quite big, especially when using DumpBuffer=true. Dump object to variable/memory: size := ObjDump(Object,Variable,DumpBuffer)Load object from variable/memory: Obj := ObjLoad(Address) Dump object to file: size := ObjDump(FilePath,Object,DumpBuffer)Load object from file: Obj := ObjLoad(FilePath) AutoHotkey v1 Code: [Select all] [Expand] [Download] (ObjDump.ahk)GeSHi © Codebox Plus ObjDump(obj,ByRef var:="""",mode:=0){   If IsObject(var){ ; FileAppend mode     If FileExist(obj){       FileDelete,%obj%       If ErrorLevel         return     }     f:=FileOpen(obj,""rw-rwd""),VarSetCapacity(v,sz:=RawObjectSize(var,mode)+8,0)     ,RawObject(var,NumPut(sz-8,0+(ptr:=&v),""Int64""),mode),count:=sz//65536     Loop % count       f.RawWrite(ptr+0,65536),ptr+=65536     return sz,f.RawWrite(ptr+0,Mod(sz,65536)),f.Close()   } else if !IsByRef(var) 		return RawObjectSize(obj,mode)+8   else return sz,VarSetCapacity(var,sz:=RawObjectSize(obj,mode)+8,0),RawObject(obj,NumPut(sz-8,&var,""Int64""),mode) } RawObject(obj,addr,buf:=0,objects:=0){   ; Type.Enum:    Char.1 UChar.2 Short.3 UShort.4 Int.5 UInt.6 Int64.7 UInt64.8 Double.9 String.10 Object.11   ; Negative for keys and positive for values   if !objects     objects:={(""""):0,(obj):0}   else objects[obj]:=(++objects[""""])   for k,v in obj   { ; 9 = Int64 for size and Char for type     If IsObject(k){       If objects.HasKey(k)         NumPut(-12,addr+0,""Char""),NumPut(objects[k],addr+1,""Int64""),addr+=9       else NumPut(-11,addr+0,""Char""),NumPut(sz:=RawObjectSize(k,buf),addr+1,""Int64""),RawObject(k,addr+9,buf,objects),addr+=sz+9     }else if (k+0="""")       NumPut(-10,addr+0,""Char""),NumPut(sz:=StrPut(k,addr+9)*2,addr+1,""Int64""),addr+=sz+9     else NumPut( InStr(k,""."")?-9:k>4294967295?-8:k>65535?-6:k>255?-4:k>-1?-2:k>-129?-1:k>-32769?-3:k>-2147483649?-5:-7,addr+0,""Char"")         ,NumPut(k,addr+1,InStr(k,""."")?""Double"":k>4294967295?""UInt64"":k>65535?""UInt"":k>255?""UShort"":k>-1?""UChar"":k>-129?""Char"":k>-32769?""Short"":k>-2147483649?""Int"":""Int64"")         ,addr+=InStr(k,""."")||k>4294967295?9:k>65535?5:k>255?3:k>-129?2:k>-32769?3:k>-2147483649?5:9     If IsObject(v){       if objects.HasKey(v)         NumPut( 12,addr+0,""Char""),NumPut(objects[v],addr+1,""Int64""),addr+=9       else NumPut( 11,addr+0,""Char""),NumPut(sz:=RawObjectSize(v,buf),addr+1,""Int64""),RawObject(v,addr+9,buf,objects),addr+=sz+9     }else if (v+0="""")       NumPut( 10,addr+0,""Char""),NumPut(sz:=buf?obj.GetCapacity(k):StrPut(v)*2,addr+1,""Int64""),DllCall(""RtlMoveMemory"",""PTR"",addr+9,""PTR"",buf?obj.GetAddress(k):&v,""PTR"",sz),addr+=sz+9     else NumPut(InStr(v,""."")?9:v>4294967295?8:v>65535?6:v>255?4:v>-1?2:v>-129?1:v>-32769?3:v>-2147483649?5:7,addr+0,""Char"")         ,NumPut(v,addr+1,InStr(v,""."")?""Double"":v>4294967295?""UInt64"":v>65535?""UInt"":v>255?""UShort"":v>-1?""UChar"":v>-129?""Char"":v>-32769?""Short"":v>-2147483649?""Int"":""Int64"")         ,addr+=InStr(v,""."")||v>4294967295?9:v>65535?5:v>255?3:v>-129?2:v>-32769?3:v>-2147483649?5:9   } } RawObjectSize(obj,buf:=0,objects:=0){   if !objects     objects:={(obj):1}   else if !objects.HasKey(obj)     objects[obj]:=1   for k,v in obj   {     If IsObject(k)       sz+=objects.HasKey(k)?9:RawObjectSize(k,buf,objects)+9     else if (k+0="""")       sz+=StrPut(k)*2+9     else sz+=InStr(k,""."")||k>4294967295?9:k>65535?5:k>255?3:k>-129?2:k>-32769?3:k>-2147483649?5:9     If IsObject(v)       sz+=objects.HasKey(v)?9:RawObjectSize(v,buf,objects)+9     else if (v+0="""")       sz+=(buf?obj.GetCapacity(k):StrPut(v)*2)+9     else sz+=InStr(v,""."")||v>4294967295?9:v>65535?5:v>255?3:v>-129?2:v>-32769?3:v>-2147483649?5:9   }   return sz } Code: [Select all] [Expand] [Download] (ObjLoad.ahk)GeSHi © Codebox Plus ObjLoad(addr,objects:=0){   If (addr+0=""""){ ; FileRead Mode     If !FileExist(addr)       return     FileGetSize,sz,%addr%     FileRead,v,*c %addr%     If ErrorLevel||!sz       return     addr:=&v   }   obj:=[],end:=addr+8+(sz:=NumGet(addr+0,""Int64"")),addr+=8   if !objects     objects:={0:obj}   else objects.Push(obj)   While addr<end{ ; 9 = Int64 for size and Char for type     If NumGet(addr+0,""Char"")=-12       k:=objects[NumGet(addr+1,""Int64"")],addr+=9     else if NumGet(addr+0,""Char"")=-11       k:=ObjLoad(addr+1,objects),addr+=9+NumGet(addr+1,""Int64"")     else if NumGet(addr+0,""Char"")=-10       sz:=NumGet(addr+1,""Int64""),k:=StrGet(addr+9),addr+=sz+9     else k:=NumGet(addr+1,SubStr(""Char  UChar Short UShortInt   UInt  Int64 UInt64Double"",(sz:=-NumGet(addr+0,""Char""))*6-5,6)),addr+=SubStr(""112244888"",sz,1)+1     If NumGet(addr+0,""Char"")= 12       obj[k]:=objects[NumGet(addr+1,""Int64"")],addr+=9     else if NumGet(addr+0,""Char"")= 11       obj[k]:=ObjLoad(addr+1,objects),addr+=9+NumGet(addr+1,""Int64"")     else if NumGet(addr+0,""Char"")= 10       obj[k]:=StrGet(addr+9),obj.SetCapacity(k,sz:=NumGet(addr+1,""Int64"")),DllCall(""RtlMoveMemory"",""PTR"",obj.GetAddress(k),""PTR"",addr+9,""PTR"",sz),addr+=sz+9     else obj[k]:=NumGet(addr+1,SubStr(""Char  UChar Short UShortInt   UInt  Int64 UInt64Double"",(sz:=NumGet(addr+0,""Char""))*6-5,6)),addr+=SubStr(""112244888"",sz,1)+1   }   return obj } AutoHotkey v2 Code: [Select all] [Expand] [Download] (ObjDump.ahk)GeSHi © Codebox Plus ObjDump(obj,ByRef var:="""",mode:=0){   If IsObject(var){ ; FileAppend mode     If FileExist(obj)&&!FileDelete(obj),return     f:=FileOpen(obj,""rw-rwd""),VarSetCapacity(v,sz:=RawObjectSize(var,mode)+8,0)     ,RawObject(var,NumPut(sz-8,ptr:=&v,""Int64""),mode),count:=sz//65536     Loop count       f.RawWrite(ptr+0,65536),ptr+=65536     return f.RawWrite(ptr+0,Mod(sz,65536)),f.Close(),sz   } else if !IsByRef(var)       ,return RawObjectSize(obj,mode)+8   else return VarSetCapacity(var,sz:=RawObjectSize(obj,mode)+8,0),RawObject(obj,NumPut(sz-8,&var,""Int64""),mode),sz } RawObject(obj,addr,buf:=0,objects:=0){   ; Type.Enum:    Char.1 UChar.2 Short.3 UShort.4 Int.5 UInt.6 Int64.7 UInt64.8 Double.9 String.10 Object.11   ; Negative for keys and positive for values   if !objects     objects:={(""""):0,(obj):0}   else objects[obj]:=(++objects[""""])   for k,v in obj   { ; 9 = Int64 for size and Char for type     If IsObject(k){       If objects.HasKey(k)         NumPut(-12,addr,""Char""),NumPut(objects[k],addr+1,""Int64""),addr+=9       else NumPut(-11,addr,""Char""),NumPut(sz:=RawObjectSize(k,buf),addr+1,""Int64""),RawObject(k,addr+9,buf,objects),addr+=sz+9     }else if Type(k)=""String"",NumPut(-10,addr,""Char""),NumPut(sz:=StrPut(k,addr+9)*2,addr+1,""Int64""),addr+=sz+9     else NumPut( InStr(k,""."")?-9:k>4294967295?-8:k>65535?-6:k>255?-4:k>-1?-2:k>-129?-1:k>-32769?-3:k>-2147483649?-5:-7,addr,""Char"")         ,NumPut(k,addr+1,InStr(k,""."")?""Double"":k>4294967295?""UInt64"":k>65535?""UInt"":k>255?""UShort"":k>-1?""UChar"":k>-129?""Char"":k>-32769?""Short"":k>-2147483649?""Int"":""Int64"")         ,addr+=InStr(k,""."")||k>4294967295?9:k>65535?5:k>255?3:k>-129?2:k>-32769?3:k>-2147483649?5:9     If IsObject(v){       if objects.HasKey(v)         NumPut( 12,addr,""Char""),NumPut(objects[v],addr+1,""Int64""),addr+=9       else NumPut( 11,addr,""Char""),NumPut(sz:=RawObjectSize(v,buf),addr+1,""Int64""),RawObject(v,addr+9,buf,objects),addr+=sz+9     }else if Type(v)=""String"",NumPut( 10,addr,""Char""),NumPut(sz:=buf?obj.GetCapacity(k):StrPut(v)*2,addr+1,""Int64""),DllCall(""RtlMoveMemory"",""PTR"",addr+9,""PTR"",buf?obj.GetAddress(k):&v,""PTR"",sz),addr+=sz+9     else NumPut(InStr(v,""."")?9:v>4294967295?8:v>65535?6:v>255?4:v>-1?2:v>-129?1:v>-32769?3:v>-2147483649?5:7,addr,""Char"")         ,NumPut(v,addr+1,InStr(v,""."")?""Double"":v>4294967295?""UInt64"":v>65535?""UInt"":v>255?""UShort"":v>-1?""UChar"":v>-129?""Char"":v>-32769?""Short"":v>-2147483649?""Int"":""Int64"")         ,addr+=InStr(v,""."")||v>4294967295?9:v>65535?5:v>255?3:v>-129?2:v>-32769?3:v>-2147483649?5:9   } } RawObjectSize(obj,buf:=0,objects:=0){   if !objects     objects:={(obj):1}   else if !objects.HasKey(obj)     objects[obj]:=1   for k,v in obj   {     If IsObject(k),sz+=objects.HasKey(k)?9:RawObjectSize(k,buf,objects)+9       else if Type(k)=""String"",sz+=StrPut(k)*2+9       else sz+=InStr(k,""."")||k>4294967295?9:k>65535?5:k>255?3:k>-129?2:k>-32769?3:k>-2147483649?5:9     If IsObject(v),sz+=objects.HasKey(v)?9:RawObjectSize(v,buf,objects)+9       else if Type(v)=""String"",sz+=(buf?obj.GetCapacity(k):StrPut(v)*2)+9       else sz+=InStr(v,""."")||v>4294967295?9:v>65535?5:v>255?3:v>-129?2:v>-32769?3:v>-2147483649?5:9   }   return sz } Code: [Select all] [Expand] [Download] (ObjLoad.ahk)GeSHi © Codebox Plus ObjLoad(addr,objects:=0){   If addr+0=""""{ ; FileRead Mode     If !FileExist(addr),return     else v:=FileRead(""*c "" addr)     If ErrorLevel||!FileGetSize(addr),return     else addr:=&v   }   obj:=[],end:=addr+8+(sz:=NumGet(addr,""Int64"")),addr+=8   if !objects     objects:={0:obj}   else objects.Push(obj)   While addr<end{ ; 9 = Int64 for size and Char for type     If NumGet(addr,""Char"")=-12,k:=objects[NumGet(addr+1,""Int64"")],addr+=9     else if NumGet(addr,""Char"")=-11,k:=ObjLoad(addr+1,objects),addr+=9+NumGet(addr+1,""Int64"")     else if NumGet(addr,""Char"")=-10,sz:=NumGet(addr+1,""Int64""),k:=StrGet(addr+9),addr+=sz+9     else k:=NumGet(addr+1,SubStr(""Char  UChar Short UShortInt   UInt  Int64 UInt64Double"",(sz:=-NumGet(addr,""Char""))*6-5,6)),addr+=SubStr(""112244888"",sz,1)+1     If NumGet(addr,""Char"")= 12,obj[k]:=objects[NumGet(addr+1,""Int64"")],addr+=9     else if NumGet(addr,""Char"")= 11,obj[k]:=ObjLoad(addr+1,objects),addr+=9+NumGet(addr+1,""Int64"")     else if NumGet(addr,""Char"")= 10,obj[k]:=StrGet(addr+9),obj.SetCapacity(k,sz:=NumGet(addr+1,""Int64"")),DllCall(""RtlMoveMemory"",""PTR"",obj.GetAddress(k),""PTR"",addr+9,""PTR"",sz),addr+=sz+9     else obj[k]:=NumGet(addr+1,SubStr(""Char  UChar Short UShortInt   UInt  Int64 UInt64Double"",(sz:=NumGet(addr,""Char""))*6-5,6)),addr+=SubStr(""112244888"",sz,1)+1   }   return obj } UPDATE: *25.02.2016 Fix ObjLoad bug. ObjDump and ObjLoad can now handle object reference to itself or another object within dumped object. *02.11.2015 Fix saving binary memory of key (use obj.GetAddress(k) instead of &v) *20.08.2015 Include size of dumped object for simplified use Note wrote:New ObjLoad() function is not compatible to the old functions and cannot load a file dumped with old ObjDump function. You can rename the old ObjLoad function to ObjLoad2 and run this with new ObjDump function: ObjDump(ObjLoad2(File),File) 20.05.2014 Implemented obj-64 -> file -> obj-32 and the other way round. Use only the required memory for numbers. Additional parameter DumpBuffer, when true obj.GetCapacity(key) is used else StrPut(value)*(A_IsUnicode?2:1) 18.05.2014 Fixed writing large objects Old_Versions 20.05.2014 Dump object to variable/memory: size := ObjDump(Object,Variable,DumpBuffer)Load object from variable/memory: Obj := ObjLoad(Address,Size) Dump object to file: size := ObjDump(FilePath,Object,DumpBuffer)Load object from file: Obj := ObjLoad(FilePath) AutoHotkey v1 Code: [Select all] [Expand] [Download] (ObjDump.ahk)GeSHi © Codebox Plus ObjDump(obj,ByRef var,mode:=0){   If IsObject(var){ ; FileAppend mode     If FileExist(obj){       FileDelete,%obj%       If ErrorLevel         return     }     f:=FileOpen(obj,""rw-rwd""),VarSetCapacity(v,sz:=RawObjectSize(var,mode),0)     ,RawObject(var,&v,mode),count:=sz//65536,ptr:=&v     Loop % count       f.RawWrite(ptr+0,65536),ptr+=65536     return sz,f.RawWrite(ptr+0,Mod(sz,65536)),f.Close()   } else return sz,VarSetCapacity(var,sz:=RawObjectSize(obj,mode),0),RawObject(obj,&var,mode) } RawObject(obj,addr,buf:=0){   ; Type.Enum:    Char.1 UChar.2 Short.3 UShort.4 Int.5 UInt.6 Int64.7 UInt64.8 Double.9 String.10 Object.11   for k,v in obj   { ; 9 = Int64 for size and Char for type     If IsObject(k)       NumPut(-11,addr+0,""Char""),NumPut(sz:=RawObjectSize(k,buf),addr+1,""UInt64""),RawObject(k,addr+9),addr+=sz+9     else if (k+0="""")       NumPut(-10,addr+0,""Char""),NumPut(StrPut(k,addr+9)*(A_IsUnicode?2:1),addr+1,""UInt64""),addr+=NumGet(addr+1,""UInt64"")+9     else NumPut( InStr(k,""."")?-9:k>4294967295?-8:k>65535?-6:k>255?-4:k>-1?-2:k>-129?-1:k>-32769?-3:k>-2147483649?-5:-7,addr+0,""Char"")         ,NumPut(k,addr+1,InStr(k,""."")?""Double"":k>4294967295?""UInt64"":k>65535?""UInt"":k>255?""UShort"":k>-1?""UChar"":k>-129?""Char"":k>-32769?""Short"":k>-2147483649?""Int"":""Int64"")         ,addr+=InStr(k,""."")||k>4294967295?9:k>65535?5:k>255?3:k>-129?2:k>-32769?3:k>-2147483649?5:9     If IsObject(v)       NumPut( 11,addr+0,""Char""),NumPut(sz:=RawObjectSize(v,buf),addr+1,""UInt64""),RawObject(v,addr+9),addr+=sz+9     else if (v+0="""")       NumPut( 10,addr+0,""Char""),NumPut(sz:=buf?obj.GetCapacity(k):StrPut(v)*(A_IsUnicode?2:1),addr+1,""Int64""),DllCall(""RtlMoveMemory"",""PTR"",addr+9,""PTR"",&v,""PTR"",sz),addr+=sz+9     else NumPut( InStr(v,""."")?9:v>4294967295?8:v>65535?6:v>255?4:v>-1?2:v>-129?1:v>-32769?3:v>-2147483649?5:7,addr+0,""Char"")         ,NumPut(v,addr+1,InStr(v,""."")?""Double"":v>4294967295?""UInt64"":v>65535?""UInt"":v>255?""UShort"":v>-1?""UChar"":v>-129?""Char"":v>-32769?""Short"":v>-2147483649?""Int"":""Int64"")         ,addr+=InStr(v,""."")||v>4294967295?9:v>65535?5:v>255?3:v>-129?2:v>-32769?3:v>-2147483649?5:9   } } RawObjectSize(obj,buf:=0,sz:=0){   ; 9 = Int64 for size and Char for type   for k,v in obj   {     If IsObject(k)       sz+=RawObjectSize(k,buf)+9     else if (k+0="""")         sz+=StrPut(k)*(A_IsUnicode?2:1)+9     else sz+=InStr(k,""."")||k>4294967295?9:k>65535?5:k>255?3:k>-129?2:k>-32769?3:k>-2147483649?5:9     If IsObject(v)       sz+=RawObjectSize(v,buf)+9     else if (v+0="""")       sz+=(buf?obj.GetCapacity(k):StrPut(v)*(A_IsUnicode?2:1))+9     else sz+=InStr(v,""."")||v>4294967295?9:v>65535?5:v>255?3:v>-129?2:v>-32769?3:v>-2147483649?5:9   }   return sz } Code: [Select all] [Expand] [Download] (ObjLoad.ahk)GeSHi © Codebox Plus ObjLoad(addr,sz:=""""){   ; Arrays to retrieve type and size from number type   static type:=[""Char"",""UChar"",""Short"",""UShort"",""Int"",""UInt"",""Int64"",""UInt64"",""Double""],num:=[1,1,2,2,4,4,8,8,8]   If (sz=""""){ ; FileRead Mode     If !FileExist(addr)       return     FileGetSize,sz,%addr%     FileRead,v,*c %addr%     If ErrorLevel||!sz       return     addr:=&v   }   end:=addr+sz,  obj:=[]   While % addr<end{ ; 9 = Int64 for size and Char for type     If NumGet(addr+0,""Char"")=-11       k:=ObjLoad(addr+9,sz:=NumGet(addr+1,""UInt64"")),addr+=sz+9     else if NumGet(addr+0,""Char"")=-10       k:=StrGet(addr+9),addr+=NumGet(addr+1,""UInt64"")+9     else      k:=NumGet(addr+1,type[sz:=-1*NumGet(addr+0,""Char"")]),addr+=num[sz]+1     If NumGet(addr+0,""Char"")= 11       obj[k]:=ObjLoad(addr+9,sz:=NumGet(addr+1,""PTR"")),addr+=sz+9     else if NumGet(addr+0,""Char"")= 10       obj.SetCapacity(k,sz:=NumGet(addr+1,""UInt64"")),DllCall(""RtlMoveMemory"",""PTR"",obj.GetAddress(k),""PTR"",addr+9,""PTR"",sz),addr+=sz+9     else obj[k]:=NumGet(addr+1,type[sz:=NumGet(addr+0,""Char"")]),addr+=num[sz]+1   }   return obj } AutoHotkey v2 Code: [Select all] [Expand] [Download] (ObjDump.ahk)GeSHi © Codebox Plus ObjDump(obj,ByRef var,mode:=0){   If IsObject(var){ ; FileAppend mode     If FileExist(obj){       FileDelete,%obj%       If ErrorLevel         return     }     f:=FileOpen(obj,""rw-rwd""),VarSetCapacity(v,sz:=RawObjectSize(var,mode),0)     ,RawObject(var,&v,mode),count:=sz//65536,ptr:=&v     Loop count       f.RawWrite(ptr+0,65536),ptr+=65536     return f.RawWrite(ptr+0,Mod(sz,65536)),f.Close(),sz   } else return VarSetCapacity(var,sz:=RawObjectSize(obj,mode),0),RawObject(obj,&var,mode),sz } RawObject(obj,addr,buf:=0){   ; Type.Enum:    Char.1 UChar.2 Short.3 UShort.4 Int.5 UInt.6 Int64.7 UInt64.8 Double.9 String.10 Object.11   for k,v in obj   { ; 9 = Int64 for size and Char for type     If IsObject(k),NumPut(-11,addr,""Char""),NumPut(sz:=RawObjectSize(k,buf),addr+1,""UInt64""),RawObject(k,addr+9),addr+=sz+9     else if Type(k)=""String"",NumPut(-10,addr,""Char""),NumPut(sz:=StrPut(k,addr+9)*2,addr+1,""UInt64""),addr+=sz+9     else NumPut( InStr(k,""."")?-9:k>4294967295?-8:k>65535?-6:k>255?-4:k>-1?-2:k>-129?-1:k>-32769?-3:k>-2147483649?-5:-7,addr,""Char"")         ,NumPut(k,addr+1,InStr(k,""."")?""Double"":k>4294967295?""UInt64"":k>65535?""UInt"":k>255?""UShort"":k>-1?""UChar"":k>-129?""Char"":k>-32769?""Short"":k>-2147483649?""Int"":""Int64"")         ,addr+=InStr(k,""."")||k>4294967295?9:k>65535?5:k>255?3:k>-129?2:k>-32769?3:k>-2147483649?5:9     If IsObject(v),NumPut( 11,addr,""Char""),NumPut(sz:=RawObjectSize(v,buf),addr+1,""UInt64""),RawObject(v,addr+9),addr+=sz+9     else if Type(v)=""String"",NumPut( 10,addr,""Char""),NumPut(sz:=buf?obj.GetCapacity(k):StrPut(v)*2,addr+1,""Int64""),DllCall(""RtlMoveMemory"",""PTR"",addr+9,""PTR"",&v,""PTR"",sz),addr+=sz+9     else NumPut( InStr(v,""."")?9:v>4294967295?8:v>65535?6:v>255?4:v>-1?2:v>-129?1:v>-32769?3:v>-2147483649?5:7,addr,""Char"")         ,NumPut(v,addr+1,InStr(v,""."")?""Double"":v>4294967295?""UInt64"":v>65535?""UInt"":v>255?""UShort"":v>-1?""UChar"":v>-129?""Char"":v>-32769?""Short"":v>-2147483649?""Int"":""Int64"")         ,addr+=InStr(v,""."")||v>4294967295?9:v>65535?5:v>255?3:v>-129?2:v>-32769?3:v>-2147483649?5:9   } } RawObjectSize(obj,buf:=0,sz:=0){   ; 9 = Int64 for size and Char for type   for k,v in obj   {     If IsObject(k),sz+=RawObjectSize(k,buf)+9       else if Type(k)=""String"",sz+=StrPut(k)*2+9       else sz+=InStr(k,""."")||k>4294967295?9:k>65535?5:k>255?3:k>-129?2:k>-32769?3:k>-2147483649?5:9     If IsObject(v),sz+=RawObjectSize(v,buf)+9       else if Type(v)=""String"",sz+=(buf?obj.GetCapacity(k):StrPut(v)*2)+9       else sz+=InStr(v,""."")||v>4294967295?9:v>65535?5:v>255?3:v>-129?2:v>-32769?3:v>-2147483649?5:9   }   return sz } Code: [Select all] [Expand] [Download] (ObjLoad.ahk)GeSHi © Codebox Plus ObjLoad(addr,sz:=""""){   ; Arrays to retrieve type and size from number type   static type:=[""Char"",""UChar"",""Short"",""UShort"",""Int"",""UInt"",""Int64"",""UInt64"",""Double""],num:=[1,1,2,2,4,4,8,8,8]   If sz=""""{ ; FileRead Mode     If !FileExist(addr)       return     FileGetSize,sz,%addr%     FileRead,v,*c %addr%     If ErrorLevel||!sz       return     addr:=&v   }   end:=addr+sz,  obj:=[]   While addr<end{ ; 9 = Int64 for size and Char for type     If NumGet(addr,""Char"")=-11,k:=ObjLoad(addr+9,sz:=NumGet(addr+1,""UInt64"")),addr+=sz+9     else if NumGet(addr,""Char"")=-10,k:=StrGet(addr+9),addr+=NumGet(addr+1,""UInt64"")+9     else      k:=NumGet(addr+1,type[sz:=-NumGet(addr,""Char"")]),addr+=num[sz]+1     If NumGet(addr,""Char"")= 11,obj[k]:=ObjLoad(addr+9,sz:=NumGet(addr+1,""PTR"")),addr+=sz+9     else if NumGet(addr,""Char"")= 10,obj.SetCapacity(k,sz:=NumGet(addr+1,""UInt64"")),DllCall(""RtlMoveMemory"",""PTR"",obj.GetAddress(k),""PTR"",addr+9,""PTR"",sz),addr+=sz+9     else obj[k]:=NumGet(addr+1,type[sz:=NumGet(addr,""Char"")]),addr+=num[sz]+1   }   return obj } First versions AutoHotkey v1 Code: [Select all] [Expand] [Download] (ObjDump.ahk)GeSHi © Codebox Plus ObjDump(obj,ByRef var){   If IsObject(var){ ; FileAppend mode     If FileExist(obj){       FileDelete,%obj%       If ErrorLevel         return     }     f:=FileOpen(obj,""rw-rwd""),VarSetCapacity(v,sz:=RawObjectSize(var),0)     ,RawObject(var,&v),count:=sz//65536,ptr:=&v     Loop count       f.RawWrite(ptr+0,65536),ptr+=65536     return sz,f.RawWrite(ptr+0,Mod(sz,65536)),f.Close()   } else return sz,VarSetCapacity(var,sz:=RawObjectSize(obj),0),RawObject(obj,&var) } RawObject(obj,addr){   orig:=addr   for k,v in obj   {     If IsObject(k)       NumPut(-4,addr+0,""Short""),NumPut(szo:=RawObjectSize(k),addr+2,""PTR""),addr+=A_PtrSize+2,RawObject(k,addr),addr+=szo     else if (k+0="""")       NumPut(-1,addr+0,""Short""),NumPut(StrPut(k),addr+2,""PTR""),StrPut(k,addr+A_PtrSize+2),addr+=NumGet(addr+2,""PTR"")*(A_IsUnicode?2:1)+A_PtrSize+2     else if (k+0!=""""&&InStr(k,"".""))       NumPut(-3,addr+0,""Short""),NumPut(k,addr+2,""Double""),addr+=8+2     else NumPut(-2,addr+0,""Short""),NumPut(k,addr+2,""Int64""),addr+=8+2     If IsObject(v)       NumPut( 4,addr+0,""Short""),NumPut(szo:=RawObjectSize(v),addr+2,""PTR""),addr+=A_PtrSize+2,RawObject(v,addr),addr+=szo     else if (v+0="""")       NumPut( 1,addr+0,""Short""),NumPut(cap:=obj.GetCapacity(k),addr+2,""PTR""),DllCall(""RtlMoveMemory"",""PTR"",addr+A_PtrSize+2,""PTR"",&v,""PTR"",cap),addr+=cap+A_PtrSize+2     else if (v+0!=""""&&InStr(v,"".""))       NumPut( 3,addr+0,""Short""),NumPut(v,addr+2,""Double""),addr+=8+2     else NumPut( 2,addr+0,""Short""),NumPut(v,addr+2,""Int64""),addr+=8+2   } } RawObjectSize(obj,sz:=0){   for k,v in obj   { ; key     If IsObject(k)       sz+=RawObjectSize(k)+A_PtrSize+2     else if (k+0="""")       sz+=StrPut(k)*2+A_PtrSize+2     else sz+=8+2     ; value     If IsObject(v)       sz+=RawObjectSize(v)+A_PtrSize+2     else if (v+0="""")       sz+=obj.GetCapacity(k)+A_PtrSize+2     else sz+=8+2   }   return sz } Code: [Select all] [Expand] [Download] (ObjLoad.ahk)GeSHi © Codebox Plus ObjLoad(addr,sz:=""""){   If (sz=""""){ ; FileRead Mode     If !FileExist(addr)       return     FileGetSize,sz,%addr%     FileRead,v,*c %addr%     If ErrorLevel||!sz       return     addr:=&v   }   end:=addr+sz,  obj:=[]   While addr<end{     If (NumGet(addr+0,""Short"")=-4)       k:=ObjLoad(addr+A_PtrSize+2,sz:=NumGet(addr+2,""PTR"")),addr+=sz+2+A_PtrSize     else if (NumGet(addr+0,""Short"")=-1)       k:=StrGet(addr+2+A_PtrSize),addr+=NumGet(addr+2,""PTR"")*(A_IsUnicode?2:1)+A_PtrSize+2     else      k:=NumGet(addr+2,NumGet(addr+0,""Short"")=-3?""Double"":""Int64""),addr+=8+2     If (NumGet(addr+0,""Short"")= 4)       obj[k]:=ObjLoad(addr+A_PtrSize+2,sz:=NumGet(addr+2,""PTR"")),addr+=sz+2+A_PtrSize     else if (NumGet(addr+0,""Short"")= 1)       obj.SetCapacity(k,NumGet(addr+2,""PTR"")),DllCall(""RtlMoveMemory"",""PTR"",obj.GetAddress(k),""PTR"",addr+2+A_PtrSize,""PTR"",NumGet(addr+2,""PTR"")),addr+=NumGet(addr+2,""PTR"")+A_PtrSize+2     else obj[k]:=NumGet(addr+2,NumGet(addr+0,""Short"")=3?""Double"":""Int64""),addr+=8+2   }   return obj } AutoHotkey v2 Code: [Select all] [Expand] [Download] (ObjDump.ahk)GeSHi © Codebox Plus ObjDump(obj,ByRef var){   If IsObject(var){ ; FileAppend mode     If FileExist(obj){       FileDelete,%obj%       If ErrorLevel         return     }     f:=FileOpen(obj,""rw-rwd""),VarSetCapacity(v,sz:=RawObjectSize(var),0)     ,RawObject(var,&v),count:=sz//65536,ptr:=&v     Loop count       f.RawWrite(ptr+0,65536),ptr+=65536     return f.RawWrite(ptr+0,Mod(sz,65536)),f.Close(),sz   } else return VarSetCapacity(var,sz:=RawObjectSize(obj),0),RawObject(obj,&var),sz } RawObject(obj,addr){   for k,v in obj   {     If IsObject(k),NumPut(-4,addr,""Short""),NumPut(szo:=RawObjectSize(k),addr+2,""PTR""),addr+=A_PtrSize+2,RawObject(k,addr),addr+=szo     else if Type(k)=""Float"",NumPut(-3,addr,""Short""),NumPut(k,addr+2,""Double""),addr+=8+2     else if Type(k)=""String"",NumPut(-1,addr,""Short""),NumPut(StrPut(k),addr+2,""PTR""),StrPut(k,addr+A_PtrSize+2),addr+=NumGet(addr+2,""PTR"")*2+A_PtrSize+2     else NumPut(-2,addr,""Short""),NumPut(k,addr+2,""Int64""),addr+=8+2     If IsObject(v),NumPut( 4,addr,""Short""),NumPut(szo:=RawObjectSize(v),addr+2,""PTR""),addr+=A_PtrSize+2,RawObject(v,addr),addr+=szo     else if Type(v)=""Float"",NumPut( 3,addr,""Short""),NumPut(v,addr+2,""Double""),addr+=8+2     else if Type(v)=""String"",NumPut( 1,addr,""Short""),NumPut(cap:=obj.GetCapacity(k),addr+2,""PTR""),DllCall(""RtlMoveMemory"",""PTR"",addr+A_PtrSize+2,""PTR"",&v,""PTR"",cap),addr+=cap+A_PtrSize+2     else NumPut( 2,addr,""Short""),NumPut(v,addr+2,""Int64""),addr+=8+2   } } RawObjectSize(obj,sz:=0){   for k,v in obj   {     If IsObject(k),sz:=RawObjectSize(k,zs)+A_PtrSize+2       else if Type(k)=""String"",sz+=StrPut(k)*2+A_PtrSize+2       else sz+=8+2     If IsObject(v),sz:=RawObjectSize(v,sz)+A_PtrSize+2       else if Type(v)=""String"",sz+=obj.GetCapacity(k)+A_PtrSize+2       else sz+=8+2   }   return sz } Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ObjLoad(addr,sz:=""""){   If sz=""""{ ; FileRead Mode     If !FileExist(addr)       return     FileGetSize,sz,%addr%     FileRead,v,*c %addr%     If ErrorLevel||!sz       return     addr:=&v   }   end:=addr+sz,  obj:=[]   While addr<end{     If NumGet(addr,""Short"")=-4,k:=ObjLoad(addr+A_PtrSize+2,sz:=NumGet(addr+2,""PTR"")),addr+=sz+2+A_PtrSize     else if NumGet(addr,""Short"")=-1,k:=StrGet(addr+2+A_PtrSize),addr+=NumGet(addr+2,""PTR"")*2+A_PtrSize+2     else      k:=NumGet(addr+2,NumGet(addr,""Short"")=-3?""Double"":""Int64""),addr+=8+2       If NumGet(addr,""Short"")= 4,obj[k]:=ObjLoad(addr+A_PtrSize+2,sz:=NumGet(addr+2,""PTR"")),addr+=sz+2+A_PtrSize     else if NumGet(addr,""Short"")= 1,obj.SetCapacity(k,NumGet(addr+2,""PTR"")),DllCall(""RtlMoveMemory"",""PTR"",obj.GetAddress(k),""PTR"",addr+2+A_PtrSize,""PTR"",NumGet(addr+2,""PTR"")),addr+=NumGet(addr+2,""PTR"")+A_PtrSize+2     else obj[k]:=NumGet(addr+2,NumGet(addr,""Short"")=3?""Double"":""Int64""),addr+=8+2   }   return obj } Top cyruz Posts: 241 Joined: 30 Sep 2013, 13:31 Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 18 May 2014, 10:01 This is seriously good stuff. I asked for this as a builtin some time ago... Thank you for your work! ABCza on the old forum. My GitHub. Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 18 May 2014, 16:28 this script is way over my head. any examples a newbie can use this? Top HotKeyIt Posts: 993 Joined: 29 Sep 2013, 18:35 Contact: Contact HotKeyIt Website Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 18 May 2014, 16:39 Save_Load_Object_to_file Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus obj:={a:1,b:2,c:[1,2,""test""],d:{a:0}} ObjDump(A_ScriptDir ""\Test.bin"",obj) for k,v in ObjLoad(A_ScriptDir ""\Test.bin"")   If !IsObject(v)     MsgBox % ""Parent:`n"" k "": "" v   else for k,v in v     MsgBox % ""Child:`n"" k "": "" v Save_Load_Object_to_variable Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus obj:={a:1,b:2,c:[1,2,""test""],d:{a:0}} size:=ObjDump(obj,var) for k,v in ObjLoad(&var,size)   If !IsObject(v)     MsgBox % ""Parent:`n"" k "": "" v   else for k,v in v     MsgBox % ""Child:`n"" k "": "" v Top arcticir Posts: 330 Joined: 17 Nov 2013, 11:32 Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 19 May 2014, 05:23 Interesting attempt, but obviously failed. Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus ObjDump(A_ScriptDir ""\1.b"",AhkDllThread()) AhkThread := ObjLoad(A_ScriptDir ""\1.b"") AhkThread.ahktextdll(""MsgBox,Test"") MsgBox Top HotKeyIt Posts: 993 Joined: 29 Sep 2013, 18:35 Contact: Contact HotKeyIt Website Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 19 May 2014, 05:42 There are 2 things why this would not work: - when ObjDump finishes the reference to the AhkDllThread object is deleted and MemoryFreeLibrary is called so there is no code anymore. - Only standard objects are supported, RegEx, DynaCall and Struct objects are not standard objects and cannot be dumped/loaded properly. Top strobo Posts: 125 Joined: 30 Sep 2013, 15:24 Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 19 May 2014, 09:28 Nice Lib. Time (encode, decode) and Space benchmark vs JSON implementations (and/or other (de)serializations) would be interesting. Top HotKeyIt Posts: 993 Joined: 29 Sep 2013, 18:35 Contact: Contact HotKeyIt Website Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 19 May 2014, 12:04 Thanks Time to decode encode depends on size of the object, in avarage ObjDump/ObjLoad will be faster. I have written ObjDump to support high speed dump for huge objects and dumping any content, so even raw data is supported. My tests shown, the larger the object, the faster ObjLoad and ObjDump would be, for example even here ObjDump is faster: Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; SetBatchLines, -1 ; uncomment when using AHK v1 ObjSize:=1000000 VarToUse:=""A_TickCount"" ; use A_TickCount, A_ScriptFullPath, A_Now ... TimesToRun:=1 obj:=[] Loop % ObjSize   obj[A_Index]:=%VarToUse% s:=A_TickCount Loop % TimesToRun {   out:=""""   for k,v in obj     out.=k ""`t"" v ""`n"" } forLoop:=A_TickCount-s s:=A_TickCount Loop % TimesToRun {   out:=""""   ObjDump(obj,var) } objDump:=A_TickCount-s MsgBox % ""For loop: "" forLoop ""`nObjDump: "" objDump ExitApp Top HotKeyIt Posts: 993 Joined: 29 Sep 2013, 18:35 Contact: Contact HotKeyIt Website Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 20 May 2014, 16:14 Update: Implemented obj-64 -> file -> obj-32 and the other way round. Use only the required memory for numbers(char,short,integer,int64,double). Changed to consume only one byte for data type. Additional parameter DumpBuffer, when 0/false (default) StrPut(value)*(A_IsUnicode?2:1) is used, eslse obj.GetCapacity(key) is used to dump all data for values. Note wrote:New ObjLoad() function is not compatible to the old functions and cannot load a file dumped with old ObjDump function. You can rename the old ObjLoad function to ObjLoad2 and run this with new ObjDump function: ObjDump(ObjLoad2(File),File) Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 20 May 2014, 20:44 Finally! I wanted this for quite a while, thanks HotkeyIt Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top arcticir Posts: 330 Joined: 17 Nov 2013, 11:32 Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 15 Aug 2014, 03:49 hi HotKeyIt I try to use this function to pass objects between processes，Use Help on OnMessage examples: The script stagnation, where the reason for this? Receive Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus #SingleInstance OnMessage(0x4a, ""Receive_WM_COPYDATA"")  ; 0x4a 为 WM_COPYDATA WinSetTitle, ahk_id %A_ScriptHwnd%, ,Receive return   Receive_WM_COPYDATA(wParam, lParam) { ToolTip,Receive_WM_COPYDATA j := ObjLoad(lParam,wParam) MsgBox % j.A } Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus TargetScriptTitle = Receive ahk_class AutoHotkey   F1:: obj:={a:1,b:2,c:[1,2,""test""],d:{a:0}} Size := ObjDump(obj,StringToSend) result := Send_WM_COPYDATA(StringToSend,Size, TargetScriptTitle)   return   Send_WM_COPYDATA(ByRef StringToSend,Size, ByRef TargetScriptTitle){     Prev_DetectHiddenWindows := A_DetectHiddenWindows     Prev_TitleMatchMode := A_TitleMatchMode     DetectHiddenWindows On     SetTitleMatchMode 2     SendMessage, 0x4a, Size, &CopyDataStruct,, %TargetScriptTitle%      DetectHiddenWindows %Prev_DetectHiddenWindows%     SetTitleMatchMode %Prev_TitleMatchMode%           return ErrorLevel } Top HotKeyIt Posts: 993 Joined: 29 Sep 2013, 18:35 Contact: Contact HotKeyIt Website Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 15 Aug 2014, 05:25 Enjoy DynaRun() Code: [Select all] [Expand] [Download] (WM_COPYOBJECT.ahk)GeSHi © Codebox Plus PID:=DynaRun("" ( #SingleInstance OnMessage(0x4a, """"ON_WM_COPYOBJECT"""")  ; 0x4a 为 WM_COPYDATA DetectHiddenWindows,On WinSetTitle, ahk_id `%A_ScriptHwnd`%, ,Receive return ON_WM_COPYOBJECT(wParam, lParam) {   j := ObjLoad(NumGet(lParam+A_PtrSize*2,""""PTR""""),NumGet(lParam + A_PtrSize,""""PTR""""))   MsgBox `% j.A """"``n"""" j.c.3 } )"")   TargetScriptTitle = Receive ahk_class AutoHotkey F1:: obj:={a:1,b:2,c:[1,2,""test""],d:{a:0}},Size := ObjDump(obj,DataToSend) result := WM_COPYOBJECT(TargetScriptTitle,&DataToSend,Size) return Esc:: Process,Close,%PID% ExitApp   WM_COPYOBJECT(Title, dwData, cbData) { 	static WM_COPYDATA := 0x4A     Prev_DetectHiddenWindows := A_DetectHiddenWindows     ,Prev_TitleMatchMode := A_TitleMatchMode     DetectHiddenWindows On     SetTitleMatchMode 2 	VarSetCapacity(COPYDATASTRUCT, 3*A_PtrSize, 0) 	,NumPut(dwData,  &COPYDATASTRUCT, 2*A_PtrSize,""PTR"") 	,NumPut(cbData,  &COPYDATASTRUCT, 1*A_PtrSize,""PTR"") 	SendMessage, %WM_COPYDATA%, 0, &COPYDATASTRUCT,,%title%     DetectHiddenWindows %Prev_DetectHiddenWindows%     ,SetTitleMatchMode %Prev_TitleMatchMode%    	return ErrorLevel == ""FAIL"" ? false : true } Top arcticir Posts: 330 Joined: 17 Nov 2013, 11:32 Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 15 Aug 2014, 08:59 Thanks. Incidentally: erratic Crash disappeared. expect H v1.1.15 ---------------------------- I try to use an object to pass parameters, but why not correct? Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus       obj:={a:A_TickCount} PID:=DynaRun(""MsgBox % Parameters.a"",1,obj) MsgBox,Test   DynaRun(s, pn:="""", pr:=""""){ ; s=Script,pn=PipeName,n:=,pr=Parameters,p1+p2=hPipes,P=PID    static AhkPath:="""""""" A_AhkPath """""""" (A_IsCompiled||(A_IsDll&&DllCall(A_AhkPath ""\ahkgetvar"",""Str"",""A_IsCompiled""))?"" /E"":"""") "" """"""    if (-1=p1 := DllCall(""CreateNamedPipe"",""str"",pf:=""\\.\pipe\"" (pn!=""""?pn:""AHK"" A_TickCount),""uint"",2,""uint"",0,""uint"",255,""uint"",0,""uint"",0,""Ptr"",0,""Ptr"",0))       || (-1=p2 := DllCall(""CreateNamedPipe"",""str"",pf,""uint"",2,""uint"",0,""uint"",255,""uint"",0,""uint"",0,""Ptr"",0,""Ptr"",0))       Return 0    ; allow compiled executable to execute dynamic scripts. Requires AHK_H    Run, % AhkPath pf """""" "" (IsObject(pr)?1:pr),,UseErrorLevel HIDE, P   if IsObject(pr) {   Size := ObjDump(pr,Data)     VarSetCapacity(COPYDATASTRUCT, 3*A_PtrSize, 0)     ,NumPut(&Data,  &COPYDATASTRUCT, 2*A_PtrSize,""PTR"")     ,NumPut(Size,  &COPYDATASTRUCT, 1*A_PtrSize,""PTR"") s:=""Parameters := ObjLoad(NumGet("" &COPYDATASTRUCT ""+A_PtrSize*2,""""PTR""""),NumGet("" &COPYDATASTRUCT "" + A_PtrSize,""""PTR""""))`n"" s }      If ErrorLevel       return 0,DllCall(""CloseHandle"",""Ptr"",p1),DllCall(""CloseHandle"",""Ptr"",p2)    DllCall(""ConnectNamedPipe"",""Ptr"",p1,""Ptr"",0),DllCall(""CloseHandle"",""Ptr"",p1),DllCall(""ConnectNamedPipe"",""Ptr"",p2,""Ptr"",0)    if !DllCall(""WriteFile"",""Ptr"",p2,""Wstr"",s:=(A_IsUnicode?chr(0xfeff):""﻿"") s,""UInt"",StrLen(s)*(A_IsUnicode ? 2 : 1)+(A_IsUnicode?4:6),""uint*"",0,""Ptr"",0)       P:=0    DllCall(""CloseHandle"",""Ptr"",p2)    Return P }     Top arcticir Posts: 330 Joined: 17 Nov 2013, 11:32 Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 15 Aug 2014, 16:30 我稍加修改，使之便于阅读，也许会提升些许效率。 I slightly modified to make it easier to read, and perhaps will increase a little efficiency. Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ObjDump(obj,ByRef var,mode:=0){ 	If IsObject(var) 	{ ; FileAppend mode 		If FileExist(obj) 		{ 			FileDelete,%obj% 			If ErrorLevel 				return 		} 		f:=FileOpen(obj,""rw-rwd""),VarSetCapacity(v,sz:=RawObjectSize(var,mode),0) 			,RawObject(var,&v,mode),count:=sz//65536,ptr:=&v 		Loop % count 			f.RawWrite(ptr+0,65536),ptr+=65536 		return sz,f.RawWrite(ptr+0,Mod(sz,65536)),f.Close() 	} 	else 		return sz,VarSetCapacity(var,sz:=RawObjectSize(obj,mode),0),RawObject(obj,&var,mode) }   RawObject(obj,addr,buf:=0){ 	; Type.Enum:    Char.1 UChar.2 Short.3 UShort.4 Int.5 UInt.6 Int64.7 UInt64.8 Double.9 String.10 Object.11 	for k,v in obj 	{ ; 9 = Int64 for size and Char for type 		(IsObject(k) 			? (NumPut(-11,addr+0,""Char""),NumPut(sz:=RawObjectSize(k,buf),addr+1,""UInt64""),RawObject(k,addr+9),addr+=sz+9) 			: (k+0="""") 				? (NumPut(-10,addr+0,""Char""),NumPut(StrPut(k,addr+9)*(A_IsUnicode?2:1),addr+1,""UInt64""),addr+=NumGet(addr+1,""UInt64"")+9) 				: (NumPut( InStr(k,""."")?-9:k>4294967295?-8:k>65535?-6:k>255?-4:k>-1?-2:k>-129?-1:k>-32769?-3:k>-2147483649?-5:-7,addr+0,""Char"") 					,NumPut(k,addr+1,InStr(k,""."")?""Double"":k>4294967295?""UInt64"":k>65535?""UInt"":k>255?""UShort"":k>-1?""UChar"":k>-129?""Char"":k>-32769?""Short"":k>-2147483649?""Int"":""Int64"") 					,addr+=InStr(k,""."")||k>4294967295?9:k>65535?5:k>255?3:k>-129?2:k>-32769?3:k>-2147483649?5:9))   		(IsObject(v) 			? (NumPut( 11,addr+0,""Char""),NumPut(sz:=RawObjectSize(v,buf),addr+1,""UInt64""),RawObject(v,addr+9),addr+=sz+9) 			: (v+0="""") 				? (NumPut( 10,addr+0,""Char""),NumPut(sz:=buf?obj.GetCapacity(k):StrPut(v)*(A_IsUnicode?2:1),addr+1,""Int64""),DllCall(""RtlMoveMemory"",""PTR"",addr+9,""PTR"",&v,""PTR"",sz),addr+=sz+9) 				: (NumPut( InStr(v,""."")?9:v>4294967295?8:v>65535?6:v>255?4:v>-1?2:v>-129?1:v>-32769?3:v>-2147483649?5:7,addr+0,""Char"") 					,NumPut(v,addr+1,InStr(v,""."")?""Double"":v>4294967295?""UInt64"":v>65535?""UInt"":v>255?""UShort"":v>-1?""UChar"":v>-129?""Char"":v>-32769?""Short"":v>-2147483649?""Int"":""Int64"") 					,addr+=InStr(v,""."")||v>4294967295?9:v>65535?5:v>255?3:v>-129?2:v>-32769?3:v>-2147483649?5:9))	     	} }   RawObjectSize(obj,buf:=0,sz:=0){ 	; 9 = Int64 for size and Char for type 	for k,v in obj 	{ 		sz +=(IsObject(k) 			? (RawObjectSize(k,buf)+9) : ((k+0="""") 				? (StrPut(k)*(A_IsUnicode?2:1)+9) 				: InStr(k,""."")||k>4294967295?9:k>65535?5:k>255?3:k>-129?2:k>-32769?3:k>-2147483649?5:9)) 		+(IsObject(v) 			?  RawObjectSize(v,buf)+9 : ((v+0="""") 				? (buf?obj.GetCapacity(k):StrPut(v)*(A_IsUnicode?2:1))+9 				: InStr(v,""."")||v>4294967295?9:v>65535?5:v>255?3:v>-129?2:v>-32769?3:v>-2147483649?5:9)) 	} 	return sz } Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ObjLoad(addr,sz:=""""){ 	; Arrays to retrieve type and size from number type 	static type:=[""Char"",""UChar"",""Short"",""UShort"",""Int"",""UInt"",""Int64"",""UInt64"",""Double""],num:=[1,1,2,2,4,4,8,8,8] 	end:=addr+sz, obj:=[] 	While % addr<end ; 9 = Int64 for size and Char for type 		k:=(NumGet(addr+0,""Char"")=-11 			? (ObjLoad(addr+9,sz:=NumGet(addr+1,""UInt64"")),addr+=sz+9) 			: NumGet(addr+0,""Char"")=-10 				? (StrGet(addr+9),addr+=NumGet(addr+1,""UInt64"")+9) 				: (NumGet(addr+1,type[sz:=-1*NumGet(addr+0,""Char"")]),addr+=num[sz]+1))   		,(NumGet(addr+0,""Char"")= 11 			? (obj[k]:=ObjLoad(addr+9,sz:=NumGet(addr+1,""PTR"")),addr+=sz+9)  			: NumGet(addr+0,""Char"")= 10 				? (obj.SetCapacity(k,sz:=NumGet(addr+1,""UInt64"")),DllCall(""RtlMoveMemory"",""PTR"",obj.GetAddress(k),""PTR"",addr+9,""PTR"",sz),addr+=sz+9) 				: (obj[k]:=NumGet(addr+1,type[sz:=NumGet(addr+0,""Char"")]),addr+=num[sz]+1))   	return obj }   ObjFileLoad(File){ 	If !FileExist(File) 		return 	FileGetSize,sz,% File 	FileRead,v,*c %File% 	If ErrorLevel||!sz 		return 	return ObjLoad(&v,sz) } In this example, about 500 milliseconds faster. Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; SetBatchLines, -1 ; uncomment when using AHK v1 ObjSize:=1000000 VarToUse:=""A_TickCount"" ; use A_TickCount, A_ScriptFullPath, A_Now ... TimesToRun:=1 obj:=[] Loop % ObjSize   obj[A_Index]:=%VarToUse% s:=A_TickCount Loop % TimesToRun {   out:=""""   for k,v in obj     out.=k ""`t"" v ""`n"" } forLoop:=A_TickCount-s s:=A_TickCount Loop % TimesToRun {   out:=""""   ObjDump(obj,var) } objDump:=A_TickCount-s MsgBox % ""For loop: "" forLoop ""`nObjDump: "" objDump ExitApp Top HotKeyIt Posts: 993 Joined: 29 Sep 2013, 18:35 Contact: Contact HotKeyIt Website Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 16 Aug 2014, 08:11 arcticir wrote:I try to use an object to pass parameters, but why not correct?Following DynaRun() versions will automatically convert obj to hex and create global A_Argv in new process containing a copy of the object: DynaRun_for_AutoHotkey_v1 Code: [Select all] [Expand] [Download] (DynaRun.ahk)GeSHi © Codebox Plus obj:={a:A_TickCount} Loop 255   obj[A_Index]:=Chr(A_Index) PID:=DynaRun(""MsgBox % A_Argv.a """"``n"""" A_Argv.65 A_Argv.72 A_Argv.75"",1,obj) Process,WaitClose,%PID%,5 Process,Close,%PID%   DynaRun(s, pn:="""", pr:=""""){ ; s=Script,pn=PipeName,n:=,pr=Parameters,p1+p2=hPipes,P=PID    static AhkPath:="""""""" A_AhkPath """""""" (A_IsCompiled||(A_IsDll&&DllCall(A_AhkPath ""\ahkgetvar"",""Str"",""A_IsCompiled""))?"" /E"":"""") "" """"""           ,h2o:=""B29C2D1CA2C24A57BC5E208EA09E162F(){`nPLACEHOLDERB29C2D1CA2C24A57BC5E208EA09E162FVarSetCapacity(dmp,sz:=StrLen(hex)//2,0)`nLoop,Parse,hex`nIf (""""""""!=h.=A_LoopField) && !Mod(A_Index,2)`nNumPut(""""0x"""" h,&dmp,A_Index/2-1,""""UChar""""),h:=""""""""`nreturn ObjLoad(&dmp,sz)`n}`n""    if (-1=p1 := DllCall(""CreateNamedPipe"",""str"",pf:=""\\.\pipe\"" (pn!=""""?pn:""AHK"" A_TickCount),""uint"",2,""uint"",0,""uint"",255,""uint"",0,""uint"",0,""Ptr"",0,""Ptr"",0))       || (-1=p2 := DllCall(""CreateNamedPipe"",""str"",pf,""uint"",2,""uint"",0,""uint"",255,""uint"",0,""uint"",0,""Ptr"",0,""Ptr"",0))       Return 0    ; allow compiled executable to execute dynamic scripts. Requires AHK_H    Run, % AhkPath pf """""" "" pr,,UseErrorLevel HIDE, P    If ErrorLevel       return 0,DllCall(""CloseHandle"",""Ptr"",p1),DllCall(""CloseHandle"",""Ptr"",p2)    DllCall(""ConnectNamedPipe"",""Ptr"",p1,""Ptr"",0),DllCall(""CloseHandle"",""Ptr"",p1),DllCall(""ConnectNamedPipe"",""Ptr"",p2,""Ptr"",0)    If IsObject(pr){     VarSetCapacity(buf,6),VarsetCapacity(val,8,0)     Loop % sz:=ObjDump(pr,dmp)       If NumPut(NumGet(&dmp,A_Index-1,""UChar""),&val,""UIn64"") && DllCall(""msvcrt\_vsnwprintf"",""Str"",buf,""ptr"",6,""str"",""`%02X"",""ptr"",&val)         hex.=buf     While % _hex:=SubStr(Hex,1 + (A_Index-1)*16370,16370)       _s.= ""hex"" (A_Index=1?"":"":""."") ""="""""" _hex """"""`n""     s:=h2o ""global A_Argv:=B29C2D1CA2C24A57BC5E208EA09E162F()`n"" s     StringReplace,s,s,PLACEHOLDERB29C2D1CA2C24A57BC5E208EA09E162F,%_s%    }    if !DllCall(""WriteFile"",""Ptr"",p2,""Wstr"",s:=(A_IsUnicode?chr(0xfeff):""﻿"") s,""UInt"",StrLen(s)*(A_IsUnicode ? 2 : 1)+(A_IsUnicode?4:6),""uint*"",0,""Ptr"",0)       P:=0    DllCall(""CloseHandle"",""Ptr"",p2)    Return P } DynaRun_for_AutoHotkey_v2 Code: [Select all] [Expand] [Download] (DynaRun.ahk)GeSHi © Codebox Plus obj:={a:A_TickCount} Loop 255   obj[A_Index]:=Chr(A_Index) PID:=DynaRun(""MsgBox `% A_Argv.a `""``n`"" A_Argv.65 A_Argv.72 A_Argv.75"",1,obj) ProcessWaitClose(PID,5) ProcessClose(PID)   DynaRun(s, pn:="""", pr:=""""){ ; s=Script,pn=PipeName,n:=,pr=Parameters,p1+p2=hPipes,P=PID    static AhkPath:=""`"""" A_AhkPath ""`"""" (A_IsCompiled||(A_IsDll&&DllCall(A_AhkPath ""\ahkgetvar"",""Str"",""A_IsCompiled""))?"" /E"":"""") "" `""""           ,h2o:=""B29C2D1CA2C24A57BC5E208EA09E162F(){`nPLACEHOLDERB29C2D1CA2C24A57BC5E208EA09E162FVarSetCapacity(dmp,sz:=StrLen(hex)//2,0)`nLoopParse,`%hex`%`nIf (`""`""!=h.=A_LoopField) && !Mod(A_Index,2)`nNumPut(`""0x`"" h,&dmp,A_Index/2-1,`""UChar`""),h:=`""`""`nreturn ObjLoad(&dmp,sz)`n}`n""    if (-1=p1 := DllCall(""CreateNamedPipe"",""str"",pf:=""\\.\pipe\"" (pn!=""""?pn:""AHK"" A_TickCount),""uint"",2,""uint"",0,""uint"",255,""uint"",0,""uint"",0,""Ptr"",0,""Ptr"",0))       || (-1=p2 := DllCall(""CreateNamedPipe"",""str"",pf,""uint"",2,""uint"",0,""uint"",255,""uint"",0,""uint"",0,""Ptr"",0,""Ptr"",0))       Return 0    ; allow compiled executable to execute dynamic scripts. Requires AHK_H    Run, % AhkPath pf ""`"" "" pr,,UseErrorLevel HIDE, P    If ErrorLevel       return 0,DllCall(""CloseHandle"",""Ptr"",p1),DllCall(""CloseHandle"",""Ptr"",p2)    DllCall(""ConnectNamedPipe"",""Ptr"",p1,""Ptr"",0),DllCall(""CloseHandle"",""Ptr"",p1),DllCall(""ConnectNamedPipe"",""Ptr"",p2,""Ptr"",0)    If IsObject(pr){     VarSetCapacity(buf,6),VarsetCapacity(val,8,0)     Loop % sz:=ObjDump(pr,dmp)       If NumPut(NumGet(&dmp,A_Index-1,""UChar""),&val,""UIn64"") && DllCall(""msvcrt\_vsnwprintf"",""Str"",buf,""ptr"",6,""str"",""`%02X"",""ptr"",&val,""Cdecl"")         hex.=buf     While % _hex:=SubStr(Hex,1 + (A_Index-1)*16370,16370)       _s.= ""hex"" (A_Index=1?"":"":""."") ""=`"""" _hex ""`""`n""     s:=StrReplace(h2o,""PLACEHOLDERB29C2D1CA2C24A57BC5E208EA09E162F"",_s) ""global A_Argv:=B29C2D1CA2C24A57BC5E208EA09E162F()`n"" s    }    if !DllCall(""WriteFile"",""Ptr"",p2,""Wstr"",s:=(A_IsUnicode?chr(0xfeff):""﻿"") s,""UInt"",StrLen(s)*(A_IsUnicode ? 2 : 1)+(A_IsUnicode?4:6),""uint*"",0,""Ptr"",0)       P:=0    DllCall(""CloseHandle"",""Ptr"",p2)    Return P } Top nnnik Posts: 1409 Joined: 30 Sep 2013, 01:01 Location: Germany Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 16 Aug 2014, 08:27 HotKeyIt these spoilers make it impossible to read anything. So I changed them. I am not afraid of many things. But I do fear fear. Top HotKeyIt Posts: 993 Joined: 29 Sep 2013, 18:35 Contact: Contact HotKeyIt Website Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 16 Aug 2014, 09:23 My fault, thanks nnnik For reference: ObjToHex() and HexToObj(). AutoHotkey_v1 Code: [Select all] [Download] (ObjToHex.ahk)GeSHi © Codebox Plus ObjToHex(obj){     Loop % sz:=ObjDump(obj,dmp)       if NumPut(NumGet(&dmp,A_Index-1,""UChar""),&val,""UIn64"") && DllCall(""msvcrt\_vsnwprintf"",""Str"",buf,""ptr"",6,""str"",""`%02X"",""ptr"",&val,""Cdecl"")         hex.=format(""{1:02X}"",NumGet(&dmp,A_Index-1,""UChar""))     return hex } Code: [Select all] [Download] (HexToObj.ahk)GeSHi © Codebox Plus HexToObj(hex){   VarSetCapacity(dmp,sz:=StrLen(hex)//2)   Loop,Parse,hex     If (""""!=h.=A_LoopField) && !Mod(A_Index,2)       NumPut(""0x"" h,&dmp,A_Index/2-1,""UChar""),h:=""""   return ObjLoad(&dmp,sz) }   AutoHotkey_v2 Code: [Select all] [Download] (ObjToHex.ahk)GeSHi © Codebox Plus ObjToHex(obj){     static buf,val,init:=VarSetCapacity(buf,6) VarsetCapacity(val,8,0)     Loop % sz:=ObjDump(obj,dmp)       if NumPut(NumGet(&dmp,A_Index-1,""UChar""),&val,""UIn64"") && DllCall(""msvcrt\_vsnwprintf"",""Str"",buf,""ptr"",6,""str"",""`%02X"",""ptr"",&val,""Cdecl"")         hex.=buf     return hex } Code: [Select all] [Download] (HexToObj.ahk)GeSHi © Codebox Plus HexToObj(hex){   VarSetCapacity(dmp,sz:=StrLen(hex)//2)   LoopParse,%hex%     If (""""!=h.=A_LoopField) && !Mod(A_Index,2)       NumPut(""0x"" h,&dmp,A_Index/2-1,""UChar""),h:=""""   return ObjLoad(&dmp,sz) } Top arcticir Posts: 330 Joined: 17 Nov 2013, 11:32 Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 16 Aug 2014, 09:28 Is it necessary? Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus Run, % AhkPath pf """""" "" (IsObject(pr) ? """": pr),,UseErrorLevel HIDE, P In addition, Is it possible also add this to BinRun, relatively speaking, I am more like BinRun. Run BinRun Mouse does not appear funnel. Top HotKeyIt Posts: 993 Joined: 29 Sep 2013, 18:35 Contact: Contact HotKeyIt Website Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 16 Aug 2014, 12:02 arcticir wrote:Is it necessary? Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus Run, % AhkPath pf """""" "" (IsObject(pr) ? """": pr),,UseErrorLevel HIDE, PNo. In addition, Is it possible also add this to BinRun, relatively speaking, I am more like BinRun. Sure BinRun_for_AutoHotkey_v1 Code: [Select all] [Expand] [Download] (BinRun.ahk)GeSHi © Codebox Plus FileRead,file,*c %A_AhkPath% BinRun(&file,""`nMsgBox `% A_Argv.a"",{a:""Hello World!""})   #Include <_Struct> Class _BinRun {   static IMAGE_DOS_HEADER :=""   (     WORD   e_magic;                     // Magic number     WORD   e_cblp;                      // Bytes on last page of file     WORD   e_cp;                        // Pages in file     WORD   e_crlc;                      // Relocations     WORD   e_cparhdr;                   // Size of header in paragraphs     WORD   e_minalloc;                  // Minimum extra paragraphs needed     WORD   e_maxalloc;                  // Maximum extra paragraphs needed     WORD   e_ss;                        // Initial (relative) SS value     WORD   e_sp;                        // Initial SP value     WORD   e_csum;                      // Checksum     WORD   e_ip;                        // Initial IP value     WORD   e_cs;                        // Initial (relative) CS value     WORD   e_lfarlc;                    // File address of relocation table     WORD   e_ovno;                      // Overlay number     WORD   e_res[4];                    // Reserved words     WORD   e_oemid;                     // OEM identifier (for e_oeminfo)     WORD   e_oeminfo;                   // OEM information; e_oemid specific     WORD   e_res2[10];                  // Reserved words     LONG   e_lfanew;                    // File address of new exe header   )""   ,IMAGE_FILE_HEADER :=""   (     WORD    Machine;     WORD    NumberOfSections;     DWORD   TimeDateStamp;     DWORD   PointerToSymbolTable;     DWORD   NumberOfSymbols;     WORD    SizeOfOptionalHeader;     WORD    Characteristics;   )""   ,IMAGE_DATA_DIRECTORY :=""   (     DWORD   VirtualAddress;     DWORD   Size;   )""   ,IMAGE_OPTIONAL_HEADER64:=""   (     WORD        Magic;     BYTE        MajorLinkerVersion;     BYTE        MinorLinkerVersion;     DWORD       SizeOfCode;     DWORD       SizeOfInitializedData;     DWORD       SizeOfUninitializedData;     DWORD       AddressOfEntryPoint;     DWORD       BaseOfCode;     ULONGLONG   ImageBase;     DWORD       SectionAlignment;     DWORD       FileAlignment;     WORD        MajorOperatingSystemVersion;     WORD        MinorOperatingSystemVersion;     WORD        MajorImageVersion;     WORD        MinorImageVersion;     WORD        MajorSubsystemVersion;     WORD        MinorSubsystemVersion;     DWORD       Win32VersionValue;     DWORD       SizeOfImage;     DWORD       SizeOfHeaders;     DWORD       CheckSum;     WORD        Subsystem;     WORD        DllCharacteristics;     ULONGLONG   SizeOfStackReserve;     ULONGLONG   SizeOfStackCommit;     ULONGLONG   SizeOfHeapReserve;     ULONGLONG   SizeOfHeapCommit;     DWORD       LoaderFlags;     DWORD       NumberOfRvaAndSizes;     _BinRun.IMAGE_DATA_DIRECTORY DataDirectory[16]; // IMAGE_NUMBEROF_DIRECTORY_ENTRIES   )""   ,IMAGE_OPTIONAL_HEADER32 :=""   (     WORD    Magic;     BYTE    MajorLinkerVersion;     BYTE    MinorLinkerVersion;     DWORD   SizeOfCode;     DWORD   SizeOfInitializedData;     DWORD   SizeOfUninitializedData;     DWORD   AddressOfEntryPoint;     DWORD   BaseOfCode;     DWORD   BaseOfData;     DWORD   ImageBase;     DWORD   SectionAlignment;     DWORD   FileAlignment;     WORD    MajorOperatingSystemVersion;     WORD    MinorOperatingSystemVersion;     WORD    MajorImageVersion;     WORD    MinorImageVersion;     WORD    MajorSubsystemVersion;     WORD    MinorSubsystemVersion;     DWORD   Win32VersionValue;     DWORD   SizeOfImage;     DWORD   SizeOfHeaders;     DWORD   CheckSum;     WORD    Subsystem;     WORD    DllCharacteristics;     DWORD   SizeOfStackReserve;     DWORD   SizeOfStackCommit;     DWORD   SizeOfHeapReserve;     DWORD   SizeOfHeapCommit;     DWORD   LoaderFlags;     DWORD   NumberOfRvaAndSizes;     _BinRun.IMAGE_DATA_DIRECTORY DataDirectory[16]; //IMAGE_NUMBEROF_DIRECTORY_ENTRIES   )""   ,IMAGE_NT_HEADERS:=""   (     DWORD Signature;     _BinRun.IMAGE_FILE_HEADER FileHeader;     _BinRun.IMAGE_OPTIONAL_HEADER"" (A_PtrSize=8?64:32) "" OptionalHeader;   )""   ,IMAGE_NT_HEADERS32:=""   (     DWORD Signature;     _BinRun.IMAGE_FILE_HEADER FileHeader;     _BinRun.IMAGE_OPTIONAL_HEADER32 OptionalHeader;   )""   ,IMAGE_NT_HEADERS64:=""   (     DWORD Signature;     _BinRun.IMAGE_FILE_HEADER FileHeader;     _BinRun.IMAGE_OPTIONAL_HEADER64 OptionalHeader;   )""   ,IMAGE_SECTION_HEADER:=""   (     BYTE    Name[8];     union {         DWORD   PhysicalAddress;         DWORD   VirtualSize;     };     DWORD   VirtualAddress;     DWORD   SizeOfRawData;     DWORD   PointerToRawData;     DWORD   PointerToRelocations;     DWORD   PointerToLinenumbers;     WORD    NumberOfRelocations;     WORD    NumberOfLinenumbers;     DWORD   Characteristics;   )""   ,FLOATING_SAVE_AREA :=""   (     DWORD   ControlWord;     DWORD   StatusWord;     DWORD   TagWord;     DWORD   ErrorOffset;     DWORD   ErrorSelector;     DWORD   DataOffset;     DWORD   DataSelector;     BYTE    RegisterArea[80]; //SIZE_OF_80387_REGISTERS     DWORD   Cr0NpxState;   )""   ,PROCESS_INFORMATION :=""   (     HANDLE hProcess;     HANDLE hThread;     DWORD  dwProcessId;     DWORD  dwThreadId;   )""   ,STARTUPINFO :=""   (     DWORD  cb;     LPTSTR lpReserved;     LPTSTR lpDesktop;     LPTSTR lpTitle;     DWORD  dwX;     DWORD  dwY;     DWORD  dwXSize;     DWORD  dwYSize;     DWORD  dwXCountChars;     DWORD  dwYCountChars;     DWORD  dwFillAttribute;     DWORD  dwFlags;     WORD   wShowWindow;     WORD   cbReserved2;     LPBYTE lpReserved2;     HANDLE hStdInput;     HANDLE hStdOutput;     HANDLE hStdError;   )""   ,M128A:=""ULONGLONG Low;LONGLONG High""   ,_XMM_SAVE_AREA32 :=""   (       WORD ControlWord;       WORD StatusWord;       BYTE TagWord;       BYTE Reserved1;       WORD ErrorOpcode;       DWORD ErrorOffset;       WORD ErrorSelector;       WORD Reserved2;       DWORD DataOffset;       WORD DataSelector;       WORD Reserved3;       DWORD MxCsr;       DWORD MxCsr_Mask;       _BinRun.M128A FloatRegisters[8];       _BinRun.M128A XmmRegisters[16];       BYTE Reserved4[96];   )""   ,CONTEXT64:=""   (       DWORD64 P1Home;       DWORD64 P2Home;       DWORD64 P3Home;       DWORD64 P4Home;       DWORD64 P5Home;       DWORD64 P6Home;       DWORD ContextFlags;       DWORD MxCsr;       WORD SegCs;            WORD SegDs;            WORD SegEs;            WORD SegFs;            WORD SegGs;            WORD SegSs;            DWORD EFlags;          DWORD64 Dr0;           DWORD64 Dr1;           DWORD64 Dr2;           DWORD64 Dr3;           DWORD64 Dr6;           DWORD64 Dr7;           DWORD64 Rax;           DWORD64 Rcx;           DWORD64 Rdx;           DWORD64 Rbx;           DWORD64 Rsp;           DWORD64 Rbp;           DWORD64 Rsi;           DWORD64 Rdi;           DWORD64 R8;            DWORD64 R9;            DWORD64 R10;           DWORD64 R11;           DWORD64 R12;           DWORD64 R13;           DWORD64 R14;           DWORD64 R15;           DWORD64 Rip;           union {           _BinRun._XMM_SAVE_AREA32 FltSave;           struct {               _BinRun.M128A Header[2];                   _BinRun.M128A Legacy[8];                   _BinRun.M128A Xmm0;                        _BinRun.M128A Xmm1;                        _BinRun.M128A Xmm2;                        _BinRun.M128A Xmm3;                        _BinRun.M128A Xmm4;                        _BinRun.M128A Xmm5;                        _BinRun.M128A Xmm6;                        _BinRun.M128A Xmm7;                        _BinRun.M128A Xmm8;                        _BinRun.M128A Xmm9;                        _BinRun.M128A Xmm10;                       _BinRun.M128A Xmm11;                       _BinRun.M128A Xmm12;                       _BinRun.M128A Xmm13;                       _BinRun.M128A Xmm14;                       _BinRun.M128A Xmm15;                   };       };       _BinRun.M128A VectorRegister[26];          DWORD64 VectorControl;             DWORD64 DebugControl;              DWORD64 LastBranchToRip;           DWORD64 LastBranchFromRip;         DWORD64 LastExceptionToRip;        DWORD64 LastExceptionFromRip;   )""   ,CONTEXT32:=""   (     DWORD ContextFlags;     DWORD   Dr0;     DWORD   Dr1;     DWORD   Dr2;     DWORD   Dr3;     DWORD   Dr6;     DWORD   Dr7;     _BinRun.FLOATING_SAVE_AREA FloatSave;     DWORD   SegGs;     DWORD   SegFs;     DWORD   SegEs;     DWORD   SegDs;     DWORD   Edi;     DWORD   Esi;     DWORD   Ebx;     DWORD   Edx;     DWORD   Ecx;     DWORD   Eax;     DWORD   Ebp;     DWORD   Eip;     DWORD   SegCs;              // MUST BE SANITIZED     DWORD   EFlags;             // MUST BE SANITIZED     DWORD   Esp;     DWORD   SegSs;     BYTE    ExtendedRegisters[512]; // MAXIMUM_SUPPORTED_EXTENSION   )""   __New(pData,cmdLine="""",cmdLineScript="""",ExeToUse=""""){     static IMAGE_NT_SIGNATURE:=17744,IMAGE_DOS_SIGNATURE:=23117,PAGE_EXECUTE_READWRITE:=64,CREATE_SUSPENDED:=4           ,MEM_COMMIT:=4096,MEM_RESERVE:=8192           ,h2o:=""B29C2D1CA2C24A57BC5E208EA09E162F(){`nPLACEHOLDERB29C2D1CA2C24A57BC5E208EA09E162FVarSetCapacity(dmp,sz:=StrLen(hex)//2,0)`nLoop,Parse,hex`nIf (""""""""!=h.=A_LoopField) && !Mod(A_Index,2)`nNumPut(""""0x"""" h,&dmp,A_Index/2-1,""""UChar""""),h:=""""""""`nreturn ObjLoad(&dmp,sz)`n}`n""     If pData       If pData is not digit       {	         ; Try first reading the file from Resource         If res := DllCall(""FindResource"",""PTR"",lib:=DllCall(""GetModuleHandle"",""PTR"",0,""PTR""),""Str"",pData,""PTR"",10,""PTR"")           VarSetCapacity(data,sz :=DllCall(""SizeofResource"",""PTR"",lib,""PTR"",res))           ,DllCall(""RtlMoveMemory"",""PTR"",&data,""PTR"",DllCall(""LockResource"",""PTR"",hres:=DllCall(""LoadResource"",""PTR"",lib,""PTR"",res,""PTR""),""PTR""),""PTR"",sz)           ,DllCall(""FreeResource"",""PTR"",hres)           ,BinRun_Uncompress(data)         else ; else try reading file from disc etc...           FileRead,Data,*c %pData%         pData:=&Data       }       If InStr(cmdLine,""`n""){ ; a script was given, first line contains the cmdLine       PipeName := ""\\.\pipe\AHK"" A_TickCount       __PIPE_GA_ := DllCall(""CreateNamedPipe"",""str"",PipeName,""UInt"",2,""UInt"",0,""UInt"",255,""UInt"",0,""UInt"",0,""PTR"",0,""PTR"",0)       __PIPE_    := DllCall(""CreateNamedPipe"",""str"",PipeName,""UInt"",2,""UInt"",0,""UInt"",255,""UInt"",0,""UInt"",0,""PTR"",0,""PTR"",0)       if (__PIPE_=-1 or __PIPE_GA_=-1)         Return 0       Script:=SubStr(cmdLine,InStr(cmdLine,""`n"")+1)       cmdLine:=Trim(SubStr(cmdLine,1,InStr(cmdLine,""`n"")),""`n`r"") A_Space PipeName     }       IDH:=new _Struct(_BinRun.IMAGE_DOS_HEADER,pData)     if (IDH.e_magic != IMAGE_DOS_SIGNATURE){       MsgBox ERROR: e_magic not found       return     }     INH := new _Struct(_BinRun.IMAGE_NT_HEADERS,pData + IDH.e_lfanew)       if (INH.Signature != IMAGE_NT_SIGNATURE){       MsgBox ERROR: Signature not found       return     }         If (A_PtrSize=8&&INH.OptionalHeader.magic=267) ; x86 on x64       pNtHeader:=new _Struct(_BinRun.IMAGE_NT_HEADERS32,pData + IDH.e_lfanew),ctx:=new _Struct(_BinRun.Context32),Force32Bit:=1       ,ctx.ContextFlags := (A_PtrSize=8?0x100000:0x10000) | 0x2 ;CONTEXT_INTEGER       ,UsedExe:=ExeToUse?ExeToUse:A_WinDir ""\Microsoft.NET\Framework\v2.0.50727\vbc.exe""     else if (A_PtrSize=4&&INH.OptionalHeader.magic=523) ; x64 on x86 not possible       Return false     else       pNtHeader:=INH,UsedExe:=ExeToUse?ExeToUse:A_IsCompiled?A_ScriptFullPath:A_AhkPath       ,ctx:=new _Struct(A_PtrSize=8?_BinRun.Context64:_BinRun.Context32),ctx.ContextFlags := (A_PtrSize=8?0x100000:0x10000) | 0x2 ;CONTEXT_INTEGER     pi:=new _Struct(_BinRun.PROCESS_INFORMATION)     si:=new _Struct(_BinRun.STARTUPINFO),si.cb:=sizeof(si)     if DllCall(""CreateProcess"",""PTR"",0,""STR"","""""""" UsedExe """""""" A_Space cmdLine (cmdLineScript?A_Space cmdLineScript:"""")               ,""PTR"",0,""PTR"",0,""int"",0,""Int"",CREATE_SUSPENDED,""PTR"",0,""PTR"",0,""PTR"",si[],""PTR"",pi[]){         if DllCall((Force32Bit?""Wow64"":"""") ""GetThreadContext"",""PTR"",pi.hThread,""PTR"", ctx[]){             pPebImageBase:=ctx[A_PtrSize=8&&!Force32Bit?""Rdx"":""Ebx""] + (Force32Bit?4:A_PtrSize)*2             if DllCall(""ReadProcessMemory"",""PTR"",pi.hProcess, ""PTR"", pPebImageBase,""PTR*"", dwImagebase,""PTR"", (Force32Bit?4:A_PtrSize),""Uint*"",NumberOfBytes){                 DllCall(""ntdll\NtUnmapViewOfSection"",""PTR"",pi.hProcess, ""PTR"",dwImagebase)                 pImagebase := DllCall(""VirtualAllocEx"",""PTR"",pi.hProcess, ""PTR"",pNtHeader.OptionalHeader.ImageBase, ""PTR"",pNtHeader.OptionalHeader.SizeOfImage,""UInt"", MEM_COMMIT|MEM_RESERVE,""UInt"", PAGE_EXECUTE_READWRITE,""PTR"")                 if (pImagebase)                 {                     if DllCall(""WriteProcessMemory"",""PTR"",pi.hProcess,""PTR"",pImagebase,""PTR"",pData,""PTR"",pNtHeader.OptionalHeader.SizeOfHeaders,""UInt*"",NumberOfBytes){                         pSecHeader :=new _Struct(_BinRun.IMAGE_SECTION_HEADER)                         pSecHeader[] :=pNtHeader.OptionalHeader[""""]+pNtHeader.FileHeader.SizeOfOptionalHeader                         counter := 0                         while (++counter < pNtHeader.FileHeader.NumberOfSections+1){                             DllCall(""WriteProcessMemory"",""PTR"",pi.hProcess,""PTR"",pImagebase + pSecHeader.VirtualAddress,""PTR"",pData + pSecHeader.PointerToRawData,""PTR"",pSecHeader.SizeOfRawData,""UInt*"", NumberOfBytes)                             pSecHeader[]:=pSecHeader[]+sizeof(pSecHeader)                         }                         if DllCall(""WriteProcessMemory"",""PTR"",pi.hProcess,""PTR"",pPebImageBase,""PTR"",pNtHeader.OptionalHeader.ImageBase[""""],""PTR"",(Force32Bit?4:A_PtrSize),""UInt*"",NumberOfBytes){                             ctx[A_PtrSize=8&&!Force32Bit?""Rcx"":""Eax""] := pImagebase + pNtHeader.OptionalHeader.AddressOfEntryPoint                             if DllCall((Force32Bit?""Wow64"":"""") ""SetThreadContext"",""PTR"",pi.hThread, ""PTR"",ctx[]){                                 if DllCall(""ResumeThread"",""PTR"",pi.hThread){                                   if (Script){ ; use pipe to pass script to new executable                                     If IsObject(cmdLineScript){                                       VarSetCapacity(buf,6),VarsetCapacity(val,8,0)                                       Loop % sz:=ObjDump(cmdLineScript,dmp)                                         If NumPut(NumGet(&dmp,A_Index-1,""UChar""),&val,""UIn64"") && DllCall(""msvcrt\_vsnwprintf"",""Str"",buf,""ptr"",6,""str"",""`%02X"",""ptr"",&val)                                           hex.=buf                                       While % _hex:=SubStr(Hex,1 + (A_Index-1)*16370,16370)                                         _s.= ""hex"" (A_Index=1?"":"":""."") ""="""""" _hex """"""`n""                                       script:=h2o ""global A_Argv:=B29C2D1CA2C24A57BC5E208EA09E162F()`n"" script                                       StringReplace,script,script,PLACEHOLDERB29C2D1CA2C24A57BC5E208EA09E162F,%_s%                                     }                                     DllCall(""ConnectNamedPipe"",""PTR"",__PIPE_GA_,""PTR"",0)                                     DllCall(""CloseHandle"",""PTR"",__PIPE_GA_)                                     DllCall(""ConnectNamedPipe"",""PTR"",__PIPE_,""PTR"",0)                                     if !DllCall(""WriteFile"",""PTR"",__PIPE_,""str"",(A_IsUnicode ? chr(0xfeff) : (chr(239) . chr(187) . chr(191))) script                                                 ,""UInt"",(StrLen(script))*(A_IsUnicode ? 2 : 1)+(A_IsUnicode?4:6),""UInt*"",0,""PTR"",0)                                       Return DllCall(""CloseHandle"",""PTR"",__PIPE_),0                                     DllCall(""CloseHandle"",""PTR"",__PIPE_)                                   }                                   return pi.dwProcessId                                 }                             }                         }                     }                 }             }         }         DllCall(""TerminateProcess"",""PTR"",pi.hProcess,""UInt"", 0)     }     return FALSE   } } BinRun(pData,cmdLine="""",cmdLineScript="""",ExeToUse=""""){   return new _BinRun(pData,cmdLine,cmdLineScript,ExeToUse) } BinRun_Uncompress( ByRef D ) {  ; Shortcode version of VarZ_Decompress() of VarZ 2.0 wrapper ; VarZ 2.0 by SKAN, 27-Sep-2012. http://www.autohotkey.com/community/viewtopic.php?t=45559  IfNotEqual, A_Tab, % ID:=NumGet(D,""UInt""), IfNotEqual, ID, 0x5F5A4C,  Return 0, ErrorLevel := -1  savedHash := NumGet(D,4,""UInt""), TZ := NumGet(D,10,""UInt""), DZ := NumGet(D,14,""UInt"")  DllCall( ""shlwapi\HashData"", UInt,&D+8, UInt,DZ+10, UIntP,Hash, UInt,4 )  IfNotEqual, Hash, %savedHash%, Return 0, ErrorLevel := -2  VarSetCapacity( TD,TZ,0 ), NTSTATUS := DllCall( ""ntdll\RtlDecompressBuffer"", UShort  , NumGet(D,8,""UShort""), PTR, &TD, UInt,TZ, PTR,&D+18, UInt,DZ, UIntP,Final, UInt )  IfNotEqual, NTSTATUS, 0, Return 0, ErrorLevel := NTSTATUS  VarSetCapacity( D,Final,0 ), DllCall( ""RtlMoveMemory"", PTR,&D, PTR,&TD, PTR,Final )  If NumGet(D,""UInt"")=0x315F5A4C && NumPut(0x005F5A4C,D,""UInt"")   Return BinRun_Uncompress( D ) Return Final, VarSetCapacity( D,-1 ) } Top arcticir Posts: 330 Joined: 17 Nov 2013, 11:32 Re: [Lib] ObjDump / ObjLoad - Object Backup Report this post Quote 16 Aug 2014, 12:54 Thanks. Can I request a more concise BinRun It？ only for AHK_H，I have never used other versions loaded BinRun only load AHKH. EXE, I only used to load AHKH.EXE， not loaded over other software and will AHK. EXE stored in the variable, so that the next call. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 47 posts 1 2 3 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: pondermatic and 14 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by HotKeyIt - Serialize/deserialize object to/from variable/memory."	"true"
"Data format"	"SerDes"	"https://github.com/cocobelgica/AutoHotkey-SerDes"	"by cocobelgica - Serialize / de-serialize an AutoHotkey object structure. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"2"	"1"	"2"	"GitHub - cocobelgica/AutoHotkey-SerDes: Serialize / de-serialize an AutoHotkey object structure Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 1 Star 2 Fork 2 cocobelgica/AutoHotkey-SerDes Code Issues 0 Pull requests 2 Pulse Graphs Serialize / de-serialize an AutoHotkey object structure 10 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Fetching latest commit… Cannot retrieve the latest commit at this time. Permalink Failed to load latest commit information. README.md SerDes.ahk README.md SerDes Serialize / de-serialize an AutoHotkey object structure. Requires AHK v1.1+ OR v2.0-a049+ License: WTFPL Serialize Syntax str   := SerDes( obj [ ,, indent := """" ] ) bytes := SerDes( obj, outfile [ , indent := """" ] )  Parameters str      [retval]   - String representation of the object bytes    [retval]   - Bytes written to 'outfile'. obj      [in]       - AHK object to serialize. outfile  [in, opt]  - The file to write to. If no absolute path is specified, %A_WorkingDir% is used. indent   [in, opt]  - If indent is an integer or string, then array elements and object members will                       be pretty-printed with that indent level. Blank(""""), the default, OR 0, selects                       the most compact representation. Using an integer indent indents that many spaces                       per level. If indent is a string, (such as ""`t""), that string is used to indent                       each level. Negative integer is treated as positive.  Deserialize Syntax obj   := SerDes( src )  Parameters obj      [retval]   - An AHK object src      [in]       - Either a 'SerDes()' formatted string or the path to the file containing 'SerDes()' formatted text.  Remarks: Serilaized output is similar to JSON except for escape sequences which follows AHK's specification. Also, strings, numbers and objects are allowed as object/{} keys unlike JSON which restricts it to string data type only. Non-standard AHK objects such as COM, Func, FileObject, RegExMatchObject are not supported. Object references, including circular ones, are supported and notated as $n, where n is the 1-based index of the referenced object in the heirarchy tree when encountered during enumeration (for-loop) OR as it appears from left to right (for string representation) as marked by an opening brace{ or bracket[. 1         2 { ""key1"": [""Hello World""], ""key2"": $2 } // -> $2 references the object stored in 'key1' Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/cocobelgica/AutoHotkey-SerDes"	"by cocobelgica - Serialize / de-serialize an AutoHotkey object structure. Forum thread:."	"true"
"Data format"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=4212"	"by cocobelgica - Serialize / de-serialize an AutoHotkey object structure. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"2"	"1"	"2"	"GitHub - cocobelgica/AutoHotkey-SerDes: Serialize / de-serialize an AutoHotkey object structure Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 1 Star 2 Fork 2 cocobelgica/AutoHotkey-SerDes Code Issues 0 Pull requests 2 Pulse Graphs Serialize / de-serialize an AutoHotkey object structure 10 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Fetching latest commit… Cannot retrieve the latest commit at this time. Permalink Failed to load latest commit information. README.md SerDes.ahk README.md SerDes Serialize / de-serialize an AutoHotkey object structure. Requires AHK v1.1+ OR v2.0-a049+ License: WTFPL Serialize Syntax str   := SerDes( obj [ ,, indent := """" ] ) bytes := SerDes( obj, outfile [ , indent := """" ] )  Parameters str      [retval]   - String representation of the object bytes    [retval]   - Bytes written to 'outfile'. obj      [in]       - AHK object to serialize. outfile  [in, opt]  - The file to write to. If no absolute path is specified, %A_WorkingDir% is used. indent   [in, opt]  - If indent is an integer or string, then array elements and object members will                       be pretty-printed with that indent level. Blank(""""), the default, OR 0, selects                       the most compact representation. Using an integer indent indents that many spaces                       per level. If indent is a string, (such as ""`t""), that string is used to indent                       each level. Negative integer is treated as positive.  Deserialize Syntax obj   := SerDes( src )  Parameters obj      [retval]   - An AHK object src      [in]       - Either a 'SerDes()' formatted string or the path to the file containing 'SerDes()' formatted text.  Remarks: Serilaized output is similar to JSON except for escape sequences which follows AHK's specification. Also, strings, numbers and objects are allowed as object/{} keys unlike JSON which restricts it to string data type only. Non-standard AHK objects such as COM, Func, FileObject, RegExMatchObject are not supported. Object references, including circular ones, are supported and notated as $n, where n is the 1-based index of the referenced object in the heirarchy tree when encountered during enumeration (for-loop) OR as it appears from left to right (for string representation) as marked by an opening brace{ or bracket[. 1         2 { ""key1"": [""Hello World""], ""key2"": $2 } // -> $2 references the object stored in 'key1' Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/cocobelgica/AutoHotkey-SerDes"	"by cocobelgica - Serialize / de-serialize an AutoHotkey object structure. Forum thread:."	"true"
"Data format"	"XA"	"https://github.com/hi5/CL3/blob/master/lib/XA.ahk"	"by trueski/hi5 - Serialize/deserialize array to/from xml. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"3"	"3"	"2"	"CL3/XA.ahk at master · hi5/CL3 · GitHub Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 3 Star 3 Fork 2 hi5/CL3 Code Issues 0 Pull requests 0 Wiki Pulse Graphs Permalink Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show Find file Copy path CL3/lib/XA.ahk Fetching contributors… Cannot retrieve contributors at this time Raw Blame History 189 lines (153 sloc) 4.96 KB /* Save/Load Arrays - trueski - http://www.autohotkey.com/board/topic/85461-ahk-l-saveload-arrays/ Examples: XA_Save(""Array"", Path) ; put variable name in quotes XA_Load(Path) ; the name of the variable containing the array is returned Note: indented code to personal pref. */ XA_Save(Array, Path) { FileDelete, % Path FileAppend, % ""<?xml version=""""1.0"""" encoding=""""UTF-8""""?>`n<"" . Array . "">`n"" . XA_ArrayToXML(Array) . ""`n</"" . Array . "">"", % Path, UTF-8 If (ErrorLevel) Return 1 Return 0 } XA_Load(Path) { Local XMLText, XMLObj, XMLRoot, Root1, Root2 If (!FileExist(Path)) Return 1 FileRead, XMLText, % Path StringReplace, XMLText, XMLText, %A_Space%&%A_Space%, %A_Space%&amp;%A_Space%, All ; dirty hack XMLObj := XA_LoadXML(XMLText) XMLObj := XMLObj.selectSingleNode(""/*"") ; */ XMLRoot := XMLObj.nodeName %XMLRoot% := XA_XMLToArray(XMLObj.childNodes) Return XMLRoot } XA_XMLToArray(nodes, NodeName="""") { Obj := Object() for node in nodes { if (node.nodeName != ""#text"") ;NAME { If (node.nodeName == ""Invalid_Name"" && node.getAttribute(""ahk"") == ""True"") NodeName := node.getAttribute(""id"") Else NodeName := node.nodeName } else ;VALUE Obj := node.nodeValue if node.hasChildNodes { ; Same node name was used for multiple nodes If ((node.nextSibling.nodeName = node.nodeName || node.nodeName = node.previousSibling.nodeName) && node.nodeName != ""Invalid_Name"" && node.getAttribute(""ahk"") != ""True"") { ; Create object If (!node.previousSibling.nodeName) { Obj[NodeName] := Object() ItemCount := 0 } ItemCount++ ; Use the supplied ID if available If (node.getAttribute(""id"") != """") Obj[NodeName][node.getAttribute(""id"")] := XA_XMLToArray(node.childNodes, node.getAttribute(""id"")) ; Use ItemCount if no ID was provided Else Obj[NodeName][ItemCount] := XA_XMLToArray(node.childNodes, ItemCount) } Else Obj.Insert(NodeName, XA_XMLToArray(node.childNodes, NodeName)) } } Return Obj } XA_LoadXML(ByRef data){ o := ComObjCreate(""MSXML2.DOMdocument.6.0"") o.async := false o.LoadXML(data) return o } XA_ArrayToXML(theArray, tabCount=1, NodeName="""") { Local tabSpace, extraTabSpace, tag, val, theXML, root tabCount++ tabSpace := """" extraTabSpace := """" theXML := """" if (!IsObject(theArray)) { root := theArray theArray := %theArray% ; StringReplace, theArray, theArray, %A_Space%&%A_Space%, %A_Space%&amp;%A_Space%, All ; dirty hack } While (A_Index < tabCount) { tabSpace .= ""`t"" extraTabSpace := tabSpace . ""`t"" } for tag, val in theArray { If (!IsObject(val)) { If (XA_InvalidTag(tag)) theXML .= ""`n"" . tabSpace . ""<Invalid_Name id="""""" . XA_XMLEncode(tag) . """""" ahk=""""True"""">"" . XA_XMLEncode(val) . ""</Invalid_Name>"" Else theXML .= ""`n"" . tabSpace . ""<"" . tag . "">"" . XA_XMLEncode(val) . ""</"" . tag . "">"" } Else { If (XA_InvalidTag(tag)) theXML .= ""`n"" . tabSpace . ""<Invalid_Name id="""""" . XA_XMLEncode(tag) . """""" ahk=""""True"""">"" . ""`n"" . XA_ArrayToXML(val, tabCount, """") . ""`n"" . tabSpace . ""</Invalid_Name>"" Else theXML .= ""`n"" . tabSpace . ""<"" . tag . "">"" . ""`n"" . XA_ArrayToXML(val, tabCount, """") . ""`n"" . tabSpace . ""</"" . tag . "">"" } } theXML := SubStr(theXML, 2) Return theXML } XA_InvalidTag(Tag) { Char1 := SubStr(Tag, 1, 1) Chars3 := SubStr(Tag, 1, 3) StartChars := ""~``!@#$%^&*()_-+={[}]|\:;""""'<,>.?/1234567890 `n`r"" Chars := """"""'<>=/ `n`r"" Loop, Parse, StartChars { If (Char1 = A_LoopField) Return 1 } Loop, Parse, Chars { If (InStr(Tag, A_LoopField)) Return 1 } If (Chars3 = ""xml"") Return 1 Return 0 } ; XA_XMLEncode references: ; https://en.wikipedia.org/wiki/XML#Escaping ; https://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references#Predefined_entities_in_XML ; added again as original source code posted at forum was lost due to forum upgrade XA_XMLEncode(Text) { StringReplace, Text, Text, &, &amp;, All StringReplace, Text, Text, <, &lt;, All StringReplace, Text, Text, >, &gt;, All StringReplace, Text, Text, "", &quot;, All StringReplace, Text, Text, ', &apos;, All Return XA_CleanInvalidChars(Text) ; additional fix see below for reference } XA_CleanInvalidChars(text, replace="""") { re := ""[^\x09\x0A\x0D\x20-\x{D7FF}\x{E000}-\x{FFFD}\x{10000}-\x{10FFFF}]"" Return RegExReplace(text, re, replace) /* Source: http://stackoverflow.com/questions/730133/invalid-characters-in-xml public static string CleanInvalidXmlChars(string text) { // From xml spec valid chars: // #x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF] // any Unicode character, excluding the surrogate blocks, FFFE, and FFFF. string re = @""[^\x09\x0A\x0D\x20-\uD7FF\uE000-\uFFFD\u10000-u10FFFF]""; return Regex.Replace(text, re, """"); } */ } Jump to Line Go Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/hi5/CL3/blob/master/lib/XA.ahk"	"by trueski/hi5 - Serialize/deserialize array to/from xml. Forum thread:."	"true"
"Data format"	"link"	"https://autohotkey.com/board/topic/85461-ahk-l-saveload-arrays/"	"by trueski/hi5 - Serialize/deserialize array to/from xml. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[AHK_L] Save/Load Arrays - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. [AHK_L] Save/Load Arrays Started by trueski , Oct 07 2012 04:40 AM Please log in to reply 13 replies to this topic trueski Members 121 posts Last active: Jun 25 2014 09:12 PM Joined: 08 Apr 2008 I created a couple functions to allow an array to be saved to a file which can then be loaded at a later time. The data is saved in xml format. Functions  XA_Save(""Array"", Path) ;put variable name in quotes XA_Load(Path) ;the name of the variable containing the array is returned   XA_Save(Array, Path) { FileDelete, % Path FileAppend, % ""<?xml version=""""1.0"""" encoding=""""UTF-8""""?>`n<"" . Array . "">`n"" . XA_ArrayToXML(Array) . ""`n</"" . Array . "">"", % Path, UTF-8 If (ErrorLevel) 	Return 1 Return 0 } XA_Load(Path) {   Local XMLText, XMLObj, XMLRoot, Root1, Root2      If (!FileExist(Path)) 	Return 1 	   FileRead, XMLText, % Path      XMLObj    := XA_LoadXML(XMLText)   XMLObj    := XMLObj.selectSingleNode(""/*"")   XMLRoot   := XMLObj.nodeName   %XMLRoot% := XA_XMLToArray(XMLObj.childNodes)      Return XMLRoot } XA_XMLToArray(nodes, NodeName="""") {    Obj := Object() 	    for node in nodes    {       if (node.nodeName != ""#text"")  ;NAME 	  { 		If (node.nodeName == ""Invalid_Name"" && node.getAttribute(""ahk"") == ""True"") 		  NodeName := node.getAttribute(""id"") 		Else 		  NodeName := node.nodeName 	  }                else ;VALUE 		  Obj := node.nodeValue                 if node.hasChildNodes 	  { 		;Same node name was used for multiple nodes 		If ((node.nextSibling.nodeName = node.nodeName || node.nodeName = node.previousSibling.nodeName) && node.nodeName != ""Invalid_Name"" && node.getAttribute(""ahk"") != ""True"") 		{ 		  ;Create object 		  If (!node.previousSibling.nodeName) 		  { 			Obj[NodeName] := Object() 			ItemCount := 0 		  } 		   		  ItemCount++ 		   		  ;Use the supplied ID if available 		  If (node.getAttribute(""id"") != """") 		    Obj[NodeName][node.getAttribute(""id"")] := XA_XMLToArray(node.childNodes, node.getAttribute(""id"")) 		 		  ;Use ItemCount if no ID was provided 		  Else 			Obj[NodeName][ItemCount] := XA_XMLToArray(node.childNodes, ItemCount) 	    } 		 		Else 		  Obj.Insert(NodeName, XA_XMLToArray(node.childNodes, NodeName)) 	  }    }        return Obj } XA_LoadXML(ByRef data){    o := ComObjCreate(""MSXML2.DOMDocument.6.0"")    o.async := false    o.LoadXML(data)    return o } XA_ArrayToXML(theArray, tabCount=1, NodeName="""") {          Local tabSpace, extraTabSpace, tag, val, theXML, root 	tabCount++     tabSpace := """"      extraTabSpace := """"  	 	if (!IsObject(theArray)) { 	  root := theArray 	  theArray := %theArray%     } 	 	While (A_Index < tabCount) {         tabSpace .= ""`t""  		extraTabSpace := tabSpace . ""`t""     }        	for tag, val in theArray {         If (!IsObject(val)) 		{ 		  If (XA_InvalidTag(tag)) 		    theXML .= ""`n"" . tabSpace . ""<Invalid_Name id="""""" . XA_XMLEncode(tag) . """""" ahk=""""True"""">"" . XA_XMLEncode(val) . ""</Invalid_Name>"" 		  Else 			theXML .= ""`n"" . tabSpace . ""<"" . tag . "">"" . XA_XMLEncode(val) . ""</"" . tag . "">"" 	    } 		 		Else 		{ 		  If (XA_InvalidTag(tag)) 		    theXML .= ""`n"" . tabSpace . ""<Invalid_Name id="""""" . XA_XMLEncode(tag) . """""" ahk=""""True"""">"" . ""`n"" . XA_ArrayToXML(val, tabCount, """") . ""`n"" . tabSpace . ""</Invalid_Name>"" 		  Else 		    theXML .= ""`n"" . tabSpace . ""<"" . tag . "">"" . ""`n"" . XA_ArrayToXML(val, tabCount, """") . ""`n"" . tabSpace . ""</"" . tag . "">"" 	    }     }  	 	theXML := SubStr(theXML, 2) 	Return theXML }  XA_InvalidTag(Tag) { 	Char1      := SubStr(Tag, 1, 1)  	Chars3     := SubStr(Tag, 1, 3) 	StartChars := ""~``!@#$%^&*()_-+={[}]|\:;""""'<,>.?/1234567890 	`n`r"" 	Chars := """"""'<>=/ 	`n`r"" 	 	Loop, Parse, StartChars 	{ 		If (Char1 = A_LoopField) 		  Return 1 	} 	 	Loop, Parse, Chars 	{ 		If (InStr(Tag, A_LoopField)) 		  Return 1 	} 	 	If (Chars3 = ""xml"") 	  Return 1 	   	Return 0 } XA_XMLEncode(Text) { StringReplace, Text, Text, &, &, All StringReplace, Text, Text, <, <, All StringReplace, Text, Text, >, >, All StringReplace, Text, Text, "", "", All StringReplace, Text, Text, ', ', All Return Text }  #1 - Posted 07 October 2012 - 04:40 AM -trueski- Back to top trueski Members 121 posts Last active: Jun 25 2014 09:12 PM Joined: 08 Apr 2008 EDIT: All bugs should be fixed. #2 - Posted 07 October 2012 - 07:09 AM -trueski- Back to top GeekDude Spam Officer 391 posts Last active: Oct 05 2015 08:13 PM Joined: 23 Nov 2009 hmm... possible to make an xml to array converter? #3 - Posted 07 October 2012 - 01:28 PM Back to top trueski Members 121 posts Last active: Jun 25 2014 09:12 PM Joined: 08 Apr 2008 hmm... possible to make an xml to array converter? That's what I've done. Look at the internal functions. In order to get the integer keys to work, I need to make some modifications so that the node name becomes the name of the object, and an ID or Key attribute is added with the correct key for each item in the array. #4 - Posted 07 October 2012 - 03:51 PM -trueski- Back to top GeekDude Spam Officer 391 posts Last active: Oct 05 2015 08:13 PM Joined: 23 Nov 2009 oh, will it work for any kind of xml, supporting attributes and self contained tags? <Tag Attribute1=""hello "" Attribute2=""world!"" /> #5 - Posted 07 October 2012 - 05:35 PM Back to top trueski Members 121 posts Last active: Jun 25 2014 09:12 PM Joined: 08 Apr 2008 oh, will it work for any kind of xml, supporting attributes and self contained tags? <Tag Attribute1=""hello "" Attribute2=""world!"" /> No. I could make it do that I suppose, but my intended purpose was to have a simple way to load and save any array, and also have that in a format that can be read easily by other programs. XML works great for this. In your example, what would the array structure look like if it did read that? Something like this?  Tag     Attribute1 = hello     Attribute2 = world!  [Object ""Tag"", containing Attribute1 and Attribute2] #6 - Posted 07 October 2012 - 05:43 PM -trueski- Back to top GeekDude Spam Officer 391 posts Last active: Oct 05 2015 08:13 PM Joined: 23 Nov 2009 I was thinking that it would be like this <Tag A1 = ""Hello "" A2 = ""world!"">     <Tag1 self=""contained"" />     <Tag2 mc=""donalds"">ba dum tss</Tag2> </Tag>Would turn into an array like this:  Tag     Attributes         A1 = Hello         A2 = world!     SubTags         Tag1             Attributes                 self = contained             SubTags             Text =         Tag2             Attributes                 mc = donalds             SubTags             Text = ba dum tss     Text = (Perhaps we can put the xml of the sub tags here)  #7 - Posted 07 October 2012 - 07:11 PM Back to top trueski Members 121 posts Last active: Jun 25 2014 09:12 PM Joined: 08 Apr 2008 Hmm.. I see what you're saying. Is there any application for this other than parsing HTML? I can see that this would conflict with my scheme I've come up with for integer keys in arrays. If the method you showed was only for parsing HTML, I could have the function check if it's HTML, and then treat it differently. #8 - Posted 07 October 2012 - 07:28 PM -trueski- Back to top GeekDude Spam Officer 391 posts Last active: Oct 05 2015 08:13 PM Joined: 23 Nov 2009 I was talking (typing) about creating another function completely separate from this one just for converting any old xml format file (html, rss, xml, and more) into an object. Oh, and one more thing, MSXML fails to load certain documents for me, and to load an RSS file, I had to change the top level node from this: ""<feed xmlns=""http://www.w3.org/2005/Atom"" xml:lang=""en-gb"">"" into this: ""<feed>"" for it to work. Any idea why some documents fail to load? #9 - Posted 07 October 2012 - 07:39 PM Back to top trueski Members 121 posts Last active: Jun 25 2014 09:12 PM Joined: 08 Apr 2008 I think that it would make sense for it to detect if the text is HTML or an RSS feed. I could also have the saving script append some kind of a comment that shows that it is an XML representation of an array in AHK. If I did this, it could use different rules for data that came straight from AHK as opposed to another source. I do feel that the rules for AHK should be standard though, unless there's a specific type of document that commonly is formatted differently (like HTML or RSS). Most XML that simply stores hierarchical data is fairly uniform and organized. See example: http://msdn.microsof...1(v=vs.85).aspx If I were to use the method that you posted for every xml document, it would add unnecessary depth to the array. Additionally, when most people start creating arrays in autohotkey, I doubt they typically make objects in the array called ""Attributes"" or ""Subtags"". This would prevent the AHK-originated arrays from matching the structure that they had before they were saved. I had to change the top level node from this: ""<feed xmlns=""http://www.w3.org/2005/Atom"" xml:lang=""en-gb"">"" into this: ""<feed>"" for it to work. Any idea why some documents fail to load? That would be because I have the script grab everything between the first <> to determine what the root node is. It should look for the first ""<"", and then get the text until the first space. #10 - Posted 07 October 2012 - 07:55 PM -trueski- Back to top GeekDude Spam Officer 391 posts Last active: Oct 05 2015 08:13 PM Joined: 23 Nov 2009 The bit about rss and such is off-topic. I meant using the MSXML COM object, and the LoadXML (perhaps maybe Load too) method, it would not work correctly and o.document.xml would be blank. Back on topic: The format I described was not for xml generated by ArrrayToXml(), but for xml from anywhere. I am saying that it would be awesome if you could make a seperate function that will convert xml with attributes and other strange bits that don't fit in with ahk arrays, into a well formatted array/sub-array system. (or maybe I could take a crack at it) EDIT: It seems that html is not always valid xml, and that there is a seperate com object for it. (It can't use XPath though, and I'm not really sure if it can do what I want it to) #11 - Posted 07 October 2012 - 08:07 PM Back to top trueski Members 121 posts Last active: Jun 25 2014 09:12 PM Joined: 08 Apr 2008 I updated the code, and I think it's now working with all arrays that originated in AHK. Please try to get the code to break. If an array element name is an invalid xml element name, the element name becomes ""Invalid_Name"", and the name of the array element is included in the attribute ""id"". The attribute ""ahk"" is also added, to allow ""Invalid_Name"" as a potential element name. #12 - Posted 15 October 2012 - 01:08 AM -trueski- Back to top magusneo Members 51 posts Last active: May 10 2014 03:15 PM Joined: 30 May 2012 Really cool,Thanks. It seems it doesn't support tag name including ""-""? like this: <AB-Analysis></AB-Analysis> #13 - Posted 10 November 2012 - 12:37 AM Back to top roi1 Members 2 posts Last active: Sep 28 2013 04:09 PM Joined: 12 Aug 2013 The Load function errors if there is an ampersand (&) in a top item in a two dimensional array. Try XA_Load on this  <?xml version=""1.0"" encoding=""UTF-8""?> <testarray>     <Invalid_Name id=""test & test"" ahk=""True"">         <Invalid_Name id=""1"" ahk=""True"">1</Invalid_Name>     </Invalid_Name> </testarray> #14 - Posted 28 September 2013 - 02:28 PM Back to top Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"by trueski/hi5 - Serialize/deserialize array to/from xml. Forum thread:."	"true"
"Database"	"ahkDBA"	"https://github.com/IsNull/ahkDBA"	"by IsNull - An OOP-SQL database access framework. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"26"	"15"	"12"	"GitHub - IsNull/ahkDBA: AutoHotkey DBA  is an OOP-SQL DataBase access framework. It currently supports  SQLite, MySQL and ADO. Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 15 Star 26 Fork 12 IsNull/ahkDBA Code Issues 0 Pull requests 0 Pulse Graphs AutoHotkey DBA is an OOP-SQL DataBase access framework. It currently supports SQLite, MySQL and ADO. 62 commits 2 branches 0 releases 3 contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master stable Nothing to show Nothing to show New pull request Latest commit d1e6623 Mar 9, 2015 IsNull Merge pull request #16 from ManiacDC/master … Variable naming and scope corrections Permalink Failed to load latest commit information. Lib Fixed spelling of ""AvailableTypes"" in DBA.DatabaseFactory *BACKWARDS … Mar 9, 2015 Test added image for blob tests Aug 13, 2012 .gitignore Introducing real Blob support for SQLite Aug 15, 2012 DBAExampleOOP.ahk Fixed spelling of ""AvailableTypes"" in DBA.DatabaseFactory *BACKWARDS … Mar 9, 2015 license.txt initial commit, setting up git Apr 17, 2012 readme.txt added readme Apr 17, 2012 readme.txt      AHK DBA - OOP Database Access Framework for AutoHotkey (_L)	      Currently DBA supports SQLite, MySQL and ADO.       DBA is an object oriented wrapper around several different     databases/database providers to standardize the access interface.     It is similar to ADO from MS or the jdbc driver in Java.          Copyright (C) 2012 IsNull and other contributors      This program is free software: you can redistribute it and/or modify     it under the terms of the GNU General Public License as published by     the Free Software Foundation, either version 3 of the License, or     (at your option) any later version.      This program is distributed in the hope that it will be useful,     but WITHOUT ANY WARRANTY; without even the implied warranty of     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the     GNU General Public License for more details.      You should have received a copy of the GNU General Public License     along with this program.  If not, see <http://www.gnu.org/licenses/>. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/IsNull/ahkDBA"	"by IsNull - An OOP-SQL database access framework. Forum thread:."	"true"
"Database"	"link"	"https://autohotkey.com/board/topic/71179"	"by IsNull - An OOP-SQL database access framework. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"by IsNull - An OOP-SQL database access framework. Forum thread:."	"false"
"Database"	"Class_SQLiteDB"	"https://github.com/AHK-just-me/Class_SQLiteDB"	"by just Me - AHK SQLite API wrapper class. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"10"	"4"	"6"	"GitHub - AHK-just-me/Class_SQLiteDB: AHK SQLite API wrapper class Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 4 Star 10 Fork 6 AHK-just-me/Class_SQLiteDB Code Issues 1 Pull requests 0 Pulse Graphs AHK SQLite API wrapper class 12 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit 24728fb Mar 29, 2016 AHK-just-me Update 0.0.07.00 … Added support for PRAGMA Permalink Failed to load latest commit information. Sources_v1.1 Update 0.0.07.00 Mar 29, 2016 .gitattributes .gitignore LICENSE README.md README.md Class_SQLiteDB AHK SQLite API Wrapper AHK class providing support to access SQLite databases. Additional stuff SQLite documentation SQLite download page Basic usage Create a new instance of the class SQLiteDB calling MyDB := New SQLiteDB Open your database calling MyDB.OpenDB(MyDatabaseFilePath). If the file doesn't exist, a new database will be created unless you specify ""False"" as the third parameter. MyDB object provides four methods to pass SQL statements to the database: MyDB.Exec(SQL) Should be called for all SQL statements which don't return values from the database (e.g. CREATE, INSERT, UPDATE, etc.). MyDB.GetTable(SQL, Table, ...) Should be called for SELECT statements whenever you want to get the complete result of the query as a ""Table"" object for direct access via the row index. All field values will be returned ""in their zero-terminated string representation"" (and accordingly an empty string for NULL values). MyDB.Query(SQL, RecordSet, ...) Should be called for SELECT statements whenever you want to get the result of the query as a ""RecordSet"" object. You'll have to call the built-in method RecordSet.Next() to access the records sequentially. Only DB-Query() does handle BLOBs properly. All other field types will be returned as strings (see DB.GetTable()). If you don't need the RecordSet anymore, call RecordSet.Free() to release the resources. MyDB.StoreBLOB(SQL, BlobArray) Should be called whenever BLOBs shall be stored in the database. For each BLOB in the row you have to specify a ? parameter within the statement. The parameters are numbered automatically from left to right starting with 1. For each parameter you have to pass an object within BlobArray containing the address and the size of the BLOB. After all work is done, call MyDB.CloseDB() to close the database. For all still existing queries RecordSet.Free() will be called internally. For further details look at the inline documentation in the class script and the sample scripts, please. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/AHK-just-me/Class_SQLiteDB"	"by just Me - AHK SQLite API wrapper class. Forum thread:."	"true"
"Database"	"link"	"https://autohotkey.com/boards/viewtopic.php?t=1064"	"by just Me - AHK SQLite API wrapper class. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[Class] SQLiteDB - Update on 2016-03-28 - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:26 All times are UTC-05:00 [Class] SQLiteDB - Update on 2016-03-28 Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 51 posts 1 2 3 Next just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany [Class] SQLiteDB - Update on 2016-03-28 Report this post Quote 19 Dec 2013, 04:19 Primarily released at http://www.autohotkey.com/board/topic/67427-class-sqlitedb-now-with-blob-and-u64-support/ Change history: Update on 2016-03-28: Added PRAGMA support. Added class script to the thread.Update on 2016-01-28: Fixed version checkUpdate on 2013-12-20: Added v2 version Changed download linksUpdate on 2013-01-25: Added new download linkUpdate on 2012-09-19: Added ""Basic usage"" sectionUpdate 2 on 2012-08-11: Added 64-bit support (somewhat tested) You need to download the 64-bit version of SQLite3.dll http://www.sqlite.org/sqlite-dll-win32-x64-3071300.zip for AHK U64. Updated scripts.Update on 2012-08-11: Added more advanced BLOB support: The new method StoreBLOB() accepts INSERT/UPDATE/REPLACE statements with ? parameters and an array containing objects holding the address and size of the BLOB to bind to these parameters. ? parameters are numbered automatically from left to right starting with 1, so you have to store the BLOB describing object on the corresponding position in the array (http://www.sqlite.org/c3ref/bind_blob.html). Updated BLOB_sample.ahkUpdate on 2012-08-10: Added basic support for BLOBs (as a proof of concept) To INSERT a BLOB into a table you have convert it into a hexadecimal string and use the following syntax: Literal Values BLOB literals are string literals containing hexadecimal data and preceded by a single ""x"" or ""X"" character. For example: X'53514C697465' To retrieve a BLOB you have to use the DataBase.Query() and RecordSet.Next() methods. They are passed in the appropriate row array field as objects containing two keys/value pairs: Size (size in bytes) and Blob (binary BLOB data). I've added a short BLOB_Sample.ahk script to show the usage.Update on 2012-07-24: Attached download files (they aren't accessible via AutoHotkey.net for unknown reasons)Update on 2011-08-10: New syntax for instance variables in AHK 1.1.02 Hello, I'm coming up with one of my favorite projects: SQLite. Since I noticed the ""class syntax"" of AHK 1.1, I had to try to design a class for the handling of SQLite databases. It may be buggy, because I had to test it on my own and could not test in a 64 bit environment It should support both ANSI and Unicode versions of AHK 1.1 It is assuming the databases to be encoded with UTF-8 Basic usage: SQLite Documentation SQLite Download Page Download the sqlite3.dll and store it in the script's folder. If you want to store it in another place, you have to provide the path via a ""SQLiteDB.ini"" file in the script's folder as follows: [Main] DllPath=Path to SQLite3.dll Create a new instance of the class SQLiteDB calling MyDB := New SQLiteDB Open your database calling MyDB.OpenDB(MyDatabaseFilePath). If the file doesn't exist, a new database will be created unless you specify ""False"" as the third parameter. MyDB object provides four methods to pass SQL statements to the database: MyDB.Exec(SQL) should be called for all SQL statements which don't return values from the database (e.g. CREATE, INSERT, UPDATE, etc.). MyDB.GetTable(SQL, Table, ...) should be called for SELECT statements whenever you want to get the complete result of the query as a ""Table"" object for direct access via the row index. All field values will be returned ""in their zero-terminated string representation"" (and accordingly an empty string for NULL values). MyDB.Query(SQL, RecordSet, ...) should be called for SELECT statements whenever you want to get the result of the query as a ""RecordSet"" object. You'll have to call the built-in method RecordSet.Next() to access the records sequentially. Only DB-Query() does handle BLOBs properly. All other field types will be returned as strings (see DB.GetTable). If you don't need the RecordSet anymore, call RecordSet.Free() to release the resources. MyDB.StoreBLOB(SQL, BlobArray) should be called whenever BLOBs shall be stored in the database. For each BLOB in the row you have to specify a ? parameter within the statement. The parameters are numbered automatically from left to right starting with 1. For each parameter you have to pass an object within BlobArray containing the address and the size of the BLOB. After all work is done, call MyDB.CloseDB() to close the database. For all still existing queries RecordSet.Free() will be called internally. For more details look at the inline documentation in the class script and the sample scripts, please. Code: [Select all] [Expand] [Download] (Class_SQLiteDB.ahk)GeSHi © Codebox Plus ; ====================================================================================================================== ; Function:         Class definitions as wrappers for SQLite3.dll to work with SQLite DBs. ; AHK version:      1.1.23.01 ; Tested on:        Win 10 Pro (x64), SQLite 3.7.13 ; Version:          0.0.01.00/2011-08-10/just me ;                   0.0.02.00/2012-08-10/just me   -  Added basic BLOB support ;                   0.0.03.00/2012-08-11/just me   -  Added more advanced BLOB support ;                   0.0.04.00/2013-06-29/just me   -  Added new methods AttachDB and DetachDB ;                   0.0.05.00/2013-08-03/just me   -  Changed base class assignment ;                   0.0.06.00/2016-01-28/just me   -  Fixed version check, revised parameter initialization. ;                   0.0.07.00/2016-03-28/just me   -  Added support for PRAGMA statements. ; Remarks:          Names of ""private"" properties / methods are prefixed with an underscore, ;                   they must not be set / called by the script! ;                   ;                   SQLite3.dll file is assumed to be in the script's folder, otherwise you have to ;                   provide an INI-File SQLiteDB.ini in the script's folder containing the path: ;                   [Main] ;                   DllPath=Path to SQLite3.dll ; ;                   Encoding of SQLite DBs is assumed to be UTF-8 ;                   Minimum supported SQLite3.dll version is 3.6 ;                   Download the current version of SQLite3.dll (and also SQlite3.exe) from www.sqlite.org ; ====================================================================================================================== ; This software is provided 'as-is', without any express or implied warranty. ; In no event will the authors be held liable for any damages arising from the ; use of this software. ; ====================================================================================================================== ; CLASS SQliteDB - SQLiteDB main class ; ====================================================================================================================== Class SQLiteDB Extends SQLiteDB.BaseClass {    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; PRIVATE Properties and Methods ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; ===================================================================================================================    ; BaseClass - SQLiteDB base class    ; ===================================================================================================================    Class BaseClass {       Static Version := """"       Static _SQLiteDLL := A_ScriptDir . ""\SQLite3.dll""       Static _RefCount := 0       Static _MinVersion := ""3.6""    }    ; ===================================================================================================================    ; CLASS _Table    ; Object returned from method GetTable()    ; _Table is an independent object and does not need SQLite after creation at all.    ; ===================================================================================================================    Class _Table {       ; ----------------------------------------------------------------------------------------------------------------       ; CONSTRUCTOR  Create instance variables       ; ----------------------------------------------------------------------------------------------------------------       __New() {           This.ColumnCount := 0          ; Number of columns in the result table         (Integer)           This.RowCount := 0             ; Number of rows in the result table            (Integer)               This.ColumnNames := []         ; Names of columns in the result table          (Array)           This.Rows := []                ; Rows of the result table                      (Array of Arrays)           This.HasNames := False         ; Does var ColumnNames contain names?           (Bool)           This.HasRows := False          ; Does var Rows contain rows?                   (Bool)           This._CurrentRow := 0          ; Row index of last returned row                (Integer)       }       ; ----------------------------------------------------------------------------------------------------------------       ; METHOD GetRow      Get row for RowIndex       ; Parameters:        RowIndex    - Index of the row to retrieve, the index of the first row is 1       ;                    ByRef Row   - Variable to pass out the row array       ; Return values:     On failure  - False       ;                    On success  - True, Row contains a valid array       ; Remarks:           _CurrentRow is set to RowIndex, so a subsequent call of NextRow() will return the       ;                    following row.       ; ----------------------------------------------------------------------------------------------------------------       GetRow(RowIndex, ByRef Row) {          Row := """"          If (RowIndex < 1 || RowIndex > This.RowCount)             Return False          If !This.Rows.HasKey(RowIndex)             Return False          Row := This.Rows[RowIndex]          This._CurrentRow := RowIndex          Return True       }       ; ----------------------------------------------------------------------------------------------------------------       ; METHOD Next        Get next row depending on _CurrentRow       ; Parameters:        ByRef Row   - Variable to pass out the row array       ; Return values:     On failure  - False, -1 for EOR (end of rows)       ;                    On success  - True, Row contains a valid array       ; ----------------------------------------------------------------------------------------------------------------       Next(ByRef Row) {          Row := """"          If (This._CurrentRow >= This.RowCount)             Return -1          This._CurrentRow += 1          If !This.Rows.HasKey(This._CurrentRow)             Return False          Row := This.Rows[This._CurrentRow]          Return True       }       ; ----------------------------------------------------------------------------------------------------------------       ; METHOD Reset       Reset _CurrentRow to zero       ; Parameters:        None       ; Return value:      True       ; ----------------------------------------------------------------------------------------------------------------       Reset() {          This._CurrentRow := 0          Return True       }    }     ; ===================================================================================================================    ; CLASS _RecordSet    ; Object returned from method Query()    ; The records (rows) of a recordset can be accessed sequentially per call of Next() starting with the first record.    ; After a call of Reset() calls of Next() will start with the first record again.    ; When the recordset isn't needed any more, call Free() to free the resources.    ; The lifetime of a recordset depends on the lifetime of the related SQLiteDB object.    ; ===================================================================================================================    Class _RecordSet {       ; ----------------------------------------------------------------------------------------------------------------       ; CONSTRUCTOR  Create instance variables       ; ----------------------------------------------------------------------------------------------------------------       __New() {           This.ColumnCount := 0          ; Number of columns                             (Integer)           This.ColumnNames := []         ; Names of columns in the result table          (Array)           This.HasNames := False         ; Does var ColumnNames contain names?           (Bool)           This.HasRows := False          ; Does _RecordSet contain rows?                 (Bool)           This.CurrentRow := 0           ; Index of current row                          (Integer)           This.ErrorMsg := """"            ; Last error message                            (String)           This.ErrorCode := 0            ; Last SQLite error code / ErrorLevel           (Variant)           This._Handle := 0              ; Query handle                                  (Pointer)           This._DB := {}                 ; SQLiteDB object                               (Object)       }       ; ----------------------------------------------------------------------------------------------------------------       ; METHOD Next        Get next row of query result       ; Parameters:        ByRef Row   - Variable to store the row array       ; Return values:     On success  - True, Row contains the row array       ;                    On failure  - False, ErrorMsg / ErrorCode contain additional information       ;                                  -1 for EOR (end of records)       ; ----------------------------------------------------------------------------------------------------------------       Next(ByRef Row) {          Static SQLITE_NULL := 5          Static SQLITE_BLOB := 4          Static EOR := -1          Row := """"          This.ErrorMsg := """"          This.ErrorCode := 0          If !(This._Handle) {             This.ErrorMsg := ""Invalid query handle!""             Return False          }          RC := DllCall(""SQlite3.dll\sqlite3_step"", ""Ptr"", This._Handle, ""Cdecl Int"")          If (ErrorLevel) {             This.ErrorMsg := ""DLLCall sqlite3_step failed!""             This.ErrorCode := ErrorLevel             Return False          }          If (RC <> This._DB._ReturnCode(""SQLITE_ROW"")) {             If (RC = This._DB._ReturnCode(""SQLITE_DONE"")) {                This.ErrorMsg := ""EOR""                This.ErrorCode := RC                Return EOR             }             This.ErrorMsg := This._DB.ErrMsg()             This.ErrorCode := RC             Return False          }          RC := DllCall(""SQlite3.dll\sqlite3_data_count"", ""Ptr"", This._Handle, ""Cdecl Int"")          If (ErrorLevel) {             This.ErrorMsg := ""DLLCall sqlite3_data_count failed!""             This.ErrorCode := ErrorLevel             Return False          }          If (RC < 1) {             This.ErrorMsg := ""RecordSet is empty!""             This.ErrorCode := This._DB._ReturnCode(""SQLITE_EMPTY"")             Return False          }          Row := []          Loop, %RC% {             Column := A_Index - 1             ColumnType := DllCall(""SQlite3.dll\sqlite3_column_type"", ""Ptr"", This._Handle, ""Int"", Column, ""Cdecl Int"")             If (ErrorLevel) {                This.ErrorMsg := ""DLLCall sqlite3_column_type failed!""                This.ErrorCode := ErrorLevel                Return False             }             If (ColumnType = SQLITE_NULL) {                Row[A_Index] := """"             } Else If (ColumnType = SQLITE_BLOB) {                BlobPtr := DllCall(""SQlite3.dll\sqlite3_column_blob"", ""Ptr"", This._Handle, ""Int"", Column, ""Cdecl UPtr"")                BlobSize := DllCall(""SQlite3.dll\sqlite3_column_bytes"", ""Ptr"", This._Handle, ""Int"", Column, ""Cdecl Int"")                If (BlobPtr = 0) || (BlobSize = 0) {                   Row[A_Index] := """"                } Else {                   Row[A_Index] := {}                   Row[A_Index].Size := BlobSize                   Row[A_Index].Blob := """"                   Row[A_Index].SetCapacity(""Blob"", BlobSize)                   Addr := Row[A_Index].GetAddress(""Blob"")                   DllCall(""Kernel32.dll\RtlMoveMemory"", ""Ptr"", Addr, ""Ptr"", BlobPtr, ""Ptr"", BlobSize)                }             } Else {                StrPtr := DllCall(""SQlite3.dll\sqlite3_column_text"", ""Ptr"", This._Handle, ""Int"", Column, ""Cdecl UPtr"")                If (ErrorLevel) {                   This.ErrorMsg := ""DLLCall sqlite3_column_text failed!""                   This.ErrorCode := ErrorLevel                   Return False                }                Row[A_Index] := StrGet(StrPtr, ""UTF-8"")             }          }          This.CurrentRow += 1          Return True       }       ; ----------------------------------------------------------------------------------------------------------------       ; METHOD Reset       Reset the result pointer       ; Parameters:        None       ; Return values:     On success  - True       ;                    On failure  - False, ErrorMsg / ErrorCode contain additional information       ; Remarks:           After a call of this method you can access the query result via Next() again.       ; ----------------------------------------------------------------------------------------------------------------       Reset() {          This.ErrorMsg := """"          This.ErrorCode := 0          If !(This._Handle) {             This.ErrorMsg := ""Invalid query handle!""             Return False          }          RC := DllCall(""SQlite3.dll\sqlite3_reset"", ""Ptr"", This._Handle, ""Cdecl Int"")          If (ErrorLevel) {             This.ErrorMsg := ""DLLCall sqlite3_reset failed!""             This.ErrorCode := ErrorLevel             Return False          }          If (RC) {             This.ErrorMsg := This._DB._ErrMsg()             This.ErrorCode := RC             Return False          }          This.CurrentRow := 0          Return True       }       ; ----------------------------------------------------------------------------------------------------------------       ; METHOD Free        Free query result       ; Parameters:        None       ; Return values:     On success  - True       ;                    On failure  - False, ErrorMsg / ErrorCode contain additional information       ; Remarks:           After the call of this method further access on the query result is impossible.       ; ----------------------------------------------------------------------------------------------------------------       Free() {          This.ErrorMsg := """"          This.ErrorCode := 0          If !(This._Handle)             Return True          RC := DllCall(""SQlite3.dll\sqlite3_finalize"", ""Ptr"", This._Handle, ""Cdecl Int"")          If (ErrorLevel) {             This.ErrorMsg := ""DLLCall sqlite3_finalize failed!""             This.ErrorCode := ErrorLevel             Return False          }          If (RC) {             This.ErrorMsg := This._DB._ErrMsg()             This.ErrorCode := RC             Return False          }          This._DB._Queries.Remove(This._Handle)          This._Handle := 0          Return True       }    }    ; ===================================================================================================================    ; CONSTRUCTOR __New    ; ===================================================================================================================    __New() {       This._Path := """"                  ; Database path                                 (String)       This._Handle := 0                 ; Database handle                               (Pointer)       This._Queries := {}               ; Valid queries                                 (Object)       If (This.Base._RefCount = 0) {          SQLiteDLL := This.Base._SQLiteDLL          If !FileExist(SQLiteDLL)             If FileExist(A_ScriptDir . ""\SQLiteDB.ini"") {                IniRead, SQLiteDLL, %A_ScriptDir%\SQLiteDB.ini, Main, DllPath, %SQLiteDLL%                This.Base._SQLiteDLL := SQLiteDLL          }          If !(DLL := DllCall(""LoadLibrary"", ""Str"", This.Base._SQLiteDLL, ""UPtr"")) {             MsgBox, 16, SQLiteDB Error, % ""DLL "" . SQLiteDLL . "" does not exist!""             ExitApp          }          This.Base.Version := StrGet(DllCall(""SQlite3.dll\sqlite3_libversion"", ""Cdecl UPtr""), ""UTF-8"")          SQLVersion := StrSplit(This.Base.Version, ""."")          MinVersion := StrSplit(This.Base._MinVersion, ""."")          If (SQLVersion[1] < MinVersion[1]) || ((SQLVersion[1] = MinVersion[1]) && (SQLVersion[2] < MinVersion[2])){             DllCall(""FreeLibrary"", ""Ptr"", DLL)             MsgBox, 16, SQLite ERROR, % ""Version "" . This.Base.Version .  "" of SQLite3.dll is not supported!`n`n""                                       . ""You can download the current version from www.sqlite.org!""             ExitApp          }       }       This.Base._RefCount += 1    }    ; ===================================================================================================================    ; DESTRUCTOR __Delete    ; ===================================================================================================================    __Delete() {       If (This._Handle)          This.CloseDB()       This.Base._RefCount -= 1       If (This.Base._RefCount = 0) {          If (DLL := DllCall(""GetModuleHandle"", ""Str"", This.Base._SQLiteDLL, ""UPtr""))             DllCall(""FreeLibrary"", ""Ptr"", DLL)       }    }    ; ===================================================================================================================    ; PRIVATE _StrToUTF8    ; ===================================================================================================================    _StrToUTF8(Str, ByRef UTF8) {       VarSetCapacity(UTF8, StrPut(Str, ""UTF-8""), 0)       StrPut(Str, &UTF8, ""UTF-8"")       Return &UTF8    }    ; ===================================================================================================================    ; PRIVATE _UTF8ToStr    ; ===================================================================================================================    _UTF8ToStr(UTF8) {       Return StrGet(UTF8, ""UTF-8"")    }    ; ===================================================================================================================    ; PRIVATE _ErrMsg    ; ===================================================================================================================    _ErrMsg() {       If (RC := DllCall(""SQLite3.dll\sqlite3_errmsg"", ""Ptr"", This._Handle, ""Cdecl UPtr""))          Return StrGet(&RC, ""UTF-8"")       Return """"    }    ; ===================================================================================================================    ; PRIVATE _ErrCode    ; ===================================================================================================================    _ErrCode() {       Return DllCall(""SQLite3.dll\sqlite3_errcode"", ""Ptr"", This._Handle, ""Cdecl Int"")    }    ; ===================================================================================================================    ; PRIVATE _Changes    ; ===================================================================================================================    _Changes() {       Return DllCall(""SQLite3.dll\sqlite3_changes"", ""Ptr"", This._Handle, ""Cdecl Int"")    }    ; ===================================================================================================================    ; PRIVATE _Returncode    ; ===================================================================================================================    _ReturnCode(RC) {       Static RCODE := {SQLITE_OK: 0          ; Successful result                      , SQLITE_ERROR: 1       ; SQL error or missing database                      , SQLITE_INTERNAL: 2    ; NOT USED. Internal logic error in SQLite                      , SQLITE_PERM: 3        ; Access permission denied                      , SQLITE_ABORT: 4       ; Callback routine requested an abort                      , SQLITE_BUSY: 5        ; The database file is locked                      , SQLITE_LOCKED: 6      ; A table in the database is locked                      , SQLITE_NOMEM: 7       ; A malloc() failed                      , SQLITE_READONLY: 8    ; Attempt to write a readonly database                      , SQLITE_INTERRUPT: 9   ; Operation terminated by sqlite3_interrupt()                      , SQLITE_IOERR: 10      ; Some kind of disk I/O error occurred                      , SQLITE_CORRUPT: 11    ; The database disk image is malformed                      , SQLITE_NOTFOUND: 12   ; NOT USED. Table or record not found                      , SQLITE_FULL: 13       ; Insertion failed because database is full                      , SQLITE_CANTOPEN: 14   ; Unable to open the database file                      , SQLITE_PROTOCOL: 15   ; NOT USED. Database lock protocol error                      , SQLITE_EMPTY: 16      ; Database is empty                      , SQLITE_SCHEMA: 17     ; The database schema changed                      , SQLITE_TOOBIG: 18     ; String or BLOB exceeds size limit                      , SQLITE_CONSTRAINT: 19 ; Abort due to constraint violation                      , SQLITE_MISMATCH: 20   ; Data type mismatch                      , SQLITE_MISUSE: 21     ; Library used incorrectly                      , SQLITE_NOLFS: 22      ; Uses OS features not supported on host                      , SQLITE_AUTH: 23       ; Authorization denied                      , SQLITE_FORMAT: 24     ; Auxiliary database format error                      , SQLITE_RANGE: 25      ; 2nd parameter to sqlite3_bind out of range                      , SQLITE_NOTADB: 26     ; File opened that is not a database file                      , SQLITE_ROW: 100       ; sqlite3_step() has another row ready                      , SQLITE_DONE: 101}     ; sqlite3_step() has finished executing       Return RCODE.HasKey(RC) ? RCODE[RC] : """"    }    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; PUBLIC Interface ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; ===================================================================================================================    ; Properties    ; ===================================================================================================================     ErrorMsg := """"              ; Error message                           (String)     ErrorCode := 0              ; SQLite error code / ErrorLevel          (Variant)     Changes := 0                ; Changes made by last call of Exec()     (Integer)     SQL := """"                   ; Last executed SQL statement             (String)    ; ===================================================================================================================    ; METHOD OpenDB         Open a database    ; Parameters:           DBPath      - Path of the database file    ;                       Access      - Wanted access: ""R""ead / ""W""rite    ;                       Create      - Create new database in write mode, if it doesn't exist    ; Return values:        On success  - True    ;                       On failure  - False, ErrorMsg / ErrorCode contain additional information    ; Remarks:              If DBPath is empty in write mode, a database called "":memory:"" is created in memory    ;                       and deletet on call of CloseDB.    ; ===================================================================================================================    OpenDB(DBPath, Access := ""W"", Create := True) {       Static SQLITE_OPEN_READONLY  := 0x01 ; Database opened as read-only       Static SQLITE_OPEN_READWRITE := 0x02 ; Database opened as read-write       Static SQLITE_OPEN_CREATE    := 0x04 ; Database will be created if not exists       Static MEMDB := "":memory:""       This.ErrorMsg := """"       This.ErrorCode := 0       HDB := 0       If (DBPath = """")          DBPath := MEMDB       If (DBPath = This._Path) && (This._Handle)          Return True       If (This._Handle) {          This.ErrorMsg := ""You must first close DB "" . This._Path . ""!""          Return False       }       Flags := 0       Access := SubStr(Access, 1, 1)       If (Access <> ""W"") && (Access <> ""R"")          Access := ""R""       Flags := SQLITE_OPEN_READONLY       If (Access = ""W"") {          Flags := SQLITE_OPEN_READWRITE          If (Create)             Flags |= SQLITE_OPEN_CREATE       }       This._Path := DBPath       This._StrToUTF8(DBPath, UTF8)       RC := DllCall(""SQlite3.dll\sqlite3_open_v2"", ""Ptr"", &UTF8, ""PtrP"", HDB, ""Int"", Flags, ""Ptr"", 0, ""Cdecl Int"")       If (ErrorLevel) {          This._Path := """"          This.ErrorMsg := ""DLLCall sqlite3_open_v2 failed!""          This.ErrorCode := ErrorLevel          Return False       }       If (RC) {          This._Path := """"          This.ErrorMsg := This._ErrMsg()          This.ErrorCode := RC          Return False       }       This._Handle := HDB       Return True    }    ; ===================================================================================================================    ; METHOD CloseDB        Close database    ; Parameters:           None    ; Return values:        On success  - True    ;                       On failure  - False, ErrorMsg / ErrorCode contain additional information    ; ===================================================================================================================    CloseDB() {       This.ErrorMsg := """"       This.ErrorCode := 0       This.SQL := """"       If !(This._Handle)          Return True       For Each, Query in This._Queries          DllCall(""SQlite3.dll\sqlite3_finalize"", ""Ptr"", Query, ""Cdecl Int"")       RC := DllCall(""SQlite3.dll\sqlite3_close"", ""Ptr"", This._Handle, ""Cdecl Int"")       If (ErrorLevel) {          This.ErrorMsg := ""DLLCall sqlite3_close failed!""          This.ErrorCode := ErrorLevel          Return False       }       If (RC) {          This.ErrorMsg := This._ErrMsg()          This.ErrorCode := RC          Return False       }       This._Path := """"       This._Handle := """"       This._Queries := []       Return True    }    ; ===================================================================================================================    ; METHOD AttachDB       Add another database file to the current database connection    ;                       http://www.sqlite.org/lang_attach.html    ; Parameters:           DBPath      - Path of the database file    ;                       DBAlias     - Database alias name used internally by SQLite    ; Return values:        On success  - True    ;                       On failure  - False, ErrorMsg / ErrorCode contain additional information    ; ===================================================================================================================    AttachDB(DBPath, DBAlias) {       Return This.Exec(""ATTACH DATABASE '"" . DBPath . ""' As "" . DBAlias . "";"")    }    ; ===================================================================================================================    ; METHOD DetachDB       Detaches an additional database connection previously attached using AttachDB()    ;                       http://www.sqlite.org/lang_detach.html    ; Parameters:           DBAlias     - Database alias name used with AttachDB()    ; Return values:        On success  - True    ;                       On failure  - False, ErrorMsg / ErrorCode contain additional information    ; ===================================================================================================================    DetachDB(DBAlias) {       Return This.Exec(""DETACH DATABASE "" . DBAlias . "";"")    }    ; ===================================================================================================================    ; METHOD Exec           Execute SQL statement    ; Parameters:           SQL         - Valid SQL statement    ;                       Callback    - Name of a callback function to invoke for each result row coming out    ;                                     of the evaluated SQL statements.    ;                                     The function must accept 4 parameters:    ;                                     1: SQLiteDB object    ;                                     2: Number of columns    ;                                     3: Pointer to an array of pointers to columns text    ;                                     4: Pointer to an array of pointers to column names    ;                                     The address of the current SQL string is passed in A_EventInfo.    ;                                     If the callback function returns non-zero, DB.Exec() returns SQLITE_ABORT    ;                                     without invoking the callback again and without running any subsequent    ;                                     SQL statements.     ; Return values:        On success  - True, the number of changed rows is given in property Changes    ;                       On failure  - False, ErrorMsg / ErrorCode contain additional information    ; ===================================================================================================================    Exec(SQL, Callback := """") {       This.ErrorMsg := """"       This.ErrorCode := 0       This.SQL := SQL       If !(This._Handle) {          This.ErrorMsg := ""Invalid dadabase handle!""          Return False       }       CBPtr := 0       Err := 0       If (FO := Func(Callback)) && (FO.MinParams = 4)          CBPtr := RegisterCallback(Callback, ""F C"", 4, &SQL)       This._StrToUTF8(SQL, UTF8)       RC := DllCall(""SQlite3.dll\sqlite3_exec"", ""Ptr"", This._Handle, ""Ptr"", &UTF8, ""Int"", CBPtr, ""Ptr"", Object(This)                   , ""PtrP"", Err, ""Cdecl Int"")       CallError := ErrorLevel       If (CBPtr)          DllCall(""Kernel32.dll\GlobalFree"", ""Ptr"", CBPtr)       If (CallError) {          This.ErrorMsg := ""DLLCall sqlite3_exec failed!""          This.ErrorCode := CallError          Return False       }       If (RC) {          This.ErrorMsg := StrGet(Err, ""UTF-8"")          This.ErrorCode := RC          DllCall(""SQLite3.dll\sqlite3_free"", ""Ptr"", Err, ""Cdecl"")          Return False       }       This.Changes := This._Changes()       Return True    }    ; ===================================================================================================================    ; METHOD GetTable       Get complete result for SELECT query    ; Parameters:           SQL         - SQL SELECT statement    ;                       ByRef TB    - Variable to store the result object (TB _Table)    ;                       MaxResult   - Number of rows to return:    ;                          0          Complete result (default)    ;                         -1          Return only RowCount and ColumnCount    ;                         -2          Return counters and array ColumnNames    ;                          n          Return counters and ColumnNames and first n rows    ; Return values:        On success  - True, TB contains the result object    ;                       On failure  - False, ErrorMsg / ErrorCode contain additional information    ; ===================================================================================================================    GetTable(SQL, ByRef TB, MaxResult := 0) {       TB := """"       This.ErrorMsg := """"       This.ErrorCode := 0       This.SQL := SQL       If !(This._Handle) {          This.ErrorMsg := ""Invalid dadabase handle!""          Return False       }       If !RegExMatch(SQL, ""i)^\s*(SELECT|PRAGMA)\s"") {          This.ErrorMsg := ""Method "" . A_ThisFunc . "" requires a query statement!""          Return False       }       Names := """"       Err := 0, RC := 0, GetRows := 0       I := 0, Rows := Cols := 0       Table := 0       If MaxResult Is Not Integer          MaxResult := 0       If (MaxResult < -2)          MaxResult := 0       This._StrToUTF8(SQL, UTF8)       RC := DllCall(""SQlite3.dll\sqlite3_get_table"", ""Ptr"", This._Handle, ""Ptr"", &UTF8, ""PtrP"", Table                   , ""IntP"", Rows, ""IntP"", Cols, ""PtrP"", Err, ""Cdecl Int"")       If (ErrorLevel) {          This.ErrorMsg := ""DLLCall sqlite3_get_table failed!""          This.ErrorCode := ErrorLevel          Return False       }       If (RC) {          This.ErrorMsg := StrGet(Err, ""UTF-8"")          This.ErrorCode := RC          DllCall(""SQLite3.dll\sqlite3_free"", ""Ptr"", Err, ""Cdecl"")          Return False       }       TB := new This._Table       TB.ColumnCount := Cols       TB.RowCount := Rows       If (MaxResult = -1) {          DllCall(""SQLite3.dll\sqlite3_free_table"", ""Ptr"", Table, ""Cdecl"")          If (ErrorLevel) {             This.ErrorMsg := ""DLLCall sqlite3_free_table failed!""             This.ErrorCode := ErrorLevel             Return False          }          Return True       }       If (MaxResult = -2)          GetRows := 0       Else If (MaxResult > 0) && (MaxResult <= Rows)          GetRows := MaxResult       Else          GetRows := Rows       Offset := 0       Names := Array()       Loop, %Cols% {          Names[A_Index] := StrGet(NumGet(Table+0, Offset, ""UPtr""), ""UTF-8"")          Offset += A_PtrSize       }       TB.ColumnNames := Names       TB.HasNames := True       Loop, %GetRows% {          I := A_Index          TB.Rows[I] := []          Loop, %Cols% {             TB.Rows[I][A_Index] := StrGet(NumGet(Table+0, Offset, ""UPtr""), ""UTF-8"")             Offset += A_PtrSize          }       }       If (GetRows)          TB.HasRows := True       DllCall(""SQLite3.dll\sqlite3_free_table"", ""Ptr"", Table, ""Cdecl"")       If (ErrorLevel) {          TB := """"          This.ErrorMsg := ""DLLCall sqlite3_free_table failed!""          This.ErrorCode := ErrorLevel          Return False       }       Return True    }    ; ===================================================================================================================    ; METHOD Query          Get ""recordset"" object for prepared SELECT query    ; Parameters:           SQL         - SQL SELECT statement    ;                       ByRef RS    - Variable to store the result object (Class _RecordSet)    ; Return values:        On success  - True, RS contains the result object    ;                       On failure  - False, ErrorMsg / ErrorCode contain additional information    ; ===================================================================================================================    Query(SQL, ByRef RS) {       RS := """"       This.ErrorMsg := """"       This.ErrorCode := 0       This.SQL := SQL       ColumnCount := 0       HasRows := False       If !(This._Handle) {          This.ErrorMsg := ""Invalid dadabase handle!""          Return False       }       If !RegExMatch(SQL, ""i)^\s*(SELECT|PRAGMA)\s|"") {          This.ErrorMsg := ""Method "" . A_ThisFunc . "" requires a query statement!""          Return False       }       Query := 0       This._StrToUTF8(SQL, UTF8)       RC := DllCall(""SQlite3.dll\sqlite3_prepare_v2"", ""Ptr"", This._Handle, ""Ptr"", &UTF8, ""Int"", -1                   , ""PtrP"", Query, ""Ptr"", 0, ""Cdecl Int"")       If (ErrorLeveL) {          This.ErrorMsg := ""DLLCall sqlite3_prepare_v2 failed!""          This.ErrorCode := ErrorLevel          Return False       }       If (RC) {          This.ErrorMsg := This._ErrMsg()          This.ErrorCode := RC          Return False       }       RC := DllCall(""SQlite3.dll\sqlite3_column_count"", ""Ptr"", Query, ""Cdecl Int"")       If (ErrorLevel) {          This.ErrorMsg := ""DLLCall sqlite3_column_count failed!""          This.ErrorCode := ErrorLevel          Return False       }       If (RC < 1) {          This.ErrorMsg := ""Query result is empty!""          This.ErrorCode := This._ReturnCode(""SQLITE_EMPTY"")          Return False       }       ColumnCount := RC       Names := []       Loop, %RC% {          StrPtr := DllCall(""SQlite3.dll\sqlite3_column_name"", ""Ptr"", Query, ""Int"", A_Index - 1, ""Cdecl UPtr"")          If (ErrorLevel) {             This.ErrorMsg := ""DLLCall sqlite3_column_name failed!""             This.ErrorCode := ErrorLevel             Return False          }          Names[A_Index] := StrGet(StrPtr, ""UTF-8"")       }       RC := DllCall(""SQlite3.dll\sqlite3_step"", ""Ptr"", Query, ""Cdecl Int"")       If (ErrorLevel) {          This.ErrorMsg := ""DLLCall sqlite3_step failed!""          This.ErrorCode := ErrorLevel          Return False       }       If (RC = This._ReturnCode(""SQLITE_ROW""))          HasRows := True       RC := DllCall(""SQlite3.dll\sqlite3_reset"", ""Ptr"", Query, ""Cdecl Int"")       If (ErrorLevel) {          This.ErrorMsg := ""DLLCall sqlite3_reset failed!""          This.ErrorCode := ErrorLevel          Return False       }       RS := new This._RecordSet       RS.ColumnCount := ColumnCount       RS.ColumnNames := Names       RS.HasNames := True       RS.HasRows := HasRows       RS._Handle := Query       RS._DB := This       This._Queries[Query] := Query       Return True    }    ; ===================================================================================================================    ; METHOD LastInsertRowID   Get the ROWID of the last inserted row    ; Parameters:              ByRef RowID - Variable to store the ROWID    ; Return values:           On success  - True, RowID contains the ROWID    ;                          On failure  - False, ErrorMsg / ErrorCode contain additional information    ; ===================================================================================================================    LastInsertRowID(ByRef RowID) {       This.ErrorMsg := """"       This.ErrorCode := 0       This.SQL := """"       If !(This._Handle) {          This.ErrorMsg := ""Invalid dadabase handle!""          Return False       }       RowID := 0       RC := DllCall(""SQLite3.dll\sqlite3_last_insert_rowid"", ""Ptr"", This._Handle, ""Cdecl Int64"")       If (ErrorLevel) {          This.ErrorMsg := ""DLLCall sqlite3_last_insert_rowid failed!""          This.ErrorCode := ErrorLevel          Return False       }       RowID := RC       Return True    }    ; ===================================================================================================================    ; METHOD TotalChanges   Get the number of changed rows since connecting to the database    ; Parameters:           ByRef Rows  - Variable to store the number of rows    ; Return values:        On success  - True, Rows contains the number of rows    ;                       On failure  - False, ErrorMsg / ErrorCode contain additional information    ; ===================================================================================================================    TotalChanges(ByRef Rows) {       This.ErrorMsg := """"       This.ErrorCode := 0       This.SQL := """"       If !(This._Handle) {          This.ErrorMsg := ""Invalid dadabase handle!""          Return False       }       Rows := 0       RC := DllCall(""SQLite3.dll\sqlite3_total_changes"", ""Ptr"", This._Handle, ""Cdecl Int"")       If (ErrorLevel) {          This.ErrorMsg := ""DLLCall sqlite3_total_changes failed!""          This.ErrorCode := ErrorLevel          Return False       }       Rows := RC       Return True    }    ; ===================================================================================================================    ; METHOD SetTimeout     Set the timeout to wait before SQLITE_BUSY or SQLITE_IOERR_BLOCKED is returned,    ;                       when a table is locked.    ; Parameters:           TimeOut     - Time to wait in milliseconds    ; Return values:        On success  - True    ;                       On failure  - False, ErrorMsg / ErrorCode contain additional information    ; ===================================================================================================================    SetTimeout(Timeout := 1000) {       This.ErrorMsg := """"       This.ErrorCode := 0       This.SQL := """"       If !(This._Handle) {          This.ErrorMsg := ""Invalid dadabase handle!""          Return False       }       If Timeout Is Not Integer          Timeout := 1000       RC := DllCall(""SQLite3.dll\sqlite3_busy_timeout"", ""Ptr"", This._Handle, ""Cdecl Int"")       If (ErrorLevel) {          This.ErrorMsg := ""DLLCall sqlite3_busy_timeout failed!""          This.ErrorCode := ErrorLevel          Return False       }       If (RC) {          This.ErrorMsg := This._ErrMsg()          This.ErrorCode := RC          Return False       }       Return True    }    ; ===================================================================================================================    ; METHOD EscapeStr      Escapes special characters in a string to be used as field content    ; Parameters:           Str         - String to be escaped    ;                       Quote       - Add single quotes around the outside of the total string (True / False)    ; Return values:        On success  - True    ;                       On failure  - False, ErrorMsg / ErrorCode contain additional information    ; ===================================================================================================================    EscapeStr(ByRef Str, Quote := True) {       This.ErrorMsg := """"       This.ErrorCode := 0       This.SQL := """"       If !(This._Handle) {          This.ErrorMsg := ""Invalid dadabase handle!""          Return False       }       If Str Is Number          Return True       OP := Quote ? ""%Q"" : ""%q""       This._StrToUTF8(Str, UTF8)       Ptr := DllCall(""SQLite3.dll\sqlite3_mprintf"", ""Ptr"", &OP, ""Ptr"", &UTF8, ""Cdecl UPtr"")       If (ErrorLevel) {          This.ErrorMsg := ""DLLCall sqlite3_mprintf failed!""          This.ErrorCode := ErrorLevel          Return False       }       Str := This._UTF8ToStr(Ptr)       DllCall(""SQLite3.dll\sqlite3_free"", ""Ptr"", Ptr, ""Cdecl"")       Return True    }    ; ===================================================================================================================    ; METHOD StoreBLOB      Use BLOBs as parameters of an INSERT/UPDATE/REPLACE statement.    ; Parameters:           SQL         - SQL statement to be compiled    ;                       BlobArray   - Array of objects containing two keys/value pairs:    ;                                     Addr : Address of the (variable containing the) BLOB.    ;                                     Size : Size of the BLOB in bytes.    ; Return values:        On success  - True    ;                       On failure  - False, ErrorMsg / ErrorCode contain additional information    ; Remarks:              For each BLOB in the row you have to specify a ? parameter within the statement. The    ;                       parameters are numbered automatically from left to right starting with 1.    ;                       For each parameter you have to pass an object within BlobArray containing the address    ;                       and the size of the BLOB.    ; ===================================================================================================================    StoreBLOB(SQL, BlobArray) {       Static SQLITE_STATIC := 0       Static SQLITE_TRANSIENT := -1       This.ErrorMsg := """"       This.ErrorCode := 0       If !(This._Handle) {          This.ErrorMsg := ""Invalid dadabase handle!""          Return False       }       If !RegExMatch(SQL, ""i)^\s*(INSERT|UPDATE|REPLACE)\s"") {          This.ErrorMsg := A_ThisFunc . "" requires an INSERT/UPDATE/REPLACE statement!""          Return False       }       Query := 0       This._StrToUTF8(SQL, UTF8)       RC := DllCall(""SQlite3.dll\sqlite3_prepare_v2"", ""Ptr"", This._Handle, ""Ptr"", &UTF8, ""Int"", -1                   , ""PtrP"", Query, ""Ptr"", 0, ""Cdecl Int"")       If (ErrorLeveL) {          This.ErrorMsg := A_ThisFunc . "": DLLCall sqlite3_prepare_v2 failed!""          This.ErrorCode := ErrorLevel          Return False       }       If (RC) {          This.ErrorMsg := A_ThisFunc . "": "" . This._ErrMsg()          This.ErrorCode := RC          Return False       }       For BlobNum, Blob In BlobArray {          If !(Blob.Addr) || !(Blob.Size) {             This.ErrorMsg := A_ThisFunc . "": Invalid parameter BlobArray!""             This.ErrorCode := ErrorLevel             Return False          }          RC := DllCall(""SQlite3.dll\sqlite3_bind_blob"", ""Ptr"", Query, ""Int"", BlobNum, ""Ptr"", Blob.Addr                      , ""Int"", Blob.Size, ""Ptr"", SQLITE_STATIC, ""Cdecl Int"")          If (ErrorLeveL) {             This.ErrorMsg := A_ThisFunc . "": DLLCall sqlite3_prepare_v2 failed!""             This.ErrorCode := ErrorLevel             Return False          }          If (RC) {             This.ErrorMsg := A_ThisFunc . "": "" . This._ErrMsg()             This.ErrorCode := RC             Return False          }       }       RC := DllCall(""SQlite3.dll\sqlite3_step"", ""Ptr"", Query, ""Cdecl Int"")       If (ErrorLevel) {          This.ErrorMsg := A_ThisFunc . "": DLLCall sqlite3_step failed!""          This.ErrorCode := ErrorLevel          Return False       }       If (RC) && (RC <> This._ReturnCode(""SQLITE_DONE"")) {          This.ErrorMsg := A_ThisFunc . "": "" . This._ErrMsg()          This.ErrorCode := RC          Return False       }       RC := DllCall(""SQlite3.dll\sqlite3_finalize"", ""Ptr"", Query, ""Cdecl Int"")       If (ErrorLevel) {          This.ErrorMsg := A_ThisFunc . "": DLLCall sqlite3_finalize failed!""          This.ErrorCode := ErrorLevel          Return False       }       If (RC) {          This.ErrorMsg := A_ThisFunc . "": "" . This._ErrMsg()          This.ErrorCode := RC          Return False       }       Return True    } } View sources on GitHub Download from GitHub Last edited by just me on 29 Mar 2016, 01:43, edited 6 times in total. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top arcticir Posts: 330 Joined: 17 Nov 2013, 11:32 Re: [Class] SQLiteDB Report this post Quote 19 Dec 2013, 05:15 Can you add support for ahk v2 it? I tried to modify, but always errors, especially reading and writing binary part. Thanks. Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] SQLiteDB Report this post Quote 19 Dec 2013, 09:51 I'll try, but it would be nice to have a separate v2 (sub)forum for v2 versions. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] SQLiteDB Report this post Quote 20 Dec 2013, 02:12 *Added v2 version (marginally tested)* Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top arcticir Posts: 330 Joined: 17 Nov 2013, 11:32 Re: [Class] SQLiteDB Report this post Quote 20 Dec 2013, 04:00 Thanks. I will transfer to V2. I used to add two functions make it more easy to use: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus Class_SQLiteDB(){ 	Return New SQLiteDB }   SQLite_(v){ 	Return InStr(v, ""`'"") ? StrReplace(v,""`'"",""`'`'"") : v } Top hoppfrosch Posts: 197 Joined: 07 Oct 2013, 04:05 GitHub: hoppfrosch Location: Rhine-Maine-Area, Hesse, Germany Contact: Contact hoppfrosch Website Re: [Class] SQLiteDB Report this post Quote 03 Jan 2014, 03:11 Hi just me, which one of your SQLite-Libs/Classes would you consider to be more mature and which one will you support in future: * Class_SQLiteDB as mentioned in this thread * or DBA The latter one, seems to have more recent modifications, but you have not mentioned it within this forum ... Which would you recommend to use? Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] SQLiteDB Report this post Quote 03 Jan 2014, 05:36 Hi hoppfrosch, the SQLite Lib/Class included in DBA is a (non-authorized ) version maintained by IsNull. Feel free to use it, but I will not support this version. BTW: I replaced the sample script on GitHub, thanks for reporting. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top hoppfrosch Posts: 197 Joined: 07 Oct 2013, 04:05 GitHub: hoppfrosch Location: Rhine-Maine-Area, Hesse, Germany Contact: Contact hoppfrosch Website Re: [Class] SQLiteDB Report this post Quote 03 Jan 2014, 05:42 Uh - I didn't realize that DBA is by IsNull ... I'll have a more detailled look in both of your libs ... Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] SQLiteDB Report this post Quote 03 Jan 2014, 05:52 The most important difference is the handling of BLOBs. It's better integrated in IsNull's version. Maybe I'll try to rewrite my version, too. But personally I don't need (large) BLOBs, and there are other ways like Base64 or Hex encoding to store and read binary content. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top whippy Posts: 2 Joined: 10 Jan 2014, 13:08 Re: [Class] SQLiteDB Report this post Quote 10 Jan 2014, 13:12 Hello. I have tried to get this working but continually get an error message on Line 28 of the Class ahk saying that BaseClass is an unknown class. I have the SQLite3.dll ver 3.8 from the website in the directory, also tried moving it into a subfolder and using the ini file to set path, but nothing seems to work. Help, not sure what i need to be doing? Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] SQLiteDB Report this post Quote 11 Jan 2014, 00:20 Changelog wrote:1.1.11.00 - June 21, 2013 Fixed class X extends Y to allow Y to be defined after X. Seems that you'll have to update your AHK. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top whippy Posts: 2 Joined: 10 Jan 2014, 13:08 Re: [Class] SQLiteDB Report this post Quote 12 Jan 2014, 09:35 Many thanks. Top djvj11 Posts: 14 Joined: 21 Jun 2014, 01:30 Re: [Class] SQLiteDB Report this post Quote 07 Jul 2014, 17:06 Having trouble just launching the sample script, getting this error: Error in line 28 in #Include \Class_SQLiteDB.ahk Line Text: SQLiteDB.Base.Class Error: Unknown Class I'm using AHK_H v1.1.9.4 ANSI 32-bit. H is based off L, so it should work. I don't get the Class error using the DBA sqlite library, but I have another error later on with objects. Was hoping to get one of these libraries to work. Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] SQLiteDB Report this post Quote 08 Jul 2014, 02:46 Sorry, but I didn't use AHK_H as yet. If there are incompatibilities between the two versions, they should be fixed in AHK_H. Last edited by just me on 08 Jul 2014, 11:36, edited 1 time in total. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] SQLiteDB Report this post Quote 08 Jul 2014, 11:34 I'm using AHK_H v1.1.9.4 ANSI 32-bit. I overlooked that. You need an AHK_H version based on AHK 1.1.11.00+ -> Fixed class X extends Y to allow Y to be defined after X. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top HotKeyIt Posts: 993 Joined: 29 Sep 2013, 18:35 Contact: Contact HotKeyIt Website Re: [Class] SQLiteDB Report this post Quote 08 Jul 2014, 13:40 Get latest AHK_H v1 or AHK_H v2. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: [Class] SQLiteDB Report this post Quote 08 Jul 2014, 14:29 Repo star'd! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Gicu Posts: 24 Joined: 19 Aug 2014, 08:19 Location: Italy Re: [Class] SQLiteDB Report this post Quote 08 May 2015, 10:40 Thanks a lot! Top arcticir Posts: 330 Joined: 17 Nov 2013, 11:32 Re: [Class] SQLiteDB Report this post Quote 25 Aug 2015, 01:57 V2 now is wrong, can fix it? Thanks. Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] SQLiteDB Report this post Quote 25 Aug 2015, 02:23 What's wrong? Which error is reported? I do not use v2 at the moment. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 51 posts 1 2 3 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: pondermatic and 14 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by just Me - AHK SQLite API wrapper class. Forum thread:."	"true"
"Filesystem"	"FileGetProperties"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=3806"	"by kon - Functions for retrieving extended file properties."	"null"	"null"	"null"	"null"	"null"	""	"null"	"null"	"null"	"null"	"[Function] FGP - FileGetProperties - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:26 All times are UTC-05:00 [Function] FGP - FileGetProperties Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 10 posts • Page 1 of 1 kon Posts: 1252 Joined: 29 Sep 2013, 17:11 [Function] FGP - FileGetProperties Report this post Quote 25 Jun 2014, 19:01 FGP - FileGetProperties Functions for retrieving extended file properties. Example Usage Code: [Select all] [Expand] [Download] (FGP_Example.ahk)GeSHi © Codebox Plus #NoEnv SetBatchLines, -1 FileSelectFile, FilePath					; Select a file to use for this example.   PropName := FGP_Name(0)						; Gets a property name based on the property number. PropNum  := FGP_Num(""Size"")					; Gets a property number based on the property name. PropVal1 := FGP_Value(FilePath, PropName)	; Gets a file property value by name. PropVal2 := FGP_Value(FilePath, PropNum)	; Gets a file property value by number. PropList := FGP_List(FilePath)				; Gets all of a file's non-blank properties.   MsgBox, % PropName "":`t"" PropVal1			; Display the results. . ""`n"" PropNum "":`t"" PropVal2 . ""`n`nList:`n"" PropList.CSV Functions Code: [Select all] [Expand] [Download] (FGP.ahk)GeSHi © Codebox Plus /*  FGP_Init()  *		Gets an object containing all of the property numbers that have corresponding names.  *		Used to initialize the other functions.  *	Returns  *		An object with the following format:  *			PropTable.Name[""PropName""]	:= PropNum  *			PropTable.Num[PropNum]		:= ""PropName""  */ FGP_Init() { 	static PropTable 	if (!PropTable) { 		PropTable := {Name: {}, Num: {}}, Gap := 0 		oShell := ComObjCreate(""Shell.Application"") 		oFolder := oShell.NameSpace(0) 		while (Gap < 11) 			if (PropName := oFolder.GetDetailsOf(0, A_Index - 1)) { 				PropTable.Name[PropName] := A_Index - 1 				PropTable.Num[A_Index - 1] := PropName 				Gap := 0 			} 			else 				Gap++ 	} 	return PropTable }     /*  FGP_List(FilePath)  *		Gets all of a file's non-blank properties.  *	Parameters  *		FilePath	- The full path of a file.  *	Returns  *		An object with the following format:  *			PropList.CSV				:= ""PropNum,PropName,PropVal`r`n...""  *			PropList.Name[""PropName""]	:= PropVal  *			PropList.Num[PropNum]		:= PropVal  */ FGP_List(FilePath) { 	static PropTable := FGP_Init() 	SplitPath, FilePath, FileName, DirPath 	oShell := ComObjCreate(""Shell.Application"") 	oFolder := oShell.NameSpace(DirPath) 	oFolderItem := oFolder.ParseName(FileName) 	PropList := {CSV: """", Name: {}, Num: {}} 	for PropNum, PropName in PropTable.Num 		if (PropVal := oFolder.GetDetailsOf(oFolderItem, PropNum)) { 			PropList.Num[PropNum] := PropVal 			PropList.Name[PropName] := PropVal 			PropList.CSV .= PropNum "","" PropName "","" PropVal ""`r`n"" 		} 	PropList.CSV := RTrim(PropList.CSV, ""`r`n"") 	return PropList }     /*  FGP_Name(PropNum)  *		Gets a property name based on the property number.  *	Parameters  *		PropNum		- The property number.  *	Returns  *		If succesful the file property name is returned. Otherwise:  *		-1			- The property number does not have an associated name.  */ FGP_Name(PropNum) { 	static PropTable := FGP_Init() 	if (PropTable.Num[PropNum] != """") 		return PropTable.Num[PropNum] 	return -1 }     /*  FGP_Num(PropName)  *		Gets a property number based on the property name.  *	Parameters  *		PropName	- The property name.  *	Returns  *		If succesful the file property number is returned. Otherwise:  *		-1			- The property name does not have an associated number.  */ FGP_Num(PropName) { 	static PropTable := FGP_Init() 	if (PropTable.Name[PropName] != """") 		return PropTable.Name[PropName] 	return -1 }     /*  FGP_Value(FilePath, Property)  *		Gets a file property value.  *	Parameters  *		FilePath	- The full path of a file.  *		Property	- Either the name or number of a property.  *	Returns  *		If succesful the file property value is returned. Otherwise:  *		0			- The property is blank.  *		-1			- The property name or number is not valid.  */ FGP_Value(FilePath, Property) { 	static PropTable := FGP_Init() 	if ((PropNum := PropTable.Name[Property] != """" ? PropTable.Name[Property] 	: PropTable.Num[Property] ? Property : """") != """") { 		SplitPath, FilePath, FileName, DirPath 		oShell := ComObjCreate(""Shell.Application"") 		oFolder := oShell.NameSpace(DirPath) 		oFolderItem := oFolder.ParseName(FileName) 		if (PropVal := oFolder.GetDetailsOf(oFolderItem, PropNum)) 			return PropVal 		return 0 	} 	return -1 } File properties numbers will vary depending on your system. This is the reason some functions generate a static look-up table. Files will not necessarily have values for every property. i.e. The ""Authors"" property is used by some MSOffice files, but it is blank in the majority of other cases. References COM Object Reference entry by sbc GetDetailsOf ParseName Retrieving Extended File Properties Look-up table by just me Change Log July 5, 2014 Changed FGP_Init so that the other functions all contain static references to the same PropTable object instead of each function having its own array. Replaced FGP_ByName and FGP_ByNum with the new function FGP_Value. The new function accepts either a property name or number as its second parameter and returns the property value. Changed FGP_Name to return -1 instead of 0 in the event the property number does not have an associated name. The reason for the change is for consistency with FGP_Num. FGP_Num cannot return 0 as an error code because 0 is a valid property number.June 27, 2014 Added the FGP_List function to get all of a file's non-blank properties. Changed FGP_Init's returned array to use a zero-based index. Changed FGP_Num to use a look-up table instead of looping. Last edited by kon on 05 Jul 2014, 02:46, edited 3 times in total. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: [Function] FGP - FileGetProperties Report this post Quote 25 Jun 2014, 19:19 Providing an MSDN link or a list of properties would be great. Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top kon Posts: 1252 Joined: 29 Sep 2013, 17:11 Re: [Function] FGP - FileGetProperties Report this post Quote 25 Jun 2014, 20:33 I moved the reference URL's from the comments to actual links (much better, thanks joedf). Also, I added a bit of an explanation regarding property numbers varying. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: [Function] FGP - FileGetProperties Report this post Quote 25 Jun 2014, 21:10 Great! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top kon Posts: 1252 Joined: 29 Sep 2013, 17:11 Re: [Function] FGP - FileGetProperties Report this post Quote 27 Jun 2014, 14:49 Some updates to the functions: Added the FGP_List function to get all of a file's non-blank properties. Changed FGP_Init's returned array to use a zero-based index. Changed FGP_Num to use a look-up table instead of looping. Top elmo Posts: 35 Joined: 09 Oct 2013, 09:08 Re: [Function] FGP - FileGetProperties Report this post Quote 27 Jun 2014, 16:39 Quite elegant. Thank you. Top kon Posts: 1252 Joined: 29 Sep 2013, 17:11 Re: [Function] FGP - FileGetProperties Report this post Quote 05 Jul 2014, 02:50 Update: Changed FGP_Init so that the other functions all contain static references to the same PropTable object instead of each function having its own array. Replaced FGP_ByName and FGP_ByNum with the new function FGP_Value. The new function accepts either a property name or number as its second parameter and returns the property value. Changed FGP_Name to return -1 instead of 0 in the event the property number does not have an associated name. The reason for the change is for consistency with FGP_Num. FGP_Num cannot return 0 as an error code because 0 is a valid property number. Top jiggunjer Posts: 13 Joined: 16 Jan 2016, 04:00 Re: [Function] FGP - FileGetProperties Report this post Quote 18 Jan 2016, 22:40 can these properties be used to differentiate a compressed (e.g. zip/rar) from a 'normal' file (e.g. txt, jpeg, etc). The compressed field from the default ""FileGetAttrib"" is unreliable. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: [Function] FGP - FileGetProperties Report this post Quote 18 Jan 2016, 23:33 Well, you could have a custom function to check for the ""file magic number"" and determine zip and rar, etc Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: [Function] FGP - FileGetProperties Report this post Quote 19 Jan 2016, 00:27 The compressed field from the default ""FileGetAttrib"" is unreliable.The ""Compressed"" attribute is about file system compression, not about what type of data the file contains. It's the ""Compress contents to save disk space"" option in the file's properties, under ""Advanced"". Usually names of compressed files are displayed with blue text in Explorer. Windows does not ""know"" about all compressed file types natively, and it's doubtful that all of the different archiving programs mark the file in some way that's common between file types. So if you want to identify whether a file is a compressed archive or not, you need to know about each file type (filename extension or some signature within the data). Or you could utilize an external program or library, like the 7-zip DLL. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 10 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: pondermatic and 14 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by kon - Functions for retrieving extended file properties."	"true"
"Graphics"	"GDIp"	"https://github.com/tariqporter/Gdip/"	"by tic - Full featured library that helps in interaction with Microsoft's gdiplus.dll - Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"20"	"4"	"7"	"GitHub - tariqporter/Gdip: GDI+ library for Autohotkey Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 4 Star 20 Fork 7 tariqporter/Gdip Code Issues 0 Pull requests 0 Pulse Graphs GDI+ library for Autohotkey 23 commits 2 branches 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags GdipDOM master Nothing to show Nothing to show New pull request Latest commit cb0fb42 Apr 23, 2015 tariqporter Removed beta test files Permalink Failed to load latest commit information. BRA.ahk Gdip.Tutorial.1-Draw.Shapes.ahk Gdip.Tutorial.10-Rotate.Flip.or.Mirror.an.image.ahk Gdip.Tutorial.11-Using.BRAs.to.perform.animations.ahk Gdip.Tutorial.12-Pixelate.a.bitmap.using.machine.code.ahk Gdip.Tutorial.2-Draw.Outlined.Shapes.ahk Gdip.Tutorial.3-Create.Gui.From.Image.ahk Gdip.Tutorial.4-Draw.Circles.ahk Add files Feb 24, 2015 Gdip.Tutorial.5-Create.Bitmap.ahk Gdip.Tutorial.6-Image.Editing.ahk Gdip.Tutorial.7-Draw.draggable.rounded.rectangle.ahk Gdip.Tutorial.8-Write.text.onto.a.gui.ahk Gdip.Tutorial.9-Create.a.progress.bar.on.standard.gui.ahk Gdip.ahk Add files Feb 24, 2015 Gdip.tutorial.file-fish.bra README.md gdiplus.dll README.md GDI+ standard library for Autohotkey Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/tariqporter/Gdip/"	"by tic - Full featured library that helps in interaction with Microsoft's gdiplus.dll - Forum thread:."	"true"
"Graphics"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=6517"	"by tic - Full featured library that helps in interaction with Microsoft's gdiplus.dll - Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"GDI+ standard library 1.45 by tic - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:26 All times are UTC-05:00 GDI+ standard library 1.45 by tic Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 113 posts 1 2 3 4 5 6 Next tic Posts: 79 Joined: 03 Nov 2014, 03:10 GDI+ standard library 1.45 by tic Report this post Quote 23 Feb 2015, 17:32 Download: Gdip.ahk Alternative Download: Gdip All (Alternate link for other versions of AHK: 32, 64, unicode, ansi) Full featured gdi+ library with examples by me tic (Tariq Porter) Supports AHK and AHK_L This library can be distributed for commercial and non-commercial use and I actively encourage both. I would appreciate it if people give acknowledgement for my work and would be nice to have pasted once at the top of your script something similar to: Thanks to tic (Tariq Porter) for his GDI+ Library ahkscript.org/boards/viewtopic.php?t=6517 or anything more elaborate if you feel like it! A big thank you to Lexikos and Sean for their help and contributions If your OS is not >= XP then you will need gdiplus.dll A link to the original post as there is so much information contained in those 93 pages: https://autohotkey.com/board/topic/2944 ... 45-by-tic/ Examples Example 1: Gdip.Tutorial.1-Draw.Shapes.ahk - Create a simple gui and draw an ellipse and a rectangle Example 2: Gdip.Tutorial.2-Draw.Outlined.Shapes.ahk - Create a simple gui and draw the outlines of an ellipse and a rectangle Example 3: Gdip.Tutorial.3-Create.Gui.From.Image.ahk - Create a gui from an existing image on disk Example 4: Gdip.Tutorial.4-Draw.Circles.ahk - Create a fullscreen gui and fill it with random ellipses Example 5: Gdip.Tutorial.5-Create.Bitmap.ahk - Put a few shapes into a bitmap and save to a "".png"" filetype Example 6: Gdip.Tutorial.6-Image.Editing.ahk - Take files from disk, load them onto a background and save to a "".png"" filetype Example 7: Gdip.Tutorial.7-Draw.draggable.rounded.rectangle.ahk - Draw a rounded rectangle for a gui and allow it to be dragged with the left click of the mouse Example 8: Gdip.Tutorial.8-Write.text.onto.a.gui.ahk - Take the rounded rectangle gui and add text to it, showing all the text options possible Example 9: Gdip.Tutorial.9-Create.a.progress.bar.on.standard.gui.ahk - Create a nice looking progress bar using the library in a standard gui Example 10: Gdip.Tutorial.10-Rotate.Flip.or.Mirror.an.image.ahk - Rotate, flip or mirror an image on a layered window The BRA Library so far: BRA.ahk Example 11: Gdip.Tutorial.11-Using.BRAs.to.perform.animations.ahk - Using BRA files to transport many images with your script and show animation Please also download the BRA here: Gdip.tutorial.file-fish.bra Example 12: Gdip.Tutorial.12-Pixelate.a.bitmap.using.machine.code - Use LockBits and machine code to pixelate an image and update it quickly Top tic Posts: 79 Joined: 03 Nov 2014, 03:10 Re: GDI+ standard library 1.45 by tic Report this post Quote 23 Feb 2015, 17:33 File links will be moved from autohotkey.com. Support will also be dropped for the old autohotkey, and library updated to take advantage of objects Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: GDI+ standard library 1.45 by tic Report this post Quote 23 Feb 2015, 18:12 Great to see you've moved it over here. Is there an ETA on any updates? Or is it more of a ""I've planned it, but who knows if it'll ever get done""? AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: GDI+ standard library 1.45 by tic Report this post Quote 23 Feb 2015, 18:32 Awesome. Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top tic Posts: 79 Joined: 03 Nov 2014, 03:10 Re: GDI+ standard library 1.45 by tic Report this post Quote 24 Feb 2015, 14:38 GeekDude wrote:Great to see you've moved it over here. Is there an ETA on any updates? Or is it more of a ""I've planned it, but who knows if it'll ever get done""? Good question! I would like to be proactive and welcome any nudging every now and again to get me going. I've taken the first 2 steps at least....I've created this post, and have now moved all the links to github, which will make changes much easier to track. https://github.com/tariqporter/Gdip Next step is to decide on the best way to treat gdi and gdi+ bitmaps and graphics and their associated handles/pointers as objects. I have an idea of how, but would need testing to see if it works comfortably in practice. Top tic Posts: 79 Joined: 03 Nov 2014, 03:10 Re: GDI+ standard library 1.45 by tic Report this post Quote 24 Feb 2015, 15:16 As a proposed possibility, how does the following look? Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus pToken := Gdip_Startup()   w := A_ScreenWidth, h := A_ScreenHeight gui1 := Gdip_GuiCreate() obj1 := Gdip_ObjectCreate(w, h)   brush1 := Gdip_BrushCreate(0xff00ff00) obj1.FillEllipse(brush1, w/2, h/2, 50, 50) gui1.Update(obj1, 0, 0, w, h) brush1.Dispose()   obj1.Dispose() Gdip_Shutdown(pToken) return It is not completely thought out, as I would need to consider how to handle gdi bitmaps for windows and gdi+ bitmaps for the file system, but if I get enough thoughts on this then I can begin work. Any better naming than Gdip_ObjectCreate() ? Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: GDI+ standard library 1.45 by tic Report this post Quote 24 Feb 2015, 19:03 Code: [Select all] [Download] GeSHi © Codebox Plus obj1 := new Gdip.Object() brush1 := new Gdip.Brush(0xFF00FF00) etc And dispose should probably be handled in __Delete if it was not called manually. AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: GDI+ standard library 1.45 by tic Report this post Quote 24 Feb 2015, 22:26 I suppose that you could model it after the GDI+ object model in .NET. Top Soft Posts: 147 Joined: 07 Jan 2015, 13:18 GitHub: visionary1 Location: Seoul Contact: Contact Soft Website Re: GDI+ standard library 1.45 by tic Report this post Quote 25 Feb 2015, 03:52 nice to see you here! AutoHotkey & AutoHotkey_H v1.1.22.07 Top Pacsa Posts: 7 Joined: 02 Mar 2015, 11:02 Gdip_All.ahk stopped working after updating Autohotkey Report this post Quote 02 Mar 2015, 11:09 Hi guys, yesterday, I updated my AutoHotKey from 1.1.10.01 to 1.1.19.03 on my Win7 64bit machine. I had been using this script http://www.autohotkey.com/board/topic/6 ... /?p=662909 for quite a while without problems. Unfortunately it stopped working after the update. To be exact, it's still working in the background, but the clock itself doesn't appear on the screen any more. This is why I suspect that something is broken on the graphical side. That script was not written by me originally, I just added some non-graphics-related features, so I don't have much experience about how to go around with Gdip_All.ahk. Anyway, it was working fine with v1.1.10.01, and it is not working now. Btw, I also updated Gdip_All.ahk from the version at http://www.autohotkey.net/~Rseding91/Gd ... ip_All.ahk to the version shared in the first post of tic, which was updated last on 2/20/2014, but I experience the same. Do you have any ideas, what could be the reason? I also checked the recent changes in AutoHotKey, but I couldn't find a relevant change. Your help is much appreciated. Csaba Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: GDI+ standard library 1.45 by tic Report this post Quote 02 Mar 2015, 11:14 Working here, as far as I can tell AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top Pacsa Posts: 7 Joined: 02 Mar 2015, 11:02 Re: GDI+ standard library 1.45 by tic Report this post Quote 02 Mar 2015, 11:21 I envy you. Are you using the most recent version of Autohotkey v1.1.19.03? Your operating system? Mine is Win7 Pro SP1 64-bit. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: GDI+ standard library 1.45 by tic Report this post Quote 02 Mar 2015, 11:23 I'm using 1.1.19.03-22+g2609ddd (bleeding edge test build), on Win7 Pro SP1 32-bit. Are you using 32 or 64 bit AutoHotkey? AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top Pacsa Posts: 7 Joined: 02 Mar 2015, 11:02 Re: GDI+ standard library 1.45 by tic Report this post Quote 02 Mar 2015, 11:28 Unicode 64-bit. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: GDI+ standard library 1.45 by tic Report this post Quote 02 Mar 2015, 11:29 Try using unicode 32 bit instead AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top Pacsa Posts: 7 Joined: 02 Mar 2015, 11:02 Re: GDI+ standard library 1.45 by tic Report this post Quote 02 Mar 2015, 11:45 Sadly, still the same. It is not working. I even tried the ansi version. Thanks though. Top Pacsa Posts: 7 Joined: 02 Mar 2015, 11:02 Re: GDI+ standard library 1.45 by tic Report this post Quote 02 Mar 2015, 15:42 I downloaded the old version, and now I can run the script again, just as before. I tried some more recent ones, and it turned out that the clock is failing already with the next one: v1.1.11.00. I only tried the x64 versions. So it looks like the changes appearing first in v1.1.11.00 make the difference?.. And at the same time, it seems to affect only x64 machines? At least me, but as we see, GeekDude can run it on a 32 bit system, but for me it's not working even with the 32 bit executable. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: GDI+ standard library 1.45 by tic Report this post Quote 02 Mar 2015, 16:23 Maybe it's DPI related? I have my DPI set to the normal value of 96, what's your set to? AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top Pacsa Posts: 7 Joined: 02 Mar 2015, 11:02 Re: GDI+ standard library 1.45 by tic Report this post Quote 03 Mar 2015, 03:56 Yes, indeed, it was the DPI. I was using the default 125% setting, now it's on 100%, and the script is working again. Thanks for the hint. Nevertheless, I quite liked the 125% DPI. Is there a way the to return to that? The only thing I could think of was to disable the new feature by adding the line: Gui -DPIScale It didn't work. Right now I don't have the time to read all the relevant parts of the manual (of Autohotkey or the GDI+ library?), but I have the feeling that this feature was not meant to work this way. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: GDI+ standard library 1.45 by tic Report this post Quote 03 Mar 2015, 08:10 I've updated the line UpdateLayeredWindow(hwnd1, hdc) to UpdateLayeredWindow(hwnd1, hdc, 0, 0, WinWidth, WinHeight) in this section here, and it seems to work on non-standard DPIs now: Code: [Select all] [Download] GeSHi © Codebox Plus write_display_text_clock: Gdip_SetCompositingMode(G, 1) Gdip_FillRoundedRectangle(G, pBrush, 0, 0, WinWidth, WinHeight, 5) Gdip_SetCompositingMode(G, 0) Options = x0 y6 w140 %display_color% Center %display_size% Gdip_TextToGraphics(G, displaytext, Options, Font, winWidth, winHeight) UpdateLayeredWindow(hwnd1, hdc, 0, 0, WinWidth, WinHeight) return AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 113 posts 1 2 3 4 5 6 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: pondermatic and 14 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by tic - Full featured library that helps in interaction with Microsoft's gdiplus.dll - Forum thread:."	"true"
"Graphics"	"GDIp_ImageSearch"	"https://autohotkey.com/board/topic/71100-"	"by tic - Library using gdiplus.dll for searching image instances on the screen. See the end of that thread for MasterFocus' improved version, or see his"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Gdip_ImageSearch - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. Gdip_ImageSearch Started by tic , Sep 06 2011 04:29 PM Page 1 of 5 1 2 3 Next » Please log in to reply 63 replies to this topic tic Members 1934 posts Last active: Dec 21 2015 01:05 PM Joined: 22 Apr 2007 I'm putting this here as it continually gets lost in the GDI+ thread. This is still a work in progress so can't be included in the library. Further testing is needed as there are still problems with it. There are 2 parts that everything needs to be tested with; with variation and without. Bugs: [*:3qersqza]With variation, a no match takes a long time to complete [*:3qersqza]It has been reported that w and h paramteres work on neither Gdip_ImageSearch(pBitmapHayStack, pBitmapNeedle, ByRef x, ByRef y, Variation=0, sx="""", sy="""", w="""", h="""") {    static _ImageSearch1, _ImageSearch2    if !_ImageSearch1    {       MCode_ImageSearch1 := ""83EC108B44242C9983E20303C28BC88B4424309983E20303C253C1F80255894424148B44244056C1F9023B44244C578944244""       . ""80F8DCA0000008B7C24348D148D000000000FAFC88B442444895424148B54242403C88D1C8A8B4C244C895C24183BC1894424407D7A895C24108D6424""       . ""008B6C2428C744243C000000008D6424008B44243C3B4424380F8D9400000033C985FF7E178BD58BF38B063B02752283C10183C20483C6043BCF7CED8""       . ""B44241C035C24148344243C0103C003C003E8EBC08B4424408B5C24108B4C244C83C00183C3043BC189442440895C24107C928B4424448B5424488B5C""       . ""2418035C241483C2013B54245089542448895C24180F8C5DFFFFFF8B5424548B4424585F5EC702FFFFFFFF5DC700FFFFFFFF83C8FF5B83C410C38B4C2""       . ""4548B5424408B4424585F89118B4C24445E5D890833C05B83C410C3""        VarSetCapacity(_ImageSearch1, StrLen(MCode_ImageSearch1)//2)       Loop % StrLen(MCode_ImageSearch1)//2      ;%          NumPut(""0x"" SubStr(MCode_ImageSearch1, (2*A_Index)-1, 2), _ImageSearch1, A_Index-1, ""char"")    }     if !_ImageSearch2    {       MCode_ImageSearch2 :=""83EC1C8B4424443B44244C535556578944241C0F8D760100008B4C24488B5424580FAFC88B4424608B742440894C24188B4C24""       . ""503BCA894C24140F8D320100008B54241833FF897C24108B5C24103B5C2444897C2428895424240F8D4E01000085F6C7442420000000000F8ECD00000""       . ""08B7424348D148A8B4C243003F7897424548D1C0AEB0A8DA424000000008D49008B6C2454B9030000000FB60C19BE030000000FB6342E8D2C013BF50F""       . ""8FA20000002BC83BF10F8C980000008B4C24300FB64C0A028B7424340FB67437028D2C013BF57F7F2BC83BF17C798B4C24300FB64C0A018B7424340FB""       . ""67437018D2C013BF57F602BC83BF17C5A0FB60B8B7424540FB6368D2C013BF57F492BC83BF17C438B4C24208B742440834424540483C10183C20483C3""       . ""0483C7043BCE894C24200F8C5BFFFFFF8B4C24148B7C24288B542424035424488344241001037C244CE9F7FEFFFF8B4C24148B5424588B74244083C10""       . ""13BCA894C24140F8CD2FEFFFF8B4C24508B7C241C8B5C2448015C241883C7013B7C245C897C241C0F8CA5FEFFFF8B5424648B4424685F5EC702FFFFFF""       . ""FF5DC700FFFFFFFF83C8FF5B83C41CC38B5424648B4424685F890A8B4C24185E5D890833C05B83C41CC3""        VarSetCapacity(_ImageSearch2, StrLen(MCode_ImageSearch2)//2)       Loop % StrLen(MCode_ImageSearch2)//2      ;%          NumPut(""0x"" SubStr(MCode_ImageSearch2, (2*A_Index)-1, 2), _ImageSearch2, A_Index-1, ""char"")    }        if (Variation > 255 || Variation < 0)       return -2     Gdip_GetImageDimensions(pBitmapHayStack, hWidth, hHeight), Gdip_GetImageDimensions(pBitmapNeedle, nWidth, nHeight)        if !(hWidth && hHeight && nWidth && nHeight)       return -3    if (nWidth > hWidth || nHeight > hHeight)       return -4        sx := (sx = """") ? 0 : sx    sy := (sy = """") ? 0 : sy    w := (w = """") ? hWidth-sx : w    h := (h = """") ? hHeight-sy : h        if (sx+w > hWidth-nWidth)       w := hWidth-sx-nWidth+1        if (sy+h > hHeight-nHeight)       h := hHeight-sy-nHeight+1           E1 := Gdip_LockBits(pBitmapHayStack, 0, 0, hWidth, hHeight, Stride1, Scan01, BitmapData1)    E2 := Gdip_LockBits(pBitmapNeedle, 0, 0, nWidth, nHeight, Stride2, Scan02, BitmapData2)    if (E1 || E2)       return -5     x := y := 0    if (Variation = 0)    {       E := DllCall(&_ImageSearch1, ""uint"", Scan01, ""uint"", Scan02, ""int"", hWidth, ""int"", hHeight, ""int"", nWidth, ""int"", nHeight, ""int"", Stride1       , ""int"", Stride2, ""int"", sx, ""int"", sy, ""int"", w, ""int"", h, ""int*"", x, ""int*"", y)    }    else    {       E := DllCall(&_ImageSearch2, ""uint"", Scan01, ""uint"", Scan02, ""int"", hWidth, ""int"", hHeight, ""int"", nWidth, ""int"", nHeight, ""int"", Stride1       , ""int"", Stride2, ""int"", sx, ""int"", sy, ""int"", w, ""int"", h, ""int"", Variation, ""int*"", x, ""int*"", y)    }    Gdip_UnlockBits(pBitmapHayStack, BitmapData1), Gdip_UnlockBits(pBitmapNeedle, BitmapData2)    return (E = """") ? -6 : E }  int Gdip_ImageSearch1(unsigned int * HayStack, unsigned int * Needle, int w1, int h1, int w2, int h2, int Stride1, int Stride2, int sx, int sy, int w, int h, int * x, int * y) {    int tx, ty;    int offset1 = Stride1/4, offset2 = Stride2/4;    for (int y1 = sy; y1 < h; ++y1)    {       for (int x1 = sx; x1 < w; ++x1)       {          ty = y1;          for (int y2 = 0; y2 < h2; ++y2)          {             tx = x1;             for (int x2 = 0; x2 < w2; ++x2)             {                if (HayStack[tx+(ty*offset1)] != Needle[x2+(y2*offset2)])                   goto NoMatch;                tx++;             }             ty++;          }          x[0] = x1; y[0] = y1;          return 0;          NoMatch:          continue;       }    }    x[0] = -1; y[0] = -1;    return -1; } int Gdip_ImageSearch2(unsigned char * HayStack, unsigned char * Needle, int w1, int h1, int w2, int h2, int Stride1, int Stride2, int sx, int sy, int w, int h, int v, int * x, int * y) {    int tx, ty, ph, pn, Ah, Rh, Gh, Bh, An, Rn, Gn, Bn;    for (int y1 = sy; y1 < h; ++y1)    {       for (int x1 = sx; x1 < w; ++x1)       {          ty = y1;          for (int y2 = 0; y2 < h2; ++y2)          {             tx = x1;             for (int x2 = 0; x2 < w2; ++x2)             {                ph = (4*tx)+(ty*Stride1);                pn = (4*x2)+(y2*Stride2);                 Ah = HayStack[3+ph]; An = Needle[3+pn];                if (An > Ah+v || An < Ah-v) goto NoMatch;                 Rh = HayStack[2+ph]; Rn = Needle[2+pn];                if (Rn > Rh+v || Rn < Rh-v) goto NoMatch;                 Gh = HayStack[1+ph]; Gn = Needle[1+pn];                if (Gn > Gh+v || Gn < Gh-v) goto NoMatch;                 Bh = HayStack[ph]; Bn = Needle[pn];                if (Bn > Bh+v || Bn < Bh-v) goto NoMatch;                                tx++;             }             ty++;          }          x[0] = x1; y[0] = y1;          return 0;          NoMatch:          continue;       }    }    x[0] = -1; y[0] = -1;    return -1; } #1 - Posted 06 September 2011 - 04:29 PM Back to top Iggy_ Members 90 posts Last active: Nov 16 2012 05:55 PM Joined: 29 May 2011 Hi tic, thanks for posting this, I was never sure when I was using the gdi+ image search what version was working or latest or what. Would it be possible to also include a parameter to allow a transparent color to be specified, like the *TransN AHK imagesearch option? The reason I ask is because I have some scripts which use pngs where RGB:FF00FF is the transparent color, and I'd like to at some point add some features which would require doing these searches on GDI bitmaps instead. I know you can make pngs which have real transparency encoded, but neither MSPaint nor the PaintShopPro version I have can save them like this, so it's convenient to just use pink. Or maybe it would be more appropriate to run some sort of image processing function to set a color in the gdi bitmap transparent prior to searching - I don't know. Sorry if this has already been requested/discussed, but I thought I'd mention it, since it would make it more easily interchangeable with the AHK imagesearch, if you could specify a transparent color. Thanks. #2 - Posted 09 September 2011 - 02:54 PM Back to top imagy Guests Last active: Joined: -- this looks so complicate, im quite new to autohotkey, can someone explain allittle about how to use this script , such as an example #3 - Posted 16 September 2011 - 01:14 AM Back to top closed Members 509 posts Last active: Jan 14 2012 06:14 PM Joined: 07 Feb 2008 is it possible to take a screenshot of the background window, and then use 'imagesearch' to find the coodinate in another word, can i imagesearch on a picture-file instead of the screen #SingleInstance, Force #NoEnv SetBatchLines, -1  #include gdip.ahk   ; download from here http://www.autohotkey.com/forum/topic32238.html    If !pToken := Gdip_Startup() {    MsgBox, 48, gdiplus error!, Gdiplus failed to start. Please ensure you have gdiplus on your system    ExitApp }  file1=e:\imagetosearch_for.png      ;filepath to image to search in image  file2=e:\imagetosearch_in.png       ;filepath to imagefile    pBitmapneedle:=Gdip_CreateBitmapFromFile(file1) pBitmapHaystack:=Gdip_CreateBitmapFromFile(file2)  Gdip_ImageSearch( pBitmapHayStack,pBitmapNeedle,  x,  y)   msgbox x coord =%x% y coord= %y%     Gdip_DisposeImage(pBitmaphaystack) Gdip_DisposeImage(pBitmapneedle) Gdip_Shutdown(pToken) ExitApp     Gdip_ImageSearch(pBitmapHayStack, pBitmapNeedle, ByRef x, ByRef y, Variation=0, sx="""", sy="""", w="""", h="""") {    static _ImageSearch1, _ImageSearch2    if !_ImageSearch1    {       MCode_ImageSearch1 := ""83EC108B44242C9983E20303C28BC88B4424309983E20303C253C1F80255894424148B44244056C1F9023B44244C578944244""       . ""80F8DCA0000008B7C24348D148D000000000FAFC88B442444895424148B54242403C88D1C8A8B4C244C895C24183BC1894424407D7A895C24108D6424""       . ""008B6C2428C744243C000000008D6424008B44243C3B4424380F8D9400000033C985FF7E178BD58BF38B063B02752283C10183C20483C6043BCF7CED8""       . ""B44241C035C24148344243C0103C003C003E8EBC08B4424408B5C24108B4C244C83C00183C3043BC189442440895C24107C928B4424448B5424488B5C""       . ""2418035C241483C2013B54245089542448895C24180F8C5DFFFFFF8B5424548B4424585F5EC702FFFFFFFF5DC700FFFFFFFF83C8FF5B83C410C38B4C2""       . ""4548B5424408B4424585F89118B4C24445E5D890833C05B83C410C3""        VarSetCapacity(_ImageSearch1, StrLen(MCode_ImageSearch1)//2)       Loop % StrLen(MCode_ImageSearch1)//2      ;%          NumPut(""0x"" SubStr(MCode_ImageSearch1, (2*A_Index)-1, 2), _ImageSearch1, A_Index-1, ""char"")    }     if !_ImageSearch2    {       MCode_ImageSearch2 :=""83EC1C8B4424443B44244C535556578944241C0F8D760100008B4C24488B5424580FAFC88B4424608B742440894C24188B4C24""       . ""503BCA894C24140F8D320100008B54241833FF897C24108B5C24103B5C2444897C2428895424240F8D4E01000085F6C7442420000000000F8ECD00000""       . ""08B7424348D148A8B4C243003F7897424548D1C0AEB0A8DA424000000008D49008B6C2454B9030000000FB60C19BE030000000FB6342E8D2C013BF50F""       . ""8FA20000002BC83BF10F8C980000008B4C24300FB64C0A028B7424340FB67437028D2C013BF57F7F2BC83BF17C798B4C24300FB64C0A018B7424340FB""       . ""67437018D2C013BF57F602BC83BF17C5A0FB60B8B7424540FB6368D2C013BF57F492BC83BF17C438B4C24208B742440834424540483C10183C20483C3""       . ""0483C7043BCE894C24200F8C5BFFFFFF8B4C24148B7C24288B542424035424488344241001037C244CE9F7FEFFFF8B4C24148B5424588B74244083C10""       . ""13BCA894C24140F8CD2FEFFFF8B4C24508B7C241C8B5C2448015C241883C7013B7C245C897C241C0F8CA5FEFFFF8B5424648B4424685F5EC702FFFFFF""       . ""FF5DC700FFFFFFFF83C8FF5B83C41CC38B5424648B4424685F890A8B4C24185E5D890833C05B83C41CC3""        VarSetCapacity(_ImageSearch2, StrLen(MCode_ImageSearch2)//2)       Loop % StrLen(MCode_ImageSearch2)//2      ;%          NumPut(""0x"" SubStr(MCode_ImageSearch2, (2*A_Index)-1, 2), _ImageSearch2, A_Index-1, ""char"")    }        if (Variation > 255 || Variation < 0)       return -2     Gdip_GetImageDimensions(pBitmapHayStack, hWidth, hHeight), Gdip_GetImageDimensions(pBitmapNeedle, nWidth, nHeight)        if !(hWidth && hHeight && nWidth && nHeight)       return -3    if (nWidth > hWidth || nHeight > hHeight)       return -4        sx := (sx = """") ? 0 : sx    sy := (sy = """") ? 0 : sy    w := (w = """") ? hWidth-sx : w    h := (h = """") ? hHeight-sy : h        if (sx+w > hWidth-nWidth)       w := hWidth-sx-nWidth+1        if (sy+h > hHeight-nHeight)       h := hHeight-sy-nHeight+1           E1 := Gdip_LockBits(pBitmapHayStack, 0, 0, hWidth, hHeight, Stride1, Scan01, BitmapData1)    E2 := Gdip_LockBits(pBitmapNeedle, 0, 0, nWidth, nHeight, Stride2, Scan02, BitmapData2)    if (E1 || E2)       return -5     x := y := 0    if (Variation = 0)    {       E := DllCall(&_ImageSearch1, ""uint"", Scan01, ""uint"", Scan02, ""int"", hWidth, ""int"", hHeight, ""int"", nWidth, ""int"", nHeight, ""int"", Stride1       , ""int"", Stride2, ""int"", sx, ""int"", sy, ""int"", w, ""int"", h, ""int*"", x, ""int*"", y)    }    else    {       E := DllCall(&_ImageSearch2, ""uint"", Scan01, ""uint"", Scan02, ""int"", hWidth, ""int"", hHeight, ""int"", nWidth, ""int"", nHeight, ""int"", Stride1       , ""int"", Stride2, ""int"", sx, ""int"", sy, ""int"", w, ""int"", h, ""int"", Variation, ""int*"", x, ""int*"", y)    }    Gdip_UnlockBits(pBitmapHayStack, BitmapData1), Gdip_UnlockBits(pBitmapNeedle, BitmapData2)    return (E = """") ? -6 : E } #4 - Posted 16 September 2011 - 07:31 AM Back to top Sven Members 22 posts Last active: Apr 05 2012 08:03 AM Joined: 03 Aug 2011 Would it be possible to also include a parameter to allow a transparent color to be specified, like the *TransN AHK imagesearch option?Seconded. For me, having transparency is a must have. #5 - Posted 22 November 2011 - 08:34 AM Back to top Safmy Guests Last active: Joined: -- I added the first code you posted into the GDIP.ahk but only received an error level of -6 with the code below:-  pToken := Gdip_Startup()   file1:=""Location of Haystack"" ;specific to your file location file2:=""Location of needle"" ;specific to your file location  my_haystack := Gdip_CreateBitmapFromFile(File1)  my_needle := Gdip_CreateBitmapFromFile(File2)   F4:: ;if !Gdip_ImageSearch(pBitmapHayStack, pBitmapNeedle, x, y)  ;   MsgBox, %x%`n%y% MsgBox % Gdip_ImageSearch(my_haystack, my_needle, FoundX, FoundY)  Return  Gdip_ShutDown(pToken) #6 - Posted 04 December 2011 - 01:33 PM Back to top swades Guests Last active: Joined: -- The above code with Gdip_CreateBitmapFromFile, doesnot work for me. Same image search is successful for Gdip_BitmapFromScreen. Can anyone please advise, if it imagesearch can work on file? #7 - Posted 23 December 2011 - 01:23 AM Back to top tic Members 1934 posts Last active: Dec 21 2015 01:05 PM Joined: 22 Apr 2007 Are either of you running this on x64 ahk as that could provide an error level -6 The above code with Gdip_CreateBitmapFromFile, doesnot work for me. Same image search is successful for Gdip_BitmapFromScreen. Can anyone please advise, if it imagesearch can work on file? Are the files jpgs that you are using? Are you sure that 1 file is definitely within the other file? Please provide both images #8 - Posted 17 January 2012 - 10:02 PM Back to top kenn Members 407 posts Last active: Jan 14 2015 08:16 PM Joined: 11 Oct 2010 Hi tic Another thread you mention that fastPixelGetColor would be thousands times faster with machine code. Would you please post such an example script? I saw your image search script with machine code so you must know how to do that. #9 - Posted 18 March 2012 - 06:09 PM My Scripts Ain’t No Shame in Asking for Help! Back to top tic Members 1934 posts Last active: Dec 21 2015 01:05 PM Joined: 22 Apr 2007 Hi kenn I don't want to turn this thread into a general question thread, but should only relate to Image Searching to help bug test the function in the first post. Simple pixel searching for 1 pixel will look like int Gdip_PixelSearch(unsigned int * HayStack, int w, int h, int Stride, int ARGB, int * x, int * y) { 	int offset = Stride/4; 	for (int y1 = 0; y1 < h; ++y1) 	{ 		for (int x1 = 0; x1 < w; ++x1) 		{ 			if (HayStack[x1+y1*offset] == ARGB) 			{ 				x[0] = x1; y[0] = y1; 				return 0; 			} 		} 	} 	x[0] = -1; y[0] = -1; 	return -1; } Although this is not the speed I was talking of. The speed I was talking of would come into effect if you tried for example to find all the x,y coordinates of every pixel on the screen that matches a certain colour, as then it could return all of them in an array and only run through the code once. The only difference would be that ByRefs x and y would need to have the appropriate size for VarSetCapacity and the c++ function would dump the results into this ""array"" Hope this helps a bit. Don't reply in this thread please. Thanks! #10 - Posted 03 April 2012 - 08:16 PM Back to top Guests Last active: Joined: -- Are either of you running this on x64 ahk as that could provide an error level -6 The above code with Gdip_CreateBitmapFromFile, doesnot work for me. Same image search is successful for Gdip_BitmapFromScreen. Can anyone please advise, if it imagesearch can work on file? Are the files jpgs that you are using? Are you sure that 1 file is definitely within the other file? Please provide both images If both haystack and needle are from Gdip_CreateBitmapFromFile the search returns a -6. I am running a 64 bit os but 32 bit AHK_L (unicode) Sample code would be: pbHaystack := Gdip_CreateBitmapFromFile(""haystack.png"") pbNeedle := Gdip_CreateBitmapFromFile(""haystack.png"") ;yes loading again, same image Gdip_ImageSearch(pbHaystack, pbNeedle, X, Y) #11 - Posted 10 June 2012 - 06:32 PM Back to top tic Members 1934 posts Last active: Dec 21 2015 01:05 PM Joined: 22 Apr 2007 -6 means the machine code could not complete, which likely means it doesn't work in AHK_L I need to make the library completely AHK_L compatible but I have a million projects I'm working on! #12 - Posted 10 June 2012 - 10:33 PM Back to top Wicked Members 504 posts Last active: Jun 14 2014 06:04 PM Joined: 07 Jun 2008 Take your time, tic. All your work is highly valued and very much appreciated! . Works for me in AHK_L 32b Uni. #13 - Posted 10 July 2012 - 06:27 PM Back to top Wicked Members 504 posts Last active: Jun 14 2014 06:04 PM Joined: 07 Jun 2008 After messing with it further, I noticed the sx, sy, w, h. I suppose that's of the needle? Is it possible to search a specific area of the haystack? I know the exact coordinates where the image should be, I just want to make sure it's there before proceeding. Rather then scan the whole haystack, or without creating a whole new bitmap, how would I scan a specified area? More specifically, I know my needle should appear at x277 y4 in my haystack and is 8x8. How might I narrow it down so that it only checks x277 y4 w8 h8. I tried simply using those values as sx, sy, etc, with no luck. #14 - Posted 11 July 2012 - 01:42 AM Back to top meochain Members 12 posts Last active: Jun 10 2012 04:25 PM Joined: 10 Jun 2012 I have learn many unique things from this sharing..Thanks #15 - Posted 11 July 2012 - 12:14 PM Back to top Page 1 of 5 1 2 3 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"by tic - Library using gdiplus.dll for searching image instances on the screen. See the end of that thread for MasterFocus' improved version, or see his"	"true"
"Graphics"	"GitHub repo here"	"https://github.com/MasterFocus/AutoHotkey/tree/master/Functions/Gdip_ImageSearch"	"by tic - Library using gdiplus.dll for searching image instances on the screen. See the end of that thread for MasterFocus' improved version, or see his"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"28"	"6"	"19"	"AutoHotkey/Functions/Gdip_ImageSearch at master · MasterFocus/AutoHotkey · GitHub Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 6 Star 28 Fork 19 MasterFocus/AutoHotkey Code Pull requests 0 Pulse Graphs Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show Create new file Find file History AutoHotkey/Functions/Gdip_ImageSearch/ Latest commit bd8cc85 Apr 2, 2013 Antonio Minor additions for the GDI+ functions … Gdip_ImageSearch() now defaults to 1 match only. Gdip_SetBitmapTransColor() now returns the number of modified pixels and uses VarSetCapacity to empty TransColor properly. A few more comments were added to explain the meaning of certain parameters and return values. Permalink .. Failed to load latest commit information. IMG Gdip_ImageSearch.ahk Gdip_ImageSearch.c TestScript.ahk Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/MasterFocus/AutoHotkey/tree/master/Functions/Gdip_ImageSearch"	"by tic - Library using gdiplus.dll for searching image instances on the screen. See the end of that thread for MasterFocus' improved version, or see his"	"true"
"Graphics"	"Simple GDI class"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=5820"	"by GeekDude - A class aiming to make using low-level GDI functions simple."	"null"	"null"	"null"	"null"	"null"	""	"null"	"null"	"null"	"null"	"Simple GDI Class - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:26 All times are UTC-05:00 Simple GDI Class Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 18 posts • Page 1 of 1 GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Simple GDI Class Report this post Quote 05 Jan 2015, 17:14 A class aiming to make using low-level GDI functions simple. Example use code: Simple button Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #Include GDI.ahk   Gui, Margin, 50, 50 Gui, Add, Progress, w100 h50 hWndhWnd ; Progress controls make ideal canvases Gui, Show   global MyButton := new CustomButton(hWnd) OnMessage(0xF, ""WM_PAINT"") OnMessage(0x200, ""WM_MOUSEMOVE"") OnMessage(0x201, ""WM_LBUTTONDOWN"") OnMessage(0x202, ""WM_LBUTTONUP"") return   GuiClose: ExitApp   WM_PAINT() { 	Sleep, -1 ; Let the scrollbar redraw before painting over it 	MyButton.BitBlt() }   WM_MOUSEMOVE(wParam, lParam, Msg, hWnd) { 	static LasthWnd 	if (hWnd != LasthWnd) 	{ 		if (hWnd == MyButton.hWnd) 			MyButton.Hovering() 		else if (lasthWnd == MyButton.hWnd) 			MyButton.Default() 		LasthWnd := hWnd 	} }   WM_LBUTTONDOWN(wParam, lParam, Msg, hWnd) { 	if (hWnd == MyButton.hWnd) 		MyButton.Held() }   WM_LBUTTONUP(wParam, lParam, Msg, hWnd) { 	if (hWnd == MyButton.hWnd) 		MyButton.Hovering() }   class CustomButton { 	__New(hWnd) 	{ 		this.GDI := new GDI(hWnd) 		this.hWnd := hWnd 		this.Default() 	}   	Default() 	{ 		this.Draw(""Hover"", 0xFFFFFF, 0x000000) 	}   	Hovering() 	{ 		this.Draw(""Click"", 0xC0C0C0, 0x000000) 	}   	Held() 	{ 		this.Draw(""Release"", 0x000000, 0x0000FF) 	}   	Draw(Text, Color, TextColor) 	{ 		critical 		this.GDI.FillRectangle(0, 0, this.GDI.CliWidth, this.GDI.CliHeight, Color, TextColor) 		this.GDI.DrawText(0, 0, 100, 50, Text, TextColor, ""Courier New"", 20, ""CC"") 		this.GDI.BitBlt() 	}   	BitBlt() 	{ 		this.GDI.BitBlt() 	} } The library code: Last edited by GeekDude on 05 Jan 2015, 17:41, edited 3 times in total. AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: Simple GDI Class Report this post Quote 05 Jan 2015, 17:24 Nice! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Soft Posts: 147 Joined: 07 Jan 2015, 13:18 GitHub: visionary1 Location: Seoul Contact: Contact Soft Website Re: Simple GDI Class Report this post Quote 07 Jan 2015, 22:56 oh.. nice AutoHotkey & AutoHotkey_H v1.1.22.07 Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Simple GDI Class Report this post Quote 07 Jan 2015, 22:57 ""oh..""? AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: Simple GDI Class Report this post Quote 18 Jan 2015, 11:43 Please also add link here: viewtopic.php?f=6&t=3851&start=60 DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Simple GDI Class Report this post Quote 18 Jan 2015, 12:49 It's not really beautiful, but I'll post it anyways if you want me to AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: Simple GDI Class Report this post Quote 19 Jan 2015, 00:00 But! It will facilitate new GUIs using GDI Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top dfdfdf Re: Simple GDI Class Report this post Quote 19 Jan 2015, 22:34 where is GDI.ahk? Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: Simple GDI Class Report this post Quote 19 Jan 2015, 22:38 https://gist.github.com/G33kDude/aa6f31f85a533f49c632 Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top sddf Re: Simple GDI Class Report this post Quote 20 Jan 2015, 01:48 thanks Top lblb Posts: 114 Joined: 30 Sep 2013, 11:31 Re: Simple GDI Class Report this post Quote 14 Apr 2016, 23:29 Hi Geekdude, This is cool and simple! Thanks for your work. Is there any way that this could be adapted to make circular buttons? There are ellipse functions in Tic's Gdip library so I'm guessing it may be possible, but adding it to your class is way over my head. Thanks in advance for the help you may be able to provide. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Simple GDI Class Report this post Quote 14 Apr 2016, 23:39 Greetings lblb, You should be able to take the code for FillRectangle and modify it to use a DllCall for Ellipse instead of for Rectangle. It looks like it takes all the same parameters as Rectangle, so it should be as simple as copying that class method and changing the name Rectangle to Ellipse. I'd probably also remove that 1x1 pixel check, since it doesn't really apply to an ellipse in the same way it might a rectangle. Here is the documentation page for Ellipse AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top lblb Posts: 114 Joined: 30 Sep 2013, 11:31 Re: Simple GDI Class Report this post Quote 14 Apr 2016, 23:52 Hi Geekdude, Thanks a lot for the quick reply and for the info, much appreciated. I'm willing to work on it but this is quite new to me. So before I invest some time into this, maybe I should ask if you think it would be possible to reach my objective. What I am trying to do is to have individual floating circle buttons that react as you showed in your test script. So I would make the Gui background transparent in order to only see the circle buttons (and have some free space between the buttons). If I can come up with the Ellipse code, I'm not sure what to expect: since the Fill functions seem to act by changing the color of the progress control, would I be stuck with the corner of the rectangular progress control sticking out of the ellipse shape? Top lblb Posts: 114 Joined: 30 Sep 2013, 11:31 Re: Simple GDI Class Report this post Quote 15 Apr 2016, 03:11 Hi Geekdude, Thanks a lot for your help. I think I'm getting close to what I need. Here is the code I have so far: Spoiler Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus #Include GDI.ahk #SingleInstance, Force Gui, +LastFound -Resize +HwndhGuiMain +AlwaysOnTop -Caption -dpiscale +ToolWindow +E0x08000000 Gui, Color, 0x000000 Gui, Margin, 50, 50 Winset, Transcolor, 0x000000 Gui, Add, Progress, x50 w100 h100 hWndButton1 ; Progress controls make ideal canvases Gui, Add, Progress, x50 y200 w100 h100 hWndButton2 ; Progress controls make ideal canvases   Gui, Show   global MyButton := new CustomButton(Button1) global MyButton2 := new CustomButton(Button2)   OnMessage(0xF, ""WM_PAINT"") OnMessage(0x200, ""WM_MOUSEMOVE"") OnMessage(0x201, ""WM_LBUTTONDOWN"") OnMessage(0x202, ""WM_LBUTTONUP"")   OnMessage(0x2A2, ""WM_NCMOUSELEAVE"") SetTimer, CheckIfMouseIsOutsideGui,10 return   GuiClose: ExitApp Return   CheckIfMouseIsOutsideGui:   MouseGetPos,,,MouseOverWindow,   Gui, +Lastfound   If (MouseOverWindow <> WinExist())       WM_NCMOUSELEAVE() return   WM_NCMOUSELEAVE() { global LasthWnd global hwnd If (lasthWnd == MyButton.hWnd) 	{ 	hWnd := MyButton.hWnd 	lasthWnd = 	MyButton.Default() 	} Else if (lasthWnd == MyButton2.hWnd) 	{ 	hWnd := MyButton2.hWnd 	lasthWnd = 	MyButton2.Default() 	} }     WM_PAINT() { 	Sleep, -1 ; Let the scrollbar redraw before painting over it 	MyButton.BitBlt() 	MyButton2.BitBlt() }   WM_MOUSEMOVE(wParam, lParam, Msg, hWnd) { 	global LasthWnd 	if (hWnd != LasthWnd) 	{ 		if (hWnd == MyButton.hWnd) 			MyButton.Hovering() 		else if (hWnd == MyButton2.hWnd) 			MyButton2.Hovering() 		else if (lasthWnd == MyButton.hWnd) 			MyButton.Default() 		else if (lasthWnd == MyButton2.hWnd) 			MyButton2.Default()   		LasthWnd := hWnd 	} }   WM_LBUTTONDOWN(wParam, lParam, Msg, hWnd) { 	if (hWnd == MyButton.hWnd) 		MyButton.Held() 	else if (hWnd == MyButton2.hWnd) 		MyButton2.Held() }   WM_LBUTTONUP(wParam, lParam, Msg, hWnd) { 	if (hWnd == MyButton.hWnd) 		MyButton.Hovering() 	else if (hWnd == MyButton2.hWnd) 		MyButton2.Hovering() }   class CustomButton {   	__New(hWnd) 	{ 		this.GDI := new GDI(hWnd) 		this.hWnd := hWnd 		this.Default() 	}   	Default() 	{ 	global LasthWnd 	global hwnd 	if (hWnd == MyButton.hWnd) 			this.Draw(""Hover1"", 0x000000, 0x00000F) 	Else if (hWnd == MyButton2.hWnd) 			this.Draw(""Hover2"", 0x000000, 0x00000F) 	}   	Hovering() 	{ 	global LasthWnd 	global hwnd 	if (hWnd == MyButton.hWnd) 		this.Draw(""Click1"", 0xC0C0C0, 0x00000F) 	Else if (hWnd == MyButton2.hWnd) 	this.Draw(""Click2"", 0xC0C0C0, 0x00000F) 	}   	Held() 	{ 		this.Draw(""Release"", 0x00000F, 0x0000FF) 	}   	Draw(Text, Color, TextColor) 	{ 		critical 		this.GDI.FillEllipse(0, 0, this.GDI.CliWidth, this.GDI.CliHeight, Color, TextColor) 		this.GDI.DrawText(0, 0, 100, 100, Text, TextColor, ""Arial"", 20, ""CC"") 		this.GDI.BitBlt() 	}   	BitBlt() 	{ 		this.GDI.BitBlt() 	} }   F8:: Reload And then in GDI.ahk, I replaced FillRectangle with: Spoiler Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus 	FillEllipse(x, y, w, h, Color, BorderColor=-1) 	{ 		if (w == 1 && h == 1) 			return this.SetPixel(x, y, Color)   		Pen := new this.Pen(BorderColor < 0 ? Color : BorderColor) 		Brush := new this.Brush(Color)   		; Replace the original pen and brush with our own 		hOriginalPen := DllCall(""SelectObject"", ""UPtr"", this.hMemDC, ""UPtr"", Pen.Handle, ""UPtr"") 		hOriginalBrush := DllCall(""SelectObject"", ""UPtr"", this.hMemDC, ""UPtr"", Brush.Handle, ""UPtr"")   		x1 := this.TranslateX(x) 		x2 := this.TranslateX(x+w) 		y1 := this.TranslateY(y) 		y2 := this.TranslateY(y+h)   		DllCall(""Ellipse"", ""UPtr"", this.hMemDC 		, ""Int"", x1, ""Int"", y1 		, ""Int"", x2, ""Int"", y2)   		; Reselect the original pen and brush 		DllCall(""SelectObject"", ""UPtr"", this.hMemDC, ""UPtr"", hOriginalPen, ""UPtr"") 		DllCall(""SelectObject"", ""UPtr"", this.hMemDC, ""UPtr"", hOriginalBrush, ""UPtr"") 	} When you run the script above, there should be two round buttons at the middle of the screen. A few questions: 1) I made the default state of the buttons transparent by using Code: [Select all] [Download] GeSHi © Codebox Plus Winset, Transcolor, 0x000000 It was necessary to use 0x000000 for Transcolor (and for the Gui background color) because the corners of the progress control that are outside of the ellipse are black. Is there any way to control the color of these corners outside of the ellipse? 2) As you can see, the edges of the circle and of the text are a bit jagged. In Tic's Gdip library, it's possible to adjust the antialiasing using the Quality functions. Would it be possible to do the same here? I have no clue how I could include this function in your code. Spoiler Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ;##################################################################################### ; Quality functions (from Gdip_All.ahk) ;#####################################################################################   ; SystemDefault = 0 ; SingleBitPerPixelGridFit = 1 ; SingleBitPerPixel = 2 ; AntiAliasGridFit = 3 ; AntiAlias = 4 Gdip_SetTextRenderingHint(pGraphics, RenderingHint) { 	return DllCall(""gdiplus\GdipSetTextRenderingHint"", A_PtrSize ? ""UPtr"" : ""UInt"", pGraphics, ""int"", RenderingHint) }   ; Default = 0 ; LowQuality = 1 ; HighQuality = 2 ; Bilinear = 3 ; Bicubic = 4 ; NearestNeighbor = 5 ; HighQualityBilinear = 6 ; HighQualityBicubic = 7 Gdip_SetInterpolationMode(pGraphics, InterpolationMode) {    return DllCall(""gdiplus\GdipSetInterpolationMode"", A_PtrSize ? ""UPtr"" : ""UInt"", pGraphics, ""int"", InterpolationMode) }   ; Default = 0 ; HighSpeed = 1 ; HighQuality = 2 ; None = 3 ; AntiAlias = 4 Gdip_SetSmoothingMode(pGraphics, SmoothingMode) {    return DllCall(""gdiplus\GdipSetSmoothingMode"", A_PtrSize ? ""UPtr"" : ""UInt"", pGraphics, ""int"", SmoothingMode) }   ; CompositingModeSourceOver = 0 (blended) ; CompositingModeSourceCopy = 1 (overwrite) Gdip_SetCompositingMode(pGraphics, CompositingMode=0) {    return DllCall(""gdiplus\GdipSetCompositingMode"", A_PtrSize ? ""UPtr"" : ""UInt"", pGraphics, ""int"", CompositingMode) } 3) I'm trying to put different text on each button. That works well by itself using something like: Code: [Select all] [Download] GeSHi © Codebox Plus Default() 	{ 	global LasthWnd 	global hwnd 	if (hWnd == MyButton.hWnd) 			this.Draw(""Hover1"", 0x000000, 0x00000F) 	Else if (hWnd == MyButton2.hWnd) 			this.Draw(""Hover2"", 0x000000, 0x00000F) 	} But I'm running in some issues when I combine this with the function to reset the buttons when the cursor leaves the buttons. When the cursor leaves the the buttons, I use the following to reset the buttons: Code: [Select all] [Download] GeSHi © Codebox Plus OnMessage(0x2A2, ""WM_NCMOUSELEAVE"") SetTimer, CheckIfMouseIsOutsideGui,10 If you hover on and off over button 1 (or button 2), the text is updated correctly. But if you hover over button 1, then go over button 2, the first time you hover over button 2 the hover text is not updated correctly. Can you see where the mistake is? Thanks a lot for all your help. This is really challenging for me as I'm not used to working with functions and classes (so for example, I'm not really sure the WM_NCMOUSELEAVE and CheckIfMouseIsOutsideGui are deployed correctly) but I'm learning a whole lot. So thanks in advance for any support you may be able to offer. Top Guest Re: Simple GDI Class Report this post Quote 19 Apr 2016, 09:34 I'm running into some issues with multiple buttons too... It seems they get switched around for some reason. Can't pinpoint why yet. There seems to be some HWND weirdness going on. Could you provide an example of using more than one button Geekdude? Thanks. Like this it seems kinda confusing to get things right. (I usually don't work with HWNDS to get things done) Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Simple GDI Class Report this post Quote 20 Apr 2016, 12:16 Sorry for the late replies. Here's some code with multiple round buttons. I took advantage of some newer AHK features that let me handle the messages for each button individually instead of having a single message handler that handles all the buttons. Also, I fixed WM_MOUSELEAVE (had to do some research for this one, and modified it to be both 32 and 64 bit compatible). See the original post for the updated GDI.ahk with FillEllipse. As for making things smoother/less pixelated, it's not really possible. My class strictly uses GDI (not plus) functions, which don't have such features. That kind of functionality is only present in GDI+. If you want good transparency and aliasing (smoothing), you'll need to use either tic's gdip or his gdip2 beta (also class based). https://github.com/tariqporter/Gdip/blo ... /Gdip2.ahk Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus #NoEnv SetBatchLines, -1   #Include <GDI>   ; Window Message Constants global WM_PAINT := 0xF , WM_MOUSEMOVE := 0x200 , WM_LBUTTONDOWN := 0x201 , WM_LBUTTONUP := 0x202 , WM_MOUSELEAVE := 0x2A3   ; TRACKMOUSEEVENT struct for WM_MOUSELEAVE ; https://autohotkey.com/board/topic/32663-/?p=207708 VarSetCapacity(TME, 24, 0) NumPut(8+A_PtrSize*2, TME, 0, ""UInt"") ; cbSize NumPut(2, TME, 4, ""UInt"") ; dwFlags NumPut(0, TME, 8, ""UPtr"") ; hwndTrack NumPut(0, TME, 8+A_PtrSize, ""UInt"") ; dwHoverTime   Buttons := [] Loop, 5 { 	Gui, Add, Progress, w150 h100 hWndhWnd 	Buttons.Push(new CustomButton(hWnd)) } Gui, Show return   GuiClose: Gui, Destroy   ; Erase all button references so the class instances can be deleted for Index, Button in Buttons 	Button.Release() Button := """" ; ""Button"" from the for loop actually still exists, so delete that reference too Buttons := """"   ExitApp return   class CustomButton { 	Messages := [WM_PAINT, WM_MOUSEMOVE, WM_LBUTTONDOWN, WM_LBUTTONUP, WM_MOUSELEAVE]   	__New(hWnd) 	{ 		this.hWnd := hWnd 		this.GDI := new GDI(hWnd)   		; Fill in background 		this.GDI.FillRectangle(0, 0, this.GDI.CliWidth, this.GDI.CliHeight, 0xF0F0F0)   		; Fill in foreground 		this.Default()   		; Listen for messages 		this.Bound := this.OnMessage.Bind(this) 		for Index, Msg in this.Messages 			OnMessage(Msg, this.Bound) 	}   	Release() 	{ 		for Index, Msg in this.Messages 			OnMessage(Msg, this.Bound, 0) 		this.Bound := """" ; Erase circular reference 	}   	OnMessage(wParam, lParam, Msg, hWnd) 	{ 		global TME   		; If the/a window needs repainted 		if (Msg == WM_PAINT) 		{ 			Sleep, -1 			this.BitBlt() 		}   		; From this point on, only handle messages specifically for this control 		if (hWnd != this.hWnd) 			return   		if (Msg == WM_MOUSEMOVE) { 			NumPut(hWnd, TME, 8, ""Ptr"") ; hwndTrack 			DllCall(""TrackMouseEvent"", ""Ptr"", &TME)   			; TODO: only call on state change 			if !GetKeyState(""LButton"") 				this.Hovering() 		} else if (Msg == WM_MOUSELEAVE) 			this.Default() 		else if (Msg == WM_LBUTTONDOWN) 			this.Held() 		else if (Msg == WM_LBUTTONUP) 			this.Hovering() 	}   	Default() 	{ 		this.Draw(""Hover"", 0xFFFFFF, 0x000000) 	}   	Hovering() 	{ 		this.Draw(""Click"", 0xC0C0C0, 0x000000) 	}   	Held() 	{ 		this.Draw(""Release"", 0x000000, 0x0000FF) 	}   	Draw(Text, Color, TextColor) 	{ 		this.GDI.FillEllipse(0, 0, this.GDI.CliWidth, this.GDI.CliHeight, Color, TextColor) 		this.GDI.DrawText(0, 0, this.GDI.CliWidth, this.GDI.CliHeight, Text, TextColor, ""Comic Sans"", 20, ""CC"") 		this.GDI.BitBlt() 	}   	BitBlt() 	{ 		this.GDI.BitBlt() 	} } AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top Guest Re: Simple GDI Class Report this post Quote 20 Apr 2016, 13:18 Cheers I managed to get things looking smooth enough with your library so no need for gdip on my end. Now if only i could find some bass.dll help i'd be set lol Top lblb Posts: 114 Joined: 30 Sep 2013, 11:31 Re: Simple GDI Class Report this post Quote 25 Apr 2016, 01:53 Hi GeekDude, Sorry for the late reply as I just got back into this. Thanks a lot for modifying the GDI.ahk and for modifying my script. I really appreciate it. I'll look into what you wrote and will write back here if I encounter any issues. Thanks a lot! Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 18 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Bing [Bot], pondermatic and 14 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by GeekDude - A class aiming to make using low-level GDI functions simple."	"true"
"Combobox"	"CbAutoComplete"	"https://github.com/pulover/cbautocomplete"	"by Pulover - Auto-completes typed values in an AHK ComboBox.. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"0"	"1"	"0"	"GitHub - Pulover/CbAutoComplete: Auto-completes typed values in an AHK ComboBox. Skip to content Personal Open source Business Explore Join GitHub Sign in Pricing Blog Support Search GitHub This repository Watch 1 Star 0 Fork 0 Pulover/CbAutoComplete Code Issues 0 Pull requests 0 Pulse Graphs Auto-completes typed values in an AHK ComboBox. 3 commits 1 branch 1 release 1 contributor AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show v1.0 Nothing to show New pull request Latest commit a4f98b2 Mar 16, 2016 Pulover Updated header info. Permalink Failed to load latest commit information. Examples v1.0 Mar 16, 2016 CbAutoComplete.ahk Updated header info. Mar 16, 2016 LICENSE Initial commit Mar 16, 2016 README.md v1.0 Mar 16, 2016 README.md CbAutoComplete() Auto-completes typed values in an AHK ComboBox. Usage Call the function from the Combobox's gLabel. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/pulover/cbautocomplete"	"by Pulover - Auto-completes typed values in an AHK ComboBox.. Forum thread:"	"true"
"Combobox"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=15002"	"by Pulover - Auto-completes typed values in an AHK ComboBox.. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"CbAutoComplete - Auto-completes typed values in a ComboBox - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:27 All times are UTC-05:00 CbAutoComplete - Auto-completes typed values in a ComboBox Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 1 post • Page 1 of 1 Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website CbAutoComplete - Auto-completes typed values in a ComboBox Report this post Quote 16 Mar 2016, 15:34 I have found a few scripts out there to accomplish this task, but all of them had some bug. So I decided to make my own and share it here. Code: [Select all] [Expand] [Download] (CbAutoComplete.ahk)GeSHi © Codebox Plus ;======================================================================================= ; ; Function:      CbAutoComplete ; Description:   Auto-completes typed values in a ComboBox. ; ; Author:        Pulover [Rodolfo U. Batista] ; Usage:         Call the function from the Combobox's gLabel. ; ;======================================================================================= CbAutoComplete() {	; CB_GETEDITSEL = 0x0140, CB_SETEDITSEL = 0x0142 	If ((GetKeyState(""Delete"", ""P"")) || (GetKeyState(""Backspace"", ""P""))) 		return 	GuiControlGet, lHwnd, Hwnd, %A_GuiControl% 	SendMessage, 0x0140, 0, 0,, ahk_id %lHwnd% 	MakeShort(ErrorLevel, Start, End) 	GuiControlGet, CurContent,, %lHwnd% 	GuiControl, ChooseString, %A_GuiControl%, %CurContent% 	If (ErrorLevel) 	{ 		ControlSetText,, %CurContent%, ahk_id %lHwnd% 		PostMessage, 0x0142, 0, MakeLong(Start, End),, ahk_id %lHwnd% 		return 	} 	GuiControlGet, CurContent,, %lHwnd% 	PostMessage, 0x0142, 0, MakeLong(Start, StrLen(CurContent)),, ahk_id %lHwnd% }   MakeLong(LoWord, HiWord) { 	return (HiWord << 16) | (LoWord & 0xffff) }   MakeShort(Long, ByRef LoWord, ByRef HiWord) { 	LoWord := Long & 0xffff ,   HiWord := Long >> 16 }   I only wish there was a better way to detect when the user is deleting content. Checking key state of bs and del keys doesn't work with Right-Click > Delete or with simulated keystrokes. But I'm not going to try OnMessage either... Sources and examples on GitHub Feedback and improvements are welcome. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Post Reply Email topic Print view 1 post • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Bing [Bot], pondermatic and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by Pulover - Auto-completes typed values in an AHK ComboBox.. Forum thread:"	"true"
"Custom Controls"	"Rebar"	"https://github.com/Pulover/Class_Rebar"	"by Pulover - AHK class for AutoHotkey Rebar custom controls. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"1"	"2"	"0"	"GitHub - Pulover/Class_Rebar: AHK class for AutoHotkey Rebar custom controls Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 2 Star 1 Fork 0 Pulover/Class_Rebar Code Issues 0 Pull requests 0 Pulse Graphs AHK class for AutoHotkey Rebar custom controls https://autohotkey.com/boards/viewtopic.php?f=6&t=139 11 commits 1 branch 1 release Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show v1.1 Nothing to show New pull request Latest commit 5e2e80d Apr 4, 2016 Pulover Merge branch 'master' of https://github.com/Pulover/Class_Rebar Permalink Failed to load latest commit information. Examples Added MaxRows limit. Apr 4, 2016 Class_Rebar.ahk Changed header info. Mar 15, 2016 LICENSE Initial commit Mar 14, 2016 README.md README.md Class Rebar Class for AutoHotkey Rebar custom controls AHK version: 1.1.23.01 This class provides intuitive methods to work with Rebar controls created via Gui, Add, Custom, ClassReBarWindow32. Rebar Methods DeleteBand(Band) GetBand(Band [, ID, Text, Size, Image, Background, Style, Child]) GetBandCount() GetBarHeight() GetLayout() GetRowCount() GetRowHeight(Band) IDToIndex(ID) InsertBand(hChild [, Position, Options, ID, Text, Size, Image, Background, MinHeight, MinWidth, IdealSize]) MaximizeBand(Band [, IdealWidth]) MinimizeBand(Band) ModifyBand(Band, Property, Value [, SetStyle]) MoveBand(Band, Target) OnNotify(Param [, MenuXPos, MenuYPos, ID) SetBandStyle(Band, Value) SetBandWidth(Band, Width) SetImageList(ImageList) SetMaxRows([Rows]) SetLayout(Layout) ShowBand(Band [, Show]) ToggleStyle(Style) Useful Rebar Styles Styles can be applied to Gui command options, e.g.: Gui, Add, Custom, ClassReBarWindow32 0x0800 0x0100 RBS_BANDBORDERS := 0x0400 - Add a separator border between bands in different rows. RBS_DBLCLKTOGGLE := 0x8000 - Toggle maximize/minimize with double-click instead of single. RBS_FIXEDORDER := 0x0800 - Always displays bands in the same order. RBS_VARHEIGHT := 0x0200 - Allow bands to have different heights. CCS_NODIVIDER := 0x0040 - Removes the separator line above the rebar. CCS_NOPARENTALIGN := 0x0008 - Allows positioning and moving rebars. CCS_NORESIZE := 0x0004 - Allows resizing rebars. CCS_VERT := 0x0080 - Creates a vertical rebar. Delete() Deletes a band from a rebar control. Return TRUE if successful, FALSE if there was a problem. Parameters Band - 1-based index of the band to be deleted. GetBand() Retrieves information from a rebar band. Return TRUE if successful, FALSE if there was a problem. Parameters Band - 1-based index of the band. ID - OutputVar to store the band's ID. Text - OutputVar to store the band's text. Size - OutputVar to store the band's size. Image - OutputVar to store the band's image index. Background - OutputVar to store a handle to the band's background bitmap. Style - OutputVar to store the band's style numeric value. Child - OutputVar to store a handle to the band's child control. GetBandCount() Retrieves the count of bands currently in the rebar control. Return The number of bands in the rebar control. GetBarHeight() Retrieves the height of the rebar control. Return The height of the rebar control in pixels. GetLayout() Retrieves the current layout of bands in the rebar control. Return A string containing information about the current bands. String format is: ID1,Size1,Style1|ID2,Size2,Style2|... GetRowCount() Retrieves the number of rows of bands in a rebar control. Return The number of rows in the rebar control. GetRowHeight() Retrieves the number of rows of bands in a rebar control. Return The height of the row from the corresponding band in pixels. Parameters Band - 1-based index of a band to retrieve the height from. IDToIndex() Converts a band identifier to a band index in a rebar control. Return The 1-based band index if successful, or 0 otherwise. Parameters ID - The application-defined identifier of the band in question. InsertBand() Inserts a new band in a rebar control. Return TRUE if successful, FALSE if there was a problem. Parameters hChild - Handle to the control contained in the band, if any. Position - 1-based index of the location where the band will be inserted. If you set this parameter to 0, the control will add the new band at the last location. Options - Enter zero or more words, separated by space or tab, from the following list to set the band's initial styles: Break, FixedBmp, FixedSize, Hidden, HideTitle, NoGripper, NoVert, TopAlign, VariableHeight. The following styles are applied by default** - ChildEdge, GripperAlways (can be disabled with NoGripper), UseChevron (only valid if IdealSize is set). ID - Integer value that the control uses to identify this band. This parameter is required to retrieve and set layouts. Text - The display text for the band. Size - Length of the band, in pixels. Image - 1-based index of any image that should be displayed in the band. SetImageList method must be called prior to this. Background - Path of a bitmap file that is used as the background for this band. MinHeight - Minimum height of the control, in pixels. MinWidth - Minimum width of the control, in pixels. IdealSize - Ideal width of the band, in pixels. If the band is maximized to the ideal width (see MaximizeBand method), the rebar control will attempt to make the band this width. MaximizeBand() Resizes a band to either its ideal or largest size. Return TRUE if successful, FALSE if there was a problem. Parameters Band - 1-based index of a band to be maximized. IdealWidth - If TRUE the ideal width of the band will be used to maximize MinimizeBand() Resizes a band to its smallest size. Return TRUE if successful, FALSE if there was a problem. Parameters Band - 1-based index of a band to be minimized. ModifyBand() Sets band parameters such as Text and Size. Return TRUE if successful, FALSE if there was a problem. Parameters Band - 1-based index of a band to be modified. Property - Enter one word from the following list to select the Property to be set** - Style, ID, Text, Size, Image, Background, MinWidth, MinHeight, IdealSize, Child (handle of control). Value - The value to be set in the selected Property. If Property is Style you can enter named values as in the InsertBand options, or an integer value. SetStyle - Only valid if Property is Style. Determines whether to add or remove the styles. MoveBand() Moves a band from one index to another. Return TRUE if successful, FALSE if there was a problem. Parameters Band - 1-based index of a band to be moved. Target - 1-based index of a the new band position. OnNotify() Handles rebar notifications. This method should be called from the rebar's G-Label. If A_GuiEvent is ""N"", pass it A_EventInfo as the Param. You can also call it from a function monitoring the WM_NOTIFY message, pass it lParam as the Param. Currently this method is used to retrieve the position for a menu when the Chevron button is pushed and prevent a number of rows higher then the one set by SetMaxRows method. Return If the ChevronPushed notification is passed returns the index of the band it is from. Parameters Param - The lParam from WM_NOTIFY message. MenuXPos - OutputVar to store the horizontal position for a menu. MenuYPos - OutputVar to store the vertical position for a menu. ID - OutputVar to store the band's ID. SetBandStyle() Sets the style of a band. Return TRUE if successful, FALSE if there was a problem. Parameters Band - 1-based index of the band. Value - Named values as in the InsertBand options, or an integer value. SetBandWidth() Sets the width for a docked band. Return TRUE if successful, FALSE if there was a problem. Parameters Band - 1-based index of the band. Width - New width in pixels. SetImageList() Sets an ImageList to the rebar control. Return TRUE if successful, FALSE if there was a problem. Parameters ImageList - ImageList ID. SetLayout() Sets a layout of bands in the rebar control. Return TRUE if a valid layout was passed, or FALSE otherwise. Parameters Layout - A string containing information about the current bands. String format is** - ID1,Size1,Style1|ID2,Size2,Style2|... SetMaxRows() Sets the maximum number of rows allowed in a rebar control. This method requires the OnNotify method to be implemented. Return The number of rows previously allowed. Parameters Rows - Number of maximum rows allowed. Set it to 0 to disable limit. ShowBand() Shows or hides a given band in a rebar control. Return TRUE if successful, FALSE if there was a problem. Parameters Band - 1-based index of the band. Show - Set to TRUE to show the band or FALSE to hide it. ToggleStyle() Toggles rebar's style. Return TRUE if a valid style is passed, or FALSE otherwise. Parameters Style - Enter one or more words, separated by space or tab, from the following list to toggle toolbar's styles** - AutoSize, BandBorders, DblClkToggle, FixedOrder, RegisterDropdown, VarHeight, VerticalGripper. You may also enter an integer value to define the style. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/Pulover/Class_Rebar"	"by Pulover - AHK class for AutoHotkey Rebar custom controls. Forum thread:"	"true"
"Custom Controls"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=139"	"by Pulover - AHK class for AutoHotkey Rebar custom controls. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[Class] Rebar - Adjustable GUI controls (Updated 03/17/2016) - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:27 All times are UTC-05:00 [Class] Rebar - Adjustable GUI controls (Updated 03/17/2016) Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 6 posts • Page 1 of 1 Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website [Class] Rebar - Adjustable GUI controls (Updated 03/17/2016) Report this post Quote 04 Oct 2013, 07:31 This class attempts to provide intuitive methods to work with rebars created using Gui Custom controls. A Rebar control acts as a container for child windows. It can contain one or more bands, and each band can have any combination of a gripper bar, a bitmap, a text label, and one child window. An application assigns a child window—typically another control— to a rebar control band. As you dynamically reposition a rebar control band, the rebar control manages the size and position of the child window assigned to that band. Also, an application can specify a background bitmap for a band, and the rebar control will display the band's child window over the bitmap. -- MSDN Screenshot: Features: Insert bands with any control. Add text, image icon and background for each band. Save and load layouts. Retrieve and change information of bar and each band. Sources, documentation and examples on GitHub Reference: Rebar (MSDN) Last edited by Pulover on 17 Mar 2016, 06:19, edited 4 times in total. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Chef Posts: 50 Joined: 14 Nov 2013, 13:01 Re: [Class] Rebar - Adjustable GUI controls Report this post Quote 22 Nov 2013, 12:31 Very nice, time to rewrite few scripts Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] Rebar - Adjustable GUI controls Report this post Quote 16 Mar 2016, 19:52 Update: Updated class to new AHK Object methods. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top CheshireCat Posts: 6 Joined: 07 Mar 2016, 15:58 Re: [Class] Rebar - Adjustable GUI controls (Updated 03/17/2016) Report this post Quote 03 Apr 2016, 19:43 Hi, This is awesome. I have used the Rebar library by majkinetor previously but I think this one is more user friendly. I have a few questions however. I am interested in using a Rebar mainly because it has a ""splitter"" or ""separator"". I've made a GUI that has a listbox on the left side of the window with a drop down box above it, and then a tab control on the right side. I can set two Rebar bands (as used in your Rebar_Multiple example on GitHub) with one band having a GUI with the dropdown list and listbox, and the second band with the tab control and any other controls, etc. My question is how can I implement the ""SetMaxRows()"" method in order to limit the max rows to be only 1? ie: both bands being side by side without the ability to stack the bands above or below one another. Any insight or assistance would be great. Thank you. Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] Rebar - Adjustable GUI controls (Updated 03/17/2016) Report this post Quote 03 Apr 2016, 22:13 Hello CheshireCat, Thank you for the feedback, it's good to know that this class is being useful. Well, SetMaxRows(1) seems to work. You just can't forget to implement OnNotify(). I have found your description interesting and thought I should include an example of split panels with resizable controls in the repo. This is the new demo, it should help you get this splitter done. I've set a few styles to make it look good for this purpose. Code: [Select all] [Expand] [Download] (SplitPanels.ahk)GeSHi © Codebox Plus ; Example of Split Panels with resizable GUI and controls   #NoEnv #SingleInstance Force #Include <Class_Rebar>   Gui, LeftPanel:+HwndhLeft -Caption Gui, LeftPanel:Add, DDL, vDList, Item1||Item2|Item3 Gui, LeftPanel:Add, ListBox, r10 vListB, Item1|Item2|Item3   Gui, RightPanel:+HwndhRight -Caption Gui, RightPanel:Add, Tab2, h160 w100 vTabC, Tab A|Tab B|Tab C   Gui, +Resize Gui, Add, Custom, ClassReBarWindow32 hwndhSplitter vSplitWin w380 -Theme 0x0800 0x0040 0x8000 0x0008 Gui, Show, h200 w400   rbSplitter := New Rebar(hSplitter) rbSplitter.InsertBand(hLeft, 0, ""NoGripper"", 10, """", 150, 0, """", 170, 80, 10) rbSplitter.InsertBand(hRight, 0, """", 20, """", 150, 0, """", 170, 80, 10) rbSplitter.SetMaxRows(1)   WM_NOTIFY := 0x4E OnMessage(WM_NOTIFY, ""RB_Notify"") return   GuiClose: ExitApp   GuiSize: rbSplitter.ModifyBand(1, ""MinHeight"", (A_GuiHeight - 15)) rbSplitter.ModifyBand(2, ""MinHeight"", (A_GuiHeight - 15)) GuiControl, Move, SplitWin, % ""W"" (A_GuiWidth - 10) ""H"" (A_GuiHeight - 10) return   LeftPanelGuiSize: GuiControl, LeftPanel:Move, DList, % ""W"" (A_GuiWidth - 25) GuiControl, LeftPanel:Move, ListB, % ""W"" (A_GuiWidth - 25) ""H"" (A_GuiHeight - 40) return   RightPanelGuiSize: GuiControl, RightPanel:Move, TabC, % ""W"" (A_GuiWidth - 25) ""H"" (A_GuiHeight - 20) return   RB_Notify(wParam, lParam) {     Global rbSplitter     rbSplitter.OnNotify(lParam) }    The only thing that doesn't work when I make controls resizable is the minWidth of the bands... Probably another bug in MS control. Let me know if you have more doubts. Last edited by Pulover on 04 Apr 2016, 00:15, edited 1 time in total. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top CheshireCat Posts: 6 Joined: 07 Mar 2016, 15:58 Re: [Class] Rebar - Adjustable GUI controls (Updated 03/17/2016) Report this post Quote 03 Apr 2016, 23:44 Ahhhh, wow, that's exactly what I had in mind. I thought it would be harder to code. As I start using it I'm sure I'll have more questions, but that was excellent. Thank you so much for your prompt response and example. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 6 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Bing [Bot], pondermatic and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by Pulover - AHK class for AutoHotkey Rebar custom controls. Forum thread:"	"true"
"Custom Controls"	"Toolbar"	"https://github.com/Pulover/Class_Toolbar"	"by Pulover - AHK Class for AutoHotkey Toolbar custom controls. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"2"	"1"	"1"	"GitHub - Pulover/Class_Toolbar: AHK Class for AutoHotkey Toolbar custom controls Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 1 Star 2 Fork 1 Pulover/Class_Toolbar Code Issues 0 Pull requests 0 Pulse Graphs AHK Class for AutoHotkey Toolbar custom controls https://autohotkey.com/boards/viewtopic.php?f=6&t=138 13 commits 1 branch 1 release Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show v1.1 Nothing to show New pull request Latest commit 447289b Mar 20, 2016 Pulover Fixed #Include in examples. Permalink Failed to load latest commit information. Examples Class_Toolbar.ahk Changed header info. Mar 15, 2016 LICENSE Initial commit Mar 14, 2016 README.md Styling. Mar 15, 2016 README.md Class Toolbar Class for AutoHotkey Toolbar custom controls AHK version: 1.1.23.01 This class provides intuitive methods to work with Toolbar controls created via Gui, Add, Custom, ClassToolbarWindow32. Note: It's recommended to call any method only after Gui, Show. Adding or modifying buttons of a toolbar in a Gui that is not yet visible might fail eventually. Toolbar Methods: Add([Options, Label1[=Text]:Icon[(Options)], Label2[=Text]:Icon[(Options)]...]) AutoSize() Customize() Delete(Button) Export() Get([HotItem, TextRows, Rows, BtnWidth, BtnHeight, Style, ExStyle]) GetButton(Button [, ID, Text, State, Style, Icon, Label, Index]) GetButtonPos(Button [, OutX, OutY, OutW, OutH]) GetButtonState(Button, StateQuerry) GetCount() GetHiddenButtons() Insert(Position [, Options, Label1[=Text]:Icon[(Options)], Label2[=Text]:Icon[(Options)]...]) LabelToIndex(Label) ModifyButton(Button, State [, Set]) ModifyButtonInfo(Button, Property, Value) MoveButton(Button, Target) OnMessage(CommandID) OnNotify(Param [, MenuXPos, MenuYPos, Label, ID, AllowCustom]) Reset() SetButtonSize(W, H) SetDefault([Options, Label1[=Text]:Icon[(Options)], Label2[=Text]:Icon[(Options)]...]) SetExStyle(Style) SetHotItem(Button) SetImageList(IL_Default [, IL_Hot, IL_Pressed, IL_Disabled]) SetIndent(Value) SetListGap(Value) SetMaxTextRows([MaxRows]) SetPadding(X, Y) SetRows([Rows, AddMore]) ToggleStyle(Style) Presets Methods: Presets.Delete(Slot) Presets.Export(Slot, [ArrayOut]) Presets.Import(Slot, [Options, Label1[=Text]:Icon, Label2[=Text]:Icon, Label3[=Text]:Icon...]) Presets.Load(Slot) Presets.Save(Slot, Buttons) Useful Toolbar Styles: Styles can be applied to Gui command options, e.g.: Gui, Add, Custom, ClassToolbarWindow32 0x0800 0x0100 TBSTYLE_FLAT := 0x0800 - Shows separators as bars. TBSTYLE_LIST := 0x1000 - Shows buttons text on their side. TBSTYLE_TOOLTIPS := 0x0100 - Shows buttons text as tooltips. CCS_ADJUSTABLE := 0x0020 - Allows customization by double-click and shift-drag. CCS_NODIVIDER := 0x0040 - Removes the separator line above the toolbar. CCS_NOPARENTALIGN := 0x0008 - Allows positioning and moving toolbars. CCS_NORESIZE := 0x0004 - Allows resizing toolbars. CCS_VERT := 0x0080 - Creates a vertical toolbar (add WRAP to button options). Add() Add button(s) to the end the toolbar. The Buttons parameters sets target Label, text caption and icon index for each button. If not a valid label name, a function name can be used instead (parameters can be passed to the OnMessage method). To add a separator call this method without parameters. Prepend any non letter or digit symbol, such as ""-"" or ""*"" to the label to add a hidden button. Hidden buttons won't be visible when Gui is shown but will still be available in the customize window. E.g.: ""-Label=New:1"", ""Label:2"". Return TRUE if successful, FALSE if there was a problem. Parameters: Options - Enter zero or more words, separated by space or tab, from the following list to set buttons' initial states and styles: Checked, Ellipses, Enabled, Hidden, Indeterminate, Marked, Pressed, Wrap, Button, Sep, Check, Group, CheckGroup, Dropdown, AutoSize, NoPrefix, ShowText, WholeDropdown. You can also set the minimum and maximum button width, for example W20-100 would set min to 20 and max to 100. This option affects all buttons in the toolbar when added or inserted but does not prevent modifying button sizes. If this parameter is blank it defaults to ""Enabled"", otherwise you must set this parameter to enable buttons. You may pass integer values that correspond to (a combination of) button styles. You cannot set states this way (it will always be set to ""Enabled""). Buttons - Buttons can be added in the following format: Label=Text:1, where ""Label"" is the target label to execute when the button is pressed, ""Text"" is caption to be displayed with the button or as a Tooltip if the toolbar has the TBSTYLE_TOOLTIPS style (this parameter can be omitted) and""1"" can be any numeric value that represents the icon index in the ImageList (0 means no icon). You can include specific states and styles for a button appending them inside parenthesis after the icon. E.g.: ""Label=Text:3(Enabled Dropdown)"". This option can also be an Integer value, in this case the general options are ignored for that button. To add a separator between buttons specify """" or equivalent. AutoSize() Auto-sizes toolbar. Return TRUE if successful, FALSE if there was a problem. Customize() Displays the Customize Toolbar dialog box. Return TRUE if successful, FALSE if there was a problem. Delete() Delete one or all buttons. Return TRUE if successful, FALSE if there was a problem. Parameters Button - 1-based index of the button. If omitted deletes all buttons. Export() Returns a text string with current buttons and order in Add and Insert methods compatible format (this includes button's styles but not states). Duplicate labels are ignored. Return A text string with current buttons information to be exported. Parameters ArrayOut - Set to TRUE to return an object array. The returned object format is compatible with Presets.Save and Presets.Load methods, which can be used to save and load layout presets. HidMark - Changes the default symbol to prepend to hidden buttons. Get() Retrieves information from the toolbar. Return TRUE if successful, FALSE if there was a problem. Parameters HotItem - OutputVar to store the 1-based index of current HotItem. TextRows - OutputVar to store the number of text rows Rows - OutputVar to store the number of rows for vertical toolbars. BtnWidth - OutputVar to store the buttons' width in pixels. BtnHeight - OutputVar to store the buttons' heigth in pixels. Style - OutputVar to store the current styles numeric value. ExStyle - OutputVar to store the current extended styles numeric value. GetButton() Retrieves information from the toolbar buttons. Return TRUE if successful, FALSE if there was a problem. Parameters Button - 1-based index of the button. ID - OutputVar to store the button's command ID. Text - OutputVar to store the button's text caption. State - OutputVar to store the button's state numeric value. Style - OutputVar to store the button's style numeric value. Icon - OutputVar to store the button's icon index. Label - OutputVar to store the button's associated script label or function. Index - OutputVar to store the button's text string index. GetButtonPos() Retrieves position and size of a specific button, relative to the toolbar control. Return TRUE if successful, FALSE if there was a problem. Parameters Button - 1-based index of the button. OutX - OutputVar to store the button's horizontal position. OutY - OutputVar to store the button's vertical position. OutW - OutputVar to store the button's width. OutH - OutputVar to store the button's height. GetButtonState() Retrieves the state of a button based on a querry. Return The TRUE if the StateQuerry is true, FALSE if it's not. Parameters StateQuerry - Enter one of the following words to get the state of the button** - Checked, Enabled, Hidden, Highlighted, Indeterminate, Pressed. GetCount() Retrieves the total number of buttons. Return The total number of buttons in the toolbar. GetHiddenButtons() Retrieves which buttons are hidden when the toolbar size is smaller then the total size of the buttons it has. This method is most useful when the toolbar is a child window of a Rebar control, in order to show a menu when the chevron is pushed. It does not retrieve buttons hidden by gui size. Return An array with all buttons hidden by the Rebar band. Each key in the array has 4 properties: ID, Text, Label and Icon. Insert() Insert button(s) in specified postion. To insert a separator call this method without parameters. Return TRUE if successful, FALSE if there was a problem. Parameters Position - 1-based index of button position to insert the new buttons. Options - Same as Add(). Buttons - Same as Add(). LabelToIndex() Converts a button label to its index in a toolbar. Return The 1-based index for the button or FALSE if Label is invalid. Parameters Label - Button's associated label or function. ModifyButton() Sets button states. Return TRUE if successful, FALSE if there was a problem. Parameters Button - 1-based index of the button. State - Enter one word from the follwing list to change a button's state** - Check, Enable, Hide, Mark, Press. Set - Enter TRUE or FALSE to set the state on/off. ModifyButtonInfo() Sets button parameters such as Icon and CommandID. Return TRUE if successful, FALSE if there was a problem. Parameters Button - 1-based index of the button. Property - Enter one word from the following list to select the Property to be set** - Command, Image, Size, State, Style, Text, Label. Value - The value to be set in the selected Property. If Property is State or Style you can enter named values as in the Add options. MoveButton() Moves a toolbar button (change order). Return TRUE if successful, FALSE if there was a problem. Parameters Button - 1-based index of the button to be moved. Target - 1-based index of the new position. OnMessage() Run label associated with button's Command identifier. This method should be called from a function monitoring the WM_COMMAND message. Pass the wParam as the CommandID. Return TRUE if target label or function exists, or FALSE otherwise. Parameters CommandID - Command ID associated with the button. This is send via WM_COMMAND message, you must pass the wParam from inside a function that monitors this message. FuncParams - In case the button is associated with a valid function, you may pass optional parameters for the function call. You can pass any number of parameters. OnNotify() Handles toolbar notifications. This method should be called from a function monitoring the WM_NOTIFY message. Pass the lParam as the Param. The returned value should be used as return value for the monitoring function as well. Return The required return value for the function monitoring the the WM_NOTIFY message. Parameters Param - The lParam from WM_NOTIFY message. MenuXPos - OutputVar to store the horizontal position for a menu. MenuYPos - OutputVar to store the vertical position for a menu. BtnLabel - OutputVar to store the label or function name associated with the button. ID - OutputVar to store the button's Command ID. AllowCustom - Set to FALSE to prevent customization of toolbars. AllowReset - Set to FALSE to prevent Reset button from restoring original buttons. HideHelp - Set to FALSE to show the Help button in the customize dialog. Reset() Restores all toolbar's buttons to default layout. Default layout is set by the buttons added. This can be changed calling the SetDefault method. Return TRUE if successful, FALSE if there was a problem. SetButtonSize() Sets the size of buttons on a toolbar. Affects current buttons. Return TRUE if successful, FALSE if there was a problem. Parameters W - Width of buttons, in pixels H - Height of buttons, in pixels SetDefault() Sets the internal default layout to be used when customizing or when the Reset method is called. Return Always TRUE. Parameters Options - Same as Add(). Buttons - Same as Add(). Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/Pulover/Class_Toolbar"	"by Pulover - AHK Class for AutoHotkey Toolbar custom controls. Forum thread:"	"true"
"Custom Controls"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=138"	"by Pulover - AHK Class for AutoHotkey Toolbar custom controls. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[Class] Toolbar - Create and modify (Updated 03/17/2016) - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:27 All times are UTC-05:00 [Class] Toolbar - Create and modify (Updated 03/17/2016) Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 42 posts 1 2 3 Next Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website [Class] Toolbar - Create and modify (Updated 03/17/2016) Report this post Quote 04 Oct 2013, 07:25 This class attempts to provide intuitive methods to work with toolbars created using Gui Custom controls. Since the new Custom controls were implemented I've been waiting for someone to come up with a library or class to work with toolbars but as nothing has shown I decided to try and make one myself. Screenshot: I've been learning from examples in MSDN and from Toolbar.ahk, included in majkinetor's impressive Forms Framework, to implement the most essential methods needed. Features: Add, insert, delete and modify buttons. Add or insert various buttons in a single call with general and individual options. Add default, hot, pressed and disabled Image Lists. Export layouts. Save, load, import and export presets. Retrieve and change information about buttons and toolbars. Supports customization and save/reset operations. Supports vertical toolbars. Sources, documentation and examples on GitHub   Reference: Toolbar (MSDN) See also Rebar Last edited by Pulover on 17 Mar 2016, 06:19, edited 6 times in total. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: [Class] Toolbar - Create and modify Report this post Quote 07 Nov 2013, 23:19 neat! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] Toolbar - Create and modify Report this post Quote 08 Nov 2013, 04:13 joedf wrote:neat! Thanks, joedf! Btw I've reverted the last update. Turned out I had misunderstand the request and the result was not very good... Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top BGM Posts: 315 Joined: 20 Nov 2013, 20:56 GitHub: bgmCoder Contact: Contact BGM ICQ Website Re: [Class] Toolbar - Create and modify Report this post Quote 20 Nov 2013, 21:08 Hi, Pulover. Does this new toolbar have a configurator? Majkenator's toolbar.ahk from the forms framework had a configuration window that would allow you to add and remove buttons. Last edited by BGM on 21 Nov 2013, 22:28, edited 1 time in total. Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] Toolbar - Create and modify Report this post Quote 20 Nov 2013, 21:18 Hi BGM, It does. Check out the Customize() method and the demo script to know how to implement it. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top BGM Posts: 315 Joined: 20 Nov 2013, 20:56 GitHub: bgmCoder Contact: Contact BGM ICQ Website Re: [Class] Toolbar - Create and modify Report this post Quote 20 Nov 2013, 22:14 Thanks, Pulover - I played with it and it works fine. Figured out how to add a Customize button to the demo in less than 10 minutes! The demo is wonderful, by the way. Maybe you should add the Customize button to the demo, too? My Stuff: mousey; volume; ahkinfo; instantbirder; npp highlighter; Dynamic File Menu; tv - a treeview library; Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] Toolbar - Create and modify Report this post Quote 21 Nov 2013, 06:42 I didn't use the Customize method in the demo because I used CCS_ADJUSTABLE to show it when you double-click on an empty area of the toolbar. But I might add a button for the method too. Thanks. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top BGM Posts: 315 Joined: 20 Nov 2013, 20:56 GitHub: bgmCoder Contact: Contact BGM ICQ Website Re: [Class] Toolbar - Create and modify Report this post Quote 21 Nov 2013, 21:21 Pulover, I am trying to adjust my script to use your class instead of the older forms framework toolbar.ahk. The gosubs I am using detect whether the user held the shift key when they were called. However, it seems that when I use this with the class_toolbar, the modifier keys get lost. Here is what I have (the forum is escaping all my parentheses within the code-block, by the way....): Spoiler I put this in the main sub where the toolbar is built (after it is constructed): Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus OnMessage(0x111, ""TB_Messages"")		;WM_COMMAND   And I have this by itself later on. Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus TB_Messages(wParam, lParam){ 	global 	SetLastWin("""","""", true) 	hMYtoolbar.onMessage(wParam) }   But what happens is that the commands do get called like they ought, but the key-modifers are lost. In the forms_framework, there was a function to fetch the button's ""label"" when it was pushed: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus OnToolbar(hMYtoolbar, pEvent, pTxt, pPos, pID){	 msgbox, %pID% }   And that worked. The script would call the function instead of the toolbar calling the function, and so the keyboard modifiers didn't get lost. What do you recommend? Last edited by BGM on 21 Nov 2013, 22:45, edited 5 times in total. My Stuff: mousey; volume; ahkinfo; instantbirder; npp highlighter; Dynamic File Menu; tv - a treeview library; Top BGM Posts: 315 Joined: 20 Nov 2013, 20:56 GitHub: bgmCoder Contact: Contact BGM ICQ Website Re: [Class] Toolbar - Create and modify Report this post Quote 21 Nov 2013, 21:25 Also, Pulover, in my own script, when I call hMYtoolbar.Customize(), the customize window appears for a second and then goes away. I can see the buttons just fine on my toolbar, and they work well enough (except for what I mentioned in my other post), but the customizer is wrong. I confirm that 0x0020 is present in the toolbars options. What can I do? My Stuff: mousey; volume; ahkinfo; instantbirder; npp highlighter; Dynamic File Menu; tv - a treeview library; Top BGM Posts: 315 Joined: 20 Nov 2013, 20:56 GitHub: bgmCoder Contact: Contact BGM ICQ Website Re: [Class] Toolbar - Create and modify Report this post Quote 21 Nov 2013, 22:25 Pulover, sorry to be so noisy, but I've another problem. And this one is a bit strange. Spoiler I have a bunch of gosubs that I name by number, say 101, 102, 103, 201, 202, 203 Now, if I create an array for the buttons to be inserted, all is well if I do this: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus mybuttons := [ 101=first:1, 102=second:2, 103=third:3 ] But when I do this: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus mybuttons := [ 101=first:1, 102=second:2, 103=third:3, 201=fourth:4 ] then it starts doing weird things: it won't show the tooltip for 101, and the tooltip for 201 is what 101 ought to be. However, the icons are still correct. So it looks like the tooltip mechanism doesn't like similar numbers. It confuses 201 with 101 even though they are two different labels in the script. I think this is a bug somewhere. My Stuff: mousey; volume; ahkinfo; instantbirder; npp highlighter; Dynamic File Menu; tv - a treeview library; Top Chef Posts: 50 Joined: 14 Nov 2013, 13:01 Re: [Class] Toolbar - Create and modify Report this post Quote 22 Nov 2013, 03:05 Hello Pulover, I don't think autoResize resizes the width to fit buttons. Is it meant to do that? Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] Toolbar - Create and modify Report this post Quote 22 Nov 2013, 07:51 BGM wrote:Pulover, I am trying to adjust my script to use your class instead of the older forms framework toolbar.ahk. The gosubs I am using detect whether the user held the shift key when they were called. However, it seems that when I use this with the class_toolbar, the modifier keys get lost. What do you recommend? Well, you didn't give me an example to try so I don't know how you're doing this check. I've tested here with a sample script and I could detect the shift key pressed on the target label. Spoiler Code: [Select all] [Expand] [Download] (Toolbar_demo_simple.ahk)GeSHi © Codebox Plus #NoEnv #SingleInstance, Force #Include <Class_Toolbar>   ; Create an ImageList. ILA := IL_Create(4, 2, True) IL_Add(ILA, ""shell32.dll"", 127) IL_Add(ILA, ""shell32.dll"", 128) IL_Add(ILA, ""shell32.dll"", 129) IL_Add(ILA, ""shell32.dll"", 130)   ; TBSTYLE_FLAT     := 0x0800 Required to show separators as bars. ; TBSTYLE_TOOLTIPS := 0x0100 Required to show Tooltips. Gui, Add, Custom, ClassToolbarWindow32 hwndhToolbar 0x0800 0x0100 Gui, Show,, Test   ; Initialize Toolbars. ; The variable you choose will be your handle to access the class for your toolbar. MyToolbar := New Toolbar(hToolbar)   ; Set ImageList. MyToolbar.SetImageList(ILA)   ; Add buttons. MyToolbar.Add("""", ""Label1=Button 1:1"", ""Label2=Button 2:2"", ""Label3=Button 3:3"", ""Label4=Button 4:4"")   ; Removes text labels and show them as tooltips. MyToolbar.SetMaxTextRows(0)   ; Set a function to monitor the Toolbar's messages. WM_COMMAND := 0x111 OnMessage(WM_COMMAND, ""TB_Messages"")   ; Set a function to monitor notifications. WM_NOTIFY := 0x4E OnMessage(WM_NOTIFY, ""TB_Notify"")   return   ; This function will receive the messages sent by both Toolbar's buttons. TB_Messages(wParam, lParam) {     Global ; Function (or at least the Handles) must be global.     MyToolbar.OnMessage(wParam) ; Handles toolbar's messages. }   ; This function will receive the notifications. TB_Notify(wParam, lParam) {     Global ; Function (or at least the Handles) must be global.     ReturnCode := MyToolbar.OnNotify(lParam) ; Handles notifications.     return ReturnCode }   ; Your labels. Label1: Label2: Label3: Label4: If GetKeyState(""Shift"", ""P"") 	GoSub, ShiftLabel Else 	MsgBox, You selected %A_ThisLabel% return   ShiftLabel: MsgBox, You selected %A_ThisLabel% return   F1::MyToolbar.Customize()   GuiClose: ExitApp return   BGM wrote:Also, Pulover, in my own script, when I call hMYtoolbar.Customize(), the customize window appears for a second and then goes away. I can see the buttons just fine on my toolbar, and they work well enough (except for what I mentioned in my other post), but the customizer is wrong. I confirm that 0x0020 is present in the toolbars options. What can I do? I forgot to add a note that this method requires OnNotifiy() implemented to work. The demo above shows a simple way to use it. BGM wrote:Pulover, sorry to be so noisy, but I've another problem. And this one is a bit strange. Spoiler I have a bunch of gosubs that I name by number, say 101, 102, 103, 201, 202, 203 Now, if I create an array for the buttons to be inserted, all is well if I do this: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus mybuttons := [ 101=first:1, 102=second:2, 103=third:3 ] But when I do this: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus mybuttons := [ 101=first:1, 102=second:2, 103=third:3, 201=fourth:4 ] then it starts doing weird things: it won't show the tooltip for 101, and the tooltip for 201 is what 101 ought to be. However, the icons are still correct. So it looks like the tooltip mechanism doesn't like similar numbers. It confuses 201 with 101 even though they are two different labels in the script. I think this is a bug somewhere. In order to trigger an action the toolbar buttons are assigned to a CommandID, which is sent in a WM_COMMAND message. I didn't want to have to care about assigning those codes manually so I've created a function (StringToNumber()) that converts the label into a (possibly) unique code number. I don't recommend using labels that contain only numbers, not for toolbars nor for any project you're working on. Make them at least begin with a letter like L101. Or you can modify the function on the class to fit your needs. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] Toolbar - Create and modify Report this post Quote 22 Nov 2013, 07:55 Chef wrote:Hello Pulover, I don't think autoResize resizes the width to fit buttons. Is it meant to do that? Maybe you need CCS_NORESIZE (0x0004) and CCS_NOPARENTALIGN (0x0008) styles on your toolbar. Without them the toolbar is positioned and sized automatically to the gui. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top BGM Posts: 315 Joined: 20 Nov 2013, 20:56 GitHub: bgmCoder Contact: Contact BGM ICQ Website Re: [Class] Toolbar - Create and modify Report this post Quote 22 Nov 2013, 09:39 Say, that simple_toolbar.ahk example is valuable! It provides an easy template to go by and quickly get results using your class script. I recommend posting it at the head of the thread along with the demo! Pulover, adding the OnNotify fixed the customization window (thank you!). Pulover, I understand what you mean about not using numbers as labels - but I've build my whole project to work by dynamically cycling through the numbers and then building variables from them. I'm not sure I want to re-figure out my code to undo that... So I changed the StringToNumber() function to just return the parameter without doing anything to it. And I also changed the Export function to use ""|"" as a separator instead of "", "". I'm not sure if that made any difference, but my button text issue seems to have cleared up! Thanks again for your hlep! Last edited by BGM on 22 Nov 2013, 11:46, edited 3 times in total. My Stuff: mousey; volume; ahkinfo; instantbirder; npp highlighter; Dynamic File Menu; tv - a treeview library; Top BGM Posts: 315 Joined: 20 Nov 2013, 20:56 GitHub: bgmCoder Contact: Contact BGM ICQ Website Re: [Class] Toolbar - Create and modify Report this post Quote 22 Nov 2013, 09:50 Here is the function I am using to detect keys: Spoiler Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus Modkey(){ 	if GetKeyState(""shift"", ""P"") and GetKeyState(""control"", ""P""){ 		mode := -2 	}else if GetKeyState(""shift"", ""P""){ 		mode := -1 	}else if GetKeyState(""control"", ""P""){ 		mode := 2 	}else{ 		mode := 1 	}	 	return mode } Then, in my label functions, I do something like this: Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus 102: curmod := ModKey() 	if(curmod = 1){ 		msgbox no modifier 	}else if(curmod = 2){ 		msgbox control 	}else if(curmod = -1){ 		msgbox shift 	}else if(curmod = -2){ 		msgbox control+shift 	} return What is happening is that it will detect for ""no modifier"" and ""control"" but not for ""shift"" - when I say it won't detect, I mean that the messagebox doesn't even fire when I push shift. But it works fine for control. Strange, no? But if I try the same function whilst called from a hotkey instead of from the toolbar, it works perfectly. So something with the toolbar is causing shift not to be detected. I suppose it's the same thing that mixes up the button text. (I know this is hard to troubleshoot!) **edit** Ah, I've noticed something. If I shift+click the button, it makes certain separators in the toolbar appear and disappear - after that, the shift-function fires fine. So I think what is happening is that shift+click causes the toolbar to enter an editing mode. Okay, after I removed CCS_ADJUSTABLE then this problem went away! My Stuff: mousey; volume; ahkinfo; instantbirder; npp highlighter; Dynamic File Menu; tv - a treeview library; Top Chef Posts: 50 Joined: 14 Nov 2013, 13:01 Re: [Class] Toolbar - Create and modify Report this post Quote 22 Nov 2013, 10:54 Those options have no effect when it comes to autoSizing width. You can see that yourself by adding +border option in your example. But since I have TB library I just call TB_AUTOSIZE() which works like a charm. Here its if your interested... Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus TB_AUTOSIZE(hToolbar, Align=""fit"") { 	PtrType:= A_PtrSize ? ""Ptr"" : ""UInt"" ; use x64-compatible type if running AHK_L 	if (align != """") { 		dhw:= A_DetectHiddenWindows 		DetectHiddenWindows,on 		TB_GETMAXSIZE(hToolbar, w, h) 		SysGet, f, 8		;SM_CYFIXEDFRAME , Thickness of the frame around the perimeter of a window that has a caption but is not sizable 		SysGet, c, 4		;SM_CYCAPTION: Height of a caption area, in pixels. 		hParent:= DllCall(""GetParent"", PtrType, hToolbar) 		WinGetPos, ,,pw,ph, ahk_id %hParent% 		if Align = fit 			ControlMove,,,,%w%,%h%, ahk_id %hToolbar% 		else if Align = tr 			ControlMove,,pw-w-f,c+f+2,%w%,%h%, ahk_id %hToolbar% 		else if Align = tl 			ControlMove,,f,c+f+2,%w%,%h%, ahk_id %hToolbar% 		else if Align = br 			ControlMove,,pw-w-f,ph-h-f,%w%,%h%, ahk_id %hToolbar% 		else if Align = bl 			ControlMove,,,ph-h-f,%w%,%h%, ahk_id %hToolbar% 		DetectHiddenWindows, %dhw% 		} 	else SendMessage,0x0421,,,,ahk_id %hToolbar% 	} TB_GETMAXSIZE(hToolbar, ByRef Width, ByRef Height) { 	VarSetCapacity(SIZE, 8) 	SendMessage, 0x0453, 0, &SIZE, , ahk_id %hToolbar% 	res:= ErrorLevel, 	Width:= NumGet(SIZE), Height:= NumGet(SIZE, 4) 	return res 	} Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] Toolbar - Create and modify Report this post Quote 22 Nov 2013, 11:54 BGM wrote:Okay, after I removed CCS_ADJUSTABLE then this problem went away! Good catch! I'll see what I can do about the tooltips when I have more time. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] Toolbar - Create and modify Report this post Quote 22 Nov 2013, 12:02 Chef wrote:Those options have no effect when it comes to autoSizing width. You can see that yourself by adding +border option in your example. But since I have TB library I just call TB_AUTOSIZE() which works like a charm. I haven't tested yet but maybe there's a bug in the method. This wouldn't be the only bug in Microsoft common controls... I've used more than one workaround by majkinetor. If you're using the toolbar with a resizable gui you might be interested in using a Rebar. viewtopic.php?f=6&t=139 Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top BGM Posts: 315 Joined: 20 Nov 2013, 20:56 GitHub: bgmCoder Contact: Contact BGM ICQ Website Re: [Class] Toolbar - Create and modify Report this post Quote 22 Nov 2013, 14:31 In my project, I have around 50 buttons. I have a couple of ideas. Upon program launch, the script (in my opinoin) should work like this: Add all the possible buttons - of course, the coder has to add the routine to do that. That way, if there is an update of the script, the new buttons are available. Layouts would consist only of visible buttons. The script would load a layout, and when a button is added, the script should check to see if the button exists before adding it - if it exists, the button's properties get updated (visibility, perhaps - whatever is set in the add() function's options). THEN, since all the buttons are added at the start, there is no reason to save hidden buttons in the export. It seems to be less processing to just save visible buttons in the layout. What do you think, Pulover? My Stuff: mousey; volume; ahkinfo; instantbirder; npp highlighter; Dynamic File Menu; tv - a treeview library; Top BGM Posts: 315 Joined: 20 Nov 2013, 20:56 GitHub: bgmCoder Contact: Contact BGM ICQ Website Re: [Class] Toolbar - Create and modify Report this post Quote 22 Nov 2013, 14:37 Also, what is the difference between using myToolbar.export() and a layout? It seems that a layout is the same thing. If I export the current button set to a different key in the ini file, isn't that the same thing as saving a layout? That's what I understand from the demo, anyway. My Stuff: mousey; volume; ahkinfo; instantbirder; npp highlighter; Dynamic File Menu; tv - a treeview library; Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 42 posts 1 2 3 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Bing [Bot], pondermatic and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by Pulover - AHK Class for AutoHotkey Toolbar custom controls. Forum thread:"	"true"
"General"	"AutoXYWH"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=1079"	"by tmplinshi - Move and resize controls automatically when a GUI is resized."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"AutoXYWH() - Move control automatically when GUI resized - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:27 All times are UTC-05:00 AutoXYWH() - Move control automatically when GUI resized Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 68 posts 1 2 3 4 Next tmplinshi Posts: 836 Joined: 01 Oct 2013, 14:57 AutoXYWH() - Move control automatically when GUI resized Report this post Quote 20 Dec 2013, 06:39 This is a simple version of Anchor() by Titan. Old version Code: [Select all] [Expand] [Download] (AutoXYWH.ahk)GeSHi © Codebox Plus ; ================================================================================= ; Function:     AutoXYWH ; 	Move and resize control automatically when GUI resized. ; Parameters: ; 	ctrl_list  - ControlID list separated by ""|"". ; 	             ControlID can be a control HWND, associated variable name or ClassNN. ; 	Attributes - Can be one or more of x/y/w/h ; 	Redraw     - True to redraw controls ; Examples: ; 	AutoXYWH(""Btn1|Btn2"", ""xy"") ; 	AutoXYWH(hEdit      , ""wh"") ; --------------------------------------------------------------------------------- ; AHK version : 1.1.13.01 ; Tested On   : Windows XP SP3 (x86) ; Release date: 2014-1-2 ; Author      : tmplinshi ; ================================================================================= AutoXYWH(ctrl_list, Attributes, Redraw = False) { 	static cInfo := {}, New := []   	Loop, Parse, ctrl_list, | 	{ 		ctrl := A_LoopField   		if ( cInfo[ctrl]._x = """" ) 		{ 			GuiControlGet, i, Pos, %ctrl% 			_x := A_GuiWidth  - iX 			_y := A_GuiHeight - iY 			_w := A_GuiWidth  - iW 			_h := A_GuiHeight - iH 			_a := RegExReplace(Attributes, ""i)[^xywh]"") 			cInfo[ctrl] := { _x:_x, _y:_y, _w:_w, _h:_h, _a:StrSplit(_a) } 		} 		else 		{ 			if ( cInfo[ctrl]._a.1 = """" ) 				Return   			New.x := A_GuiWidth  - cInfo[ctrl]._x 			New.y := A_GuiHeight - cInfo[ctrl]._y 			New.w := A_GuiWidth  - cInfo[ctrl]._w 			New.h := A_GuiHeight - cInfo[ctrl]._h   			for i, a in cInfo[ctrl][""_a""] 				Options .= a New[a] A_Space   			GuiControl, % Redraw ? ""MoveDraw"" : ""Move"", % ctrl, % Options 		} 	} } Code: [Select all] [Expand] [Download] (Sample_AutoXYWH.ahk)GeSHi © Codebox Plus Gui, +Resize Gui, Add, Edit  ,    w200    hwndhEdit Gui, Add, Button, ys w40  hp vBtn1 Gui, Add, Button, ys wp   hp vBtn2 Gui, Show Return   GuiSize: 	AutoXYWH(hEdit, ""wh"") 	AutoXYWH(""Btn1|Btn2"", ""hx"") Return   GuiClose: ExitApp #Include AutoXYWH.ahk Modified version by toralf: Code: [Select all] [Expand] [Download] (AutoXYWH.ahk)GeSHi © Codebox Plus ; ================================================================================= ; Function: AutoXYWH ;   Move and resize control automatically when GUI resizes. ; Parameters: ;   DimSize - Can be one or more of x/y/w/h  optional followed by a fraction ;             add a '*' to DimSize to 'MoveDraw' the controls rather then just 'Move', this is recommended for Groupboxes ;   cList   - variadic list of ControlIDs ;             ControlID can be a control HWND, associated variable name, ClassNN or displayed text. ;             The later (displayed text) is possible but not recommend since not very reliable ; Examples: ;   AutoXYWH(""xy"", ""Btn1"", ""Btn2"") ;   AutoXYWH(""w0.5 h 0.75"", hEdit, ""displayed text"", ""vLabel"", ""Button1"") ;   AutoXYWH(""*w0.5 h 0.75"", hGroupbox1, ""GrbChoices"") ; --------------------------------------------------------------------------------- ; Version: 2015-5-29 / Added 'reset' option (by tmplinshi) ;          2014-7-03 / toralf ;          2014-1-2  / tmplinshi ; requires AHK version : 1.1.13.01+ ; ================================================================================= AutoXYWH(DimSize, cList*){       ; http://ahkscript.org/boards/viewtopic.php?t=1079   static cInfo := {}     If (DimSize = ""reset"")     Return cInfo := {}     For i, ctrl in cList {     ctrlID := A_Gui "":"" ctrl     If ( cInfo[ctrlID].x = """" ){         GuiControlGet, i, %A_Gui%:Pos, %ctrl%         MMD := InStr(DimSize, ""*"") ? ""MoveDraw"" : ""Move""         fx := fy := fw := fh := 0         For i, dim in (a := StrSplit(RegExReplace(DimSize, ""i)[^xywh]"")))             If !RegExMatch(DimSize, ""i)"" dim ""\s*\K[\d.-]+"", f%dim%)               f%dim% := 1         cInfo[ctrlID] := { x:ix, fx:fx, y:iy, fy:fy, w:iw, fw:fw, h:ih, fh:fh, gw:A_GuiWidth, gh:A_GuiHeight, a:a , m:MMD}     }Else If ( cInfo[ctrlID].a.1) {         dgx := dgw := A_GuiWidth  - cInfo[ctrlID].gw  , dgy := dgh := A_GuiHeight - cInfo[ctrlID].gh         For i, dim in cInfo[ctrlID][""a""]             Options .= dim (dg%dim% * cInfo[ctrlID][""f"" dim] + cInfo[ctrlID][dim]) A_Space         GuiControl, % A_Gui "":"" cInfo[ctrlID].m , % ctrl, % Options } } } Example: Code: [Select all] [Expand] [Download] (Untitled.ahk)GeSHi © Codebox Plus #Include, AutoXYWH.ahk   Gui, +Resize Gui, Add, Edit, ve1 w150 h100 Gui, Add, Button, vb1 gResize, Resize Gui, Show return   Resize: 	GuiControl, Move, e1, h50 	AutoXYWH(""reset"") ; Needs to reset if you changed the Control size manually. return   GuiSize: 	If (A_EventInfo = 1) ; The window has been minimized. 		Return 	AutoXYWH(""wh"", ""e1"") 	AutoXYWH(""y"", ""b1"") return Last edited by tmplinshi on 28 May 2015, 22:57, edited 11 times in total. Top Rindis Posts: 15 Joined: 23 Dec 2013, 13:58 Location: Norway Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 23 Dec 2013, 14:28 Hi I can't get this to work. I get an error saying ""Call to non existent function"" in this line: cInfo[ctrl] := { _x:(_x), _y:(_y), _w:(_w), _h:(_h), _a:StrSplit(_a) } Cheers Top tmplinshi Posts: 836 Joined: 01 Oct 2013, 14:57 Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 23 Dec 2013, 14:31 Hello, Rindis Please use latest version of AHK. Download link: http://l.autohotkey.net/AutoHotkey_L_Install.exe Top gregster Posts: 124 Joined: 30 Sep 2013, 06:48 Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 23 Dec 2013, 14:33 As far as I know, StrSplit() - as a function - is relatively new to AHK (the corresponding command is older) . You probably need AHK 1.1.13.01, like it is mentioned in the script header. So, update...! Top Rindis Posts: 15 Joined: 23 Dec 2013, 13:58 Location: Norway Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 23 Dec 2013, 14:39 Thank. Now updated and its working Cheers Top toralf Posts: 426 Joined: 27 Apr 2014, 21:08 Location: Germany Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 25 Jun 2014, 13:41 Dear tmplinshi, your code is nice, but it doesn't support fractions of dimensions, e.g. w0.5 = control gets only half of the gui width change. Have you considered to expend your function in this direction? ciao toralf Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 25 Jun 2014, 15:03 Nice! @toralf true... But then, doesn't anchor do that? Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top toralf Posts: 426 Joined: 27 Apr 2014, 21:08 Location: Germany Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 25 Jun 2014, 15:37 @joedf Yes, but much more complicated. The lastest version of Anchor() is very complex code (i assume it got further optimized for speed). This version is simple and uses the latest features of AHK. And it allows to give a list of controls at once. I went ahead an made a mod. Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ; ================================================================================= ; Function:     AutoXYWH ;   Move and resize control automatically when GUI resized. ; Parameters: ;   ctrl_list  - ControlID list separated by ""|"". ;                ControlID can be a control HWND, associated variable name or ClassNN. ;   Attributes - Can be one or more of x/y/w/h  followed by fractions ;   Redraw     - True to redraw controls ; Examples: ;   AutoXYWH(""Btn1|Btn2"", ""xy"") ;   AutoXYWH(hEdit      , ""w0.5 h0.75"") ; --------------------------------------------------------------------------------- ; Release date: 2014-6-25           http://ahkscript.org/boards/viewtopic.php?t=1079 ; Author      : tmplinshi (mod by toralf) ; requires AHK version : 1.1.13.01+ ; ================================================================================= AutoXYWH(ctrl_list, Attributes=""wh"", Redraw = False){     static cInfo := {}     Loop, Parse, ctrl_list, |     {         ctrl := A_Gui "":"" A_LoopField         If ( cInfo[ctrl].x = """" ){             GuiControlGet, i, %A_Gui%:Pos, %A_LoopField%             a := RegExReplace(Attributes, ""i)[^xywh]"")              fx := fy := fw := fh := 0             Loop, Parse, a                 If !RegExMatch(Attributes, ""i)"" A_LoopField ""\s*\K[\d.-]+"", f%A_LoopField%)                   f%A_LoopField% := 1             cInfo[ctrl] := { x:ix, fx:fx, y:iy, fy:fy, w:iw, fw:fw, h:ih, fh:fh, gw:A_GuiWidth, gh:A_GuiHeight, a:StrSplit(a) }         }Else If ( cInfo[ctrl].a.1) {             x := (A_GuiWidth  - cInfo[ctrl].gw) * cInfo[ctrl].fx + cInfo[ctrl].x             y := (A_GuiHeight - cInfo[ctrl].gh) * cInfo[ctrl].fy + cInfo[ctrl].y             w := (A_GuiWidth  - cInfo[ctrl].gw) * cInfo[ctrl].fw + cInfo[ctrl].w             h := (A_GuiHeight - cInfo[ctrl].gh) * cInfo[ctrl].fh + cInfo[ctrl].h             For i, a in cInfo[ctrl][""a""]                 Options .= a %a% A_Space             GuiControl, % A_Gui "":"" (Redraw ? ""MoveDraw"" : ""Move""), % A_LoopField, % Options         }     } } Last edited by toralf on 30 Jun 2014, 22:22, edited 4 times in total. ciao toralf Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 25 Jun 2014, 15:55 nice mod! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 25 Jun 2014, 16:03 can probably use this at the top of scripts requiring later AHK versions: Code: [Select all] [Download] GeSHi © Codebox Plus if (A_AhkVersion < ""1.1.13.01"")    MsgBox, This script/func requires AHK v1.1.13.01 or greater   http://ahkscript.org/docs/Variables.htm#AhkVersion Top tmplinshi Posts: 836 Joined: 01 Oct 2013, 14:57 Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 26 Jun 2014, 06:06 @toralf Thanks for share. Your version looks much better. Top toralf Posts: 426 Joined: 27 Apr 2014, 21:08 Location: Germany Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 26 Jun 2014, 08:06 Fame is all to you, you started this. here is a another mod with variadic list. I removed the redraw option. Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ; ================================================================================= ; Function: AutoXYWH ;   Move and resize control automatically when GUI resizes. ; Parameters: ;   DimSize - Can be one or more of x/y/w/h  [followed by a fraction] ;   cList   - variadic list of ControlIDs separated ;             ControlID can be a control HWND, associated variable name, ClassNN or displayed text. ; Examples: ;   AutoXYWH(""xy"", ""Btn1"", ""Btn2"") ;   AutoXYWH(""w0.5 h 0.75"", hEdit, ""displayed text"", ""vLabel"", ""Button1"") ; --------------------------------------------------------------------------------- ; Release date: 2014-6-26           http://ahkscript.org/boards/viewtopic.php?t=1079 ; Author      : tmplinshi (mod by toralf) ; requires AHK version : 1.1.13.01+ ; ================================================================================= AutoXYWH(DimSize, cList*){     static cInfo := {}     For i, ctrl in cList {         ctrlID := A_Gui "":"" ctrl         If ( cInfo[ctrlID].x = """" ){             GuiControlGet, i, %A_Gui%:Pos, %ctrl%             fx := fy := fw := fh := 0             For i, dim in (a := StrSplit(RegExReplace(DimSize, ""i)[^xywh]"")))                 If !RegExMatch(DimSize, ""i)"" dim ""\s*\K[\d.-]+"", f%dim%)                   f%dim% := 1             cInfo[ctrlID] := { x:ix, fx:fx, y:iy, fy:fy, w:iw, fw:fw, h:ih, fh:fh, gw:A_GuiWidth, gh:A_GuiHeight, a:a }         }Else If ( cInfo[ctrlID].a.1) {             dgx := dgw := A_GuiWidth  - cInfo[ctrlID].gw  , dgy := dgh := A_GuiHeight - cInfo[ctrlID].gh             For i, dim in cInfo[ctrlID][""a""]                 Options .= dim (dg%dim% * cInfo[ctrlID][""f"" dim] + cInfo[ctrlID][dim]) A_Space             GuiControl, %A_Gui%:MoveDraw, % ctrl, % Options }    }    }   Last edited by toralf on 30 Jun 2014, 22:23, edited 4 times in total. ciao toralf Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 26 Jun 2014, 09:42 Nice! It's shaping! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 27 Jun 2014, 07:38 Awesome code! But, since vLabels, ClassNNs, and text are permitted as control identifiers, I suggest to consider the Gui. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top toralf Posts: 426 Joined: 27 Apr 2014, 21:08 Location: Germany Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 27 Jun 2014, 08:00 I was thinking of it too, but GuiControlGet works on the default Gui. I decided to leave it to the user to define a differnt Gui as default Code: [Select all] [Download] GeSHi © Codebox Plus Gui, GuiName:Default just before the function is called *not tested*. I assume in most cases this will not be nessecary, because the GuiSize thread will be set it's own Gui as the default. So only in the rare cases that you want to control a second gui size by resizing the first gui you would need to define a different default gui. (do not even know if that would work, since A_GuiWidth and A_GuiHeight would be of the first gui) Does this makes sense? Overall, I believe it is not required. Do you agree? ciao toralf Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 27 Jun 2014, 08:48 It's permitted to use the same vLabel and control text in different Guis. Also, ClassNNs like Edit1 or Button1 aren't necessarily unique. But only the first of two or more identical control identifiers will be stored, and possibly used for the wrong Gui. That's what I thought about. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top toralf Posts: 426 Joined: 27 Apr 2014, 21:08 Location: Germany Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 28 Jun 2014, 12:11 Good point. I'll fix it. ciao toralf Top toralf Posts: 426 Joined: 27 Apr 2014, 21:08 Location: Germany Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 28 Jun 2014, 20:06 I hope I fixed both of my two functions above. Could not test it yet, I'm only on my phone. ciao toralf Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 30 Jun 2014, 03:21 It's working on A32, U32, and U64. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top toralf Posts: 426 Joined: 27 Apr 2014, 21:08 Location: Germany Re: AutoXYWH() - Move control automatically when GUI resized Report this post Quote 01 Jul 2014, 14:36 This version removes some of the flickering by reducing the MoveDraw to only controls of class 'Button' (since Groupboxes are of class 'Button'). Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus AutoXYWH(DimSize, cList*){  ; http://ahkscript.org/boards/viewtopic.php?t=1079   static cInfo := {}   If !cInfo[A_Gui].ClassNN.MaxIndex() {     WinGet, CH, ControlListHwnd,     WinGet, CN, ControlList,     ACH := StrSplit(CH, ""`n""), ACN := StrSplit(CN, ""`n"")     Loop, % ACH.MaxIndex()       If InStr(ACN[A_Index], ""Button"")   ;GroupBox have a ClassNN of 'Button'         cInfo[A_Gui , ""ClassNN"" , ACH[A_Index]] := 1   }   For i, ctrl in cList {     ctrlID := A_Gui "":"" ctrl     If ( cInfo[ctrlID].x = """" ){         GuiControlGet, i, %A_Gui%:Pos, %ctrl%         GuiControlGet, Hwnd, %A_Gui%:Hwnd, %ctrl%         MMD := cInfo[A_Gui,""ClassNN"",Hwnd] ? ""MoveDraw"" : ""Move""         fx := fy := fw := fh := 0         For i, dim in (a := StrSplit(RegExReplace(DimSize, ""i)[^xywh]"")))             If !RegExMatch(DimSize, ""i)"" dim ""\s*\K[\d.-]+"", f%dim%)               f%dim% := 1         cInfo[ctrlID] := { x:ix, fx:fx, y:iy, fy:fy, w:iw, fw:fw, h:ih, fh:fh, gw:A_GuiWidth, gh:A_GuiHeight, a:a , m:MMD}     }Else If ( cInfo[ctrlID].a.1) {         dgx := dgw := A_GuiWidth  - cInfo[ctrlID].gw  , dgy := dgh := A_GuiHeight - cInfo[ctrlID].gh         For i, dim in cInfo[ctrlID][""a""]             Options .= dim (dg%dim% * cInfo[ctrlID][""f"" dim] + cInfo[ctrlID][dim]) A_Space         GuiControl, % A_Gui "":"" cInfo[ctrlID].m , % ctrl, % Options } } } ciao toralf Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 68 posts 1 2 3 4 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Bing [Bot], pondermatic and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by tmplinshi - Move and resize controls automatically when a GUI is resized."	"true"
"General"	"TaskDialog"	"https://github.com/AHK-just-me/TaskDialog"	"by just Me - enhanced MsgBox for Win Vista+ -"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"2"	"1"	"0"	"GitHub - AHK-just-me/TaskDialog: The other MsgBox for Win Vista+. Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 1 Star 2 Fork 0 AHK-just-me/TaskDialog Code Issues 0 Pull requests 0 Pulse Graphs The other MsgBox for Win Vista+. 2 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Fetching latest commit… Cannot retrieve the latest commit at this time. Permalink Failed to load latest commit information. Sources LICENSE README.md README.md TaskDialog The other MsgBox for Win Vista+. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/AHK-just-me/TaskDialog"	"by just Me - enhanced MsgBox for Win Vista+ -"	"true"
"General"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=4635"	"by just Me - enhanced MsgBox for Win Vista+ -"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"TaskDialog() - the other 'MsgBox' for Win Vista+ - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:27 All times are UTC-05:00 TaskDialog() - the other 'MsgBox' for Win Vista+ Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 56 posts 1 2 3 Next just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 20 Sep 2014, 02:34 MSDN wrote:Task Dialog ... A task dialog is similar to, while much more flexible than, a basic message box. Source The task dialog was introduced with Win Vista and the simple form TaskDialog() can be used as a 'modernized' message box replacement. There are at least two implementations at AutoHotkey dot com: TheGood's 'all-inclusive' solution wrapping the TaskDialogIndirect() function: /board/topic/54555-taskdialog-stdlib-compatible/ nepter's solution providing wrapper functions for both TaskDialog() and TaskDialogIndirect() functions: /board/topic/96587-ahk-l-taskdialog-taskdialogex-windows-vista/ Nevertheless, I think it's worth to be found here too (though according to Microsoft it won't work on Win XP). So I wrote a slightly changed wrapper for the TaskDialog() function using the main instruction as the only mandatory parameter and additional undocumented icon values found in TheGood's script. Screenshot: TaskDialog.PNG (5.86 KiB) Viewed 2395 times Simple version Update on 2014-09-20: Revised inline documentation. Changed TDBTNS. Removed needless definitions. TaskDialog.ahk: Code: [Select all] [Expand] [Download] (TaskDialog.ahk)GeSHi © Codebox Plus ; ====================================================================================================================== ; TaskDialog -> msdn.microsoft.com/en-us/library/bb760540(v=vs.85).aspx ; Main:     String to be used for the main instruction (mandatory). ; Extra:    String used for additional text that appears below the main instruction (optional). ;           Default: 0 - no additional text. ; Title:    String to be used for the task dialog title (optional). ;           Default: """" - A_ScriptName. ; Buttons:  Specifies the push buttons displayed in the dialog box (optional). ;           This parameter may be a combination of the integer values defined in TDBTNS or a pipe (|) separated ;           list of the string keys. ;           Default: 0 - OK button ; Icon:     Specifies the icon to display in the task dialog (optional). ;           This parameter can be one of the keys defined in TDICON. ;           Default: 0 - no icon ; Parent:   HWND of the owner window of the task dialog to be created(optional). ;           If specified, the task dialog will become modal. ;           Default: 0 - no owner window ; Returns:  An integer value identifying the button pressed by the user: ;           1 = OK, 2 = CANCEL, 4 = RETRY, 6 = YES, 7 = NO, 8 = CLOSE ;           If the function fails, ErrorLevel will be set to 1 and the return value will be empty. ; ====================================================================================================================== TaskDialog(Main, Extra := 0, Title := """", Buttons := 0, Icon := 0, Parent := 0) {    Static S_OK := 0    Static TDBTNS := {OK: 1, YES: 2, NO: 4, CANCEL: 8, RETRY: 16, CLOSE: 32}    Static TDICON := {1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 6, 7: 7, 8: 8, 9: 9                    , WARN: 1, ERROR: 2, INFO: 3, SHIELD: 4, BLUE: 5, YELLOW: 6, RED: 7, GREEN: 8, GRAY: 9}    If ((DllCall(""Kernel32.dll\GetVersion"", ""UInt"") & 0xFF) < 6) {       MsgBox, 16, %A_ThisFunc%, This function requires Windows Vista or newer!       Return    }    BTNS := 0    If Buttons Is Integer       BTNS := Buttons & 0x3F    Else       For Each, Btn In StrSplit(Buttons, ""|"")          BTNS |= (B := TDBTNS[Btn]) ? B : 0    ICO := (I := TDICON[Icon]) ? 0x10000 - I : 0    If (S_OK = DllCall(""Comctl32.dll\TaskDialog""                     , ""Ptr"",  Parent                     , ""Ptr"",  0                     , ""WStr"", Title = """" ? A_ScriptName : Title                     , ""WStr"", Main                     , Extra = 0 ? ""Ptr"" : ""WStr"",  Extra                     , ""UInt"", BTNS                     , ""Ptr"",  ICO                     , ""IntP"", Result))       Return Result    ErrorLevel := 1 } Sample: Code: [Select all] [Download] (Sample.ahk)GeSHi © Codebox Plus #NoEnv #Include TaskDialog.ahk Gui, +HwndHGUI Gui, Show, w600 h400, Dummy Main := ""Some main instruction`nwith`nthree lines!"" Extra := ""And some additional text that appears below the main instruction.`n""        . ""The dialog is showing all of the possible buttons."" MsgBox, % TaskDialog(Main, Extra, , 0x3F, 8, HGUI) ExitApp Advanced version Update on 2014-09-26: Added parameter Width to specify the width of the task dialog in pixels. For details look at the Remarks section of the inline documentation and viewtopic.php?p=26779#p26779, please. Updated sample script. Update on 2014-09-24: Added TaskDialogUseMsgBoxOnXP() which may be called once passing True and will cause the TaskDialog() function to display a MsgBox instead of a task dialog on Win XP systems. For restrictions look at the Remarks section of the inline documentation, please. Additional features: Added AlwaysOnTop option (pass -1 in the Parent parameter). Added question mark icon (pass ""Question"" in the Icon parameter). Added support for custom icons (pass a HICON handle in the Icon parameter). Added Timeout parameter. Added Width parameter. Added option to show a simple MsgBox instead of the task dialog on Windows versions prior Vista. TaskDialog.ahk: Code: [Select all] [Expand] [Download] (TaskDialog.ahk)GeSHi © Codebox Plus ; ====================================================================================================================== ; TaskDialog -> msdn.microsoft.com/en-us/library/bb760540(v=vs.85).aspx ; Main:     String to be used for the main instruction (mandatory). ; Extra:    String used for additional text that appears below the main instruction (optional). ;           Default: 0 - no additional text. ; Title:    String to be used for the task dialog title (optional). ;           Default: """" - A_ScriptName. ; Buttons:  Specifies the push buttons displayed in the dialog box (optional). ;           This parameter may be a combination of the integer values defined in TDBTNS or a list of string keys ;           separated by pipe (|), space, comma, or LF (`n). ;           list of the string keys. ;           Default: 0 - OK button ; Icon:     Specifies the icon to display in the task dialog (optional). ;           This parameter can be one of the keys defined in TDICON or a HICON handle to a 32*32 sized icon. ;           Default: 0 - no icon ; Width:    Specifies the width of the task dialog's client area, in pixels. ;           If you pass -1 the width of the task dialog is determined by the width of its content (Extra) area. ;           Default: 0 - the task dialog manager will calculate the ideal width. ; Parent:   HWND of the owner window of the task dialog to be created(optional). ;           If a valid window handle is specified, the task dialog will become modal. ;           Pass -1 to set the task dialog 'AlwaysOnTop'. ;           Default: 0 - no owner window ; Timeout:  Timeout in seconds, which can contain a decimal point. ;           Due to the use of the TDN_TIMER notification the precision will be about 200 ms. ;           Default: 0 - no timeout ; Returns:  An integer value identifying the button pressed by the user: ;           -1 = Timeout, 1 = OK, 2 = CANCEL, 4 = RETRY, 6 = YES, 7 = NO, 8 = CLOSE ;           If the function fails, ErrorLevel will be set and the return value will be 0. ; Remarks:  Depending on the settings of TaskDialogUseMsgBoxOnXP() the function can display a MsgBox instead of ;           the task dialog on Win XP. In that case you should only use icons and in particular button combinations ;           also supported by the MsgBox command: ;              Icon:    1/""WARN"", 2/""ERROR"", 3/""INFO"", ""QUESTION"" ;              Buttons: 1/""OK"", 9/""OK|CANCEL"", 6/""YES|NO"", 14/""YES|NO|CANCEL"", 24/""RETRY|CANCEL"" ;           Other icons won't be shown, other button combinations won't show all specified buttons. ; Version:  2014-09-26 ; ====================================================================================================================== TaskDialog(Main, Extra := """", Title := """", Buttons := 0, Icon := 0, Width := 0, Parent := 0, TimeOut := 0) {    Static TDCB      := RegisterCallback(""TaskDialogCallback"", ""Fast"")         , TDCSize   := (4 * 8) + (A_PtrSize * 16)         , TDBTNS    := {OK: 1, YES: 2, NO: 4, CANCEL: 8, RETRY: 16, CLOSE: 32}         , TDF       := {HICON_MAIN: 0x0002, ALLOW_CANCEL: 0x0008, CALLBACK_TIMER: 0x0800, SIZE_TO_CONTENT: 0x01000000}         , TDICON    := {1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 6, 7: 7, 8: 8, 9: 9                       , WARN: 1, ERROR: 2, INFO: 3, SHIELD: 4, BLUE: 5, YELLOW: 6, RED: 7, GREEN: 8, GRAY: 9                       , QUESTION: 0}         , HQUESTION := DllCall(""User32.dll\LoadIcon"", ""Ptr"", 0, ""Ptr"", 0x7F02, ""UPtr"")         , DBUX      := DllCall(""User32.dll\GetDialogBaseUnits"", ""UInt"") & 0xFFFF         , OffParent := 4         , OffFlags  := OffParent + (A_PtrSize * 2)         , OffBtns   := OffFlags + 4         , OffTitle  := OffBtns + 4         , OffIcon   := OffTitle + A_PtrSize         , OffMain   := OffIcon + A_PtrSize         , OffExtra  := OffMain + A_PtrSize         , OffCB     := (4 * 7) + (A_PtrSize * 14)         , OffCBData := OffCB + A_PtrSize         , OffWidth  := OffCBData + A_PtrSize    ; -------------------------------------------------------------------------------------------------------------------    If ((DllCall(""Kernel32.dll\GetVersion"", ""UInt"") & 0xFF) < 6) {       If TaskDialogUseMsgBoxOnXP()          Return TaskDialogMsgBox(Main, Extra, Title, Buttons, Icon, Parent, Timeout)       Else {          MsgBox, 16, %A_ThisFunc%, You need at least Win Vista / Server 2008 to use %A_ThisFunc%().          ErrorLevel := ""You need at least Win Vista / Server 2008 to use "" . A_ThisFunc . ""().""          Return 0       }    }    ; -------------------------------------------------------------------------------------------------------------------    Flags := Width = 0 ? TDF.SIZE_TO_CONTENT : 0    If (Title = """")       Title := A_ScriptName    BTNS := 0    If Buttons Is Integer       BTNS := Buttons & 0x3F    Else       For Each, Btn In StrSplit(Buttons, [""|"", "" "", "","", ""`n""])          BTNS |= (B := TDBTNS[Btn]) ? B : 0    ICO := (I := TDICON[Icon]) ? 0x10000 - I : 0    If Icon Is Integer       If ((Icon & 0xFFFF) <> Icon) ; caller presumably passed HICON          ICO := Icon    If (Icon = ""Question"")       ICO := HQUESTION    If (ICO > 0xFFFF)       Flags |= TDF.HICON_MAIN    AOT := Parent < 0 ? !(Parent := 0) : False ; AlwaysOnTop    ; -------------------------------------------------------------------------------------------------------------------    PTitle := A_IsUnicode ? &Title : TaskDialogToUnicode(Title, WTitle)    PMain  := A_IsUnicode ? &Main : TaskDialogToUnicode(Main, WMain)    PExtra := Extra = """" ? 0 : A_IsUnicode ? &Extra : TaskDialogToUnicode(Extra, WExtra)    VarSetCapacity(TDC, TDCSize, 0) ; TASKDIALOGCONFIG structure    NumPut(TDCSize, TDC, ""UInt"")    NumPut(Parent, TDC, OffParent, ""Ptr"")    NumPut(BTNS, TDC, OffBtns, ""Int"")    NumPut(PTitle, TDC, OffTitle, ""Ptr"")    NumPut(ICO, TDC, OffIcon, ""Ptr"")    NumPut(PMain, TDC, OffMain, ""Ptr"")    NumPut(PExtra, TDC, OffExtra, ""Ptr"")    If (AOT) || (TimeOut > 0) {       If (TimeOut > 0) {          Flags |= TDF.CALLBACK_TIMER          TimeOut := Round(Timeout * 1000)       }       TD := {AOT: AOT, Timeout: Timeout}       NumPut(TDCB, TDC, OffCB, ""Ptr"")       NumPut(&TD, TDC, OffCBData, ""Ptr"")    }    NumPut(Flags, TDC, OffFlags, ""UInt"")    If (Width > 0)       NumPut(Width * 4 / DBUX, TDC, OffWidth, ""UInt"")    If !(RV := DllCall(""Comctl32.dll\TaskDialogIndirect"", ""Ptr"", &TDC, ""IntP"", Result, ""Ptr"", 0, ""Ptr"", 0, ""UInt""))       Return TD.TimedOut ? -1 : Result    ErrorLevel := ""The call of TaskDialogIndirect() failed!`nReturn value: "" . RV . ""`nLast error: "" . A_LastError    Return 0 } ; ====================================================================================================================== ; Call this function once passing 1/True if you want a MsgBox to be displayed instead of the task dialog on Win XP. ; ====================================================================================================================== TaskDialogUseMsgBoxOnXP(UseIt := """") {    Static UseMsgBox := False    If (UseIt <> """")       UseMsgBox := !!UseIt    Return UseMsgBox } ; ====================================================================================================================== ; Internally used functions ; ====================================================================================================================== TaskDialogMsgBox(Main, Extra, Title := """", Buttons := 0, Icon := 0, Parent := 0, TimeOut := 0) {    Static MBICON := {1: 0x30, 2: 0x10, 3: 0x40, WARN: 0x30, ERROR: 0x10, INFO: 0x40, QUESTION: 0x20}         , TDBTNS := {OK: 1, YES: 2, NO: 4, CANCEL: 8, RETRY: 16}    BTNS := 0    If Buttons Is Integer       BTNS := Buttons & 0x1F    Else       For Each, Btn In StrSplit(Buttons, [""|"", "" "", "","", ""`n""])          BTNS |= (B := TDBTNS[Btn]) ? B : 0    Options := 0    Options |= (I := MBICON[Icon]) ? I : 0    Options |= Parent = -1 ? 262144 : Parent > 0 ? 8192 : 0    If ((BTNS & 14) = 14)       Options |= 0x03 ; Yes/No/Cancel    Else If ((BTNS & 6) = 6)       Options |= 0x04 ; Yes/No    Else If ((BTNS & 24) = 24)       Options |= 0x05 ; Retry/Cancel    Else If ((BTNS & 9) = 9)       Options |= 0x01 ; OK/Cancel    Main .= Extra <> """" ? ""`n`n"" . Extra : """"    MsgBox, % Options, %Title%, %Main%, %TimeOut%    IfMsgBox, OK       Return 1    IfMsgBox, Cancel       Return 2    IfMsgBox, Retry       Return 4    IfMsgBox, Yes       Return 6    IfMsgBox, No       Return 7    IfMsgBox, TimeOut       Return -1    Return 0 } ; ====================================================================================================================== TaskDialogToUnicode(String, ByRef Var) {    VarSetCapacity(Var, StrPut(String, ""UTF-16"") * 2, 0)    StrPut(String, &Var, ""UTF-16"")    Return &Var } ; ====================================================================================================================== TaskDialogCallback(H, N, W, L, D) {    Static TDM_CLICK_BUTTON := 0x0466         , TDN_CREATED := 0         , TDN_TIMER   := 4    TD := Object(D)    If (N = TDN_TIMER) && (W > TD.Timeout) {       TD.TimedOut := True       PostMessage, %TDM_CLICK_BUTTON%, 2, 0, , ahk_id %H% ; IDCANCEL = 2    }    Else If (N = TDN_CREATED) && TD.AOT {       DHW := A_DetectHiddenWindows       DetectHiddenWindows, On       WinSet, AlwaysOnTop, On, ahk_id %H%       DetectHiddenWindows, %DHW%    }    Return 0 } Sample.ahk: Code: [Select all] [Expand] [Download] (Sample.ahk)GeSHi © Codebox Plus #NoEnv #Include TaskDialog.ahk TaskDialogUseMsgBoxOnXP(True) Gui, +HwndHGUI Gui, Show, w600 h400, Dummy Main  := ""Some rather long main instruction without any line breaks just to see what happens."" Extra := ""The dialog is showing all of the possible buttons. The dialog is showing all of the possible buttons. The dialog is showing all of the possible buttons."" MsgBox, 262144, %A_ScriptName%, % TaskDialog(Main, Extra, , 0x3F, ""Green"", , HGUI) ToolTip Extra := ""Short Extra text."" MsgBox, 262144, %A_ScriptName%, % TaskDialog(Main, Extra, , 6, ""Question"", , -1) ToolTip MsgBox, 262144, %A_ScriptName%, % TaskDialog(Main, Extra, , 6, ""Question"", 700, -1) ToolTip Return GuiClose: ExitApp ; Show the width and height of the current task dialog ^+w:: HWND := WinExist(""A"") VarSetCapacity(RC, 16, 0) DllCall(""User32.dll\GetClientRect"", ""Ptr"", HWND, ""Ptr"", &RC) ToolTip, % NumGet(RC, 8, ""Int"") . "" - "" . NumGet(RC, 12, ""Int"") Return Updated on 2014-09-26: see Advanced version Last edited by just me on 26 Sep 2014, 00:48, edited 4 times in total. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top Coco Posts: 767 Joined: 29 Sep 2013, 20:37 GitHub: cocobelgica Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 20 Sep 2014, 02:45 Cool! Thanks just me Top ozzii Posts: 224 Joined: 30 Oct 2013, 06:04 Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 20 Sep 2014, 03:28 Yes, this is cool. If I may: Maybe a ""simpler"" way to do the combination of the button. Calculating in HEX is not my strong side Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 20 Sep 2014, 03:35 ozzii wrote:If I may: Maybe a ""simpler"" way to do the combination of the button. Calculating in HEX is not my strong side You may not, because its already been done. Read the docs: just me wrote: Code: [Select all] [Expand] [Download] (TaskDialog.ahk)GeSHi © Codebox Plus ; Buttons:  Specifies the push buttons displayed in the dialog box (optional). ;           This parameter may be a combination of the integer keys defined in TDBTNS or a ;           pipe (|) separated list of the string keys. ; ========================================================================================= TaskDialog(Main, Extra := 0, Title := """", Buttons := 0, Icon := 0, Parent := 0) {      Static TDBTNS := {OK: 0x01, YES: 0x02, NO: 0x04, CANCEL: 0x08, RETRY: 0x10, CLOSE: 0x20}    ;...    If Buttons Is Integer       BTNS := Buttons & 0x3F    Else       For Each, Btn In StrSplit(Buttons, ""|"")          BTNS |= (B := TDBTNS[Btn]) ? B : 0 Top Coco Posts: 767 Joined: 29 Sep 2013, 20:37 GitHub: cocobelgica Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 20 Sep 2014, 03:45 @ozzii TaskDialog() inline doc wrote:This parameter may be a combination of the integer keys defined in TDBTNS or a pipe (|) separated list of the string keys. Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 20 Sep 2014, 04:17 ozzii, I've updated the script using decimal values. But you don't need to precalculate at all. You just might use TaskDialog(""My Main"", ""My Extra"", ""My Title"", 0x02 + 0x04). Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top Coco Posts: 767 Joined: 29 Sep 2013, 20:37 GitHub: cocobelgica Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 20 Sep 2014, 04:37 Hi just me, if it's OK with you, perhaps you can provide more flexibility on the type of delimiter for the Buttons parameter other than a pipe(|). Something like StrSplit(Buttons, [""|"", "" "", "","", ""`n""]) Top huyaowen Posts: 96 Joined: 28 Jul 2014, 01:15 Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 20 Sep 2014, 06:18 so cool.thanks. how can i set this beautiful msgbox alway on top? and where is the close button? QQ截图20140920230307.jpg (54.33 KiB) Viewed 2318 times Top DataLife Posts: 159 Joined: 29 Sep 2013, 19:52 Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 20 Sep 2014, 11:14 TaskDialog() has 3 of the 4 icons supported by Msgbox, it is missing the Icon Question. Is it possible to have question mark icon? Check out my scripts. (MyIpChanger) (XPSnap) (SavePictureAs) All my scripts are tested on Windows 7, AutoHotkey 32 bit Ansi unless otherwise stated. Top Coco Posts: 767 Joined: 29 Sep 2013, 20:37 GitHub: cocobelgica Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 20 Sep 2014, 11:24 @DataLife, it only supports the following: Code: [Select all] [Download] GeSHi © Codebox Plus TD_ERROR_ICON       -> A stop-sign icon appears in the task dialog. TD_INFORMATION_ICON -> An icon consisting of a lowercase letter i in a circle appears in the task dialog. TD_SHIELD_ICON      -> A security shield icon appears in the task dialog. TD_WARNING_ICON     -> An exclamation-point icon appears in the task dialog. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 20 Sep 2014, 17:47 Very interesting, I'll check it out! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top huyaowen Posts: 96 Joined: 28 Jul 2014, 01:15 Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 20 Sep 2014, 19:41 Could you set 2 extra parameters for "" timeout"" and ""alway on top""? Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 21 Sep 2014, 02:01 Coco wrote:...perhaps you can provide more flexibility on the type of delimiter for the Buttons parameter other than a pipe(|). Something like StrSplit(Buttons, [""|"", "" "", "","", ""`n""])Sure, I'll use your StrSplit for the next update. huyaowen wrote:and where is the close button?The close button only appears in combination with the cancel button. DataLife wrote:TaskDialog() has 3 of the 4 icons supported by Msgbox, it is missing the Icon Question.This has been discussed on MSDN too. It seems that the lack of the question mark is intended by Microsoft due to changed user interface design guidelines. huyaowen wrote:Could you set 2 extra parameters for "" timeout"" and ""alway on top""?The task dialog doesn't offer equivalent options. But I'll think about a workaround. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top ozzii Posts: 224 Joined: 30 Oct 2013, 06:04 Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 21 Sep 2014, 03:09 guest3456 wrote:You may not, because its already been done. Read the docs: I overlooked this and didn't understand it well at my first read. So, just me, I am so sorry for having overlooked your documentation Oh, and thanks, for the update. Top huyaowen Posts: 96 Joined: 28 Jul 2014, 01:15 Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 21 Sep 2014, 03:44 thanks. waiting for the update. Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 22 Sep 2014, 06:06 Well, it's done. I've implemented the requested features, but decided to keep the original function as 'simple version' and to release a second 'advanced version'. The 'advanced' features are: AlwayOnTop option. Support for the missing question mark icon. Support for custom icons. New Timeout parameter. I hope you'll like it. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top huyaowen Posts: 96 Joined: 28 Jul 2014, 01:15 Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 22 Sep 2014, 07:14 thank you very much. Could u also import the normal msgbox for XP? then display the beautiful msgbox on win7 or newer.and display a normal msgbox on WINXP. Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 22 Sep 2014, 07:29 I think I can! Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top huyaowen Posts: 96 Joined: 28 Jul 2014, 01:15 Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 22 Sep 2014, 07:57 aha!so amazing! thanks again. Could the normal msgbox recognize the parameters(on top,icon,timeout and so on)? Last edited by huyaowen on 22 Sep 2014, 18:18, edited 1 time in total. Top jNizM Posts: 1581 Joined: 30 Sep 2013, 01:33 GitHub: jNizM Location: Germany Re: TaskDialog() - the other 'MsgBox' for Win Vista+ Report this post Quote 22 Sep 2014, 08:32 @huyaowen: some info for you about MsgBox - MessageBox function - MessageBoxEx function - MessageBoxIndirect function & MSGBOXPARAMS structure @just me: something to add for Task Dialogs About Task Dialogs (Parts of a Task Dialog) [AHK] 1.1.24.00 x64 Unicode [WIN] 7 Ultimate x64 SP1 | 10 Pro (10.0.10586) x64 Dropbox referrals (earn 500 MB of bonus and support me) Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 56 posts 1 2 3 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: pondermatic and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by just Me - enhanced MsgBox for Win Vista+ -"	"true"
"General"	"OnWin"	"https://github.com/cocobelgica/AutoHotkey-Util/blob/master/OnWin.ahk"	"by cocobelgica - Call function on window event (WinWaitXXX async). Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"21"	"3"	"6"	"AutoHotkey-Util/OnWin.ahk at master · cocobelgica/AutoHotkey-Util · GitHub Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 3 Star 21 Fork 6 cocobelgica/AutoHotkey-Util Code Issues 1 Pull requests 0 Pulse Graphs Permalink Branch: master Switch branches/tags Branches Tags dev master Nothing to show Nothing to show Find file Copy path AutoHotkey-Util/OnWin.ahk Fetching contributors… Cannot retrieve contributors at this time Raw Blame History 371 lines (326 sloc) 9.21 KB /** * Function: OnWin * Specifies a function to call when the specified window event for the * specified window occurs. * Version: * v1.1.00.02 * License: * WTFPL [http://wtfpl.net/] * Requirements: * Latest stable version of AutoHotkey * Syntax: * OnWin( Event, WinTitle, Callback [, ItemId := """" ] ) * Parameter(s): * Event [in] - Window event to monitor. Valid values are: Exist, * Close, Show, Hide, Active, NotActive, Minimize, * Maximize. * WinTitle [in] - see http://ahkscript.org/docs/misc/WinTitle.htm * Callback [in] - ""Function object"" - see http://ahkscript.org/docs/objects/Functor.htm * ItemId [in, opt] - User-defined ID to associate with this particular * window event monitor. * Remarks: * - Script must be #Include-ed(manually or automatically) and must not be * copy-pasted into the main script. * - OnWin() uses A_TitleMatchMode * Links: * GitHub - http://goo.gl/JfzFTh * Forum Topic - http://goo.gl/sMufTt */ OnWin(args*) { return __OnWinEvent(args*) } /** * Function: OnWin_Ex * Sames as OnWin() above, however, a child process is spawned to perform the * monitoring. * Syntax: * OnWin_Ex( Event, WinTitle, Callback [, ItemId := """", ProcessName := ""default"" ] ) * Parameter(s): * Event [in] - Same as that of OnWin()'s * WinTitle [in] - Same as that of OnWin()'s * Callback [in] - Same as that of OnWin()'s * ItemId [in, opt] - Same as that of OnWin()'s * ProcessName [in, opt] - User-defined ID to associate with this particular * child process. Subsequent call(s) to OnWin_Ex() * will push the window event monitor info into the * queue of this particular process unless a different * name/ID is specified. */ OnWin_Ex(args*) { return __OnWinEvent(args*) } /** * Function: OnWin_Stop * Disables monitoring for the particular window event monitor info item * specified by the 'ItemId' parameter. * Syntax: * OnWin_Stop( ItemId [, ProcessName ] ) * Parameter(s): * ItemId [in] - a previously defined ItemId - see OnWin/OnWin_Ex * If explicitly blank(""""), all window event monitor * are disabled. * ProcessName [in, opt] - a previously defined ProcessName - see OnWin_Ex */ OnWin_Stop(id, name*) { return __OnWinEvent(id, name*) } ; PRIVATE __OnWinEvent(args*) { static InProcess := new __OnWinEvent.Watcher static SubProcesss := new __OnWinEvent.Server static level := A_AhkVersion<""2"" ? -2 : -1 command := Exception("""", level).What ; prevent user from calling A_ThisFunc directly, overkill?? if (command == ""OnWin"") return %InProcess%(args*) else if (command == ""OnWin_Ex"") return %SubProcesss%(args*) else if (command == ""OnWin_Stop"") { if ObjHasKey(args, 2) SubProcesss.Clients[args[2]].Stop(args[1]) else InProcess.Stop(args[1]) } } class __OnWinEvent ; namespace { class Callable ; base object for custom ""Function"" objects { __Call(method, args*) { if IsObject(method) return this.Call(method, args*) else if (method == """") return this.Call(args*) } } class Watcher extends __OnWinEvent.Callable { Queue := [] IsRunning := false Call(args*) { ObjPush(this.Queue, info := new __OnWinEvent.Info(args*)) if !this.IsRunning this.Start() } Watch() { Loop, % ObjLength(this.Queue) { if this.Queue[1].Assert() ObjRemoveAt(this.Queue, 1) else ObjPush(this.Queue, ObjRemoveAt(this.Queue, 1)) } if !this.IsRunning := ObjLength(this.Queue) ; update 'IsRunning' property this.Stop() } Start() { this.SetTimer(25) this.IsRunning := true } Stop(args*) { this.SetTimer(""Off"") if HasId := ObjLength(args) { id := args[1] if (id == """") && (len := ObjLength(this.Queue)) ObjRemoveAt(this.Queue, 1, len) Loop, % ObjLength(this.Queue) if (this.Queue[A_Index].Id = id) ? ObjRemoveAt(this.Queue, A_Index) : 0 break } this.SetTimer(HasId ? ""On"" : ""Delete"") } SetTimer(arg3) { static number := ""number"" if arg3 is %number% { if !timer := this.Timer timer := this.Timer := ObjBindMethod(this, ""Watch"") SetTimer, %timer%, %arg3% } else if (arg3 = ""On"" || arg3 = ""Off"") { timer := this.Timer SetTimer, %timer%, %arg3% } else if (arg3 = ""Delete"") { if timer := ObjDelete(this, ""Timer"") SetTimer, %timer%, Delete } } } class WatcherEx extends __OnWinEvent.Watcher { Host := """" ; value assigned by host Name := """" ; value assigned by host __Delete() { ExitApp } Stop(args*) { base.Stop(args*) if !ObjLength(args) ; usually called from the timer routine when the queue is empty { ; there are no longer any window events to monitor. Remove object ; reference from the host script's clients list, __Delete should be ; triggered automatically. this.Host.Ptr.Clients.Delete(this.Name) this.Host := """" } } } class Server extends __OnWinEvent.Callable { Clients := {} Call(event, WinTitle, CbProc, id:="""", name:=""default"") { if !IsObject(this.Clients[name]) { client := new __OnWinEvent.Client static q := Chr(34), quot := Func(""Format"").Bind(""{1}{2}{1}"", q) code := Format("" ( LTrim Join`r`n Comments ComObjActive({1}).Proxy := new __OnWinEvent.WatcherEx return #NoTrayIcon #Persistent #Include {2} )"" , quot.Call(client.Guid[""Str""]), A_LineFile) try { WshExec := ComObjCreate(""WScript.Shell"").Exec(quot.Call(A_AhkPath) . "" /ErrorStdOut *"") WshExec.StdIn.Write(code) WshExec.StdIn.Close() while (WshExec.Status == 0) && !client.Proxy Sleep, 10 } finally client.Revoke() client.Proxy.Host := new this.Ref(this) ; weak reference, allows 2-way communication client.Proxy.Name := name this.Clients[name] := client.Proxy client := """" } remote := this.Clients[name] return %remote%(event, WinTitle, CbProc, id, A_TitleMatchMode) } class Ref { __New(self) { this.__Ptr := &self } Ptr[] ; allows client script(s) to retrieve a reference to the host object { get { if (pThis := this.__Ptr) && (NumGet(pThis + 0) == NumGet(&this)) return Object(pThis) } } } __Delete() ; triggers on main script's exit { ; stop remote client script(s) if any for i, client in this.Clients client.SetTimer(""Delete"") ; force stop and remove any extra object references(timer's BoundFunc) this.Clients := """" ; should trigger client script(s) __Delete } } class Client { __New() { HR := DllCall(""oleaut32\RegisterActiveObject"", ""Ptr"", &this, ""Ptr"", this.Guid[""Ptr""], ""UInt"", 0, ""UInt*"", hReg, ""UInt"") if (HR < 0) throw Exception(""RegisterActiveObject() error"", -1, Format(""HRESULT: 0x{:x}"", HR)) this.__Handle := hReg } __Delete() { this.Revoke() } Revoke() { if hReg := this.__Handle DllCall(""oleaut32\RevokeActiveObject"", ""UInt"", hReg, ""Ptr"", 0) this.__Handle := 0 } Guid[arg] { get { if !pGuid := ObjGetAddress(this, ""_Guid"") { ObjSetCapacity(this, ""_Guid"", 94) pGuid := ObjGetAddress(this, ""_Guid"") if ( DllCall(""ole32\CoCreateGuid"", ""Ptr"", pGuid) != 0 ) throw Exception(""Failed to create GUID"", -1, Format(""<at {1:p}>"", pGuid)) DllCall(""ole32\StringFromGUID2"", ""Ptr"", pGuid, ""Ptr"", pGuid + 16, ""Int"", 39) } return (arg=""Ptr"") ? pGuid : (arg=""Str"") ? StrGet(pGuid + 16, ""UTF-16"") : """" } } } class Info { __New(event, WinTitle, CbProc, id:="""", tmm:=0) ; tmm used internally for client scripts { this.Event := event this.WinTitle := WinTitle this.Callback := CbProc this.TitleMatchMode := tmm ? tmm : A_TitleMatchMode if (id != """") this.Id := id } Assert() { event := this.Event WinTitle := this.WinTitle prev_TMM := A_TitleMatchMode this_TMM := this.TitleMatchMode SetTitleMatchMode, %this_TMM% prev_DWH := A_DetectHiddenWindows DetectHiddenWindows, On if (event = ""Exist"") r := WinExist(WinTitle) else if (event = ""Close"") r := !WinExist(WinTitle) else if (event = ""Active"") r := WinActive(WinTitle) else if (event = ""NotActive"") r := !WinActive(WinTitle) else if (event = ""Show"") || (event = ""Hide"" && hWnd := WinExist(WinTitle)) { DetectHiddenWindows, Off r := (event=""Show"") ? WinExist(WinTitle) : !WinExist(WinTitle) } else if (event = ""Minimize"" || event = ""Maximize"") { static WINDOWPLACEMENT if !VarSetCapacity(WINDOWPLACEMENT) VarSetCapacity(WINDOWPLACEMENT, 44, 0), NumPut(44, WINDOWPLACEMENT, 0, ""UInt"") ; sizeof(WINDOWPLACEMENT) hWnd := WinExist(WinTitle) showCmd := event=""Minimize"" ? 2 : 3 DllCall(""GetWindowPlacement"", ""Ptr"", hWnd, ""Ptr"", &WINDOWPLACEMENT) r := NumGet(WINDOWPLACEMENT, 8, ""UInt"") == showCmd } SetTitleMatchMode, %prev_TMM% DetectHiddenWindows %prev_DHW% if r this.Callback.Call(this) return r } } } Jump to Line Go Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/cocobelgica/AutoHotkey-Util/blob/master/OnWin.ahk"	"by cocobelgica - Call function on window event (WinWaitXXX async). Forum thread:"	"true"
"General"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=6463"	"by cocobelgica - Call function on window event (WinWaitXXX async). Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"21"	"3"	"6"	"GitHub - cocobelgica/AutoHotkey-Util: Utility functions for AutoHotkey. Works on both AHK v1.1 and v2.0-a builds. Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 3 Star 21 Fork 6 cocobelgica/AutoHotkey-Util Code Issues 1 Pull requests 0 Pulse Graphs Utility functions for AutoHotkey. Works on both AHK v1.1 and v2.0-a builds. 44 commits 2 branches 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags dev master Nothing to show Nothing to show New pull request Latest commit edccc03 May 16, 2016 cocobelgica Terminate() - fix bug where last found window is not restored. Permalink Failed to load latest commit information. Base64.ahk Added Base64.ahk Mar 16, 2015 BrowserEmulation.ahk Added BrowserEmulation() to repo Dec 30, 2014 CpyData.ahk Renamed 'CpyData_SetF' to 'CpyData_OnRcv' + some minor editions. Nov 9, 2014 EnumIncludes.ahk Improve support for #IncludeAgain and *i option Oct 11, 2015 ExecScript.ahk Code refactored Jan 27, 2015 Guid.ahk Added Guid.ahk May 8, 2015 Include.ahk Code refactored Nov 1, 2014 IsUpdated.ahk Initial commit Aug 19, 2014 MemBlk.ahk v1.1.00.00 Mar 22, 2015 OnExitF.ahk Initial commit Aug 18, 2014 OnWin.ahk v1.1.00.02 Dec 3, 2015 StdOutToVar.ahk Added Include.ahk and StdOutToVar.ahk Aug 25, 2014 Subprocess.ahk Terminate() - fix bug where last found window is not restored. May 16, 2016 TskDlg.ahk Added TskDlg.ahk Sep 20, 2014 UUIDCreate.ahk Added to repo Nov 5, 2014 WinEnum.ahk Added WinEnum.ahk to repo Nov 16, 2014 eol.ahk Added eol.ahk to repo Jan 19, 2015 googl.ahk Initial commit Aug 18, 2014 range.ahk Initial commit Aug 18, 2014 vtype.ahk Added support for BoundFunc object + minor optimization. Mar 13, 2015 Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/cocobelgica/AutoHotkey-Util"	"by cocobelgica - Call function on window event (WinWaitXXX async). Forum thread:"	"true"
"ListView"	"LV_Colors"	"https://github.com/AHK-just-me/Class_LV_Colors/"	"by just Me - Individual background and/or text colours for a GUI ListView's cells or rows. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"7"	"5"	"2"	"GitHub - AHK-just-me/Class_LV_Colors: AHK class providing individual colors for ListView items/subitems. Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 5 Star 7 Fork 2 AHK-just-me/Class_LV_Colors Code Issues 0 Pull requests 0 Pulse Graphs AHK class providing individual colors for ListView items/subitems. 15 commits 1 branch 1 release Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show v0 Nothing to show New pull request Fetching latest commit… Cannot retrieve the latest commit at this time. Permalink Failed to load latest commit information. Sources .gitattributes .gitignore LICENSE README.md README.md Class_LV_Colors The class supports individually colored rows and cells for AHK ListView controls. How to use: Create a new instance with MyInstance := New LV_Colors(HLV) passing the HWND of your ListView. Then call MyInstance.Cell() or MyInstance.Row() to setup colors for individual cells and/or rows. That's all you have to do for coloring. If you finally don't want the colors to be shown any more, use MyInstance := """" to restore the ListView's default behaviour. For more detailed informations look at the inline documentation, please. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/AHK-just-me/Class_LV_Colors/"	"by just Me - Individual background and/or text colours for a GUI ListView's cells or rows. Forum thread:"	"true"
"ListView"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=1081"	"by just Me - Individual background and/or text colours for a GUI ListView's cells or rows. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[Class] LV_Colors - 1.1.04.01 (2016-05-03) - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:27 All times are UTC-05:00 [Class] LV_Colors - 1.1.04.01 (2016-05-03) Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 86 posts 1 2 3 4 5 Next just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany [Class] LV_Colors - 1.1.04.01 (2016-05-03) Report this post Quote 20 Dec 2013, 07:09 Primarily released on old forum: /board/topic/88699-class-lv-colors-coloured-rowscells-in-gui-listviews/. Change History Update on 2016-05-03 (v1.1.04.01): Added change to remove the focus rectangle from custom drawn rows. Update on 2016-05-03 (v1.1.04.00): Added SelectionColor mehod. Updated sample script. Update on 2015-04-12 (v1.1.03.00): Fixed bug for StaticMode. Update on 2015-04-07 (v1.1.02.00): Fixed bugs for StaticMode, NoSort, and NoSizing options. Added class script to the topic. Update on 2015-03-31 (v1.1.01.00): Removed the deprecated OnMessage option from _New(). Restructured code. Update on 2015-03-27 (v1.1.00.00): Added AlternateRows() and AlternateCols() methods. Revised code. Changed sample script. Update on 2015-03-24 (v1.0.00.00): New version using the new features of AHK 1.1.20+: Changed the class to support new instances per control instead of attaching them to the prototype. Added individual message handling per instance which doesn't interfere with other message handlers for WM_NOTIFY messages. Revised code. Adjusted sample script and 'How to use'. Update on 2014-08-13 (v0.5.00.00): Changed internal handling of static mode. It doesn't use the lParam field of the ListView items any more. Note: Be sure to keep track of the relation between row number and row content, if you want to change colors later. Update on 2013-12-31 (v0.4.00.00): Added static mode, i.e. the colors will be assigned permanently to the specified row's content rather than the row number. Note: Be sure to keep track of the relation between row number and row content, if you want to change colors later. Also, the static mode uses the lParam field of the ListView items. If this field is already used for other purposes, you cannot use the static mode simultaneously. Adjusted sample script. Update on 2013-06-16: Added Critical, 100 to avoid that the ListView might become unresponsive.  Update on 2013-01-12: Changed Class_LV_Colors to allow different row and cell colouring within the same row. This is just another attempt to support individual background and/or text colours for a GUI ListView's cells or rows. Class_LVColors.ahk (v1.1.04.01): Code: [Select all] [Expand] [Download] (Class_LVColors.ahk)GeSHi © Codebox Plus ; ====================================================================================================================== ; Namespace:      LV_Colors ; Function:       Individual row and cell coloring for AHK ListView controls. ; Tested with:    AHK 1.1.23.05 (A32/U32/U64) ; Tested on:      Win 10 (x64) ; Changelog: ;     1.1.04.01/2016-05-03/just me - added change to remove the focus rectangle from focused rows ;     1.1.04.00/2016-05-03/just me - added SelectionColors method ;     1.1.03.00/2015-04-11/just me - bugfix for StaticMode ;     1.1.02.00/2015-04-07/just me - bugfixes for StaticMode, NoSort, and NoSizing ;     1.1.01.00/2015-03-31/just me - removed option OnMessage from __New(), restructured code ;     1.1.00.00/2015-03-27/just me - added AlternateRows and AlternateCols, revised code. ;     1.0.00.00/2015-03-23/just me - new version using new AHK 1.1.20+ features ;     0.5.00.00/2014-08-13/just me - changed 'static mode' handling ;     0.4.01.00/2013-12-30/just me - minor bug fix ;     0.4.00.00/2013-12-30/just me - added static mode ;     0.3.00.00/2013-06-15/just me - added ""Critical, 100"" to avoid drawing issues ;     0.2.00.00/2013-01-12/just me - bugfixes and minor changes ;     0.1.00.00/2012-10-27/just me - initial release ; ====================================================================================================================== ; CLASS LV_Colors ; ; The class provides six public methods to set individual colors for rows and/or cells, to clear all colors, to ; prevent/allow sorting and rezising of columns dynamically, and to deactivate/activate the message handler for ; WM_NOTIFY messages (see below). ; ; The message handler for WM_NOTIFY messages will be activated for the specified ListView whenever a new instance is ; created. If you want to temporarily disable coloring call MyInstance.OnMessage(False). This must be done also before ; you try to destroy the instance. To enable it again, call MyInstance.OnMessage(). ; ; To avoid the loss of Gui events and messages the message handler might need to be set 'critical'. This can be ; achieved by setting the instance property 'Critical' ti the required value (e.g. MyInstance.Critical := 100). ; New instances default to 'Critical, Off'. Though sometimes needed, ListViews or the whole Gui may become ; unresponsive under certain circumstances if Critical is set and the ListView has a g-label. ; ====================================================================================================================== Class LV_Colors {    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; META FUNCTIONS ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; ===================================================================================================================    ; __New()         Create a new LV_Colors instance for the given ListView    ; Parameters:     HWND        -  ListView's HWND.    ;                 Optional ------------------------------------------------------------------------------------------    ;                 StaticMode  -  Static color assignment, i.e. the colors will be assigned permanently to the row    ;                                contents rather than to the row number.    ;                                Values:  True/False    ;                                Default: False    ;                 NoSort      -  Prevent sorting by click on a header item.    ;                                Values:  True/False    ;                                Default: True    ;                 NoSizing    -  Prevent resizing of columns.    ;                                Values:  True/False    ;                                Default: True    ; ===================================================================================================================    __New(HWND, StaticMode := False, NoSort := True, NoSizing := True) {       If (This.Base.Base.__Class) ; do not instantiate instances          Return False       If This.Attached[HWND] ; HWND is already attached          Return False       If !DllCall(""IsWindow"", ""Ptr"", HWND) ; invalid HWND          Return False       VarSetCapacity(Class, 512, 0)       DllCall(""GetClassName"", ""Ptr"", HWND, ""Str"", Class, ""Int"", 256)       If (Class <> ""SysListView32"") ; HWND doesn't belong to a ListView          Return False       ; ----------------------------------------------------------------------------------------------------------------       ; Set LVS_EX_DOUBLEBUFFER (0x010000) style to avoid drawing issues.       SendMessage, 0x1036, 0x010000, 0x010000, , % ""ahk_id "" . HWND ; LVM_SETEXTENDEDLISTVIEWSTYLE       ; Get the default colors       SendMessage, 0x1025, 0, 0, , % ""ahk_id "" . HWND ; LVM_GETTEXTBKCOLOR       This.BkClr := ErrorLevel       SendMessage, 0x1023, 0, 0, , % ""ahk_id "" . HWND ; LVM_GETTEXTCOLOR       This.TxClr := ErrorLevel       ; Get the header control       SendMessage, 0x101F, 0, 0, , % ""ahk_id "" . HWND ; LVM_GETHEADER       This.Header := ErrorLevel       ; Set other properties       This.HWND := HWND       This.IsStatic := !!StaticMode       This.AltCols := False       This.AltRows := False       This.NoSort(!!NoSort)       This.NoSizing(!!NoSizing)       This.OnMessage()       This.Critical := ""Off""       This.Attached[HWND] := True    }    ; ===================================================================================================================    __Delete() {       This.Attached.Remove(HWND, """")       This.OnMessage(False)       WinSet, Redraw, , % ""ahk_id "" . This.HWND    }    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; PUBLIC METHODS ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; ===================================================================================================================    ; Clear()         Clears all row and cell colors.    ; Parameters:     AltRows     -  Reset alternate row coloring (True / False)    ;                                Default: False    ;                 AltCols     -  Reset alternate column coloring (True / False)    ;                                Default: False    ; Return Value:   Always True.    ; ===================================================================================================================    Clear(AltRows := False, AltCols := False) {       If (AltCols)          This.AltCols := False       If (AltRows)          This.AltRows := False       This.Remove(""Rows"")       This.Remove(""Cells"")       Return True    }    ; ===================================================================================================================    ; AlternateRows() Sets background and/or text color for even row numbers.    ; Parameters:     BkColor     -  Background color as RGB color integer (e.g. 0xFF0000 = red) or HTML color name.    ;                                Default: Empty -> default background color    ;                 TxColor     -  Text color as RGB color integer (e.g. 0xFF0000 = red) or HTML color name.    ;                                Default: Empty -> default text color    ; Return Value:   True on success, otherwise false.    ; ===================================================================================================================    AlternateRows(BkColor := """", TxColor := """") {       If !(This.HWND)          Return False       This.AltRows := False       If (BkColor = """") && (TxColor = """")          Return True       BkBGR := This.BGR(BkColor)       TxBGR := This.BGR(TxColor)       If (BkBGR = """") && (TxBGR = """")          Return False       This[""ARB""] := (BkBGR <> """") ? BkBGR : This.BkClr       This[""ART""] := (TxBGR <> """") ? TxBGR : This.TxClr       This.AltRows := True       Return True    }    ; ===================================================================================================================    ; AlternateCols() Sets background and/or text color for even column numbers.    ; Parameters:     BkColor     -  Background color as RGB color integer (e.g. 0xFF0000 = red) or HTML color name.    ;                                Default: Empty -> default background color    ;                 TxColor     -  Text color as RGB color integer (e.g. 0xFF0000 = red) or HTML color name.    ;                                Default: Empty -> default text color    ; Return Value:   True on success, otherwise false.    ; ===================================================================================================================    AlternateCols(BkColor := """", TxColor := """") {       If !(This.HWND)          Return False       This.AltCols := False       If (BkColor = """") && (TxColor = """")          Return True       BkBGR := This.BGR(BkColor)       TxBGR := This.BGR(TxColor)       If (BkBGR = """") && (TxBGR = """")          Return False       This[""ACB""] := (BkBGR <> """") ? BkBGR : This.BkClr       This[""ACT""] := (TxBGR <> """") ? TxBGR : This.TxClr       This.AltCols := True       Return True    }    ; ===================================================================================================================    ; SelectionColors() Sets background and/or text color for selected rows.    ; Parameters:     BkColor     -  Background color as RGB color integer (e.g. 0xFF0000 = red) or HTML color name.    ;                                Default: Empty -> default selected background color    ;                 TxColor     -  Text color as RGB color integer (e.g. 0xFF0000 = red) or HTML color name.    ;                                Default: Empty -> default selected text color    ; Return Value:   True on success, otherwise false.    ; ===================================================================================================================    SelectionColors(BkColor := """", TxColor := """") {       If !(This.HWND)          Return False       This.SelColors := False       If (BkColor = """") && (TxColor = """")          Return True       BkBGR := This.BGR(BkColor)       TxBGR := This.BGR(TxColor)       If (BkBGR = """") && (TxBGR = """")          Return False       This[""SELB""] := BkBGR       This[""SELT""] := TxBGR       This.SelColors := True       Return True    }    ; ===================================================================================================================    ; Row()           Sets background and/or text color for the specified row.    ; Parameters:     Row         -  Row number    ;                 Optional ------------------------------------------------------------------------------------------    ;                 BkColor     -  Background color as RGB color integer (e.g. 0xFF0000 = red) or HTML color name.    ;                                Default: Empty -> default background color    ;                 TxColor     -  Text color as RGB color integer (e.g. 0xFF0000 = red) or HTML color name.    ;                                Default: Empty -> default text color    ; Return Value:   True on success, otherwise false.    ; ===================================================================================================================    Row(Row, BkColor := """", TxColor := """") {       If !(This.HWND)          Return False       If This.IsStatic          Row := This.MapIndexToID(Row)       This[""Rows""].Remove(Row, """")       If (BkColor = """") && (TxColor = """")          Return True       BkBGR := This.BGR(BkColor)       TxBGR := This.BGR(TxColor)       If (BkBGR = """") && (TxBGR = """")          Return False       This[""Rows"", Row, ""B""] := (BkBGR <> """") ? BkBGR : This.BkClr       This[""Rows"", Row, ""T""] := (TxBGR <> """") ? TxBGR : This.TxClr       Return True    }    ; ===================================================================================================================    ; Cell()          Sets background and/or text color for the specified cell.    ; Parameters:     Row         -  Row number    ;                 Col         -  Column number    ;                 Optional ------------------------------------------------------------------------------------------    ;                 BkColor     -  Background color as RGB color integer (e.g. 0xFF0000 = red) or HTML color name.    ;                                Default: Empty -> row's background color    ;                 TxColor     -  Text color as RGB color integer (e.g. 0xFF0000 = red) or HTML color name.    ;                                Default: Empty -> row's text color    ; Return Value:   True on success, otherwise false.    ; ===================================================================================================================    Cell(Row, Col, BkColor := """", TxColor := """") {       If !(This.HWND)          Return False       If This.IsStatic          Row := This.MapIndexToID(Row)       This[""Cells"", Row].Remove(Col, """")       If (BkColor = """") && (TxColor = """")          Return True       BkBGR := This.BGR(BkColor)       TxBGR := This.BGR(TxColor)       If (BkBGR = """") && (TxBGR = """")          Return False       If (BkBGR <> """")          This[""Cells"", Row, Col, ""B""] := BkBGR       If (TxBGR <> """")          This[""Cells"", Row, Col, ""T""] := TxBGR       Return True    }    ; ===================================================================================================================    ; NoSort()        Prevents/allows sorting by click on a header item for this ListView.    ; Parameters:     Apply       -  True/False    ;                                Default: True    ; Return Value:   True on success, otherwise false.    ; ===================================================================================================================    NoSort(Apply := True) {       If !(This.HWND)          Return False       If (Apply)          This.SortColumns := False       Else          This.SortColumns := True       Return True    }    ; ===================================================================================================================    ; NoSizing()      Prevents/allows resizing of columns for this ListView.    ; Parameters:     Apply       -  True/False    ;                                Default: True    ; Return Value:   True on success, otherwise false.    ; ===================================================================================================================    NoSizing(Apply := True) {       Static OSVersion := DllCall(""GetVersion"", ""UChar"")       If !(This.Header)          Return False       If (Apply) {          If (OSVersion > 5)             Control, Style, +0x0800, , % ""ahk_id "" . This.Header ; HDS_NOSIZING = 0x0800          This.ResizeColumns := False       }       Else {          If (OSVersion > 5)             Control, Style, -0x0800, , % ""ahk_id "" . This.Header ; HDS_NOSIZING          This.ResizeColumns := True       }       Return True    }    ; ===================================================================================================================    ; OnMessage()     Adds/removes a message handler for WM_NOTIFY messages for this ListView.    ; Parameters:     Apply       -  True/False    ;                                Default: True    ; Return Value:   Always True    ; ===================================================================================================================    OnMessage(Apply := True) {       If (Apply) && !This.HasKey(""OnMessageFunc"") {          This.OnMessageFunc := ObjBindMethod(This, ""On_WM_Notify"")          OnMessage(0x004E, This.OnMessageFunc) ; add the WM_NOTIFY message handler       }       Else If !(Apply) && This.HasKey(""OnMessageFunc"") {          OnMessage(0x004E, This.OnMessageFunc, 0) ; remove the WM_NOTIFY message handler          This.OnMessageFunc := """"          This.Remove(""OnMessageFunc"")       }       WinSet, Redraw, , % ""ahk_id "" . This.HWND       Return True    }    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; PRIVATE PROPERTIES  +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    Static Attached := {}    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; PRIVATE METHODS +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    ; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    On_WM_NOTIFY(W, L, M, H) {       ; Notifications: NM_CUSTOMDRAW = -12, LVN_COLUMNCLICK = -108, HDN_BEGINTRACKA = -306, HDN_BEGINTRACKW = -326       Critical, % This.Critical       If ((HCTL := NumGet(L + 0, 0, ""UPtr"")) = This.HWND) || (HCTL = This.Header) {          Code := NumGet(L + (A_PtrSize * 2), 0, ""Int"")          If (Code = -12)             Return This.NM_CUSTOMDRAW(This.HWND, L)          If !This.SortColumns && (Code = -108)             Return 0          If !This.ResizeColumns && ((Code = -306) || (Code = -326))             Return True       }    }    ; -------------------------------------------------------------------------------------------------------------------    NM_CUSTOMDRAW(H, L) {       ; Return values: 0x00 (CDRF_DODEFAULT), 0x20 (CDRF_NOTIFYITEMDRAW / CDRF_NOTIFYSUBITEMDRAW)       Static SizeNMHDR := A_PtrSize * 3                  ; Size of NMHDR structure       Static SizeNCD := SizeNMHDR + 16 + (A_PtrSize * 5) ; Size of NMCUSTOMDRAW structure       Static OffItem := SizeNMHDR + 16 + (A_PtrSize * 2) ; Offset of dwItemSpec (NMCUSTOMDRAW)       Static OffItemState := OffItem + A_PtrSize         ; Offset of uItemState  (NMCUSTOMDRAW)       Static OffCT :=  SizeNCD                           ; Offset of clrText (NMLVCUSTOMDRAW)       Static OffCB := OffCT + 4                          ; Offset of clrTextBk (NMLVCUSTOMDRAW)       Static OffSubItem := OffCB + 4                     ; Offset of iSubItem (NMLVCUSTOMDRAW)       ; ----------------------------------------------------------------------------------------------------------------       DrawStage := NumGet(L + SizeNMHDR, 0, ""UInt"")       , Row := NumGet(L + OffItem, ""UPtr"") + 1       , Col := NumGet(L + OffSubItem, ""Int"") + 1       , Item := Row - 1       If This.IsStatic          Row := This.MapIndexToID(Row)       ; CDDS_SUBITEMPREPAINT = 0x030001 --------------------------------------------------------------------------------       If (DrawStage = 0x030001) {          UseAltCol := !(Col & 1) && (This.AltCols)          , ColColors := This[""Cells"", Row, Col]          , ColB := (ColColors.B <> """") ? ColColors.B : UseAltCol ? This.ACB : This.RowB          , ColT := (ColColors.T <> """") ? ColColors.T : UseAltCol ? This.ACT : This.RowT          , NumPut(ColT, L + OffCT, ""UInt""), NumPut(ColB, L + OffCB, ""UInt"")          Return (!This.AltCols && !This.HasKey(Row) && (Col > This[""Cells"", Row].MaxIndex())) ? 0x00 : 0x20       }       ; CDDS_ITEMPREPAINT = 0x010001 -----------------------------------------------------------------------------------       If (DrawStage = 0x010001) {          ; LVM_GETITEMSTATE = 0x102C, LVIS_SELECTED = 0x0002          If (This.SelColors) && DllCall(""SendMessage"", ""Ptr"", H, ""UInt"", 0x102C, ""Ptr"", Item, ""Ptr"", 0x0002, ""UInt"") {             ; Remove the CDIS_SELECTED (0x0001) and CDIS_FOCUS (0x0010) states from uItemState and set the colors.             NumPut(NumGet(L + OffItemState, ""UInt"") & ~0x0011, L + OffItemState, ""UInt"")             If (This.SELB <> """")                NumPut(This.SELB, L + OffCB, ""UInt"")             If (This.SELT <> """")                NumPut(This.SELT, L + OffCT, ""UInt"")             Return 0x02 ; CDRF_NEWFONT          }          UseAltRow := (Item & 1) && (This.AltRows)          , RowColors := This[""Rows"", Row]          , This.RowB := RowColors ? RowColors.B : UseAltRow ? This.ARB : This.BkClr          , This.RowT := RowColors ? RowColors.T : UseAltRow ? This.ART : This.TxClr          If (This.AltCols || This[""Cells""].HasKey(Row))             Return 0x20          NumPut(This.RowT, L + OffCT, ""UInt""), NumPut(This.RowB, L + OffCB, ""UInt"")          Return 0x00       }       ; CDDS_PREPAINT = 0x000001 ---------------------------------------------------------------------------------------       Return (DrawStage = 0x000001) ? 0x20 : 0x00    }    ; -------------------------------------------------------------------------------------------------------------------    MapIndexToID(Row) { ; provides the unique internal ID of the given row number       SendMessage, 0x10B4, % (Row - 1), 0, , % ""ahk_id "" . This.HWND ; LVM_MAPINDEXTOID       Return ErrorLevel    }    ; -------------------------------------------------------------------------------------------------------------------    BGR(Color, Default := """") { ; converts colors to BGR       Static Integer := ""Integer"" ; v2       ; HTML Colors (BGR)       Static HTML := {AQUA: 0xFFFF00, BLACK: 0x000000, BLUE: 0xFF0000, FUCHSIA: 0xFF00FF, GRAY: 0x808080, GREEN: 0x008000                     , LIME: 0x00FF00, MAROON: 0x000080, NAVY: 0x800000, OLIVE: 0x008080, PURPLE: 0x800080, RED: 0x0000FF                     , SILVER: 0xC0C0C0, TEAL: 0x808000, WHITE: 0xFFFFFF, YELLOW: 0x00FFFF}       If Color Is Integer          Return ((Color >> 16) & 0xFF) | (Color & 0x00FF00) | ((Color & 0xFF) << 16)       Return (HTML.HasKey(Color) ? HTML[Color] : Default)    } } How to use: First create a new instance of LV_Colors with MyInstance := New LV_Colors(HLV) passing the HWND of your ListView. Then call MyInstance.Cell() or MyInstance.Row() to setup colours for individual cells and/or rows. That's all you have to do for colouring. If you finally don't want the colours to be shown any more, use MyInstance := """" to restore the ListView's default behaviour. For more detailed informations look at the inline documentation, please. Credits:: dadepp for LVA View sources on GitHub: https://github.com/AHK-just-me/Class_LV_Colors/   Download sources from GitHub: https://github.com/AHK-just-me/Class_LV_Colors/archive/master.zip Previous releases on GitHub: https://github.com/AHK-just-me/Class_LV_Colors/releases Last edited by just me on 03 May 2016, 09:57, edited 12 times in total. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: [Class] LV_Colors - individual colors for ListView items Report this post Quote 21 Feb 2014, 00:18 great! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top tmplinshi Posts: 836 Joined: 01 Oct 2013, 14:57 Re: [Class] LV_Colors - individual colors for ListView items Report this post Quote 21 Feb 2014, 07:11 The ""static mode"" is really useful, thanks a lot! Top tmplinshi Posts: 836 Joined: 01 Oct 2013, 14:57 Re: [Class] LV_Colors - individual colors for ListView items Report this post Quote 13 Aug 2014, 03:26 Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #NoEnv #Include Class_LV_Colors.ahk SetBatchLines, -1   Gui, Add, ListView, w600 r5 Grid -ReadOnly hwndHLV, Col1 Gui, Show   LV_Colors.Attach(HLV, 1) ; static mode LV_Colors.OnMessage()   LV_Insert(1, """", ""111111111111"") LV_Colors.Row(HLV, 1, 0xFFFFB5)   Sleep, 2000   LV_Insert(1, """", ""22222222222"") LV_Colors.Row(HLV, 1, 0x80FF00) Return   GuiClose: ExitApp   Is this a bug? row 1 and row 2 changes to same color (0x80FF00). Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] LV_Colors - individual colors for ListView items Report this post Quote 13 Aug 2014, 07:32 I won't consider this to be a bug. As the name implies, static mode is intended to be used with static ListViews. But I've already considered to change the internal handling of the 'static mode'. Since you're apparently using this mode, would you please test this version? Edit: Removed test code, it's available on GitHub now. Last edited by just me on 13 Aug 2014, 10:58, edited 1 time in total. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top tmplinshi Posts: 836 Joined: 01 Oct 2013, 14:57 Re: [Class] LV_Colors - individual colors for ListView items Report this post Quote 13 Aug 2014, 10:20 Thank you! This is the way I wanted. Tested and worked! Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] LV_Colors - individual colors for ListView items Report this post Quote 13 Aug 2014, 10:59 Thank you for testing. I've updated the script on GitHub. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top oldbrother Posts: 93 Joined: 23 Oct 2013, 05:08 Re: [Class] LV_Colors - individual colors for ListView items Report this post Quote 15 Aug 2014, 17:45 Hi Just me, I have an old script using both your classes Class_LV_Colors and Class_LV_InCellEdit. About 2 years ago, your wrote the Message Handler function MyMessageHandler() for me (please see the code below. Many thanks ). It worked perfectly. Recently, I updated Class_LV_InCellEdit to the latest version, everything was fine. Yesterday, I was trying to update Class_LV_Colors to the new version, but it failed. After I replaced the old Class_LV_Colors.php with the new one, the script cannot work properly. The Listview even my computer is frozen everytime when I run the script. I'm wondering if you can help me again? Thanks a lot!!! Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus MyMessageHandler(W, L) { 	 Critical, 500    Static LVN_BEGINLABELEDITA := -105    Static LVN_BEGINLABELEDITW := -175    Static LVN_COLUMNCLICK := -108    Static LVN_ENDLABELEDITA := -106    Static LVN_ENDLABELEDITW := -176    Static NM_CLICK := -2    Static NM_CUSTOMDRAW := -12    Static NM_DBLCLICK := -3    H := NumGet(L + 0, 0, ""UPtr"")    M := NumGet(L + (A_PtrSize * 2), 0, ""Int"")    ; Critical    If LV_Colors.HasKey(H) {       ; NM_CUSTOMDRAW --------------------------------------------------------------------------------------------------       If (M = NM_CUSTOMDRAW)          Return LV_Colors.On_NM_CUSTOMDRAW(H, L)       ; LVN_COLUMNCLICK ------------------------------------------------------------------------------------------------       If (LV_Colors[H].NS && (M = LVN_COLUMNCLICK))          Return 0    }    If (LV_InCellEdit.Attached.HasKey(H)) {       ; BeginLabelEdit -------------------------------------------------------------------------------------------------       If (M = LVN_BEGINLABELEDITW) || (M = LVN_BEGINLABELEDITA) {          Return LV_InCellEdit.On_LVN_BEGINLABELEDIT(H, L)       }       ; EndLabelEdit ---------------------------------------------------------------------------------------------------       If (M = LVN_ENDLABELEDITW) || (M = LVN_ENDLABELEDITA) {          Return LV_InCellEdit.On_LVN_ENDLABELEDIT(H, L)       }       ; Double click ---------------------------------------------------------------------------------------------------       If (M = NM_DBLCLICK) {          LV_InCellEdit.On_NM_DBLCLICK(H, L)       }    } }     Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] LV_Colors - individual colors for ListView items Report this post Quote 16 Aug 2014, 00:20 Hi oldbrother, ATM I've no idea. Did you update LV_Colors from v0.4 to v0.5? Hopefully, the only changes in v0.5 are related to the 'static mode'. Do you use it? In most of my tests with ListViews and WM_NOTIFY message handlers I get into troubles with frozen ListViews or whole GUIs. Since I use Critical, 500 in the message handlers like you do, it's more rare, but it still happens. I couldn't recognise any consistent reason as yet. All I know is that the script is consuming a whole processor here. It seems to loop very fast in the background. But my computer is still working in either case, though a bit delayed. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top oldbrother Posts: 93 Joined: 23 Oct 2013, 05:08 Re: [Class] LV_Colors - individual colors for ListView items Report this post Quote 16 Aug 2014, 07:41 Hi Just Me, Both V0.4 and V0.5 are not working for me. I'm still using V3.0. Luckily I kept all the versions . Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] LV_Colors - individual colors for ListView items Report this post Quote 17 Aug 2014, 01:32 Hi oldbrother, I've checked the changes from 0.3 to 0.4 again und found nothing not related to the new 'static mode'. It was realised by implementing a new additional second parameter for LV_Colors.Attach(). I've never used the combination of LV_InCellEdit and LV_Colors, so I have to ask you: Which OS version are you running? Did you adjust the LV_Colors.Attach() call? Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top oldbrother Posts: 93 Joined: 23 Oct 2013, 05:08 Re: [Class] LV_Colors - individual colors for ListView items Report this post Quote 17 Aug 2014, 08:02 I just adjusted LV_Colors.Attach() to LV_Colors.Attach(MyLV,1,0,0). The script works now. I didn't read your update notice carefully. How stupid I am! The only thing now is I feel the program is a little bit sluggish. My OS is XP SP3, and my laptop is 4 year old. Probably I need a new computer. Thanks a lot!!! Top list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Re: [Class] LV_Colors - individual colors for ListView items Report this post Quote 16 Mar 2015, 15:34 Edit: fixed it I think with the GuiControl, +Redraw... Hi just me, I'm thinking about adding color to my listview and in principle it works, but when I scroll through my listview the color is gone - perhaps I'm doing something wrong? I use a trick to scroll using up & down arrow keys while remaining in an edit control - I've prepared a short example to illustrate the problem. I've tested this on Windows 7 (32bit, unicode) and Windows 8 (64bit). Is there a solution? Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus Gui, Add, Edit, w100 Gui, Add, Listview, hwndHLV vVLV h200 w200,A|B|C Loop, 30 	LV_Add("""",A_Index,A_Index,A_Index) Gui, Show LV_Colors.OnMessage() LV_Colors.Attach(HLV, 1, 0, 0) Loop, 30 	LV_Colors.Row(HLV, A_Index, 0xFFECB0, 0x000000) Return	   ~Down:: GuiControl, -Redraw, VLV ; added this line ControlSend, SysListview321, {Down}, A GuiControl, +Redraw, VLV ; added this line Return   #include include\Class_LV_Colors.ahk   Esc::ExitApp   Lintalist: website - source (github) Top list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Re: [Class] LV_Colors - individual colors for ListView items Report this post Quote 17 Mar 2015, 12:32 The GuiControl, +Redraw does seem to have done the trick, tested on both systems again and the colours remain. Lintalist: website - source (github) Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] LV_Colors - new version on 2015-03-24 Report this post Quote 24 Mar 2015, 07:15 *new version* Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top empardopo Posts: 326 Joined: 06 Oct 2013, 12:50 Location: Spain Contact: Contact empardopo Website Re: [Class] LV_Colors - new version on 2015-03-24 Report this post Quote 25 Mar 2015, 03:42 just me wrote:*new version* Is it necesary update to the last version of AKH. Now, I am using the 1.1.19.03 version and I get this error Greetings. Attachments Everything is possible! Top list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Re: [Class] LV_Colors - new version on 2015-03-24 Report this post Quote 25 Mar 2015, 15:39 @empardopo - Yes. In the first post it says about the latest update ""New version using the new features of AHK 1.1.12+:"" but I think that is a typo, as in the source code of Class_LV_Colors.ahk it says ""new version using new AHK 1.1.20+ features"" Using 1.1.20.03 I can confirm it works, but you have to modify your code as indicated in the readme here https://github.com/AHK-just-me/Class_LV_Colors and study the new example script as well. Lintalist: website - source (github) Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] LV_Colors - new version on 2015-03-24 Report this post Quote 25 Mar 2015, 16:00 list is right, it was a typo and should be 1.1.20+. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top TLM Posts: 703 Joined: 01 Oct 2013, 07:52 Re: [Class] LV_Colors - new version on 2015-03-24 Report this post Quote 25 Mar 2015, 16:10 Thanks for this Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [Class] LV_Colors - update on 2015-03-27 Report this post Quote 27 Mar 2015, 04:25 *update* Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 86 posts 1 2 3 4 5 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: pondermatic and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by just Me - Individual background and/or text colours for a GUI ListView's cells or rows. Forum thread:"	"true"
"ListView"	"LV_EX"	"https://github.com/AHK-just-me/LV_EX"	"by just me - Some additional functions for AHK GUI ListView controls. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"2"	"1"	"2"	"GitHub - AHK-just-me/LV_EX: Some additional functions for AHK GUI ListView controls. Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 1 Star 2 Fork 2 AHK-just-me/LV_EX Code Issues 0 Pull requests 0 Pulse Graphs Some additional functions for AHK GUI ListView controls. 8 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Fetching latest commit… Cannot retrieve the latest commit at this time. Permalink Failed to load latest commit information. Docs Sources .gitignore LICENSE README.md README.md LV_EX Some additional functions for AHK GUI ListView controls. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/AHK-just-me/LV_EX"	"by just me - Some additional functions for AHK GUI ListView controls. Forum thread:"	"true"
"ListView"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=1256"	"by just me - Some additional functions for AHK GUI ListView controls. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[LIB] LV_EX - update on 2016-04-28 - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:27 All times are UTC-05:00 [LIB] LV_EX - update on 2016-04-28 Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 23 posts 1 2 Next just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany [LIB] LV_EX - update on 2016-04-28 Report this post Quote 03 Jan 2014, 05:15 Additional functions for GUI ListView controls. Primarily [CLASS] version released on the old forum -> board/topic/80686-class-guilistviewex-added-functions-for-gui-listviews/. Well, this is a !!! LIB !!! version of my originally released CLASS_GuiListViewEx. I added some more functions, most of them are intended to be used primarily in Report view. ChangeLog 1.1.01.00 - 2016-04-28: Added LV_EX_GroupGetState() contributed by Pulover. Took the chance and added LV_EX_GroupGetHeader() as suggested by kczx3 1.1.00.00 - 2015-03-13: Added basic tile view support (suggested by toralf). Added basic (mainly XP compatible) group view support. Revised code and made some minor changes. I only did some quick testing, so you might find some issues or bugs. If so, report them here, please. Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ; ====================================================================================================================== ; Namespace:      LV_EX ; Function:       Some additional functions to use with AHK ListView controls. ; Tested with:    AHK 1.1.20.03 (A32/U32/U64) ; Tested on:      Win 8.1 (x64) ; Changelog: ;     1.1.01.00/2016-04-28(just me     -  added LV_EX_GroupGetState contributed by Pulover. ;     1.1.00.00/2015-03-13/just me     -  added basic tile view support (suggested by toralf), ;                                         added basic (XP compatible) group view support, ;                                         revised code and made some minor changes. ;     1.0.00.00/2013-12-30/just me     -  initial release. ; Notes: ;     In terms of Microsoft ;        Item     stands for the whole row or the first column of the row ;        SubItem  stands for the second to last column of a row ;     All functions require the handle of the ListView (HWND). You get this handle using the 'Hwnd' option when ;     creating the control per 'Gui, Add, HwndHwndOfLV ...' or using 'GuiControlGet, HwndOfLV, Hwnd, MyListViewVar' ;     after control creation. ; Credits: ;     LV_EX tile view functions: ;        Initial idea by segalion (old forum: /board/topic/80754-listview-with-multiline-in-report-mode-help/) ;        based on code from Fabio Lucarelli (http://users.skynet.be/oleole/ListView_Tiles.htm). ; ====================================================================================================================== ; This software is provided 'as-is', without any express or implied warranty. ; In no event will the authors be held liable for any damages arising from the use of this software. ; ====================================================================================================================== ; ====================================================================================================================== ; LV_EX_CalcViewSize - Calculates the approximate width and height required to display a given number of items. ; ====================================================================================================================== LV_EX_CalcViewSize(HLV, Rows := 0) {    ; LVM_APPROXIMATEVIEWRECT = 0x1040 -> http://msdn.microsoft.com/en-us/library/bb774883(v=vs.85).aspx    SendMessage, 0x1040, % (Rows - 1), 0, , % ""ahk_id "" . HLV    Return {W: (ErrorLevel & 0xFFFF), H: (ErrorLevel >> 16) & 0xFFFF} } ; ====================================================================================================================== ; LV_EX_EnableGroupView - Enables or disables whether the items in a list-view control display as a group. ; ====================================================================================================================== LV_EX_EnableGroupView(HLV, Enable := True) {    ; LVM_ENABLEGROUPVIEW = 0x109D -> msdn.microsoft.com/en-us/library/bb774900(v=vs.85).aspx    SendMessage, 0x109D, % (!!Enable), 0, , % ""ahk_id "" . HLV    Return (ErrorLevel >> 31) ? 0 : 1 } ; ====================================================================================================================== ; LV_EX_FindString - Searches the first column for an item containing the specified string. ; ====================================================================================================================== LV_EX_FindString(HLV, Str, Start := 0, Partial := False) {    ; LVM_FINDITEM -> http://msdn.microsoft.com/en-us/library/bb774903(v=vs.85).aspx    Static LVM_FINDITEM := A_IsUnicode ? 0x1053 : 0x100D ; LVM_FINDITEMW : LVM_FINDITEMA    Static LVFISize := 40    VarSetCapacity(LVFI, LVFISize, 0) ; LVFINDINFO    Flags := 0x0002 ; LVFI_STRING    If (Partial)       Flags |= 0x0008 ; LVFI_PARTIAL    NumPut(Flags, LVFI, 0, ""UInt"")    NumPut(&Str,  LVFI, A_PtrSize, ""Ptr"")    SendMessage, % LVM_FINDITEM, % (Start - 1), % &LVFI, , % ""ahk_id "" . HLV    Return (ErrorLevel > 0x7FFFFFFF ? 0 : ErrorLevel + 1) } ; ====================================================================================================================== ; LV_EX_FindStringEx - Searches all columns or the specified column for a subitem containing the specified string. ; ====================================================================================================================== LV_EX_FindStringEx(HLV, Str, Column := 0, Start := 0, Partial := False) {    Len := StrLen(Str)    Row := Col := 0    ControlGet, ItemList, List, , , % ""ahk_id "" . HLV    Loop, Parse, ItemList, `n    {       If (A_Index > Start) {          Row := A_Index          Columns := StrSplit(A_LoopField, ""`t"")          If (Column + 0) > 0 {             If (Partial) {                If (SubStr(Columns[Column], 1, Len) = Str)                   Col := Column             }             Else {                If (Columns[Column] = Str)                   Col := Column             }          }          Else {             For Index, ColumnText In Columns {                If (Partial) {                   If (SubStr(ColumnText, 1, Len) = Str)                      Col := Index                }                Else {                   If (ColumnText = Str)                      Col := Index                }             } Until (Col > 0)          }       }    } Until (Col > 0)    Return (Col > 0) ? {Row: Row, Col: Column} : 0 } ; ====================================================================================================================== ; LV_EX_GetColumnOrder - Gets the current left-to-right order of columns in a list-view control. ; ====================================================================================================================== LV_EX_GetColumnOrder(HLV) {    ; LVM_GETCOLUMNORDERARRAY = 0x103B -> http://msdn.microsoft.com/en-us/library/bb774913(v=vs.85).aspx    SendMessage, 0x1200, 0, 0, , % ""ahk_id "" . LV_EX_GetHeader(HLV) ; HDM_GETITEMCOUNT    If (ErrorLevel > 0x7FFFFFFF)       Return False    Cols := ErrorLevel    VarSetCapacity(COA, Cols * 4, 0)    SendMessage, 0x103B, % Cols, % &COA, , % ""ahk_id "" . HLV    If (ErrorLevel = 0) || !(ErrorLevel + 0)       Return False    ColArray := []    Loop, %Cols%       ColArray[A_Index] := NumGet(COA, 4 * (A_Index - 1), ""Int"") + 1    Return ColArray } ; ====================================================================================================================== ; LV_EX_GetColumnWidth - Gets the width of a column in report or list view. ; ====================================================================================================================== LV_EX_GetColumnWidth(HLV, Column) {    ; LVM_GETCOLUMNWIDTH = 0x101D -> http://msdn.microsoft.com/en-us/library/bb774915(v=vs.85).aspx    SendMessage, 0x101D, % (Column - 1), 0, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_GetExtendedStyle - Gets the extended styles that are currently in use for a given list-view control. ; ====================================================================================================================== LV_EX_GetExtendedStyle(HLV) {    ; LVM_GETEXTENDEDLISTVIEWSTYLE = 0x1037 -> http://msdn.microsoft.com/en-us/library/bb774923(v=vs.85).aspx    SendMessage, 0x1037, 0, 0, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_GetGroup - Gets the ID of the group the list-view item belongs to. ; ====================================================================================================================== LV_EX_GetGroup(HLV, Row) {    ; LVM_GETITEMA = 0x1005 -> http://msdn.microsoft.com/en-us/library/bb774953(v=vs.85).aspx    Static OffGroupID := 28 + (A_PtrSize * 3)    LV_EX_LVITEM(LVITEM, 0x00000100, Row) ; LVIF_GROUPID    SendMessage, 0x1005, 0, % &LVITEM, , % ""ahk_id "" . HLV    Return NumGet(LVITEM, OffGroupID, ""UPtr"") } ; ====================================================================================================================== ; LV_EX_GetHeader - Retrieves the handle of the header control used by the list-view control. ; ====================================================================================================================== LV_EX_GetHeader(HLV) {    ; LVM_GETHEADER = 0x101F -> http://msdn.microsoft.com/en-us/library/bb774937(v=vs.85).aspx    SendMessage, 0x101F, 0, 0, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_GetIconSpacing - Determines the spacing between icons in the icon view. ; ====================================================================================================================== LV_EX_GetIconSpacing(HLV, ByRef CX, BYREF CY) {    ; LVM_GETITEMSPACING = 0x1033 -> http://msdn.microsoft.com/en-us/library/bb761051(v=vs.85).aspx    CX := CY := 0    SendMessage, 0x1033, 0, 0, , % ""ahk_id "" . HLV    CX := ErrorLevel & 0xFFFF, CY := ErrorLevel >> 16    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_GetItemParam - Retrieves the value of the item's lParam field. ; ====================================================================================================================== LV_EX_GetItemParam(HLV, Row) {    ; LVM_GETITEM -> http://msdn.microsoft.com/en-us/library/bb774953(v=vs.85).aspx    Static LVM_GETITEM := A_IsUnicode ? 0x104B : 0x1005 ; LVM_GETITEMW : LVM_GETITEMA    Static OffParam := 24 + (A_PtrSize * 2)    LV_EX_LVITEM(LVITEM, 0x00000004, Row) ; LVIF_PARAM    SendMessage, % LVM_GETITEM, 0, % &LVITEM, , % ""ahk_id "" . HLV    Return NumGet(LVITEM, OffParam, ""UPtr"") } ; ====================================================================================================================== ; LV_EX_GetItemRect - Retrieves the bounding rectangle for all or part of an item in the current view. ; ====================================================================================================================== LV_EX_GetItemRect(HLV, Row := 1, LVIR := 0, Byref RECT := """") {    ; LVM_GETITEMRECT = 0x100E -> http://msdn.microsoft.com/en-us/library/bb761049(v=vs.85).aspx    VarSetCapacity(RECT, 16, 0)    NumPut(LVIR, RECT, 0, ""Int"")    SendMessage, 0x100E, % (Row - 1), % &RECT, , % ""ahk_id "" . HLV    If (ErrorLevel = 0)       Return False    Result := {}    Result.X := NumGet(RECT,  0, ""Int"")    Result.Y := NumGet(RECT,  4, ""Int"")    Result.R := NumGet(RECT,  8, ""Int"")    Result.B := NumGet(RECT, 12, ""Int"")    Result.W := Result.R - Result.X    Result.H := Result.B - Result.Y    Return Result } ; ====================================================================================================================== ; LV_EX_GetItemState - Retrieves the state of a list-view item. ; ====================================================================================================================== LV_EX_GetItemState(HLV, Row) {    ; LVM_GETITEMSTATE = 0x102C -> http://msdn.microsoft.com/en-us/library/bb761053(v=vs.85).aspx    Static LVIS := {Cut: 0x04, DropHilited: 0x08, Focused: 0x01, Selected: 0x02, Checked: 0x2000}    SendMessage, 0x102C, % (Row - 1), 0xFFFF, , % ""ahk_id "" . HLV ; all states    States := ErrorLevel    Result := {}    For Key, Value In LVIS       Result[Key] := States & Value    Return Result } ; ====================================================================================================================== ; LV_EX_GetRowHeight - Gets the height of the specified row. ; ====================================================================================================================== LV_EX_GetRowHeight(HLV, Row := 1) {    Return LV_EX_GetItemRect(HLV, Row).H } ; ====================================================================================================================== ; LV_EX_GetRowsPerPage - Calculates the number of items that can fit vertically in the visible area of a list-view ;                        control when in list or report view. Only fully visible items are counted. ; ====================================================================================================================== LV_EX_GetRowsPerPage(HLV) {    ; LVM_GETCOUNTPERPAGE = 0x1028 -> http://msdn.microsoft.com/en-us/library/bb774917(v=vs.85).aspx    SendMessage, 0x1028, 0, 0, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_GetSubItemRect - Retrieves information about the bounding rectangle for a subitem in a list-view control. ; ====================================================================================================================== LV_EX_GetSubItemRect(HLV, Column, Row := 1, LVIR := 0, ByRef RECT := """") {    ; LVM_GETSUBITEMRECT = 0x1038 -> http://msdn.microsoft.com/en-us/library/bb761075(v=vs.85).aspx    VarSetCapacity(RECT, 16, 0)    NumPut(LVIR, RECT, 0, ""Int"")    NumPut(Column - 1, RECT, 4, ""Int"")    SendMessage, 0x1038, % (Row - 1), % &RECT, , % ""ahk_id "" . HLV    If (ErrorLevel = 0)       Return False    If (Column = 1) && ((LVIR = 0) || (LVIR = 3))       NumPut(NumGet(RECT, 0, ""Int"") + LV_EX_GetColumnWidth(HLV, 1), RECT, 8, ""Int"")    Result := {}    Result.X := NumGet(RECT,  0, ""Int""), Result.Y := NumGet(RECT,  4, ""Int"")    Result.R := NumGet(RECT,  8, ""Int""), Result.B := NumGet(RECT, 12, ""Int"")    Result.W := Result.R - Result.X,     Result.H := Result.B - Result.Y    Return Result } ; ====================================================================================================================== ; LV_EX_GetSubItemText - Retrieves the text of the specified item and subitem. ; ====================================================================================================================== LV_EX_GetSubItemText(HLV, Row, Column := 1, MaxChars := 257) {    ; LVM_GETITEMTEXT -> http://msdn.microsoft.com/en-us/library/bb761055(v=vs.85).aspx    Static LVM_GETITEMTEXT := A_IsUnicode ? 0x1073 : 0x102D ; LVM_GETITEMTEXTW : LVM_GETITEMTEXTA    Static OffText := 16 + A_PtrSize    Static OffTextMax := OffText + A_PtrSize    VarSetCapacity(ItemText, MaxChars << !!A_IsUnicode, 0)    LV_EX_LVITEM(LVITEM, , Row, Column)    NumPut(&ItemText, LVITEM, OffText, ""Ptr"")    NumPut(MaxChars, LVITEM, OffTextMax, ""Int"")    SendMessage, % LVM_GETITEMTEXT, % (Row - 1), % &LVITEM, , % ""ahk_id "" . HLV    VarSetCapacity(ItemText, -1)    Return ItemText } ; ====================================================================================================================== ; LV_EX_GetTileViewLines - Retrieves the maximum number of additional text lines in each tile, not counting the title. ; ====================================================================================================================== LV_EX_GetTileViewLines(HLV) {    ; LVM_GETTILEVIEWINFO = 0x10A3 -> http://msdn.microsoft.com/en-us/library/bb774768(v=vs.85).aspx    Static SizeLVTVI := 40    Static OffLines := 20    VarSetCapacity(LVTVI, SizeLVTVI, 0)   ; LVTILEVIEWINFO    NumPut(SizeLVTVI, LVTVI, 0, ""UInt"")   ; cbSize    NumPut(0x00000002, LVTVI, 4, ""UInt"")  ; dwMask = LVTVIM_COLUMNS    SendMessage, 0x10A3, 0, % &LVTVI, , % ""ahk_id "" . HLV ; LVM_GETTILEVIEWINFO    Lines := NumGet(LVTVI, OffLines, ""Int"")    Return (Lines > 0 ? --Lines : 0) } ; ====================================================================================================================== ; LV_EX_GetTopIndex - Retrieves the index of the topmost visible item when in list or report view. ; ====================================================================================================================== LV_EX_GetTopIndex(HLV) {    ; LVM_GETTOPINDEX = 0x1027 -> http://msdn.microsoft.com/en-us/library/bb761087(v=vs.85).aspx    SendMessage, 0x1027, 0, 0, , % ""ahk_id "" . HLV    Return (ErrorLevel + 1) } ; ====================================================================================================================== ; LV_EX_GetView - Retrieves the current view of a list-view control. ; ====================================================================================================================== LV_EX_GetView(HLV) {    ; LVM_GETVIEW = 0x108F -> http://msdn.microsoft.com/en-us/library/bb761091(v=vs.85).aspx    Static Views := {0x00: ""Icon"", 0x01: ""Report"", 0x02: ""IconSmall"", 0x03: ""List"", 0x04: ""Tile""}    SendMessage, 0x108F, 0, 0, , % ""ahk_id "" . HLV    Return Views[ErrorLevel] } ; ====================================================================================================================== ; LV_EX_GroupGetState - Get group states (requires Win Vista+ for most states). ; ====================================================================================================================== LV_EX_GroupGetState(HLV, GroupID, ByRef Collapsed := """", ByRef Collapsible := """", ByRef Focused := """", ByRef Hidden := """"                   , ByRef NoHeader := """", ByRef Normal := """", ByRef Selected := """") {    ; LVM_GETGROUPINFO = 0x1095 -> msdn.microsoft.com/en-us/library/bb774932(v=vs.85).aspx    Static OS := DllCall(""GetVersion"", ""UChar"")    Static LVGS5 := {Collapsed: 0x01, Hidden: 0x02, Normal: 0x00}    Static LVGS6 := {Collapsed: 0x01, Collapsible: 0x08, Focused: 0x10, Hidden: 0x02, NoHeader: 0x04, Normal: 0x00, Selected: 0x20}    Static LVGF := 0x04 ; LVGF_STATE    Static SizeOfLVGROUP := (4 * 6) + (A_PtrSize * 4)    Static OffStateMask := 8 + (A_PtrSize * 3) + 8    Static OffState := OffStateMask + 4    SetStates := 0    LVGS := OS > 5 ? LVGS6 : LVGS5    For Each, State In LVGS       SetStates |= State    VarSetCapacity(LVGROUP, SizeOfLVGROUP, 0)    NumPut(SizeOfLVGROUP, LVGROUP, 0, ""UInt"")    NumPut(LVGF, LVGROUP, 4, ""UInt"")    NumPut(SetStates, LVGROUP, OffStateMask, ""UInt"")    SendMessage, 0x1095, %GroupID%, &LVGROUP, , % ""ahk_id "" . HLV    States := NumGet(&LVGROUP, OffState, ""UInt"")    For Each, State in LVGS       %Each% := States & State ? True : False    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_GroupInsert - Inserts a group into a list-view control. ; ====================================================================================================================== LV_EX_GroupInsert(HLV, GroupID, Header, Align := """", Index := -1) {    ; LVM_INSERTGROUP = 0x1091 -> msdn.microsoft.com/en-us/library/bb761103(v=vs.85).aspx    Static Alignment := {1: 1, 2: 2, 4: 4, C: 2, L: 1, R: 4}    Static SizeOfLVGROUP := (4 * 6) + (A_PtrSize * 4)    Static OffHeader := 8    Static OffGroupID := OffHeader + (A_PtrSize * 3) + 4    Static OffAlign := OffGroupID + 12    Static LVGF := 0x11 ; LVGF_GROUPID | LVGF_HEADER | LVGF_STATE    Static LVGF_ALIGN := 0x00000008    Align := (A := Alignment[SubStr(Align, 1, 1)]) ? A : 0    Mask := LVGF | (Align ? LVGF_ALIGN : 0)    PHeader := A_IsUnicode ? &Header : LV_EX_PWSTR(Header, WHeader)    VarSetCapacity(LVGROUP, SizeOfLVGROUP, 0)    NumPut(SizeOfLVGROUP, LVGROUP, 0, ""UInt"")    NumPut(Mask, LVGROUP, 4, ""UInt"")    NumPut(PHeader, LVGROUP, OffHeader, ""Ptr"")    NumPut(GroupID, LVGROUP, OffGroupID, ""Int"")    NumPut(Align, LVGROUP, OffAlign, ""UInt"")    SendMessage, 0x1091, %Index%, % &LVGROUP, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_GroupRemove - Removes a group from a list-view control. ; ====================================================================================================================== LV_EX_GroupRemove(HLV, GroupID) {    ; LVM_REMOVEGROUP = 0x1096 -> msdn.microsoft.com/en-us/library/bb761149(v=vs.85).aspx    SendMessage, 0x10A0, %GroupID%, 0, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_GroupRemoveAll - Removes all groups from a list-view control. ; ====================================================================================================================== LV_EX_GroupRemoveAll(HLV) {    ; LVM_REMOVEALLGROUPS = 0x10A0 -> msdn.microsoft.com/en-us/library/bb761147(v=vs.85).aspx    SendMessage, 0x10A0, 0, 0, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_GroupSetState - Set group state (requires Win Vista+ for most states). ; ====================================================================================================================== LV_EX_GroupSetState(HLV, GroupID, States*) {    ; LVM_SETGROUPINFO = 0x1093 -> msdn.microsoft.com/en-us/library/bb761167(v=vs.85).aspx    Static OS := DllCall(""GetVersion"", ""UChar"")    Static LVGS5 := {Collapsed: 0x01, Hidden: 0x02, Normal: 0x00, 0: 0, 1: 1, 2: 2}    Static LVGS6 := {Collapsed: 0x01, Collapsible: 0x08, Focused: 0x10, Hidden: 0x02, NoHeader: 0x04, Normal: 0x00                  , Selected: 0x20, 0: 0, 1: 1, 2: 2, 4: 4, 8: 8, 16: 16, 32: 32}    Static LVGF := 0x04 ; LVGF_STATE    Static SizeOfLVGROUP := (4 * 6) + (A_PtrSize * 4)    Static OffStateMask := 8 + (A_PtrSize * 3) + 8    Static OffState := OffStateMask + 4    SetStates := 0    LVGS := OS > 5 ? LVGS6 : LVGS5    For Each, State In States {       If !LVGS.HasKey(State)          Return False       SetStates |= LVGS[State]    }    VarSetCapacity(LVGROUP, SizeOfLVGROUP, 0)    NumPut(SizeOfLVGROUP, LVGROUP, 0, ""UInt"")    NumPut(LVGF, LVGROUP, 4, ""UInt"")    NumPut(SetStates, LVGROUP, OffStateMask, ""UInt"")    NumPut(SetStates, LVGROUP, OffState, ""UInt"")    SendMessage, 0x1093, %GroupID%, % &LVGROUP, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_HasGroup - Determines whether the list-view control has a specified group. ; ====================================================================================================================== LV_EX_HasGroup(HLV, GroupID) {    ; LVM_HASGROUP = 0x10A1 -> msdn.microsoft.com/en-us/library/bb761097(v=vs.85).aspx    SendMessage, 0x10A1, %GroupID%, 0, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_IsGroupViewEnabled - Checks whether the list-view control has group view enabled. ; ====================================================================================================================== LV_EX_IsGroupViewEnabled(HLV) {    ; LVM_ISGROUPVIEWENABLED = 0x10AF -> msdn.microsoft.com/en-us/library/bb761133(v=vs.85).aspx    SendMessage, 0x10AF, 0, 0, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_IsRowChecked - Indicates if a row in the list-view control is checked. ; ====================================================================================================================== LV_EX_IsRowChecked(HLV, Row) {    Return LV_EX_GetItemState(HLV, Row).Checked } ; ====================================================================================================================== ; LV_EX_IsRowFocused - Indicates if a row in the list-view control is focused. ; ====================================================================================================================== LV_EX_IsRowFocused(HLV, Row) {    Return LV_EX_GetItemState(HLV, Row).Focused } ; ====================================================================================================================== ; LV_EX_IsRowSelected - Indicates if a row in the list-view control is selected. ; ====================================================================================================================== LV_EX_IsRowSelected(HLV, Row) {    Return LV_EX_GetItemState(HLV, Row).Selected } ; ====================================================================================================================== ; LV_EX_IsRowVisible - Indicates if a row in the list-view control is visible. ; ====================================================================================================================== LV_EX_IsRowVisible(HLV, Row) {    ; LVM_ISITEMVISIBLE = 0x10B6 -> http://msdn.microsoft.com/en-us/library/bb761135(v=vs.85).aspx    SendMessage, 0x10B6, % (Row - 1), 0, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; CommCtrl.h: ; // These next to methods make it easy to identify an item that can be repositioned ; // within listview. For example: Many developers use the lParam to store an identifier that is ; // unique. Unfortunatly, in order to find this item, they have to iterate through all of the items ; // in the listview. Listview will maintain a unique identifier.  The upper bound is the size of a DWORD. ; ====================================================================================================================== ; LV_EX_MapIDToIndex - Maps the ID of an item to an index. ; ====================================================================================================================== LV_EX_MapIDToIndex(HLV, ID) {    ; LVM_MAPIDTOINDEX = 0x10B5 -> http://msdn.microsoft.com/en-us/library/bb761137(v=vs.85).aspx    SendMessage, 0x10B5, % ID, 0, , % ""ahk_id "" . HLV    Return (ErrorLevel + 1) } ; ====================================================================================================================== ; LV_EX_MapIndexToID - Maps the index of an item to an unique ID. ; ====================================================================================================================== LV_EX_MapIndexToID(HLV, Index) {    ; LVM_MAPINDEXTOID = 0x10B4 -> http://msdn.microsoft.com/en-us/library/bb761139(v=vs.85).aspx    SendMessage, 0x10B4, % (Index - 1), 0, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_RedrawRows - Forces a list-view control to redraw a range of items. ; ====================================================================================================================== LV_EX_RedrawRows(HLV, First := 0, Last := """") {    ; LVM_REDRAWITEMS = 0x1015 -> http://msdn.microsoft.com/en-us/library/bb761145(v=vs.85).aspx    If (First > 0) {       If (Last = """")          Last := First    }    Else {       First := LV_EX_GetTopIndex(HLV)       Last := First + LV_EX_GetRowsPerPage(HLV) - 1    }    SendMessage, 0x1015, % (First - 1), % (Last - 1), , % ""ahk_id "" . HLV    If (ErrorLevel)       Return DllCall(""User32.dll\UpdateWindow"", ""Ptr"", HLV, ""UInt"")    Return False } ; ====================================================================================================================== ; LV_EX_SetBkImage - Sets the background image in a list-view control. ; ====================================================================================================================== LV_EX_SetBkImage(HLV, ImgPath, Width := """", Height := """") {    ; LVM_SETBKIMAGEA := 0x1044 -> http://msdn.microsoft.com/en-us/library/bb761155(v=vs.85).aspx    Static XAlign := {C: 50, L: 0, R: 100}, YAlign := {B: 100, C: 50, T: 0}    Static KnownCtrls := []    Static OSVERSION := DllCall(""Kernel32.dll\GetVersion"", ""UInt"") & 0xFF    HBITMAP := 0    If (ImgPath) && FileExist(ImgPath) {       If (Width = """") && (Height = """") {          VarSetCapacity(RECT, 16, 0)          DllCall(""User32.dll\GetClientRect"", ""Ptr"", HLV, ""Ptr"", &RECT)          Width := NumGet(RECT, 8, ""Int""), Height := NumGet(RECT, 12, ""Int"")       }       HMOD := DllCall(""Kernel32.dll\LoadLibrary"", ""Str"", ""Gdiplus.dll"", ""UPtr"")       VarSetCapacity(SI, 24, 0), NumPut(1, SI, ""UInt"")       DllCall(""Gdiplus.dll\GdiplusStartup"", ""PtrP"", Token, ""Ptr"", &SI, ""Ptr"", 0)       DllCall(""Gdiplus.dll\GdipCreateBitmapFromFile"", ""WStr"", ImgPath, ""PtrP"", Bitmap)       DllCall(""Gdiplus.dll\GdipCreateHBITMAPFromBitmap"", ""Ptr"", Bitmap, ""PtrP"", HBITMAP, ""UInt"", 0x00FFFFFF)       DllCall(""Gdiplus.dll\GdipDisposeImage"", ""Ptr"", Bitmap)       DllCall(""Gdiplus.dll\GdiplusShutdown"", ""Ptr"", Token)       DllCall(""Kernel32.dll\FreeLibrary"", ""Ptr"", HMOD)       HBITMAP := DllCall(""User32.dll\CopyImage""                        , ""Ptr"", HBITMAP, ""UInt"", 0, ""Int"", Width, ""Int"", Height, ""UInt"", 0x2008, ""UPtr"")       If !(HBITMAP)          Return False    }    ; Set extended style LVS_EX_DOUBLEBUFFER to avoid drawing issues    If !KnownCtrls.HasKey(HLV) {       LV_EX_SetExtendedStyle(HLV, 0x00010000, 0x00010000) ; LVS_EX_DOUBLEBUFFER = 0x00010000       KnownCtrls[HLV] := True    }    Flags := 0x10000000 ; LVBKIF_TYPE_WATERMARK    If (HBITMAP) && (OSVERSION >= 6) ; LVBKIF_FLAG_ALPHABLEND prevents that the image will be shown on WinXP       Flags |= 0x20000000 ; LVBKIF_FLAG_ALPHABLEND    LVBKIMAGESize :=  A_PtrSize = 8 ? 40 : 24    VarSetCapacity(LVBKIMAGE, LVBKIMAGESize, 0)    NumPut(Flags, LVBKIMAGE, 0, ""UInt"")    NumPut(HBITMAP, LVBKIMAGE, A_PtrSize, ""UPtr"")    SendMessage, 0x1044, 0, % &LVBKIMAGE, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_SetColumnOrder - Sets the left-to-right order of columns in a list-view control. ; ====================================================================================================================== LV_EX_SetColumnOrder(HLV, ColArray) {    ; LVM_SETCOLUMNORDERARRAY = 0x103A -> http://msdn.microsoft.com/en-us/library/bb761161(v=vs.85).aspx    Cols := ColArray.MaxIndex()    VarSetCapacity(COA, Cols * 4, 0)    For I, C In ColArray       NumPut(C - 1, COA, (I - 1) * 4, ""Int"")    SendMessage, 0x103A, % Cols, % &COA, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_SetExtendedStyle - Sets extended styles in list-view controls. ; ====================================================================================================================== LV_EX_SetExtendedStyle(HLV, StyleMsk, Styles) {    ; LVM_SETEXTENDEDLISTVIEWSTYLE = 0x1036 -> http://msdn.microsoft.com/en-us/library/bb761165(v=vs.85).aspx    SendMessage, 0x1036, % StyleMsk, % Styles, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_SetGroup - Assigns a list-view item to an existing group. ; ====================================================================================================================== LV_EX_SetGroup(HLV, Row, GroupID) {    ; LVM_SETITEMA = 0x1006 -> http://msdn.microsoft.com/en-us/library/bb761186(v=vs.85).aspx    Static OffGroupID := 28 + (A_PtrSize * 3)    LV_EX_LVITEM(LVITEM, 0x00000100, Row) ; LVIF_GROUPID    NumPut(GroupID, LVITEM, OffGroupID, ""UPtr"")    SendMessage, 0x1006, 0, % &LVITEM, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_SetIconSpacing - Sets the spacing between icons in the icon view. ; ====================================================================================================================== LV_EX_SetIconSpacing(HLV, CX, CY) {    ; LVM_SETICONSPACING = 0x1035 -> http://msdn.microsoft.com/en-us/library/bb761176(v=vs.85).aspx    If (CX < 4) && (CX <> -1)       CX := 4    If (CY < 4) && (CY <> -1)       CY := 4    SendMessage, 0x1035, 0, % (CX & 0xFFFF) | ((CY & 0xFFFF) << 16), , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_SetItemIndent - Sets the indent of the first column to the specified number of icon widths. ; ====================================================================================================================== LV_EX_SetItemIndent(HLV, Row, NumIcons) {    ; LVM_SETITEMA = 0x1006 -> http://msdn.microsoft.com/en-us/library/bb761186(v=vs.85).aspx    Static OffIndent := 24 + (A_PtrSize * 3)    LV_EX_LVITEM(LVITEM, 0x00000010, Row) ; LVIF_INDENT    NumPut(NumIcons, LVITEM, OffIndent, ""Int"")    SendMessage, 0x1006, 0, % &LVITEM, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_SetItemParam - Sets the lParam field of the item to the specified value. ; ====================================================================================================================== LV_EX_SetItemParam(HLV, Row, Value) {    ; LVM_SETITEMA = 0x1006 -> http://msdn.microsoft.com/en-us/library/bb761186(v=vs.85).aspx    Static OffParam := 24 + (A_PtrSize * 2)    LV_EX_LVITEM(LVITEM, 0x00000004, Row) ; LVIF_PARAM    NumPut(Value, LVITEM, OffParam, ""UPtr"")    SendMessage, 0x1006, 0, % &LVITEM, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_SetSubItemImage - Assigns an image from the list-view's image list to this subitem. ; ====================================================================================================================== LV_EX_SetSubItemImage(HLV, Row, Column, Index) {    ; LVM_SETITEMA = 0x1006 -> http://msdn.microsoft.com/en-us/library/bb761186(v=vs.85).aspx    Static KnownCtrls := []    Static OffImage := 20 + (A_PtrSize * 2)    If !KnownCtrls.HasKey(HLV) {       LV_EX_SetExtendedStyle(HLV, 0x00000002, 0x00000002) ; LVS_EX_SUBITEMIMAGES = 0x00000002       KnownCtrls[HLV] := True    }    LV_EX_LVITEM(LVITEM, 0x00000002, Row, Column) ; LVIF_IMAGE    NumPut(Index - 1, LVITEM, OffImage, ""Int"")    SendMessage, 0x1006, 0, % &LVITEM, , % ""ahk_id "" . HLV    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_SetTileInfo - Sets the additional columns displayed for this tile, and the order of those columns. ; ====================================================================================================================== LV_EX_SetTileInfo(HLV, Row, Columns*) {    ; Row      : The 1-based row number. If you specify a number less than 1, the tile info will be set for all rows.    ; Colomns* : Array of column indices, specifying which columns are displayed for this item, and the order of those    ;            columns. Indices should be greater than 1, because column 1, the item name, is already displayed.    ; LVM_SETTILEINFO = 0x10A4 -> http://msdn.microsoft.com/en-us/library/bb761210(v=vs.85).aspx    Static SizeLVTI := (4 * 2) + (A_PtrSize * 2)    Static OffItem := 4    Static OffCols := 8    Static OffColArr := OffCols + A_PtrSize    ColCount := (CC := Columns.MaxIndex()) = """" ? 0 : CC    Lines := LV_EX_GetTileViewLines(HLV)    If ((Row = 0) && (ColCount <> Lines)) || ((Row <> 0) && (ColCount >= Lines))       LV_EX_SetTileViewLines(HLV, ColCount)    VarSetCapacity(ColArr, 4 * (ColCount + 1), 0)    Addr := &ColArr    For I, Column In Columns       Addr := NumPut(Column - 1, Addr + 0, ""UInt"")    VarSetCapacity(LVTI, SizeLVTI, 0)       ; LVTILEINFO    NumPut(SizeLVTI, LVTI, 0, ""UInt"")       ; cbSize    NumPut(ColCount, LVTI, OffCols, ""UInt"") ; cColumns    NumPut(&ColArr, LVTI, OffColArr, ""Ptr"") ; puColumns    If (Row > 0) {       NumPut(Row - 1, LVTI, OffItem, ""Int"") ; iItem       SendMessage, 0x10A4, 0, % &LVTI, , % ""ahk_id "" . HLV ; LVM_SETTILEINFO       Return ErrorLevel    }    SendMessage, 0x1004, 0, 0, , % ""ahk_id "" . HLV ; LVM_GETITEMCOUNT    Loop, % ErrorLevel {       NumPut(A_Index - 1, LVTI, OffItem, ""Int"") ; iItem       SendMessage, 0x10A4, 0, % &LVTI, , % ""ahk_id "" . HLV ; LVM_SETTILEINFO       If !(ErrorLevel)          Return ErrorLevel    }    Return True } ; ====================================================================================================================== ; LV_EX_SetTileViewLines - Sets the maximum number of additional text lines in each tile, not counting the title. ; ====================================================================================================================== LV_EX_SetTileViewLines(HLV, Lines) {    ; Lines : Maximum number of text lines in each item label, not counting the title.    ; LVM_GETTILEVIEWINFO = 0x10A3 -> http://msdn.microsoft.com/en-us/library/bb761083(v=vs.85).aspx    ; LVM_SETTILEVIEWINFO = 0x10A2 -> http://msdn.microsoft.com/en-us/library/bb761212(v=vs.85).aspx    ; One line is added internally because the item might be wrapped to two lines!    Static SizeLVTVI := 40    Static OffLines := 20    If (Lines > 0)       Lines++    VarSetCapacity(LVTVI, SizeLVTVI, 0)     ; LVTILEVIEWINFO    NumPut(SizeLVTVI, LVTVI, 0, ""UInt"")     ; cbSize    NumPut(0x00000003, LVTVI, 4, ""UInt"")    ; dwMask = LVTVIM_TILESIZE | LVTVIM_COLUMNS    NumPut(Lines, LVTVI, OffLines, ""Int"") ; c_lines: max lines below first line    SendMessage, 0x10A2, 0, % &LVTVI, , % ""ahk_id "" . HLV ; LVM_SETTILEVIEWINFO    Return ErrorLevel } ; ====================================================================================================================== ; LV_EX_SubItemHitTest - Gets the column (subitem) at the passed coordinates or the position of the mouse cursor. ; ====================================================================================================================== LV_EX_SubItemHitTest(HLV, X := -1, Y := -1) {    ; LVM_SUBITEMHITTEST = 0x1039 -> http://msdn.microsoft.com/en-us/library/bb761229(v=vs.85).aspx    VarSetCapacity(LVHTI, 24, 0) ; LVHITTESTINFO    If (X = -1) || (Y = -1) {       DllCall(""User32.dll\GetCursorPos"", ""Ptr"", &LVHTI)       DllCall(""User32.dll\ScreenToClient"", ""Ptr"", HLV, ""Ptr"", &LVHTI)    }    Else {       NumPut(X, LVHTI, 0, ""Int"")       NumPut(Y, LVHTI, 4, ""Int"")    }    SendMessage, 0x1039, 0, % &LVHTI, , % ""ahk_id "" . HLV    Return (ErrorLevel > 0x7FFFFFFF ? 0 : NumGet(LVHTI, 16, ""Int"") + 1) } ; ====================================================================================================================== ; ====================================================================================================================== ; Function for internal use ============================================================================================ ; ====================================================================================================================== ; ====================================================================================================================== LV_EX_LVITEM(ByRef LVITEM, Mask := 0, Row := 1, Col := 1) {    Static LVITEMSize := 48 + (A_PtrSize * 3)    VarSetCapacity(LVITEM, LVITEMSize, 0)    NumPut(Mask, LVITEM, 0, ""UInt""), NumPut(Row - 1, LVITEM, 4, ""Int""), NumPut(Col - 1, LVITEM, 8, ""Int"") } ; ---------------------------------------------------------------------------------------------------------------------- LV_EX_PWSTR(Str, ByRef WSTR) { ; ANSI to Unicode    VarSetCapacity(WSTR, StrPut(Str, ""UTF-16"") * 2, 0)    StrPut(Str, &WSTR, ""UTF-16"")    Return &WSTR } Sources at GitHub. Docs at GitHub. Download from GitHub. Last edited by just me on 28 Apr 2016, 08:24, edited 2 times in total. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [LIB] LV_EX - update on 2015-03-13 Report this post Quote 13 Mar 2015, 05:42 * Update 1.1.00.00 * Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top rajat Posts: 8 Joined: 07 Feb 2014, 13:35 Re: [LIB] LV_EX - update on 2015-03-13 Report this post Quote 31 Jul 2015, 10:19 This is an awesome set of functions mate, many thanks! Top kczx3 Posts: 237 Joined: 06 Oct 2015, 21:39 Re: [LIB] LV_EX - update on 2015-03-13 Report this post Quote 17 Dec 2015, 09:15 @just me I haven't been able to figure out the right combination of commands to create a collapsible listview group but set that group to initially be collapsed. Setting the state to Collapsible makes it expanded but setting it to Collapsed makes it so you can't expand it. Help plz Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [LIB] LV_EX - update on 2015-03-13 Report this post Quote 17 Dec 2015, 10:43 The LV_EX_GroupSetState() function replaces all states with the passed states. Code: [Select all] [Download] GeSHi © Codebox Plus LV_EX_GroupSetState(HLV, GrouID, ""Collapsible"") includes the Normal (expanded) state implicitely, because its value is 0x00. Code: [Select all] [Download] GeSHi © Codebox Plus LV_EX_GroupSetState(HLV, GrouID, ""Collapsed"") will remove the Collapsible state. Code: [Select all] [Download] GeSHi © Codebox Plus LV_EX_GroupSetState(HLV, GrouID, ""Collapsed"", ""Collapsible"")will set both states. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top kczx3 Posts: 237 Joined: 06 Oct 2015, 21:39 Re: [LIB] LV_EX - update on 2015-03-13 Report this post Quote 17 Dec 2015, 11:19 Ahhhh, is that what the States* means? That any parameters after that all are States? Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [LIB] LV_EX - update on 2015-03-13 Report this post Quote 17 Dec 2015, 11:49 Correct! Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top kczx3 Posts: 237 Joined: 06 Oct 2015, 21:39 Re: [LIB] LV_EX - update on 2015-03-13 Report this post Quote 18 Dec 2015, 12:15 More help needed. So I currently have a listview with 2 groups, the first has the header hidden and the second is now set to be collapsible but initially collapsed. What I now want to do is scroll the listview to the bottom should the user expand the second group. I first need to find a way to determine how to track the user's movements and clicks/double clicks. It seems none of the built in A_* variables give any useful info when the header is double clicked or the Arrow is clicked to expand the group. As for the scrolling, I was looking at checking for LVM_GETGROUPSTATE but not sure if that's what I need to be using. Does this look even remotely correct? Code: [Select all] [Download] GeSHi © Codebox Plus ; ====================================================================================================================== ; LV_EX_GetGroupState - Gets the state of a group by group ID ; ====================================================================================================================== LV_EX_GetGroupState(HLV, GroupID) {    ; LVM_GETGROUPSTATE = 0x105C -> https://msdn.microsoft.com/en-us/library/bb774936(v=vs.85).aspx    ; LVGS_COLLAPSED = 0x00000001    SendMessage, 0x105C, %GroupID%, 0x00000001, , % ""ahk_id "" . HLV    Return ErrorLevel }   Top kczx3 Posts: 237 Joined: 06 Oct 2015, 21:39 Re: [LIB] LV_EX - update on 2015-03-13 Report this post Quote 18 Dec 2015, 12:36 Oh wait! That function works actually. It only checks for LVGS_COLLAPSED := 0x00000001 though. Not sure if there is a way to check for all applied states. So now I just need to figure out how to check if they double clicked on the group header, and if so, check the state of LVGS_COLLAPSED and if it is not collapsed, scroll to the bottom. Top kczx3 Posts: 237 Joined: 06 Oct 2015, 21:39 Re: [LIB] LV_EX - update on 2015-03-13 Report this post Quote 06 Jan 2016, 11:46 Thoughts on this function? Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ; ====================================================================================================================== ; LV_EX_GetGroupHeader - Gets the header text of a group by group ID ; ====================================================================================================================== LV_EX_GetGroupHeader(HLV, GroupID) {    ; LVM_GETGROUPINFO = 0x1095    Static SizeOfLVGROUP := (4 * 6) + (A_PtrSize * 4)    Static OffHeader := 8    VarSetCapacity(LVGROUP, SizeOfLVGROUP, 0)    NumPut(SizeOfLVGROUP, LVGROUP, 0, ""UInt"")    SendMessage, 0x1095, %GroupID%, % &LVGROUP, , % ""ahk_id "" . HLV    Return NumGet(LVGROUP, OffHeader, ""Ptr"") }   The message is returning successfully because ErrorLevel is getting set to the GroupID but I'm having trouble correctly extracting the header text. Wonder if I need to make use of the LV_EX_PWSTR(Str, ByRef WSTR) function. Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [LIB] LV_EX - update on 2015-03-13 Report this post Quote 07 Jan 2016, 02:52 It's a bug and will be fixed. Thanks for reporting! Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [LIB] LV_EX - update on 2015-03-13 Report this post Quote 07 Jan 2016, 04:52 Haha, I thought it would be a part of my lib, but it isn't. It's faulty, though. So I'll fix your function. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [LIB] LV_EX - update on 2015-03-13 Report this post Quote 07 Jan 2016, 05:17 Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ; ====================================================================================================================== ; LV_EX_GetGroupHeader - Gets the header text of a group by group ID ; ====================================================================================================================== LV_EX_GetGroupHeader(HLV, GroupID, MaxChars := 1024) {    ; LVM_GETGROUPINFO = 0x1095    Static SizeOfLVGROUP := (4 * 6) + (A_PtrSize * 4)    Static LVGF_HEADER := 0x00000001    Static OffHeader := 8    Static OffHeaderMax := 8 + A_PtrSize    VarSetCapacity(HeaderText, MaxChars * 2, 0)    VarSetCapacity(LVGROUP, SizeOfLVGROUP, 0)    NumPut(SizeOfLVGROUP, LVGROUP, 0, ""UInt"")    NumPut(LVGF_HEADER, LVGROUP, 4, ""UInt"")    NumPut(&HeaderText, LVGROUP, OffHeader, ""Ptr"")    NumPut(MaxChars, LVGROUP, OffHeaderMax, ""Int"")    SendMessage, 0x1095, %GroupID%, % &LVGROUP, , % ""ahk_id "" . HLV    Return StrGet(&HeaderText, MaxChars, ""UTF-16"") } Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top kczx3 Posts: 237 Joined: 06 Oct 2015, 21:39 Re: [LIB] LV_EX - update on 2015-03-13 Report this post Quote 07 Jan 2016, 07:58 just me wrote:Haha, I thought it would be a part of my lib, but it isn't. It's faulty, though. So I'll fix your function. I think its a great addition to your library. I really can't call it my function seeing as I tried piecing it together based on your work. And then you ended up fixing it anyhow! I do just want to tell you that all your work here is brilliant. I've learned a lot from deciphering your work. Bravo! Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [LIB] LV_EX - update on 2016-04-28 Report this post Quote 28 Apr 2016, 07:59 *Update 1.1.01.00* (Added LV_EX_GroupGetState() contributed by Pulover) Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [LIB] LV_EX - update on 2016-04-28 Report this post Quote 28 Apr 2016, 08:26 Took the chance and added LV_EX_GroupGetHeader() as suggested by kczx3 above, too. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top kczx3 Posts: 237 Joined: 06 Oct 2015, 21:39 Re: [LIB] LV_EX - update on 2016-04-28 Report this post Quote 10 May 2016, 12:46 So I'm looking into trying to extend the functionality that LV_EX has. They are quite a few parameters to the LVGROUP structure, albeit only supported on newer OS versions, that I'm interested in. Of particular interest, is the Task Link which is clickable text in the group header that sends a LVN_LINKCLICK notification via WM_NOTIFY. I attempted to add another parameter to LV_EX_GroupIsnert() but am not seeing any results from it. Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ; ====================================================================================================================== ; LV_EX_GroupInsert - Inserts a group into a list-view control. ; ====================================================================================================================== LV_EX_GroupInsert(HLV, GroupID, Header, Align := """", Index := -1, Task := """") {    ; LVM_INSERTGROUP = 0x1091 -> msdn.microsoft.com/en-us/library/bb761103(v=vs.85).aspx    Static Alignment := {1: 1, 2: 2, 4: 4, C: 2, L: 1, R: 4}    Static SizeOfLVGROUP := (4 * 6) + (A_PtrSize * 8)    Static OffHeader := 8    Static OffGroupID := OffHeader + (A_PtrSize * 3) + 4    Static OffAlign := OffGroupID + 12    Static OffTask := OffAlign + (A_PtrSize * 3)    Static LVGF := 0x11 ; LVGF_GROUPID | LVGF_HEADER | LVGF_STATE    Static LVGF_ALIGN := 0x00000008    Static LVGF_TASK := 0x00000200    Align := (A := Alignment[SubStr(Align, 1, 1)]) ? A : 0    Mask := LVGF | (Align ? LVGF_ALIGN : 0) | (Task ? LVGF_TASK : 0)    PHeader := A_IsUnicode ? &Header : LV_EX_PWSTR(Header, WHeader)    PTask := A_IsUnicode ? &Task : LV_EX_PWSTR(Task, WTask)    VarSetCapacity(LVGROUP, SizeOfLVGROUP, 0)    NumPut(SizeOfLVGROUP, LVGROUP, 0, ""UInt"")    NumPut(Mask, LVGROUP, 4, ""UInt"")    NumPut(PHeader, LVGROUP, OffHeader, ""Ptr"")    NumPut(GroupID, LVGROUP, OffGroupID, ""Int"")    NumPut(Align, LVGROUP, OffAlign, ""UInt"")    NumPut(PTask, LVGROUP, OffTask, ""Ptr"")    SendMessage, 0x1091, %Index%, % &LVGROUP, , % ""ahk_id "" . HLV    Return ErrorLevel }   I tried getting the offsets correct by talking with GeekDude in the IRC chat. Not sure if those are off or if there is a mystery puzzle piece I am missing. I also contemplated making a new function to handle this by mimicking LV_EX_GroupSetState() but this also fails to function properly. Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ; ====================================================================================================================== ; LV_EX_GroupSetTask - Set group Task ; ====================================================================================================================== LV_EX_GroupSetTask(HLV, GroupID, Task := """") {    ; LVM_SETGROUPINFO = 0x1093 -> msdn.microsoft.com/en-us/library/bb761167(v=vs.85).aspx    Static LVGF_TASK := 0x00000200 ;LVGF_TASK    Static SizeOfLVGROUP := (4 * 6) + (A_PtrSize * 8)    Static OffTask := 72    PTask := A_IsUnicode ? &Task : LV_EX_PWSTR(Task, WTask)    VarSetCapacity(LVGROUP, SizeOfLVGROUP, 0)    NumPut(SizeOfLVGROUP, LVGROUP, 0, ""UInt"")    NumPut(LVGF_TASK, LVGROUP, 4, ""UInt"")    NumPut(PTask, LVGROUP, OffTask, ""Ptr"")    SendMessage, 0x1093, %GroupID%, % &LVGROUP, , % ""ahk_id "" . HLV    Return ErrorLevel }   Lastly, my concern is monitoring for this notification. I make use of Class_LV_Colors in nearly all ListViews that I make which also monitors WM_NOTIFY, I believe. I don't think I could use both then and monitor the notifications from each. I'd like to try and pick this up myself so if there are any hints you may have to offer that would be helpful. The more I learn the less I have to ask you . As always, thanks! Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [LIB] LV_EX - update on 2016-04-28 Report this post Quote 11 May 2016, 09:50 Hi kczx3, the structure size of the extended LVGROUP version for Vista+ is not correct. I corrected your LV_EX_GroupSetTask() function and it is working for me: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ; ====================================================================================================================== ; LV_EX_GroupSetTask - Set group Task ; ====================================================================================================================== LV_EX_GroupSetTask(HLV, GroupID, Task := """") {    ; LVM_SETGROUPINFO = 0x1093 -> msdn.microsoft.com/en-us/library/bb761167(v=vs.85).aspx    Static LVGF_TASK := 0x00000200 ;LVGF_TASK    Static SizeOfLVGROUP := (4 * 10) + (A_PtrSize * 14)    Static OffTask := (4 * 6) + (A_PtrSize * 6)    PTask := A_IsUnicode ? &Task : LV_EX_PWSTR(Task, WTask)    VarSetCapacity(LVGROUP, SizeOfLVGROUP, 0)    NumPut(SizeOfLVGROUP, LVGROUP, 0, ""UInt"")    NumPut(LVGF_TASK, LVGROUP, 4, ""UInt"")    NumPut(PTask, LVGROUP, OffTask, ""Ptr"")    SendMessage, 0x1093, %GroupID%, % &LVGROUP, , % ""ahk_id "" . HLV    Return ErrorLevel } Related to WM_NOTIFY -> LVN_LINKCLICK I think that you can monitor it with an own function if you use a function object. The default message handler of LV_Colors() does not touch LVN_LINKCLICK notifications, so both should work But it possibly might cause the well-known freezing issue. Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top kczx3 Posts: 237 Joined: 06 Oct 2015, 21:39 Re: [LIB] LV_EX - update on 2016-04-28 Report this post Quote 12 May 2016, 09:12 Well, I think I'm getting there... Last bit is to get the iSubItem from the NMLINK structure so that I know what group's link was clicked. Assumption would be that my offsets are again incorrect. Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ON_LVN_LINKCLICK(w, l, msg, hwnd) { 	Global IMLV_LView, AMLV_LView 	; lParam is a pointer to a NMLINK structure containing NMHDR and LITEM structures 	; -> http://msdn.microsoft.com/en-us/library/bb760714%28VS.85%29.aspx 	Static LVN_LINKCLICK := -184 	Static NMHDRSize := A_PtrSize * 3 	Static MAX_LINKID_TEXT := 48 	Static L_MAX_URL_LENGTH := (2048 + 32 + 3) ; 3 : sizeof(""://"")) 	Static LITEMSize := (A_PtrSize * 4) + ((MAX_LINKID_TEXT + L_MAX_URL_LENGTH) * 2) 	Static iSubItem := LITEMSize + A_PtrSize 	If ((HCTL := NumGet(L + 0, 0, ""UPtr"")) = IMLV_LView OR HCTL = AMLV_LView) 	{ 		code := NumGet(L + (A_PtrSize * 2), 0, ""Int"") 		If (code = -184) 			ToolTip, % NumGet(L + iSubItem, ""Int"") 		Else 			Return 	} }   Top just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany Re: [LIB] LV_EX - update on 2016-04-28 Report this post Quote 13 May 2016, 09:33 Well, your assumption was right. I corrected the offset. You didn't add the size of the leading NMHDR structure. Also, the first 4 fields of the LITEM structure as well as iItem and iSubItem are 4 bytes long (Uint/Int), and the iItem field following the LITEM structure has to be aligned to a DWORD boundary, so 2 extra bytes must be added: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ON_LVN_LINKCLICK(W, L, Msg, hWnd) { 	Global IMLV_LView, AMLV_LView 	; lParam is a pointer to a NMLVLINK structure. The identifier of the group containing the link is in the iSubItem member. 	; -> msdn.microsoft.com/en-us/library/bb774851%28v=vs.85%29.aspx 	Static MAX_LINKID_TEXT := 48 	Static L_MAX_URL_LENGTH := 2048 + 32 + 3 ; 3 = sizeof(""://"")) 	Static NMHDRSize := A_PtrSize * 3 	Static LITEMSize := (4 * 4) + ((MAX_LINKID_TEXT + L_MAX_URL_LENGTH) * 2) 	Static OffSubItem := NMHDRSize + LITEMSize + 6 ; 2 bytes alignment + 4 bytes iItem 	If ((HCTL := NumGet(L + 0, 0, ""UPtr"")) = IMLV_LView) OR (HCTL = AMLV_LView) 	{ 		Code := NumGet(L + (A_PtrSize * 2), ""Int"") 		If (Code = -184) ; LVN_LINKCLICK 			ToolTip, % ""GroupID: "" . NumGet(L + OffSubItem, ""Int"") 		Else 			Return 	} } Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 23 posts 1 2 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: pondermatic and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by just me - Some additional functions for AHK GUI ListView controls. Forum thread:"	"true"
"ListView"	"LV_InCellEdit"	"https://github.com/AHK-just-me/Class_LV_InCellEdit/"	"by just Me - In-cell editing for ListView controls. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"4"	"5"	"1"	"GitHub - AHK-just-me/Class_LV_InCellEdit: AHK class supporting in-cell editing for ListView controls Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 5 Star 4 Fork 1 AHK-just-me/Class_LV_InCellEdit Code Issues 0 Pull requests 0 Pulse Graphs AHK class supporting in-cell editing for ListView controls 9 commits 1 branch 1 release Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show v1.1 Nothing to show New pull request Fetching latest commit… Cannot retrieve the latest commit at this time. Permalink Failed to load latest commit information. Sources .gitattributes .gitignore README.md README.md Class_LV_InCellEdit AHK class providing in-cell editing for ListView controls in AHK GUIs. The class provides methods to restrict editing to certain columns, to directly start editing of a specified cell, and to deactivate/activate the built-in message handler for WM_NOTIFY messages (see below). The message handler for WM_NOTIFY messages will be activated for the specified ListView whenever a new instance is created. As long as the message handler is activated a double-click on any cell will show an Edit control within this cell allowing to edit the current content. The default behavior for editing the first column by two subsequent single clicks is disabled. You have to press ""Esc"" to cancel editing, otherwise the content of the Edit will be stored in the current cell. ListViews must have the -ReadOnly option to be editable. While editing, ""Esc"", ""Tab"", ""Shift+Tab"", ""Down"", and ""Up"" keys are registered as hotkeys. ""Esc"" will cancel editing without changing the value of the current cell. All other hotkeys will store the content of the edit in the current cell and continue editing for the next (Tab), previous (Shift+Tab), upper (Up), or lower (Down) cell. You cannot use the keys for other purposes while editing. All changes are stored in MyInstance.Changed. You may track the changes by triggering (A_GuiEvent == ""F"") in the ListView's gLabel and checking MyInstance[""Changed""] as shown in the sample scipt. If ""True"", MyInstance.Changed contains an array of objects with keys ""Row"" (row number), ""Col"" (column number), and ""Txt"" (new content). 'Changed' is one of the two keys intended to be accessed directly from outside the class. If you want to temporarily disable in-cell editing call MyInstance.OnMessage(False). This must be done also before you try to destroy the instance. To enable it again, call MyInstance.OnMessage()`. To avoid the loss of Gui events and messages the message handler might need to be Critical. This can be achieved by setting the instance property 'Critical' to the required value (e.g. MyInstance.Critical := 100). New instances default to Critical, Off. Though sometimes needed, ListViews or the whole Gui may become unresponsive under certain circumstances if Critical is set and the ListView has a g-label. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/AHK-just-me/Class_LV_InCellEdit/"	"by just Me - In-cell editing for ListView controls. Forum thread:"	"true"
"ListView"	"link"	"http://https//autohotkey.com/boards/viewtopic.php?f=6&t=1076"	"by just Me - In-cell editing for ListView controls. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"by just Me - In-cell editing for ListView controls. Forum thread:"	"false"
"ListView"	"LV_Rows"	"https://github.com/Pulover/Class_LV_Rows"	"by Pulover - Additional functions for AHK ListView controls. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"0"	"1"	"0"	"GitHub - Pulover/Class_LV_Rows: Additional functions for AHK ListView controls Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 1 Star 0 Fork 0 Pulover/Class_LV_Rows Code Issues 0 Pull requests 0 Pulse Graphs Additional functions for AHK ListView controls https://autohotkey.com/boards/viewtopic.php?f=6&t=137 10 commits 1 branch 3 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show v1.1.2 v1.1.1 v1.1 Nothing to show New pull request Fetching latest commit… Cannot retrieve the latest commit at this time. Permalink Failed to load latest commit information. Examples Class_LV_Rows.ahk LICENSE README.md README.md Class LV_Rows Additional functions for AHK ListView controls AHK version: 1.1.23.01 This class provides an easy way to add functionalities to ListViews that are not supported by AutoHotkey built-in functions such as Copy, Cut, Paste, Drag and more. Credits LV_EX functions by just me Edit Functions Copy() Cut() Paste([Row, Multiline]) Duplicate() Delete() Move([Up]) Drag([DragButton, AutoScroll, ScrollDelay, LineThick, Color]) History Functions Add() Undo() Redo() ClearHistory() Group Functions EnableGroups([Enable, FirstName, Collapsible, StartCollapsed]) InsertGroup([Row, GroupName]) RemoveGroup([Row]) InsertAtGroup([Count, Rows*]) RemoveAtGroup([Count, Rows*]) SetGroups(Groups) GetGroups([AsObject]) SetGroupCollapisable([Collapsible]) RemoveAllGroups([FirstName]) CollapseAll([Collapse]) RefreshGroups([Collapsed]) Management Functions InsertHwnd(Hwnd) RemoveHwnd(Hwnd) SetHwnd(Hwnd [, NewData]) GetData([Hwnd]) SetCallback(Func) Usage You can call the function by preceding them with LV_Rows. For example: LV_Rows.Copy() <-- Calls function on active ListView. Or with a handle initialized via New meta-function. For example: MyListHandle := New LV_Rows() <-- Creates a new handle. MyListHandle.Add() <-- Calls function for that Handle. Like AutoHotkey built-in functions, these functions operate on the default gui, and active ListView control. When usingle handles, SetHwnd will attempt to set the selected ListView as active, but it's recommend to call Gui, Listview on your script too. Initializing is required for History and Group functions and in case your ListView has icons to be moved during Drag(). Gui, Add, ListView, hwndhLV, Columns MyListHandle := New LV_Rows(hLV) <-- Creates a new handle with Hwnd. Gui, Add, ListView, hwndhLV1, Columns Gui, Add, ListView, hwndhLV2, Columns MyListHandle := New LV_Rows(hLV1, hLV2) You can also use the same handle for the Edit functions. You can create more handles or pass the ListView's Hwnd to operate on different lists with the same handle. In order to keep row's icons you need to initialize the class passing the ListView's Hwnd. For example: Gui, Add, ListView, hwndhLV, Columns MyListHandle := New LV_Rows(hLV) Management Functions Set, Insert and Remove ListView Hwnd's. Handle.InsertHwnd() Inserts one or more ListView Hwnd's to be managed. Return No return value. Parameters Hwnd - One or more ListView Hwnd's. Handle.RemoveHwnd() Removes a ListView Hwnd. Return No return value. Parameters Hwnd - Hwnd of the ListView to be removed. Handle.SetHwnd() Selects a previously inserted ListView or adds it to the handle and selects it, optionally copying the data, history and groups from another Hwnd. Return No return value. Parameters Hwnd - Hwnd of a ListView to be selected. If the hwnd is not found, it will be added to the handle and selected. NewData - Hwnd of a previously inserted ListView whose data, history and groups will be copied to the one being selected. Handle.GetData() Retrieves the data, history and groups of a previously inserted ListView. Return An object with data, history and groups of a ListView. Parameters Hwnd - Hwnd of a previously inserted ListView. If left blank, the current active ListView will be returned. LV_Rows.SetCallback() Sets a callback function where the user can take actions based on the function being called called. The Callback function must return true for the operation to be completed. Return No return value. Parameters Func - Name of a user-defined function that should receive 2 parameters** - The name of the function being called and the Hwnd of the current set ListView. Edit Functions Edit ListView rows. LV_Rows.Copy() Copy selected rows to memory. Return Number of copied rows. LV_Rows.Cut() Copy selected rows to memory and delete them. Return Number of copied rows. LV_Rows.Paste() Paste copied rows at selected position. Return True if memory contains data or false if not. Parameters Row - If non-zero pastes memory contents at the specified row. Multiline - If true pastes the contents at every selected row. LV_Rows.Duplicate() Duplicates selected rows. Return Number of duplicated rows. LV_Rows.Delete() Delete selected rows. Return Number of removed rows. LV_Rows.Move() Move selected rows down or up. Return Number of rows moved. Parameters Up - If false or omitted moves rows down. If true moves rows up. LV_Rows.Drag() Drag-and-Drop selected rows showing a destination bar. Must be called in the ListView G-Label subroutine when A_GuiEvent returns ""D"" or ""d"". Return The destination row number. Parameters DragButton - If it is a lower case ""d"" it will be recognized as a Right-Click drag and won't actually move any row, only return the destination, otherwise it will be recognized as a Left-Click drag. You may pass A_GuiEvent as the parameter. AutoScroll - If true or omitted the ListView will automatically scroll up or down when the cursor is above or below the control. ScrollDelay - Delay in miliseconds for AutoScroll. Default is 100ms. LineThick - Thickness of the destination bar in pixels. Default is 2px. Color - Color of destination bar. Default is ""Black"". History Functions Keep a history of ListView changes and allow Undo and Redo. These functions operate on the currently selected ListView. Handle.Add() Adds an entry on History. This function requires initializing: MyListHandle := New LV_Rows() Return The total number of entries in history. Handle.Undo() Replaces ListView contents with previous entry state, if any. Return New entry position or false if it's already the first entry. Handle.Redo() Replaces ListView contents with next entry state, if any. Return New entry position or false if it's already the last entry. Handle.ClearHistory() Removes all history entries from the ListView. Return New entry position or false if it's already the last entry. Group Functions Set, add and remove Listview Groups. These functions are based on just me's LV_EX library Handle.EnableGroups() Enables or disables Groups in the currently selected ListView initializing: MyListHandle := New LV_Rows() Return No return value. Parameters Enable - If TRUE enables GroupView in the selected ListView. If FALSE disables it. FirstName - Name for the first (mandatory) group at row 1. Collapsible - If TRUE makes the groups collapsible. StartCollapsed - If TRUE starts all groups collapsed. Handle.InsertGroup() Inserts or renames a group on top of the specified row. Return TRUE if Row is bigger than 0 or FALSE otherwise. Parameters Row - Number of the row for the group to be inserted. If left blank the first selected row will be used. GroupName - Name of the new group or new name for an existing group. Handle.RemoveGroup() Removes the group the indicated row belongs to. Return TRUE if Row is bigger than 0 or FALSE otherwise. Parameters Row - Number of a row the group belongs to. If left blank the first selected row will be used. Handle.InsertAtGroup() Inserts a row at indicated position, moving groups after it one row down. Return No return value. Parameters Row - Number of the row where to insert. Handle.RemoveAtGroup() Removes a row from indicated position, moving groups after it one row up. Return No return value. Parameters Row - Number of the row where to insert. Handle.SetGroups() Sets one or more groups in the selected ListView. Return No return value. Parameters Groups - A list of groups in the format ""GroupName:RowNumber"" separated by comma. You can use GetGroups() to save a valid String or Object to be used with this function. Handle.GetGroups() Returns a string or object representing the current groups in the selected ListView. Return No return value. Parameters AsObject - If TRUE returns an object with the groups, otherwise an string. Both can be used with SetGroups(). Handle.SetGroupCollapisable() Enables or disables Groups Collapsible style. Return No return value. Parameters Collapsible - If TRUE enables Collapsible style in the selected ListView. If FALSE disables it. Handle.RemoveAllGroups() Removes all groups in the selected ListView. Return No return value. Parameters FirstName - Name for the first (mandatory) group at row 1. Handle.CollapseAll() Collapses or expands all groups. Return No return value. Parameters Collapse - If TRUE collapses all groups in the selected ListView. If FALSE expands all groups in the selected ListView. Handle.RefreshGroups() Reloads the ListView to update groups. This function is called automatically in from other functions, usually it's not necessary to use it in your script. Return No return value. Parameters Collapsed - If TRUE collapses all groups in the selected ListView. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/Pulover/Class_LV_Rows"	"by Pulover - Additional functions for AHK ListView controls. Forum thread:"	"true"
"ListView"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=137"	"by Pulover - Additional functions for AHK ListView controls. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[Class] LV_Rows - Copy, Cut, Paste and Drag ListViews (Updated 03/17/2016) - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:27 All times are UTC-05:00 [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews (Updated 03/17/2016) Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 20 posts • Page 1 of 1 Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews (Updated 03/17/2016) Report this post Quote 04 Oct 2013, 07:22 This class is a collection of functions to allow additional features in ListViews that are not supported by AutoHotkey built-in functions. It provides an easy way to add the commands Copy, Cut, Paste, Duplicate, Delete, Move, Drag, Undo and Redo. Features: Edit functions: Copy, Cut, Paste, Duplicate, Delete, Move, Drag, CopyTo and MoveTo. History functions: Add, Undo and Redo. Group functions: EnableGroups, InsertGroup, RemoveGroup, InsertAtGroup, RemoveAtGroup, SetGroups, GetGroups, SetGroupCollapisable, RemoveAllGroups, CollapseAll and RefreshGroups. Copy, cut and paste between different ListViews. Keep history of individual ListViews to be used with Undo and Redo. Drag-and-Drop shows a destination bar to indicate where selected rows will be moved to. Auto-Scrolls ListViews when dragging above or below them. Easily add and manage ListView Groups. Supports Right-Click drag. Supports Checked ListViews. Supports ListViews with Icons. Customize Auto-Scroll delay, thickness and color of destination bar. Screenshots: Spoiler Notes: They all operate on the active ListView control, like AHK built-in functions. Edit functions can be called directly as easy as ^c::LV_Rows.Copy() (except CopyTo and MoveTo that need to be initialized with a HWND). History and Group functions must be initialized via Handle := New LV_Rows(). To keep original icons you must initialize it passing the ListView's HWND, e.g. Handle := New LV_Rows(Hwnd). The Drag function must be called from the LV G-Label when the Drag event occurs. You can manage multiple listviews with the same Handle. Pass the HWND's in inialization, e.g. Handle := New LV_Rows(Hwnd1, Hwnd2, Hwnd3...) and use SetHwnd() to select them. Use SetHwnd() or InsertHwnd() to add more HWND's to the Handle. Sources, documentation and examples on GitHub Special thanks to Micahs for the base code for the Drag function and to just me for the LV_EX library used for the Group functions. Last edited by Pulover on 17 Mar 2016, 06:19, edited 5 times in total. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top doomboy1000 Posts: 1 Joined: 24 Dec 2013, 19:20 Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 24 Dec 2013, 19:31 Both this code (Dec 24, 2013) and the version hosted on the other forums seem to have some problems for me in AHK_L 1.1.10.01. Specifically, ~Line 188: Code: [Select all] [Download] (Class_LV_Rows.ahk)GeSHi © Codebox Plus , DupRows.Paste(, False) Yields an error about not allowing a blank parameter. Perhaps it should be Code: [Select all] [Download] (Class_LV_Rows.ahk)GeSHi © Codebox Plus , DupRows.Paste("""", False) Then, trying to drag a row yields an error, in which it seems the variable Line_W is never defined; the custom Gui Element ""MarkLine"" is given an unknown parameter ""W H2 Y327 X278 NoActivate"" (notice the W number is blank). I'm not sure where the root of this is happening, though. Thanks for the great class! EDIT: It seems the line Code: [Select all] [Download] (Class_LV_Rows.ahk)GeSHi © Codebox Plus LV_lw := LV_lw * 96 / A_ScreenDPI Is causing a problem because A_ScreenDPI is not defined. Must this be done manually, or is this a feature of a newer AHK_L (or other fork)? Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 24 Dec 2013, 19:42 Hi, Please, update AutoHotkey to the latest version and try it again. Thanks for the feedback. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top hoppfrosch Posts: 197 Joined: 07 Oct 2013, 04:05 GitHub: hoppfrosch Location: Rhine-Maine-Area, Hesse, Germany Contact: Contact hoppfrosch Website Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 24 Apr 2014, 01:01 EDIT: Now it works as expected - strange .... Perhaps web wasn't very responsive at the time the problem occured ... ----------------------- Hmmmmm ... cannot access the code you posted in your initial post. Clicking on buttons ""Spoiler -> SHOW"", an ""EXPAND"" button occurs (which is unfamiliar, as ""expand"" is usually part of the Codebox header...) - clicking on the ""EXPAND"" button nothing happens (it toggles to ""COLLAPSE-Button and vice versa).... What it looks like .... 2014-04-24 07_56_33-[Class] LV_Rows - Copy, Cut, Paste and Drag ListViews • AHKScript.png (8.78 KiB) Viewed 2432 times Top m3user Posts: 71 Joined: 17 Jan 2014, 18:11 Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 04 May 2014, 09:10 Is anything like this available for TreeView? Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 04 May 2014, 09:21 Not yet, AFAIK. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Chef Posts: 50 Joined: 14 Nov 2013, 13:01 Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 20 Jun 2014, 04:01 Any reason why your not using LVM to do all the work? Using built-in functions for listviews makes it impossible to use. Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 20 Jun 2014, 05:06 Chef wrote:Any reason why your not using LVM to do all the work? Yes. I made this class based on functions and routines I had already for my app. It was easier and faster to use built-in functions, since they work pretty well. Chef wrote:Using built-in functions for listviews makes it impossible to use. I don't get your point. I can do everything I need with it. If you want to create a version based on LVM, you're free to do it and post it or link it here, I don't have the time or interest to rebuild the class with it. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top think Posts: 11 Joined: 09 Feb 2014, 05:20 Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 16 Aug 2014, 09:20 Great class, thank you. Would it be possible to drag/drop items between tabs? Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 16 Aug 2014, 09:43 think wrote:Great class, thank you. Would it be possible to drag/drop items between tabs? Thanks. I've tried to do that for PMC but went into many issues... You can try to implement it yourself, I don't think you need to change anything in the class. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top garry Posts: 528 Joined: 22 Dec 2013, 12:50 Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 17 Aug 2014, 02:55 Hello Pulover, works fine Want ask you , how to manage a csv-file = -Delete one/multiple selected row -Modify -Add-New -Move-UP -Move-Down -Search and then delete or modify -DoubleClick > run selected column (example c2) example, see F1 ( csv-file ) ( example reads variable e4x ) Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #NoEnv #SingleInstance, Force #Include,Class_LV_Rows.ahk   SendMode Input                ; Recommended for new scripts due to its superior speed and reliability. SetWorkingDir %A_ScriptDir% SetBatchLines -1    F1=%a_scriptdir%\LV_Test21.txt    e4x=  (Ltrim Join`r`n  Calc;calc.exe  Notepad;notepad.exe  ProgramFiles;%a_programfiles%  )   ifnotexist,%f1%   fileappend,%e4x%,%f1%     Gui,1: Default Gui,1: Font,CDefault,Fixedsys     Menu, EditMenu, Add, Copy`tCtrl+C, Copy Menu, EditMenu, Add, Cut`tCtrl+X, Cut Menu, EditMenu, Add, Paste`tCtrl+V, Paste Menu, EditMenu, Add, Delete`tDelete, Delete Menu, EditMenu, Add Menu, EditMenu, Add, Undo`tCtrl+Z, Undo Menu, EditMenu, Add, Redo`tCtrl+Y, Redo Menu, EditMenu, Add Menu, EditMenu, Add, Move Up`tCtrl+Up, MoveUp Menu, EditMenu, Add, Move Down`tCtrl+Down, MoveDown Menu, MenuBar, Add, Edit, :EditMenu Gui,1: Menu, MenuBar   Gui,1: Add , ListView, AltSubmit vLv1 gLVLabel x10 w320 r8 LV0x10000 backgroundgray +grid ,Name|Fullpath ; Create a handle for the History of first ListView. HistoryLv1 := New LV_Rows() HistoryLv1.Add()   LV_ModifyCol(1,200) LV_ModifyCol(2,300)   gosub,fill Gui,1: Show,x0 y0 h160 w350,TEST return ;--------   Guiclose: exitapp ;--------   fill: Gui,1:submit,nohide ;fileread,e4x,%f1%                ;-  ????  if I read file how to manage ..... Loop, Parse,e4x, `n, `r  {  StringSplit,C, A_LoopField, `;     LV_Add("""",c1,c2)  } return ;--------   ; Context Menu. GuiContextMenu: If !InStr(A_GuiControl, ""LV"")    return Menu, EditMenu, Show, %A_GuiX%, %A_GuiY% return     ; ListViews G-Label. LVLabel: Gui,1: ListView, %A_GuiControl%   ; Sets selected ListView as Default. ActiveList := A_GuiControl        ; Sets a variable to define the active list for History entries.   ; Detect Drag event. If A_GuiEvent = D { LV_Rows.Drag()            ; Call Drag function. History%ActiveList%.Add() ; Add an entry in History. } return   Copy: LV_Rows.Copy()            ; Copy active List selected rows. return   Cut: LV_Rows.Cut()             ; Cut active List selected rows. History%ActiveList%.Add() ; Add an entry in History. return   Paste: If (LV_Rows.Paste())      ; Paste contents from memory. History%ActiveList%.Add() ; Add an entry in History if Paste had data. return   Delete: If (LV_Rows.Delete())     ; Deletes selected rows. History%ActiveList%.Add() ; Add an entry in History if there are rows selected. return   MoveUp: If (LV_Rows.Move(1))      ; Move selected rows up. History%ActiveList%.Add() ; Add an entry in History if there are rows selected. return   MoveDown: If (LV_Rows.Move())        ; Move selected rows down. History%ActiveList%.Add()  ; Add an entry in History if there are rows selected. return   Undo: GuiControl,1: -Redraw, %ActiveList% History%ActiveList%.Undo() ; Go to previous History entry. GuiControl,1: +Redraw, %ActiveList% return   Redo: GuiControl,1: -Redraw, %ActiveList% History%ActiveList%.Redo() ; Go to next History entry. GuiControl,1: +Redraw, %ActiveList% return ;=============================================================   Top think Posts: 11 Joined: 09 Feb 2014, 05:20 Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 10 Sep 2014, 14:58 Hi, I have one more question. In my script I use few ListViews in different tabs so I keep history of each ListView using different handles. Sometimes I move the content of one ListView to another. Is it possible to assign/move the history from one handle to another? Thanks. Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus History1 := New LV_Rows() History1.Add() ; ... History2 := New LV_Rows() History2.Add() ; ... ; how to assign History1 to History2? Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 10 Sep 2014, 16:26 think wrote:Hi, I have one more question. In my script I use few ListViews in different tabs so I keep history of each ListView using different handles. Sometimes I move the content of one ListView to another. Is it possible to assign/move the history from one handle to another? Thanks. Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus History1 := New LV_Rows() History1.Add() ; ... History2 := New LV_Rows() History2.Add() ; ... ; how to assign History1 to History2? Well, you could try History2 := History1. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top think Posts: 11 Joined: 09 Feb 2014, 05:20 Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 12 Sep 2014, 15:19 Of course... It didn't work at first as I had other issues... Thanks. Top highend Posts: 22 Joined: 24 Nov 2014, 16:57 Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 20 Sep 2015, 11:15 Everything works just fine until... I create a new window with e.g. Gui, New, , testwindow right before the Gui, Add, ListView line When I do that, all the context menus stop working (they don't do anything anymore) I can't find out what to change in the code to get it working again *sigh* Any help would be appreciated Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 16 Mar 2016, 19:58 Update: Added support for multiple ListView hwnd's in the same handle. Added ListView Groups functions (thanks to just me).Now you can use the same Handle to manage different ListViews, keeping individual history but sharing copied data. The documentation can be found on GitHub too. All original behavior was kept, so updating shouldn't break any script. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top gr81 Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 16 Mar 2016, 20:39 Your class as is doesn't work on my side, too many errors, I had to go through the old version and change the built-in functions (that I needed) to LVM. You need to get rid of all built-in functions and use LVM instead. Thanks anyway. Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: [Class] LV_Rows - Copy, Cut, Paste and Drag ListViews Report this post Quote 16 Mar 2016, 21:03 gr81 wrote:Your class as is doesn't work on my side, too many errorsWhat errors? gr81 wrote:You need to get rid of all built-in functions and use LVM instead.It works for me so I'm not inclined to change that unless someone shows me a good reason. Feel free to collaborate with the project. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Update v1.1.1 Report this post Quote 29 Apr 2016, 11:11 Update v1.1.1 Fixed collapsed groups expanded after refreshing. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Update v1.1.2 Report this post Quote 09 Jun 2016, 17:58 Update v1.1.2 Removed *CopyTo* and *MoveTo* functions due to bugs with setting target ListView. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 20 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: pondermatic and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by Pulover - Additional functions for AHK ListView controls. Forum thread:"	"true"
"Menu"	"link"	"https://autohotkey.com/boards/viewtopic.php?t=3068"	"by just me - Some functions related to AHK menus. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[Lib] Menu - some functions related to AHK menus - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:27 All times are UTC-05:00 [Lib] Menu - some functions related to AHK menus Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 2 posts • Page 1 of 1 just me Posts: 3046 Joined: 02 Oct 2013, 08:51 Location: Germany [Lib] Menu - some functions related to AHK menus Report this post Quote 27 Mar 2014, 02:13 Just my own attempt to collect some functions which might be useful in relation to AHK menus: Function list Menu_BarHiliteItem() Adds or removes highlighting from an item in a menu bar. Menu_BarRightJustify() Right-justifies the menu item and any subsequent items in a menu bar. Menu_CheckRadioItem() Checks a specified menu item and makes it a radio item. Menu_GetItemCount() Determines the number of items in the specified menu. Menu_GetItemInfo() Retrieves information about a menu item. Menu_GetItemPos() Retrieves the position of the menu item specified by its name in the menu. Menu_GetItemState() Retrieves the state flags associated with the specified menu item. Menu_GetItemName() Retrieves the name (text string) of the specified menu item. Menu_GetMenu() Retrieves a handle to the menu assigned to the specified window. Menu_GetMenuByName() Retrieves a handle to the menu specified by its name. Menu_GetSubMenu() Retrieves a handle to the submenu activated by the specified menu item. Menu_IsItemChecked() Determines whether the specified menu item is checked. Menu_IsSeparator() Determines whether the specified menu item is a separator. Menu_IsSubmenu() Determines whether the specified menu item opens a submenu. Menu_RemoveCheckMarks() Removes the space reserved for check marks from the specified menu. Menu_ShowAligned() Displays a shortcut menu at the specified location using the specified alignment. Sample.ahk: Code: [Select all] [Expand] [Download] (Sample.ahk)GeSHi © Codebox Plus #NoEnv #Include Menu.ahk ; GUI menu Menu, GuiMenu, Add, Menu, ShowMenu Menu, GuiMenu, Add, Quit, GuiClose HGMEN := Menu_GetMenuByName(""GuiMenu"") ; Pop-up menu Menu, ExportMenu, Add, Excel (.csv), Export Menu, ExportMenu, Add Menu, ExportMenu, Add, Excel Direct, Export Menu, ExportMenu, Add Menu, ExportMenu, Add, Access DB, Export HMENU := Menu_GetMenuByName(""ExportMenu"") ; GUI Gui, New, +hwndHGUI Gui, Margin, 100, 20 Gui, Menu, GuiMenu Menu_BarRightJustify(HGUI, 2) Gui, Add, Button, y100 w100 vExportBtn hwndHExportBtn gExportMenu, Button Menu Gui, Show, , Menu MsgBox, 0, ExportMenu, % ""The name of item 3 is:`n`n"" . Menu_GetItemName(HMENU, 3) MsgBox, 0, ExportMenu,% ""Item 2 is"" . (Menu_IsSeparator(HMENU, 2) ? """" : ""n't"" ) . "" a separator!"" Loop, 5 {    Menu_BarHiliteItem(HGUI, 2, True)    Sleep, 250    Menu_BarHiliteItem(HGUI, 2, False)    Sleep, 250 } Return ; ---------------------------------------------------------------------------------------------------------------------- GuiClose: ExitApp ; ---------------------------------------------------------------------------------------------------------------------- ShowMenu:    ; Get the screen coordinates of the GUI's client area    VarSetCapacity(POINT, 8, 0)    DllCall(""User32.dll\ClientToScreen"", ""Ptr"", HGUI, ""Ptr"", &POINT)    X := Numget(POINT, 0, ""Int"")    Y := NumGet(POINT, 4, ""Int"")    ; Show the ExportMenu using X and Y as left and top position.    Menu_ShowAligned(HMENU, HGUI, X, Y, ""Left"", ""Top"") Return ; ---------------------------------------------------------------------------------------------------------------------- ExportMenu:    ; Get the position of the Export button 	WinGetPos, X, Y, W, H, ahk_id %HExportBtn%    X += W // 2    ; Show the ExportMenu using X and Y as horizontal center and bottom position.    Menu_ShowAligned(HMENU, HGUI, X, Y, ""Center"", ""Bottom"") Return ; ---------------------------------------------------------------------------------------------------------------------- Export:    Menu_CheckRadioItem(HMENU, A_ThisMenuItemPos)    MsgBox, 0, %A_ThisLabel%          , % A_ThisMenuItem . "" is now "" . (Menu_IsItemChecked(HMENU, A_ThisMenuItemPos) ? """" : ""un"") . ""checked!"" Return Menu.ahk: Code: [Select all] [Expand] [Download] (Menu.ahk)GeSHi © Codebox Plus ; ====================================================================================================================== ; Namespace:      Menu ; Function:       Some functions related to AHK menus. ; Tested with:    AHK 1.1.14.03 ; Tested on:      Win 8.1 Pro (x64) ; Changelog: ;     1.0.00.00/2014-03-26/just me - initial release ; General function parameters (not mentioned in the parameter description of functions): ;     HMENU       -  Handle to a menu or a menu bar. ;     ItemPos     -  1-based position of the menu item in the menu. ;     ItemName    -  Name (text string) of the menu item. ;     HWND        -  Handle to the window the menu is / will be assigned to. ; Credits: ;     Lexikos for MI.ahk (www.autohotkey.com/board/topic/20253-menu-icons-v2/) adopted in Menu_GetMenuByName(). ; ====================================================================================================================== ; BarHiliteItem   Adds or removes highlighting from an item in a menu bar. ; Parameters:     Hilite   -  Highlight the menu item (True / False). ;                             Default: True. ; Return values:  If the function succeeds, the return value is nonzero; otherwise, it is zero (False). ; ====================================================================================================================== Menu_BarHiliteItem(HWND, ItemPos, Hilite := True) {    ; http://msdn.microsoft.com/en-us/library/ms647986(v=vs.85).aspx    If (HMENU := Menu_GetMenu(HWND)) {       Flags := 0x0400 | (Hilite ? 0x80 : 0x00)       Return DllCall(""User32.dll\HiliteMenuItem"", ""Ptr"", HWND, ""Ptr"", HMENU, ""UInt"", ItemPos - 1, ""UInt"", Flags, ""UInt"")    }    Return False } ; ====================================================================================================================== ; BarRightJustify Right-justifies the menu item and any subsequent items in a menu bar. ; Return values:  If the function succeeds, the return value is nonzero; otherwise, it is zero (False). ; ====================================================================================================================== Menu_BarRightJustify(HWND, ItemPos) {    ; http://msdn.microsoft.com/en-us/library/ms648001(v=vs.85).aspx    Static MIIsize := (4 * 6) + (A_PtrSize * 6) + ((A_PtrSize - 4) * 2)    If (HMENU := Menu_GetMenu(HWND)) {       VarSetCapacity(MII, MIIsize, 0)              ; MENUITEMINFO structure       NumPut(MIIsize, MII, 0, ""UInt"")              ; cbSize       NumPut(0x0100, MII, 4, ""UInt"")               ; fMask: MIIM_FTYPE = 0x0100       If DllCall(""User32.dll\GetMenuItemInfo"", ""Ptr"", HMENU, ""UInt"", ItemPos - 1, ""UInt"", 1, ""Ptr"", &MII, ""UInt"") {          NumPut(NumGet(MII, 8, ""UInt"") | 0x4000, MII, 8, ""UInt"") ; fType: MFT_RIGHTJUSTIFY = 0x4000          RC := DllCall(""User32.dll\SetMenuItemInfo"", ""Ptr"", HMENU, ""UInt"", ItemPos - 1, ""UInt"", 1, ""Ptr"", &MII, ""UInt"")          DllCall(""User32.dll\DrawMenuBar"", ""Ptr"", HWND, ""UInt"")          Return RC       }    }    Return False } ; ====================================================================================================================== ; CheckRadioItem  Checks a specified menu item and makes it a radio item. At the same time, the function clears ;                 all other menu items in the associated group and clears the radio-item type flag for those items. ; Parameters:     First -  The 1-based position of the first menu item in the group. ;                          Default: 1 = first menu item. ;                 Last  -  The 1-based position of the last menu item in the group. ;                          Default: 0 = last menu item. ; Return values:  If the function succeeds, the return value is nonzero; otherwise, it is zero (False). ; ====================================================================================================================== Menu_CheckRadioItem(HMENU, ItemPos, First := 1, Last := 0) {    ; http://msdn.microsoft.com/en-us/library/ms647621(v=vs.85).aspx    If (Last < 1)       Last := Menu_GetItemCount(HMENU)    Return DllCall(""User32.dll\CheckMenuRadioItem"", ""Ptr"", HMENU, ""UInt"", First - 1, ""UInt"", Last - 1                                                  , ""UInt"", ItemPos - 1, ""UInt"", 0x0400, ""UInt"") } ; ====================================================================================================================== ; GetItemCount    Determines the number of items in the specified menu. ; Return values:  If the function succeeds, the return value specifies the number of items in the menu. ;                 If the function fails, the return value is -1 ; ====================================================================================================================== Menu_GetItemCount(HMENU) {    ; http://msdn.microsoft.com/en-us/library/ms647978(v=vs.85).aspx    Return DllCall(""User32.dll\GetMenuItemCount"", ""Ptr"", HMENU, ""Int"") } ; ====================================================================================================================== ; GetItemInfo     Retrieves information about a menu item. ; Return values:  If the function succeeds, the return value is an object containing the following keys: ;                       Type     -  The menu item type flags. ;                       State    -  The menu item state flags. ;                       ID       -  The application-defined value that identifies the menu item. ;                       HMENU    -  The handle to the submenu associated with the menu item, if exist. ;                       Name     -  The menu item text string , if any. ;                       HBITMAP  -  The handle to the bitmap to be displayed, if any. ;                 If the function fails, the return value is zero (False). ; ====================================================================================================================== Menu_GetItemInfo(HMENU, ItemPos) {    ; http://msdn.microsoft.com/en-us/library/ms647980(v=vs.85).aspx    Static MIIsize := (4 * 6) + (A_PtrSize * 6) + ((A_PtrSize - 4) * 2)    Static MIIoffs := (A_PtrSize = 8) ? {Type: 8, State: 12, ID: 16, HMENU: 24, String: 56, cch: 64, HBITMAP: 72}                                      : {Type: 8, State: 12, ID: 16, HMENU: 20, String: 36, cch: 40, HBITMAP: 44}    VarSetCapacity(MII, MIIsize, 0)              ; MENUITEMINFO structure    NumPut(MIIsize, MII, 0, ""UInt"")              ; cbSize    NumPut(0x1EF, MII, 4, ""UInt"")                ; fMask    VarSetCapacity(String, 1024, 0)    NumPut(&String, MII, MIIoffs.String, ""UPtr"") ; dwTypeData    NumPut(512, MII, MIIoffs.cch, ""UInt"")        ; cch    If DllCall(""User32.dll\GetMenuItemInfo"", ""Ptr"", HMENU, ""UInt"", ItemPos - 1, ""UInt"", 1, ""Ptr"", &MII, ""UInt"")       Return {Type: NumGet(MII, MIIoffs.Type, ""UInt"")             , State: NumGet(MII, MIIoffs.State, ""UInt"")             , ID: NumGet(MII, MIIoffs.ID, ""UInt"")             , HMENU: NumGet(MII, MIIoffs.HMENU, ""UPtr"")             , Name: StrGet(&String, NumGet(MII, MIIoffs.cch, ""UInt""))             , HBITMAP: NumGet(MII, MIIoffs.HBITMAP, ""UPtr"")}    Return False } ; ====================================================================================================================== ; GetItemPos      Retrieves the position of the menu item specified by its name in the menu. ; Return values:  If the function succeeds, the return value is the 1-based position of the menu item. ;                 If the function fails, the return value is zero (False). ; ====================================================================================================================== Menu_GetItemPos(HMENU, ItemName) {    Loop, % Menu_GetItemCount(HMENU)       If (ItemName = Menu_GetItemName(HMENU, A_Index))          Return A_Index    Return False } ; ====================================================================================================================== ; GetItemState    Retrieves the state flags associated with the specified menu item. ; Return values:  If the specified item does not exist, the return value is -1. ;                 If the menu item opens a submenu, the low-order byte of the return value contains the menu flags, ;                 and the high-order byte contains the number of items in the submenu. ;                 Otherwise, the return value is a mask (Bitwise OR) of the menu flags. ; ====================================================================================================================== Menu_GetItemState(HMENU, ItemPos) {    ; http://msdn.microsoft.com/en-us/library/ms647982(v=vs.85).aspx    Return DllCall(""User32.dll\GetMenuState"", ""Ptr"", HMENU, ""UInt"", ItemPos - 1, ""UInt"", 0x0400, ""UInt"") } ; ====================================================================================================================== ; GetItemName     Retrieves the name (text string) of the specified menu item. ; Return values:  If the function succeeds, the return value is the text string of the specified menu item. ;                 Otherwise, the return value is an empty string. ; ====================================================================================================================== Menu_GetItemName(HMENU, ItemPos) {    ; http://msdn.microsoft.com/en-us/library/ms647983(v=vs.85).aspx    VarSetCapacity(Str, 1024, 0) ; should be sufficient    If DllCall(""User32.dll\GetMenuString"", ""Ptr"", HMENU, ""UInt"", ItemPos - 1, ""Str"", Str, ""Int"", 512                                         , ""UInt"", 0x0400, ""Int"")       Return Str    Return """" } ; ====================================================================================================================== ; GetMenu         Retrieves a handle to the menu assigned to the specified window. ; Return values:  The return value is a handle to the menu. ;                 If the specified window has no menu, the return value is NULL. ;                 If the window is a child window, the return value is undefined. ; ====================================================================================================================== Menu_GetMenu(HWND) {    ; http://msdn.microsoft.com/en-us/library/ms647640(v=vs.85).aspx    Return DllCall(""User32.dll\GetMenu"", ""Ptr"", HWND, ""Ptr"") } ; ====================================================================================================================== ; GetMenuByName   Retrieves a handle to the menu specified by its name. ; Return values:  If the function succeeds, the return value is a handle to the menu. ;                 Otherwise, the return value is zero (False). ; Remarks:        Based on MI.ahk by Lexikos -> http://www.autohotkey.com/board/topic/20253-menu-icons-v2/ ; ====================================================================================================================== Menu_GetMenuByName(MenuName) {    Static HMENU := 0    If !(HMENU) {       Menu, %A_ThisFunc%Menu, Add       Menu, %A_ThisFunc%Menu, DeleteAll       Gui, %A_ThisFunc%GUI:+HwndHGUI       Gui, %A_ThisFunc%GUI:Menu, %A_ThisFunc%Menu       HMENU := Menu_GetMenu(HGUI)       Gui, %A_ThisFunc%GUI:Menu       Gui, %A_ThisFunc%GUI:Destroy    }    If !(HMENU)       Return 0    Menu, %A_ThisFunc%Menu, Add, :%MenuName%    HSUBM := Menu_GetSubMenu(HMENU, 1)    Menu, %A_ThisFunc%Menu, Delete, :%MenuName%    Return HSUBM } ; ====================================================================================================================== ; GetSubMenu      Retrieves a handle to the submenu activated by the specified menu item. ; Return values:  If the function succeeds, the return value is a handle to the submenu activated by the menu item. ;                 If the menu item does not activate a submenu, the return value is zero (False). ; ====================================================================================================================== Menu_GetSubMenu(HMENU, ItemPos) {    ; http://msdn.microsoft.com/en-us/library/ms647984(v=vs.85).aspx    Return DllCall(""User32.dll\GetSubMenu"", ""Ptr"", HMENU, ""Int"", ItemPos - 1, ""Ptr"") } ; ====================================================================================================================== ; IsItemChecked   Determines whether the specified menu item is checked. ; Return values:  If the function succeeds, the return value is nonzero; otherwise, it is zero (False). ; ====================================================================================================================== Menu_IsItemChecked(HMENU, ItemPos) {    Return (Menu_GetItemState(HMENU, ItemPos) & 0x08) ; MF_CHECKED = 0x00000008 } ; ====================================================================================================================== ; IsSeparator     Determines whether the specified menu item  is a separator. ; Return values:  If the function succeeds, the return value is nonzero; otherwise, it is zero (False). ; ====================================================================================================================== Menu_IsSeparator(HMENU, ItemPos) {    Return (Menu_GetItemInfo(HMENU, ItemPos).Type & 0x0800) ; MFT_SEPARATOR = 0x00000800 } ; ====================================================================================================================== ; IsSubmenu       Determines whether the specified menu item opens a submenu. ; Return values:  If the function succeeds, the return value is a handle to the submenu; otherwise, it is zero (False). ; ====================================================================================================================== Menu_IsSubmenu(HMENU, ItemPos) {    Return Menu_GetItemInfo(HMENU, ItemPos).HMENU } ; ====================================================================================================================== ; RemoveCheckMarks Removes the space reserved for check marks from the specified menu. ; Parameters:     ApplyToSubMenus   -  Settings apply to the menu and all of its submenus (True / False). ;                                      Default: True. ; Return value:   Always True. ; ====================================================================================================================== Menu_RemoveCheckMarks(HMENU, ApplyToSubMenus := True) {    ; http://msdn.microsoft.com/en-us/library/ff468864(v=vs.85).aspx    Static MIsize := (4 * 4) + (A_PtrSize * 3)    VarSetCapacity(MI, MIsize, 0)    NumPut(MIsize, MI, 0, ""UInt"")    NumPut(0x00000010, MI, 4, ""UInt"") ; MIM_STYLE = 0x00000010    DllCall(""User32.dll\GetMenuInfo"", ""Ptr"", HMENU, ""Ptr"", &MI, ""UInt"")    If (ApplyToSubMenus)       NumPut(0x80000010, MI, 4, ""UInt"") ; MIM_APPLYTOSUBMENUS = 0x80000000 | MIM_STYLE = 0x00000010    NumPut(NumGet(MI, 8, ""UINT"") | 0x80000000, MI, 8, ""UInt"") ; MNS_NOCHECK = 0x80000000    DllCall(""User32.dll\SetMenuInfo"", ""Ptr"", HMENU, ""Ptr"", &MI, ""UInt"")    Return True } ; ====================================================================================================================== ; ShowAligned     Displays a shortcut menu at the specified location using the specified alignment. ; Parameters:     X     -  The horizontal location of the shortcut menu, in screen coordinates. ;                 Y     -  The vertical location of the shortcut menu, in screen coordinates. ;                 Align -  Array containing one or a more of the keys defined in 'Alignment'. ; Return values:  If the function succeeds, the return value is nonzero; otherwise, it is zero (False). ; ====================================================================================================================== Menu_ShowAligned(HMENU, HWND, X, Y, XAlign, YAlign) {    ; http://msdn.microsoft.com/en-us/library/ms648002(v=vs.85).aspx    Static XA := {0: 0, 4: 4, 8: 8, LEFT: 0x00, CENTER: 0x04, RIGHT: 0x08}    Static YA := {0: 0, 16: 16, 32: 32, TOP: 0x00, VCENTER: 0x10, BOTTOM: 0x20}    If !XA.HasKey(XAlign) || !YA.HasKey(YAlign)       Return False    Flags := XA[XAlign] | YA[YAlign]    Return DllCall(""User32.dll\TrackPopupMenu"", ""Ptr"", HMENU, ""UInt"", Flags, ""Int"", X, ""Int"", Y, ""Int"", 0, ""Ptr"", HWND                                              , ""Ptr"", 0, ""UInt"") } ; ====================================================================================================================== Except as noted otherwise all of my code is tested on Win 10 Pro (x64) using the current AHK version. Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: [Lib] Menu - some functions related to AHK menus Report this post Quote 28 Mar 2014, 10:42 very nice. test and works as expected. es einen Mangel von Skripts vor kurzem! Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 2 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: pondermatic and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by just me - Some functions related to AHK menus. Forum thread:"	"true"
"Hotkeys"	"CHotkeyControl"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=9087"	"by evilC - Replacement for AHK hotkey GuiControl that supports mouse buttons etc (Partially mature)."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"CHotkeyControl - a replacement for AHK's Hotkey GuiControl - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:27 All times are UTC-05:00 CHotkeyControl - a replacement for AHK's Hotkey GuiControl Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 13 posts • Page 1 of 1 evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 CHotkeyControl - a replacement for AHK's Hotkey GuiControl Report this post Quote 02 Aug 2015, 17:59 CHotkeyControl aims to provide a feature-rich replacement for AHK's Hotkey GuiControl that is capable of recognizing any binding that AHK's hotkey system supports - with options for setting pass-through (~), Wild (*) etc. It uses SetWindowsHookEx DLL calls to simultaneously read and block input from being seen by other apps. It is currently a work in progress, but the basics are operational. GitHub page Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: CHotkeyControl - a replacement for AHK's Hotkey GuiControl Report this post Quote 03 Aug 2015, 18:11 Massive update - loads of fixes and optimizations. I think it is now pretty much ready for use, gonna start trying to use it in some of my projects. GitHub page Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: CHotkeyControl - a replacement for AHK's Hotkey GuiControl Report this post Quote 04 Aug 2015, 14:43 We made a major usability improvement. The control is now a ComboBox, and we use a ""Cue Banner"" to display the currently selected hotkey. GitHub page Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: CHotkeyControl - a replacement for AHK's Hotkey GuiControl Report this post Quote 05 Aug 2015, 10:05 Another major change - bind mode now only ends on an up event. Although slightly less user-friendly, it does make the whole thing a lot simpler, and open some doors. For example, if you end bind mode on the down event, and bind the hotkey at that point, when the user releases the key, the up event for that hotkey will be fired. You don't seem to be able to do a GetKeyState loop to wait for the key just bound to be released however, I guess because we are hooking and blocking the keys, so AHK didn't see the key go down. Also we cannot end bind mode on the down event of a non-modifier if we wish to support hotkeys such as a + b GitHub page Top KuroiLight Posts: 112 Joined: 12 Apr 2015, 20:24 GitHub: KuroiLight Re: CHotkeyControl - a replacement for AHK's Hotkey GuiControl Report this post Quote 07 Aug 2015, 18:04 Finally got around to testing it. Works and its close to what I had in mind. If you dont want to block input globally you can instead add Code: [Select all] [Download] GeSHi © Codebox Plus OnMessage(0x100, ""BlockDing"") BlockDing() {     if(A_Gui == YourGuiId)         return 1 } to avoid the ding windows does. Windows 10, i5-6600k (4.5GHz), 16GB G.Skill DDR4, 2GB R9 270x | [MyScripts][MySublimeSettings] [Unlicense][MIT License] Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: CHotkeyControl - a replacement for AHK's Hotkey GuiControl Report this post Quote 08 Aug 2015, 05:20 Hmm, interesting idea. My original forays into SetWindowsHookEx were a result of trying to re-write AHK's hotkey system, so for that I needed global hooks. But I suppose for the bind routine, then yeah, you only need to hook inside the application. Also, new version uploaded - now has basic support for Joystick buttons. GitHub page Top KuroiLight Posts: 112 Joined: 12 Apr 2015, 20:24 GitHub: KuroiLight Re: CHotkeyControl - a replacement for AHK's Hotkey GuiControl Report this post Quote 08 Aug 2015, 19:27 What I meant was that you can keep you global hook but instead of returning 1 (and blocking all user input) you can add that code and windows wont ding while keys are being pressed inside the window. Windows 10, i5-6600k (4.5GHz), 16GB G.Skill DDR4, 2GB R9 270x | [MyScripts][MySublimeSettings] [Unlicense][MIT License] Top titep Posts: 20 Joined: 14 Nov 2015, 09:01 Re: CHotkeyControl - a replacement for AHK's Hotkey GuiControl Report this post Quote 03 Dec 2015, 07:11 It works great, but when I embed the code of CHotkeyControl into my .ahk file, CHotkey make Morse() goes wrong. For example, when I hit my key binding three times (captured with Morse()), its return to 000 and 0 instead of 000 only. @@ What happened? Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: CHotkeyControl - a replacement for AHK's Hotkey GuiControl Report this post Quote 03 Dec 2015, 08:03 Morse() works with AHK hotkeys. CHotkeyControl does not use AHK's hotkey system *at all*, it is entirely reliant on low-level windows hooks. Therefore CHotkeyControl is totally incompatible with Morse() GitHub page Top titep Posts: 20 Joined: 14 Nov 2015, 09:01 Re: CHotkeyControl - a replacement for AHK's Hotkey GuiControl Report this post Quote 04 Dec 2015, 03:51 @evilC : Thank you, I am just trying to capture word I type like Typing Aid. I use input and loop function to capture letter by letter and then combine them into word. When I type fast, my ahk works unrealiably. That's why I came to CHotkeycontrol ಠ_ಠ Maybe I will try another way... Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: CHotkeyControl - a replacement for AHK's Hotkey GuiControl Report this post Quote 04 Dec 2015, 07:42 I have pretty much abandoned the low-level hook technique (as used in CHotkeyControl) now, because the application becomes un-debuggable while the hooks are running (key / mouse stops working so you can't step through). So instead I just map a hotkey to every key on the keyboard, like this: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus 	CreateHotkeys(){ 		static pfx := ""$*"" 		critical on 		; Cycle through all keys / mouse buttons 		Loop 256 { 			; Get the key name 			i := A_Index 			code := Format(""{:x}"", A_Index) 			n := GetKeyName(""vk"" code) 			if (n = """") 				continue 			fn := this.KeyPressed.Bind(this, n) 			hotkey, % pfx ""~"" n, % fn, % ""On"" 		} 		critical off 	}   	KeyPressed(n){ 		; key went down - caveat: may be a repeat though if key is held 		; n holds the name of the key 	}   GitHub page Top KuroiLight Posts: 112 Joined: 12 Apr 2015, 20:24 GitHub: KuroiLight Re: CHotkeyControl - a replacement for AHK's Hotkey GuiControl Report this post Quote 04 Dec 2015, 19:10 Might I ask what debugger you're using? I haven't been using one thus far. Windows 10, i5-6600k (4.5GHz), 16GB G.Skill DDR4, 2GB R9 270x | [MyScripts][MySublimeSettings] [Unlicense][MIT License] Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: CHotkeyControl - a replacement for AHK's Hotkey GuiControl Report this post Quote 05 Dec 2015, 08:49 Scite4Autohotkey GitHub page Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 13 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: pondermatic and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by evilC - Replacement for AHK hotkey GuiControl that supports mouse buttons etc (Partially mature)."	"true"
"Hotkeys"	"HParse"	"https://autohotkey.com/board/topic/92805-"	"by Avi - Function to convert meaningful shortcuts (Ctrl+X) to AutoHotkey syntax (^x)."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"47"	"8"	"19"	"GitHub - aviaryan/autohotkey-scripts: A collection of Autohotkey scripts and functions authored by me (Avi Aryan). Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 8 Star 47 Fork 19 aviaryan/autohotkey-scripts Code Issues 0 Pull requests 0 Pulse Graphs 👌 A collection of Autohotkey scripts and functions authored by me (Avi Aryan). http://aviaryan.in/ahk/ 132 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit 4abad9e Mar 9, 2016 aviaryan Merge pull request #4 from D4D3VD4V3/patch-1 … Indented and more in DayofDate.ahk Permalink Failed to load latest commit information. Example_files Functions Others Tools NOTICE.txt README.md README.md Avi's Autohotkey Scripts and Functions Repository See my AHK script listing Copyright 2014 Avi Aryan    Licensed under the Apache License, Version 2.0 (the ""License"");   you may not use this file except in compliance with the License.   You may obtain a copy of the License at    http://www.apache.org/licenses/LICENSE-2.0    Unless required by applicable law or agreed to in writing, software   distributed under the License is distributed on an ""AS IS"" BASIS,   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.   See the License for the specific language governing permissions and   limitations under the License.    Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/aviaryan/autohotkey-scripts"	"by Avi - Function to convert meaningful shortcuts (Ctrl+X) to AutoHotkey syntax (^x)."	"true"
"Joystick"	"CvJoyInterface"	"https://autohotkey.com/boards/viewtopic.php?t=5705"	"by evilC - Control a vJoy virtual joystick using AHK."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"CvJoyInterface - A new, class based vJoy library - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:27 All times are UTC-05:00 CvJoyInterface - A new, class based vJoy library Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 9 posts • Page 1 of 1 evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 CvJoyInterface - A new, class based vJoy library Report this post Quote 24 Dec 2014, 13:49 I have used and maintained Axlar's vJoy interface for many years now in my projects, and it has stood the test of time well, but I felt that it was a little difficult to use for less experienced coders, polluted the global namespace too much etc, and had a number of other niggles, so I thought I would re-write it. CvJoyInterface is designed to make it easy for anyone to operate virtual sticks - for example, in it's simplest use-case, you do not even need to Acquire() the stick, CvJoyInterface will do it automatically for you: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus #SingleInstance, force #include CvJoyInterface.ahk ;#include <CvJoyInterface>   ; Create an object from vJoy Interface Class. vJoyInterface := new CvJoyInterface()   ; Was vJoy installed and the DLL Loaded? if (!vJoyInterface.vJoyEnabled()){ 	; Show log of what happened 	Msgbox % vJoyInterface.LoadLibraryLog 	ExitApp }   myStick := vJoyInterface.Devices[1]   ; End Startup Sequence Return   ; Hotkeys F10:: 	; On press of F10 try and press button 1 	myStick.SetBtn(1,1) 	Return   F10 up:: 	; On release of F10, release button 1 	myStick.SetBtn(0,1) 	Return   ; Hotkeys F11:: 	; Refer to the stick by name, move it to 0% 	myStick.SetAxisByName(0,""x"") 	SoundBeep 	return   F12:: 	; Refer to the stick by index (axis number), move it to 100% (32768) 	myStick.SetAxisByIndex(vJoyInterface.PercentTovJoy(100),1) 	SoundBeep 	return   Github Page (Download) Top matt Posts: 2 Joined: 09 May 2016, 13:50 Re: CvJoyInterface - A new, class based vJoy library Report this post Quote 10 May 2016, 09:01 Hey there, I don't know if this is the place to discuss about it but I just found your library and can't thank you enough for your work. It allowed me to finally work out a solution to get throttle control on keyboard in GTA V, through AHK, vjoy and x360ce — sounds cumbersome, but it actually works very well thanks to CvJoyInterface. So, thanks alot for this! I am surprised that there is no answer to this thread by the way. Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: CvJoyInterface - A new, class based vJoy library Report this post Quote 10 May 2016, 12:55 Yep, this is the right place I think that the main reason there are so few replies is that people wanting to use AHK to control vJoy tend to use one of my GUI applications that achieves the same result without them needing to learn how to code in AHK. See the UCR thread. By the way, there is a new version of vJoy coming that is able to create virtual XBox controllers. Dunno if that will simplify your tool chain any, but maybe not. What are you using for input, a real XBox controller? The new XBox version of vJoy will probably only help when you are not using a physical XBox controller. GitHub page Top matt Posts: 2 Joined: 09 May 2016, 13:50 Re: CvJoyInterface - A new, class based vJoy library Report this post Quote 11 May 2016, 14:24 Well, I don't really know how to code in AHK either, but with a bit of searching and experiments I managed to get what I needed. I'll have a look at UCR, maybe it will be more interesting that what I currently have, thanks for the link! I use both the keyboard and a 360 controller when playing, so yeah, the xinput version of vjoy won't be helpful to me, but I can see it gathering lots of interest. Top kjyek Posts: 7 Joined: 01 Jun 2016, 19:56 Re: CvJoyInterface - A new, class based vJoy library Report this post Quote 01 Jun 2016, 22:17 How do I do something as simple as with vJoy? I can't figure it out. Code: [Select all] [Download] GeSHi © Codebox Plus a::joy5 Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: CvJoyInterface - A new, class based vJoy library Report this post Quote 02 Jun 2016, 05:33 You cannot use syntax like that to control joysticks, that is why I wrote this library. To make a operate vjoy button 5, download CvJoyInterface.ahk, and put this ahk script in the same folder as it. Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus #SingleInstance, force #include CvJoyInterface.ahk ;#include <CvJoyInterface>   ; Create an object from vJoy Interface Class. vJoyInterface := new CvJoyInterface()   ; Was vJoy installed and the DLL Loaded? if (!vJoyInterface.vJoyEnabled()){ 	; Show log of what happened 	Msgbox % vJoyInterface.LoadLibraryLog 	ExitApp }   myStick := vJoyInterface.Devices[1]   ; End Startup Sequence Return   ; Hotkeys a:: 	; On press of a, press button 5 	myStick.SetBtn(1,5) 	Return   a up:: 	; On release of a, release button 5 	myStick.SetBtn(0,5) 	Return   GitHub page Top kjyek Posts: 7 Joined: 01 Jun 2016, 19:56 Re: CvJoyInterface - A new, class based vJoy library Report this post Quote 02 Jun 2016, 10:09 Thanks man. The issue was my script wasn't in the same directory as CvJoyinterface.ahk I didn't think that necessary since I have it in /lib folder. Top kjyek Posts: 7 Joined: 01 Jun 2016, 19:56 Re: CvJoyInterface - A new, class based vJoy library Report this post Quote 02 Jun 2016, 10:37 Couple questions if you don't mind. Can this be used to temporarily block POV input or is BlockInput still necessary? I know the syntax here is wrong, but what would your vJoy implementation be for something like this?: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus a:: GetKeyState, POV, JoyPOV if POV = 27000 { ;Block POV input if possible myStick.SetBtn(1,5) Sleep, 10 myStick.SetBtn(0,5) Sleep, 10 POV DOWN ; or whatever the syntax is for vJoy Sleep, 10 POV DOWN Release ;  or whatever the syntax is for vJoy ;Unblock Pov input if possible } Return   Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: CvJoyInterface - A new, class based vJoy library Report this post Quote 02 Jun 2016, 16:08 Thanks man. The issue was my script wasn't in the same directory as CvJoyinterface.ahk If you have CvJoyInterface.ahk in the lib folder, then replace #include CvJoyInterface.ahk with #include <CvJoyInterface> Can this be used to temporarily block POV input or is BlockInput still necessary? Using AHK, you cannot *in any way* alter how applications see a physical joystick, like you can for keyboard and mouse. BlockInput has absolutely no effect on joysticks. If you want to remap stuff without having to learn to code, see my UCR app. That has a GUI that will allow you to remap stuff to a vJoy stick. GitHub page Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 9 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: pondermatic and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by evilC - Control a vJoy virtual joystick using AHK."	"true"
"Joystick"	"XInput"	"https://autohotkey.com/board/topic/35848-xinput-xbox-360-controller-api/"	"by Lexikos - Read XBOX gamepads using XInput (Only way to independently read L/R triggers), control rumble motors."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"XInput - Xbox 360 Controller API - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. XInput - Xbox 360 Controller API Started by Lexikos , Dec 21 2008 01:28 PM Page 1 of 4 1 2 3 Next » Please log in to reply 57 replies to this topic Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 XInput XInput.ahk wraps a few key functions of XInput, a.k.a. the Microsoft Common Controller API. It provides the following capabilities not otherwise accessible to scripts: The official drivers report to Windows one axis for both analog triggers, making it impossible to detect when both triggers are pulled at once. XInput allows one to retrieve the state of each analog trigger individually. Set level of controller vibration - left and right motor speeds. Other capabilities of the XInput API that this script does not currently support include: Detect input on attached messenger kits (mini keyboards which can be attached to a controller). Retrieve battery levels of wireless controllers. Access the audio input/output of a given controller's headset. Required: xinput1_3.dll This should be included in recent DirectX run-times. Usage notes for each function are included in XInput.ahk. XInput.ahk for AutoHotkey 1.1 This version uses objects, so AutoHotkey 1.1 (AutoHotkey_L) is required. ; Example: Control the vibration motors using the analog triggers of each controller. XInput_Init() Loop {     Loop, 4 {         if State := XInput_GetState(A_Index-1) {             LT := State.bLeftTrigger             RT := State.bRightTrigger             XInput_SetState(A_Index-1, LT*257, RT*257)         }     }     Sleep, 100 } XInput.ahk for AutoHotkey 1.0 This version uses JSON strings, and should work on any version of AutoHotkey. The example below requires json(). ; Example: Control the vibration motors using the analog triggers of each controller. XInput_Init() Loop {     Loop, 4 {         if XInput_GetState(A_Index-1, State)=0 {             LT := json(State,""bLeftTrigger"")             RT := json(State,""bRightTrigger"")             XInput_SetState(A_Index-1, LT*257, RT*257)         }     }     Sleep, 100 } XInput.ahk is basically public domain. #1 - Posted 21 December 2008 - 01:28 PM Back to top Frankie Members 2930 posts Last active: Feb 05 2015 02:49 PM Joined: 02 Nov 2008 Im getting a wireless adapter for the XBox 360 controller sometime soon. Is there any reason it won't work with wireless? #2 - Posted 24 December 2008 - 07:51 PM aboutscript ⋰ apps ⋱ scripts Request Video Tutorials Here or View Current Tutorials on YouTube Any code ⇈ above ⇈ requires AutoHotkey_L to run Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 I originally tested the script with one wireless controller. After your post, I also connected a wired controller - the script worked correctly with both controllers connected. It's easy to identify the index of a controller as it directly relates to the lit quadrant on the guide button. #3 - Posted 25 December 2008 - 09:55 AM Back to top Guests Last active: Joined: -- hi, is there anybody still working on it? would love to have the abbility to connect a xbox 360 controller wth my pc and use the chatpad and output sound to headset #4 - Posted 29 May 2009 - 03:24 PM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 I doubt it. I don't own a chatpad. #5 - Posted 29 May 2009 - 03:49 PM Back to top mtgtopdeck Members 17 posts Last active: Nov 01 2010 10:03 PM Joined: 25 Mar 2009 There is a community of xbox users that might find this very useful. If you get the time could you post about this script on the forums at xim360.com? thank you #6 - Posted 29 May 2009 - 06:26 PM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 I'm not familiar with that community, where or what to post. Perhaps you'd better do it? #7 - Posted 30 May 2009 - 05:23 AM Back to top TheLeO Members 264 posts Last active: Jan 02 2012 01:51 AM Joined: 11 Jun 2005 Thank you so much for this, I've been trying to figure out how to make xinput work with ahk for quite a while. BTW, is there anyway to determine if the user presses the big ""X"" button on the controller? (or taps it)// thanks again, I'll be testing it .. #8 - Posted 19 June 2009 - 04:10 PM :: I Have Spoken :: Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 I'm not aware of any way. #9 - Posted 19 June 2009 - 07:07 PM Back to top constell Guests Last active: Joined: -- For some reason, this doesn't work for me. Running the xinput.ahk file with the dll in the same directory. It just shows the tray icon for a split second then quits with no error message. What's up? #10 - Posted 12 October 2009 - 02:56 AM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 XInput.ahk doesn't do anything on its own; it's a library of functions for use in other scripts such as the example in my first post. #11 - Posted 12 October 2009 - 07:38 AM Back to top constell Guests Last active: Joined: -- Ah, thanks for that. Sorry for bumping a pretty old post. Anyway, my original intention was to somehow find a way to overcome the current limitation of the 360 driver to detect when both triggers are pressed at once. Looks like it isn't actually a limitation considering Xinput can actually detect when both triggers are pressed. There's a game that I wanna play that has moves where you have to press both triggers at once. I can download a 3rd party driver, but that would affect games that detect Xinput devices (GRiD, GTA4) and I prefer to still have that. What's the simplest way I can do that? I'm thinking of maybe scripting something like joy2key, where it maps the controller input to the keyboard, hopefully being able to detect both triggers pressed at once. Then passing that onto the game. Problem is, I don't know anything about AutoHotKey scripting. I can learn, though. Anyway, is there an easier way you can think of other than this? #12 - Posted 12 October 2009 - 08:05 AM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 That limitation is the main reason I wrote XInput.ahk. If the game supports mixing keyboard and game controller input, you may use this to remap just the triggers: ; ~ Config:  ; Minimum to be considered ""pressed"", between 1 (0.39%) and 255 (100%). Threshold = 64  ; Keys to bind to triggers. LT_Key = [ RT_Key = ]  ; ~  LastRT := LastLT := 0 XInput_Init() Loop {     Loop, 4 {         if XInput_GetState(A_Index-1, State)=0 {             LT := json(State,""bLeftTrigger"") >= Threshold             RT := json(State,""bRightTrigger"") >= Threshold             if (LT != LastLT) {                 Send % ""{"" . LT_Key . (LT ? "" Down}"" : "" Up}"")                 LastLT := LT             }             if (RT != LastRT) {                 Send % ""{"" . RT_Key . (RT ? "" Down}"" : "" Up}"")                 LastRT := RT             }         }     }     Sleep, 100 }If you need to remap other buttons/axes, the methods outlined here may be sufficient. #13 - Posted 12 October 2009 - 08:49 AM Back to top Matze Guests Last active: Joined: -- I play NBA 2K for PC with xbox 360 Wireless contoller. The isomotion on the game is executed if the two triggers are pressed simultaneously, which because of the one axis doesnt do nothing actually. Well I sense this could be a solution for it, but tried to run the script after I installe AutoHotkey but nothing changes. Is there something I need to do in order to make it work, change something in the script, add some values or..? I'm just regular PC user and haven't been working with these kind of stuff till now. PS. I have the xinput1_3.dll, I've searched for it. Thank u guys, ur help would be very appreciated. #14 - Posted 12 October 2009 - 12:41 PM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 Obviously, the script can't make the game recognize the two triggers as separate axes. It only translates the triggers into two keys: [ and ]. You need to either bind these keys to something in your game, or change the keys in the script (simply replace the [ and/or ] characters). #15 - Posted 12 October 2009 - 01:00 PM Back to top Page 1 of 4 1 2 3 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"by Lexikos - Read XBOX gamepads using XInput (Only way to independently read L/R triggers), control rumble motors."	"true"
"Lists"	"List manipulation functions"	"http://www.hars.us/SW/List.ahk"	"by Laszlo - Function library to manipulate comma delimited lists. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"; ; AutoHotkey Version: 1.0.31.04+ ; Language: English ; Platform: Win2000/XP ; Author: Laszlo Hars ; ; Script Function: ; Function library to manipulate comma delimited lists ; Little error check is performed on the parameters, add your own! ; ; Test cases at the end are activated with adding lines like ; TestListUniq = 1 ; ; Version 1.0: 2005.04.14 Initial creation ; Version 1.1: 2005.04.17 ; Minor cleanups (removed unnecessary %'s, partial results...) ; Added test code ; User function Precede is used in ListMerge and ListSort ; Version 1.2: 2005.04.20 ; Change: Removed ByRef in ListAdd and ListReplace to Return list ; Added ListSwap(pos1,pos2,list) - Swap items at pos1 and pos2 ; ListMove(pos1,pos2,list) - Move item from pos1 to pos2 ; ListDel(pos,list) - Delete item, Return list ; ListReloc(pos,ofst,list) - Move item relative to current pos ; ListRemove(text,list) - Remove items containing text ; ListKeep(text,list) - Remove items NOT containing text ; Version 1.3: 2005.04.21 ; Changed ListRemove and ListKeep (text,opt,list), opt<0, =0, >0 ; to search text at end, anywhere, or in beginning of item ; Version 1.4: 2005.05.09 ; Hexify is renamed String2Hex ; Added its inverse Hex2String (thanks Skrommel) ListAdd(item,pos,list) ; Add item to the list at pos, < 0 counted from the end { ; ErrorLevel = 1 if pos was truncated, = 0 otherwise _list_ = ,%list%, ; enclose in commas for search IfLess pos,0, { ; pos = -1,-2... counted from right _pos := -pos StringGetPos chpos, _list_, `,, R%_pos% } Else IfGreater pos,1, { ; pos = 2,3... counted from left StringGetPos chpos, _list_, `,, L%pos% IfEqual chpos,-1, StringLen chpos, _list_ } ; pos = 0, 1 and normal cases ... StringLeft lst1, list, chpos - 1 StringTrimLeft lst2, list, chpos IfNotEqual lst2,, SetEnv item, %item%`, IfNotEqual lst1,, SetEnv item, `,%item% IfEqual pos,0, SetEnv ErrorLevel, 1 Return lst1 item lst2 } ListCut(pos, ByRef list) ; Remove & return item from list at pos, < 0 from end { _list_ = ,%list%, ; enclose in commas for search Transform p1, ABS, pos p2 := p1 + 1 IfGreater pos,-1, { ; pos > 0 counted from left, pos = 0: empty StringGetPos ch1, _list_, `,, L%p1% StringGetPos ch2, _list_, `,, L%p2% } Else IfLess pos,0, { ; pos < 0 counted from right StringGetPos ch2, _list_, `,, R%p1% StringGetPos ch1, _list_, `,, R%p2% } IfGreater ErrorLevel,0, Return ; nothing found StringMid item, list, ch1+1, ch2-ch1-1 StringLeft lst1, list, ch1-1 StringTrimLeft lst2, list, ch2 IfEqual lst2,, SetEnv list, %lst1% Else IfEqual lst1,, SetEnv list, %lst2% Else SetEnv list, %lst1%,%lst2% Return item } ListDel(pos,list) ; Del item from list at pos, < 0 from end { ; ErrorLevel = 1 if not found. No ByRef as in ListCut _list_ = ,%list%, ; enclose in commas for search Transform p1, ABS, pos p2 := p1 + 1 IfGreater pos,-1, { ; pos > 0 counted from left, pos = 0: empty StringGetPos ch1, _list_, `,, L%p1% StringGetPos ch2, _list_, `,, L%p2% } Else IfLess pos,0, { ; pos < 0 counted from right StringGetPos ch2, _list_, `,, R%p1% StringGetPos ch1, _list_, `,, R%p2% } IfGreater ErrorLevel,0, Return list ; no change StringLeft lst1, list, ch1-1 StringTrimLeft lst2, list, ch2 IfEqual lst2,, SetEnv list, %lst1% Else IfEqual lst1,, SetEnv list, %lst2% Else SetEnv list, %lst1%,%lst2% Return list } ListItem(pos,list) ; Return item at pos, < 0 from the end { ; ErrorLevel = 1 if pos is outside of list IfEqual pos,0, { ErrorLevel = 1 Return } _list_ = ,%list%, ; enclose in commas for search Transform p1, ABS, pos p2 := p1 + 1 IfGreater pos,0, { ; pos > 0 counted from left StringGetPos ch1, _list_, `,, L%p1% StringGetPos ch2, _list_, `,, L%p2% } Else { ; pos < 0 counted from right StringGetPos ch2, _list_, `,, R%p1% StringGetPos ch1, _list_, `,, R%p2% } IfGreater ErrorLevel,0, Return ; nothing found StringMid item, list, ch1+1, ch2-ch1-1 Return %item% } ListLen(list) ; how many items constitute the list { IfEqual list,, Return 0 StringReplace list, list, `,, `,, UseErrorLevel Return ErrorLevel + 1 } ListPart(pos1,pos2,list) ; Returns list_pos1,...,list_pos2, pos < 0: from end { _list_ = ,%list%, ; enclose in commas for search IfLess pos1,0, { p := 1-pos1 StringGetPos ch1, _list_, `,, R%p% IfGreater ErrorLevel,0, SetEnv ch1, 0 } Else { StringGetPos ch1, _list_, `,, L%pos1% IfGreater ErrorLevel,0, StringLen ch1, _list_ } IfLess pos2,0, { p := -pos2 StringGetPos ch2, _list_, `,, R%p% IfGreater ErrorLevel,0, SetEnv ch2, 0 } Else { p := 1+pos2 StringGetPos ch2, _list_, `,, L%p% IfGreater ErrorLevel,0, StringLen ch2, _list_ } StringMid list, list, ch1+1, ch2-ch1-1 Return list } ListPos(item,list) ; Return position of 1st copy of item, 0 if not found { _list_ = ,%list%, ; enclose in commas for search StringGetPos ch, _list_, `,%item%`, StringLeft list, _list_, ch+1 StringReplace list, list, `,, `,, UseErrorLevel Return %ErrorLevel% } ListReplace(itm1,itm2,list) ; Replace all itm1 with itm2 in list, itm2="""": delete { ; ErrorLevel = # items replaced list = ,%list%, ; enclose in commas for search _it_ = ,%itm2%, IfEqual itm2,, SetEnv _it_, `, Loop { ; StringReplace does not delete consecutive items StringReplace list, list, `,%itm1%`,, %_it_%, UseErrorLevel IfEqual ErrorLevel,0, Break cnt += ErrorLevel } ErrorLevel := cnt StringTrimLeft list, list, 1 StringTrimRight list, list, 1 Return list } ListSplit(pos,list,ByRef lst1,ByRef lst2) ; Split list at pos, < 0 from end { ; pos >=0: lst1:=item_1,...,item_pos; lst2:=item_pos+1,...{end} ; pos < 0: lst1:=item_1,...,item_pos-1; lst2:=item_pos,...{end} _list_ = ,%list%, ; enclose in commas for search IfLess pos,0, { p := 1-pos StringGetPos ch, _list_, `,, R%p% IfGreater ErrorLevel,0, SetEnv ch, 0 } Else { p := 1+pos StringGetPos ch, _list_, `,, L%p% IfGreater ErrorLevel,0, StringLen ch, _list_ } StringLeft lst1, list, ch-1 StringTrimLeft lst2, list, ch } ListSwap(pos1,pos2,list) ; Returns list with items at pos1 & pos2 swapped { ; ErrorLevel = 1 if item1 or item2 does not exist _list_ = ,%list%, ; enclose in commas for search IfLess pos1,0, { pos1 := 1-pos1 StringGetPos ch11, _list_, `,, R%pos1% IfGreater ErrorLevel,0, Return list pos1-- ; before the beginning StringGetPos ch12, _list_, `,, R%pos1% } Else { StringGetPos ch11, _list_, `,, L%pos1% IfGreater ErrorLevel,0, Return list ; pos1 = 0 pos1++ StringGetPos ch12, _list_, `,, L%pos1% IfGreater ErrorLevel,0, Return list ; over the end } IfLess pos2,0, { pos2 := 1-pos2 StringGetPos ch21, _list_, `,, R%pos2% IfGreater ErrorLevel,0, Return list pos2-- ; before the beginning StringGetPos ch22, _list_, `,, R%pos2% } Else { StringGetPos ch21, _list_, `,, L%pos2% IfGreater ErrorLevel,0, Return list ; pos2 = 0 pos2++ StringGetPos ch22, _list_, `,, L%pos2% IfGreater ErrorLevel,0, Return list ; over the end } IfEqual ch11,%ch21%, Return list ; swap the same StringMid I1, list, ch11+1, ch12-ch11-1 StringMid I2, list, ch21+1, ch22-ch21-1 IfLess ch11,%ch21%, { StringLeft L1, list, ch11 StringMid L2, list, ch12, ch21-ch12+1 StringTrimLeft L3, list, ch22-1 Return L1 I2 L2 I1 L3 } Else { StringLeft L1, list, ch21 StringMid L2, list, ch22, ch11-ch22+1 StringTrimLeft L3, list, ch12-1 Return L1 I1 L2 I2 L3 } } ListMove(pos1,pos2,list) ; Move item from pos1 to pos2, return new list { ; ErrorLevel = 1 if pos1 wrong or pos2 truncated ;item := ListCut(pos1,list) ; Does not work in AHK 1.0.31.05 (ByRef bug) item := ListItem(pos1,list) ; Remove if ByRef fixed IfEqual item,, Return list list := ListDel(pos1,list) ; Remove if ByRef fixed Return ListAdd(item,pos2,list) } ListReloc(pos,ofst,list) ; Move item relative to its current position { ; ErrorLevel = 1 if pos wrong or pos+ofst truncated ;item := ListCut(pos,list) ; Does not work in AHK 1.0.31.05 (ByRef bug) item := ListItem(pos,list) ; Remove if ByRef fixed IfEqual item,, Return list list := ListDel(pos,list) ; Remove if ByRef fixed Return ListAdd(item,pos+ofst,list) } ;----- Contained Text functions ----- ListRemove(text,opt,list) ; Remove items containing text. ErrorLevel = #removed items { ; Opt<,=,>0 text at end, anywhere, in beginning of item _list_ = ,%list%, ; enclose in commas for search IfGreater opt,0, SetEnv text, `,%text% Else IfLess opt,0, SetEnv text, %text%`, Loop { StringGetPos ch, _list_, %text% IfEqual ch,-1, Break cnt++ StringLen len, _list_ IfGreater opt,0, SetEnv ch1,%ch% ; position of "","" Else StringGetPos ch1, _list_, `,, R, len-ch StringGetPos ch2, _list_, `,, L, ch+1 StringLeft L1, _list_, ch1 StringTrimLeft L2, _list_, ch2+1 _list_ = %L1%,%L2% } StringTrimLeft _list_, _list_, 1 StringTrimRight _list_, _list_, 1 ErrorLevel = %cnt% Return _list_ } ListKeep(text,opt,list) ; Keep only items containing text, ErrorLevel = #kept items { ; Opt<,=,>0 text at end, anywhere, in beginning of item _list_ = ,%list%, ; enclose in commas for search StringLen len, _list_ IfGreater opt,0, SetEnv text, `,%text% Else IfLess opt,0, SetEnv text, %text%`, Loop { StringGetPos ch, _list_, %text%, L, ch+1 ; at start """"+1 = """" IfEqual ch,-1, Break cnt++ IfGreater opt,0, SetEnv ch1,%ch% ; position of "","" Else StringGetPos ch1, _list_, `,, R, len-ch StringGetPos ch2, _list_, `,, L, ch+1 StringMid I, list, ch1+1, ch2-ch1-1 L = %L%,%I% } StringTrimLeft L, L, 1 ErrorLevel = %cnt% Return L } ;----- Sorted list functions ----- Precede(x,y) ; =1 if x precedes y (used in In ListMerge, ListSort) { IfGreater x,%y%, Return 1 } ListMerge(list1,list2) ; Merge sorted lists { ; If listX = item, insert in the right place IfEqual list1,, Return list2 IfEqual list2,, Return list1 p1 = 1 p2 = 1 i1 := ListItem(1,list1) i2 := ListItem(1,list2) Loop { ; IfLess i1,%i2%, { ; Ascending <-- change for other order If Precede(i1,i2) ; User supplied order { list = %list%,%i1% p1++ i1 := ListItem(p1,list1) IfNotEqual i1,, Continue list := list "","" ListPart(p2,-1,list2) break ; list1 is exhausted } Else { list = %list%,%i2% p2++ i2 := ListItem(p2,list2) IfNotEqual i2,, Continue list := list "","" ListPart(p1,-1,list1) break ; list2 is exhausted } } StringTrimLeft list, list, 1 Return list } ListSort(ByRef list) ; ByRef wrapper for recursive sort { ; for simple cases ""Sort x, D,"" is faster list := _Sort(ListLen(list),list) } _Sort(len,lst) ; Returns Recursive Merge-sorted list { ; No ByRef with recursion in AHK Vers 1.0.31 IfLess len,2, Return lst ; list of length 0,1 is sorted L1 := len >> 1 ; integer halve Return ListMerge(_Sort(L1,ListPart(1,L1,lst)),_Sort(len-L1,ListPart(L1+1,-1,lst))) } String2Hex(x) ; Convert a string to a huge hex number starting with X { StringLen Len, x format = %A_FormatInteger% SetFormat Integer, H hex = X Loop %Len% { Transform y, ASC, %x% ; ASCII code of 1st char, 15 < y < 256 StringTrimLeft y, y, 2 ; Remove leading 0x hex = %hex%%y% StringTrimLeft x, x, 1 ; Remove 1st char } SetFormat Integer, %format% Return hex } Hex2String(x) ; Convert a huge hex number starting with X to string { StringTrimLeft x, x, 1 ; discard leading X StringLen len, x Loop % len/2 ; 2-digit blocks { StringLeft hex, x, 2 Transform y, Chr, % ""0x""hex string = %string%%y% StringTrimLeft x, x, 2 } Return string } ListUniq(ByRef list) ; Remove repeated items from list, preserve order { ; faster than _Sort list = %list%, ; "","" added for simpler search c = 0 Loop { StringGetPos d, list, `,,, %c% ; search from c IfLess d,0, { ; No more "","" StringTrimRight list, list, 1 Return } StringMid item, list, % c+1, % d-c hex := String2Hex(item) ; Item might not be a valid name IfEqual %hex%,, { ; 1st occurrence %hex% = 1 ; Record that hex is found c := d + 1 ; Jump over next "","" Continue } ; hex already occured ... StringLeft left, list,% c-1 StringTrimLeft right, list, %d% list = %left%%right% } } ;----- Hash functions ----- Hash16(x) ; 16-bit hash related to DJB2 hash(i) = 33*hash(i-1) + x[i] { hash = 5381 StringLen Len, x Loop %Len% { Transform y, ASC, %x% ; ASCII code of 1st char hash := 33*hash + y ; *33 = <<5,add hash := hash >> 16 ^ hash & 0xFFFF ; Fold over MS & LS word StringTrimLeft x, x, 1 ; Remove 1st char from x } Return hash } ;----- Test cases for function x: set TESTx = 1 ----- TEST(A,x) ; Display expression x and its value: TEST(A_LineNumber,3*a+2) { E = %ErrorLevel% FileReadLine Line, %A_LineFile%, %A% StringTrimLeft Line, Line, 18 StringTrimRight Line, Line, 1 MsgBox %Line% = {%x%}`nErrorLevel = {%E%} } TEST1(A,x) ; Display 1 prior line I =, the expression, its value and the new I { Global I E = %ErrorLevel% FileReadLine LI, %A_LineFile%,% A-1 FileReadLine Line, %A_LineFile%, %A% StringTrimLeft Line, Line, 19 StringTrimRight Line, Line, 1 MsgBox %LI%`n%Line% = {%x%}`nI = {%I%}`nErrorLevel = {%E%} } TEST2(A,x) ; Display expression x, its value and 2 ByRef values I and J { Global I, J E = %ErrorLevel% FileReadLine Line, %A_LineFile%, %A% StringTrimLeft Line, Line, 19 StringTrimRight Line, Line, 1 MsgBox %Line% = {%x%}`nI = {%I%}`nJ = {%J%}`nErrorLevel = {%E%} } IfNotEqual TestListSwap,, { TEST(A_LineNumber,ListSwap(2,4,""1,2,3,4,5"")) TEST(A_LineNumber,ListSwap(4,2,""1,2,3,4,5"")) TEST(A_LineNumber,ListSwap(1,1,""1,2,3,4,5"")) TEST(A_LineNumber,ListSwap(0,4,""1,2,3,4,5"")) TEST(A_LineNumber,ListSwap(2,6,""1,2,3,4,5"")) TEST(A_LineNumber,ListSwap(1,1,""1"")) } IfNotEqual TestListAdd,, { TEST(A_LineNumber,ListAdd(1,0,"""")) TEST(A_LineNumber,ListAdd(""3"",-1,"""")) TEST(A_LineNumber,ListAdd(2,2,""1,3"")) TEST(A_LineNumber,ListAdd(5,5,""1,2,3"")) TEST(A_LineNumber,ListAdd(4,-2,""1,2,3,5"")) TEST(A_LineNumber,ListAdd(0,-9,""1,2,3"")) TEST(A_LineNumber,ListAdd(0,-4,""1,2,3"")) TEST(A_LineNumber,ListAdd(4,4,""1,2,3"")) TEST(A_LineNumber,ListAdd(4,5,""1,2,3"")) } IfNotEqual TestListCut,, { I = TEST1(A_LineNumber,ListCut( 1,I)) I = abc TEST1(A_LineNumber,ListCut( 1,I)) I = abc TEST1(A_LineNumber,ListCut(-1,I)) I = abc TEST1(A_LineNumber,ListCut( 2,I)) I = abc TEST1(A_LineNumber,ListCut( 2,I)) I = abc TEST1(A_LineNumber,ListCut(-2,I)) I = 1,2,03,4,5 TEST1(A_LineNumber,ListCut( 0,I)) I = 1,2,03,4,5 TEST1(A_LineNumber,ListCut( 1,I)) I = 1,2,03,4,5 TEST1(A_LineNumber,ListCut( 2,I)) I = 1,2,03,4,5 TEST1(A_LineNumber,ListCut( 3,I)) I = 1,2,03,4,5 TEST1(A_LineNumber,ListCut( 4,I)) I = 1,2,03,4,5 TEST1(A_LineNumber,ListCut( 5,I)) I = 1,2,03,4,5 TEST1(A_LineNumber,ListCut( 6,I)) I = 1,2,03,4,5 TEST1(A_LineNumber,ListCut(-1,I)) I = 1,2,03,4,5 TEST1(A_LineNumber,ListCut(-2,I)) I = 1,2,03,4,5 TEST1(A_LineNumber,ListCut(-4,I)) I = 1,2,03,4,5 TEST1(A_LineNumber,ListCut(-5,I)) I = 1,2,03,4,5 TEST1(A_LineNumber,ListCut(-6,I)) } IfNotEqual TestListItem,, { TEST(A_LineNumber,ListItem( 1,"""")) TEST(A_LineNumber,ListItem( 1,""abc"")) TEST(A_LineNumber,ListItem(-1,""abc"")) TEST(A_LineNumber,ListItem( 2,""abc"")) TEST(A_LineNumber,ListItem(-2,""abc"")) TEST(A_LineNumber,ListItem( 0,""1,2,03,4,5"")) TEST(A_LineNumber,ListItem( 1,""1,2,03,4,5"")) TEST(A_LineNumber,ListItem( 2,""1,2,03,4,5"")) TEST(A_LineNumber,ListItem( 3,""1,2,03,4,5"")) TEST(A_LineNumber,ListItem( 4,""1,2,03,4,5"")) TEST(A_LineNumber,ListItem( 5,""1,2,03,4,5"")) TEST(A_LineNumber,ListItem( 6,""1,2,03,4,5"")) TEST(A_LineNumber,ListItem(-1,""1,2,03,4,5"")) TEST(A_LineNumber,ListItem(-2,""1,2,03,4,5"")) TEST(A_LineNumber,ListItem(-5,""1,2,03,4,5"")) TEST(A_LineNumber,ListItem(-6,""1,2,03,4,5"")) } IfNotEqual TestListMove,, { TEST(A_LineNumber,ListMove(1,2,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(2,1,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(1,-1,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(-1,1,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(4,5,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(5,4,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(2,4,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(4,2,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(0,1,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(1,6,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(1,-6,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(1,-5,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(1,-4,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(-1,5,""1,2,3,4,5"")) TEST(A_LineNumber,ListMove(-4,-5,""1,2,3,4,5"")) } IfNotEqual TestListReloc,, { TEST(A_LineNumber,ListReloc(1,0,""1,2,3,4,5"")) TEST(A_LineNumber,ListReloc(1,1,""1,2,3,4,5"")) TEST(A_LineNumber,ListReloc(1,-1,""1,2,3,4,5"")) TEST(A_LineNumber,ListReloc(2,1,""1,2,3,4,5"")) TEST(A_LineNumber,ListReloc(2,-1,""1,2,3,4,5"")) TEST(A_LineNumber,ListReloc(-1,1,""1,2,3,4,5"")) TEST(A_LineNumber,ListReloc(-1,-1,""1,2,3,4,5"")) TEST(A_LineNumber,ListReloc(5,-4,""1,2,3,4,5"")) TEST(A_LineNumber,ListReloc(2,3,""1,2,3,4,5"")) } IfNotEqual TestListPos,, { TEST(A_LineNumber,ListPos(1,"""")) TEST(A_LineNumber,ListPos("""",""abc"")) TEST(A_LineNumber,ListPos(""a"",""abc"")) TEST(A_LineNumber,ListPos(""ab"",""ab,ac"")) TEST(A_LineNumber,ListPos(""ac"",""ab,ac"")) TEST(A_LineNumber,ListPos(""ab"",""ab,ab"")) TEST(A_LineNumber,ListPos(""abc"",""abc"")) TEST(A_LineNumber,ListPos( 1,""1,2,12,4,4"")) TEST(A_LineNumber,ListPos( 2,""1,2,12,4,4"")) TEST(A_LineNumber,ListPos(12,""1,2,12,4,4"")) TEST(A_LineNumber,ListPos( 4,""1,2,12,4,4"")) TEST(A_LineNumber,ListPos( 5,""1,2,12,4,4"")) } IfNotEqual TestListReplace,, { TEST(A_LineNumber,ListReplace(1,"""","""")) TEST(A_LineNumber,ListReplace("""","""",""abc"")) TEST(A_LineNumber,ListReplace(""a"","""",""abc"")) TEST(A_LineNumber,ListReplace(""ac"","""",""ab,ac"")) TEST(A_LineNumber,ListReplace(""abc"","""",""abc"")) TEST(A_LineNumber,ListReplace(""ab"","""",""ab,ab"")) TEST(A_LineNumber,ListReplace(2,""03"",""1,2,12,4,4"")) TEST(A_LineNumber,ListReplace(1,"""",""1,2,12,4,4"")) TEST(A_LineNumber,ListReplace(1,12,""1,2,12,4,4"")) TEST(A_LineNumber,ListReplace(4,"""",""1,2,12,4,4"")) TEST(A_LineNumber,ListReplace(4,55,""1,2,12,4,4"")) } IfNotEqual TestListLen,, { TEST(A_LineNumber,ListLen("""")) TEST(A_LineNumber,ListLen(""abc"")) TEST(A_LineNumber,ListLen(""ab,ac"")) TEST(A_LineNumber,ListLen(""1,2,123,4,4"")) } IfNotEqual TestListSplit,, { TEST2(A_LineNumber,ListSplit(0,1,I,J)) TEST2(A_LineNumber,ListSplit(1,1,I,J)) TEST2(A_LineNumber,ListSplit(0,""1,2"",I,J)) TEST2(A_LineNumber,ListSplit(1,""1,2"",I,J)) TEST2(A_LineNumber,ListSplit(3,""1,2"",I,J)) TEST2(A_LineNumber,ListSplit(1,""1,2,3"",I,J)) TEST2(A_LineNumber,ListSplit(2,""1,02,3"",I,J)) TEST2(A_LineNumber,ListSplit(3,""01,2,3"",I,J)) TEST2(A_LineNumber,ListSplit(-1,""1,2,3"",I,J)) TEST2(A_LineNumber,ListSplit(-2,""1,2,03"",I,J)) TEST2(A_LineNumber,ListSplit(-4,""1,2,03"",I,J)) } IfNotEqual TestListPart,, { TEST(A_LineNumber,ListPart(0,0,"""")) TEST(A_LineNumber,ListPart(1,1,""1"")) TEST(A_LineNumber,ListPart(1,2,""1"")) TEST(A_LineNumber,ListPart(2,1,""1"")) TEST(A_LineNumber,ListPart(-1,1,""1"")) TEST(A_LineNumber,ListPart(1,-1,""1"")) TEST(A_LineNumber,ListPart(2,-1,""1,2"")) TEST(A_LineNumber,ListPart(1,2,""2,1"")) TEST(A_LineNumber,ListPart(1,3,""2,1,3"")) TEST(A_LineNumber,ListPart(2,6,""2,1,3,6,5,4"")) TEST(A_LineNumber,ListPart(-6,6,""2,1,3,6,5,4"")) TEST(A_LineNumber,ListPart(-6,-1,""2,1,3,6,5,4"")) TEST(A_LineNumber,ListPart(1,3,""2,1,3,6,5,4"")) } IfNotEqual TestListRemove,, { TEST(A_LineNumber,ListRemove(2,0,""1,2,3"")) TEST(A_LineNumber,ListRemove(2,0,""2"")) TEST(A_LineNumber,ListRemove(2,0,""2,2,2"")) TEST(A_LineNumber,ListRemove(2,0,""1,3"")) TEST(A_LineNumber,ListRemove(1,0,""1,3"")) TEST(A_LineNumber,ListRemove(3,0,""1,3"")) TEST(A_LineNumber,ListRemove(3,0,""01,30"")) TEST(A_LineNumber,ListRemove(3,1,""01,30"")) TEST(A_LineNumber,ListRemove(3,-1,""01,30"")) TEST(A_LineNumber,ListRemove(0,0,""01,30"")) TEST(A_LineNumber,ListRemove(0,1,""01,30"")) TEST(A_LineNumber,ListRemove(0,-1,""01,30"")) TEST(A_LineNumber,ListRemove("".tmp"",-1,""1.exe,2.tmp,3.dat,4.tmp"")) } IfNotEqual TestListKeep,, { TEST(A_LineNumber,ListKeep(2,0,""1,2,3"")) TEST(A_LineNumber,ListKeep(2,0,""2"")) TEST(A_LineNumber,ListKeep(2,0,""2,2,2"")) TEST(A_LineNumber,ListKeep(2,0,""1,3"")) TEST(A_LineNumber,ListKeep(1,0,""1,3"")) TEST(A_LineNumber,ListKeep(3,0,""1,3"")) TEST(A_LineNumber,ListKeep(3,1,""1,3"")) TEST(A_LineNumber,ListKeep(3,-1,""1,3"")) TEST(A_LineNumber,ListKeep(3,0,""01,30"")) TEST(A_LineNumber,ListKeep(0,0,""01,30"")) TEST(A_LineNumber,ListKeep(3,1,""01,30"")) TEST(A_LineNumber,ListKeep(3,-1,""01,30"")) TEST(A_LineNumber,ListKeep(0,1,""01,30"")) TEST(A_LineNumber,ListKeep(0,-1,""01,30"")) TEST(A_LineNumber,ListKeep("".tmp"",-1,""1.exe,2.tmp,3.dat,4.tmp"")) } IfNotEqual TestListMerge,, { TEST(A_LineNumber,ListMerge("""","""")) TEST(A_LineNumber,ListMerge("""",""1"")) TEST(A_LineNumber,ListMerge(""1"","""")) TEST(A_LineNumber,ListMerge(0,""1,2"")) TEST(A_LineNumber,ListMerge(3,""2,1"")) TEST(A_LineNumber,ListMerge(""2,0"",1)) TEST(A_LineNumber,ListMerge(""2,1"",0)) TEST(A_LineNumber,ListMerge(""2,1"",3)) TEST(A_LineNumber,ListMerge(""6,5,4"",""2,1,0"")) TEST(A_LineNumber,ListMerge(""2,1,0"",""6,5,4"")) TEST(A_LineNumber,ListMerge(""2,1,0"",""3,4,5"")) TEST(A_LineNumber,ListMerge(""5,3,1"",""4,2,0"")) } IfNotEqual TestListSort,, { I = 06,5,a,3,2,01 TEST1(A_LineNumber,ListSort(I)) I = 1,02,003,4,5,06 TEST1(A_LineNumber,ListSort(I)) } IFNotEqual Test_Sort,, { TEST(A_LineNumber,_Sort(0,"""")) TEST(A_LineNumber,_Sort(1,""1"")) TEST(A_LineNumber,_Sort(2,""1,2"")) TEST(A_LineNumber,_Sort(2,""2,1"")) TEST(A_LineNumber,_Sort(3,""2,1,3"")) TEST(A_LineNumber,_Sort(6,""5,1,3,2,6,4"")) TEST(A_LineNumber,_Sort(6,""5,6,3,2,1,4"")) TEST(A_LineNumber,_Sort(6,""1,2,3,4,5,6"")) TEST(A_LineNumber,_Sort(6,""1,2,03,4,5,6"")) TEST(A_LineNumber,_Sort(6,""06,5,4,3,2,01"")) TEST(A_LineNumber,_Sort(6,""0x06,0x5,0xa,3,2,01"")) TEST(A_LineNumber,_Sort(6,""1,2,03,4,5,6"")) } IfNotEqual TestHash16,, { TEST(A_LineNumber,Hash16(""0"")) TEST(A_LineNumber,Hash16(""00"")) TEST(A_LineNumber,Hash16(""000"")) TEST(A_LineNumber,Hash16(""1"")) TEST(A_LineNumber,Hash16(""2"")) TEST(A_LineNumber,Hash16(""3"")) } IfNotEqual TestString2Hex,, { TEST(A_LineNumber,String2Hex(""0"")) TEST(A_LineNumber,String2Hex(""00"")) TEST(A_LineNumber,String2Hex(""000"")) TEST(A_LineNumber,String2Hex(""1"")) TEST(A_LineNumber,String2Hex(""2"")) TEST(A_LineNumber,String2Hex(""abc"")) } IfNotEqual TestHex2String,, { TEST(A_LineNumber,Hex2String(""X30"")) TEST(A_LineNumber,Hex2String(""X3030"")) TEST(A_LineNumber,Hex2String(""X31"")) TEST(A_LineNumber,Hex2String(""X32"")) TEST(A_LineNumber,Hex2String(""X33"")) TEST(A_LineNumber,Hex2String(""X616263"")) } IfNotEqual TestListUniq,, { I = 1 TEST1(A_LineNumber,ListUniq(I)) I = 1,2 TEST1(A_LineNumber,ListUniq(I)) I = 1,1 TEST1(A_LineNumber,ListUniq(I)) I = 01,1 TEST1(A_LineNumber,ListUniq(I)) I = 1,2,1,3,2,4 TEST1(A_LineNumber,ListUniq(I)) I = 0,1,2,1,03,02,4 TEST1(A_LineNumber,ListUniq(I)) }"	"null"	"null"	"by Laszlo - Function library to manipulate comma delimited lists. Forum thread:."	"true"
"Lists"	"link"	"https://autohotkey.com/board/topic/3020-list-manipulation-functions/"	"by Laszlo - Function library to manipulate comma delimited lists. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"List manipulation functions - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. List manipulation functions Started by Laszlo , Apr 14 2005 11:46 PM Page 1 of 2 1 2 Next Please log in to reply 28 replies to this topic Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 Lists are important building blocks for maintaining varying length of sequences, like applications, websites, window ID's, etc. AHK offers practically just one simple function for handling them if Var in MatchList  if Var not in MatchList if Var contains MatchList if Var not contains MatchListWith new user functions we can provide tools for manipulating these comma delimited lists. In the script below I tried to strike a balance between code length and running time. I tested them for function, but there still could be some bugs in it. ListAdd(item,pos,ByRef list)  ; Add item to the list at pos, < 0 counted from the end {                             ; ErrorLevel = 1 if pos was truncated, = 0 otherwise    _list_ = ,%list%,          ; enclose in commas for search    IfLess pos,0, {            ; pos = -1,-2... counted from right       _pos := -pos       StringGetPos chpos, _list_, `,, R%_pos%    }    Else IfGreater pos,1, {    ; pos = 2,3... counted from left       StringGetPos chpos, _list_, `,, L%pos%       IfEqual chpos,-1, StringLen chpos, _list_    }                          ; pos = 0, 1 and normal cases ...    StringLeft leftlist, list, % chpos - 1    StringTrimLeft rightlist, list, %chpos%    IfNotEqual rightlist,, SetEnv item, %item%`,    IfNotEqual  leftlist,, SetEnv item, `,%item%    list = %leftlist%%item%%rightlist% }  ListCut(pos, ByRef list)      ; Remove & return item from list at pos, < 0 from end {    _list_ = ,%list%,          ; enclose in commas for search    Transform p1, ABS, pos    p2 := p1 + 1    IfGreater pos,-1, {        ; pos > 0 counted from left, pos = 0: empty       StringGetPos ch1, _list_, `,, L%p1%       StringGetPos ch2, _list_, `,, L%p2%    }    Else IfLess pos,0, {       ; pos < 0 counted from right       StringGetPos ch2, _list_, `,, R%p1%       StringGetPos ch1, _list_, `,, R%p2%    }    IfGreater ErrorLevel,0, Return   ; nothing found    StringMid item, list, ch1+1, ch2-ch1-1    StringLeft leftlist, list, % ch1 - 1    StringTrimLeft rightlist, list, %ch2%    IfEqual     rightlist,, SetEnv list, %leftlist%    Else IfEqual leftlist,, SetEnv list,%rightlist%    Else SetEnv list, %leftlist%,%rightlist%    Return %item% }  ListItem(pos,list)            ; Return item at pos, < 0 from the end {    _list_ = ,%list%,          ; enclose in commas for search    Transform p1, ABS, pos    p2 := p1 + 1    IfGreater pos,-1, {        ; pos > 0 counted from left, pos = 0: empty       StringGetPos ch1, _list_, `,, L%p1%       StringGetPos ch2, _list_, `,, L%p2%    }    Else IfLess pos,0, {       ; pos < 0 counted from right       StringGetPos ch2, _list_, `,, R%p1%       StringGetPos ch1, _list_, `,, R%p2%    }    IfGreater ErrorLevel,0, Return   ; nothing found    StringMid item, list, ch1+1, ch2-ch1-1    Return %item% }  ListPos(item,list)            ; Return position of 1st  copy of item, 0 if not found {    _list_ = ,%list%,          ; enclose in commas for search    StringGetPos ch, _list_, `,%item%`,    StringLeft list, _list_, % ch+1    StringReplace list, list, `,, `,, UseErrorLevel    Return %ErrorLevel% }  ListReplace(itm1,itm2,ByRef list) ; Replace all itm1 with itm2 in list, itm2="""": delete {                             ; ErrorLevel = # items replaced    list = ,%list%,            ; enclose in commas for search    _it_ = ,%itm2%,    IfEqual itm2,, SetEnv _it_, `,    Loop    {                          ; StringReplace does not delete consecutive items       StringReplace list, list, `,%itm1%`,, %_it_%, UseErrorLevel       IfEqual ErrorLevel,0, Break       cnt += ErrorLevel    }    ErrorLevel := cnt    StringTrimLeft  list, list, 1    StringTrimRight list, list, 1 }Split or merge of lists is easy, you don't need functions for them. As the need arises I will add more functions, like sort, or removing duplicates. Any ideas, what else could be useful? Edit 2006.02.25. The full version is here. There is also an experimental version. It uses the global variable ""_"" to store the list separator, which can be set to any character, like ""_ = `;"". Edit 2006.03.17. Minor bugfix, version 1.5/1.51 uploaded Edit 2008.12.19. Source moved to AutoHotkey.net #1 - Posted 14 April 2005 - 11:46 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 Here is the second part (less tested). ListLen(list)                 ; how many items constitute the list  {     IfEqual list,, Return 0     StringReplace list, list, `,, `,, UseErrorLevel     Return ErrorLevel + 1  }    ListSplit(pos,list,ByRef list1,ByRef list2) ; Split list at pos, < 0 counted from end  {       ; pos >=0: list1:=item_1,...,item_pos;   list2:=item_pos+1,...{end}          ; pos < 0: list1:=item_1,...,item_pos-1; list2:=item_pos,...{end}     _list_ = ,%list%,          ; enclose in commas for search     IfLess pos,0, {        p := 1-pos        StringGetPos ch, _list_, `,, R%p%        IfGreater ErrorLevel,0, SetEnv ch, 0     }     Else {        p := 1+pos        StringGetPos ch, _list_, `,, L%p%        IfGreater ErrorLevel,0, StringLen ch, _list_     }     StringLeft     list1, list,% ch-1     StringTrimLeft list2, list, %ch%  }    ListPart(pos1,pos2,list)      ; Returns list_pos1,...,list_pos2, pos < 0: from end  {     _list_ = ,%list%,          ; enclose in commas for search     IfLess pos1,0, {        p := 1-pos1        StringGetPos ch1, _list_, `,, R%p%        IfGreater ErrorLevel,0, SetEnv ch1, 0     }     Else {        StringGetPos ch1, _list_, `,, L%pos1%        IfGreater ErrorLevel,0, StringLen ch1, _list_     }     IfLess pos2,0, {        p := -pos2        StringGetPos ch2, _list_, `,, R%p%        IfGreater ErrorLevel,0, SetEnv ch2, 0     }     Else {        p := 1+pos2        StringGetPos ch2, _list_, `,, L%p%        IfGreater ErrorLevel,0, StringLen ch2, _list_     }     StringMid list, list, % ch1+1, % ch2-ch1-1     Return list  }    ListSort(ByRef list)          ; ByRef wrapper for recursive sort  {     list := List_Sort(ListLen(list),list)  }    ListMerge(list1,list2)        ; Merge sorted lists  {                             ; If listX = item, insert in the right place     IfEqual list1,, Return list2     IfEqual list2,, Return list1     p1 = 1     p2 = 1     i1 := ListItem(1,list1)     i2 := ListItem(1,list2)     Loop     {        IfLess i1,%i2%, {       ; Ascending <-- change for other order           list = %list%,%i1%           p1++           i1 := ListItem(p1,list1)           IfNotEqual i1,, Continue           list := list "","" ListPart(p2,-1,list2)           break                ; list1 is exhausted        }        Else {           list = %list%,%i2%           p2++           i2 := ListItem(p2,list2)           IfNotEqual i2,, Continue           list := list "","" ListPart(p1,-1,list1)           break                ; list2 is exhausted        }     }     StringTrimLeft list, list, 1     Return list  }    List_Sort(len,list)           ; Returns Recursive Merge-sorted list  {                             ; No ByRef with recursion in AHK Vers 1.0.31     IfLess len,2, Return list  ; list of length 0,1 is sorted     Transform L1, BitShiftRight, len, 1 ; integer halve     L2 := len - L1     Return ListMerge(List_Sort(L1,ListPart(1,L1,list)),List_Sort(L2,ListPart(L1+1,-1,list)))  }Notes for ListSort: The applied algorithm is asymptotically one of the fastest, taking time proportional to n.log(n) for length-n lists. The comparison is done by AHK's internal algorithm, providing ascending sort. If you don't like it, replace the instruction in ListMerge() IfLess i1,%i2%, {with IfGreater i1,%i2%, {or for a more general way, with If MyLess(i1,i2)        {You have to provide the MyLess(x,y) function, which returns 1 if you consider x < y, and 0 otherwise. For example MyLess(x,y)  {     IfGreater x,%y%, Return 1     Return 0  }will sort the list descending (6,5,4,3...). Try it with list = 6,5,3,2,01,4  ListSort(list)  MsgBox %list%Edit 20050416: the function ListMerge is separated from List_Sort, as it is useful for its own right. #2 - Posted 15 April 2005 - 07:54 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 Here is the third part, removing identical items from lists. The script below is faster than sorting. For each item in the list a local variable is generated, named by the hex representation of the name of the item (which could contain illegal characters for a variable name, like "".""). If this name is new, it is the first occurrence of the item, otherwise we cut this item off the list. Hexify(x)         ; Convert a string to a huge hex number starting with X  {     StringLen Len, x     format = %A_FormatInteger%     SetFormat Integer, H     hex = X     Loop %Len%     {        Transform y, ASC, %x%   ; ASCII code of 1st char, 15 < y < 256        StringTrimLeft y, y, 2  ; Remove leading 0x        hex = %hex%%y%        StringTrimLeft x, x, 1  ; Remove 1st char     }     SetFormat Integer, %format%     Return hex  }    ListUniq(ByRef list)          ; Remove repeated items from list  {     list = %list%,     c = 0     Loop     {        StringGetPos d, list, `,,, %c% ; search from c        IfLess d,0, {           ; No more "",""           StringTrimRight list, list, 1           Return        }        StringMid item, list, % c+1, % d-c        hex := Hexify(item)     ; Item might not be a valid name        IfEqual %hex%,, {       ; 1st occurrence           %hex% = 1           c := d + 1           Continue        }                       ; Already found        StringLeft      left, list,% c-1        StringTrimLeft right, list, %d%        list = %left%%right%     }  }Test it with list = 0,1,2,1,3,02,4,2,1  ListUniq(list)  MsgBox %list% #3 - Posted 15 April 2005 - 11:07 PM Back to top Chris Administrators 10727 posts Last active: Joined: 02 Mar 2004 Very nice. Perhaps these list management functions are abstract enough to be a good general-purpose library. If so, they can eventually be consolidated and put into a new ""standard includes"" folder that can be distributed with AutoHotkey. To include something from the standard folder, the syntax might enclose the filename in <> such as: #Include But no final decision on syntax has been made. Maybe someone will think of something better. #4 - Posted 16 April 2005 - 12:22 AM Back to top Jon Members 349 posts Last active: Aug 30 2011 08:35 PM Joined: 28 Apr 2004 Nice script, Thanks for putting them together Lazlo. I'm sure I'll be finding them useful in the future. #5 - Posted 16 April 2005 - 02:53 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 Thanks for the nice words. I applied some minor changes (removed unnecessary %'s, partial results; added tests). I'll keep the current version here, as it might become too long for posting. #6 - Posted 18 April 2005 - 01:43 AM Back to top Invalid User Members 447 posts Last active: Mar 27 2012 01:04 PM Joined: 14 Feb 2005 I was also thinking of putting together a pile of lifunctions for lists and other functions I use often in scripts. My pile-o-functions should include: Move a list item up one Move a list item down Select next item Select pevious item Drag and Drop onto list Remove item from list Filtering script for mass drag and drop to exclude certain defined files Move group of selected items up Move group of selected items down Remove groups of selected items Script for adding items to the list via gui button or other means(menu item) Script to demonstrate two different actions to take upon selecting an item with single click and double clicks This list is longer in my head but I will work on it. #7 - Posted 18 April 2005 - 04:42 AM my lame sig Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 What you, Invalid User, describe is mostly the application layer above the low level List function library. They include drag-and-drop addition, making multiple selections in a GUI and acting on them at button press or click, etc. What I could add to the library, are: Move a list item up/down by a specified number of positions Move a list item to a new position Swap 2 items However, it is not clear how selecting the next/previous item should work. If you mean, returning items from pos+1 or pos-1, it is trivial. If you mean locations relative to the last access point, we need to mark somehow where we were. We must not change the list, and inside a function we don't know the name of a parameter (the list), so we cannot attach a variable to the list, telling the last access point. If there are multiple lists, global variables of fixed names won't help. Hashing the content of the list could give a name for the access point variable, but adding an item to the list invalidates this name. It is also slow, needing a full scan of the list each time we need to find out the location of the last access. If only we could access the memory location or the pointer there where the list is stored... Mass add: it looks like merging or concatenating lists, and optionally removing repetitions. Remove items, which contain a specified string: it is a good idea. Useful, for example, to remove files with the extension .bak, .tmp, etc. from a list of files. Especially, when wildcards will be available in AHK. #8 - Posted 18 April 2005 - 10:42 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 I updated the List functions library List.ahk. The changes are: ; Version 1.1: 2005.04.17  ;              Minor cleanups (removed unnecessary %'s, partial results...)  ;              Added test code  ;              User function Precede is used in ListMerge and ListSort  ; Version 1.2: 2005.04.20  ;              Change: Removed ByRef in ListAdd and ListReplace to Return list  ;              Added ListSwap(pos1,pos2,list) - Swap items at pos1 and pos2  ;                    ListMove(pos1,pos2,list) - Move item from pos1 to pos2  ;                    ListReloc(pos,ofst,list) - Move item relative to current pos  ;                    ListDel(pos,list)        - Delete item, Return list  ;                    ListRemove(text,list)    - Remove items containing text  ;                    ListKeep(text,list)      - Remove items NOT containing textThe complete list of the implemented List functions is now ListAdd(item,pos,list)        ; Add item to the list at pos, < 0 counted from the end  ListCut(pos, ByRef list)      ; Remove & return item from list at pos, < 0 from end  ListDel(pos,list)             ; Del item from list at pos, < 0 from end  ListItem(pos,list)            ; Return item at pos, < 0 from the end  ListLen(list)                 ; how many items constitute the list  ListPart(pos1,pos2,list)      ; Returns list_pos1,...,list_pos2, pos < 0: from end  ListPos(item,list)            ; Return position of 1st copy of item, 0 if not found  ListReplace(itm1,itm2,list)   ; Replace all itm1 with itm2 in list, itm2="""": delete  ListSplit(pos,list,ByRef lst1,ByRef lst2) ; Split list at pos, < 0 from end  ListSwap(pos1,pos2,list)      ; Returns list with items at pos1 & pos2 swapped  ListMove(pos1,pos2,list)      ; Move item from pos1 to pos2, return new list  ListReloc(pos,ofst,list)      ; Move item relative to its current position  ListRemove(text,list)         ; Remove items containing text  ListKeep(text,list)           ; Remove all items NOT containing text  Precede(x,y)                  ; =1 if x precedes y (used in ListMerge, ListSort)  ListMerge(list1,list2)        ; Merge sorted lists  ListSort(ByRef list)          ; ByRef wrapper for recursive sort  _Sort(len,lst)                ; Returns Recursive Merge-sorted list  Hexify(x)                     ; Convert a string to a huge hex number starting with X  ListUniq(ByRef list)          ; Remove repeated items from list, preserve order  Hash16(x)   ; 16-bit hash related to DJB2 hash(i) = 33*hash(i-1) + x[i]  TEST(A,x)   ; Display expression x and its value: TEST(A_LineNumber,3*a+2)  TEST1(A,x)  ; Display 1 prior line I =, the expression, its value and the new I  TEST2(A,x)  ; Display expression x, its value and 2 ByRef values I and J #9 - Posted 20 April 2005 - 05:02 PM Back to top toralf Moderators 4035 posts Last active: Aug 20 2014 04:23 PM Joined: 31 Jan 2005 Hi Lazlo, Very nice and usefull functions. Something that might be an additional usefull function: ListFillControl(ControlName,GuiID,List) #10 - Posted 21 April 2005 - 01:35 PM Ciao toralf   I use the latest AHK version (1.1.15+) Please ask questions in forum on ahkscript.org. Why? For online reference please use these Docs. Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 Thanks for the suggestion. What should this function do? Replace commas with pipes? It is one line. What else? I deliberately left out anything GUI related, since this library provides the low level functions, the building blocks for complex applications with GUI's, file I/O, etc. If they use well tested powerful functions, their development will be faster and less error prone. #11 - Posted 21 April 2005 - 03:22 PM Back to top toralf Moderators 4035 posts Last active: Aug 20 2014 04:23 PM Joined: 31 Jan 2005 You are right, it is just a two line function (StringReplace and GuiControl) Might not be as useful as I thought in the beginning. #12 - Posted 21 April 2005 - 05:07 PM Ciao toralf   I use the latest AHK version (1.1.15+) Please ask questions in forum on ahkscript.org. Why? For online reference please use these Docs. Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 Version 1.3 is uploaded. Two functions are changed ListRemove(text,opt,list)     ; Remove items containing text. ErrorLevel = #removed items  ListKeep(text,opt,list)       ; Keep only items containing text, ErrorLevel = #kept itemsThere is a new parameter, opt < 0, = 0, > 0: text searched at the end, anywhere, in the beginning of items, respectively. It is to avoid surprises, like Chief.Executive.Officer is treated like a program having .Exe as a substring. With opt = -1 only those .exe occurrences are processed, which are at the end of the items, like file extensions. #13 - Posted 21 April 2005 - 08:02 PM Back to top maxinuruguay Members 15 posts Last active: Nov 06 2006 10:24 PM Joined: 09 Dec 2005 Is there anyway for the library to use a different delimiter? Maybe a global variable to set the delimiter. It would really be of great help to me. Thanks. #14 - Posted 25 February 2006 - 08:33 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 I uploaded an experimental version to http://www.hars.us/SW/List1.ahk. It uses the global variable ""_"" to store the list separator, which can be set to any character, like ""_ = `;"". (The semicolon needs to be escaped with the back apostrophe.) #15 - Posted 26 February 2006 - 02:39 AM Back to top Page 1 of 2 1 2 Next Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"by Laszlo - Function library to manipulate comma delimited lists. Forum thread:."	"true"
"Maths"	"calc()"	"https://autohotkey.com/board/topic/59087-func-calc-math-expression-evaluation-incl-brackets/?p=655135"	"math expression evaluation incl brackets"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[func] calc() - math expression evaluation incl brackets - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. [func] calc() - math expression evaluation incl brackets Started by derRaphael , Oct 15 2010 08:45 PM Please log in to reply 7 replies to this topic derRaphael Members 872 posts Last active: Mar 19 2013 04:42 PM Joined: 23 Nov 2007 This very compacted function (its not perfect - i know) allows calculating expressions given by a string. it also supports the following functions: sqrt, log, ln, exp, sin, cos, tan, asin, acos, atan, rad, deg, abs, fib, gcb, min, max, sgn, **, ^, *, /, //, +, -, %, pi, e. it may be extended more or less easily. its just another evaluating function. there are better alternatives (but also more complex) like the ones from laszlo (monster, eval, and friends). basically i wrote this one to see how far an expession evaluating function can be compacted and still having a fair amount of functionality. ; dRs CALC! - http://www.opensource.org/licenses/mit-license.html term1 := ""10 * (10 + 12) / (5 * (8 + 2 * (1 + 3)) * (50 + 2))"" term2 := ""1 * 2-1 * sin( cos(pi) )"" term3 := ""sqrt(2^2/2)*(2**(1/2))"" term4 := ""6 % 4"" term5 := ""( 1 + 1 + 1 ) !"" term6 := ""fib(6)""  msgbox % term1 "" = "" calc( term1 )    . ""`n"" term2 "" = "" calc( term2 )   . ""`n"" term3 "" = "" calc( term3 )   . ""`n"" term4 "" = "" calc( term4 )   . ""`n"" term5 "" = "" calc( term5 )   . ""`n"" term6 "" = "" calc( term6 ) exitapp  calc( t, t0="""", t1="""", t2="""" ) {   ; c-labeled functions by Laszlo: http://www.autohotkey.com/forum/topic17058.html    static f := ""sqrt|log|ln|exp|sin|cos|tan|asin|acos|atan|rad|deg|abs"", c := ""fib|gcb|min|max|sgn""           o := ""\*\*|\^|\*|/|//|\+|\-|%"", pi:=""pi"", e:=""e""    if ( t0 = ""fib""  && t1 != """" && t2 != """" ) {       a := 0, b := 1        Loop % abs(t1)-1          c := b, b += a, a := c       return t1=0 ? 0 : t1>0 || t1&1 ? b : -b    } else if ( t0 != """" && RegExMatch( t0, ""("" f ""|"" c ""|"" o ""|!)"" ) && t1 != """" && t2 != """" )       return t0 == ""**"" ? t1 ** t2 : t0 == ""^"" ? t1 ** t2             : t0 == ""*"" ? t1 * t2   : t0 == ""/"" ? t1 / t2 : t0 == ""+"" ? t1 + t2 : t0 == ""-"" ? t1 - t2           : t0 == ""//"" ? t1 // t2 : t0 == ""%"" ? Mod( t1, t2 ) : t0 = ""abs"" ? abs( calc( t1 ) )           : t0 == ""!"" ? ( t1 < 2 ? 1 : t1 * calc( t, t0, t1-1, 0 ) )           : t0 = ""log"" ? log( calc( t1 ) ) : t0 = ""ln"" ? ln( calc ( t1 ) )           : t0 = ""sqrt"" ? sqrt( calc( t1 ) ) : t0 = ""exp"" ? Exp( calc ( t1 ) )           : t0 = ""rad"" ? calc( calc( t1 ) ""* pi / 180"" ) : t0 = ""deg"" ? calc( calc( t1 ) ""* 180 / pi"" )           : t0 = ""sin"" ? sin( calc( ""rad("" t1 "")"" ) ) : t0 = ""asin"" ? asin( calc( ""rad("" t1 "")"" ) )           : t0 = ""cos"" ? cos( calc( ""rad("" t1 "")"" ) ) : t0 = ""acos"" ? acos( calc( ""rad("" t1 "")"" ) )           : t0 = ""tan"" ? tan( calc( ""rad("" t1 "")"" ) ) : t0 = ""atan"" ? atan( calc( ""rad("" t1 "")"" ) )           : t0 = ""min"" ? ( t1 < t2 ? t1 : t2 ) : t0 = ""max"" ? ( t1 < t2 ? t2 : t1 )           : t0 = ""gcd"" ? ( t2 = 0 ? abs(t1) : calc( t, t0, calc( t1 ""%"" t2 ) ) )           : t0 = ""sgn"" ? (t1>0)-(t1<0) : 0        t := RegExReplace( t, ""\s*"", """" )    while ( RegExMatch( t, ""i)"" f ""|"" c ""|"" o ""|"" pi ""|"" e ""|!"" ) )       if ( RegExMatch( t, ""i)\b"" pi ""\b"" ) )          t := RegExReplace( t, ""i)\b"" pi ""\b"", 4 * atan(1) )       else if ( RegExMatch( t, ""i)\b"" e ""\b"" ) )          t := RegExReplace( t, ""i)\b"" e ""\b"", 2.718281828459045 )       else if ( RegExMatch( t, ""i)("" f ""|"" c "").*"", s )               && RegExMatch( s, ""(?>[^\(\)]*)\((?>[^\(\)]*)(?R)*(?>[^\(\)]*)\)"", m )             && RegExMatch( m, ""(?P<0>[^(]+)\((?P<1>[^,]*)(,(?P<2>.*))?\)"", p ) )          t := RegExReplace( t, ""\Q"" p ""\E"", calc( """", p0, p1, p2 != """" ? p2 : 0 ) )       else if ( RegExMatch( t, ""(?P<1>-*\d+(\.\d+)?)!"", p) )          t := RegExReplace( t, ""\Q"" p ""\E"", calc( """", ""!"", p1, 0 ) )       else if ( RegExMatch( t, ""\((?P<0>[^(]+)\)"", p ) )          t := RegExReplace( t, ""\Q("" p0 "")\E"", calc( p0 ) )       else          loop, parse, o, |             while ( RegExMatch( t, ""(?P<1>-*\d+(\.\d+)?)(?P<0>"" A_LoopField "")(?P<2>-*\d+(\.\d+)?)"", p ) )                t := RegExReplace( t, ""\Q"" p ""\E"", calc( """", p0, p1, p2 ) )    return t }  esc::exitapp greets dR #1 - Posted 15 October 2010 - 08:45 PM All scripts, unless otherwise noted, are hereby released under CC-BY Back to top Uberi Moderators 1119 posts Last active: May 02 2015 06:05 PM Joined: 23 Aug 2010 Amazing! This seems like a very good alternative when Monster is too big and complicated. Just one question: is there an alternative to recursion? For example, with a loop and a pseudo-stack? #2 - Posted 16 October 2010 - 01:53 AM AutoHotkey.net | GitHub My default license. Back to top derRaphael Members 872 posts Last active: Mar 19 2013 04:42 PM Joined: 23 Nov 2007 at the current stage of development - the function is designed to work only due to recursion. probably it might be redesigned in a manner to use internal jumplabels thus avoiding the recursions. thx for the interest. greets dR #3 - Posted 16 October 2010 - 12:28 PM All scripts, unless otherwise noted, are hereby released under CC-BY Back to top Smurth Members 120 posts Last active: Feb 23 2014 09:58 PM Joined: 13 Dec 2006 Hi, Great script; exactly what I need... But I've found one bug: when I try to call calc with something like cos(90), cos(179), etc., AutoHotkey goes in an endless loop I've tried with AutoHotkey and AHK_L, under XP and Win7. Still the same. #4 - Posted 28 February 2011 - 09:41 PM Back to top robertcollier4 Members 141 posts Last active: Apr 14 2016 06:24 AM Joined: 11 Nov 2012 But I've found one bug: when I try to call calc with something like cos(90), cos(179), etc., AutoHotkey goes in an endless loop I've tried with AutoHotkey and AHK_L, under XP and Win7. Still the same.  Found the problem, here's the fix. Find the line: : t0 = ""rad"" ? calc( calc( t1 ) ""* pi / 180"" ) : t0 = ""deg"" ? calc( calc( t1 ) ""* 180 / pi"" ) change to: : t0 = ""rad"" ? calc( t1 )*4*atan(1)/180 : t0 = ""deg"" ? calc( t1 )*180/4*atan(1) #5 - Posted 25 July 2013 - 11:30 PM Back to top Sam. Members 107 posts Last active: May 20 2016 03:50 PM Joined: 14 Nov 2008 Very useful function, thank you!   However, I have found that running  equation=-3+1 MsgBox % calc(equation) ExitApp  seems to result in an infinite loop. #6 - Posted 23 August 2013 - 05:22 PM Back to top robertcollier4 Members 141 posts Last active: Apr 14 2016 06:24 AM Joined: 11 Nov 2012 Seems to infinite loop on any negative number. MsgBox % calc(-5)Something to do with the regex parsing for negative numbers, I tried looking into it but I don't understand some of those Regex tags. The infinite loop seems to occur in the following piece of code.       else          loop, parse, o, |             while ( RegExMatch( t, ""(?P<1>-*\d+(\.\d+)?)(?P<0>"" A_LoopField "")(?P<2>-*\d+(\.\d+)?)"", p ) )                t := RegExReplace( t, ""\Q"" p ""\E"", calc( """", p0, p1, p2 ) )Anyone understand whats going on? This is my favorite calc function since looking for something minimalistic. #7 - Posted 28 August 2013 - 10:06 AM Back to top Lv2 Members 23 posts Last active: Dec 18 2014 05:05 PM Joined: 10 Jun 2014 I don't mean to resurrect an old thread but I happened across this and thought I'd contribute.   The problem stems (I believe) from the regex thinking negative numbers are equations because they contain the character ""-"". It's not ideal but I believe you can use the following to terminate the loop and return negative values.  ; dRs CALC! - http://www.opensource.org/licenses/mit-license.html    Msgbox % Calc(""-3+1"")  exitapp return  Esc::ExitApp  calc( t, t0="""", t1="""", t2="""" ) {   ; c-labeled functions by Laszlo: http://www.autohotkey.com/forum/topic17058.html    static f := ""sqrt|log|ln|exp|sin|cos|tan|asin|acos|atan|rad|deg|abs"", c := ""fib|gcb|min|max|sgn""           o := ""\*\*|\^|\*|/|//|\+|\-|%"", pi:=""pi"", e:=""e""    if ( t0 = ""fib""  && t1 != """" && t2 != """" ) {       a := 0, b := 1        Loop % abs(t1)-1          c := b, b += a, a := c       return t1=0 ? 0 : t1>0 || t1&1 ? b : -b    } else if ( t0 != """" && RegExMatch( t0, ""("" f ""|"" c ""|"" o ""|!)"" ) && t1 != """" && t2 != """" )       return t0 == ""**"" ? t1 ** t2 : t0 == ""^"" ? t1 ** t2             : t0 == ""*"" ? t1 * t2   : t0 == ""/"" ? t1 / t2 : t0 == ""+"" ? t1 + t2 : t0 == ""-"" ? t1 - t2           : t0 == ""//"" ? t1 // t2 : t0 == ""%"" ? Mod( t1, t2 ) : t0 = ""abs"" ? abs( calc( t1 ) )           : t0 == ""!"" ? ( t1 < 2 ? 1 : t1 * calc( t, t0, t1-1, 0 ) )           : t0 = ""log"" ? log( calc( t1 ) ) : t0 = ""ln"" ? ln( calc ( t1 ) )           : t0 = ""sqrt"" ? sqrt( calc( t1 ) ) : t0 = ""exp"" ? Exp( calc ( t1 ) )           : t0 = ""rad"" ? calc( t1 )*4*atan(1)/180 : t0 = ""deg"" ? calc( t1 )*180/4*atan(1)           : t0 = ""sin"" ? sin( calc( ""rad("" t1 "")"" ) ) : t0 = ""asin"" ? asin( calc( ""rad("" t1 "")"" ) )           : t0 = ""cos"" ? cos( calc( ""rad("" t1 "")"" ) ) : t0 = ""acos"" ? acos( calc( ""rad("" t1 "")"" ) )           : t0 = ""tan"" ? tan( calc( ""rad("" t1 "")"" ) ) : t0 = ""atan"" ? atan( calc( ""rad("" t1 "")"" ) )           : t0 = ""min"" ? ( t1 < t2 ? t1 : t2 ) : t0 = ""max"" ? ( t1 < t2 ? t2 : t1 )           : t0 = ""gcd"" ? ( t2 = 0 ? abs(t1) : calc( t, t0, calc( t1 ""%"" t2 ) ) )           : t0 = ""sgn"" ? (t1>0)-(t1<0) : 0        t := RegExReplace( t, ""\s*"", """" )    while ( RegExMatch( t, ""i)"" f ""|"" c ""|"" o ""|"" pi ""|"" e ""|!"" ) )       if ( RegExMatch( t, ""i)\b"" pi ""\b"" ) )          t := RegExReplace( t, ""i)\b"" pi ""\b"", 4 * atan(1) )       else if ( RegExMatch( t, ""i)\b"" e ""\b"" ) )          t := RegExReplace( t, ""i)\b"" e ""\b"", 2.718281828459045 )       else if ( RegExMatch( t, ""i)("" f ""|"" c "").*"", s )               && RegExMatch( s, ""(?>[^\(\)]*)\((?>[^\(\)]*)(?R)*(?>[^\(\)]*)\)"", m )             && RegExMatch( m, ""(?P<0>[^(]+)\((?P<1>[^,]*)(,(?P<2>.*))?\)"", p ) )          t := RegExReplace( t, ""\Q"" p ""\E"", calc( """", p0, p1, p2 != """" ? p2 : 0 ) )       else if ( RegExMatch( t, ""(?P<1>-*\d+(\.\d+)?)!"", p) )          t := RegExReplace( t, ""\Q"" p ""\E"", calc( """", ""!"", p1, 0 ) )       else if ( RegExMatch( t, ""\((?P<0>[^(]+)\)"", p ) )          t := RegExReplace( t, ""\Q("" p0 "")\E"", calc( p0 ) )       else 		loop, parse, o, | 			{ 				while ( RegExMatch( t, ""(?P<1>-*\d+(\.\d+)?)(?P<0>"" A_LoopField "")(?P<2>-*\d+(\.\d+)?)"", p ) ) 					t := RegExReplace( t, ""\Q"" p ""\E"", calc( """", p0, p1, p2 ) ) 				If ( RegExMatch(SubStr(t, 2), ""[(\*\*)\^\*(//)/\+\-`%]"") = 0 ) 					return t 			}    return t }  #8 - Posted 10 June 2014 - 09:59 AM Back to top Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"math expression evaluation incl brackets"	"true"
"Maths"	"Eval"	"https://github.com/pulover/eval"	"by Pulover - Evaluate expressions in strings. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"1"	"1"	"0"	"GitHub - Pulover/Eval: AHK Function to evaluate expressions dynamically in strings. Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 1 Star 1 Fork 0 Pulover/Eval Code Issues 0 Pull requests 0 Pulse Graphs AHK Function to evaluate expressions dynamically in strings. https://autohotkey.com/boards/viewtopic.php?f=6&t=13565 32 commits 1 branch 7 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show v1.1.6 v1.1.5 v1.1.4 v1.1.3 v1.1.2 v1.1.1 v1.1 Nothing to show New pull request Latest commit 99cdcc8 Apr 27, 2016 Pulover Updated ReadMe. Permalink Failed to load latest commit information. Examples Added support for dynamic references of objects and functions. Mar 13, 2016 Eval.ahk * Fixed identical function or object calls in being executed only once. Apr 27, 2016 LICENSE README.md Updated ReadMe. Apr 27, 2016 README.md Eval() Evaluate Expressions Dynamically in Strings. Credits ExprEval() by Uberi Return An array (object) with the result of each expression. Parameters String: The input string to be evaluated. You can enter multiple expressions separated by commas (inside the string). CustomVars [optional] An Associative Array object containing variables names as keys and values to replace them. For example, setting it to {A_Index: A_Index} inside a loop will replace occurrences of A_Index with the correct value for the iteration. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/pulover/eval"	"by Pulover - Evaluate expressions in strings. Forum thread:"	"true"
"Maths"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=13565"	"by Pulover - Evaluate expressions in strings. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Eval - Evaluate Expressions in Strings Dynamically (Updated 04/27/2016) - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:27 All times are UTC-05:00 Eval - Evaluate Expressions in Strings Dynamically (Updated 04/27/2016) Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 20 posts • Page 1 of 1 Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Eval - Evaluate Expressions in Strings Dynamically (Updated 04/27/2016) Report this post Quote 31 Jan 2016, 23:33 Array := Eval(String [, CustomVars]) This is my take on the Eval() function. The actual evaluation is done by Uberi's ExprEval(), but I've added parsers to support objects and ternary. There's also an optional parameter to set Custom Variables, mostly usable to resolve built-in variables like A_Index, A_LoopField, etc. Usage is explained in the header. Code: [Select all] [Expand] [Download] (Eval.ahk)GeSHi © Codebox Plus ;======================================================================================= ; ; Function:			Eval ; Description:		Evaluate Expressions in Strings. ; Return value:		An array (object) with the result of each expression. ; ; Author:			Pulover [Rodolfo U. Batista] ; Credits:			ExprEval() by Uberi ; ;======================================================================================= ; ; Parameters: ; ;	$x:				The input string to be evaluated. You can enter multiple expressions ;						separated by commas (inside the string). ;	_CustomVars:	An optional Associative Array object containing variables names ;					  as keys and values to replace them. ;					For example, setting it to {A_Index: A_Index} inside a loop will replace ;						occurrences of A_Index with the correct value for the iteration. ;	_Init:			Used internally for the recursive calls. If TRUE it resets the static ;						object _Objects, which holds objects references to be restored. ; ;======================================================================================= Eval($x, _CustomVars := """", _Init := true) { 	Static _Objects 	_Elements := {} 	If (_Init) 		_Objects := {}   	; Strip off comments 	$x := RegExReplace($x, ""U)/\*.*\*/""), $x := RegExReplace($x, ""U)\s;.*(\v|$)"")   	; Replace brackets, braces, parenthesis and literal strings   	While (RegExMatch($x, ""sU)"""".*"""""", _String)) 		_Elements[""&_String"" A_Index ""_&""] := _String 	,	$x := RegExReplace($x, ""sU)"""".*"""""", ""&_String"" A_Index ""_&"",, 1) 	While (RegExMatch($x, ""\[([^\[\]]++|(?R))*\]"", _Bracket)) 		_Elements[""&_Bracket"" A_Index ""_&""] := _Bracket 	,	$x := RegExReplace($x, ""\[([^\[\]]++|(?R))*\]"", ""&_Bracket"" A_Index ""_&"",, 1) 	While (RegExMatch($x, ""\{[^\{\}]++\}"", _Brace)) 		_Elements[""&_Brace"" A_Index ""_&""] := _Brace 	,	$x := RegExReplace($x, ""\{[^\{\}]++\}"", ""&_Brace"" A_Index ""_&"",, 1) 	While (RegExMatch($x, ""\(([^()]++|(?R))*\)"", _Parent)) 		_Elements[""&_Parent"" A_Index ""_&""] := _Parent 	,	$x := RegExReplace($x, ""\(([^()]++|(?R))*\)"", ""&_Parent"" A_Index ""_&"",, 1)   	; Split multiple expressions 	$z := StrSplit($x, "","", "" `t"")   	For $i, $v in $z 	{ 		; Check for Ternary expression and evaluate 		If (RegExMatch($z[$i], ""([^\?:]+?)\?([^\?:]+?):(.*)"", _Match)) 		{ 			Loop, 3 			{ 				$o := A_Index, _Match%$o% := Trim(_Match%$o%) 			,	_Match%$o% := RestoreElements(_Match%$o%, _Elements) 			} 			EvalResult := Eval(_Match1, _CustomVars, false) 		,	$y := EvalResult[1] 			If ($y) 			{ 				EvalResult := Eval(_Match2, _CustomVars, false) 			,	$y := StrJoin(EvalResult,, true, false) 			,	ObjName := RegExReplace(_Match2, ""\W"", ""_"") 				If (IsObject($y)) 					_Objects[ObjName] := $y 				$z[$i] := StrReplace($z[$i], _Match, IsObject($y) ? """"""<~#"" ObjName ""#~>"""""" : $y) 			} 			Else 			{ 				EvalResult := Eval(_Match3, _CustomVars, false) 			,	$y := StrJoin(EvalResult,, true, false) 			,	ObjName := RegExReplace(_Match3, ""\W"", ""_"") 				If (IsObject($y)) 					_Objects[ObjName] := $y 				$z[$i] := StrReplace($z[$i], _Match, IsObject($y) ? """"""<~#"" ObjName ""#~>"""""" : $y) 			} 		}   		_Pos := 1 		; Check for Object calls 		While (RegExMatch($z[$i], ""([\w%]+)(\.|&_Bracket|&_Parent\d+_&)[\w\.&%]+(.*)"", _Match, _Pos)) 		{ 			AssignParse(_Match, VarName, Oper, VarValue) 			If (Oper != """") 			{ 				VarValue := RestoreElements(VarValue, _Elements) 			,	EvalResult := Eval(VarValue, _CustomVars, false) 			,	VarValue := StrJoin(EvalResult) 				If (!IsObject(VarValue)) 					VarValue := RegExReplace(VarValue, """"""{2,2}"", """""""") 			} 			Else 				_Match := StrReplace(_Match, _Match3), VarName := _Match   			VarName := RestoreElements(VarName, _Elements)   			If _Match1 is Number 			{ 				_Pos += StrLen(_Match1) 				continue 			}   			$y := ParseObjects(VarName, _CustomVars, Oper, VarValue) 		,	ObjName := RegExReplace(_Match, ""\W"", ""_"")   			If (IsObject($y)) 				_Objects[ObjName] := $y 			Else If $y is not Number 			{ 				$y := """""""" StrReplace($y, """""""", """""""""""") """""""" 			,	HidString := ""&_String"" (ObjCount(_Elements) + 1) ""_&"" 			,	_Elements[HidString] := $y 			,	$y := HidString 			} 			$z[$i] := StrReplace($z[$i], _Match, IsObject($y) ? """"""<~#"" ObjName ""#~>"""""" : $y,, 1) 		}   		; Assign Arrays 		While (RegExMatch($z[$i], ""&_Bracket\d+_&"", $pd)) 		{ 			$z[$i] := StrReplace($z[$i], $pd, _Elements[$pd],, 1) 		,	RegExMatch($z[$i], ""\[(.*)\]"", _Match) 		,	_Match1 := RestoreElements(_Match1, _Elements) 		,	$y := Eval(_Match1, _CustomVars, false) 		,	ObjName := RegExReplace(_Match, ""\W"", ""_"") 		,	_Objects[ObjName] := $y 		,	$z[$i] := StrReplace($z[$i], _Match, """"""<~#"" ObjName ""#~>"""""") 		}   		; Assign Associative Arrays 		While (RegExMatch($z[$i], ""&_Brace\d+_&"", $pd)) 		{ 			$y := {}, o_Elements := {} 		,	$o := _Elements[$pd] 		,	$o := RestoreElements($o, _Elements) 		,	$o := SubStr($o, 2, -1) 			While (RegExMatch($o, ""sU)"""".*"""""", _String%A_Index%)) 				o_Elements[""&_String"" A_Index ""_&""] := _String%A_Index% 			,	$o := RegExReplace($o, ""sU)"""".*"""""", ""&_String"" A_Index ""_&"", """", 1) 			While (RegExMatch($o, ""\[([^\[\]]++|(?R))*\]"", _Bracket)) 				o_Elements[""&_Bracket"" A_Index ""_&""] := _Bracket 			,	$o := RegExReplace($o, ""\[([^\[\]]++|(?R))*\]"", ""&_Bracket"" A_Index ""_&"",, 1) 			While (RegExMatch($o, ""\{[^\{\}]++\}"", _Brace)) 				o_Elements[""&_Brace"" A_Index ""_&""] := _Brace 			,	$o := RegExReplace($o, ""\{[^\{\}]++\}"", ""&_Brace"" A_Index ""_&"",, 1) 			While (RegExMatch($o, ""\(([^()]++|(?R))*\)"", _Parent)) 				o_Elements[""&_Parent"" A_Index ""_&""] := _Parent 			,	$o := RegExReplace($o, ""\(([^()]++|(?R))*\)"", ""&_Parent"" A_Index ""_&"",, 1) 			Loop, Parse, $o, `,, %A_Space%%A_Tab% 			{ 				$o := StrSplit(A_LoopField, "":"", "" `t"") 			,	$o.1 := RestoreElements($o.1, o_Elements) 			,	$o.2 := RestoreElements($o.2, o_Elements) 			,	EvalResult := Eval($o.2, _CustomVars, false) 			,	$o.1 := Trim($o.1, """""""") 			,	$y[$o.1] := EvalResult[1] 			} 			ObjName := RegExReplace(_Match, ""\W"", ""_"") 		,	_Objects[ObjName] := $y 		,	$z[$i] := StrReplace($z[$i], $pd, """"""<~#"" ObjName ""#~>"""""") 		}   		; Restore and evaluate any remaining parenthesis 		While (RegExMatch($z[$i], ""&_Parent\d+_&"", $pd)) 		{ 			_oMatch := StrSplit(_Elements[$pd], "","", "" `t()"") 		,	_Match := RegExReplace(_Elements[$pd], ""\((.*)\)"", ""$1"") 		,	_Match := RestoreElements(_Match, _Elements) 		,	EvalResult := Eval(_Match, _CustomVars, false) 		,	RepString := ""("" 			For _i, _v in EvalResult 			{ 				ObjName := RegExReplace($pd . _i, ""\W"", ""_"") 				If (IsObject(_v)) 					_Objects[ObjName] := _v 				Else If _v is not Number 				{ 					If (_oMatch[_i] != """") 					{ 						_v := """""""" _v """""""" 					,	HidString := ""&_String"" (ObjCount(_Elements) + 1) ""_&"" 					,	_Elements[HidString] := _v 					,	_v := HidString 					} 				} 				RepString .= (IsObject(_v) ? """"""<~#"" ObjName ""#~>"""""" : _v) "", "" 			} 			RepString := RTrim(RepString, "", "") "")"" 		,	$z[$i] := StrReplace($z[$i], $pd, RepString,, 1) 		}   		; Check whether the whole string is an object 		$y := $z[$i] 		Try 		{ 			If (_CustomVars.HasKey($y)) 			{ 				If (IsObject(_CustomVars[$y])) 				{ 					ObjName := RegExReplace($y, ""\W"", ""_"") 				,	_Objects[ObjName] := _CustomVars[$y].Clone() 				,	$z[$i] := """"""<~#"" ObjName ""#~>"""""" 				} 			} 			Else If (IsObject(%$y%)) 			{ 				ObjName := RegExReplace($y, ""\W"", ""_"") 			,	_Objects[ObjName] := %$y%.Clone() 			,	$z[$i] := """"""<~#"" ObjName ""#~>"""""" 			} 		}   		; Check for Functions 		While (RegExMatch($z[$i], ""s)([\w%]+)\((.*?)\)"", _Match)) 		{ 			_Match1 := (RegExMatch(_Match1, ""^%(\S+)%$"", $pd)) ? %$pd1% : _Match1 		,	_Match2 := RestoreElements(_Match2, _Elements) 		,	_Params := Eval(_Match2, _CustomVars) 		,	$y := %_Match1%(_Params*) 		,	ObjName := RegExReplace(_Match, ""\W"", ""_"") 			If (IsObject($y)) 				_Objects[ObjName] := $y 			Else If $y is not Number 			{ 				$y := """""""" $y """""""" 			,	HidString := ""&_String"" (ObjCount(_Elements) + 1) ""_&"" 			,	_Elements[HidString] := $y 			,	$y := HidString 			} 			$z[$i] := StrReplace($z[$i], _Match, IsObject($y) ? """"""<~#"" ObjName ""#~>"""""" : $y,, 1) 		}   		; Dereference variables in percent signs 		While (RegExMatch($z[$i], ""U)%(\S+)%"", _Match)) 			EvalResult := Eval(_Match1, _CustomVars, false) 		,	$z[$i] := StrReplace($z[$i], _Match, EvalResult[1])   		; ExprEval() cannot parse Unicode strings, so the ""real"" strings are ""hidden"" from ExprCompile() and restored later 		$z[$i] := RestoreElements($z[$i], _Elements) 	,	__Elements := {} 		While (RegExMatch($z[$i], ""sU)""""(.*)"""""", _String)) 			__Elements[""&_String"" A_Index ""_&""] := _String1 		,	$z[$i] := RegExReplace($z[$i], ""sU)"""".*"""""", ""&_String"" A_Index ""_&"",, 1) 		$z[$i] := RegExReplace($z[$i], ""&_String\d+_&"", """"""$0"""""")   		; Add concatenate operator after strings where necessary 		While (RegExMatch($z[$i], ""(""""&_String\d+_&""""\s+)([^\d\.,\s:\?])"")) 			$z[$i] := RegExReplace($z[$i], ""(""""&_String\d+_&""""\s+)([^\d\.,\s:\?])"", ""$1. $2"")   		; Evaluate parsed expression with ExprEval() 		ExprInit() 	,	CompiledExpression := ExprCompile($z[$i]) 	,	$Result := ExprEval(CompiledExpression, _CustomVars, _Objects, __Elements) 	,	$Result := StrSplit($Result, Chr(1))   		; Restore object references 		For _i, _v in $Result 		{ 			If (RegExMatch(_v, ""^<~#(.*)#~>$"", $pd)) 				$Result[_i] := _Objects[$pd1] 		}   		$z[$i] := StrJoin($Result,, false, _Init) 	}   	; If returning to the original call, remove missing expressions from the array 	If (_Init) 	{ 		$x := StrSplit($x, "","", "" `t"") 		For _i, _v in $x 		{ 			If (_v = """") 				$z.Delete(_i) 		} 	}   	return $z }   ParseObjects(v_String, _CustomVars := """", o_Oper := """", o_Value := """") { 	Static _needle := ""([\w%]+\.?|\(([^()]++|(?R))*\)\.?|\[([^\[\]]++|(?R))*\]\.?)""   	l_Matches := [], _Pos := 1 	While (_Pos := RegExMatch(v_String, _needle, l_Found, _Pos)) 		l_Matches.Push(RegExMatch(RTrim(l_Found, "".""), ""^%(\S+)%$"", $pd) ? %$pd1% : RTrim(l_Found, ""."")) 	,	_Pos += StrLen(l_Found) 	v_Obj := l_Matches[1] 	If (_CustomVars.HasKey(v_Obj)) 		_ArrayObject := _CustomVars[v_Obj] 	Else 		Try _ArrayObject := %v_Obj% 	For $i, $v in l_Matches 	{ 		If (RegExMatch($v, ""^\((.*)\)$"")) 			continue 		If (RegExMatch($v, ""^\[(.*)\]$"", l_Found)) 			_Key := Eval(l_Found1, _CustomVars, false) 		Else 			_Key := [$v] 		$n := l_Matches[$i + 1] 		If (RegExMatch($n, ""^\((.*)\)$"", l_Found)) 		{ 			_Key := _Key[1] 		,	_Params := Eval(l_Found1, _CustomVars, false)   			Try 			{ 				If ($i = 1) 					_ArrayObject := %_Key%(_Params*) 				Else 					_ArrayObject := _ArrayObject[_Key](_Params*) 			} 			Catch e 			{ 				If (InStr(e.Message, ""0x800A03EC"")) 				{ 					; Workaround for strange bug in some Excel methods 					For _i, _v in _Params 						_Params[_i] := "" "" _v   					If ($i = 1) 						_ArrayObject := %_Key%(_Params*) 					Else 						_ArrayObject := _ArrayObject[_Key](_Params*) 				} 				Else 					Throw e 			} 		} 		Else If (($i = l_Matches.Length()) && (o_Value != """")) 		{ 			Try 			{ 				If (o_Oper = "":="") 					_ArrayObject := _ArrayObject[_Key*] := o_Value ? o_Value : false 				Else If (o_Oper = ""+="") 					_ArrayObject := _ArrayObject[_Key*] += o_Value ? o_Value : false 				Else If (o_Oper = ""-="") 					_ArrayObject := _ArrayObject[_Key*] -= o_Value ? o_Value : false 				Else If (o_Oper = ""*="") 					_ArrayObject := _ArrayObject[_Key*] *= o_Value ? o_Value : false 				Else If (o_Oper = ""/="") 					_ArrayObject := _ArrayObject[_Key*] /= o_Value ? o_Value : false 				Else If (o_Oper = ""//="") 					_ArrayObject := _ArrayObject[_Key*] //= o_Value ? o_Value : false 				Else If (o_Oper = "".="") 					_ArrayObject := _ArrayObject[_Key*] .= o_Value ? o_Value : false 				Else If (o_Oper = ""|="") 					_ArrayObject := _ArrayObject[_Key*] |= o_Value ? o_Value : false 				Else If (o_Oper = ""&="") 					_ArrayObject := _ArrayObject[_Key*] &= o_Value ? o_Value : false 				Else If (o_Oper = ""^="") 					_ArrayObject := _ArrayObject[_Key*] ^= o_Value ? o_Value : false 				Else If (o_Oper = "">>="") 					_ArrayObject := _ArrayObject[_Key*] >>= o_Value ? o_Value : false 				Else If (o_Oper = ""<<="") 					_ArrayObject := _ArrayObject[_Key*] <<= o_Value ? o_Value : false 			} 		} 		Else If ($i > 1) 			_ArrayObject := _ArrayObject[_Key*] 	} 	return _ArrayObject }   RestoreElements(_String, _Elements) { 	While (RegExMatch(_String, ""&_\w+_&"", $pd)) 		_String := StrReplace(_String, $pd, _Elements[$pd]) 	return _String }   AssignParse(String, ByRef VarName, ByRef Oper, ByRef VarValue) { 	RegExMatch(String, ""(.*?)(:=|\+=|-=|\*=|/=|//=|\.=|\|=|&=|\^=|>>=|<<=)(?=([^""""]*""""[^""""]*"""")*[^""""]*$)(.*)"", Out) ,	VarName := Trim(Out1), Oper := Out2, VarValue := Trim(Out4) }   StrJoin(InputArray, JChr := """", Quote := false, Init := true) { 	For i, v in InputArray 	{ 		If (IsObject(v)) 			return v 		If v is not Number 		{ 			If (!Init) 				v := RegExReplace(v, """"""{1,2}"", """""""""""") 			If (Quote) 				v := """""""" v """""""" 		} 		JoinedStr .= v . JChr 	} 	If (JChr != """") 		JoinedStr := SubStr(JoinedStr, 1, -(StrLen(JChr))) 	return JoinedStr }   ObjCount(Obj) { 	return NumGet(&Obj + 4 * A_PtrSize) }   ;################################################## ; Author: Uberi ; Modified by: Pulover ; http://autohotkey.com/board/topic/64167-expreval-evaluate-expressions/ ;################################################## ExprInit() { 	global 	Exprot:=""`n:= 0 R 2`n+= 0 R 2`n-= 0 R 2`n*= 0 R 2`n/= 0 R 2`n//= 0 R 2`n.= 0 R 2`n|= 0 R 2`n&= 0 R 2`n^= 0 R 2`n>>= 0 R 2`n<<= 0 R 2`n|| 3 L 2`n&& 4 L 2`n\! 5 R 1`n= 6 L 2`n== 6 L 2`n<> 6 L 2`n!= 6 L 2`n> 7 L 2`n< 7 L 2`n>= 7 L 2`n<= 7 L 2`n\. 8 L 2`n& 9 L 2`n^ 9 L 2`n| 9 L 2`n<< 10 L 2`n>> 10 L 2`n+ 11 L 2`n- 11 L 2`n* 12 L 2`n/ 12 L 2`n// 12 L 2`n\- 13 R 1`n! 13 R 1`n~ 13 R 1`n\& 13 R 1`n\* 13 R 1`n** 14 R 2`n\++ 15 R 1`n\-- 15 R 1`n++ 15 L 1`n-- 15 L 1`n. 16 L 2`n`% 17 R 1`n"",Exprol:=SubStr(RegExReplace(Exprot,""iS) \d+ [LR] \d+\n"",""`n""),2,-1) 	Sort,Exprol,FExprols }   ExprCompile(e) { 	e:=Exprt(e) 	Loop,Parse,e,% Chr(1) 	{ 		lf:=A_LoopField,tt:=SubStr(lf,1,1),to:=SubStr(lf,2) 		If tt=f 		Exprp1(s,lf) 		Else If lf=, 		{ 			While,s<>""""&&Exprp3(s)<>""("" 			Exprp1(ou,Exprp2(s)) 		} 		Else If tt=o 		{ 			While,SubStr(so:=Exprp3(s),1,1)=""o"" 			{ 				ta:=Expras(to),tp:=Exprpr(to),sop:=Exprpr(SubStr(so,2)) 				If ((ta=""L""&&tp>sop)||(ta=""R""&&tp>=sop)) 				Break 				Exprp1(ou,Exprp2(s)) 			} 			Exprp1(s,lf) 		} 		Else If lf=( 		Exprp1(s,""("") 		Else If lf=) 		{ 			While,Exprp3(s)<>""("" 			{ 				If s= 				Return 				Exprp1(ou,Exprp2(s)) 			} 			Exprp2(s) 			If (SubStr(Exprp3(s),1,1)=""f"") 			Exprp1(ou,Exprp2(s)) 		} 		Else Exprp1(ou,lf) 	} 	While,s<>"""" 	{ 		t1:=Exprp2(s) 		If t1 In (,) 		Return 		Exprp1(ou,t1) 	} 	Return,ou }   ExprEval(e,lp,eo,el) { 	c1:=Chr(1) 	Loop,Parse,e,%c1% 	{ 		lf:=A_LoopField,tt:=SubStr(lf,1,1),t:=SubStr(lf,2) 		While (RegExMatch(lf,""&_String\d+_&"",rm)) 		lf:=StrReplace(lf,rm,el[rm]) 		If tt In l,v 		lf:=Exprp1(s,lf) 		Else{ 			If tt=f 			t1:=InStr(t,"" ""),a:=SubStr(t,1,t1-1),t:=SubStr(t,t1+1) 			Else a:=Exprac(t) 			Exprp1(s,Exprap(t,s,a,lp,eo)) 		} 	}   	Loop,Parse,s,%c1% 	{ 		lf:=A_LoopField 		If (SubStr(lf,1,1)=""v"") 		t1:=SubStr(lf,2),r.=(lp.HasKey(t1) ? lp[t1] : %t1%) . c1 		Else r.=SubStr(lf,2) . c1 	} 	Return,SubStr(r,1,-1) }   Exprap(o,ByRef s,ac,lp,eo) { 	local i,t1,a1,a2,a3,a4,a5,a6,a1v,a2v,a3v,a4v,a5v,a6v,a7v,a8v,a9v 	Loop,%ac% 	i:=ac-(A_Index-1),t1:=Exprp2(s),a%i%:=SubStr(t1,2),(SubStr(t1,1,1)=""v"")?(a%i%v:=1) 	Loop, 10 	{ 		If (RegExMatch(a%A_Index%,""^<~#(.*)#~>$"",rm)) 		a%A_Index%:=eo[rm1],a%A_Index%v:=0 		Else If (lp.HasKey(a%A_Index%)) 		a%A_Index%:=lp[a%A_Index%],a%A_Index%v:=0 	} 	If o=++ 	Return,""l"" . %a1%++ 	If o=-- 	Return,""l"" . %a1%-- 	If o=\++ 	Return,""l"" . ++%a1% 	If o=\-- 	Return,""l"" . --%a1% 	If o=`% 	Return,""v"" . %a1% 	If o=! 	Return,""l"" . !(a1v ? %a1%:a1) 	If o=\! 	Return,""l"" . (a1v ? %a1%:a1) 	If o=~ 	Return,""l"" . ~(a1v ? %a1%:a1) 	If o=** 	Return,""l"" . ((a1v ? %a1%:a1)**(a2v ? %a2%:a2)) 	If o=* 	Return,""l"" . ((a1v ? %a1%:a1)*(a2v ? %a2%:a2)) 	If o=\* 	Return,""l"" . *(a1v ? %a1%:a1) 	If o=/ 	Return,""l"" . ((a1v ? %a1%:a1)/(a2v ? %a2%:a2)) 	If o=// 	Return,""l"" . ((a1v ? %a1%:a1)//(a2v ? %a2%:a2)) 	If o=+ 	Return,""l"" . ((a1v ? %a1%:a1)+(a2v ? %a2%:a2)) 	If o=- 	Return,""l"" . ((a1v ? %a1%:a1)-(a2v ? %a2%:a2)) 	If o=\- 	Return,""l"" . -(a1v ? %a1%:a1) 	If o=<< 	Return,""l"" . ((a1v ? %a1%:a1)<<(a2v ? %a2%:a2)) 	If o=>> 	Return,""l"" . ((a1v ? %a1%:a1)>>(a2v ? %a2%:a2)) 	If o=& 	Return,""l"" . ((a1v ? %a1%:a1)&(a2v ? %a2%:a2)) 	If o=\& 	Return,""l"" . &(a1v ? %a1%:a1) 	If o=^ 	Return,""l"" . ((a1v ? %a1%:a1)^(a2v ? %a2%:a2)) 	If o=| 	Return,""l"" . ((a1v ? %a1%:a1)|(a2v ? %a2%:a2)) 	If o=\. 	Return,""l"" . ((a1v ? %a1%:a1) . (a2v ? %a2%:a2)) 	If o=. 	Return,""v"" . a1 	If o=< 	Return,""l"" . ((a1v ? %a1%:a1)<(a2v ? %a2%:a2)) 	If o=> 	Return,""l"" . ((a1v ? %a1%:a1)>(a2v ? %a2%:a2)) 	If o== 	Return,""l"" . ((a1v ? %a1%:a1)=(a2v ? %a2%:a2)) 	If o=== 	Return,""l"" . ((a1v ? %a1%:a1)==(a2v ? %a2%:a2)) 	If o=<> 	Return,""l"" . ((a1v ? %a1%:a1)<>(a2v ? %a2%:a2)) 	If o=!= 	Return,""l"" . ((a1v ? %a1%:a1)!=(a2v ? %a2%:a2)) 	If o=>= 	Return,""l"" . ((a1v ? %a1%:a1)>=(a2v ? %a2%:a2)) 	If o=<= 	Return,""l"" . ((a1v ? %a1%:a1)<=(a2v ? %a2%:a2)) 	If o=&& 	Return,""l"" . ((a1v ? %a1%:a1)&&(a2v ? %a2%:a2)) 	If o=|| 	Return,""l"" . ((a1v ? %a1%:a1)||(a2v ? %a2%:a2)) 	If o=:= 	{ 		%a1%:=(a2v ? %a2%:a2) 		Return,""v"" . a1 	} 	If o=+= 	{ 		%a1%+=(a2v ? %a2%:a2) 		Return,""v"" . a1 	} 	If o=-= 	{ 		%a1%-=(a2v ? %a2%:a2) 		Return,""v"" . a1 	} 	If o=*= 	{ 		%a1%*=(a2v ? %a2%:a2) 		Return,""v"" . a1 	} 	If o=/= 	{ 		%a1%/=(a2v ? %a2%:a2) 		Return,""v"" . a1 	} 	If o=//= 	{ 		%a1%//=(a2v ? %a2%:a2) 		Return,""v"" . a1 	} 	If o=.= 	{ 		%a1%.=(a2v ? %a2%:a2) 		Return,""v"" . a1 	} 	If o=|= 	{ 		%a1%|=(a2v ? %a2%:a2) 		Return,""v"" . a1 	} 	If o=&= 	{ 		%a1%&=(a2v ? %a2%:a2) 		Return,""v"" . a1 	} 	If o=^= 	{ 		%a1%^=(a2v ? %a2%:a2) 		Return,""v"" . a1 	} 	If o=>>= 	{ 		%a1%>>=(a2v ? %a2%:a2) 		Return,""v"" . a1 	} 	If o=<<= 	{ 		%a1%<<=(a2v ? %a2%:a2) 		Return,""v"" . a1 	} 	If ac=0 	Return,""l"" . %o%() 	If ac=1 	Return,""l"" . %o%(a1v ? %a1%:a1) 	If ac=2 	Return,""l"" . %o%((a1v ? %a1%:a1),(a2v ? %a2%:a2)) 	If ac=3 	Return,""l"" . %o%((a1v ? %a1%:a1),(a2v ? %a2%:a2),(a3v ? %a3%:a3)) 	If ac=4 	Return,""l"" . %o%((a1v ? %a1%:a1),(a2v ? %a2%:a2),(a3v ? %a3%:a3),(a4v ? %a4%:a4)) 	If ac=5 	Return,""l"" . %o%((a1v ? %a1%:a1),(a2v ? %a2%:a2),(a3v ? %a3%:a3),(a4v ? %a4%:a4),(a5v ? %a5%:a5)) 	If ac=6 	Return,""l"" . %o%((a1v ? %a1%:a1),(a2v ? %a2%:a2),(a3v ? %a3%:a3),(a4v ? %a4%:a4),(a5v ? %a5%:a5),(a6v ? %a6%:a6)) 	If ac=7 	Return,""l"" . %o%((a1v ? %a1%:a1),(a2v ? %a2%:a2),(a3v ? %a3%:a3),(a4v ? %a4%:a4),(a5v ? %a5%:a5),(a6v ? %a6%:a6),(a7v ? %a7%:a7)) 	If ac=8 	Return,""l"" . %o%((a1v ? %a1%:a1),(a2v ? %a2%:a2),(a3v ? %a3%:a3),(a4v ? %a4%:a4),(a5v ? %a5%:a5),(a6v ? %a6%:a6),(a7v ? %a7%:a7),(a8v ? %a8%:a8)) 	If ac=9 	Return,""l"" . %o%((a1v ? %a1%:a1),(a2v ? %a2%:a2),(a3v ? %a3%:a3),(a4v ? %a4%:a4),(a5v ? %a5%:a5),(a6v ? %a6%:a6),(a7v ? %a7%:a7),(a8v ? %a8%:a8),(a9v ? %a9%:a9)) 	If ac=10 	Return,""l"" . %o%((a1v ? %a1%:a1),(a2v ? %a2%:a2),(a3v ? %a3%:a3),(a4v ? %a4%:a4),(a5v ? %a5%:a5),(a6v ? %a6%:a6),(a7v ? %a7%:a7),(a8v ? %a8%:a8),(a9v ? %a9%:a9),(a10v ? %a10%:a10)) }   Exprt(e) { 	global Exprol 	c1:=Chr(1),f:=1,f1:=1 	While,(f:=RegExMatch(e,""S)""""(?:[^""""]|"""""""")*"""""",m,f)) 	{ 		t1:=SubStr(m,2,-1) 	,	t1:=StrReplace(t1,"""""""""""","""""""") 	,	t1:=StrReplace(t1,""'"",""'27"") 	,	t1:=StrReplace(t1,""````"",c1) 	,	t1:=StrReplace(t1,""``n"",""`n"") 	,	t1:=StrReplace(t1,""``r"",""`r"") 	,	t1:=StrReplace(t1,""``b"",""`b"") 	,	t1:=StrReplace(t1,""``t"",""`t"") 	,	t1:=StrReplace(t1,""``v"",""`v"") 	,	t1:=StrReplace(t1,""``a"",""`a"") 	,	t1:=StrReplace(t1,""``f"",""`f"") 	,	t1:=StrReplace(t1,c1,""``"") 		SetFormat,IntegerFast,Hex 		While,RegExMatch(t1,""iS)[^\w']"",c) 		t1:=StrReplace(t1,c,""'"" . SubStr(""0"" . SubStr(Asc(c),3),-1)) 		SetFormat,IntegerFast,D 		e1.=SubStr(e,f1,f-f1) . c1 . ""l"" . t1 . c1,f+=StrLen(m),f1:=f 	} 	e1.=SubStr(e,f1),e:=InStr(e1,"""""""")? """":e1,e1:="""",e:=RegExReplace(e,""S)/\*.*?\*/|[ \t]`;.*?(?=\r|\n|$)"") ,	e:=StrReplace(e,""`t"","" "") ,	e:=RegExReplace(e,""S)([\w#@\$] +|\) *)(?="" . Chr(1) . ""*[\w#@\$\(])"",""$1 . "") ,	e:=StrReplace(e,"" . "",""\."") ,	e:=StrReplace(e,"" "") ,	f:=1,f1:=1 	While,(f:=RegExMatch(e,""iS)(^|[^\w#@\$\.'])(0x[0-9a-fA-F]+|\d+(?:\.\d+)?|\.\d+)(?=[^\d\.]|$)"",m,f)) 	{ 		If ((m1=""\"") && (RegExMatch(m2,""\.\d+""))) 		m1:="""",m2:=SubStr(m2,2) 		m2+=0 		m2:=StrReplace(m2,""."",""'2E"",,1) 		e1.=SubStr(e,f1,f-f1) . m1 . c1 . ""n"" . m2 . c1,f+=StrLen(m),f1:=f 	} 	e:=e1 . SubStr(e,f1),e1:="""",e:=RegExReplace(e,""S)(^|\(|[^"" . c1 . ""-])-"" . c1 . ""n"",""$1"" . c1 . ""n'2D"") ,	e:=StrReplace(e,c1 ""n"",c1 ""l"") ,	e:=RegExReplace(e,""\\\.(\d+)\.(\d+)"",c1 . ""l$1'2E$2"" . c1) ,	e:=RegExReplace(RegExReplace(e,""S)(%[\w#@\$]{1,253})%"",""$1""),""S)(?:^|[^\w#@\$'"" . c1 . ""])\K[\w#@\$]{1,253}(?=[^\(\w#@\$]|$)"",c1 . ""v$0"" . c1),f:=1,f1:=1 	While,(f:=RegExMatch(e,""S)(^|[^\w#@\$'])([\w#@\$]{1,253})(?=\()"",m,f)) 	{ 		t1:=f+StrLen(m) 		If (SubStr(e,t1+1,1)="")"") 		ac=0 		Else 		{ 			If !Exprmlb(e,t1,fa) 			Return 			fa:=StrReplace(fa,""`,"",""`,"",c) 			ac:=c+1 		} 		e1.=SubStr(e,f1,f-f1) . m1 . c1 . ""f"" . ac . ""'20"" . m2 . c1,f+=StrLen(m),f1:=f 	} 	e:=e1 . SubStr(e,f1),e1:="""" ,	e:=StrReplace(e,""\."" c1 ""vNot"" c1 ""\."",""!"") ,	e:=StrReplace(e,""\."" c1 ""vAnd"" c1 ""\."",""&&"") ,	e:=StrReplace(e,""\."" c1 ""vOr"" c1 ""\."",""||"") ,	e:=StrReplace(e,c1 ""vNot"" c1 ""\."",""!"") ,	e:=StrReplace(e,c1 ""vAnd"" c1 ""\."",""&&"") ,	e:=StrReplace(e,c1 ""vOr"" c1 ""\."",""||"") ,	e:=RegExReplace(e,""S)(^|[^"" . c1 . ""\)-])-"" . c1 . ""(?=[lvf])"",""$1\-"" . c1) ,	e:=RegExReplace(e,""S)(^|[^"" . c1 . ""\)&])&"" . c1 . ""(?=[lvf])"",""$1\&"" . c1) ,	e:=RegExReplace(e,""S)(^|[^"" . c1 . ""\)\*])\*"" . c1 . ""(?=[lvf])"",""$1\*"" . c1) ,	e:=RegExReplace(e,""S)(^|[^"" . c1 . ""\)])(\+\+|--)"" . c1 . ""(?=[lvf])"",""$1\$2"" . c1) ,	t1:=RegExReplace(Exprol,""S)[\\\.\*\?\+\[\{\|\(\)\^\$]"",""\$0"") ,	t1:=StrReplace(t1,""`n"",""|"") ,	e:=RegExReplace(e,""S)"" . t1,c1 . ""o$0"" . c1) ,	e:=StrReplace(e,""`,"",c1 ""`,"" c1) ,	e:=StrReplace(e,""("",c1 ""("" c1) ,	e:=StrReplace(e,"")"",c1 "")"" c1) ,	e:=StrReplace(e,c1 . c1,c1) 	If RegExMatch(e,""S)"" . c1 . ""[^lvfo\(\),\n]"") 	Return 	e:=SubStr(e,2,-1),f:=0 	While,(f:=InStr(e,""'"",False,f + 1)) 	{ 		If ((t1:=SubStr(e,f+1,2))<>27) 		e:=StrReplace(e,""'"" t1,Chr(""0x"" . t1)) 	} 	e:=StrReplace(e,""'27"",""'"") 	Return,e }   Exprols(o1,o2) { 	Return,StrLen(o2)-StrLen(o1) }   Exprpr(o) { 	global Exprot 	t:=InStr(Exprot,""`n"" . o . "" "")+StrLen(o)+2 	Return,SubStr(Exprot,t,InStr(Exprot,"" "",0,t)-t) }   Expras(o) { 	global Exprot 	Return,SubStr(Exprot,InStr(Exprot,"" "",0,InStr(Exprot,""`n"" . o . "" "")+StrLen(o)+2)+1,1) }   Exprac(o) { 	global Exprot 	Return,SubStr(Exprot,InStr(Exprot,""`n"",0,InStr(Exprot,""`n"" . o . "" "")+1)-1,1) }   Exprmlb(ByRef s,p,ByRef o="""",b=""("",e="")"") { 	t:=SubStr(s,p),bc:=0,VarSetCapacity(o,StrLen(t)) 	If (SubStr(t,1,1)<>b) 	Return,0 	Loop,Parse,t 	{ 		lf:=A_LoopField 		If lf=%b% 		bc++ 		Else If lf=%e% 		{ 			bc-- 			If bc=0 			Return,p 		} 		Else If bc=1 		o.=lf 		p++ 	} 	Return,0 }   Exprp1(ByRef dl,d) { 	dl.=((dl="""")? """":Chr(1)) . d }   Exprp2(ByRef dl) { 	t:=InStr(dl,Chr(1),0,0),t ?(t1:=SubStr(dl,t+1),dl:=SubStr(dl,1,t-1)):(t1:=dl,dl:="""") 	Return,t1 }   Exprp3(ByRef dl) { 	Return,SubStr(dl,InStr(dl,Chr(1),0,0)+1) }     Sources and examples on GitHub Know limitation: Some short variable names used in the ExprEval() should be avoided as they will not be correctly evaluated. The names are a, e, i, o, r, s, t, ac, eo, lf, lp, tt and numbered variations of them like a1, a2... tt1, tt2.... Last edited by Pulover on 27 Apr 2016, 11:25, edited 21 times in total. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top oldbrother Posts: 93 Joined: 23 Oct 2013, 05:08 Re: Eval - Evaluate Expressions in Strings Report this post Quote 01 Feb 2016, 12:59 Is is possible to make ""Eval"" to interact with the main program? Like this: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus #SingleInstance Force #include Eval.ahk SetBatchLines, -1   Var1 :=12 Var2 :=20   Expression := ""Var1 * Var2"" Result := Eval(Expression)   MsgBox %Result%  ; currently not working ExitApp Edited! Sorry, after I added StrJoin(), it worked. Thanks a lot! Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus #SingleInstance Force #include Eval.ahk SetBatchLines, -1   Var1 :=12 Var2 := 24   Expression := ""Var1 *Var2"" Result := Eval(Expression)   r := StrJoin(Result, ""`n"") MsgBox, %r%   ExitApp   Last edited by oldbrother on 01 Feb 2016, 13:11, edited 1 time in total. Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Eval - Evaluate Expressions in Strings Report this post Quote 01 Feb 2016, 13:07 Hello oldbrother, The output is an array, because you can evaluate multiple expressions (e.g. ""Var1 * Var2, Var1 / Var2"") so you have to select one to show. To make your test work you can either do this: Code: [Select all] [Download] GeSHi © Codebox Plus Result := Eval(Expression)[1] ...or this: Code: [Select all] [Download] GeSHi © Codebox Plus MsgBox % Result[1] Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top oldbrother Posts: 93 Joined: 23 Oct 2013, 05:08 Re: Eval - Evaluate Expressions in Strings Report this post Quote 01 Feb 2016, 13:12 Thank you very much! Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Eval - Evaluate Expressions in Strings Report this post Quote 01 Feb 2016, 22:02 Update: Fixed problem solving more than one object reference in the same expression. Fixed problem concatenating object values and other values. Last edited by Pulover on 16 Mar 2016, 20:04, edited 1 time in total. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top oldbrother Posts: 93 Joined: 23 Oct 2013, 05:08 Re: Eval - Evaluate Expressions in Strings Report this post Quote 02 Feb 2016, 12:06 Hi Pulover, Is it possible to get the result form multiple line equations? For example: D :=1.5 L :=2 Pi :=3.14 Str = ( S := Pi * (D/2)**2 V := S * L Weight := V * 0.3 ) And then use Eval to get the result of ""Weight"". Thanks! Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Eval - Evaluate Expressions in Strings Report this post Quote 02 Feb 2016, 16:50 Hi oldbrother, You can use Join, or StrReplace() to replace line breaks with commas. Only trouble is the limitation I mentioned above about variable names used in ExprEval(), I had to rename the ones in your example to make it work. Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus xD :=1.5 xL :=2 Pi :=3.14   Str = (Join, xS := Pi * (xD/2)**2 xV := xS * xL Weight := xV * 0.3 )   Eval(Str) MsgBox % Eval(""Weight"")[1]   I tried to rename variables in Uberi's functions but it stopped working. I will try to change at least a few of them. Edit: I used a function to test all possible alphabetical variable names from a to zzz and found that the only names that should be avoided are a, e, i, o, r, s, t, ac, eo, lf, lp, tt and numbered variations like a1, a2... tt1, tt2.... Replacing even one of them is difficult because of combinations and variations, so I won't touch that. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Gio Posts: 117 Joined: 30 Sep 2013, 10:54 Re: Eval - Evaluate Expressions in Strings Report this post Quote 03 Feb 2016, 08:39 The function works nicely, thank you for it I have some questions: 1 - Uberi stated that ExprEval was 28x slower than actual expression evaluation in one of his examples. Are there any big practical advantages of using this method vs the ordinary expression method though? Can you please provide examples? 2 - Is this part of a bigger project? (a compiler os something like that)? Best wishes. ""What is a suitable automation? Whatever saves your day for the greater matters."" Barcoder - Create QR Codes and other Barcodes using only Autohotkey !! Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Eval - Evaluate Expressions in Strings Report this post Quote 03 Feb 2016, 09:19 Hi Gio, I haven't made performance tests, but it works fast enough for my needs . The one practical use for this function is provide a method to evaluate expressions dynamically, i.e. you can get results from copied text, user input, read files, etc. Without eval you cannot build something like a calculator, or the expression tester I posted above. I made this function to use with the next version of my Macro Creator. The current version uses Laszlo's Eval, but it's limited to math expressions. When I first tried Uberi's, some years ago, for some reason I couldn't get it to work with my project (I probably did something wrong), but in the last weeks I was looking for a way to support 'real' expressions and gave it another try and it worked well, allowing me to support multiple statements for example (a || b, a && b...). I knew how to evaluate object calls in strings, so I tried to combine what I did in my ComInterface function for PMC to give it support for object creation and calls, as well as functions that return objects, such as StrSplit(). The last thing I did was find a way to support ternary, one of the requests from Uberi's original post. I haven't tested short-circuiting, though. Regards. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Gio Posts: 117 Joined: 30 Sep 2013, 10:54 Re: Eval - Evaluate Expressions in Strings Report this post Quote 03 Feb 2016, 09:29 Ok, thanks for the explanation, those examples did sparkled some more ideas ""What is a suitable automation? Whatever saves your day for the greater matters."" Barcoder - Create QR Codes and other Barcodes using only Autohotkey !! Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Eval - Evaluate Expressions in Strings Report this post Quote 03 Feb 2016, 14:39 Update: Added support for Object references in [key, key] format. I was forgetting that it's possible to assign and access multi-dimensional arrays that way... I updated the function to make it consistent with this feature. Example: Code: [Select all] [Download] GeSHi © Codebox Plus Expression = (Join, Obj := [] Obj[1, ""Pi""] := 3.141593 )   Eval(Expression)   MsgBox % Eval(""Obj[1, """"Pi""""]"")[1]   Last edited by Pulover on 16 Mar 2016, 20:03, edited 1 time in total. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Eval - Evaluate Expressions in Strings Report this post Quote 06 Feb 2016, 22:03 Update: Updated to resolve objects inside CustomVars values. Last edited by Pulover on 16 Mar 2016, 20:03, edited 1 time in total. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Eval - Evaluate Expressions in Strings Report this post Quote 10 Feb 2016, 09:54 Update: Fixed bug in ExprEval() when concatenating variables or numbers with a number. I had fixed a few bugs in Uberi's function already, and I have found now that it cannot process expressions like Variable 1 or Variable 1.1. Took me some time to figure out the code, but I managed to solve the problem. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Eval - Evaluate Expressions in Strings Report this post Quote 16 Mar 2016, 20:12 Update: Added support for Unicode strings. Added support for dynamic references of objects and functions. Fixed various bugs with literal strings.I found that ExprEval() cannot parse Unicode strings, so I added a workaround. The function should be able to evaluate dynamic references now, such as fn := ""StrLen"", %fn%(""some string"") and similar, as well as object calls with them. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Eval - Evaluate Expressions in Strings Report this post Quote 21 Mar 2016, 17:55 Update: v1.1.1 Fixed creating linear arrays not working with string or array elements.My mistake this time... forgot to restore strings and other elements before creating linear arrays. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Eval - Evaluate Expressions in Strings Dynamically (Updated 03/21/2016) Report this post Quote 21 Mar 2016, 20:19 Update: v1.1.2 Fixed bug when creating associative arrays with commas in values (such as arrays or function parameters).Just found another problem (I do hope they all will be fixed some day...), this time with Associative Arrays. Something like person := {name: ""John"", surname: ""Smith"", age: 26, stats: [10,9,8.5,7,9.5,10]} would not work because of the commas in stats. Fixed now. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Eval - Evaluate Expressions in Strings Dynamically (Updated 03/21/2016) Report this post Quote 24 Mar 2016, 20:21 Update: v1.1.3 Added support for missing parameters in function calls. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Eval - Evaluate Expressions in Strings Dynamically (Updated 03/21/2016) Report this post Quote 01 Apr 2016, 11:30 Update: v1.1.4 Fixed bug in ExprEval() with hex numbers. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Update v1.1.5 Report this post Quote 14 Apr 2016, 10:06 Update: v1.1.5 Fixed problem with setting false value to COM object parameters. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Update v1.1.6 Report this post Quote 27 Apr 2016, 11:26 Update: v1.1.6 Fixed identical function or object calls in being executed only once. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 20 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by Pulover - Evaluate expressions in strings. Forum thread:"	"true"
"Maths"	"Scientific Maths"	"https://autohotkey.com/board/topic/93516-"	"by Avi - Library facilitating high precision mathematics."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"47"	"8"	"19"	"GitHub - aviaryan/autohotkey-scripts: A collection of Autohotkey scripts and functions authored by me (Avi Aryan). Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 8 Star 47 Fork 19 aviaryan/autohotkey-scripts Code Issues 0 Pull requests 0 Pulse Graphs 👌 A collection of Autohotkey scripts and functions authored by me (Avi Aryan). http://aviaryan.in/ahk/ 132 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit 4abad9e Mar 9, 2016 aviaryan Merge pull request #4 from D4D3VD4V3/patch-1 … Indented and more in DayofDate.ahk Permalink Failed to load latest commit information. Example_files Functions Others Tools NOTICE.txt README.md README.md Avi's Autohotkey Scripts and Functions Repository See my AHK script listing Copyright 2014 Avi Aryan    Licensed under the Apache License, Version 2.0 (the ""License"");   you may not use this file except in compliance with the License.   You may obtain a copy of the License at    http://www.apache.org/licenses/LICENSE-2.0    Unless required by applicable law or agreed to in writing, software   distributed under the License is distributed on an ""AS IS"" BASIS,   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.   See the License for the specific language governing permissions and   limitations under the License.    Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/aviaryan/autohotkey-scripts"	"by Avi - Library facilitating high precision mathematics."	"true"
"Networking"	"AHKhttp"	"https://github.com/Skiouros/AHKhttp"	"Basic HTTP Server. Forum"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"13"	"3"	"6"	"GitHub - Skiouros/AHKhttp: HTTP Server Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 3 Star 13 Fork 6 Skiouros/AHKhttp Code Issues 0 Pull requests 1 Pulse Graphs HTTP Server 9 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit a4116cf Nov 8, 2014 Skiouros Added table of contents Permalink Failed to load latest commit information. AHKhttp.ahk Added support for mime types and serving files Nov 8, 2014 LICENSE init commit Oct 16, 2014 README.md Created README Oct 22, 2014 documentation.md Added table of contents Nov 8, 2014 example.ahk updated logo example using mime types Nov 8, 2014 logo.png added png example Nov 7, 2014 mime.types updated logo example using mime types Nov 8, 2014 README.md AHKhttp Basic HTTP Server written in AutoHotkey Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/Skiouros/AHKhttp"	"Basic HTTP Server. Forum"	"true"
"Networking"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=4890"	"Basic HTTP Server. Forum"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"AHKhttp - HTTP Server - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:28 All times are UTC-05:00 AHKhttp - HTTP Server Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 22 posts 1 2 Next Skittlez Posts: 7 Joined: 13 Mar 2014, 12:16 AHKhttp - HTTP Server Report this post Quote 16 Oct 2014, 21:02 Basic http server I wrote, requires AHKsock. Example Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #Persistent #SingleInstance, force SetBatchLines, -1   paths := {} paths[""/""] := Func(""HelloWorld"") paths[""404""] := Func(""NotFound"") paths[""/logo""] := Func(""Logo"")   server := new HttpServer() server.LoadMimes(A_ScriptDir . ""/mime.types"") server.SetPaths(paths) server.Serve(8000) return   Logo(ByRef req, ByRef res, ByRef server) {     server.ServeFile(res, A_ScriptDir . ""/logo.png"")     res.status := 200 }   NotFound(ByRef req, ByRef res) {     res.SetBodyText(""Page not found"") }   HelloWorld(ByRef req, ByRef res) {     res.SetBodyText(""Hello World"")     res.status := 200 }   #include, %A_ScriptDir%\AHKhttp.ahk #include <AHKsock> Source Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus class Uri {     Decode(str) {         Loop             If RegExMatch(str, ""i)(?<=%)[\da-f]{1,2}"", hex)                 StringReplace, str, str, `%%hex%, % Chr(""0x"" . hex), All             Else Break         Return, str     }       Encode(str) {         f = %A_FormatInteger%         SetFormat, Integer, Hex         If RegExMatch(str, ""^\w+:/{0,2}"", pr)             StringTrimLeft, str, str, StrLen(pr)         StringReplace, str, str, `%, `%25, All         Loop             If RegExMatch(str, ""i)[^\w\.~%]"", char)                 StringReplace, str, str, %char%, % ""%"" . Asc(char), All             Else Break         SetFormat, Integer, %f%         Return, pr . str     } }   class HttpServer {     static servers := {}       LoadMimes(file) {         if (!FileExist(file))             return false           FileRead, data, % file         types := StrSplit(data, ""`n"")         this.mimes := {}         for i, data in types {             info := StrSplit(data, "" "")             type := info.Remove(1)             ; Seperates type of content and file types             info := StrSplit(LTrim(SubStr(data, StrLen(type) + 1)), "" "")               for i, ext in info {                 this.mimes[ext] := type             }         }         return true     }       GetMimeType(file) {         default := ""text/plain""         if (!this.mimes)             return default           SplitPath, file,,, ext         type := this.mimes[ext]         if (!type)             return default         return type     }       ServeFile(ByRef response, file) {         f := FileOpen(file, ""r"")         length := f.RawRead(data, f.Length)         f.Close()           response.SetBody(data, length)         res.headers[""Content-Type""] := this.GetMimeType(file)     }       SetPaths(paths) {         this.paths := paths     }       Handle(ByRef request) {         response := new HttpResponse()         if (!this.paths[request.path]) {             func := this.paths[""404""]             response.status := 404             if (func)                 func.(request, response, this)             return response         } else {             this.paths[request.path].(request, response, this)         }         return response     }       Serve(port) {         this.port := port         HttpServer.servers[port] := this           AHKsock_Listen(port, ""HttpHandler"")     } }   HttpHandler(sEvent, iSocket = 0, sName = 0, sAddr = 0, sPort = 0, ByRef bData = 0, bDataLength = 0) {     static sockets := {}       if (!sockets[iSocket]) {         sockets[iSocket] := new Socket(iSocket)         AHKsock_SockOpt(iSocket, ""SO_KEEPALIVE"", true)     }     socket := sockets[iSocket]       if (sEvent == ""DISCONNECTED"") {         socket.request := false         sockets[iSocket] := false     } else if (sEvent == ""SEND"") {         if (socket.TrySend()) {             socket.Close()         }       } else if (sEvent == ""RECEIVED"") {         server := HttpServer.servers[sPort]           text := StrGet(&bData, ""UTF-8"")         request := new HttpRequest(text)           ; Multipart request         if (request.IsMultipart()) {             length := request.headers[""Content-Length""]             request.bytesLeft := length + 0               if (request.body) {                 request.bytesLeft -= StrLen(request.body)             }             socket.request := request         } else if (socket.request) {             ; Get data and append it to the request body             socket.request.bytesLeft -= StrLen(text)             socket.request.body := socket.request.body . text         }           if (socket.request) {             request := socket.request             if (request.bytesLeft <= 0) {                 request.done := true             }         }           response := server.Handle(request)         if (response.status) {             socket.SetData(response.Generate())               if (socket.TrySend()) {                 if (!request.IsMultipart() || (request.IsMultipart() && request.done)) {                     socket.Close()                 }             }         }     } }   class HttpRequest {     __New(data = """") {         if (data)             this.Parse(data)     }       GetPathInfo(top) {         results := []         while (pos := InStr(top, "" "")) {             results.Insert(SubStr(top, 1, pos - 1))             top := SubStr(top, pos + 1)         }         this.method := results[1]         this.path := Uri.Decode(results[2])         this.protocol := top     }       GetQuery() {         pos := InStr(this.path, ""?"")         query := StrSplit(SubStr(this.path, pos + 1), ""&"")         if (pos)             this.path := SubStr(this.path, 1, pos - 1)           this.queries := {}         for i, value in query {             pos := InStr(value, ""="")             key := SubStr(value, 1, pos - 1)             val := SubStr(value, pos + 1)             this.queries[key] := val         }     }       Parse(data) {         this.raw := data         data := StrSplit(data, ""`n`r"")         headers := StrSplit(data[1], ""`n"")         this.body := LTrim(data[2], ""`n"")           this.GetPathInfo(headers.Remove(1))         this.GetQuery()         this.headers := {}           for i, line in headers {             pos := InStr(line, "":"")             key := SubStr(line, 1, pos - 1)             val := Trim(SubStr(line, pos + 1), ""`n`r "")               this.headers[key] := val         }     }       IsMultipart() {         length := this.headers[""Content-Length""]         expect := this.headers[""Expect""]           if (expect = ""100-continue"" && length > 0)             return true         return false     } }   class HttpResponse {     __New() {         this.headers := {}         this.status := 0         this.protocol := ""HTTP/1.1""           this.SetBodyText("""")     }       Generate() {         FormatTime, date,, ddd, d MMM yyyy HH:mm:ss         this.headers[""Date""] := date           headers := this.protocol . "" "" . this.status . ""`n""         for key, value in this.headers {             headers := headers . key . "": "" . value . ""`n""         }         headers := headers . ""`n""         length := this.headers[""Content-Length""]           buffer := new Buffer((StrLen(headers) * 2) + length)         buffer.WriteStr(headers)           buffer.Append(this.body)         buffer.Done()           return buffer     }       SetBody(ByRef body, length) {         this.body := new Buffer(length)         this.body.Write(&body, length)         this.headers[""Content-Length""] := length     }       SetBodyText(text) {         this.body := Buffer.FromString(text)         this.headers[""Content-Length""] := this.body.length     }     }   class Socket {     __New(socket) {         this.socket := socket     }       Close(timeout = 5000) {         AHKsock_Close(this.socket, timeout)     }       SetData(data) {         this.data := data     }       TrySend() {         if (!this.data || this.data == """")             return false           p := this.data.GetPointer()         length := this.data.length           this.dataSent := 0         loop {             if ((i := AHKsock_Send(this.socket, p, length - this.dataSent)) < 0) {                 if (i == -2) {                     return                 } else {                     ; Failed to send                     return                 }             }               if (i < length - this.dataSent) {                 this.dataSent += i             } else {                 break             }         }         this.dataSent := 0         this.data := """"           return true     } }   class Buffer {     __New(len) {         this.SetCapacity(""buffer"", len)         this.length := 0     }       FromString(str, encoding = ""UTF-8"") {         length := Buffer.GetStrSize(str, encoding)         buffer := new Buffer(length)         buffer.WriteStr(str)         return buffer     }       GetStrSize(str, encoding = ""UTF-8"") {         encodingSize := ((encoding=""utf-16"" || encoding=""cp1200"") ? 2 : 1)         ; length of string, minus null char         return StrPut(str, encoding) * encodingSize - encodingSize     }       WriteStr(str, encoding = ""UTF-8"") {         length := this.GetStrSize(str, encoding)         VarSetCapacity(text, length)         StrPut(str, &text, encoding)           this.Write(&text, length)         return length     }       ; data is a pointer to the data     Write(data, length) {         p := this.GetPointer()         DllCall(""RtlMoveMemory"", ""uint"", p + this.length, ""uint"", data, ""uint"", length)         this.length += length     }       Append(ByRef buffer) {         destP := this.GetPointer()         sourceP := buffer.GetPointer()           DllCall(""RtlMoveMemory"", ""uint"", destP + this.length, ""uint"", sourceP, ""uint"", buffer.length)         this.length += buffer.length     }       GetPointer() {         return this.GetAddress(""buffer"")     }       Done() {         this.SetCapacity(""buffer"", this.length)     } } GitHub Documentation Last edited by Skittlez on 08 Nov 2014, 18:53, edited 2 times in total. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: AHKhttp - HTTP Server Report this post Quote 16 Oct 2014, 23:27 Interesting Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top fincs Posts: 484 Joined: 30 Sep 2013, 14:17 GitHub: fincs Location: Seville, Spain Contact: Contact fincs Website Re: AHKhttp - HTTP Server Report this post Quote 17 Oct 2014, 03:24 AutoHotkey on Rails anybody? This little script even supports route-based serving instead of using a folder in disk. fincs Windows 10 x64 Build 10240 / AutoHotkey v1.1.22.02 Get SciTE4AutoHotkey v3.0.06.01 - [My project list] Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: AHKhttp - HTTP Server Report this post Quote 17 Oct 2014, 13:57 Haha true, along with AHK-webkit Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Relayer Posts: 72 Joined: 30 Sep 2013, 13:09 Re: AHKhttp - HTTP Server Report this post Quote 18 Oct 2014, 08:47 This looks very interesting but I would like to ask someone to explain a little more how one would use this. It would be very helpful. Relayer Top ahk7 Posts: 72 Joined: 06 Nov 2013, 16:35 Re: AHKhttp - HTTP Server Report this post Quote 18 Oct 2014, 10:42 @Skittlez: do you plan to work on this some more and extend it? Some documentation would indeed be useful, I've been playing around with a bit - see below. You can find AHKsock here https://github.com/jleb/AHKsock Here is a small example displaying parameters and using them in a form. Enter two numbers and press submit will show you the answer on the next page. Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus #Persistent #SingleInstance, force SetBatchLines, -1   ahp= ( <html> <title>AHKhttp-server 1.0</title> <body> <b>[var]</b> </body> </html> )   paths := {} paths[""/""] := Func(""PlayList"") paths[""/page""] := Func(""Page"") paths[""/calc""] := Func(""Calc"") paths[""404""] := Func(""NotFound"")   server := new HttpServer() server.SetPaths(paths) server.Serve(8000) Run http://localhost:8000/page?para1=123&para2=456 return   NotFound(ByRef req, ByRef res) {     res.SetBody(""Page not found"") }   Page(ByRef req, ByRef res) { 	global ahp 	form= 	( <form action=""/calc"" method=""get""> <input type=text name=para1> + <input type=text name=para2> <input type=submit> </form> 	) 	stringreplace, serve, ahp, [var], % ""para1: "" req.queries[""para1""] "" - para2: "" req.queries[""para2""] ""<br><br>"" form, All     res.SetBody(serve)     res.statusCode := 200 }   Calc(ByRef req, ByRef res) { 	global ahp 	answer:=req.queries[""para1""] + req.queries[""para2""] 	stringreplace, serve, ahp, [var], % req.queries[""para1""] ""+"" req.queries[""para2""] ""="" answer, All     res.SetBody(serve)     res.statusCode := 200 }   HelloWorld(ByRef req, ByRef res) {     res.SetBody(""Hello World"")     res.statusCode := 200 }   f12::Reload   #include, %A_ScriptDir%\AHKhttp.ahk #include AHKsock.ahk   Top Skittlez Posts: 7 Joined: 13 Mar 2014, 12:16 Re: AHKhttp - HTTP Server Report this post Quote 18 Oct 2014, 11:30 I'll write some documentation later today. @ahk7 If you have any features you'd like to see, just let me know and I'll see what I can do. Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: AHKhttp - HTTP Server Report this post Quote 18 Oct 2014, 14:40 awesome Top Relayer Posts: 72 Joined: 30 Sep 2013, 13:09 Re: AHKhttp - HTTP Server Report this post Quote 19 Oct 2014, 08:51 ahk7, I tried your script and get ""unable to connect"". I'm using Firefox and AutoHotKey v1.1.16.05 I'm a complete noob when it comes to http server stuff. Relayer Top ahk7 Posts: 72 Joined: 06 Nov 2013, 16:35 Re: AHKhttp - HTTP Server Report this post Quote 19 Oct 2014, 12:13 if you google 'unable to connect localhost firefox' you will see that it might be a firefox setting so try it with another browser to see if that works - if it does you can try to figure out how to let firefox allow connections to localhost. You can test if the server is up and running by opening a command window (cmd.exe) and use ping localhost if it gives valid pings the script (server) works - so you will have to work on getting it to work in your browser. (Edit see comments by Lexikos below) I'd like to be able to display images in pages and stream mp3 over http - I recall sparrow did that by reading/parsing a list of mimetypes. Edit: ping but note the test script does a run Run http://localhost:8000/page?para1=123&para2=456 so the default browser should try to open http://localhost:8000 - it may be a firefox problem so worth trying in another browser just to check. Otherwise I don't know why it doesn't work or how to fix it. Last edited by ahk7 on 21 Oct 2014, 11:20, edited 1 time in total. Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: AHKhttp - HTTP Server Report this post Quote 20 Oct 2014, 17:17 Relayer wrote:ahk7, I tried your script and get ""unable to connect"". I'm using Firefox and AutoHotKey v1.1.16.05 I'm a complete noob when it comes to http server stuff. Relayer Well why don't you tell us what url you are trying to connect to in firefox The example in the OP uses port 8000 instead of the http default which is 80 Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: AHKhttp - HTTP Server Report this post Quote 20 Oct 2014, 21:49 You can test if the server is up and running by opening a command window (cmd.exe) and use ping localhost if it gives valid pings the script (server) worksThat will only prove that the computer responds to ICMP (specifically, ping) requests on its loopback interface. It will not prove that the HTTP server is running or that the system will accept TCP/IP connections on any particular port. Some systems don't respond to ping (from outside) but still accept connections on specific TCP ports. I think you'd be hard-pressed to find a system that doesn't respond to ping localhost. What you can do is attempt to connect to localhost:8000 using telnet or PuTTY, or see if port 8000 is listed by netstat -a. Of course, that won't be necessary if the problem is as guest3456 guessed. http://localhost:8000 not http://localhost Top ahk7 Posts: 72 Joined: 06 Nov 2013, 16:35 Re: AHKhttp - HTTP Server Report this post Quote 21 Oct 2014, 11:23 I can indeed see it is listening using netstat -a so that is a good tip (edited post above) Top kidbit Posts: 168 Joined: 02 Oct 2013, 16:05 Re: AHKhttp - HTTP Server Report this post Quote 27 Oct 2014, 13:28 There's some bug: last 5 symbols of the page get eaten. ahk7's example results into a page with such a code: Code: [Select all] [Download] GeSHi © Codebox Plus <html> <title>AHKhttp-server 1.0</title> <body> <b>para1: 123 - para2: 456<br><br><form action=""/calc"" method=""get""> <input type=text name=para1> + <input type=text name=para2> <input type=submit> </form></b> </body> </ question := (2b) || !(2b) © Shakespeare. Top Skittlez Posts: 7 Joined: 13 Mar 2014, 12:16 Re: AHKhttp - HTTP Server Report this post Quote 07 Nov 2014, 22:22 @ahk7 I've added an example of how to serve images. @kidbit Try updating to the latest version, I can't reproduce that bug. I'll be adding support for mime types and writing some docs, for real this time, sometime this weekend. Top ahk7 Posts: 72 Joined: 06 Nov 2013, 16:35 Re: AHKhttp - HTTP Server Report this post Quote 08 Nov 2014, 09:16 Thanks! I've already been playing around with it and now have a rudimentary mp3 server. I can access the server from other PCs in the network and ""stream"" MP3 via a downloadable m3u playlist, very nice. For others who already want to play around with it, you can use the following mimetypes for mp3/m3u for m3u: (playlists) res.headers[""Content-Type""] := ""audio/x-mpequrl"" for mp3: res.headers[""Content-Type""] := ""audio/mpeg"" This will play an mp3 in your browser: Code: [Select all] [Download] GeSHi © Codebox Plus mp3(ByRef req, ByRef res) {     f := FileOpen(A_ScriptDir . ""/groove.mp3"", ""r"") ; example mp3 file     length := f.RawRead(data, f.Length)     f.Close()     res.status := 200     res.headers[""Content-Type""] := ""audio/mpeg""     res.SetBody(data, length) } Look forward to the documentation Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: AHKhttp - HTTP Server Report this post Quote 08 Nov 2014, 09:55 Binary files over HTTP. Wonderful! Now we need to dump WAVs from the Speech API over http AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top Skittlez Posts: 7 Joined: 13 Mar 2014, 12:16 Re: AHKhttp - HTTP Server Report this post Quote 08 Nov 2014, 18:54 Added support for mime types, updated example using ServeFile. Documentation is on github. Top tmplinshi Posts: 836 Joined: 01 Oct 2013, 14:57 Re: AHKhttp - HTTP Server Report this post Quote 15 Mar 2015, 11:31 Great! Thank you very much!! Top tmplinshi Posts: 836 Joined: 01 Oct 2013, 14:57 Re: AHKhttp - HTTP Server Report this post Quote 17 Mar 2015, 04:44 For anyone who want to use this wonderful lib: Please use AHK Unicode version in order to work. ahk7's example code not working? Yes, it's outdated (I tried his code several times, and finally noticed that today...). You need make these changes in his code: Replace SetBody to SetBodyText Replace statusCode to status Thanks for your example code ahk7! Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 22 posts 1 2 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Bing [Bot] and 15 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"Basic HTTP Server. Forum"	"true"
"Networking"	"AHKsock"	"https://github.com/jleb/AHKsock"	"by TheGood - Function based sockets library. Supports TCP. Forum"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"12"	"7"	"3"	"GitHub - jleb/AHKsock: A simple AHK implementation of Winsock (TCP/IP) Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 7 Star 12 Fork 3 jleb/AHKsock Code Issues 1 Pull requests 0 Pulse Graphs A simple AHK implementation of Winsock (TCP/IP) 21 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Fetching latest commit… Cannot retrieve the latest commit at this time. Permalink Failed to load latest commit information. examples AHKsock.ahk README.md documentation.md README.md AHKsock - A simple AHK implementation of Winsock (TCP/IP) AHKsock is a high-level wrapper which I have written to facilitate the use of the Winsock APIs in AHK. It will allow you to create clients and servers that can communicate with each other, purely written in AHK! Forum thread is here. AHKsock includes three examples: In Example 1, the server listens for clients and sends some data to any client that connects. This is a very simple example to show the basics of AHKsock. In Example 2, the server sends a file to any client that connects. There are three types of servers. The first one uses the TransmitFile() function provided by Windows while the second one reads from the file itself and transfer to a single client at a time. The third type can serve multiple clients simultaneously. In Example 3, two peers connect to each other to start chatting. This is a great example of a symmetrical connection. Whichever is started first becomes the server, while the second becomes the client. However, they both behave in exactly the same way once connected to each other. In Example 4, we can look up IPs from hostnames and vice-versa. Additional resources on Winsock and sockets in general: Winsock Programmer's FAQ WinSock Development Information MSDN Windows Sockets 2 Reference Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/jleb/AHKsock"	"by TheGood - Function based sockets library. Supports TCP. Forum"	"true"
"Networking"	"link"	"https://autohotkey.com/board/topic/53827-ahksock-a-simple-ahk-implementation-of-winsock-tcpip/"	"by TheGood - Function based sockets library. Supports TCP. Forum"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"12"	"7"	"3"	"GitHub - jleb/AHKsock: A simple AHK implementation of Winsock (TCP/IP) Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 7 Star 12 Fork 3 jleb/AHKsock Code Issues 1 Pull requests 0 Pulse Graphs A simple AHK implementation of Winsock (TCP/IP) 21 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Fetching latest commit… Cannot retrieve the latest commit at this time. Permalink Failed to load latest commit information. examples AHKsock.ahk README.md documentation.md README.md AHKsock - A simple AHK implementation of Winsock (TCP/IP) AHKsock is a high-level wrapper which I have written to facilitate the use of the Winsock APIs in AHK. It will allow you to create clients and servers that can communicate with each other, purely written in AHK! Forum thread is here. AHKsock includes three examples: In Example 1, the server listens for clients and sends some data to any client that connects. This is a very simple example to show the basics of AHKsock. In Example 2, the server sends a file to any client that connects. There are three types of servers. The first one uses the TransmitFile() function provided by Windows while the second one reads from the file itself and transfer to a single client at a time. The third type can serve multiple clients simultaneously. In Example 3, two peers connect to each other to start chatting. This is a great example of a symmetrical connection. Whichever is started first becomes the server, while the second becomes the client. However, they both behave in exactly the same way once connected to each other. In Example 4, we can look up IPs from hostnames and vice-versa. Additional resources on Winsock and sockets in general: Winsock Programmer's FAQ WinSock Development Information MSDN Windows Sockets 2 Reference Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/jleb/AHKsock"	"by TheGood - Function based sockets library. Supports TCP. Forum"	"true"
"Networking"	"Socket Class (überarbeitet)"	"https://autohotkey.com/board/topic/94376-"	"by Bentschi - Class based sockets library. Supports TCP and UDP."	"null"	"null"	"null"	"null"	"null"	""	"null"	"null"	"null"	"null"	"Socket Class (überarbeitet) - Gebrauchsfertige Skripte & Funktionen - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community Deutsch (German) Gebrauchsfertige Skripte & Funktionen View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. Socket Class (überarbeitet) Started by Bentschi , Jun 12 2013 09:39 AM Page 1 of 3 1 2 3 Next Please log in to reply 30 replies to this topic Bentschi Moderators 120 posts Last active: Sep 05 2014 02:12 AM Joined: 26 Nov 2008 Hallo Hab die Socket-Classen von http://www.autohotke...opic.php?t=8587 nochmal überarbeitet.   Änderungen: - Hauptklasse Socket erstellt - TCP Klasse in SocketTCP umbenannt - UDP Klasse in SocketUDP umbenannt - send in sendText umbenannt - sendBinary in send umbenannt - recv in recvText umbenannt - recvBinary in recv umbenannt - Callbackreferenzen werden jetzt mit bsp. mySocket.onRecv := Func(""MyOnRecv"") erstellt - Einige Fehler und Probleme behoben und verbessert  class Socket {   static __eventMsg := 0x9987      __New(s=-1)   {     static init     if (!init)     {       DllCall(""LoadLibrary"", ""str"", ""ws2_32"", ""ptr"")       VarSetCapacity(wsadata, 394+A_PtrSize)       DllCall(""ws2_32\WSAStartup"", ""ushort"", 0x0000, ""ptr"", &wsadata)       DllCall(""ws2_32\WSAStartup"", ""ushort"", NumGet(wsadata, 2, ""ushort""), ""ptr"", &wsadata)       OnMessage(Socket.__eventMsg, ""SocketEventProc"")       init := 1     }     this.socket := s   }   __Delete()   {     this.disconnect()   }   __Get(k, v)   {     if (k=""size"")       return this.msgSize()   }   connect(host, port)   {     if ((this.socket!=-1) || (!(faddr := next := this.__getAddrInfo(host, port))))       return 0     while (next)     {       sockaddrlen := NumGet(next+0, 16, ""uint"")       sockaddr := NumGet(next+0, 16+(2*A_PtrSize), ""ptr"")       if ((this.socket := DllCall(""ws2_32\socket"", ""int"", NumGet(next+0, 4, ""int""), ""int"", this.__socketType, ""int"", this.__protocolId, ""ptr""))!=-1)       {         if ((r := DllCall(""ws2_32\WSAConnect"", ""ptr"", this.socket, ""ptr"", sockaddr, ""uint"", sockaddrlen, ""ptr"", 0, ""ptr"", 0, ""ptr"", 0, ""ptr"", 0, ""int""))=0)         {           DllCall(""ws2_32\freeaddrinfo"", ""ptr"", faddr)           return Socket.__eventProcRegister(this, 0x21)         }         this.disconnect()       }       next := NumGet(next+0, 16+(3*A_PtrSize), ""ptr"")     }     this.lastError := DllCall(""ws2_32\WSAGetLastError"")     return 0   }   bind(host, port)   {     if ((this.socket!=-1) || (!(faddr := next := this.__getAddrInfo(host, port))))       return 0     while (next)     {       sockaddrlen := NumGet(next+0, 16, ""uint"")       sockaddr := NumGet(next+0, 16+(2*A_PtrSize), ""ptr"")       if ((this.socket := DllCall(""ws2_32\socket"", ""int"", NumGet(next+0, 4, ""int""), ""int"", this.__socketType, ""int"", this.__protocolId, ""ptr""))!=-1)       {         if (DllCall(""ws2_32\bind"", ""ptr"", this.socket, ""ptr"", sockaddr, ""uint"", sockaddrlen, ""int"")=0)         {           DllCall(""ws2_32\freeaddrinfo"", ""ptr"", faddr)           return Socket.__eventProcRegister(this, 0x29)         }         this.disconnect()       }       next := NumGet(next+0, 16+(3*A_PtrSize), ""ptr"")     }     this.lastError := DllCall(""ws2_32\WSAGetLastError"")     return 0   }   listen(backlog=32)   {     return (DllCall(""ws2_32\listen"", ""ptr"", this.socket, ""int"", backlog)=0) ? 1 : 0   }   accept()   {     if ((s := DllCall(""ws2_32\accept"", ""ptr"", this.socket, ""ptr"", 0, ""int"", 0, ""ptr""))!=-1)     {       newsock := new Socket(s)       newsock.__protocolId := this.__protocolId       newsock.__socketType := this.__socketType       Socket.__eventProcRegister(newsock, 0x21)       return newsock     }     return 0   }   disconnect()   {     Socket.__eventProcUnregister(this)     DllCall(""ws2_32\closesocket"", ""ptr"", this.socket, ""int"")     this.socket := -1     return 1   }   msgSize()   {     VarSetCapacity(argp, 4, 0)     if (DllCall(""ws2_32\ioctlsocket"", ""ptr"", this.socket, ""uint"", 0x4004667F, ""ptr"", &argp)!=0)       return 0     return NumGet(argp, 0, ""int"")   }   send(addr, length)   {     if ((r := DllCall(""ws2_32\send"", ""ptr"", this.socket, ""ptr"", addr, ""int"", length, ""int"", 0, ""int""))<=0)       return 0     return r   }   sendText(msg, encoding=""UTF-8"")   {     VarSetCapacity(buffer, length := (StrPut(msg, encoding)*(((encoding=""utf-16"")||(encoding=""cp1200"")) ? 2 : 1)))     StrPut(msg, &buffer, encoding)     return this.send(&buffer, length)   }   recv(byref buffer, wait=1)   {     while ((wait) && ((length := this.msgSize())=0))       sleep, 100     if (length)     {       VarSetCapacity(buffer, length)       if ((r := DllCall(""ws2_32\recv"", ""ptr"", this.socket, ""ptr"", &buffer, ""int"", length, ""int"", 0))<=0)         return 0       return r     }     return 0   }   recvText(wait=1, encoding=""UTF-8"")   {     if (length := this.recv(buffer, wait))       return StrGet(&buffer, length, encoding)     return   }   __getAddrInfo(host, port)   {     a := [""127.0.0.1"", ""0.0.0.0"", ""255.255.255.255"", ""::1"", ""::"", ""FF00::""]     conv := {localhost:a[1], addr_loopback:a[1], inaddr_loopback:a[1], addr_any:a[2], inaddr_any:a[2], addr_broadcast:a[3]     , inaddr_broadcast:a[3], addr_none:a[3], inaddr_none:a[3], localhost6:a[4], addr_loopback6:a[4], inaddr_loopback6:a[4]     , addr_any6:a[5], inaddr_any:a[5], addr_broadcast6:a[6], inaddr_broadcast6:a[6], addr_none6:a[6], inaddr_none6:a[6]}     if (conv[host])       host := conv[host]     VarSetCapacity(hints, 16+(4*A_PtrSize), 0)     NumPut(this.__socketType, hints, 8, ""int"")     NumPut(this.__protocolId, hints, 12, ""int"")     if ((r := DllCall(""ws2_32\getaddrinfo"", ""astr"", host, ""astr"", port, ""ptr"", &hints, ""ptr*"", next))!=0)     {       this.lastError := DllCall(""ws2_32\WSAGetLastError"")       return 0     }     return next   }   __eventProcRegister(obj, msg)   {     a := SocketEventProc(0, 0, ""register"", 0)     a[obj.socket] := obj     return (DllCall(""ws2_32\WSAAsyncSelect"", ""ptr"", obj.socket, ""ptr"", A_ScriptHwnd, ""uint"", Socket.__eventMsg, ""uint"", msg)=0) ? 1 : 0   }   __eventProcUnregister(obj)   {     a := SocketEventProc(0, 0, ""register"", 0)     a.remove(obj.socket)     return (DllCall(""ws2_32\WSAAsyncSelect"", ""ptr"", obj.socket, ""ptr"", A_ScriptHwnd, ""uint"", 0, ""uint"", 0)=0) ? 1 : 0   } } SocketEventProc(wParam, lParam, msg, hwnd) {   global Socket   static a := []   Critical   if (msg=""register"")     return a   if (msg=Socket.__eventMsg)   {     if (!isobject(a[wParam]))       return 0     if ((lParam & 0xFFFF) = 1)       return a[wParam].onRecv(a[wParam])     else if ((lParam & 0xFFFF) = 8)       return a[wParam].onAccept(a[wParam])     else if ((lParam & 0xFFFF) = 32)     {       a[wParam].socket := -1       return a[wParam].onDisconnect(a[wParam])     }     return 0   }   return 0 }  class SocketTCP extends Socket {   static __protocolId := 6 ;IPPROTO_TCP   static __socketType := 1 ;SOCK_STREAM }  class SocketUDP extends Socket {   static __protocolId := 17 ;IPPROTO_UDP   static __socketType := 2 ;SOCK_DGRAM    enableBroadcast()   {     VarSetCapacity(optval, 4, 0)     NumPut(1, optval, 0, ""uint"")     if (DllCall(""ws2_32\setsockopt"", ""ptr"", this.socket, ""int"", 0xFFFF, ""int"", 0x0020, ""ptr"", &optval, ""int"", 4)=0)       return 1     return 0   }   disableBroadcast()   {     VarSetCapacity(optval, 4, 0)     if (DllCall(""ws2_32\setsockopt"", ""ptr"", this.socket, ""int"", 0xFFFF, ""int"", 0x0020, ""ptr"", &optval, ""int"", 4)=0)       return 1     return 0   } }  #1 - Posted 12 June 2013 - 09:39 AM Back to top nnnik Members 1625 posts Last active: Sep 26 2015 10:58 PM Joined: 28 Jul 2012 Nicht schlecht. #2 - Posted 14 June 2013 - 09:03 AM Visit the new forum ahkscript.org. http://ahkscript.org Back to top strobo Members 359 posts Last active: Mar 10 2015 08:13 PM Joined: 19 Jun 2012 Ich bin grad bei deiner lib am rumtesten und funzt soweit gut. Kleiner typo in __getAddrInfo: inaddr_any:5[5]   #3 - Posted 29 June 2013 - 05:14 PM Regards, Babba Back to top Bentschi Moderators 120 posts Last active: Sep 05 2014 02:12 AM Joined: 26 Nov 2008 danke dir, ist geändert #4 - Posted 02 July 2013 - 11:47 AM Back to top Larctic Members 303 posts Last active: May 10 2016 04:56 PM Joined: 21 Jul 2012 Can you please write some examples of it? #5 - Posted 28 July 2013 - 09:01 AM Back to top nnnik Members 1625 posts Last active: Sep 26 2015 10:58 PM Joined: 28 Jul 2012  myTcp := new tcp() ;myTcp is the new tcp-Objekt (class) myTcp.accept(""addr_any"", 12345) ;Waiting for Connection on Port 12345 myTcp.send(""Hello Client!"") ;Send Text-Message MsgBox, % myTcp.recv() ;Getting Text-Message ExitApp  This is an example for the original Version of the Script. Wich you can find in the Link.     BTW wie muss ich denn diese Zeile abändern Bentschi:  myTcp.accept(""addr_any"", 12345)   #6 - Posted 28 July 2013 - 02:22 PM Visit the new forum ahkscript.org. http://ahkscript.org Back to top Bentschi Moderators 120 posts Last active: Sep 05 2014 02:12 AM Joined: 26 Nov 2008 sorry, hab ich wohl vergessen, mit der neuen Version funktioniert das nur noch mit den callbacks (onAccept) #7 - Posted 28 July 2013 - 07:17 PM Back to top SAPlayer Members 403 posts Last active: Apr 11 2014 04:45 PM Joined: 06 Nov 2012 Habe mich mal gewagt das Beispiel von oben umzuschreiben, allerdings ungetestet:  myTcp := new SocketTCP() myTcp.onAccept := Func(""OnTCPAccept"") return  OnTCPAccept(){   global myTcp   myTcp.sendText(""Hello Client!"")   MsgBox, % myTcp.recvText()   ExitApp }  Bitte verbessert mich falls was nicht passt... #8 - Posted 28 July 2013 - 08:48 PM Translated AHK v2-changelog/Übersetzter AHK v2-Changelog [German/Deutsch] Back to top Bentschi Moderators 120 posts Last active: Sep 05 2014 02:12 AM Joined: 26 Nov 2008 ja, erst must du den socket binden (bind), und dann auf verbindung warten (listen), und dann noch akzeptieren (accept)  myTcp := new SocketTCP() myTcp.bind(""addr_any"", 12345) myTcp.listen() myTcp.onAccept := Func(""OnTCPAccept"") return  OnTCPAccept(){   global myTcp   newTcp := myTcp.accept()   newTcp.sendText(""Hello Client!"")   MsgBox, % newTcp.recvText()   ExitApp }  sollte funktionieren #9 - Posted 28 July 2013 - 09:02 PM Back to top SAPlayer Members 403 posts Last active: Apr 11 2014 04:45 PM Joined: 06 Nov 2012 Okay danke, ich werde das morgen mal probieren. Nochmal eine kleine Frage: Gibt es sowas wie SendAllClients? #10 - Posted 29 July 2013 - 04:11 AM Translated AHK v2-changelog/Übersetzter AHK v2-Changelog [German/Deutsch] Back to top Bentschi Moderators 120 posts Last active: Sep 05 2014 02:12 AM Joined: 26 Nov 2008  myTcp := new SocketTCP() myTcp.bind(""addr_any"", 12345) myTcp.listen() clients := [] myTcp.onAccept := Func(""OnTCPAccept"") return  OnTCPAccept(){ global myTcp clients.insert(myTcp.accept()) }  SendToAll(msg) {   global clients   for k,v in clients     v.send(msg) } #11 - Posted 29 July 2013 - 12:00 PM Back to top SAPlayer Members 403 posts Last active: Apr 11 2014 04:45 PM Joined: 06 Nov 2012 Gut, ich habe jetzt die beiden TCP-Beispiele (Client und Server) aus dem alten Thread an die überarbeitete Class angepasst (getestet):  ;Server  myTcp := new SocketTCP() myTcp.bind(""addr_any"", 12345) myTcp.listen() myTcp.onAccept := Func(""OnTCPAccept"") return  OnTCPAccept(){   global myTcp   newTcp := myTcp.accept()   newTcp.sendText(""Hello Client!"")   MsgBox, % newTcp.recvText()   ExitApp }   ;Client  myTcp := new SocketTCP() myTcp.connect(""localhost"", 12345) MsgBox, % myTcp.recvText() myTcp.sendText(""Hello Server!"") ExitApp  Die kannst du ja vielleicht in den Post einfügen. Eventuell mach ich jetzt auch noch die anderen Beispiele #12 - Posted 29 July 2013 - 01:45 PM Translated AHK v2-changelog/Übersetzter AHK v2-Changelog [German/Deutsch] Back to top Larctic Members 303 posts Last active: May 10 2016 04:56 PM Joined: 21 Jul 2012 Very grateful,Examples useful to me. #13 - Posted 29 July 2013 - 03:56 PM Back to top SAPlayer Members 403 posts Last active: Apr 11 2014 04:45 PM Joined: 06 Nov 2012 Gut, nun wollte ich einen kleinen (recht sinnlosen) Chat aufbauen, doch leider krieg ich auch das nur zur Hälfte gebacken:  ;Server  myTcp := new SocketTCP() myTcp.bind(""addr_any"", 12345) myTcp.listen() myTcp.onAccept := Func(""OnTCPAccept"") return  OnTCPAccept(this){   newTcp := this.accept()   newTcp.sendText(""Connected"")   newTcp.onRecv := Func(""OnTCPRecv"") } OnTCPRecv(this){   InputBox, msg, Server to Client Message, % ""Message from Client:`n"" this.RecvText()   this.SendText(msg) }   ;Client  myTcp := new SocketTCP() myTcp.connect(""localhost"", 12345) myTcp.onRecv := Func(""OnTCPRecv"") return  OnTCPRecv(this){ 	InputBox, msg, Client to Server Message, % ""Message from Server:`n"" this.RecvText() 	this.SendText(msg) }  Das Problem hierbei ist, dass die ""Connected""-Meldung zwar beim Client ankommt, jedoch kommt dann die Eingabe in der InputBox nicht mehr beim Server an... #14 - Posted 29 July 2013 - 06:25 PM Translated AHK v2-changelog/Übersetzter AHK v2-Changelog [German/Deutsch] Back to top clackwell Members 2 posts Last active: Oct 27 2013 07:25 PM Joined: 26 Oct 2013 Hallo.   Ich habe das gleiche Problem wie SAPlayer.   Das Problem ist vermutlich, dass für die accept()ed Socket das Event Processing nicht aktiviert wird. Hier die korrigierte accept() Methode:     accept()   {     if ((s := DllCall(""ws2_32\accept"", ""ptr"", this.socket, ""ptr"", 0, ""int"", 0, ""ptr""))!=-1)     {       newsock := new Socket(s)       newsock.__protocolId := this.__protocolId       newsock.__socketType := this.__socketType       Socket.__eventProcRegister(newsock, 0x21)       return newsock     }     return 0   }   (Neu ist die Zeile Socket.__eventProcRegister(newsock, 0x21)).       Ciao #15 - Posted 26 October 2013 - 09:46 PM Back to top Page 1 of 3 1 2 3 Next Back to Gebrauchsfertige Skripte & Funktionen Reply to quoted posts     Clear     AutoHotkey Community → Deutsch (German) → Gebrauchsfertige Skripte & Funktionen Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"by Bentschi - Class based sockets library. Supports TCP and UDP."	"true"
"Plotting (graphs, bars, charts and etc)"	"BarChart"	"https://autohotkey.com/board/topic/82959-barchart/"	"by Learning One - Library for making bar charts. Download."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"BarChart - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. BarChart Started by Learning one , Jul 24 2012 08:35 PM Page 1 of 2 1 2 Next Please log in to reply 22 replies to this topic Learning one Members 1483 posts Last active: Jan 02 2016 02:30 PM Joined: 04 Apr 2009 WARNING: This is old thread. It is continued here. BarChart() - compatible with AHK_L and AHK Basic - no globals - has 20 built-in skins + you can make your own - requires Gdip.ahk by Tic Download BarChart.zip which includes: BarChart.ahk, examples, Gdip.ahk, screenshots. Short documentation and license are in BarChart.ahk's comments. Learn from examples.   See also: - Excel Charts by Xx7 - XGraph by SKAN #1 - Posted 24 July 2012 - 08:35 PM My Website • Recommended: AutoHotkey Unicode 32-bit • Join DropBox, Copy Back to top guest3456 Members 1704 posts Last active: Nov 19 2015 11:58 AM Joined: 10 Mar 2011 nice work as usual #2 - Posted 24 July 2012 - 08:49 PM Back to top Wicked Members 504 posts Last active: Jun 14 2014 06:04 PM Joined: 07 Jun 2008 My God. I've not had time to check it out yet, but damn it looks good! EDIT: After trying it out... Fantastic! These are VERY well done! #3 - Posted 25 July 2012 - 02:11 AM Back to top sumon Moderators 1317 posts Last active: Mar 28 2015 08:33 PM Joined: 18 May 2010 I applaud you for a clean code, simple to use, good visuals. Very nice! #4 - Posted 25 July 2012 - 08:14 AM ~sumon • APPIFYER Back to top Learning one Members 1483 posts Last active: Jan 02 2016 02:30 PM Joined: 04 Apr 2009 Thanks #5 - Posted 28 July 2012 - 12:28 AM My Website • Recommended: AutoHotkey Unicode 32-bit • Join DropBox, Copy Back to top iDrug Members 389 posts Last active: Oct 11 2015 09:24 PM Joined: 13 Oct 2009 o-some! it would be nice to have other kinds of graphs, though: 1. vertical ones (just rotate the current ones by 90 degrees) 2. one line graphs: #6 - Posted 30 October 2012 - 03:13 PM AHK channel without Ops and rules: irc.freenode.net #.ahk Back to top Learning one Members 1483 posts Last active: Jan 02 2016 02:30 PM Joined: 04 Apr 2009 vertical ones (just rotate the current ones by 90 degrees)The newest update (which was finished 2 months ago but not released yet because of www.autohotkey.net problems) has example which demostrates vertical bar charts - column charts. You can already do it with the current version by using Gdip_RotateBitmap() function which I posted in Tic's GDI+ lib thread. one line graphsMaybe I'll do it once... Multi lines in one chart should be supported too. #7 - Posted 30 October 2012 - 08:03 PM My Website • Recommended: AutoHotkey Unicode 32-bit • Join DropBox, Copy Back to top m3nth0l Members 27 posts Last active: Feb 13 2015 11:34 PM Joined: 19 Oct 2011 Very awesome script! Great job. #8 - Posted 31 October 2012 - 07:04 PM Back to top Learning one Members 1483 posts Last active: Jan 02 2016 02:30 PM Joined: 04 Apr 2009 Thanks. BarChart updated: simplified usage, new possibilities, new examples. #9 - Posted 02 December 2012 - 05:59 PM My Website • Recommended: AutoHotkey Unicode 32-bit • Join DropBox, Copy Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011 Hi L1,   This is phenomenal!!  I'm really liking the ""DarkT"" skin.   Quick question for you..  without changing the bars, would it be possible to change the age ""27"" to ""Oldest"".. and age ""22"" to ""Youngest"".  Any quick way to hide the actual numbers and just have bars and text?           Another really ""minor"" adjustment that could be made is if there are negative values, the fade might look abit more symmetrical if it went the other way?? or was this your preference? #10 - Posted 16 December 2012 - 10:32 PM Back to top Joe Glines Members 118 posts Last active: Jan 24 2016 03:08 PM Joined: 23 Dec 2009 This is awesome!  I report on a lot of data and frequently graph it in Excel.  This opens up the possibility of doing it all in AutoHotKey!   #11 - Posted 16 December 2012 - 11:14 PM Automating the mundane 1 script at a time... https://www.linkedin.com/in/joeglines The-Automator Back to top Learning one Members 1483 posts Last active: Jan 02 2016 02:30 PM Joined: 04 Apr 2009 Thanks.   without changing the bars, would it be possible to change the age ""27"" to ""Oldest"".. and age ""22"" to ""Youngest"".Such feature is not built in BarChart. What you could do is to create BarChar bitmap - pBitmap := BarChart(), than get Gdip_GraphicsFromImage(), and than overwrite part of bar where ""27 & 22"" are written; first with rectangle - Gdip_FillRoundedRectangle() or Gdip_FillRectangle, and than write Gdip_TextToGraphics().   Any quick way to hide the actual numbers and just have bars and text?Yes. Add DisplayValues:0 in the Options parameter.   if there are negative values, the fade might look abit more symmetrical if it went the other way?Hm... yes... I'll think about changing that. For now use other skins which have vertical bar gradient or use BarColorDirection:1 in  Options parameter which actually represents WrapMode in Gdip_CreateLineBrushFromRect(), and that is; LinearGradientModeHorizontal = 0 LinearGradientModeVertical = 1 LinearGradientModeForwardDiagonal = 2 LinearGradientModeBackwardDiagonal = 3     #12 - Posted 19 December 2012 - 05:59 PM My Website • Recommended: AutoHotkey Unicode 32-bit • Join DropBox, Copy Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011   Yes. Add DisplayValues:0 in the Options parameter.     Perfect, this is what I was looking for!       Such feature is not built in BarChart. What you could do is to create BarChar bitmap - pBitmap := BarChart(), than get Gdip_GraphicsFromImage(), and than overwrite part of bar where ""27 & 22"" are written; first with rectangle - Gdip_FillRoundedRectangle() or Gdip_FillRectangle, and than write Gdip_TextToGraphics().     If you set DisplayValues := 0, then you could store the names and alter any text subsequent which is what I desired. Thanks!      var_1 := ""Steve: Oldest"" var_2 := ""Jenny: Youngest""   AgeChart = ( Mike 24 %var_1% 27 Chris 25 %var_2% 22 Marry 23 ) ;....etc...  BarChart(AgeChart, ""AgePic"", 1, ""Age"", Skin, ""DisplayValues:0"")     #13 - Posted 20 December 2012 - 04:05 AM Back to top Learning one Members 1483 posts Last active: Jan 02 2016 02:30 PM Joined: 04 Apr 2009 Ha!   You know how to use BarChart() better than me!   Respect!  #14 - Posted 20 December 2012 - 07:18 PM My Website • Recommended: AutoHotkey Unicode 32-bit • Join DropBox, Copy Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011 L1, your script got me thinking...   I was looking for a way to create a graph in Excel, then show it as a GUI. Please check out my script Excel Charts, if you have time! #15 - Posted 22 December 2012 - 09:27 PM Back to top Page 1 of 2 1 2 Next Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"by Learning One - Library for making bar charts. Download."	"true"
"Plotting (graphs, bars, charts and etc)"	"link"	"https://dl.dropboxusercontent.com/u/171417982/AHK/BarChart/BarChart.zip"	"by Learning One - Library for making bar charts. Download."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"by Learning One - Library for making bar charts. Download."	"false"
"Plotting (graphs, bars, charts and etc)"	"Excel Charts"	"https://autohotkey.com/board/topic/88438-excel-charts/"	"by Xx7 - Library for creating a graph in Excel, save the graph as an image and display it in a GUI."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Excel Charts - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. Excel Charts Started by Xx7 , Dec 22 2012 07:07 PM Page 1 of 3 1 2 3 Next Please log in to reply 33 replies to this topic Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011 Inspired by Learning one's BarChart... Excel Charts creates a graph in Excel, saves the graph as an image and displays it in a GUI.       **EDIT: originally was a question.. solved below ... working examples from post #2 onwards!** -tested on AHK_L & Excel 2010 (3D graphs may not work in prior versions)   Original question: How could I save the graph as an image WITHOUT making Excel visible through the whole process.  I don't want the user to see Excel open at all.  I want them to be able to run the script, and then a GUI with their graph will show up.    XL := ComObjCreate(""Excel.Application"") XL.WorkBooks.Add XL.Visible := true  ;<--- I want this to be false... so Excel never appears  XL.Range(""A1"").Value := ""Sept"" XL.Range(""A2"").Value := ""Oct"" XL.Range(""A3"").Value := ""Nov"" XL.Range(""A4"").Value := ""Dec""  XL.Range(""B1"").Value := 10 XL.Range(""B2"").Value := 14 XL.Range(""B3"").Value := 33 XL.Range(""B4"").Value := 21  XL.Range(""A1:B4"").Select XL.ActiveSheet.Shapes.AddChart.Select XL.ActiveChart.ChartType := 63 XL.ActiveChart.PlotArea.Select XL.ActiveChart.SetElement(207) XL.Range(""A1"").Select return     Here's the result of running the above script...     I want to save the graph as an image and show it in a GUI... so the user only sees this #1 - Posted 22 December 2012 - 07:07 PM Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011 I believe this does it...  XL.Worksheets(""Sheet1"").ChartObjects(1).Chart.Export(""C:\pic1.bmp"")     Final code:  XL := ComObjCreate(""Excel.Application"") XL.WorkBooks.Add  XL.Range(""A1"").Value := ""Sept"" XL.Range(""A2"").Value := ""Oct"" XL.Range(""A3"").Value := ""Nov"" XL.Range(""A4"").Value := ""Dec""  XL.Range(""B1"").Value := 10 XL.Range(""B2"").Value := 14 XL.Range(""B3"").Value := 33 XL.Range(""B4"").Value := 21  XL.Range(""A1:B4"").Select XL.ActiveSheet.Shapes.AddChart.Select XL.ActiveChart.ChartType := 63 XL.ActiveChart.PlotArea.Select XL.ActiveChart.SetElement(207) XL.Range(""A1"").Select  XL.Worksheets(""Sheet1"").ChartObjects(1).Chart.Export(""C:\pic1.bmp"")  XL.ActiveWorkbook.Close(0) XL.Quit  Gui, Add, Picture, , C:\pic1.bmp Gui, Show return   #2 - Posted 22 December 2012 - 07:33 PM Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011 Here's another one for you...  The possibilities are endless since it is based on Excel's graphing          XL := ComObjCreate(""Excel.Application"") XL.WorkBooks.Add  XL.Range(""A1"").Value := ""Sept"" XL.Range(""A2"").Value := ""Oct"" XL.Range(""A3"").Value := ""Nov"" XL.Range(""A4"").Value := ""Dec""  XL.Range(""B1"").Value := 10 XL.Range(""B2"").Value := 14 XL.Range(""B3"").Value := 33 XL.Range(""B4"").Value := 21  XL.Range(""C1"").Value := 22 XL.Range(""C2"").Value := 41 XL.Range(""C3"").Value := 14 XL.Range(""C4"").Value := 31  XL.Range(""A1:C4"").Select XL.ActiveSheet.Shapes.AddChart.Select XL.ActiveChart.ChartType := -4101 XL.ActiveChart.PlotArea.Select XL.ActiveChart.ChartArea.Select XL.ActiveChart.SetElement(2) XL.ActiveChart.ChartTitle.Text := ""3D AHK line graph""  XL.ActiveSheet.Shapes(""Chart 1"").Fill.ForeColor.ObjectThemeColor := 15 XL.ActiveSheet.Shapes(""Chart 1"").Fill.ForeColor.Brightness := 0.8000000119  XL.Worksheets(""Sheet1"").ChartObjects(1).Chart.Export(""C:\pic1.bmp"")  XL.ActiveWorkbook.Close(0) XL.Quit   Gui, Add, Picture, , C:\pic1.bmp Gui, Show return   #3 - Posted 22 December 2012 - 08:09 PM Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011        XL := ComObjCreate(""Excel.Application"") XL.WorkBooks.Add  XL.Range(""A1"").Value := ""Sept"" XL.Range(""A2"").Value := ""Oct"" XL.Range(""A3"").Value := ""Nov"" XL.Range(""A4"").Value := ""Dec""  XL.Range(""B1"").Value := 10 XL.Range(""B2"").Value := 14 XL.Range(""B3"").Value := 33 XL.Range(""B4"").Value := 21  XL.Range(""C1"").Value := 22 XL.Range(""C2"").Value := 41 XL.Range(""C3"").Value := 14 XL.Range(""C4"").Value := 31  XL.Range(""A1:C4"").Select XL.ActiveSheet.Shapes.AddChart.Select XL.ActiveChart.ChartType := -4100 XL.ActiveChart.ClearToMatchStyle XL.ActiveChart.ChartStyle := 42 XL.ActiveChart.ClearToMatchStyle  XL.Worksheets(""Sheet1"").ChartObjects(1).Chart.Export(""C:\pic1.bmp"")  XL.ActiveWorkbook.Close(0) XL.Quit  Gui, Add, Picture, , C:\pic1.bmp Gui, Show return     Maybe move this to the Scripts forum.. #4 - Posted 22 December 2012 - 08:23 PM Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011        XL := ComObjCreate(""Excel.Application"") XL.WorkBooks.Add  XL.Range(""A1"").Value := ""Sept"" XL.Range(""A2"").Value := ""Oct"" XL.Range(""A3"").Value := ""Nov"" XL.Range(""A4"").Value := ""Dec""  XL.Range(""B1"").Value := 10 XL.Range(""B2"").Value := 14 XL.Range(""B3"").Value := 33 XL.Range(""B4"").Value := 21  XL.Range(""C1"").Value := 22 XL.Range(""C2"").Value := 41 XL.Range(""C3"").Value := 14 XL.Range(""C4"").Value := 31  XL.Range(""A1:C4"").Select XL.ActiveSheet.Shapes.AddChart.Select XL.ActiveChart.ChartType := 104 XL.ActiveChart.ClearToMatchStyle XL.ActiveChart.ChartStyle := 45 XL.ActiveChart.ClearToMatchStyle XL.ActiveChart.SetElement(1) XL.ActiveChart.ChartTitle.Text := ""Green Cone""  XL.Worksheets(""Sheet1"").ChartObjects(1).Chart.Export(""C:\pic1.bmp"")  XL.ActiveWorkbook.Close(0) XL.Quit  Gui, Add, Picture, , C:\pic1.bmp Gui, Show return #5 - Posted 22 December 2012 - 08:35 PM Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011        XL := ComObjCreate(""Excel.Application"") XL.WorkBooks.Add  XL.Range(""A2"").Value := ""Sept"" XL.Range(""A3"").Value := ""Oct"" XL.Range(""A4"").Value := ""Nov"" XL.Range(""A5"").Value := ""Dec""  XL.Range(""B1"").Value := ""Days"" XL.Range(""B2"").Value := 10 XL.Range(""B3"").Value := 14 XL.Range(""B4"").Value := 33 XL.Range(""B5"").Value := 21  XL.Range(""C1"").Value := ""Temp"" XL.Range(""C2"").Value := 22 XL.Range(""C3"").Value := 41 XL.Range(""C4"").Value := 14 XL.Range(""C5"").Value := 31  XL.Range(""A1:C5"").Select XL.ActiveSheet.Shapes.AddChart.Select XL.ActiveChart.ChartType := 78 XL.ActiveChart.ClearToMatchStyle XL.ActiveChart.ChartStyle := 40 XL.ActiveChart.ClearToMatchStyle XL.ActiveChart.Axes(2).MajorGridlines.Select XL.ActiveChart.SetElement(1) XL.ActiveChart.ChartTitle.Text := ""Temp & Days""  XL.ActiveSheet.Shapes(""Chart 1"").Fill.ForeColor.ObjectThemeColor := 14 XL.ActiveSheet.Shapes(""Chart 1"").Fill.ForeColor.Brightness := -0.150000006  XL.Worksheets(""Sheet1"").ChartObjects(1).Chart.Export(""C:\pic1.bmp"")  XL.ActiveWorkbook.Close(0) XL.Quit  Gui, Add, Picture, , C:\pic1.bmp Gui, Show return   #6 - Posted 22 December 2012 - 08:55 PM Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011        XL := ComObjCreate(""Excel.Application"") XL.WorkBooks.Add  XL.Range(""A2"").Value := ""Sept"" XL.Range(""A3"").Value := ""Oct"" XL.Range(""A4"").Value := ""Nov"" XL.Range(""A5"").Value := ""Dec""  XL.Range(""B1"").Value := ""Days"" XL.Range(""B2"").Value := 10 XL.Range(""B3"").Value := 14 XL.Range(""B4"").Value := 33 XL.Range(""B5"").Value := 21  XL.Range(""C1"").Value := ""Temp"" XL.Range(""C2"").Value := 22 XL.Range(""C3"").Value := 41 XL.Range(""C4"").Value := 14 XL.Range(""C5"").Value := 31  XL.Range(""A1:C5"").Select XL.ActiveSheet.Shapes.AddChart.Select XL.ActiveChart.ChartType := 81 XL.ActiveChart.ClearToMatchStyle XL.ActiveChart.ChartStyle := 48 XL.ActiveChart.ClearToMatchStyle  XL.Worksheets(""Sheet1"").ChartObjects(1).Chart.Export(""C:\pic1.bmp"")  XL.ActiveWorkbook.Close(0) XL.Quit  Gui, Add, Picture, , C:\pic1.bmp Gui, Show return   #7 - Posted 22 December 2012 - 09:06 PM Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011    XL := ComObjCreate(""Excel.Application"") XL.WorkBooks.Add  XL.Range(""A2"").Value := ""Sept"" XL.Range(""A3"").Value := ""Oct"" XL.Range(""A4"").Value := ""Nov"" XL.Range(""A5"").Value := ""Dec""  XL.Range(""B1"").Value := ""Temp"" XL.Range(""B2"").Value := 22 XL.Range(""B3"").Value := 41 XL.Range(""B4"").Value := 14 XL.Range(""B5"").Value := 31  XL.Range(""A1:B5"").Select XL.ActiveSheet.Shapes.AddChart.Select XL.ActiveChart.ChartType := -4102 XL.ActiveChart.ClearToMatchStyle XL.ActiveChart.ChartStyle := 48 XL.ActiveChart.ClearToMatchStyle XL.ActiveChart.ChartTitle.Select XL.ActiveChart.ChartTitle.Text := ""Mmmmmm...   Pie""  XL.Worksheets(""Sheet1"").ChartObjects(1).Chart.Export(""C:\pic1.bmp"")  XL.ActiveWorkbook.Close(0) XL.Quit  Gui, Add, Picture, , C:\pic1.bmp Gui, Show return #8 - Posted 22 December 2012 - 09:20 PM Back to top guest3456 Members 1704 posts Last active: Nov 19 2015 11:58 AM Joined: 10 Mar 2011 indeed, well done, should move to scripts forum   must you have Excel installed for this to work? #9 - Posted 22 December 2012 - 10:39 PM Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011 If changing the size, probably best to do it in Excel to maintain the highest quality.      XL.ActiveSheet.Shapes(""Chart 1"").ScaleWidth(1.3,0,0) ;Magnified at 130%... use "".8"" for 80%  XL.ActiveSheet.Shapes(""Chart 1"").ScaleHeight(1.3,0,0) ;;Magnified at 130%..   Chart at 80% size   Chart magnified at 130%        XL := ComObjCreate(""Excel.Application"") XL.WorkBooks.Add  XL.Range(""A2"").Value := ""Sept"" XL.Range(""A3"").Value := ""Oct"" XL.Range(""A4"").Value := ""Nov"" XL.Range(""A5"").Value := ""Dec""  XL.Range(""B1"").Value := 2010 XL.Range(""B2"").Value := 10 XL.Range(""B3"").Value := 14 XL.Range(""B4"").Value := 33 XL.Range(""B5"").Value := 21  XL.Range(""C1"").Value := 2011 XL.Range(""C2"").Value := 22 XL.Range(""C3"").Value := 41 XL.Range(""C4"").Value := 14 XL.Range(""C5"").Value := 31  XL.Range(""D1"").Value := 2012 XL.Range(""D2"").Value := 30 XL.Range(""D3"").Value := 8 XL.Range(""D4"").Value := 27 XL.Range(""D5"").Value := 11  XL.Range(""A1:D5"").Select XL.ActiveSheet.Shapes.AddChart.Select XL.ActiveChart.ChartType := 92 XL.ActiveChart.ClearToMatchStyle XL.ActiveChart.ChartStyle := 43 XL.ActiveChart.ClearToMatchStyle  XL.ActiveSheet.ChartObjects(""Chart 1"").Activate XL.ActiveChart.SetElement(102) XL.ActiveChart.SetElement(2) XL.ActiveChart.ChartTitle.Text := ""Blue Tube""  XL.ActiveSheet.ChartObjects(""Chart 1"").Activate XL.ActiveSheet.Shapes(""Chart 1"").ScaleWidth(1.3,0,0)  ;Magnified at 130%... use "".8"" for 80% above XL.ActiveSheet.Shapes(""Chart 1"").ScaleHeight(1.3,0,0) ;;Magnified at 130%..  XL.Worksheets(""Sheet1"").ChartObjects(1).Chart.Export(""C:\pic1.bmp"")  XL.ActiveWorkbook.Close(0) XL.Quit  Gui, Add, Picture, , C:\pic1.bmp Gui, Show return #10 - Posted 22 December 2012 - 11:02 PM Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011     Download --->  Compiled version    FileInstall, C:\BlueSea.png, BlueSea.png, 1  ;include this pic as background image blue_sea := A_WorkingDir ""\BlueSea.png""   XL := ComObjCreate(""Excel.Application"") XL.WorkBooks.Add  XL.Range(""A2"").Value := ""Sept"" XL.Range(""A3"").Value := ""Oct"" XL.Range(""A4"").Value := ""Nov"" XL.Range(""A5"").Value := ""Dec""  XL.Range(""B1"").Value := ""2010"" XL.Range(""B2"").Value := 10 XL.Range(""B3"").Value := 14 XL.Range(""B4"").Value := 33 XL.Range(""B5"").Value := 21  XL.Range(""C1"").Value := 2011 XL.Range(""C2"").Value := 22 XL.Range(""C3"").Value := 41 XL.Range(""C4"").Value := 14 XL.Range(""C5"").Value := 31  XL.Range(""D1"").Value := 2012 XL.Range(""D2"").Value := 30 XL.Range(""D3"").Value := 8 XL.Range(""D4"").Value := 27 XL.Range(""D5"").Value := 11  XL.Range(""A1:D5"").Select XL.ActiveSheet.Shapes.AddChart.Select XL.ActiveChart.ChartType := 92 XL.ActiveChart.ClearToMatchStyle XL.ActiveChart.ChartStyle := 43 XL.ActiveChart.ClearToMatchStyle  XL.ActiveSheet.ChartObjects(""Chart 1"").Activate XL.ActiveChart.SetElement(102) XL.ActiveChart.SetElement(2) XL.ActiveChart.ChartTitle.Text := ""Blue Sea with Pic""  XL.ActiveSheet.ChartObjects(""Chart 1"").Activate XL.ActiveSheet.Shapes(""Chart 1"").ScaleWidth(1.1,0,0) XL.ActiveSheet.Shapes(""Chart 1"").ScaleHeight(1.1,0,0)  XL.ActiveSheet.ChartObjects(""Chart 1"").Activate XL.ActiveSheet.Shapes(""Chart 1"").Fill.UserPicture(blue_sea)  ;background pic  XL.Worksheets(""Sheet1"").ChartObjects(1).Chart.Export(""C:\pic1.bmp"")  XL.ActiveWorkbook.Close(0) XL.Quit  Gui, Add, Picture, , C:\pic1.bmp Gui, Show return #11 - Posted 23 December 2012 - 12:23 AM Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011 indeed, well done, should move to scripts forum   must you have Excel installed for this to work?     Moved & Yes, Excel is required!  Tested on Excel 2010, unsure if the 3D charts will work on older versions. #12 - Posted 23 December 2012 - 04:34 AM Back to top S0und Members 100 posts Last active: Apr 08 2015 10:07 AM Joined: 16 Feb 2007 This is awesome, thanks for sharing! #13 - Posted 23 December 2012 - 06:51 PM Back to top Xx7 Members 674 posts Last active: Mar 24 2015 10:48 PM Joined: 19 Apr 2011      XL := ComObjCreate(""Excel.Application"") XL.WorkBooks.Add  XL.Range(""B1"").Value := ""Budget"" XL.Range(""C1"").Value := ""2011"" XL.Range(""D1"").Value := ""2012""  Array_1 := [""Jan"",""Feb"",""Mar"",""Apr"",""May"",""Jun"",""Jul"",""Aug"",""Sep"",""Oct"",""Nov"",""Dec""]  ;--------- Chart generated using RANDOM values below ---------- Loop, 12 {   XL.Range(""A"" A_Index+1).Value := Array_1[A_Index]   Random, rand, 5, 60   XL.Range(""B"" A_Index+1).Value := rand   Random, rand, 40, 100   XL.Range(""C"" A_Index+1).Value := rand   Random, rand, 40, 100   XL.Range(""D"" A_Index+1).Value := rand } ;---------------------------------------------------------------   XLAS := XL.ActiveSheet  XL.Range(""A1:D13"").Select XLAS.Shapes.AddChart.Select XL.ActiveChart.ChartType := 4  ;All THREE charts originally set-up as Line Graphs XL.ActiveChart.ChartStyle := 42  ;Black background template XL.ActiveChart.ApplyLayout(5)  ;This is the design with boxed numbers on the bottom XLAS.Shapes(""Chart 1"").ScaleWidth(1.5,0,0) XLAS.Shapes(""Chart 1"").ScaleHeight(1.5,0,0) XL.ActiveChart.SeriesCollection(1).ChartType := 51  ;Changes the ""Budget"" chart to Bar Graph  XL.ActiveChart.SeriesCollection(3).Format.Line.ForeColor.RGB := 16711680  ;Changes ""2012"" to blue line XL.ActiveChart.SeriesCollection(2).Format.Line.ForeColor.RGB := 65535  ;Changes ""2011"" to yellow line ;Red 255, Orange 33023,Green 60928, Dark Green 25600... etc. ;Source: http://cloford.com/r...ours/500col.htm  XL.ActiveChart.SeriesCollection(2).Smooth := True  ;makes the junctions smooth instead of sharp corners XL.ActiveChart.SeriesCollection(3).Smooth := True XL.ActiveChart.ChartTitle.Text := ""Smoothed Bar-Line Chart"" XL.ActiveChart.Axes(2, 1).AxisTitle.Text := ""$ 000's""  XL.Worksheets(""Sheet1"").ChartObjects(1).Chart.Export(""C:\pic1.bmp"")  ;saves the chart as a pic XL.ActiveWorkbook.Close(0) XL.Quit  Gui, Add, Picture,, C:\pic1.bmp  ;shows the pic in the GUI Gui, Show return #14 - Posted 24 December 2012 - 09:16 AM Back to top Learning one Members 1483 posts Last active: Jan 02 2016 02:30 PM Joined: 04 Apr 2009 Good job Xx7! I put a link to your work in my BarChart thread.  #15 - Posted 24 December 2012 - 05:56 PM My Website • Recommended: AutoHotkey Unicode 32-bit • Join DropBox, Copy Back to top Page 1 of 3 1 2 3 Next Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"by Xx7 - Library for creating a graph in Excel, save the graph as an image and display it in a GUI."	"true"
"Plotting (graphs, bars, charts and etc)"	"XGraph"	"https://autohotkey.com/boards/viewtopic.php?t=3492"	"by SKAN - Function library for graphically plotting real time data."	"null"	"null"	"null"	"null"	"null"	""	"null"	"null"	"null"	"null"	"XGraph v1.1.1.0 : Real time data plotting. - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:28 All times are UTC-05:00 XGraph v1.1.1.0 : Real time data plotting. Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 14 posts • Page 1 of 1 SKAN Posts: 204 Joined: 29 Sep 2013, 16:58 XGraph v1.1.1.0 : Real time data plotting. Report this post Quote 05 May 2014, 19:14 Easy to use, Light weight, fast, efficient GDI based function library for graphically plotting real time data. Typical applications include real time usage/performance charts for CPU, HDD, Network etc and to a limited extent, it can also be used for historical charts like Weather, Stock etc. Simple example follows. ( Another example ) Code: [Select all] [Expand] [Download] (RandomPlot.ahk)GeSHi © Codebox Plus ListLines, Off #NoEnv #SingleInstance, Force #Include XGraph.ahk   Gui, Add, Text, w300 h105 hwndErrorLevel            ; Create a Text control pGraph := XGraph( ErrorLevel )                      ; Attach XGraph Gui, Show,, XGraph : Plotting Random values   SetTimer, RandomPlot   F1::Msgbox, 0x1040, XGraph, % XGraph_Info( pGraph ) ; // end of auto-execute section //   RandomPlot:  Random, MY2, 0, 100  XGraph_Plot( pGraph, MY2 )                         ; Plot values Return The Library: XGraph.ahk Code: [Select all] [Expand] [Download] (XGraph.ahk)GeSHi © Codebox Plus /*      __    __  __          __ __       __    __                 _       __                       / /_  / /_/ /_____  _ / // /____ _/ /_  / /________________(_)___  / /_ ____  _______    / __ \/ __/ __/ __ \(_) // // __ '/ __ \/ //_/ ___/ ___/ __/ / __ \/ __// __ \/ __/ _ \       / / / / /_/ /_/ /_/ / / // // /_/ / / / / ,< (__  ) /__/ / / / /_/ / /__/ /_/ / / / // /  /_/ /_/\__/\__/ .___(_) // / \__,_/_/ /_/_/|_/____/\___/_/ /_/ .___/\__(_)____/_/  \__ /                /_/     /_//_/                                 /_/                   (___/       Script      :  XGraph v1.1.1.0 : Real time data plotting.                  http://ahkscript.org/boards/viewtopic.php?t=3492                  Created: 24-Apr-2014,  Last Modified: 09-May-2014     Description :  Easy to use, Light weight, fast, efficient GDI based function library for                  graphically plotting real time data.     Author      :  SKAN - Suresh Kumar A N ( arian.suresh@gmail.com )   Demos       :  CPU Load Monitor > http://ahkscript.org/boards/viewtopic.php?t=3413   - -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - */   XGraph( hCtrl, hBM := 0, ColumnW := 3, LTRB := ""0,2,0,2"", PenColor := 0x808080, PenSize := 1, SV := 0 ) { Static WM_SETREDRAW := 0xB, STM_SETIMAGE := 0x172, PS_SOLID := 0, cbSize := 136, SRCCOPY := 0x00CC0020      , GPTR := 0x40, OBJ_BMP := 0x7, LR_CREATEDIBSECTION := 0x2000, LR_COPYDELETEORG := 0x8   ; Validate control    WinGetClass, Class,   ahk_id %hCtrl%    Control, Style, +0x5000010E,, ahk_id %hCtrl%   ControlGet, Style, Style,,, ahk_id %hCtrl%   ControlGet, ExStyle, ExStyle,,, ahk_id %hCtrl%   ControlGetPos,,, CtrlW, CtrlH,, ahk_id %hCtrl%   If not ( Class == ""Static"" and Style = 0x5000010E and ExStyle = 0 and CtrlW > 0 and CtrlH > 0 )      Return 0, ErrorLevel := -1   ; Validate Bitmap   If ( DllCall( ""GetObjectType"", ""Ptr"",hBM ) <> OBJ_BMP )        hTargetBM := DllCall( ""CreateBitmap"", ""Int"",2, ""Int"",2, ""UInt"",1, ""UInt"",16, ""Ptr"",0, ""Ptr"" )     ,  hTargetBM := DllCall( ""CopyImage"", ""Ptr"",hTargetBM, ""UInt"",0, ""Int"",CtrlW, ""Int"",CtrlH                            , ""UInt"",LR_CREATEDIBSECTION|LR_COPYDELETEORG, ""Ptr"" )   else hTargetBM := hBM      VarSetCapacity( BITMAP,32,0 )      DllCall( ""GetObject"", ""Ptr"",hTargetBM, ""Int"",( A_PtrSize = 8 ? 32 : 24 ), ""Ptr"",&BITMAP )   If NumGet( BITMAP, 18, ""UInt"" ) < 16 ; Checking if BPP < 16       Return 0, ErrorLevel := -2   Else BitmapW := NumGet( BITMAP,  4, ""UInt"" ),  BitmapH := NumGet( BITMAP, 8, ""UInt"" )       If ( BitmapW <> CtrlW or BitmapH <> CtrlH )                    Return 0, ErrorLevel := -3   ; Validate Margins and Column width     StringSplit, M, LTRB, `, , %A_Space% ; Left,Top,Right,Bottom   MarginL := ( M1+0 < 0 ? 0 : M1 ),    MarginT     := ( M2+0 < 0 ? 0 : M2 )   MarginR := ( M3+0 < 0 ? 0 : M3 ),    MarginB     := ( M4+0 < 0 ? 0 : M4 )    ColumnW := ( ColumnW+0 < 0 ? 3 : ColumnW & 0xff ) ; 1 - 255   ; Derive Columns, BitBlt dimensions, Movement coords for Lineto() and MoveToEx()    Columns := ( BitmapW - MarginL - MarginR ) // ColumnW   BitBltW := Columns * ColumnW,                BitBltH := BitmapH - MarginT - MarginB   MX1     := BitBltW - ColumnW,                    MY1 := BitBltH - 1   MX2     := MX1 + ColumnW - ( PenSize < 1 ) ;     MY2 := < user defined >   ; Initialize Memory Bitmap   hSourceDC  := DllCall( ""CreateCompatibleDC"", ""Ptr"",0, ""Ptr"" )   hSourceBM  := DllCall( ""CopyImage"", ""Ptr"",hTargetBM, ""UInt"",0, ""Int"",ColumnW * 2 + BitBltW                        , ""Int"",BitBltH, ""UInt"",LR_CREATEDIBSECTION, ""Ptr"" )     DllCall( ""SaveDC"", ""Ptr"",hSourceDC )   DllCall( ""SelectObject"", ""Ptr"",hSourceDC, ""Ptr"",hSourceBM )     hTempDC    := DllCall( ""CreateCompatibleDC"", ""Ptr"",0, ""Ptr"" )   DllCall( ""SaveDC"", ""Ptr"",hTempDC )   DllCall( ""SelectObject"", ""Ptr"",hTempDC, ""Ptr"",hTargetBM )     If ( hTargetBM <> hBM )     hBrush := DllCall( ""CreateSolidBrush"", UInt,hBM & 0xFFFFFF, ""Ptr"" )   , VarSetCapacity( RECT, 16, 0 )   , NumPut( BitmapW, RECT, 8, ""UInt"" ),  NumPut( BitmapH, RECT,12, ""UInt"" )   , DllCall( ""FillRect"", ""Ptr"",hTempDC, ""Ptr"",&RECT, ""Ptr"",hBrush )   , DllCall( ""DeleteObject"", ""Ptr"",hBrush )     DllCall( ""BitBlt"", ""Ptr"",hSourceDC, ""Int"",ColumnW * 2, ""Int"",0, ""Int"",BitBltW, ""Int"",BitBltH                    , ""Ptr"",hTempDC,   ""Int"",MarginL, ""Int"",MarginT, ""UInt"",SRCCOPY )   DllCall( ""BitBlt"", ""Ptr"",hSourceDC, ""Int"",0, ""Int"",0, ""Int"",BitBltW, ""Int"",BitBltH                    , ""Ptr"",hTempDC,   ""Int"",MarginL, ""Int"",MarginT, ""UInt"",SRCCOPY )   ; Validate Pen color / Size                                                                      PenColor   := ( PenColor + 0 <> """" ? PenColor & 0xffffff : 0x808080 ) ; Range: 000000 - ffffff   PenSize    := ( PenSize  + 0 <> """" ? PenSize & 0xf : 1 )              ; Range: 0 - 15                  hSourcePen := DllCall( ""CreatePen"", ""Int"",PS_SOLID, ""Int"",PenSize, ""UInt"",PenColor, ""Ptr"" )   DllCall( ""SelectObject"", ""Ptr"",hSourceDC, ""Ptr"",hSourcePen )   DllCall( ""MoveToEx"", ""Ptr"",hSourceDC, ""Int"",MX1, ""Int"",MY1, ""Ptr"",0 )     hTargetDC := DllCall( ""GetDC"", ""Ptr"",hCtrl, ""Ptr"" )   DllCall( ""BitBlt"", ""Ptr"",hTargetDC, ""Int"",0, ""Int"",0, ""Int"",BitmapW, ""Int"",BitmapH                    , ""Ptr"",hTempDC,   ""Int"",0, ""Int"",0, ""UInt"",SRCCOPY )     DllCall( ""RestoreDC"", ""Ptr"",hTempDC, ""Int"",-1 )   DllCall( ""DeleteDC"",  ""Ptr"",hTempDC )        DllCall( ""SendMessage"", ""Ptr"",hCtrl, ""UInt"",WM_SETREDRAW, ""Ptr"",False, ""Ptr"",0 )   hOldBM := DllCall( ""SendMessage"", ""Ptr"",hCtrl, ""UInt"",STM_SETIMAGE, ""Ptr"",0, ""Ptr"",hTargetBM )      DllCall( ""SendMessage"", ""Ptr"",hCtrl, ""UInt"",WM_SETREDRAW, ""Ptr"",True,  ""Ptr"",0 )   DllCall( ""DeleteObject"", ""Ptr"",hOldBM )   ; Create / Update Graph structure   DataSz := ( SV = 1 ? Columns * 8 : 0 )   pGraph := DllCall( ""GlobalAlloc"", ""UInt"",GPTR, ""Ptr"",cbSize + DataSz, ""UPtr"" )   NumPut( DataSz, pGraph + cbSize - 8   )       VarL := ""cbSize / hCtrl / hTargetDC / hSourceDC / hSourceBM / hSourcePen / ColumnW / Columns / ""         . ""MarginL / MarginT / MarginR / MarginB / MX1 / MX2 / BitBltW / BitBltH""   Loop, Parse, VarL, /, %A_Space%     NumPut( %A_LoopField%, pGraph + 0, ( A_Index - 1 ) * 8 )   Return pGraph          }   ; -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -   XGraph_Info( pGraph, FormatFloat := """" ) { Static STM_GETIMAGE := 0x173   IfEqual, pGraph, 0, Return """",    ErrorLevel := -1   T := ""`t"",  TT := ""`t:`t"",  LF := ""`n"", SP := ""                ""     pData := pGraph + NumGet( pGraph + 0 ), DataSz := Numget( pData-8 )   If ( FormatFloat <> """" and DataSz )     GoTo, XGraph_Info_Data      VarL := ""cbSize / hCtrl / hTargetDC / hSourceDC / hSourceBM / hSourcePen / ColumnW / Columns / ""         . ""MarginL / MarginT / MarginR / MarginB / MX1 / MX2 / BitBltW / BitBltH""   Loop, Parse, VarL, /, %A_Space%     Offset := ( A_Index - 1 ) * 8,         %A_LoopField% := NumGet( pGraph + 0, OffSet )   , RAW    .= SubStr( Offset SP,1,3 ) T SubStr( A_LoopField SP,1,16 ) T %A_LoopField% LF     hTargetBM := DllCall( ""SendMessage"", ""Ptr"",hCtrl, ""UInt"",STM_GETIMAGE, ""Ptr"",0, ""Ptr"",0 )   VarSetCapacity( BITMAP,32,0 )   DllCall( ""GetObject"", ""Ptr"",hTargetBM, ""Int"",( A_PtrSize = 8 ? 32 : 24 ), ""Ptr"",&BITMAP )   TBMW := NumGet( BITMAP,  4, ""UInt"" ),            TBMH := NumGet( BITMAP, 8, ""UInt"" )   TBMB := NumGet( BITMAP, 12, ""UInt"" ) * TBMH,     TBMZ := Round( TBMB/1024,2 )   TBPP := NumGet( BITMAP, 18, ""UShort"" )   Adj := ( Adj := TBMW - MarginL - BitBltW - MarginR ) ? "" (-"" Adj "")"" : """"     DllCall( ""GetObject"", ""Ptr"",hSourceBM, ""Int"",( A_PtrSize = 8 ? 32 : 24 ), ""Ptr"",&BITMAP )   SBMW := NumGet( BITMAP,  4, ""UInt"" ),            SBMH := NumGet( BITMAP, 8, ""UInt"" )   SBMB := NumGet( BITMAP, 12, ""UInt"" ) * SBMH,     SBMZ := Round( SBMB/1024,2 )   SBPP := NumGet( BITMAP, 18, ""UShort"" )   Return ""GRAPH Properties"" LF LF  . ""Screen BG Bitmap   "" TT TBMW ( Adj ) ""x"" TBMH "" "" TBPP ""bpp ( "" TBMZ "" KB )"" LF  . ""Margins ( L,T,R,B )"" TT MarginL "","" MarginT "","" MarginR "","" MarginB LF  . ""Client Area        "" TT MarginL "","" MarginT "","" MarginL+BitBltW-1 "","" MarginT+BitBltH-1 LF LF  . ""Memory Bitmap      "" TT SBMW         ""x"" SBMH "" "" SBPP ""bpp ( "" SBMZ "" KB )"" LF  . ""Graph Width        "" TT BitBltW "" px ( "" Columns "" cols x "" ColumnW "" px )"" LF  . ""Graph Height (MY2) "" TT BitBltH "" px ( y0 to y"" BitBltH - 1 "" )"" LF   . ""Graph Array        "" TT ( DataSz=0 ? ""NA"" : Columns "" cols x 8 bytes = "" DataSz "" bytes"" ) LF LF  . ""Pen start position "" TT MX1 "","" BitBltH - 1 LF  . ""LineTo position    "" TT MX2 "","" ""MY2"" LF  . ""MoveTo position    "" TT MX1 "","" ""MY2"" LF LF  . ""STRUCTURE ( Offset / Variable / Raw value )"" LF LF RAW   XGraph_Info_Data:     AFF := A_FormatFloat   SetFormat, FloatFast, %FormatFloat%   Loop % DataSz // 8      Values .= SubStr( A_Index ""   "", 1, 4  ) T NumGet( pData - 8, A_Index * 8, ""Double"" ) LF   SetFormat, FloatFast, %AFF%   StringTrimRight, Values, Values, 1                                                                            Return Values      }   ; -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -   XGraph_Plot( pGraph, MY2 := """", SetVal := """", Draw := 1 ) { Static SRCCOPY := 0x00CC0020     IfEqual, pGraph, 0, Return """",    ErrorLevel := -1   pData     := pGraph + NumGet( pGraph + 0 ),     DataSz     := Numget( pData - 8 )   , hSourceDC := NumGet( pGraph + 24 ),             BitBltW    := NumGet( pGraph + 112 )     , hTargetDC := NumGet( pGraph + 16 ),             BitBltH    := NumGet( pGraph + 120 ) , ColumnW   := NumGet( pGraph + 48 )             , MarginL   := NumGet( pGraph + 64 ),             MX1 := NumGet( pGraph + 096 ) , MarginT   := NumGet( pGraph + 72 ),             MX2 := NumGet( pGraph + 104 )     If not ( MY2 = """" )                                      DllCall( ""BitBlt"", ""Ptr"",hSourceDC, ""Int"",0, ""Int"",0, ""Int"",BitBltW + ColumnW, ""Int"",BitBltH                     , ""Ptr"",hSourceDC, ""Int"",ColumnW, ""Int"",0, ""UInt"",SRCCOPY )   ,  DllCall( ""LineTo"",   ""Ptr"",hSourceDC, ""Int"",MX2, ""Int"",MY2 )   ,  DllCall( ""MoveToEx"", ""Ptr"",hSourceDC, ""Int"",MX1, ""Int"",MY2, ""Ptr"",0 )     If ( Draw = 1 )      DllCall( ""BitBlt"", ""Ptr"",hTargetDC, ""Int"",MarginL, ""Int"",MarginT, ""Int"",BitBltW, ""Int"",BitBltH                       , ""Ptr"",hSourceDC, ""Int"",0, ""Int"",0, ""UInt"",SRCCOPY )     If not ( MY2 = """" or SetVal = """" or DataSz = 0 )      DllCall( ""RtlMoveMemory"", ""Ptr"",pData, ""Ptr"",pData + 8, ""Ptr"",DataSz - 8 )   ,  NumPut( SetVal, pData + DataSz - 8, 0, ""Double"" )   Return 1 }   ; -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -   XGraph_SetVal( pGraph, Double := 0, Column := """" ) {     IfEqual, pGraph, 0, Return """",    ErrorLevel := -1   pData := pGraph + NumGet( pGraph + 0 ), DataSz := Numget( pData - 8 )   IfEqual, DataSz, 0, Return 0     If ( Column = """" )        DllCall( ""RtlMoveMemory"", ""Ptr"",pData, ""Ptr"",pData + 8, ""Ptr"",DataSz - 8 )      , pNumPut := pData + DataSz   else Columns := NumGet( pGraph + 56 )      , pNumPut := pData + ( Column < 0 or Column > Columns ? Columns * 8 : Column * 8 )   Return NumPut( Double, pNumPut - 8, 0, ""Double"" ) - 8       }   ; -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -   XGraph_GetVal( pGraph, Column := """" ) { Static RECT   If not VarSetCapacity( RECT )          VarSetCapacity( RECT, 16, 0 )     IfEqual, pGraph, 0, Return """",    ErrorLevel := -1   pData   := pGraph + NumGet( pGraph + 0 ),   DataSz  := Numget( pData - 8 )   Columns := NumGet( pGraph + 56 )   If not ( Column = """" or DataSz = 0 or Column < 1 or Column > Columns )     Return NumGet( pData - 8, Column * 8, ""Double"" ),    ErrorLevel := Column     hCtrl   := NumGet( pGraph + 8   ),          ColumnW := NumGet( pGraph + 48 )                      , BitBltW := NumGet( pGraph + 112 ),          MarginL := NumGet( pGraph + 64 ) , BitBltH := NumGet( pGraph + 120 ),          MarginT := NumGet( pGraph + 72 )   , Numput( MarginL, RECT, 0, ""Int"" ),          Numput( MarginT, RECT, 4, ""Int"" ) , DllCall( ""ClientToScreen"", ""Ptr"",hCtrl, ""Ptr"",&RECT ) , DllCall( ""GetCursorPos"", ""Ptr"",&RECT + 8 )   , MX := NumGet( RECT, 8, ""Int"" ) - NumGet( RECT, 0, ""Int"" ) , MY := NumGet( RECT,12, ""Int"" ) - NumGet( RECT, 4, ""Int"" )   , Column := ( MX >= 0 and MY >= 0 and MX < BitBltW and MY < BitBltH ) ? MX // ColumnW + 1 : 0 Return ( DataSz and Column ) ? NumGet( pData - 8, Column * 8, ""Double"" ) : """",    ErrorLevel := Column  }   ; -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -   XGraph_GetMean( pGraph, TailCols := """" ) {     IfEqual, pGraph, 0, Return """",    ErrorLevel := -1   pData := pGraph + NumGet( pGraph + 0 ), DataSz := Numget( pData - 8 )   IfEqual, DataSz, 0, Return 0,     ErrorLevel := 0     Columns := NumGet( pGraph + 56 )   pDataEnd := pGraph + NumGet( pGraph + 0 ) + ( Columns * 8 )   TailCols := ( TailCols = """" or TailCols < 1 or Tailcols > Columns ) ? Columns : TailCols     Loop %TailCols%     Value += NumGet( pDataEnd - ( A_Index * 8 ), 0, ""Double""  )   Return Value / TailCols,            ErrorLevel := TailCols }   ; -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -   XGraph_Detach( pGraph ) {   IfEqual, pGraph, 0, Return 0     VarL := ""cbSize / hCtrl / hTargetDC / hSourceDC / hSourceBM / hSourcePen""   Loop, Parse, VarL, /, %A_Space%     %A_LoopField% := NumGet( pGraph + 0, ( A_Index - 1 ) * 8 )     DllCall( ""ReleaseDC"",    ""Ptr"",hCtrl, ""Ptr"",hTargetDC )   DllCall( ""RestoreDC"",    ""Ptr"",hSourceDC, ""Int"",-1  )   DllCall( ""DeleteDC"",     ""Ptr"",hSourceDC  )   DllCall( ""DeleteObject"", ""Ptr"",hSourceBM  )                 DllCall( ""DeleteObject"", ""Ptr"",hSourcePen )   Return DllCall( ""GlobalFree"", ""Ptr"",pGraph, ""Ptr""  )   }   ; -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -   XGraph_MakeGrid(  CellW, CellH, Cols, Rows, GLClr, BGClr, ByRef BMPW := """", ByRef BMPH := """" ) { Static LR_Flag1 := 0x2008 ; LR_CREATEDIBSECTION := 0x2000 | LR_COPYDELETEORG := 8     ,  LR_Flag2 := 0x200C ; LR_CREATEDIBSECTION := 0x2000 | LR_COPYDELETEORG := 8 | LR_COPYRETURNORG := 4     ,  DC_PEN := 19     BMPW := CellW * Cols + 1,  BMPH := CellH * Rows + 1   hTempDC := DllCall( ""CreateCompatibleDC"", ""Ptr"",0, ""Ptr"" )   DllCall( ""SaveDC"", ""Ptr"",hTempDC )     If ( DllCall( ""GetObjectType"", ""Ptr"",BGClr ) = 0x7 )     hTBM := DllCall( ""CopyImage"", ""Ptr"",BGClr, ""Int"",0, ""Int"",BMPW, ""Int"",BMPH, ""UInt"",LR_Flag2, ""UPtr"" )   , DllCall( ""SelectObject"", ""Ptr"",hTempDC, ""Ptr"",hTBM )     Else     hTBM := DllCall( ""CreateBitmap"", ""Int"",2, ""Int"",2, ""UInt"",1, ""UInt"",24, ""Ptr"",0, ""Ptr"" )   , hTBM := DllCall( ""CopyImage"", ""Ptr"",hTBM,  ""Int"",0, ""Int"",BMPW, ""Int"",BMPH, ""UInt"",LR_Flag1, ""UPtr"" )   , DllCall( ""SelectObject"", ""Ptr"",hTempDC, ""Ptr"",hTBM )   , hBrush := DllCall( ""CreateSolidBrush"", ""UInt"",BGClr & 0xFFFFFF, ""Ptr"" )   , VarSetCapacity( RECT, 16 )   , NumPut( BMPW, RECT, 8, ""UInt"" ),  NumPut( BMPH, RECT, 12, ""UInt"" )   , DllCall( ""FillRect"", ""Ptr"",hTempDC, ""Ptr"",&RECT, ""Ptr"",hBrush )   , DllCall( ""DeleteObject"", ""Ptr"",hBrush )     hPenDC := DllCall( ""GetStockObject"", ""Int"",DC_PEN, ""Ptr"" )   DllCall( ""SelectObject"",  ""Ptr"",hTempDC, ""Ptr"",hPenDC )   DllCall( ""SetDCPenColor"", ""Ptr"",hTempDC, ""UInt"",GLClr & 0xFFFFFF )     Loop, % Rows + 1 + ( X := Y := 0 )      DllCall( ""MoveToEx"", ""Ptr"",hTempDC, ""Int"",X,    ""Int"",Y, ""Ptr"",0  )   , DllCall( ""LineTo"",   ""Ptr"",hTempDC, ""Int"",BMPW, ""Int"",Y ),  Y := Y + CellH     Loop, % Cols + 1 + ( X := Y := 0 )     DllCall( ""MoveToEx"", ""Ptr"",hTempDC, ""Int"",X, ""Int"",Y, ""Ptr"",0 )   , DllCall( ""LineTo"",   ""Ptr"",hTempDC, ""Int"",X, ""Int"",BMPH ),  X := X + CellW     DllCall( ""RestoreDC"", ""Ptr"",hTempDC, ""Int"",-1 )   DllCall( ""DeleteDC"",  ""Ptr"",hTempDC )      Return hTBM }   ; -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - The functions and parameters: XGraph() Create and attach graph. Returns a pointer to Graph data: hCtrl : Hwnd of Static control. The control's dimension ( W x H ) should be present and exactly match the size of the background bitmap. It is preferable to use a Text control instead of Picture control. Do not use any styles/exstyles or associate a variable with this control. To be specific: The text control should not have a non-client area. hBM : This parameter can be either hBitmap ( BPP 16|24 ) or COLORREF ( eg. 0x0000FF = Red ) that will be used as background. Note: The background bitmap will be applied to the control with STM_SETIMAGE. This means: The graph line may disappear when the timer is not running or the script is paused etc., But whenever window redraws, it draws the background bitmap and there is a guaranteed placeholder. If hBitmap, the dimension ( W x H ) should exactly match the size of the control. The bitmap can be a Grid returned by XGraph_MakeGrid(), or a vertical linear gradient returned by CreateDIB(). A horizontal linear gradient will produce undesirable result whilst plotting. If this parameter is a COLORREF ( eg. 0x0000FF = Red ), XGraph creates a 16BPP bitmap and fills it with COLORREF passed. Default value is 0x000000 and a black bitmap matching control's dimension is automatically created. ColumnW : Column width for each graph line, in pixels. Total columns is derived from this parameter. eg. For a background bitmap width of 600px with no left/right margins and ColumnW of 3, the Total columns will be 600//3 = 200 Columns. Default value is 2 and valid range is from 1 to 255. LTRB : Margin for Left,Top,Right,Bottom. XGraph derives a virtual client area ( or graph area ) using the margins specified. ( and is the reason why text control should not have styles like WS_BORDER or SS_SUNKEN ) Image transfer will occur from Memory bitmap to screen, only for the derived graph area. A background bitmap can be many times large than the graph area and LTRB allows you to specify the client rectangle where it actually needs to be drawn. Default value is 0,2,0,2. PenColor : The line color of graph passed as COLORREF. Default value is 0x808080 and valid range is from 0 to 0xFFFFFF. Note: 24bit color is enforced. PenSize : Thickness of graph line. If 0 is passed, graph line will be short by 1px per column and will result in broken lines. This is a feature. Default value is 1 and valid range is from 0 to 15. Note: GDI lines are not anti-aliased. Line thickness and background color plays an important role in graph's appearance. Pen size of 1 or 2 will be ideal in most situations. SV : Pass True to enable ""Set Value"" feature. Allocates space for internal array. When SV is true, XGraph allocates memory space of 8 bytes ( data type = double ) for each column of graph. Enabling internal array allows you to store/retrieve values with XGraph_Plot(), XGraph_SetVal(), XGraph_GetVal() and XGraph_GetMean(). Default value is False. XGraph_Plot() Plots graph line on FIFO basis. ( FIFO = First In, First Out ): For a graph with 30 columns, when 31st value is passed, the first value will move out of the graph. When called with single parameter, XGraph_Plot( pGraph ) will update screen without any actual plotting. pGraph : Pointer to Graph data. MY2 : The Y axis coordinate. Pass a null value if you want to refresh/redraw the graph ( Draw should be True ). Default value is NULL SetVal : A Column value to store. Updates internal array on FIFO basis. Value will be ignored if MY2 is NULL. Value will be ignored if internal array was not enabled when graph was created with XGraph(). Default value is NULL Draw : Transfers the graph from memory to screen. Default value is True. For historical graphs, you can pass False until all columns have been plotted and then call XGraph_Plot( pGraph ) to update the screen. XGraph_Detach() Detaches graph from control and releases/frees the resources is use: pGraph : Pointer to Graph data. Passing invalid pointer to XGraph_Plot() etc, will result in appcrash. When successful, XGraph_Detach() returns 0, so it is advised to store the return value from this function to pGraph itself. Correct usage: pGraph := XGraph_Detach( pGraph ). Functions that require pGraph as parameter will safely fail when pGraph equals zero XGraph_GetVal() Returns the associated value for a graph column: Note: Internal array should have been enabled when creating with XGraph(). pGraph : Pointer to Graph data. Column : Valid column number in graph. When invalid column number is passed, the value for the last column will be returned. Default parameter is NULL If this parameter is NULL, and the mouse pointer is over any of the columns, then value for the column under mouse will be returned and ErrorLevel will contain the column number under mouse Suggested usage: Assign a subroutine [ GoSub Label ) to text control and from the subroutine call XGraph_GetVal() and display the return value in Status bar. Well, one would be tempted to use ToolTip, but it will trigger WM_PAINT() which will erase the graph line. The workaround is to call XGraph_Plot( pGraph ) every time WM_PAINT() is triggered. XGraph_SetVal() Manually sets a value for any column, Returns pointer to written data : Note: Internal array should have been enabled when creating with XGraph(). pGraph : Pointer to Graph data. Double : The value. Column : Valid column number in graph. Invalid number will set the value for last column. XGraph_GetMean() Returns arithmetic mean for specified no. of columns: Note: Internal array should have been enabled when creating with XGraph(). ErrorLevel will contain the number of columns used for mean calculation. pGraph : Pointer to Graph data. TailCols : Number of columns ( at the tail of internal array ). XGraph_MakeGrid() Creates a bitmap and draws a grid on it, Returns hBitmap : CellW : Cell width should be same as Column width parameter of XGraph() CellH : Cell height. Cols : Columns required. Rows : Rows required. GLClr : Color of grid line. Note: 24bit color is enforced. BGClr : Background color. You can pass a hBitmap, which will be re-sized to fit the grid. You may create and pass a vertical linear gradient with CreateDIB() BMPW : ByRef. Width of Bitmap. BMPH : ByRef. Height of Bitmap. XGraph_Info() Returns either graph properties or Internal array data pGraph : Pointer to Graph data. FormatFloat: If this parameter is NULL, the function returns graph properties. If this parameter is non-NULL, it must be a valid float format like ""0.2"" which return all values from internal array :: end of documentation :: Sample code posted in following topic should demonstrate most of the functionality: CPULoad() : CPU usage percentage ( Demos for XGraph ) Screenshots from above topic: Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: XGraph v1.1.1.0 : Real time data plotting. Report this post Quote 05 May 2014, 21:15 WOW! THIS IS WAY COOL! I HAVE TO TRY THIS! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top strobo Posts: 125 Joined: 30 Sep 2013, 15:24 Re: XGraph v1.1.1.0 : Real time data plotting. Report this post Quote 07 May 2014, 16:20 Killer -- in the meaning of ""looks promising""**2. Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: XGraph v1.1.1.0 : Real time data plotting. Report this post Quote 07 May 2014, 22:05 i guess this script could be also used to generate charts, too? i mean static charts like in Excel (with labels and all)? any examples of such charts? Top Learning one Posts: 111 Joined: 04 Oct 2013, 13:59 Location: Croatia Contact: Contact Learning one Website Re: XGraph v1.1.1.0 : Real time data plotting. Report this post Quote 08 May 2014, 00:56 Guest10, look here; BarChart Nice library SKAN! My Website • Recommended: AutoHotkey Unicode 32-bit • Join DropBox, Copy Top SKAN Posts: 204 Joined: 29 Sep 2013, 16:58 Re: XGraph v1.1.1.0 : Real time data plotting. Report this post Quote 08 May 2014, 05:10 Learning one wrote:Nice library SKAN! Thanks. Guest10 wrote:static charts like in Excel GDI is very limited. Excel kind of charts requires GDI Plus. Learning one's Lib looks great . XGraph was specifically written to plot real time data at high speeds with bare minimum resources. Here is an example: When you move your mouse cursor fast enough, it can use 100% of CPU for 1ms which will not be caught by a CPU load monitor running with 1000ms timer as 100% usage for 1ms translates to 0.001% usage for 1000ms. Windows Task Manager's fastest speed is like 250ms. Any faster, the chart would peak as Task manager itself uses lot of CPU time. You can call XGraph_Plot() several thousands of times without registering 1 second of CPU time... But of course, what you plot does matter. GetSystemTimes() does not use much CPU whereas 'Random' command does. If not anything else, XGraph() can be a good performance testing tool. I actually wrote it to monitor the performance of my Mobile dial-up connection ( EDGE ) which is as erratic as Random plotting. Top SKAN Posts: 204 Joined: 29 Sep 2013, 16:58 XGraph_GetMean() Report this post Quote 08 May 2014, 15:36 Update: Added new function XGraph_GetMean(). This function can return the average value for X number of columns from the end of internal array. Here follows a demo that shows how to combine XGraph_SetVal() and XGraph_GetMean() to smoothen graph line. Code: [Select all] [Expand] [Download] (SmoothGraph.ahk)GeSHi © Codebox Plus ListLines, Off #NoEnv #SingleInstance, Force #Include XGraph.ahk   Gui, Add, Text,, Raw Random Values Gui, Add, Text,  y+3 w300 h105 hwndhGraph1           Gui, Add, Text,, Smoothened Random Values ( mean of last 3 values ) Gui, Add, Text,  y+3 w300 h105 hwndhGraph2 Gui, Add, Text,, Smoothened Random Values ( mean of last 10 values ) Gui, Add, Text,  y+3 w300 h105 hwndhGraph3   pGraph1 := XGraph( hGraph1, 0, 3, """", 0xAAAA00, 1, False )                    pGraph2 := XGraph( hGraph2, 0, 3, """", 0x00AAAA, 1, True  ) pGraph3 := XGraph( hGraph3, 0, 3, """", 0x00AA00, 1, True  )                      Gui, Show,, XGraph : Plotting Random values SetTimer, RandomPlot   Return ; // end of auto-execute section //   RandomPlot:   Random, MY2, 0, 100     XGraph_Plot( pGraph1, MY2 )                  ; Plot random value as is     XGraph_SetVal( pGraph2, MY2 )                ; Update internal array with raw value   SmoothMY2 := XGraph_GetMean( pGraph2, 3  )   ; Retrieve mean value for last 3 columns    XGraph_Plot( pGraph2, SmoothMY2 )            ; Plot smoothened value      XGraph_SetVal( pGraph3, MY2 )                ; Update internal array with raw value   SmoothMY2 := XGraph_GetMean( pGraph3, 10 )   ; Retrieve mean value for last 10 columns    XGraph_Plot( pGraph3, SmoothMY2 )            ; Plot smoothened value    Return   Top tank Posts: 1582 Joined: 28 Sep 2013, 22:15 Facebook: charlie.simmons.7334 GitHub: ttnnkkrr Location: Louisville KY Contact: Contact tank Website Re: XGraph v1.1.1.0 : Real time data plotting. Report this post Quote 09 Jun 2014, 11:52 I wonder about data points? dots on the line for each data point? We are troubled on every side‚ yet not distressed; we are perplexed‚ but not in despair; Persecuted‚ but not forsaken; cast down‚ but not destroyed; https://www.facebook.com/ahkscript.org Top SKAN Posts: 204 Joined: 29 Sep 2013, 16:58 Re: XGraph v1.1.1.0 : Real time data plotting. Report this post Quote 09 Jun 2014, 13:41 Hi tank, you wrote:dots on the line for each data point GDI is fast and efficient for a moving graph.. But since there is no anti-aliasing in GDI, I guess dots would not look good on the graph. Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: XGraph v1.1.1.0 : Real time data plotting. Report this post Quote 11 Jun 2014, 11:16 Hi, Could this maybe be repurposed for a regular chart? I would like to create something like the windows joystick test dialog using AHK. ie, replicate the functionality of the moving ""+"" in the X/Y chart. This dialog does not update when it does not have focus, whereas AHK does. I would like to make a tool for YouTubers that generates graphics to represent state of keyboard / mouse / joystick, for tutorial videos etc. GitHub page Top colt Posts: 1 Joined: 04 Aug 2014, 23:12 Re: XGraph v1.1.1.0 : Real time data plotting. Report this post Quote 05 Aug 2014, 18:38 Thank you so much for posting this! I will be using this library extensively in my future projects. Are there any plans to support resizing of the graph after it has been created? Currently resizing the text control resizes the background but does not scale the actual graph region. -Colt update- a project using xgraph to plot csv data from a file http://www.autohotkey.com/board/topic/145386-csv-data-visualizer-using-xgraphahk/?hl=%2Bxgraph Last edited by colt on 15 Jul 2015, 00:18, edited 1 time in total. Top architech1906 Re: XGraph v1.1.1.0 : Real time data plotting. Report this post Quote 26 Oct 2014, 23:06 Can this script allow multiple lines of real time data on the same graph. If so, how? I only see an implementation where one data group per plot. I'm still looking through your code but not sure how it would come together to generate multiple plots on a single graph. Thanks for any assistance you can provide. Top Scoox Posts: 74 Joined: 11 May 2014, 09:12 Location: China Re: XGraph v1.1.1.0 : Real time data plotting. Report this post Quote 13 Nov 2014, 00:34 Looks awesome, thanks for sharing! Top ThomasB Re: XGraph v1.1.1.0 : Real time data plotting. Report this post Quote 01 Dec 2014, 03:45 like ""architech1906"" I tried to use it with multiple graphs using the same axis, but for me it seems at the moment it is not possible. Any idea? Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 14 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 15 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by SKAN - Function library for graphically plotting real time data."	"true"
"System"	"RunAsTask"	"https://autohotkey.com/boards/viewtopic.php?t=4334"	"by SKAN - Auto-elevates script without UAC prompt."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"RunAsTask() - Auto-elevates script without UAC prompt - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:29 All times are UTC-05:00 RunAsTask() - Auto-elevates script without UAC prompt Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 64 posts 1 2 3 4 Next SKAN Posts: 204 Joined: 29 Sep 2013, 16:58 RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 21 Aug 2014, 18:01 Code: [Select all] [Expand] [Download] (RunAsTask.ahk)GeSHi © Codebox Plus /*  _      _    _               __ __      _      _                      _         _                        | |__  | |_ | |_  _ __  _   / // /__ _ | |__  | | __ ___   ___  _ __ (_) _ __  | |_     ___   _ __  __ _ | '_ \ | __|| __|| '_ \(_) / // // _` || '_ \ | |/ // __| / __|| '__|| || '_ \ | __|   / _ \ | '__|/ _` | | | | || |_ | |_ | |_) |_ / // /| (_| || | | ||   < \__ \| (__ | |   | || |_) || |_  _| (_) || |  | (_| | |_| |_| \__| \__|| .__/(_)_//_/  \__,_||_| |_||_|\_\|___/ \___||_|   |_|| .__/  \__|(_)\___/ |_|   \__, |                  |_|                                                    |_|                        |___/ RunAsTask() - Auto-elevates script without UAC prompt |  http://ahkscript.org/boards/viewtopic.php?t=4334        _________________________________________________________________________________________________________ */   RunAsTask() {                         ;  By SKAN,  http://goo.gl/yG6A1F,  CD:19/Aug/2014 | MD:22/Aug/2014     Local CmdLine, TaskName, TaskExists, XML, TaskSchd, TaskRoot, RunAsTask   Local TASK_CREATE := 0x2,  TASK_LOGON_INTERACTIVE_TOKEN := 3     Try TaskSchd  := ComObjCreate( ""Schedule.Service"" ),    TaskSchd.Connect()     , TaskRoot  := TaskSchd.GetFolder( ""\"" )   Catch       Return """", ErrorLevel := 1        CmdLine       := ( A_IsCompiled ? """" : """"""""  A_AhkPath """""""" )  A_Space  ( """""""" A_ScriptFullpath """"""""  )   TaskName      := ""[RunAsTask] "" A_ScriptName "" @"" SubStr( ""000000000""  DllCall( ""NTDLL\RtlComputeCrc32""                    , ""Int"",0, ""WStr"",CmdLine, ""UInt"",StrLen( CmdLine ) * 2, ""UInt"" ), -9 )     Try RunAsTask := TaskRoot.GetTask( TaskName )   TaskExists    := ! A_LastError       If ( not A_IsAdmin and TaskExists )      {       RunAsTask.Run( """" )     ExitApp     }     If ( not A_IsAdmin and not TaskExists )  {       Run *RunAs %CmdLine%, %A_ScriptDir%, UseErrorLevel     ExitApp     }     If ( A_IsAdmin and not TaskExists )      {        XML := ""     ( LTrim Join       <?xml version=""""1.0"""" ?><Task xmlns=""""http://schemas.microsoft.com/windows/2004/02/mit/task""""><Regi       strationInfo /><Triggers /><Principals><Principal id=""""Author""""><LogonType>InteractiveToken</LogonT       ype><RunLevel>HighestAvailable</RunLevel></Principal></Principals><Settings><MultipleInstancesPolic       y>Parallel</MultipleInstancesPolicy><DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries><       StopIfGoingOnBatteries>false</StopIfGoingOnBatteries><AllowHardTerminate>false</AllowHardTerminate>       <StartWhenAvailable>false</StartWhenAvailable><RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAva       ilable><IdleSettings><StopOnIdleEnd>true</StopOnIdleEnd><RestartOnIdle>false</RestartOnIdle></IdleS       ettings><AllowStartOnDemand>true</AllowStartOnDemand><Enabled>true</Enabled><Hidden>false</Hidden><       RunOnlyIfIdle>false</RunOnlyIfIdle><DisallowStartOnRemoteAppSession>false</DisallowStartOnRemoteApp       Session><UseUnifiedSchedulingEngine>false</UseUnifiedSchedulingEngine><WakeToRun>false</WakeToRun><       ExecutionTimeLimit>PT0S</ExecutionTimeLimit></Settings><Actions Context=""""Author""""><Exec>       <Command>""   (  A_IsCompiled ? A_ScriptFullpath : A_AhkPath )       ""</Command>       <Arguments>"" ( !A_IsCompiled ? """""""" A_ScriptFullpath  """""""" : """" )   ""</Arguments>       <WorkingDirectory>"" A_ScriptDir ""</WorkingDirectory></Exec></Actions></Task>     )""          TaskRoot.RegisterTask( TaskName, XML, TASK_CREATE, """", """", TASK_LOGON_INTERACTIVE_TOKEN )     }           Return TaskName, ErrorLevel := 0 } ; _____________________________________________________________________________________________________Usage example: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus #NoTrayIcon RunAsTask() ; self elevate Run RegEdit.exe RunAsTask() elevates the calling script by registering a scheduled task with highest privileges on the *first run of the script. For subsequent runs, it will start a parallel elevated instance via Task scheduler and original instance will exit. *UAC will prompt on the first run. RunAsTask() generates a unique Taskname , for a given script as in following pattern: ""[RunAsTask]"" . A_Space . A_ScriptName . A_Space . ""@"" . ( CRC32 hash of file paths, as decimal ) eg. [RunAsTask] My Admin Script.ahk @0123456789 For every change in A_ScriptFullpath ( compiled / uncompiled ) or A_AhkPath + A_ScriptFullpath ( uncompiled ), a new task will be registered. It is up to the user to clean and maintain the task scheduler. Here is a task scheduler export of XML which was registered by RunAsTask(). The items in red are not in script. Items in blue are variable. Task scheduler XML export <?xml version=""1.0"" encoding=""UTF-16""?> <Task version=""1.3"" xmlns=""http://schemas.microsoft.com/windows/2004/02/mit/task""> <RegistrationInfo /> <Triggers /> <Principals> <Principal id=""Author""> <UserId>SOME-PC\USERNAME</UserId> <LogonType>InteractiveToken</LogonType> <RunLevel>HighestAvailable</RunLevel> </Principal> </Principals> <Settings> <MultipleInstancesPolicy>Parallel</MultipleInstancesPolicy> <DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries> <StopIfGoingOnBatteries>false</StopIfGoingOnBatteries> <AllowHardTerminate>false</AllowHardTerminate> <StartWhenAvailable>false</StartWhenAvailable> <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable> <IdleSettings> <StopOnIdleEnd>true</StopOnIdleEnd> <RestartOnIdle>false</RestartOnIdle> </IdleSettings> <AllowStartOnDemand>true</AllowStartOnDemand> <Enabled>true</Enabled> <Hidden>false</Hidden> <RunOnlyIfIdle>false</RunOnlyIfIdle> <DisallowStartOnRemoteAppSession>false</DisallowStartOnRemoteAppSession> <UseUnifiedSchedulingEngine>false</UseUnifiedSchedulingEngine> <WakeToRun>false</WakeToRun> <ExecutionTimeLimit>PT0S</ExecutionTimeLimit> <Priority>7</Priority> </Settings> <Actions Context=""Author""> <Exec> <Command>D:\AimAndBoot\AimAndBoot.exe</Command> <Arguments>""D:\AimAndBoot\AimAndBoot.ahk""</Arguments> <WorkingDirectory>D:\AimAndBoot</WorkingDirectory> </Exec> </Actions> </Task> Edit1: 2014/Aug/22 13:25 UTC RunAsTask_CreateShortcut() RunAsTask_CreateShortcut() is a supplementary function for RunAsTask(). It will create a shortcut for the Taskname returned by RunAsTask() Shortcut target example: C:\Windows\system32\schtasks.exe /run /tn ""[RunAsTask] MyAdminScript.ahk @3264355656"" Code: [Select all] [Download] (RunAsTask_CreateShortcut.ahk)GeSHi © Codebox Plus RunAsTask_CreateShortcut( TaskName := """", Folder := """", ShcName := """" ) { ; by SKAN, http://goo.gl/yG6A1F   Local LINK, Description     IfEqual, TaskName,, Return   LINK := ( FileExist( Folder )  ? Folder : A_ScriptDir ) ""\"" ( ShcName ? ShcName : A_ScriptName ) "".lnk""   FileGetShortcut, %LINK%,,,, Description   If ( Description <> Taskname )     FileCreateShortcut, schtasks.exe, %LINK%, %A_WorkingDir%,/run /tn ""%TaskName%"", %TaskName%,,,, 7 }Usage example: Code: [Select all] [Download] (Test_CreateShortcut.ahk)GeSHi © Codebox Plus TaskName := RunAsTask() RunAsTask_CreateShortcut( TaskName ) ; Places a shortcut in Script folderParameter examples: Code: [Select all] [Download] GeSHi © Codebox Plus RunAsTask_CreateShortcut( TaskName, A_Desktop ) ; Shortcut on desktop RunAsTask_CreateShortcut( Taskname, A_Startup, ""My Admin Script"" ) ; Place in Startup. Force link name to avoid multiple startup entries. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 21 Aug 2014, 18:41 Ahhh you're using the ""Schtasks with elevate privileges"" trick thingy, I remember I used it once in a c# program I wrote, I was thinking of using for aspdm, but then I realized that ""dynamic"" arguments can not be given without creating the task anew (due to security concerns)... For me I think that's the only disadvantage, it can be worked around, but it would use a small ""dirty"" trick.. Anyway, Kudos for making a nice simple to use function! Another one for the book, SKAN! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Nextron Posts: 606 Joined: 01 Oct 2013, 08:23 Location: Netherlands OS: Win7 x64 AHK: Unicode x32 Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 21 Aug 2014, 18:50 Setting up my main script to run as admin using task scheduler is something I usually only do once per computer. Now I don't have to do it at all , although I added static autorun:=RunAsTask() to the function to make it auto-initialize. After that, you can use this similar script that does the opposite, to run process as unelevated user. Last edited by Nextron on 21 Aug 2014, 18:56, edited 2 times in total. The more I know: The more I know, I know nothing. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 21 Aug 2014, 18:51 Haha, nice! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top SKAN Posts: 204 Joined: 29 Sep 2013, 16:58 RunAsTask_CreateShortcut() Report this post Quote 22 Aug 2014, 09:32 Added function: RunAsTask_CreateShortcut() Top SKAN Posts: 204 Joined: 29 Sep 2013, 16:58 Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 22 Aug 2014, 09:33 Nextron wrote:run process as unelevated user.Why not use Run_() or ShellRun() available in Installer.ahk ? Everything search engine launches everything elevated ( except explorer ). I have set ShellRun.ahk in Options > General > Context Menu > Open (Files) > Command as $exec(""shellrun.ahk"" ""%1"") Code: [Select all] [Download] (ShellRun.ahk)GeSHi © Codebox Plus #NoTrayIcon Param = %1% ShellRun( Param ) Return   #Include C:\Program Files\AutoHotkey\Installer.ahk ; My A_Ahkpath is different Top Nextron Posts: 606 Joined: 01 Oct 2013, 08:23 Location: Netherlands OS: Win7 x64 AHK: Unicode x32 Re: RunAsTask_CreateShortcut() Report this post Quote 22 Aug 2014, 13:12 SKAN wrote:Added function: RunAsTask_CreateShortcut()That's freaky. I thought about a feature like this yesterday, but then I thought: ""Yeah, like I ever kill the AutoHotkey.exe process "" SKAN wrote:Why not use Run_() or ShellRun() available in Installer.ahk ?I've got three function in my main script, RunAsLimitedUser() (launch with restricted security token), shellrun() (launch from user shell object) and RunAsUser() (launch as scheduled task) (all from here). I mostly use RunAsLimitedUser() because it returns me a PID. I've encountered a couple situations where it doesn't work properly and I use shellrun(). I mentioned RunAsUser() for its similarity. The more I know: The more I know, I know nothing. Top arcticir Posts: 330 Joined: 17 Nov 2013, 11:32 Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 22 Aug 2014, 17:13 Get commandline Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus Process, Exist CmdLine:=winmgmts(""CommandLine"",""ProcessId"",ErrorLevel)   winmgmts(v,w:=""ProcessId"",n:=""CommandLine"",d:=""Win32_Process"",m:=""winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2""){ 	s:=[] 	for i in ComObjGet(m).ExecQuery(""Select * from "" d  (w ? "" Where "" w ""='"" n ""'"" :"""")) 		s.Insert(i[v]) 	return s.MaxIndex()?(s.MaxIndex()=1?s.1:s):"""" 	} Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 22 Aug 2014, 17:54 @arcticir nice share, but I don't think that's related, or is it? Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top arcticir Posts: 330 Joined: 17 Nov 2013, 11:32 Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 22 Aug 2014, 18:51 CmdLine More accurate Top SKAN Posts: 204 Joined: 29 Sep 2013, 16:58 Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 23 Aug 2014, 10:52 @arcticir: May I ask how winmgmts() is better than DllCall( ""GetCommandLine"",""Str"" ) ? you wrote:CmdLine More accurateI intentionally have it the way it is. If the script is Run from an another script with shortpath, then CRC32 hash will differ and RunAsTask() will register it as a new task. Also there is the Reload command ( also as tray menu item) which inserts a /restart in command line. joedf wrote:but it would use a small ""dirty"" trick..Can you explain?, please. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 23 Aug 2014, 12:13 Well, maybe there are other ways to do this, but the only thing that comes to mind right now, is to write a temporary file at a predefined location.. Say, a file like myprogram.arguments.txt in AppData and the task could launch ""thing.exe /taskmode"" or something close telling it to go read that file... It's not ultra dirty but a little bit Hey! Maybe this could be a feature... Haha Regards Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top SKAN Posts: 204 Joined: 29 Sep 2013, 16:58 LaunchAsAdmin Report this post Quote 23 Aug 2014, 17:16 joedf wrote:task could launch ""thing.exe /taskmode"" or something close telling it to go read that file I did not think of that. Nice, thanks Here is an another way where I rely on OnExit. The template also supports Reload, but is not being used. As for parsing CmdLine, I will post a function in a *separate topic. Edit: *Args() - Returns command line parameters as array Code: [Select all] [Expand] [Download] (LaunchAsAdmin.ahk)GeSHi © Codebox Plus ; Launch any app as Admin.  By SKAN,  http://goo.gl/yG6A1F ; Usage: Pass any app along with its parameters to this script.   #Warn #NoTrayIcon #SingleInstance, Ignore OnExit, OnExit   TaskName := """"                                    ; else #Warn complains. TaskName := RunAsTask()                           ; This function will never return on the first run   FileRead, CmdLine, %A_Temp%\%A_ScriptName%.tmp   If ( CmdLine = """" )                               ; Script/shortcut was launched with another admin app       CmdLine := DllCall( ""GetCommandLine"",""Str"" ) ; or with context menu item ""Run as Administrator"" !!!   Loop % ( A_IsCompiled ? 1 : 2 )      ; Excludes 'AutoHotkey exe' and 'Script path' from the command line   CmdLine := DllCall( ""shlwapi\PathGetArgs"", ""Str"",CmdLine, ""Str"" )   Run %CmdLine%,, UseErrorLevel   Return                                                                ; // end of auto-execute section //   OnExit:   OnExit   IfNotEqual, A_ExitReason, Reload, FileDelete, %A_Temp%\%A_ScriptName%.tmp   IfEqual, TaskName,, FileAppend, % DllCall( ""GetCommandLine"",""Str"" ), %A_Temp%\%A_ScriptName%.tmp, UTF-8   ExitApp Return Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 23 Aug 2014, 18:37 Oh! Nice, very interesting, I'll have to try it when I return from my trip, thanks for sharing. Edit: cool, Reading from argv pointer! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 18 Aug 2015, 15:23 Pure awesomeness. Why wasnt I aware of this before?? Has anyone tried it with Win10? GitHub page Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 29 Sep 2015, 05:13 I have successfully used this lib for scripts that run on various people's home PCs, but I now have a need to run this on a VM at work, and I cannot get it to function - it pops up the UAC dialog every time. Sure, we could turn UAC off, but the use case is automated tests, and turning off UAC is not desirable on these test VMs. Any ideas what may be stopping it from working? I have tried with just the regedit test script and no joy FYI, I am trying to use it to allow remove machines within the VM environment to read the event log of the Exchange server. GitHub page Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 02 Nov 2015, 11:24 I replaced run_as_admin in my project with RunAsTask, and now I am getting many, many reports of the application no longer starting. I have managed to replicate the issue on a VM - every EXE I compile with RunAsTask suffers from the same issues if run on a PC with UAC on: On double-clicking of the compiled EXE, nothing happens. The script does not run, no UAC prompt appears. The only way to get the script to run is to right-click the EXE and select ""Run as Administrator"". The UAC prompt then appears, and the application runs. Example script: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus #singleinstance force #include <RunAsTask> RunAsTask()   Gui, Add, Edit Gui Show, x0 y0   return   GuiClose: 	ExitApp   GitHub page Top Droyk Posts: 61 Joined: 24 Sep 2015, 06:29 Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 16 Dec 2015, 21:07 joedf wrote:Oh! Nice, very interesting, I'll have to try it when I return from my trip, thanks for sharing. Edit: cool, Reading from argv pointer! You are about too read some bad english. and i am really sorry about it i am not a native english speaker Hey joedf how are U ? hope you are fine i just started using Ahk. and i too don't like UAC prompts .until now i was using task scheduler to skip UAC prompts but now i think i could handle this problem with the help of ahk so can you plz tell me this script that SKAN created .its only able to skip uac only when i write application name on this script what i want is universal action i want to run this script and boom every application skips uac. so can you plz tell me how should i modify this script for my use & plz understand i am just foolish noob so plz bear with me some important facts i am running windows 10 and don't want to disable uac for some specific reasons when i run this script every program i click or opens indirectly will skip UAC. i do a lot of networking work safely without uac on windows 7 but rightnow i have to done some of my works on windows 10 so i want to make this script to easy my burden(UAC are time consuming ) thanxx plz relpy i came here with a lot of hope so plz dont break my hope Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 17 Dec 2015, 16:38 Well that would be a big security breach... You could have a ""central"" executable run all your other scripts since the rights will be inherited. Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Droyk Posts: 61 Joined: 24 Sep 2015, 06:29 Re: RunAsTask() - Auto-elevates script without UAC prompt Report this post Quote 17 Dec 2015, 18:13 joedf wrote:Well that would be a big security breach... You could have a ""central"" executable run all your other scripts since the rights will be inherited. I already know the consequences and so i already bought 24/7 backup station in the case my windows fuckup so plz Now i just want your help that's all i want Thanxx Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 64 posts 1 2 3 4 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 12 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by SKAN - Auto-elevates script without UAC prompt."	"true"
"Text manipulation"	"String Things"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=53"	"by tidbit - Stand-alone string manipulation functions."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"String Things - Stand-alone string manipulation functions - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:29 All times are UTC-05:00 String Things - Stand-alone string manipulation functions Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 26 posts 1 2 Next tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US String Things - Stand-alone string manipulation functions Report this post Quote 01 Oct 2013, 09:19 String Things v2.6 A collection of commonly needed functions for working with strings and arrays. There are better descriptions and an example for each function in the comments of the code. Download Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus No functions rely on eachother. You may simply copy/paste the ones you want or need. .-==================================================================-. |Function                                                            | |====================================================================| | st_count(string [, searchFor])                                     | | st_insert(insert, into [, pos])                                    | | st_delete(string [, start, length])                                | | st_overwrite(overwrite, into [, pos])                              | | st_format(string, param1, param2, param3, ...)                     | | st_word(string [, wordNu, Delim, temp])                            | | st_subString(string, searchFor [, direction, instance, searchFor2])| | st_jumble(Text[, Weight, Delim , Omit])                            | |                                                                    | | st_lineWrap(string [, column, indent])                             | | st_wordWrap(string [, column, indent])                             | | st_readLine(string, line [, delim, exclude])                       | | st_deleteLine(string, line [, delim, exclude])                     | | st_insertLine(insert, into, line [, delim, exclude])               | |                                                                    | | st_flip(string)                                                    | | st_setCase(string [, case])                                        | | st_contains(mixed [, lookFor*])                                    | | st_removeDuplicates(string [, delim])                              | | st_pad(string [, left, right, LCount, RCount])                     | |                                                                    | | st_group(string, size, separator [, perLine, startFromFront])      | | st_columnize(data [, delim, justify, pad, colsep])                 | | st_center(text [, fill, symFIll, delim, exclude])                  | | st_right(text [, fill, delim, exclude])                            | |----------------------------------------------------------------    | |array stuff:                                                        | |   st_split(string [, delim, exclude])                              | |   st_glue(array [, delim])                                         | |   st_printArr(array [, depth])                                     | |   st_countArr(array [, depth])                                     | |   st_randomArr(array [, min, max, timeout])                        | '-==================================================================-' Log: Spoiler 2.6 (Fri May 30, 2014) - Added st_concat() Thanks Verdlin! - st_printArr() alternative & fixes by AfterLemon & I. - I've been slacking, I haven't payed attention to what I changed/added/removed. Oops! 2.5 (Thu January 02, 2014) - Fixed a bug in st_jumble() 2.4 (Sat December 28, 2013) - Added st_center() - Added st_right() 2.3 (Fri December 27, 2013) - Added st_columnize() - Updated st_substring(). Thanks AfterLemon! 2.2 (Tue October 01, 2013) - Replaced st_leftOf() with st_subString(). - Replaced st_rightOf() with st_subString(). - Replaced st_between() with st_subString(). - AfterLemon Compressed st_subString() and made it unreadable.   2.1 (Thu September 12, 2013) - Fixed a bug in st_overwrite(). Thanks AfterLemon.   2.0 (Mon July 22, 2013) - Fixed a bug in st_insert(). Thanks AfterLemon. - Renamed the parameter ""string"" to ""mixed"" in st_contains().   1.9 (Fri July 05, 2013) - Bug fixed in st_between(). Thanks Bon.   1.8 (Mon June 17, 2013) - Added: st_jumble()   1.7 (Wed June 12, 2013) - Added: st_word() - Added: st_ leftOf() - Added: st_ rightOf() - Added: st_ between()   1.6 (Thu May 02, 2013) - Optimized st_wordWrap() and st_lineWrap()   1.5 (Mon March 25, 2013) - Added: st_group()   1.4 (Fri March 22, 2013) - Added: st_lineWrap() - Added: st_wordWrap() - Added: st_randomArr() - Added: st_pad()   1.3 (Wed March 20, 2013) - Added st_contains(). - Renamed st_removeBlanks to st_RemoveDuplicates() as it can contain anything you want, not just newlines. - Fixed a couple minor things in the comments.   1.2 (Tue March 19, 2013) - Added support for negative numbers in Insert, Overwrite, Delete, InsertLine, DeleteLine, ReadLine - Added st_countArr() - Fixed the examples using the wrong names.   1.1 (Tue March 05, 2013) - Made it into an stdlib, by request. 1.0 (Mon March 04, 2013) - initial release rawr. fear me. *poke* Is it December 21, 2012 yet? Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: String Things - Stand-alone string manipulation function Report this post Quote 27 Dec 2013, 15:29 added st_columnize(data [, delim, justify, pad, colsep]) Screenshot afterlemon updated st_substring() rawr. fear me. *poke* Is it December 21, 2012 yet? Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: String Things - Stand-alone string manipulation function Report this post Quote 28 Dec 2013, 11:43 2.4 added st_center() added st_right() They are simple justification functions, no fancy bells-and-whistles. rawr. fear me. *poke* Is it December 21, 2012 yet? Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: String Things - Stand-alone string manipulation function Report this post Quote 02 Jan 2014, 12:57 2.5 Nameless-exe fixed, shorted and optimized st_jumble()! Edit: I just undid his changes. they were flawed instead I fixed a minor bug with the weight grouping. rawr. fear me. *poke* Is it December 21, 2012 yet? Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: String Things - Stand-alone string manipulation function Report this post Quote 06 Mar 2014, 11:08 nice-o! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Verdlin Posts: 56 Joined: 04 Oct 2013, 08:55 GitHub: Aatoz Re: String Things - Stand-alone string manipulation function Report this post Quote 06 Mar 2014, 14:23 Pretty much my favorite and most-used library. Native DragDrop for Windows 8+ (8.1 10 | Drag & Drop) | AutoLeap - Control AutoHotKey with your Hands (Leap Motion) | EasyIni (ini native class object) Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: String Things - Stand-alone string manipulation function Report this post Quote 07 Mar 2014, 11:09 Thanks guys! rawr. fear me. *poke* Is it December 21, 2012 yet? Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: String Things - Stand-alone string manipulation function Report this post Quote 07 Mar 2014, 18:34 download link NOT working... Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: String Things - Stand-alone string manipulation function Report this post Quote 07 Mar 2014, 18:38 Guest10 wrote:download link NOT working... Right-click Link and Save as... ??? Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: String Things - Stand-alone string manipulation function Report this post Quote 08 Mar 2014, 10:34 Works for me. Even a normal click. Was probably just some downtime. rawr. fear me. *poke* Is it December 21, 2012 yet? Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: String Things - Stand-alone string manipulation function Report this post Quote 08 Mar 2014, 14:10 it always says, ""Problem loading page"" The connection has timed out The server at tidbit.3owl.com is taking too long to respond. The site could be temporarily unavailable or too busy. Try again in a few moments. If you are unable to load any pages, check your computer's network connection. If your computer or network is protected by a firewall or proxy, make sure that Firefox is permitted to access the Web. Top ozzii Posts: 224 Joined: 30 Oct 2013, 06:04 Re: String Things - Stand-alone string manipulation function Report this post Quote 10 Mar 2014, 08:13 Working for me right now : 14:13 CET Top Verdlin Posts: 56 Joined: 04 Oct 2013, 08:55 GitHub: Aatoz Re: String Things - Stand-alone string manipulation function Report this post Quote 27 May 2014, 19:37 I would find a st_Concat(delim, s*...) function quite useful. Native DragDrop for Windows 8+ (8.1 10 | Drag & Drop) | AutoLeap - Control AutoHotKey with your Hands (Leap Motion) | EasyIni (ini native class object) Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: String Things - Stand-alone string manipulation function Report this post Quote 27 May 2014, 20:04 Code: [Select all] [Download] (sprintf.ahk)GeSHi © Codebox Plus sprintf(msg, vargs*) {     for each, varg in vargs     StringReplace,msg,msg,`%s, % varg ;msg:=RegExReplace(msg,""i)`%."",varg)     return msg }   mystring := sprintf(""Hello %s!"",""joedf"")   ? Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: String Things - Stand-alone string manipulation function Report this post Quote 27 May 2014, 21:32 tried again to download. looks like i have to sign up. do i have to sign up to upload this script? Top Verdlin Posts: 56 Joined: 04 Oct 2013, 08:55 GitHub: Aatoz Re: String Things - Stand-alone string manipulation function Report this post Quote 28 May 2014, 04:42 Thanks, Joe. It's actually slightly different than that. Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus { 	Msgbox % st_Concat(""|"", 1, 2, 3, 4,5 ,6) 	return }   st_Concat(delim, as*) { 	for k, v in as 		s .= v . delim 	return s } Native DragDrop for Windows 8+ (8.1 10 | Drag & Drop) | AutoLeap - Control AutoHotKey with your Hands (Leap Motion) | EasyIni (ini native class object) Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: String Things - Stand-alone string manipulation function Report this post Quote 28 May 2014, 05:37 Ahh ok :O Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: String Things - Stand-alone string manipulation function Report this post Quote 28 May 2014, 09:32 joedf: sprintf already exists in ST st_format(). I think I went off the PHP name, can't remember. Verdlin: Will add that! There will be an update sooner or later. I've made some other minor changes aswell. rawr. fear me. *poke* Is it December 21, 2012 yet? Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: String Things - Stand-alone string manipulation function Report this post Quote 28 May 2014, 11:28 Verdlin wrote:Thanks, Joe. It's actually slightly different than that. Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus { 	Msgbox % st_Concat(""|"", 1, 2, 3, 4,5 ,6) 	return }   st_Concat(delim, as*) { 	for k, v in as 		s .= v . delim 	return s } using those braces for the auto-execute section is unnecessary Top AfterLemon Posts: 83 Joined: 30 Sep 2013, 14:27 Location: Arizona, USA Re: String Things - Stand-alone string manipulation function Report this post Quote 28 May 2014, 11:47 Verdlin wrote:I would find a st_Concat(delim, s*...) function quite useful. I'm not sure that's more than a few characters you might be saving. Obviously it could be done, but it's not even something that's easier done in a function than just with a single command. Data:=""a,b,c,d,e,f,g,h"",Data:=ST_Concat(""|"",Data*) vs Data:=""a,b,c,d,e,f,g,h"" StringReplace,Data,Data,`,,|,1 HOME: Windows 7 x64 SP1 Ultimate | AMD FX 8350 8-Core @ 4.00GHZ | 16GB Ram WORK: Windows 7 x64 SP1 Home Premium | AMD Athlon II X4 640 @ 3.00GHz | 8GB Ram MOBILE: Samsung Galaxy Note 3 | 2012 Asus Nexus 7 | Zune 80Gb Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 26 posts 1 2 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 12 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by tidbit - Stand-alone string manipulation functions."	"true"
"Text manipulation"	"TF"	"https://github.com/hi5/TF"	"by hi5 - Functions for manipulation of text files such as *.txt, *.ahk, *.html, *.css etc and Strings (or variables). Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"30"	"8"	"15"	"GitHub - hi5/TF: AutoHotkey library for Text files & Variables (strings) Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 8 Star 30 Fork 15 hi5/TF Code Issues 0 Pull requests 0 Pulse Graphs AutoHotkey library for Text files & Variables (strings) https://autohotkey.com/boards/viewtopic.php?f=6&t=576 6 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit c92ec91 Nov 29, 2015 href Fixed anchor in readme (InsertPrefix) Permalink Failed to load latest commit information. license.txt Adding license and cleanup code indentation tabs v spaces Feb 8, 2014 readme.md Fixed anchor in readme (InsertPrefix) Nov 29, 2015 tf.ahk Added additional minor error check in TF_GetData Dec 25, 2014 readme.md TF: Textfile & String Library for AutoHotkey [lib] - v3.6 A ""Swiss Army Knife"" library for Text (files) Introduction As the name suggest this is an AutoHotkey (AHK) Library with a number of functions to ""manipulate"" text, both files such as *.txt, *.ahk, *.html, *.css etc AND Strings (or variables). For example you can delete specific lines, replace words or specific lines, number lines, remove or insert columns of text, etc. See the list of functions below for a complete overview. It is not useful for binary files or data such as MS Office files, PDFs, EXEcutables, images etc. (Tip: search the AHK forum for ""binread"" to find some pointers on how to read, write and ""edit"" binary files.) Functions TF TF_Save TF_CountLines TF_Count *1 TF_ReadLines TF_Tail TF_Replace TF_ReplaceInLines TF_RegExReplace TF_RegExReplaceInLines TF_RemoveLines TF_RemoveBlankLines TF_RemoveDuplicateLines TF_InsertLine TF_ReplaceLine TF_InsertPrefix TF_InsertSuffix TF_TrimLeft TF_TrimRight TF_AlignLeft TF_AlignCenter TF_AlignRight TF_LineNumber TF_ConCat TF_ColGet TF_ColPut TF_ColCut TF_ReverseLines TF_Find (can be used as basic grep) TF_SplitFileByLines TF_SplitFileByText TF_Merge *2 TF_Prepend *2 TF_Append *2 TF_Wrap TF_WhiteSpace TF_Substract TF_RangeReplace TF_MakeFile TF_Tab2Spaces TF_Spaces2Tab TF_Sort TF_Join Notes TF_Count does not support files and only works with variables. TF_Merge, TF_Prepend, TF_Append currently do not support variables and only work with FILES. Concept It is important to understand a few basic concepts before you start working with the TF library: If you pass on a file to a TF function the output will generally be a file (there are a few exceptions). By default it writes the output to a COPY of the input file, leaving the original input file intact. You can overwrite the input file by using a ! as prefix. See ""Quick intro to Parameters"" and ""Textfile and the ! Prefix"" below for more details. If you pass on a variable to a TF function the returned output will also be a variable. Most TF Functions allow you to work on specific lines or sections of lines. TF ""knows"" if something is a file or a variable, even if the variable passed on to TF is meant to represent a file. (This is done in the helper function TF_GetData for those interested). To understand how to work with files and variables please read the ""Textfile and the ! Prefix"" and ""Files & Variables"" sections below. File encoding, codepage If you experience TF is changing the file encoding (codepage) try to set the correct file encoding at the top of your script (or at least before you call a TF function) using the following AutoHotkey command: http://ahkscript.org/docs/commands/FileEncoding.htm Please note, there is no way to determine the file encoding 100% accurately, even if a file contains BOM. See the discussion about this topic and possibly useful additional functions at the AutoHotkey forum http://www.autohotkey.com/board/topic/95986-filegetencoding-filegetformat/ (The result of these functions are simply a best guess assuming UTF-8 more common when BOM - https://en.wikipedia.org/wiki/Byte_Order_Mark - is missing). How to ""install"" / use You can either place TF.ahk in your LIB directory (see http://ahkscript.org/docs/Functions.htm#lib) or use #include (see http://ahkscript.org/docs/commands/_Include.htm) You can find examples of most functions in the ""example script"" here http://www.autohotkey.com/forum/viewtopic.php?p=280363#280363 Note: Because most of these functions operate on a line by line basis they WILL be slower compared to a function or script which could operate on an entire file or variable at once. Keep this in mind if you need to process many files/variables or very large files/variables in case speed is an issue. Quick intro to Parameters Almost all functions accept the following basic parameters: Parameter Meaning Text The Filename (may include (absolute) path) to read from and save to (for all functions that write an output file). Note: by default a filename_copy will be created, use the ! prefix if you want to OverWrite the TextFile (e.g. the source file) As of v3 ""Text"" can also be a variable or indeed text directly passed on to the function. See Textfile and the ! Prefix. ! Prefix If Text starts with ! (eg: ""!c:\sample.txt"") it will overwrite the text file, otherwise it will save the new file to a copy of the text file eg: Filename_copy.txt (All functions, apart from reading functions because there is no output file) Tip: you can use concatenation to add the !, e.g. ""!"" . Filename.txt, see the examples in the AHK thread. Note: If Text is a variable, it can start with a ! as TF will detect automatically that it is not a file and will therefore not create a file but return the altered variable instead. See Textfile and the ! Prefix. Lines Number of lines to read StartLine Start of Range (Almost all). See (StartLine, Endline) Syntax. EndLine End of Range (Almost all). See (StartLine, Endline) Syntax. SearchText Text to Find (Find / Replace functions) ReplaceText Text to Replace (Find / Replace functions) Notes Many functions also have specific parameters, see the description of each function below. Backup files: If a subdirectory ""backup"" is present in the directory of TextFile a backup is made before overwriting the original file (both for file.txt and file_copy.txt) with the BAK extension You can find examples of most functions in the ""example script"" here http://www.autohotkey.com/forum/viewtopic.php?p=280363#280363 (StartLine, Endline) Syntax You can pass on multiple lines (sections) by using the StartLine parameter. Examples: (5) ; start from line 5 to the end (StartLine) (5, 15) ; Section: lines 5 to 15 (StartLine, EndLine) (""5,13,45,67"", 135) ; Specific lines: 5,13,45,67, ignore 135 (""StartLine"", Endline - EndLine value is ignored) (""5-13,45-51"", 135) ; Multiple sections of lines: 5 to 13, 45 to 51 ignore 135 (""StartLine"", Endline - EndLine value is ignored) Incremental (EndLine will not be ignored) in the following cases: (""2+3"", 150) ; start with line 2, increment 3 up-to line 150 so 2,5,8,11,14 etc (""5+15"") ; start with line 5, increment 15 until end of file so 5,20,35 etc Negative Startline A Negative startline value makes a TF function operate on the last X lines. TF_ColGet and TF_ColPut accept negative StartColumn parameter. This can be used to ""Get"" or ""Put"" text in the x-th ""column"" from the right Textfile and the ! Prefix Valid examples for using a Textfile: TF_(""file.txt"", .... ; Process file.txt and write output to file_copy.txt  F=file.txt ; ; Note how F is a variable, but AHK/TF will see it is meant to represent file.txt and write output to file_copy.txt TF_(F, .... ; Process file.txt and write output to file_copy.txt TF_(""!file.txt"", .... ; Process file.txt and overwrite file.txt  F=file.txt TF_(""!"" . F, .... ; Process file.txt and overwrite file.txt  F=!file.txt TF_(F, .... ; Process file.txt and overwrite file.txt  In a Loop, FilePattern: TF_(A_LoopFileName, .... ; Process file and write output to file_copy TF_(""!"" . A_LoopFileName, .... ; Process file and overwrite file  Loop, *.txt     {      TF_(A_LoopFileName, .... ; Process file and write output to file_copy     } If you want to use multiple TF functions on a single file it is advised to use the ! Prefix F=!file.txt  TF_RemoveBlankLines(F)        ; remove all empty lines from file.txt and overwrite original file.txt TF_LineNumber(F)              ; add linenumbers to all lines and overwrite original file.txt TF_Replace(F, ""this"", ""that"") ; Replace the word ""this"" with ""that"" and overwrite original file.txt ; So the original file.txt has undergone three changes Files & Variables (v3+) You can use TF functions directly on files as well as variables. Below you will find some easy examples. Introduced in v3: TF() In order to save you the trouble of using a fileread to read a file into a variable and proceed to use various TF functions there is the TF() Function. TF(""pathtofile"", CreateGlobalVar=""T"") By default it reads the contents of the file in a global variable named t and returns it for further processing. By default it creates variable t if a variable name is omitted so if you do not like to use t you can use anything you like. It is NOT mandatory to use TF(), you are welcome to use a fileread as well, TF() is merely added for convenience as we will see in the examples below. TF() doesn't suddenly make the TF library ""not standard compliant"" as some seem to think as it only creates a global variable if you use the TF() function. Repeat: You only have to use TF() if you want to read a file into a variable and use it on multiple TF_* Functions but it is NOT required. TF() Examples: TF(""file.txt"") ; will create global var t TF(""file.txt"", ""MyVar"") ; will create global var MyVar Examples on how to use files & variables with TF: #Include tf.ahk TestFile= ; create variable (join`r`n 1 Hi this 2 a test variable 3 to demonstrate 4 how to  5 use this 6 new version 7 of TF.AHK ) FileDelete, TestFile.txt FileAppend, %TestFile%, TestFile.txt ; create file F=TestFile.txt ; just a shorthand code for TextFile.txt, so when ; we are using 'F' below we are still passing on a TextFile, not a variable!  ; pass on file, read lines 5 to end of file: MsgBox % ""From File 1:`n"" TF_ReadLines(""TestFile.txt"",5) MsgBox % ""From File 2:`n"" TF_ReadLines(F,5)              ; same  ; pass on variable, read lines 1 to 5 MsgBox % ""From Variable 1:`n"" TF_ReadLines(TestFile,""1-5"")   MsgBox % ""From Variable 2:`n"" TF_ReadLines(""Hi`nthis`nis`na`ntest`nvariable`nfor`ntesting"",1,3) ; pass on string  ; Examples using TF(): (it will save you a FileRead if you want to work with Variables)  TF(""TestFile.txt"") ; read file, create global var t t:=TF_ReadLines(t,5) ; pass on global var t created by TF(), read lines 5 to end of file, assign result to t  MsgBox % ""TF(), example 1:`n"" t  TF(""TestFile.txt"", ""MyVar"") ; read file, create global var MyVar MyVar:=TF_ReadLines(MyVar,5) ; pass on global var MyVar created by TF(), read lines 5 to end of file, assign result to MyVar MsgBox % ""TF(), example 2:`n"" MyVar  ; Note how we can use TF() here t:=TF_ReadLines(TF(""TestFile.txt""),5) ; pass on global var t created by TF(), read lines 5 to end of file, assign result to t  MsgBox % ""TF(), example 3:`n"" t  MyVar:=TF_ReadLines(TF(""TestFile.txt"",""MyVar""),5) ; pass on global var t created by TF(), read lines 5 to end of file, assign result to t  MsgBox % ""TF(), example 4:`n"" MyVar  t:=TF_ReadLines(TF(F),5) ; pass on global var t created by TF(), read lines 5 to end of file, assign result to t t:=TF_ReverseLines(t,5) ; pass on global var t created by TF(), reverse lines, assign result to t MsgBox % ""TF(), example 5:`n"" t  ; Work directly with the clipboard or another other variable Clipboard=Line 1`nLine 2`nLine 3`nLine 4`nLine 5`nLine 6`nLine 7`nLine 8 Clipboard:=TF_RemoveLines(Clipboard, 3, 6) ; remove lines 3 to 6 MsgBox % ""Clipboard, example 6:`n"" Clipboard Note TF_Merge, TF_Prepend, TF_Append currently do not support variables and only work with FILES. Common mistake(s): MyVar:=TF_ReadLines(""TestFile.txt"",5) ; this is wrong. It is AN INCORRECT EXAMPLE! The example above is incorrect: You pass on a file so the output is testfile_copy.txt. In this case nothing meaningful is assigned to the variable MyVar. Correct would be: MyVar:=TF_ReadLines(MyVar,5) ; this is OK MyVar:=TF_ReadLines(TF(""TestFile.txt"",""MyVar""),5) ; this is OK Functions and Examples Note: Some of these functions are very similar, but they are included in the library for ease of use ... You can find examples of most functions in the ""example script"" here http://www.autohotkey.com/forum/viewtopic.php?p=280363#280363 TF(TextFile, CreateGlobalVar=""T"") Purpose: Read contents of file to create global variable, T by default. Parameters: TextFile, CreateGlobalVar (=preferred name of global variable) Credits: See TF thread & discussion http://www.autohotkey.com/forum/viewtopic.php?p=313120#313120 Note: see background info and examples above at Files and Variables. TF_CountLines(Text) Purpose: Returns the number of lines in a file or variable Parameters: Text Credits: SKAN MsgBox % TF_CountLines(""File.txt"") ; show the number of lines of file in a MsgBox Lines:=TF_CountLines(""File.txt"") ; store the number of lines of file in a variable TF_Count(String, Char) Purpose: Count the number of occurrence of Char using StringReplace Parameters: String, Char Notes: do not use it to count lines (using `n) because it will return an incorrect value, use TF_CountLines for counting lines. TF_Count does not support files and only works with variables. MsgBox % TF_Count(""Hello this is an example"", ""i"") ; count how many i's there are in the string TF_ReadLines(Text, StartLine = 1, EndLine = 0, RemoveTrailing = 0) Purpose: Return the specified lines, can be used to read sections of a file or variable. Parameters: Text, StartLine, EndLine Note: by default it will add a newline character to the last line, so if you want to append new data you don't have to start it with a newline char. If you don't want that use RemoveTrailing = 1. MsgBox % TF_ReadLines(""File.txt"",5) ; Read lines 5 to end of file, show result in a MsgBox Lines:=TF_ReadLines(""File.txt"",5) ; Read lines 5 to end of file, store result in variable MsgBox % TF_ReadLines(""File.txt"",5,0,1) ; 0 for end line indicates until end of file, remove trailing empty line. TF_Tail(Text, Lines = 1, RemoveTrailing = 0, ReturnEmpty = 1) Purpose: Read last X lines from file or variable Parameters: Text, Lines, RemoveTrailing (0 or 1), ReturnEmpty (0 or 1) Credits: incl. ideas from Tuncay Notes: Lines can be a negative number: -1 will get the second to last line. If you use a negative number it will ALWAYS retrieve a SINGLE line By default TF_Tail will return empty lines, if you don't want that use ReturnEmpty = 0 By default TF_Tail will add a newline character to the last line, so if you want to append new data to the returned data you don't have to start it with a newline char. If you don't want that use RemoveTrailing = 1 MsgBox % TF_Tail(""File.txt"", 3) ; get the last three lines MsgBox % TF_Tail(""File.txt"", -2) ; get second to last line, negative values only return one line MsgBox % TF_Tail(""File.txt"", 5, 0, 0) ; return the last five lines, with trailing new line and excluding empty lines TF_Replace(Text, SearchText, Replacement="""") Purpose: Find and Replace text in entire file (using StringReplace) Parameters: Text, SearchText, Replacement TF_Replace(""File.txt"",""key"",""lock"")            ; pass on a file, replace the word ""key"" with ""lock"" in file_copy.txt TF_ReplaceInLines(Text, StartLine = 1, EndLine = 0, SearchText = """", ReplaceText = """") Purpose: Find and Replace text on specific lines (using StringReplace) Parameters: Text, StartLine, EndLine, SearchText, ReplaceText TF_ReplaceInLines(""!File.txt"",""1,3,9"","""",""key"",""lock"") ;  update source file, replace ""key"" with ""lock"" in lines 1, 3 and 9 TF_RegExReplace(Text, NeedleRegEx = """", Replacement = """") Purpose: Find and Replace text in entire file (using RegExReplace) Parameters: Text, NeedleRegEx, Replacement TF_RegExReplace(""File.txt"",""im)^(.*)$"",""[$1]"") ; pass on a file, wrap all lines in [] TF_RegExReplaceInLines(Text, StartLine = 1, EndLine = 0, NeedleRegEx= """", Replacement = """") Purpose: Find and Replace text in specific lines (using RegExReplace) Parameters: Text, StartLine, EndLine, NeedleRegEx, Replacement TF_RegExReplaceInLines(""File.txt"",3,8,"" [a-z]{3} "","" lock "")  ; replace any three letter word with ""lock"" in lines 3 to 8 TF_RemoveLines(Text, StartLine = 1, EndLine = 0) Purpose: Remove specified lines from file Parameters: Text, StartLine, EndLine TF_RemoveLines(""File.txt"", 5, 10) ; remove lines 5 to 10 from file Note: If you pass on a negative value for StartLine, example TF_RemoveLines(Text, -5, .... it will remove these lines from the end of Text, so -5 will remove the last five lines. The EndLine parameter is ignored. TF_RemoveBlankLines(Text, StartLine = 1, EndLine = 0) Purpose: Remove blank lines from file (in specified section) Parameters: Text, StartLine, EndLine Note: also removes lines with only tabs & spaces e.g. ""white space"" TF_RemoveBlankLines(""File.txt"") ; remove blanklines in entire file TF_RemoveDuplicateLines(Text, StartLine = 1, Endline = 0, Consecutive= 0, CaseSensitive = false) Purpose: Remove duplicate lines, optionally you can specify if they need to be Consecutive and / or Case sensitive Parameters: Text, StartLine, EndLine, Consecutive (0 or 1), CaseSensitive (true or false) TF_RemoveDuplicateLines(""File.txt"","""","""",1,false) ; remove only Consecutive duplicate lines TF_InsertLine(Text, StartLine = 1, Endline = 0, InsertText = """") Purpose: Insert text in specified lines Parameters: Text, StartLine, Endline, InsertText TF_InsertLine(""File.txt"",""2,4,9"",5,""---"")     ; insert --- in lines 2 4 and 9. 5 is endline will be ignored TF_ReplaceLine(Text, StartLine = 1, Endline = 0, ReplaceText = """") Purpose: Replace specified lines with new text Parameters: Text, StartLine, Endline, ReplaceText TF_ReplaceLine(""File.txt"",""1+3"",8,""---"")      ; replace lines 1 4 and 7. 8 is end line so no more lines are processed after TF_InsertPrefix(Text, StartLine = 1, EndLine = 0, Text = """") Purpose: Insert a text at the BEGINNING of each of the specified lines Parameters: Text, StartLine, Endline, Text TF_InsertPrefix(""File.txt"",5,8, ""Hello "")          ; Prefix Hello in lines 5 to 8 TF_InsertSuffix(Text, StartLine = 1, EndLine = 0 , Text = """") Purpose: Append a text at the END of each of the specified lines Parameters: Text, StartLine, Endline, Text TF_InsertSuffix(""File.txt"",""2-4,6-9"","""", "" Hello"")  ; Suffix Hello in lines 2 to 4 and 6 to 9 TF_TrimLeft(Text, StartLine = 1, EndLine = 0, Count = 1) Purpose: Trim number of specified columns from specified lines Parameters: Text, StartLine, Endline, Text, Count TF_TrimLeft(""File.txt"","""","""",25)                    ; Trim Left 25 Characters of all lines TF_TrimRight(Text, StartLine = 1, EndLine = 0, Count = 1) Purpose: Trim number of specified columns from specified lines Parameters: Text, StartLine, Endline, Text, Count TF_TrimRight(""File.txt"",""4,6,8"","""",45)              ; Trim Right 45 Characters in lines 4, 6 and 8 TF_AlignLeft(Text, StartLine = 1, EndLine = 0, Columns = 80, Padding = 0) Purpose: Align lines according to number of specified columns Parameters: Text, StartLine, Endline, Columns, Padding incl. ideas from SKAN Note: Using the Align functions will not take into account any leading or trailing spaces a line had BEFORE processing. So all white space before and after the text is removed before the text is aligned. Padding = 0 Remove trailing white space Padding = 1 Keep trailing white space  TF_AlignLeft(""File.txt"","""","""",90, 1)    ; AlignLeft all lines, keep trailing white space TF_AlignCenter(Text, StartLine = 1, EndLine = 0, Columns = 80, Padding = 0) Purpose: Align lines according to number of specified columns Parameters: Text, Columns, StartLine, Endline, Text uses some of SKAN functions Note: Using the Align functions will not take into account any leading or trailing spaces a line had BEFORE processing. So all white space before and after the text is removed before the text is aligned. Skip = 0 process empty lines, fill with spaces Skip = 1 skip empty lines, do not fill with spaces  TF_AlignCenter(""File.txt"","""","""",150, 1) ; AlignCenter, all lines skip empty lines, do not fill with spaces TF_AlignRight(Text, StartLine = 1, EndLine = 0, Columns = 80, Skip = 0) Purpose: Align lines according to number of specified columns Parameters: Text, Columns, StartLine, Endline, Skip (0 or 1) uses some of SKAN functions Note: Using the Align functions will not take into account any leading or trailing spaces a line had BEFORE processing. So all white space before and after the text is removed before the text is aligned. Skip = 0 process empty lines, fill with spaces Skip = 1 skip empty lines, do not fill with spaces  TF_AlignRight(""File.txt"","""","""", 190, 0) ; AlignRight, all lines, do not skip empty lines fill them with spaces TF_LineNumber(Text, Leading = 0, Restart = 0, Char = 0) Purpose: Insert line numbers before each line Parameters: Text, Leading, Restart, Char Credits: incl. ideas from ribbet.1 Leading = 0 No padding with leading zeros Leading >= 1 Include padding with leading zeros (001 v 1) Restart = restart counter after X lines (starting again at 1) Char = character to use for leading/padding. Default 0, but can be any character. Tip: use a space.  TF_LineNumber(""File.txt"",1,15,A_Space)  ; Add linenumbers, padding with spaces, linenumbers are aligned right because of space TF_ConCat(FirstTextFile, SecondTextFile, OutputFile, Blanks = 0, FirstPadMargin = 0, SecondPadMargin = 0) Purpose: Join Text files side by side (line1-from-file1 line1-from-file2 newline line2-from-file1 line2-from-file2 newline etc) Parameters: FirstTextFile, SecondTextFile, OutputFile, Blanks, FirstPadMargin, SecondPadMargin Based on: CONCATenate text files, ftp://garbo.uwasa.fi/pc/ts/tsfltc22.zip With TF_ConCat you can join Text files side by side. Blanks is number of blanks between lines. You can pad blanks the right margin of either of the text files, for this use FirstPadMargin and SecondPadMargin. TF_ColGet(Text, StartLine = 1, EndLine = 0, StartColumn = 1, EndColumn = 1, Skip = 0) Purpose: Get specified columns from text file Parameters: Text, StartLine, EndLine, StartColumn, EndColumn, Skip (0 or 1) Note: A TAB character is 1 character so for files with TABS the column might not be where you expect it to be skip = 0, DO NOT skip lines shorter then startcolumn position skip = 1, skip lines shorter then startcolumn position TF_ColGet and TF_ColPut accept negative StartColumn parameter. This can be used to ""Get"" or ""Put"" text in the x-th ""column"" from the right  TF_ColGet(""File.txt"","""","""",2,13)    ; get columns 2 to 13 from all lines, so it removes all other columns from the file or variable TF_ColPut(Text, Startline = 1, EndLine = 0, StartColumn = 1, Text = """", Skip = 0) Purpose: Insert text at specified columns in text file Parameters: Text, StartLine, EndLine, StartColumn, EndColumn, Skip (0 or 1) Based on: COLPUT.EXE & CUT.EXE, ftp://garbo.uwasa.fi/pc/ts/tsfltc22.zip Note: A TAB character is 1 character so for files with TABS the column might not be where you expect it to be skip = 0, DO NOT skip lines shorter then startcolumn position skip = 1, skip lines shorter then startcolumn position TF_ColGet and TF_ColPut accept negative StartColumn parameter. This can be used to ""Get"" or ""Put"" text in the x-th ""column"" from the right  TF_ColPut(""File.txt"","""","""",5, ""|"", 0) ; insert | in column 5 of all lines including empty lines (= | will be at column 1) TF_ColCut(Text, StartLine = 1, EndLine = 0, StartColumn = 1, EndColumn = 1) Purpose: Remove specified columns from text file Parameters: Text, StartLine, EndLine, StartColumn, EndColumn Based on: COLPUT.EXE & CUT.EXE, ftp://garbo.uwasa.fi/pc/ts/tsfltc22.zip TF_ColCut(""File.txt"", ""2+2"", """", 4, 38)  ; remove columns 4 to 38 in lines 2 4 6 8 etc TF_ReverseLines(Text, StartLine = 1, EndLine = 0) Purpose: Reverse the order of specified lines Parameters: Text, StartLine, EndLine Note: Startline parameter can not use specific lines, sections or incremental values here TF_ReverseLines(""File.txt"",2,9) ; reverse lines 2 to 9 TF_Find(Text, StartLine = 1, EndLine = 0, SearchText = """", ReturnFirst = 1, ReturnText = 0) Purpose: Find text using RegExMatch, return line(s), text or lines and text Parameters: Text, StartLine, EndLine, SearchText, ReturnFirst, ReturnText TF_Find(Lines) uses Regular Expressions - This means that if you use certain characters which have a special meaning in a RegEx: *\.\?+[{|()^\$** they must be preceded by a backslash to be seen as literal. For example, \. is a literal period and \\ is a literal backslash. Escaping can be avoided by using \Q...\E. For example: \QLiteral Text\E. See http://ahkscript.org/docs/commands/RegExMatch.htm for further information. ReturnFirst = 0 return multiple lines  ReturnFirst = 1 return first line only  ReturnText = 0 return line numbers only ReturnText = 1 return entire line (text). This simulates a basic grep feature ReturnText = 2 return line numbers + entire line (text). This simulates a basic grep feature   MsgBox % TF_Find(""File.txt"", """", """", ""keys"") ; return first line number with keys in it MsgBox % TF_Find(""File.txt"", """", """", "" c[a-z]+s "", 0, 1) ; find all lines with words that start with a c an end with an s TF_SplitFileByLines(Text, SplitAt, Prefix = ""file"", Extension = ""txt"", InFile = 1) Purpose: Split a text file in to several others based on number of lines Parameters: Text, SplitAt (number), Prefix, Extension, InFile (0, 1 or 2) SplitAt = Number of lines (three methods, see below) Prefix . Extension = filenameAUTOINCREMENT.Extension (Example: part_ . txt) InFile = 0 skip line e.g. do not include the actual line in any of the output files InFile = 1 include line IN current file InFile = 2 include line IN next file  Note: If you pass on a variable to TF_SplitFileByLines, the array size will be returned as Prefix0 and the array elements as Prefix1, Prefix2 etc similar to the AHK StringSplit command. The Extension parameter is ignored when using variables. Some characters are illegal such as - + @ % & * _ \ / [ ] etc to use in Prefix, stick to a-z A-Z. Options for ""SplitAt"" parameter: a) One numerical value, example TF_SplitFileByLines(Text, ""25"", ....     will split text every 25 lines until the end  b) Split at rotating line lengths using a dash ""-"" as separator, example TF_SplitFileByLines(Text, ""5-10-15"", ....     will split text at 5 10 15 lines, until the end so 5 lines, 10 lines, 15 lines, 5 lines, 10 lines etc c) Split at specific lines using a comma "","" as separator, example TF_SplitFileByLines(Text, ""5,81,135"", ....     will split text at lines 5,81,135 until end of file (e.g. last file will be from line 135 until the end)  TF_SplitFileByLines(""File.txt"", 2, ""part"", ""zec"", 1) ; split source file every 2 lines, include 2nd line INFILE ; illustrate use of variables and returned arrays: TF_SplitFileByLines(Variable, 2, ""part"", ""zec"", 1) MsgBox % ""Array size: "" . Part0 . ""`n1st array element: ""  Part1 TF_SplitFileByText(Text, SplitAt, Prefix = ""file"", Extension = ""txt"", InFile = 1) Purpose: Split a text file in to several others based on text Parameters: Text, SplitAt (text, can be RegEx), Prefix, Extension, InFile (0, 1 or 2) SplitAt = Text, can be RegEx Prefix . Extension = filenameAUTOINCREMENT.Extension (Example: part_ . txt) InFile = 0 skip line e.g. do not include the actual line in any of the output files InFile = 1 include line IN current file InFile = 2 include line IN next file  Note: If you pass on a variable to TF_SplitFileByLines, the array size will be returned as Prefix0 and the array elements as Prefix1, Prefix2 etc similar to the AHK StringSplit command. The Extension parameter is ignored when using variables. Some characters are illegal such as - + @ % & * _ \ / [ ] etc to use in Prefix, stick to a-z A-Z. TF_SplitFileByText(""File.txt"", ""button"", ""part"", ""zec"", 1)   ; split source file on every line with the word button, include that line INFILE ; illustrate use of variables and returned arrays: TF_SplitFileByText(Variable, ""keyboard"", ""part"", ""zec"", 1) MsgBox % ""Array size: "" . Part0 . ""`n1st array element: ""  Part1 TF_Merge(FileList, Separator = ""`n"", FileName = ""merged.txt"") Purpose: Merge several files into one Parameters: FileList, Separator (what to put between two files, newline by default), FileName (name of output file, Prefix with a ! to overwrite target file) Example FileList: FileList= ( file1.txt file2.txt file3.txt )  Note: TF_Merge, TF_Prepend, TF_Append currently do not support variables and only work with FILES. ; using Loop (files & folders) to create one quickly if you want to merge all TXT files for example: Loop, c:\*.txt   FileList .= A_LoopFileFullPath ""`n"" TF_Merge(FileList) ; will create merged.txt, you can use ! to overwrite an existing file if you want  ; using FileSelectFile to select files to merged: (Thanks for asking Vitor, http://www.autohotkey.com/forum/viewtopic.php?p=335329#335329) FileDelete merged.txt ; not required FileList= FileSelectFile, FileList, M 1,,, *.txt ; M allows you to select multiple files while holding down the left ctrl button If (ErrorLevel = 1) or (FileList = """")    ExitApp ; no files selected Path:=TF_ReadLines(FileList,1,1,1) ; the first line holds the directory of the selected files, so read path FileList:=TF_RemoveLines(FileList,1,1) ; remove path from filelist FileList:=TF_InsertPrefix(FileList, """", """", Path . ""\"") ; make sure all files have full paths to file so the are read correctly TF_Merge(FileList) ; will create a file in the current script dir called merged.txt you can also specify another filename, take into account the filedelete merged.txt above  ; You could skip the Path:= step above by calling TF_ReadLines directly in TF_InsertPrefix, but you would have to delete the first line AFTER it like so: ;FileList:=TF_InsertPrefix(FileList, """", """", TF_ReadLines(FileList,1,1,1) . ""\"") ;FileList:=TF_RemoveLines(FileList,1,1) TF_Prepend(File1, File2) Purpose: Prepend file1 to file2 (file2 is changed, uses TF_Merge) Parameters: File1, File2 Note: TF_Merge, TF_Prepend, TF_Append currently do not support variables and only work with FILES. TF_Append(File1, File2) Purpose: Append file1 to file2 (file2 is changed, uses TF_Merge) Parameters: File1, File2 Note: TF_Merge, TF_Prepend, TF_Append currently do not support variables and only work with FILES. TF_Wrap(Text, Columns = 80, AllowBreak = 0, StartLine = 1, EndLine = 0) Purpose: Wrap (specified) lines Parameters: Text, Columns, AllowBreak (0 or 1), StartLine, EndLine AllowBreak = 0 will not ""break"" words, so it will take into account whole words and not chop them off.  AllowBreak = 1 will break words  TF_Wrap(""File.txt"",60)            ; wrap at col 60 TF_WhiteSpace(Text, RemoveLeading = 1, RemoveTrailing = 1, StartLine = 1, EndLine = 0) Purpose: Remove leading and/or trailing whitespace Parameters: Text, RemoveLeading (0 or 1), RemoveTrailing (0 or 1), StartLine, EndLine RemoveLeading = 0  Do not remove leading white space of lines RemoveLeading = 1  Remove leading white space of lines RemoveTrailing = 0 Do not remove trailing white space of lines RemoveTrailing = 1 Remove trailing white space of lines         TF_WhiteSpace(""File.txt"", 1, 0, ""5-10"") ; remove leading and keep trailing whitespace in lines 5 to 10 TF_Substract(File1, File2, PartialMatch = 0) Purpose: Delete lines from file1 in file2 (using StringReplace) Parameters: File1, File2, PartialMatch (0 or 1) File2: you can use !file2 to overwrite file2 otherwise output is file2_copy.txt PartialMatch = 0 lines from file1 must appear as is, case insensitive  PartialMatch = 1 allow for paRTIal match of line PartialMatch = 2 allow for paRTIal match of line, but remove entire line (uses RegEx, new as of v3.4)  TF_RangeReplace(Text, SearchTextBegin, SearchTextEnd, ReplaceText = """", CaseSensitive = ""False"", KeepBegin = 0, KeepEnd = 0) Purpose: A Range Replacement allows you to perform a replacement on text whose beginning and ending remains the same, but whose middle contents might change. Parameters: SearchTextBegin, SearchTextEnd, ReplaceText, CaseSensitive (True or False), KeepBegin (0 or 1), KeepEnd (0 or 1) Note: Similar to ""BK Replace EM"" Range Replacement. It is basically an easier shortcut for a more complex RegExp. KeepBegin = 0 Remove SearchTextBegin from file KeepBegin = 1 Do not remove SearchTextBegin from file (saves you the trouble of putting it back in via ReplaceText) KeepEnd = 0 Remove SearchTextEnd from file KeepEnd = 1 Do not remove SearchTextEnd from file (saves you the trouble of putting it back in via ReplaceText)  SearchTextBegin = """" e.g. empty means from START of File *1 SearchTextEnd = """" e.g. empty means until END of File *1  *1 if you pass on empty strings to SearchTextBegin and SearchTextEnd the entire file will replaced with the replacement text. SearchTextBegin/End can be on the same line. Remember this LIB mainly operates on a line by line basis. This Function only operates on the FIRST SearchTextBegin to the FIRST SearchTextEnd it finds. Range=[insert this`ntext for the`nrange replace Text`ntest function] TF_RangeReplace(""File.txt"", ""Create hotkeys for keyboard"", ""into an EXE file"", Range) TF_MakeFile(Text, Lines = 1, Columns = 1, Fill = "" "") Purpose: Create file of X lines and Y columns, fill with space or other character(s) Parameters: TextFile (new file to be created), Lines, Columns, Fill Sometimes you need an ""empty"" file before you can start adding line numbers or putting data into a file. TF_Tab2Spaces(Text, TabStop = 4, StartLine = 1, EndLine = 0) Purpose: Convert tabs to spaces, shorthand for TF_ReplaceInLines Parameters: Text, TabStop, StartLine, EndLine Credits: incl. ideas from infogulch TabStop = number of spaces to replace a TAB with, so 4 means a TAB will be replaced by 4 spaces  TF_Spaces2Tab(Text, TabStop = 4, StartLine = 1, EndLine = 0) Purpose: Convert tabs to spaces, shorthand for TF_ReplaceInLines Parameters: Text, TabStop, StartLine, EndLine Credits: incl. ideas from infogulch TabStop = number of spaces to replace with a TAB, so 4 means 4 spaces will be replaced by a TAB  TF_Sort(Text, SortOptions = """", StartLine = 1, EndLine = 0) Purpose: Sort (section of) TextFile Parameters: Text, SortOptions, StartLine, EndLine SortOptions: use the SORT options http://ahkscript.org/docs/commands/Sort.htm  Note: StartLine can not have multiple sections, increments or multiple lines in this case. When dealing with variables/strings instead of text files the native AHK Sort command is of course more useful. TF_Join(Text, StartLine = 1, EndLine = 0, SmartJoin = 0, Char = 0) Purpose: Join lines (section of) Parameters: Text, StartLine, EndLine, SmartJoin, Char SmartJoin: Detect if CHAR(s) is/are already present at the end of the line before joining the next, this to prevent unnecessary double spaces for example. Char: character(s) to use between new lines, defaults to a space. To use nothing use """"  Note: StartLine can not use increments. It can have multiple sections. TF_Save(Text, FileName, OverWrite = 1) Purpose: To save a variable to a file Parameters: Text, FileName, OverWrite (O or 1) OverWrite = 0 create filename_copy.ext if filename.ext exists OverWrite = 1 will overwrite filename.ext if filename.ext exists (default)  History History v3.6, 25 December 2014 Added: Added additional minor error check in TF_GetData - if ""Text"" is ""false"", there is nothing to process so Exit History v3.5, 2 August 2014 Changed A_ScriptDir to A_WorkingDir in TF_ReturnOutPut - https://github.com/hi5/TF/issues/1 Fixed: TF_ColGet negative startcolumn and sections now work correctly History v3.4, 30 October 2010 - UNRELEASED at the time New function: TF_Join: joining lines. Added: A_ThisFunc to helper function TF_MatchList, this may help with error messages such as: Invalid StartLine parameter (non numerical character) - Function used: A_ThisFunc Added/Change: New option for StartLine, Negative startline operate on last X lines was already the case for TF_removelines, applies to all TF functions Added: TF_Substract: Partialmatch = 2 now deletes entire line on partial match, see TF DOC for more info. Added: TF_ColGet and TF_ColPut now accept negative StartColumn parameter. Can be used to Get or Put text in the xth ""column"" from the right, see description above - TF_ColCut does not support this as you can use TF_TrimRight. Added: TF_ColGet, TF_ColPut and TF_ColCut can now process multiple columns in one go. Format: CSV or incremental (DO not use sections for TF_ColPut due to unexpected end results) Minor improvements to the documentation removed TF_FindLines from lib (was already deprecated) History v3.3, 16 April 2010 Fixed: If you used variables with any of the replacement functions or tried to remove empty lines from a VARIABLE in the following format: variable:=TF_..(variable,""search"",""replace"") and the searchtext was NOT present in the variable it returned an empty variable (e.g. deleted the contents of ""variable""). It affected TF_ReplaceInLines, TF_Replace, TF_RegExReplaceInLines, TF_RegExReplace, TF_RemoveBlankLines, TF_RangeReplace. The built-in check only worked correctly for FILES and with the introduction of variables in TF 3 this didn't surface during testing. Fixed: documentation error for TF_Merge (separator and filename where swapped) and added examples on how to use TF_Merge in a Loop and with FileSelectFile History v3.2, 20 February 2010 Fixed: TF_AlignRight: due to a bug it didn't work as it should have, it prepended the number of spaces rather than aligning the text at the specified width. Changed: TF_GetData (helper function) should now avoid unnecessary IfNotExist for files, for scripts with many loops in combination with variables it should improve the speed slightly Changed: TF_SplitFileByLines: New options for SplitAt, now three methods available, see notes at function description Changed: TF_RemoveLines: New option for StartLine, if negative value is used it will remove the last X lines from file, see notes at function description History v3.1, 09 December 2009 Changed: Rewrite of TF_Find. Can now return multiple lines (like TF_Findlines used to), not only linenumbers but the entire line (text) of found lines so it can be used as a basic grep. Now uses RegExp, see compatibility notes. Deprecated: TF_FindLines (see change TF_Find). Kept in for backwards compatibility Updated and expanded documentation with examples and a hopefully ""better"" introduction highlighting some basic concepts History v3.0, 27 November 2009 Complete overhaul of library, now accepts files & variables for input and output: Changed: New parameter for TF_Readlines & TF_Tail: trailing new line now optional Added: TF_Save, shorthand for filedelete+fileappend Added: TF_GetData, helper function to determine if a file or a variable is passed on to function Added: TF() To read a text file in global var, t by default - Credits various ... Added: TF_ReturnOutput has replaced: Overwrite, MakeCopy and the newly developed ReturnStr Changed: Complete rewrite of TF_Tail, new options - borrowed bits from Tuncay (Thanks!) Changed: MakeMatchList: Removed TF_Countlines (one less fileread), Pass on ""String"" and not a TextFile Fix: TF_ConCat & TF_MakeFile didn't write output file - same bug as splitby* earlier. History v2.5 fix, 01 November 2009 Unreleased, but available on request :-) Note that in 2.4a TF_MakeFile and TF_ConCat do not produce output files, easy to fix if you are determined to use an older version of TF. History v2.4a fix, 10 August 2009: The fix for TF_SplitFileBy* functions of 2.3b wasn't complete, now it should work correctly (it didn't write the last file) History v2.4 update, 06 August 2009: Added: TF_Sort History v2.3b update, 03 August 2009: Fixed: No output problem for TF_SplitFileBy* functions, ""bug"" introduced by 2.3a ""Built in Check if TextFile actually exists"" TF_RemoveBlankLines check if file has empty empty lines to start with, if not return and do nothing (does not create file_copy identical to file) TF_RangeReplace same fix as 2.3a History v2.3a update/bugfix (29 July 2009, HugoV, ribbet.1, Murp|e) Fixed/Changed: New features in TF_LineNumber: Restart + Choice of leading/padding character. Thanks for the idea ribbet.1, http://www.autohotkey.com/forum/viewtopic.php?p=284687#284687 Built in Check if TextFile actually exists, to prevent creation of empty file(s). Thanks for the idea Murp|e, http://www.autohotkey.com/forum/viewtopic.php?p=284649#284649 TF_Replace: if SearchText wasn't present in TextFile the function never returned (stuck in endless loop) TF_ReplaceInLines: if SearchText wasn't present in TextFile simple return an do nothing (faster, does not create file_copy) TF_RegExReplaceInLines: if NeedleRegEx wasn't present in TextFile simple return an do nothing (faster, does not create file_copy) History v2.3 (28 July 2009) Added: TF_Tab2Spaces - Note: Thanks to infogulch Added: TF_Spaces2Tab - ditto Added: TF_RangeReplace Added: TF_MakeFile Also thanks to Murp|e for pointing out some errors in the documentation (TF_COL* functions). History v2.2 (10 July 2009) Added: TF_Substract Added: TF_WhiteSpace Added: TF_Wrap History v2.1 Added: TF_Prepend Added: TF_Append History v2.0 (Overhaul by HugoV using TXT lib as starting point) Renamed: TF_TotalLines to TF_CountLines (seemed more logical) Removed: TF_GetCSV, TF_SetCSV to keep the focus on TXT files, CSV requires a different library IMHO (HugoV) Introduced: MakeMatchList and adjusted TF_ReadLines, TF_RemoveLines, TF_InsertPrefix, TF_InsertSuffix, TF_TrimLeft, TF_TrimRight, TF_ColGet, TF_ColPut, TF_ColCut accordingly (HugoV) Make a MatchList which is used in various functions (listed above) Using a MatchList gives greater flexibility so you can process multiple sections of lines in one go avoiding repetitive fileread/append actions You can pass on multiple lines (sections) If you quote the StartLine parameter. Examples of StartLine, Endline: 5 ; start from line 5 to the end (StartLine) 5, 15 ; lines 5 to 15 (StartLine, EndLine) ""5,13,45,67"", 135) ; lines 5,13,45,67, ignore 135 (""StartLine"", Endline - EndLine value is ignored) ""5-13,45-51"", 135) ; lines 5 to 13, 45 to 51 ignore 135 (""StartLine"", Endline - EndLine value is ignored) Incremental processing of lines, example startline, endline - endline will not be ignored ""2+3"", 150 ; start with line 2, increment 3 up-to line 150 so 2,5,8,11,14 etc ""5+15"" ; start with line 5, increment 15 until end of file so 5,20,35 etc Introduced: OverWrite & MakeCopy (Heresy / HugoV) No longer necessary to pass on full path, e.g. ""file.txt"" works OK now (HugoV) Reduces size of library by removing repeating code sections for saving Output (Heresy) Backup files: If a subdirectory ""backup"" is present in the directory of TextFile a backup is made before overwriting the original file (both for file.txt and file_copy.txt) with the BAK extension (HugoV) Includes fix to remove trailing `n added by most functions (HugoV) Introduced: SetWidth/space by SKAN for TF_Align* Functions http://www.autohotkey.com/forum/viewtopic.php?p=45880#45880 Added: TF_ReplaceInLines. Similar to TF_Replace Added: TF_RegExReplaceInLines. Similar to TF_RegExReplace Added: TF_SplitFileByLines (HugoV) Added: TF_SplitFileByText (HugoV) Added: TF_Merge (HugoV) Added: TF_Find (HugoV, based on example by olegbl) Added: TF_FindLines (HugoV, based on example by olegbl) Change: TF_TrimLeft. 1 - it now processes all lines of the TextFile. 2 - you can now omit EndLine e.g. will process until end of file (HugoV) Change: TF_TrimRight. 1 - it now processes all lines of the TextFile. 2 - you can now omit EndLine e.g. will process until end of file (HugoV) Change: TF_AlignCenter, TF_AlignLeft, TF_AlignRight. Now use SetWidth/space by SKAN, more reliable also adds spaces to RIGHT side of line Change: TF_AlignLeft. 1 - you can now use StartLine, EndLine parameters. 2 - StartLine and/or EndLine can be omitted (HugoV) Change: TF_AlignRight. 1 - you can now use StartLine, EndLine parameters. 2 - StartLine and/or EndLine can be omitted (HugoV) Change: TF_ReadLines you can now omit EndLine e.g. will read until end of file (HugoV) Change: TF_RemoveBlankLines you can now use StartLine, EndLine parameters. EndLine can be omitted (HugoV) Change: TF_InsertLine modified to accommodate line sections and incremental lines. Change: TF_ReplaceLine modified to accommodate line sections and incremental lines. Change: TF_RegExReplace no longer returns ""Counts"" (HugoV) Change: TF_RemoveDuplicateLines 1 - no longer returns ""Removed"". 2 - can use start/end line, 3 - no longer uses sort but keeps original order intact, 4 - to methods to check consecutive lines or unique files in file (HugoV) Change: TF_ColGet, TF_ColPut, TF_ColCut. 1 - order of parameters changed, 2 - now accept Startline, EndLine parameters. (HugoV) Fixed: TF_RemoveDuplicateLines always produced empty Output file (HugoV) History prior 2.0 - TXT library (Heresy, HugoV) 2008-06-18 : added TF_AlignLeft(), TF_AlignCenter(), TF_AlignRight() (Heresy) 2008-06-18 : added TF_Tail(), TF_ReverseLines() (HugoV) 2008-06-17 : added TF_GetCSV(), TF_SetCSV() (Heresy) 2008-06-17 : added TF_LineNumber(), TF_Concat(), TF_ColGet(), TF_ColPut(), TF_ColCut() (HugoV) 2008-06-16 : added TF_RegExReplace(), TF_RemoveLines(), TF_TrimLeft(), TF_TrimRight() (Heresy) 2008-06-15 : added TF_TotalLines(), TF_ReadLines(), TF_RemoveDuplicateLines() (Heresy) Credits This library is based on the Library for Text file manipulation started by Heresy. I have contributed a number of functions to that library, but that version also has some ""bugs"" which are hopefully resolved in this TF library. Thanks to: Heresy, SKAN! (countlines, setwidth, spaces), Olegbl, (suggestion for find*), infogulch (suggestion for tab <-> spaces), Murp|e (suggestions for documentation, check if file exists), ribbet.1 (New features in TF_LineNumber), Tuncay (help with TF() and borrowed ideas for TAIL). Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/hi5/TF"	"by hi5 - Functions for manipulation of text files such as *.txt, *.ahk, *.html, *.css etc and Strings (or variables). Forum thread:."	"true"
"Text manipulation"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=576"	"by hi5 - Functions for manipulation of text files such as *.txt, *.ahk, *.html, *.css etc and Strings (or variables). Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[library] TF: Text files & Variables (strings) v3.5 - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:29 All times are UTC-05:00 [library] TF: Text files & Variables (strings) v3.5 Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 14 posts • Page 1 of 1 ahk7 Posts: 72 Joined: 06 Nov 2013, 16:35 [library] TF: Text files & Variables (strings) v3.5 Report this post Quote 10 Nov 2013, 06:16 TF v3.5 - AutoHotkey library for Text files & Variables (strings) Library and documentation at https://github.com/hi5/TF As the name suggest this is a AHK Library with a number of functions to ""manipulate"" text, both files such as *.txt, *.ahk, *.html, *.css etc AND Strings (or variables). It is NOT useful for binary files or data such as MS Office files, PDFs, EXEcutables, images etc. By using a matchlist* for the lines you want to process for the majority of the functions it is flexible in use, but it does make it a bit slower for large files or variables. If speed is of great importance this may not be the most suitable library. * The matchlist is generated automatically in each function based on the parameters. Changelog v3.5 - Changed A_ScriptDir to A_WorkingDir in TF_ReturnOutPut - https://github.com/hi5/TF/issues/1 - Fixed: TF_ColGet negative startcolumn and sections now work correctly Available Functions TF TF_CountLines TF_Count TF_ReadLines TF_Tail TF_Replace TF_ReplaceInLines TF_RegExReplace TF_RegExReplaceInLines TF_RemoveLines TF_RemoveBlankLines TF_RemoveDuplicateLines TF_InsertLine TF_ReplaceLine TF_LineNumber TF_InsertPrefix TF_InsertSuffix TF_TrimLeft TF_TrimRight TF_AlignLeft TF_AlignCenter TF_AlignRight TF_ConCat TF_ColGet TF_ColPut TF_ColCut TF_ReverseLines TF_Find TF_SplitFileByLines TF_SplitFileByText TF_Merge TF_Prepend TF_Append TF_Substract TF_WhiteSpace TF_Wrap TF_RangeReplace TF_MakeFile TF_Tab2Spaces TF_Spaces2Tab TF_Sort TF_Save TF_Join Keywords: FileDeleteLine Deleteline Delete Line Lines Text file duplicate remove trim split merge replace align sort wrap append prepend find column columns variable strings whitespace leading trailing reverse tail count insert read grep join Last edited by ahk7 on 03 Aug 2014, 03:32, edited 1 time in total. Top jigga Posts: 93 Joined: 24 Jan 2014, 00:31 Facebook: joel.fazio Google: +JoelFazio Re: [library] TF: Text files & Variables (strings) v3.4 Report this post Quote 09 Mar 2014, 12:51 Some of these functions can be kinda slow on big files, but this is a very useful lib Top kiwichick Posts: 75 Joined: 21 Jan 2014, 22:03 Re: [library] TF: Text files & Variables (strings) v3.4 Report this post Quote 18 Apr 2014, 21:18 Hi there, How would I use TF_Find on multiple files and display the results all together in one msgbox? I have this loop: Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus FileSelectFile, Files, M 1,%StartFolder%, Select the files to search, *.ahk InputBox, SearchText, Search File Contents,   loop, Parse, Files, `n { 	if a_index != 1 	{ 	FilePath = %FolderPath%\%A_LoopField% 	result = % TF_Find(FilePath, """","""", SearchText, 0, 1) 	} }   return   I can get: 1. results displayed in a separate msgbox for each file searched. OR 2. results displayed in one msgbox but only for the last file in the list. I can't figure out how to display all the results together so any help would be much appreciated Top ahk7 Posts: 72 Joined: 06 Nov 2013, 16:35 Re: [library] TF: Text files & Variables (strings) v3.4 Report this post Quote 19 Apr 2014, 02:08 You can ""Concatenate"" the results variable - see http://ahkscript.org/docs/Variables.htm#Operators Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus FileSelectFile, Files, M 1,%StartFolder%, Select the files to search, *.ahk InputBox, SearchText, Search File Contents, result:=""""   loop, Parse, Files, `n {     if a_index != 1     {     FilePath = %FolderPath%\%A_LoopField%     Result .= ""`n--------------------"" A_LoopField "":`n"" TF_Find(FilePath, """","""", ""i)\Q"" SearchText ""\E"", 0, 1)     } } MsgBox % result return As a side note: TF_Find uses Regular Expressions so by its default case sensitive, so in your case if you simply type ""msgbox"" in the input it won't find ""MsgBox"" - therefore I've wrapped SearchText with some default options in the code above to save you the hassle of typing it each time ""i)\Q"" SearchText ""\E"" you can alter this to suit your needs of course. You could also return line numbers - See also https://github.com/hi5/TF#TF_Find Top kiwichick Posts: 75 Joined: 21 Jan 2014, 22:03 Re: [library] TF: Text files & Variables (strings) v3.4 Report this post Quote 19 Apr 2014, 21:17 Thanks ahk7!! I did actually manage to figure it out (along with removing duplicate results) which was a pat-on-the-back moment for me I used a temporary text file but I like yours better because it removes the need for that. Cool!! And yes it took me while to realise that the default for TF_Find was case-sensitive. Then it took me another wee while to find the code in TF.ahk to turn it off. I didn't really want it permanently turned off but wasn't sure how to tackle it and you just solved that problem for me!!! Thanks heaps!!! Top ahk7 Posts: 72 Joined: 06 Nov 2013, 16:35 Re: [library] TF: Text files & Variables (strings) v3.5 Report this post Quote 03 Aug 2014, 03:32 Updated to v3.5 - Changed A_ScriptDir to A_WorkingDir in TF_ReturnOutPut - https://github.com/hi5/TF/issues/1 - Fixed: TF_ColGet negative startcolumn and sections now work correctly https://github.com/hi5/TF Top j-t-r Re: [library] TF: Text files & Variables (strings) v3.5 Report this post Quote 10 Apr 2015, 03:14 Thanks to all previous authors and of course to you, ahk7. I use this lib very often. Hope it will be there as long as AHK itself... Top ahk7 Posts: 72 Joined: 06 Nov 2013, 16:35 Re: [library] TF: Text files & Variables (strings) v3.5 Report this post Quote 10 Apr 2015, 12:16 Glad you like it - as soon as specifications for AHK v2 is are ""final"" I will prepare a AHK v2 compatible version Top j-t-r Re: [library] TF: Text files & Variables (strings) v3.5 Report this post Quote 07 Jun 2015, 14:24 Glad to hear it. I wont be migrating to AHK2 instantly but I will be in the end. Can I have one request? Couldnt you add function to remove all the diacritics from strings? Like ěščřžýáíé etc. It means ě or é to e, š to s etc. Top j-t-r Posts: 6 Joined: 08 Jun 2015, 03:05 Re: [library] TF: Text files & Variables (strings) v3.5 Report this post Quote 08 Jun 2015, 03:22 I managed to do it by myself in the end -> viewtopic.php?f=6&t=8089 Thanks. Top ahk7-guest Re: [library] TF: Text files & Variables (strings) v3.5 Report this post Quote 08 Jun 2015, 06:19 Indeed it is in principle a series of find/replace actions - you can now call your function from other TF functions, here TF reads file.txt, passes it on to your function, which in turn is passed on to TF_Save Code: [Select all] [Download] GeSHi © Codebox Plus TF_Save(RemoveLetterAccents(TF(""file.txt"")),""file.txt"") ; just to note this will create a global variable 't' - https://github.com/hi5/TF#TF Top Peace1 Posts: 41 Joined: 17 Mar 2015, 14:19 Location: 127.0.0.1 Re: [library] TF: Text files & Variables (strings) v3.5 Report this post Quote 24 Sep 2015, 15:12 Hi all, Sorry to bump this thread but i have a little problem to manage it in my project ! I will try to explain you my goal : I have a txt file where i want to modify values with TF_ReplaceInLines. My text file look like something like this : Code: [Select all] [Download] GeSHi © Codebox Plus value1 = 15; value2= 5000; value3= 1000; value4= true; value5= false; value6= 50; value7= 80; value8= 40;   I would like to modify the values by another and this is what i tried : Code: [Select all] [Download] GeSHi © Codebox Plus FileSelectFile, SelectedFileSettings, 3, %A_WorkingDir%, Open a file, settings.txt FileContents := SelectedFileSettings TF_ReplaceInLines(""!FileContents"", ""1"", """", ""15"", ""20"")   And in this way that doesn't work Then if i try this code : Code: [Select all] [Download] GeSHi © Codebox Plus FileSelectFile, SelectedFileSettings, 3, %A_WorkingDir%, Open a file, settings.txt FileContents := SelectedFileSettings TF_ReplaceInLines(""!"" FileContents, ""1"", """", ""15"", ""20"")   Another error appear in the TF.ahk @line 81 : OutPut .= LoopField ""`n"" Perhaps i do it bad so if someone can help me please i will appreciate it ! Edit: Well i manage it it was simply the activate#Warn sorry for disturb you guys ! Thank you in advance, regards. Top Depeche_Mode Posts: 2 Joined: 16 Nov 2015, 19:08 Re: [library] TF: Text files & Variables (strings) v3.5 Report this post Quote 25 Nov 2015, 17:49 Hello, TF_ReplaceLine creates a new file, it does not modify the initial file. Top ahk7 Posts: 72 Joined: 06 Nov 2013, 16:35 Re: [library] TF: Text files & Variables (strings) v3.5 Report this post Quote 26 Nov 2015, 14:09 @Depeche_Mode In principle that is correct, by default all functions create a copy of the original file for safety reasons so you can first test it, only if you're sure the command works correctly you can tell TF to overwrite the source file by adding a ! in front of your file name. You can read more about it here: (! prefix) https://github.com/hi5/TF#quick-intro-to-parameters https://github.com/hi5/TF#textfile-and-the--prefix Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 14 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 12 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by hi5 - Functions for manipulation of text files such as *.txt, *.ahk, *.html, *.css etc and Strings (or variables). Forum thread:."	"true"
"Library Distributions"	"ahk-libs"	"https://github.com/rshipp/ahk-libs"	"Ryan Shipp's collection of libraries."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"65"	"25"	"21"	"GitHub - rshipp/ahk-libs: AutoHotkey library archive Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 25 Star 65 Fork 21 rshipp/ahk-libs Code Issues 0 Pull requests 0 Pulse Graphs AutoHotkey library archive https://github.com/rshipp/ahk-libs#readme 181 commits 2 branches 0 releases Fetching contributors AutoHotkey 51.2% HTML 44.5% CSS 3.5% JavaScript 0.8% AutoHotkey HTML CSS JavaScript Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags gh-pages master Nothing to show Nothing to show New pull request Latest commit b1e7d1c Mar 12, 2016 rshipp Add AutoHotkey-HashTable … Closes #5 Permalink Failed to load latest commit information. AFC @ f0ca601 AHK-DB @ b40d791 Updated AHK-DB, AHK_cGist, Avis-Autohotkey-Repo Aug 28, 2013 AHK-Lib-ADOSQL @ 648d8f2 Added @Jim-VxE's JSON_ToObj and ADOSQL libraries. Nov 22, 2013 AHK-Lib-JSON_ToObj @ 52cd6dc Added new libs from @fincs and @JnLlnd. Updated README. Jan 4, 2014 AHK-Lib-Table @ 32636a5 Added @Jim-VxE's AHK-Lib-Table. Nov 22, 2013 AHK-Util-Funcs @ 8d1d2cd AHKLink @ ed5e92e Submodule update. Apr 20, 2014 AHK_DllCall_WinAPI @ 18c5d73 Submodule updates: DllCall_WinAPI, LV_EX, _Struct, ahkDBA Mar 17, 2015 AHK_cGist @ c2c15ec AHK_cTable @ 04c5181 moved all to submodules Jun 1, 2012 AHKs @ 4c63de0 Updated submodules, added @IsNull's DBA and @avi-aryan's Avis-Autohot… Jul 23, 2013 ALD.ahk @ be6a060 Added more libs from @Uberi and @maul-esel, updated README and Source… Jul 23, 2013 AeroThumbnail @ aac55ea moved all to submodules Jun 2, 2012 AssociativeArrays added more of @Uberi's libs Mar 8, 2012 AsyncHttp @ 91ff7ff moved all to submodules Jun 2, 2012 AutoHotkey-ElementTree @ 9c126f7 Added more to README, added submodules pointing to @cocobelgica. Jan 30, 2014 AutoHotkey-Expose @ 28f0455 AutoHotkey-HashTable @ e7019a8 AutoHotkey-IPC @ 0405263 AutoHotkey-JSON @ cffa384 AutoHotkey-Menu @ 252cc16 Added more to README, added submodules pointing to @cocobelgica. Jan 30, 2014 AutoHotkey-PS-Control @ 875d318 Added more to README, added submodules pointing to @cocobelgica. Jan 30, 2014 AutoHotkey-Scripts @ c2dfb10 Updated all submodules. Nov 2, 2013 AutoHotkey-StdLib @ 7195cba moved all to submodules Jun 2, 2012 AutoHotkey-XConfig @ 50379d0 Added more to README, added submodules pointing to @cocobelgica. Jan 30, 2014 AutoHotkey-XML @ ea1092b Added more to README, added submodules pointing to @cocobelgica. Jan 30, 2014 AveragingFunctions added more of @Uberi's libs Mar 9, 2012 Avis-Autohotkey-Repo @ a5c7c90 Change from git: to https:, update submodules Oct 26, 2015 BarGrapher CGUI @ 5e47447 Updated submodules, added @IsNull's DBA and @avi-aryan's Avis-Autohot… Jul 23, 2013 COM-Classes @ cbf0f66 moved all to submodules Jun 2, 2012 Canvas-AHK @ 9b4ca77 LibCon, Canvas, Avi's, and JSON submodule updates. Jul 24, 2014 CaseSensitiveObject @ 87dd242 moved all to submodules Jun 2, 2012 Class_Console @ b581a4b Added Class_Console from @AfterLemon. Apr 18, 2014 Class_ImageButton @ 02a71b8 Just another submodule update. Jun 19, 2014 Class_LV_Colors @ 02e616a Update submodules Apr 14, 2015 Class_LV_InCellEdit @ 7e712f8 Change from git: to https:, update submodules Oct 26, 2015 Class_RichEdit @ 2975d52 Update submodules Apr 15, 2015 Class_SQLiteDB @ 27a12ed Change from git: to https:, update submodules Oct 26, 2015 DeltaCompression added several of @Uberi's libs Mar 8, 2012 ExprEval added several of @Uberi's libs Mar 9, 2012 FF_COM @ 64b7bd0 FTPv2 added FTPv2, JumpList, and DBA, removed HexView (not a lib) Mar 11, 2012 Fast_ini_library added several of @Uberi's libs Mar 9, 2012 FormsFramework @ e3df41f Updated submodules, added @IsNull's DBA and @avi-aryan's Avis-Autohot… Jul 23, 2013 Fraction.ahk @ 4a9915b Added more libs from @Uberi and @maul-esel, updated README and Source… Jul 23, 2013 Geolocation added several of @Uberi's libs Mar 9, 2012 HD_EX @ 39c6a6e Added classes and libs from @AHK-just-me. Jan 26, 2014 IL_EX @ 114f9f2 Added classes and libs from @AHK-just-me. Jan 26, 2014 ITaskbarList @ 68a40c2 moved all to submodules Jun 2, 2012 ImportTypeLib @ 28e9e8b moved all to submodules Jun 2, 2012 JumpList added FTPv2, JumpList, and DBA, removed HexView (not a lib) Mar 11, 2012 LSON @ 8063cef Updated submodules, added @IsNull's DBA and @avi-aryan's Avis-Autohot… Jul 23, 2013 LV_EX @ 7a11ff4 Submodule updates: DllCall_WinAPI, LV_EX, _Struct, ahkDBA Mar 17, 2015 LibCon.ahk @ c5c2686 Submodule updates: LibCon and ahk_library. Dec 27, 2014 ListCompare added several of @Uberi's libs Mar 9, 2012 Map @ 80c9b62 moved all to submodules Jun 2, 2012 MasterFocus-AutoHotkey @ 0a3da0a Updated all submodules. Nov 2, 2013 ObjCSV @ 0a25182 Submodule updates: LibCon and ObjCSV. Mar 16, 2014 ParallelPort added inpout32.zip and modified ParallelPort README Mar 8, 2012 Parallelist @ a01109f Added more libs from @Uberi and @maul-esel, updated README and Source… Jul 23, 2013 QuotedStringReplace added some files Mar 17, 2012 RangeOverlap added several of @Uberi's libs Mar 9, 2012 Raydium-AHK @ 17e8e4a moved all to submodules Jun 2, 2012 SingleCharArray added several of @Uberi's libs Mar 9, 2012 Speech added several of @Uberi's libs Mar 9, 2012 TC_EX @ a446b7c Added classes and libs from @AHK-just-me. Jan 26, 2014 TriangleCollisionDetection added several of @Uberi's libs Mar 9, 2012 WinHttpRequest @ 68effb7 started move to submodules, with WinHttpRequest Jun 1, 2012 WorkerThread @ a87dac6 Updated submodules, added @IsNull's DBA and @avi-aryan's Avis-Autohot… Jul 23, 2013 Zip @ fe4c0db _Struct @ f1f5e24 ahk-OpenGL @ 5805aa9 moved all to submodules Jun 2, 2012 ahk-eval @ 2edfa16 Added new libs from @fincs and @JnLlnd. Updated README. Jan 4, 2014 ahk2-bigint @ b1c14a8 ahkDBA @ d1e6623 Submodule updates: DllCall_WinAPI, LV_EX, _Struct, ahkDBA Mar 17, 2015 ahk_library @ 333c7cf Change from git: to https:, update submodules Oct 26, 2015 ahkstdlib Updated derRaphael's httpQuery in ahkstdlib. Aug 8, 2013 ahkzmq @ 0d207da Added libs/wrappers from @tinku99. Aug 21, 2013 cURL-Wrapper @ a0e9d3f moved all to submodules Jun 2, 2012 dbgp @ d50095b Fixed dbgp to point to @Lexikos, removed ahkoop as deprecated. Jan 4, 2014 jNizM_AutoHotkey_Scripts @ 976fca5 Submodule updates: WinAPI, JSON, jNizM. Sep 19, 2014 scintilla-wrapper @ 7d33026 Submodule update: scintilla-wrapper. Jun 30, 2014 .gitignore changes Jun 1, 2012 .gitmodules Add AutoHotkey-HashTable Mar 12, 2016 README.md Remove Composer/Plaster, update README to point to issue #4 Jul 17, 2015 README.md ahk-libs All the (redistributable) AutoHotkey libraries I can find... Licenses are scattered around in there somewhere. At the moment, this repo contains well over 200 libraries, classes, and wrappers for AHK 1.1 (previously AHK_L), AHK 1.0 (previously basic/vanilla), and AHK v2, implemented in over 3000 scripts. AutoHotkey Library Distribution Want more libs? Several projects have similar goals to this one: pAHKlight ASPDM, for package/stdlib distribution and management from the ahkscript folks ALD (discontinued) tuncay's original ahkstdlib (discontinued) Salt (discontinued) README! Please note that, because this repo makes heavy use of git 'submodules', downloading a zip or tarball is not useful. Instead, if you wish to have access to all the libs included in this repo, please run: git clone --recursive git://github.com/rshipp/ahk-libs.git  Included So far, the included libs are (in no particular order): The 'ahkstdlib' collection, in its entirety (see http://www.autohotkey.com/forum/viewtopic.php?t=54996) Several of Uberi's libs, including: AHK-DB (sqlite3 database functions), AssociativeArrays, AveragingFunctions, BarGrapher, DeltaCompression, ExprEval(), Geolocation, ListCompare, ParallelPort, QuotedStringReplace, RangeOverlap, Raydium-AHK (game engine wrapper), SingleCharArray, Speech (tts lib), TriangleCollisionDetection, Parallelist, Canvas-AHK, Fraction.ahk Rseding91's ""Fast ini library"", basic and advanced versions Several of infogulch's libs, including: WinHttpRequest, Map, AsyncHttp, Zip, LSON, ahk2-bigint, CaseSensitiveObject, ahk-OpenGL nimdahk's AHKLink lib ChrisS85's CGUI and WorkerThread libs camerb's AHK libs polyethene's AutoHotkey-Scripts Several of maul-esel's libs, including: COM-Classes, FormsFramework, ITaskbarList, AeroThumbnail, ImportTypeLib, AHK-Util-Funcs (GUID, Mem, Obj, etc), ALD.ahk hoppfrosch's cTable and cGist classes HotKeyIt's _Struct libs for AHK v2 and _H RaptorX's scintilla-wrapper and cURL-Wrapper libs IsNull's ahkDBA aviaryan's ""autohotkey-scripts"", which includes several AHK libraries and scripts. lordkrandel's ahk_library TLMcode's FF_COM MasterFocus's ""AutoHotkey"" repo, which includes several AHK libraries and functions. tinku99's ahkzmq wrapper and stdlib. joedf's LibCon.ahk Jim-VxE's JSON_ToObj, ADOSQL, and Table libraries. JnLlnd's ObjCSV library fincs' AutoHotkey Foundation Classes (AFC), and ahk-eval library Lexikos' DBGp library AHK-just-me's HD_EX, TC_EX, IL_EX, LV_EX, Class_LV_Colors, Class_LV_InCellEdit, Class_SQLiteDB, Class_ImageButton, and Class_RichEdit. cocobelgica's AutoHotkey-ElementTree, AutoHotkey-PS-Control, AutoHotkey-Menu, AutoHotkey-IPC, AutoHotkey-XConfig, AutoHotkey-JSON, AutoHotkey-XML, and AutoHotkey-Expose. AfterLemon and tidbit's Class_Console. jNizM's AHK_DllCall_WinAPI and AutoHotkey_Scripts (jNizM_AutoHotkey_Scripts). Removed Shambles-Dev’s Plaster introspection and Composer functional programming libraries. (Issue #4) Note to developers of these libs If your code is in this repo, and you do not want it to be, I apologize. Please just let me know, and I will remove it. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/rshipp/ahk-libs"	"Ryan Shipp's collection of libraries."	"true"
"Library Distributions"	"ASPDM"	"https://github.com/ahkscript/ASPDM"	"package/stdlib distribution and management from the folks. Trello."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"20"	"9"	"5"	"GitHub - ahkscript/ASPDM: AHKScript.org's Package/StdLib Distribution and Management Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 9 Star 20 Fork 5 ahkscript/ASPDM Code Issues 7 Pull requests 0 Pulse Graphs AHKScript.org's Package/StdLib Distribution and Management http://aspdm.ahkscript.org/ 362 commits 1 branch 0 releases Fetching contributors AutoHotkey 77.9% JavaScript 7.7% PHP 7.0% HTML 4.8% NSIS 1.4% CSS 1.2% AutoHotkey JavaScript PHP HTML NSIS CSS Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit 6aed0bf Jul 5, 2016 joedf Network: Ellipse tags if too long Permalink Failed to load latest commit information. Local-Client libcrypt.ahk: refactor examples Jul 5, 2016 Network Network: Ellipse tags if too long Jul 5, 2016 Specifications update specs/guidelines+database about ADPL Jun 8, 2016 .gitattributes Add NSIS Installer + update check Jun 14, 2014 .gitignore update .gitignore Mar 5, 2014 .nojekyll .nojekyll Mar 25, 2014 README.md rebranded license to ADPL Jun 8, 2016 README.md ASPDM AHKScript.org's Package/StdLib Distribution and Management http://aspdm.ahkscript.org/ Quick Info Local-Client : The local package manager Network : The Web Frontend and NetworkAPI Try ASPDM right now! Download the latest version (Development Version, Always up to date) http://aspdm.ahkscript.org/client http://aspdm.ahkscript.org/client/get.php (Direct download) Specifications Guidelines : Specifications/Guidelines.md Database : Specifications/Database.md License : Specifications/License.md (ADPL) NetworkAPI : Specifications/NetworkAPI.md Join the Conversation! Trello : https://trello.com/b/XVP4M76d - (How to Join) GitHub : http://ahkscript.org/boards/viewtopic.php?f=17&t=936 Forum : http://ahkscript.org/boards/viewtopic.php?f=6&t=1241 Email : aspdm@ahkscript.org or joedf@ahkscript.org Contributors (Thanks) george2, perfaram, fincs, joedf Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/ahkscript/ASPDM"	"package/stdlib distribution and management from the folks. Trello."	"true"
"Library Distributions"	"ahkscript"	"https://github.com/ahkscript"	"package/stdlib distribution and management from the folks. Trello."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"ahkscript · GitHub Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This organization ahkscript A new community founded by a number of enthusiasts to promote the use of AutoHotkey. http://ahkscript.org support@ahkscript.org Repositories People 31 Filters Sources Forks AutoHotkey 20 5 ASPDM AHKScript.org's Package/StdLib Distribution and Management Updated Jul 5, 2016 AutoHotkey 11 5 libcrypt.ahk A collection of crypting and encoding functions from the community Updated Jul 5, 2016 1 17 phpbb31_styles forked from cyberalien/phpbb31_styles Updated Jul 5, 2016 261 45 awesome-AutoHotkey A curated list of awesome AutoHotkey libraries, library distributions, scripts, tools and resources. Updated Jun 21, 2016 JavaScript 81 13 SublimeAutoHotkey AutoHotkey AHK language package for SublimeText including syntax highlighting, comments toggling, auto-completions, build system definitions, commands for ahkrun, ahkcompile, ahkrunpiped. Updated May 19, 2016 HTML 0 4 Autohotkey.docset forked from vaz-ar/Autohotkey.docset Dash/Zeal Docset for autohotkey_L Updated Apr 20, 2016 1 0 AutoHotkey_User_Survey Link to AutoHotKey User survey Updated Mar 29, 2016 Python 7 1 sjBot Sjc1000's Python IRC bot for the ahkscript community. Updated Mar 6, 2016 AutoHotkey 2 3 scintilla-wrapper forked from RaptorX/scintilla-wrapper Updated Feb 29, 2016 JavaScript 3 0 phpBB_v3.0.x-Notifications This was the notification mod used in the ahkscript phpBB v3.0.x forum. Updated Dec 7, 2015 CSS 7 2 ahkscript.github.io A GitHub page for ahkscript.org - http://ahkscript.github.io/ Updated Aug 2, 2015 Ruby 0 19 inviter forked from tech404/inviter The application behind the tech404 automatic invitation system Updated Jul 29, 2015 PHP 0 8 phpBB-Extension-Codebox-Plus forked from o0johntam0o/phpBB-Extension-Codebox-Plus Syntax highlighting extension for phpBB Updated May 22, 2015 AutoHotkey 3 1 AutoHotkey-Editors AutoHotkey Syntax Highlighting for text editors Updated Apr 4, 2015 AutoHotkey 1 14 AHK-Studio forked from maestrith/AHK-Studio Created with AHK Studio Updated Mar 24, 2015 AutoHotkey 7 1 WinStructs A collection of definitions for Windows structures for decoding DLL call and OnMessage results etc. For use with HotkeyIt's _Struct library. Updated Mar 4, 2015 AutoHotkey 4 0 AHK-EXE-Swapper A Utility to easily manage which version of AutoHotkey that uncompiled scripts use. Updated Feb 14, 2015 AutoHotkey 1 1 AHK-SizeOf-Checker A library that can check the number of bytes of a windows define. Companion to _Struct and WinStructs. REQUIRES VISUAL STUDIO Updated Feb 6, 2015 AutoHotkey 1 7 ActiveScript.ahk forked from Lexikos/ActiveScript.ahk An AutoHotkey script for hosting Active Scripting languages like VBScript and JScript. Updated Jan 23, 2015 CSS 3 4 AHK_Tutorial forked from acorns/AHK_Tutorial A tutorial for AutoHotkey by tidbit Updated Jan 23, 2015 Previous 1 2 Next 31 People Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/ahkscript"	"package/stdlib distribution and management from the folks. Trello."	"true"
"Library Distributions"	"link"	"https://trello.com/b/XVP4M76d/package-stdlib-distribution-and-management"	"package/stdlib distribution and management from the folks. Trello."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Trello Your browser was unable to load all of Trello's resources. They may have been blocked by your firewall, proxy or browser configuration. Press Ctrl+F5 or Ctrl+Shift+R to have your browser try again and if that doesn't work, check out our troubleshooting guide. To use Trello, please enable JavaScript. If you're having trouble loading Trello, check out our troubleshooting guide or contact us!"	"null"	"null"	"package/stdlib distribution and management from the folks. Trello."	"true"
"Library Distributions"	"pAHKlight"	"https://github.com/hi5/pAHKlight"	"Your Lightweight Guide to AutoHotkey libraries, classes, functions and tools."	"null"	"null"	"null"	"null"	"null"	""	"null"	"9"	"3"	"3"	"GitHub - hi5/pAHKlight: Your Lightweight Guide to AutoHotkey libraries, classes, functions and tools Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 3 Star 9 Fork 3 hi5/pAHKlight Code Issues 1 Pull requests 0 Pulse Graphs Your Lightweight Guide to AutoHotkey libraries, classes, functions and tools http://ahkscript.org/boards/viewtopic.php?f=6&t=1241 45 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit f6c527f Oct 20, 2015 href Adding TrayIcon Permalink Failed to load latest commit information. COPYING.txt Initial commit Jan 1, 2014 categories.txt Adding xml, winclip Mar 25, 2014 pahklight.ahk Adding ahk.dll - duplicate category removed - further fine tuning err… Feb 12, 2014 pahklightDB.ini Adding TrayIcon Oct 20, 2015 readme.md Added new discussion link Jan 29, 2014 readme.md pAHKlight - v0.1.1 pAHKlight - Your Lightweight Guide to AutoHotkey libraries, classes, functions and tools. Questions or suggestions? Post it here http://ahkscript.org/boards/viewtopic.php?f=6&t=1241 or file an issue here on GitHub. To contribute, read the info about the format below, and either post new entries for the database on the forum or create a pull request. Discussion about an entirely new system here https://trello.com/b/XVP4M76d/package-stdlib-distribution-and-management (not related to pAHKlight) Introduction A package or module: a software component for accomplishing a particular thing. (wikipedia) Many programming languages have so called package managers to easily manage the installation of libraries. AutoHotkey lacks such a standard solution (December '13). See the discussions below for some background info. pAHKlight is a possible intermediate solution until a more competent system is setup, it is not meant as a real package manager, but its purpose is to help find libraries, classes, functions and tools quickly, especially for those unfamiliar with AutoHotkey. The pAHKlight script is fairly short and the format for the ""package database"" is kept very simple so even a novice user should be able to maintain (both the script and) the database. This will hopefully ensure that is kept up to date by posting new additions for the database on the forum or pull requests on Github. Once you have found a ""package"" of interest visit the source or discussion page for more detailed information and (usually) instructions how install and apply the ""package"". As a reminder (for yourself) you can tick the checkbox in front of a package if you use it. It will remember that for the next time you start pAHKlight so you can quickly see which package(s) you are already using. Things pAHKlight can and should not do: download, install or update libraries, classes, functions and tools check which (versions of) libraries, classes, functions and tools are currently installed Things pAHKlight should not do: replicate the content of a forum by including all posted scripts. It should include packages only. INI Format The INI format used in pahklightDB.ini has the following structure    [Sequential number]    name=short    fullname=full    author=    type=lib|class|function|tool    source=URL    forum=URL    category=    ahkversion=    description= Section/Key Description [Sequential number] Used as section names in the INI, they have to be unique name= Short names, usually the name of the Prefix in case of a library or class fullname= Full name used in the Gui (texts) and Browse list (listview) author= (Main) Author of the script - you can include an URL: name @ URL although not mandatory type= Lib, class, function or tool - only one allowed see comments below source= URL - can be same as forum URL below in case source is posted on a forum for example. Must include http(s) forum= URL - forum link, if used must include http(s) category= CSV list (see categories.txt) ahkversion= AHK version as indicated by the author or tested by person adding it to database description= Purpose of the lib, class, function or tool. The entire text should be on one line due to the limitation of the INI format. Use `n if you want to display a new line just like you would in AutoHotkey name, fullname, author, type, source and description are mandatory fields. type There are four types, you can only select one. The following brief definitions apply: lib: So called Standard and/or User Libraries (stdlib) as described briefly here http://ahkscript.org/docs/Functions.htm#lib. class: A class is an extensible template for creating objects, see http://ahkscript.org/docs/Objects.htm#Custom_Classes function: Standalone function for a specific task tool: Helper programs to generate code (gui for example) or extend the capability of AutoHotkey. ""Normal"" scripts should not be included in pAHKlight. category The category field is a comma separated value list. These can be found in categories.txt - if not present in that list the category is not accepted. Suggestions for the categories are of course welcome. Other Resources Attempts for defining so called Standard libraries have been made before and discussed a number of times, you can find some below: Alternative: https://github.com/Library-Distribution Not completed, no plans for further development Alternative: http://www.autohotkey.com/board/topic/50834-ahk-standard-library-collection-2010-sep-gui-libs-100/ Last update in 2010 Discussion: http://www.autohotkey.com/board/topic/49921-stdlib-call-for-information/ Discussion: http://www.autohotkey.com/board/topic/63827-libraries-in-default-ahk-installation-ahk-l/ New discussion: https://trello.com/b/XVP4M76d/package-stdlib-distribution-and-management Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/hi5/pAHKlight"	"Your Lightweight Guide to AutoHotkey libraries, classes, functions and tools."	"true"
"Clipboard"	"Clipjump"	"http://clipjump.sourceforge.net/"	"is a Multiple-Clipboard management utility for Windows. Source code:. Forum threads:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"116"	"19"	"19"	"GitHub - aviaryan/Clipjump: Clipboard Manager for Windows, built in AutoHotkey Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 19 Star 116 Fork 19 aviaryan/Clipjump Code Issues 30 Pull requests 1 Wiki Pulse Graphs 📋 Clipboard Manager for Windows, built in AutoHotkey http://clipjump.sourceforge.net/ 336 commits 2 branches 5 releases Fetching contributors AutoHotkey 73.0% HTML 25.2% CSS 1.8% AutoHotkey HTML CSS Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags db master Nothing to show v12.5 v12.3 v11.6.1 12.0 11.6 Nothing to show New pull request Latest commit 6777987 Apr 22, 2016 aviaryan updated Russian translation, closes #123 Permalink Failed to load latest commit information. icons bug fixes and minor feature additions - closes #24, closes #39, closes … Jul 18, 2014 languages updated Russian translation, closes #123 Apr 22, 2016 lib added monitorClipboard to settings, closes #101 Apr 13, 2016 plugins remove unused parameter Dec 8, 2015 website changed download link to github releases Apr 14, 2016 .gitignore update .gitignore Dec 8, 2015 Clipjump.ahk fixed history migration issue; a race condition Apr 14, 2016 ClipjumpCommunicator.ahk v10.7.2.6 - Plugins Mar 3, 2014 Clipjump_x64.ahk added clipjump_x64.ahk to run x64 AHK on 64-bit systems May 7, 2014 NOTICE.txt 10.7.8 - fixed issues with netbeans, added image editing feature in h… Mar 27, 2014 Readme.md change download link to github Apr 14, 2016 publicAPI.ahk don't store modifier in pastemodekey vars, #116, code part done Mar 31, 2016 sqlite3.dll added sqlite 3.9.2 Feb 29, 2016 Readme.md Clipjump Download Online Manual Clipjump is a Multiple-Clipboard management utility for Windows. It was built to make working with multiple clipboards super fast and super easy. The program records changes in the system clipboard, stores them without any limits and provides innovative ways to work with them. Running from the Source Get AutoHotkey and install it. Then double-click Clipjump.ahk to run it with AutoHotkey.exe Distribution Clipjump is distributed without compiling and a disguised AutoHotkey.exe renamed as Clipjump.exe runs Clipjump.ahk Get the ResHacked AutoHotkey.exe from sourceforge. This is the one which is to be distributed as Clipjump.exe Correct the version numbers of the binary file. Distribute it with the source. Building the Docs Docs can be compiled using Jekyll and then Microsoft's HHC. First build the website folder using Jekyll and then compile the jekyll-processed files using HHC. Adding Plugins Please add your plugins to the clipjump-addons repository. This repo only contains plugins distributed with official Clipjump release. If I realise your plugin is useful for the community, I will distribute it officially and hence it will be added to this repository. See #68 Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/aviaryan/Clipjump"	"is a Multiple-Clipboard management utility for Windows. Source code:. Forum threads:."	"true"
"Clipboard"	"GitHub"	"https://github.com/aviaryan/Clipjump"	"is a Multiple-Clipboard management utility for Windows. Source code:. Forum threads:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"116"	"19"	"19"	"GitHub - aviaryan/Clipjump: Clipboard Manager for Windows, built in AutoHotkey Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 19 Star 116 Fork 19 aviaryan/Clipjump Code Issues 30 Pull requests 1 Wiki Pulse Graphs 📋 Clipboard Manager for Windows, built in AutoHotkey http://clipjump.sourceforge.net/ 336 commits 2 branches 5 releases Fetching contributors AutoHotkey 73.0% HTML 25.2% CSS 1.8% AutoHotkey HTML CSS Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags db master Nothing to show v12.5 v12.3 v11.6.1 12.0 11.6 Nothing to show New pull request Latest commit 6777987 Apr 22, 2016 aviaryan updated Russian translation, closes #123 Permalink Failed to load latest commit information. icons bug fixes and minor feature additions - closes #24, closes #39, closes … Jul 18, 2014 languages updated Russian translation, closes #123 Apr 22, 2016 lib added monitorClipboard to settings, closes #101 Apr 13, 2016 plugins remove unused parameter Dec 8, 2015 website changed download link to github releases Apr 14, 2016 .gitignore update .gitignore Dec 8, 2015 Clipjump.ahk fixed history migration issue; a race condition Apr 14, 2016 ClipjumpCommunicator.ahk v10.7.2.6 - Plugins Mar 3, 2014 Clipjump_x64.ahk added clipjump_x64.ahk to run x64 AHK on 64-bit systems May 7, 2014 NOTICE.txt 10.7.8 - fixed issues with netbeans, added image editing feature in h… Mar 27, 2014 Readme.md change download link to github Apr 14, 2016 publicAPI.ahk don't store modifier in pastemodekey vars, #116, code part done Mar 31, 2016 sqlite3.dll added sqlite 3.9.2 Feb 29, 2016 Readme.md Clipjump Download Online Manual Clipjump is a Multiple-Clipboard management utility for Windows. It was built to make working with multiple clipboards super fast and super easy. The program records changes in the system clipboard, stores them without any limits and provides innovative ways to work with them. Running from the Source Get AutoHotkey and install it. Then double-click Clipjump.ahk to run it with AutoHotkey.exe Distribution Clipjump is distributed without compiling and a disguised AutoHotkey.exe renamed as Clipjump.exe runs Clipjump.ahk Get the ResHacked AutoHotkey.exe from sourceforge. This is the one which is to be distributed as Clipjump.exe Correct the version numbers of the binary file. Distribute it with the source. Building the Docs Docs can be compiled using Jekyll and then Microsoft's HHC. First build the website folder using Jekyll and then compile the jekyll-processed files using HHC. Adding Plugins Please add your plugins to the clipjump-addons repository. This repo only contains plugins distributed with official Clipjump release. If I realise your plugin is useful for the community, I will distribute it officially and hence it will be added to this repository. See #68 Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/aviaryan/Clipjump"	"is a Multiple-Clipboard management utility for Windows. Source code:. Forum threads:."	"true"
"Clipboard"	"link 1"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=401"	"is a Multiple-Clipboard management utility for Windows. Source code:. Forum threads:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Clipjump : The Ultimate Clipboard Manager [v12.5] - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:29 All times are UTC-05:00 Clipjump : The Ultimate Clipboard Manager [v12.5] Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 77 posts 1 2 3 4 Next Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Clipjump : The Ultimate Clipboard Manager [v12.5] Report this post Quote 23 Oct 2013, 23:52 (ORIGINAL) AutoHotkey.com Topic v12.5 Clipjump is a multiple clipboard management utility for Windows. It was built to make working with multiple clipboards super fast and super easy. The program records changes in the system clipboard, stores them without any limits and provides innovative ways to work with them. The basic ideas on which Clipjump is built upon No extra shortcuts needed to manage multiple clipboards in Clipjump, go with your default Ctrl + C,X and V. Not just the text. All Clipboard formats are supported. No opening a GUI and looking for your clip to paste it. Everything happens from Ctrl+V here, the pasting operation is superfast. Portability and Speed Multilingual and Open Source The main idea of Clipjump is to make the clipboard management process fast as well as powerful. As a result, there are lots of features in here to suit your needs. Paste Formats - Format text in different ways before pasting. The ones available by default include Trim Formatting, Sentence Case, Regex Replace, DeHTML and lots more. Plugins - Using the API, you can create plugins that can very well extend the functionality of Clipjump. Channels - You can sort clips in channels. These channels can be activated such that the clips copied automatically move to it. History Tool - It stores a plain copy of each of the item copied onto Clipjump. By default, it stores the activity of last 30 days. Action Mode - Another little innovation that saves you from rememebring dozens of shortcuts for different features in Clipjump. Just press Ctrl ShiftA to see a list of popular functionailities and open them in a snap. Scripting - ClipjumpCustom.ini is the script file for Clipjump. You can write small, easy-to-understand scripts to personalize Clipjump. Other features like adding tags to clips, exporting them, copying file directly to clipboard etc are also supported. Official  Site Online Help Source Last edited by Avi on 14 Apr 2016, 13:11, edited 17 times in total. Clipjump Clipboard Manager : More Scripts Top timeFlies Posts: 146 Joined: 22 Oct 2013, 20:54 Location: Somewhere in the northern hemisphere. Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 03 Nov 2013, 10:59 Any headway on improving the keyboard shortcuts yet? Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 04 Nov 2013, 08:59 chaz wrote:Any headway on improving the keyboard shortcuts yet? To be honest, I havent touched the Clipjump code from some time now. I hope to get back soon . Clipjump Clipboard Manager : More Scripts Top budRich Posts: 63 Joined: 29 Sep 2013, 16:52 Location: Wermland Contact: Contact budRich Website Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 09 Nov 2013, 17:28 chaz wrote:Any headway on improving the keyboard shortcuts yet? +1 ClipJump is using ^!T, i need that for other things. Is there someway to disable it? I have the source, but I can't find the hotkey declaration. The program that needs the hotkey is NexusFile (a free portable filemanager available at xiles.net/). sharing is caring Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 10 Nov 2013, 00:49 budRich wrote: chaz wrote:Any headway on improving the keyboard shortcuts yet? +1 ClipJump is using ^!T, i need that for other things. Is there someway to disable it? I have the source, but I can't find the hotkey declaration. The program that needs the hotkey is NexusFile (a free portable filemanager available at xiles.net/). Sorry but I dont see whose default shortcut is Ctrl+Alt+T ? If there is, you can disable it with the Settings Editor. Clipjump Clipboard Manager : More Scripts Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 16 Nov 2013, 06:54 v9.8.1 Added an option to auto-disable Clipjump when certain window is active Added an option to play sound when data copied to Clipjump Fixed bugs with Channel cycles in Paste-Mode Clipjump Clipboard Manager : More Scripts Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 18 Nov 2013, 06:12 v9.8.5 Fixed bugs with Clipjump in MS Excel Fixed bug with Cut functionality in MS Excel and Kingsoft Office (you can add more spreadsheet application too) Clipjump Clipboard Manager : More Scripts Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 07 Dec 2013, 08:15 v9.9.1 Made Clipjump possible to be translated in other languages. Removed system-level shortcuts for copy file data, copy file path, pitswap and channel selector. They can be accessed from Clipjump Action Mode and a system-level shortcut for them can still be created. fixed many odd bugs    FUTURE PLANS A plugin architecture to make user script various aspects of Clipjump a/c their needs . The syntax will be like AutoHotkey and so simple and for everyone.   PS - New Site - http://avi.uco.im/projects/clipjump/ Clipjump Clipboard Manager : More Scripts Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 02 Jan 2014, 02:14 v10 Added option to Copy and Move clips from one channel to another Now press A in paste mode to go to Clip 1 Current Clip pointer in paste mode is never discarded You can use Middle Mouse Button to Insta-paste Added option in Ini to set program's default priority Clipjump Clipboard Manager : More Scripts Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 04 Jan 2014, 03:27 v10.4.9.9 beta Fixed bugs with ^a in paste mode, channel delete feature and middle mouse insta-paste feature Added Customizing feature in Clipjump (see http://clipjump.sourceforge.net/docs/custom.html) ClipjumpCustom.ini can be configured to change hidden variables in Clipjump to make Clipjump totally custom for a user. The file is created and loaded when you start Clipjump. It gives power to- - Change previously unchangeable shortcuts - bind a hotkey to an action (like a hotkey to toggle Incognito Mode) - run coded labels and functions to tailor-make any complex user function. (you may need my help here and I am here to help) - send key-presses to facilitate scripting/macro Please have a look at the new customizing features and suggest your ideas. If you have in the past preferred some features in Clipjump, you can put your words so that more helpful examples can be given in the doc (http://clipjump.sourceforge.net/docs/custom.html). DOWNLOAD EXE - https://sourceforge.net/projects/clipju ... p/download Clipjump Clipboard Manager : More Scripts Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 08 Jan 2014, 09:06 v10.6 Fixed a bug with A key in Paste mode Fixed bugs with channel delete feature Added feature to customize + scripting (Clipjump Customizer) in Clipjump Added search feature in paste mode Added feature to edit clips in Paste mode Added feature : Protected Channels Clipjump now shows changes in current version when updated Clipjump Clipboard Manager : More Scripts Top art Posts: 9 Joined: 01 Jan 2014, 05:56 Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 08 Jan 2014, 14:16 Error for Clipjump v10.6: --------------------------- Clipjump.exe --------------------------- Error: Nonexistent menu item. Specifically: &Incognito Mode Line# ---> 3586: Menu,Tray,check,&Incognito Mode The current thread will exit. --------------------------- OK --------------------------- Best Regards art Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 08 Jan 2014, 22:45 art wrote:Error for Clipjump v10.6: --------------------------- Clipjump.exe --------------------------- Error: Nonexistent menu item. Specifically: &Incognito Mode Line# ---> 3586: Menu,Tray,check,&Incognito Mode The current thread will exit. --------------------------- OK --------------------------- Best Regards art Thanks @art, that came out an issue because it was a part of a less used feature . You have kept ""No of days to keep items in history"" as 0 unlike anybody else and so you found that error . I will release a fix soon. Clipjump Clipboard Manager : More Scripts Top art Posts: 9 Joined: 01 Jan 2014, 05:56 Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 09 Jan 2014, 00:41 Avi wrote:Thanks @art, that came out an issue because it was a part of a less used feature . You have kept ""No of days to keep items in history"" as 0 unlike anybody else and so you found that error . I will release a fix soon.You are right! Tks Avi for your good work, Keep walking! Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 09 Jan 2014, 02:35 art wrote: Avi wrote:Thanks @art, that came out an issue because it was a part of a less used feature . You have kept ""No of days to keep items in history"" as 0 unlike anybody else and so you found that error . I will release a fix soon.You are right! Tks Avi for your good work, Keep walking! Clipjump Clipboard Manager : More Scripts Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 09 Jan 2014, 03:36 v10.6.2 minor release Minor fix: bug when number of days in history was set to 0 Minor fix: a clip was FIXED at pos 1 Major fix: invalid hotkey error when used in Russian systems Added: A sound beep in protected channels @art You may update Clipjump Clipboard Manager : More Scripts Top art Posts: 9 Joined: 01 Jan 2014, 05:56 Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 09 Jan 2014, 04:42 Avi wrote:v10.6.2 minor release ... @art You may updateYou are really fast! Thank you sir. Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 11 Jan 2014, 06:22 v10.6.3 Fixed issue with Action mode in Russian systems Minor: fixed about gui title centering Clipjump Clipboard Manager : More Scripts Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 03 Mar 2014, 06:27 v10.7.2.6 beta Clipjump now supports Plugins Custom Paste Formats like NO-FORMATTING are now possible with the added Plugin Support Multiple Insta-paste'ing possible in History Tool. Use Enter in Paste mode to paste without closing Paste mode. After that, release Ctrl to cancel. Use Ctrl+Enter in Search in Paste mode to paste without closing the window i.e. multi-paste. ActionMode keys are totally customizable now. Added Edit option in History Use %...% in Customizer to declare variables. (Eg > myvar = %some_oldvar% or myvar = %Store.var% ) Also added function support in %..% variables. (Eg > myvar = %myfunc(someparam)% ) Use noautorun=1 in a section in ClipjumpCustom.ini to avoid auto-executing it even if it doesn't have a bind key. Added API.executeSection() to execute a section at will in ClipjumpCustom.ini Added Store. object (multi-variable holder) to store variables that are valid throughout the Program's runtime. Fixes in EditClip option in Paste mode See Site - http://clipjump.sourceforge.net/beta/ Clipjump Clipboard Manager : More Scripts Top Avi Posts: 183 Joined: 30 Sep 2013, 09:51 Facebook: avi.aryan.ap Google: +AviAryan GitHub: aviaryan Location: India Contact: Contact Avi Website Skype Twitter Re: Clipjump : The Ultimate Clipboard Manager Report this post Quote 16 Mar 2014, 10:07 v10.7.5 Clipjump now supports Plugins Custom Paste Formats like NO-FORMATTING are now possible with the added Plugin Support Multiple Insta-paste'ing possible in History Tool. Use Enter in Paste mode to paste without closing Paste mode. After that, release Ctrl to cancel. Use Ctrl+Enter in Search in Paste mode to paste without closing the window i.e. multi-paste. ActionMode keys are totally customizable now. Add, remove, modify.. Added Edit option in History Use %...% in Customizer to declare variables. Also added function support in %..% variables. Use noautorun=1 in a section in ClipjumpCustom.ini to avoid auto-executing it even if it doesn't have a bind key. Added API.executeSection() to execute a section at will in ClipjumpCustom.ini Added Store. object (multi-variable holder) to store variables that are valid throughout the Program's runtime. Fixes in EditClip option in Paste mode CHANGED No-Formatting option is now a part of paste-formatting option Clipjump Clipboard Manager : More Scripts Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 77 posts 1 2 3 4 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 12 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"is a Multiple-Clipboard management utility for Windows. Source code:. Forum threads:."	"true"
"Clipboard"	"link 2"	"https://autohotkey.com/board/topic/91488-clipjump-the-ultimate-clipboard-manager-updated-0708/"	"is a Multiple-Clipboard management utility for Windows. Source code:. Forum threads:."	"null"	"null"	"null"	"null"	"null"	""	"null"	"116"	"19"	"19"	"GitHub - aviaryan/Clipjump: Clipboard Manager for Windows, built in AutoHotkey Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 19 Star 116 Fork 19 aviaryan/Clipjump Code Issues 30 Pull requests 1 Wiki Pulse Graphs 📋 Clipboard Manager for Windows, built in AutoHotkey http://clipjump.sourceforge.net/ 336 commits 2 branches 5 releases Fetching contributors AutoHotkey 73.0% HTML 25.2% CSS 1.8% AutoHotkey HTML CSS Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags db master Nothing to show v12.5 v12.3 v11.6.1 12.0 11.6 Nothing to show New pull request Latest commit 6777987 Apr 22, 2016 aviaryan updated Russian translation, closes #123 Permalink Failed to load latest commit information. icons bug fixes and minor feature additions - closes #24, closes #39, closes … Jul 18, 2014 languages updated Russian translation, closes #123 Apr 22, 2016 lib added monitorClipboard to settings, closes #101 Apr 13, 2016 plugins remove unused parameter Dec 8, 2015 website changed download link to github releases Apr 14, 2016 .gitignore update .gitignore Dec 8, 2015 Clipjump.ahk fixed history migration issue; a race condition Apr 14, 2016 ClipjumpCommunicator.ahk v10.7.2.6 - Plugins Mar 3, 2014 Clipjump_x64.ahk added clipjump_x64.ahk to run x64 AHK on 64-bit systems May 7, 2014 NOTICE.txt 10.7.8 - fixed issues with netbeans, added image editing feature in h… Mar 27, 2014 Readme.md change download link to github Apr 14, 2016 publicAPI.ahk don't store modifier in pastemodekey vars, #116, code part done Mar 31, 2016 sqlite3.dll added sqlite 3.9.2 Feb 29, 2016 Readme.md Clipjump Download Online Manual Clipjump is a Multiple-Clipboard management utility for Windows. It was built to make working with multiple clipboards super fast and super easy. The program records changes in the system clipboard, stores them without any limits and provides innovative ways to work with them. Running from the Source Get AutoHotkey and install it. Then double-click Clipjump.ahk to run it with AutoHotkey.exe Distribution Clipjump is distributed without compiling and a disguised AutoHotkey.exe renamed as Clipjump.exe runs Clipjump.ahk Get the ResHacked AutoHotkey.exe from sourceforge. This is the one which is to be distributed as Clipjump.exe Correct the version numbers of the binary file. Distribute it with the source. Building the Docs Docs can be compiled using Jekyll and then Microsoft's HHC. First build the website folder using Jekyll and then compile the jekyll-processed files using HHC. Adding Plugins Please add your plugins to the clipjump-addons repository. This repo only contains plugins distributed with official Clipjump release. If I realise your plugin is useful for the community, I will distribute it officially and hence it will be added to this repository. See #68 Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/Avi-Aryan/Clipjump"	"is a Multiple-Clipboard management utility for Windows. Source code:. Forum threads:."	"true"
"Filesystem"	"Belvedere"	"https://github.com/adampash/belvedere"	"sets up rules for taking actions on files (move, copy, delete, etc) based on the name of a file, its extension, size, age, and more. More info."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"105"	"17"	"52"	"GitHub - adampash/belvedere: Automated file manager Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 17 Star 105 Fork 52 adampash/belvedere Code Issues 12 Pull requests 1 Pulse Graphs Automated file manager http://lifehacker.com/341950/belvedere-automates-your-self+cleaning-pc 18 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit 436174c Dec 1, 2013 adampash Rename README to README.md Permalink Failed to load latest commit information. includes Changed version numbers across the board to reflect new release Apr 16, 2009 installer fixed bug that allowed rules of the name but different folders to ove… Apr 10, 2009 resources Initial commit of Belvedere 0.3 source code Apr 3, 2009 Belvedere.ahk Changed version numbers across the board to reflect new release Apr 16, 2009 README.md Rename README to README.md Dec 1, 2013 todo.txt fixed bug that allowed rules of the name but different folders to ove… Apr 10, 2009 README.md Belvedere Belvedere sets up rules for taking actions on files (move, copy, delete, etc) based on the name of a file, its extension, size, age, and more. For usage details, see Lifehacker Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/adampash/belvedere"	"sets up rules for taking actions on files (move, copy, delete, etc) based on the name of a file, its extension, size, age, and more. More info."	"true"
"Filesystem"	"link"	"http://lifehacker.com/341950/belvedere-automates-your-self-cleaning-pc"	"sets up rules for taking actions on files (move, copy, delete, etc) based on the name of a file, its extension, size, age, and more. More info."	"null"	"null"	"null"	"null"	"null"	""	"null"	"212"	"35"	"52"	"GitHub - mshorts/belvedere: Automated file manager Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 35 Star 212 Fork 52 mshorts/belvedere forked from adampash/belvedere Code Issues 35 Pull requests 2 Wiki Pulse Graphs Automated file manager http://lifehacker.com/341950/belvedere-automates-your-self+cleaning-pc 113 commits 2 branches 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags gh-pages master Nothing to show Nothing to show New pull request Pull request Compare This branch is 97 commits ahead, 2 commits behind adampash:master. Latest commit 9a824a8 Mar 13, 2012 mshorts added missing license Permalink Failed to load latest commit information. help includes fixed custom action to behave with paths with spaces and the working … Mar 13, 2012 installer resources added new icon for paused state in tray menu May 1, 2009 .gitignore Belvedere.ahk LICENSE.txt Add LICENSE.txt (GPL v3). Mar 7, 2012 README.md altered build script to be completely automated Mar 11, 2012 build.ahk README.md Belvedere An automated file manager for Windows Platform: Windows (XP and later) Language(s): AutoHotkey, NSIS (for the installer) License: GPL v3 See LICENSE.txt for licensing details. How to build the installer manually. Clone the repo: git clone git://github.com/mshorts/belvedere.git Download and install NSIS Download KIllProc plug-in for NSIS Download and install Microsoft HTML Help Workshop 1.3. Download and install AutoHotkey_L. Download and install Compile_AHK. Compile Belvedere.ahk with Compile_AHK(in the root of the repo) and move the .exe into the /installer directory. Compile /help/Belvedere Help.hhp with HTML Help Workshop and move the .chm to the /installer directory. Compile /installer/install.nsi Make sure to test the installer. How to build the installer automatically. Run build.ahk Find the installer in the /dist directory. How to run. Download the installer -or- Install AutoHotkey and run Belvedere.ahk. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/mshorts/belvedere"	"sets up rules for taking actions on files (move, copy, delete, etc) based on the name of a file, its extension, size, age, and more. More info."	"true"
"Graphics"	"Fun with GDIPlus"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=6071"	"Interesting GDI+ examples."	"null"	"null"	"null"	"null"	"null"	""	"null"	"null"	"null"	"null"	"Fun with GDIPlus (GDI+) - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:29 All times are UTC-05:00 Fun with GDIPlus (GDI+) Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 21 posts 1 2 Next jNizM Posts: 1581 Joined: 30 Sep 2013, 01:33 GitHub: jNizM Location: Germany Fun with GDIPlus (GDI+) Report this post Quote 23 Jan 2015, 04:39 Like the Topic (A collection of small ahk functions) a Topic for GDIPlus-experiments Feel free to add more My first example: ""Hüpfer"" (Fractal) Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus #Warn #NoEnv #SingleInstance Force SetBatchLines -1   ; ===============================================================================================================================   global GUI_W := 1024, GUI_H := 768 global a := -70, b := 100, c := -100 global cnt := 100000 global u := GUI_W / 2, v := GUI_H / 2 global x := y := 0 global pToken := pGraphics := pBrush := """"   OnExit, CleanUp   ; ===============================================================================================================================   if !(DllCall(""kernel32.dll\GetModuleHandle"", ""Str"", ""GdiPlus"", ""UPtr""))     GdiPDLL := DllCall(""kernel32.dll\LoadLibrary"", ""Str"", ""GdiPlus.dll"", ""UPtr"") VarSetCapacity(SI, 24, 0), Numput(1, SI, 0, ""Int"") if !(DllCall(""GdiPlus.dll\GdiplusStartup"", ""PtrP"", pToken, ""Ptr"", &SI, ""Ptr"", 0))     pToken := pToken   ; ===============================================================================================================================   Gui, +LastFound +hwndGDIFun Gui, Show, w%GUI_W% h%GUI_H%   DllCall(""GdiPlus.dll\GdipCreateFromHWND"", ""Ptr"", GDIFun, ""PtrP"", pGraphics), pGraphics := pGraphics DllCall(""GdiPlus.dll\GdipCreateSolidFill"", ""UInt"", 0, ""PtrP"", pBrush), pBrush := pBrush DllCall(""GdiPlus.dll\GdipGraphicsClear"", ""Ptr"", pGraphics, ""UInt"", 0xFF181818)   loop % cnt {     DllCall(""GdiPlus.dll\GdipFillRectangle"", ""Ptr"", pGraphics, ""Ptr"", pBrush, ""Float"", (u + x), ""Float"", (v + y), ""Float"", 1, ""Float"", 1)     xx := y + Sgn(x) * Abs(b * x - c) ** 0.5, y := yy := a - x, x := xx     , r := 0x10000 * Floor(Abs(y) > 0xFF ? 0xFF : Abs(y))     , g := 0x100 * Floor(Abs(yy) > 0xFF ? 0xFF : Abs(yy))     , b := Floor(Abs(xx) > 0xFF ? 0xFF : Abs(xx))     DllCall(""GdiPlus.dll\GdipSetSolidFillColor"", ""UPtr"", pBrush, ""UInt"", (0x80000000 + r + g + b)) } return   ; ===============================================================================================================================   CleanUp: GuiClose:     DllCall(""GdiPlus.dll\GdipDeleteGraphics"", ""Ptr"", pGraphics)     DllCall(""GdiPlus.dll\GdipDeleteBrush"", ""Ptr"", pBrush)     DllCall(""GdiPlus.dll\GdiplusShutdown"", ""Ptr"", pToken)     DllCall(""kernel32.dll\FreeLibrary"", ""Ptr"", GdiPDLL)     ExitApp return   ; ===============================================================================================================================   Sgn(var) {     return (var > 0) ? 1 : (var < 0) ? -1 : 0 } Last edited by jNizM on 23 Jan 2015, 09:25, edited 2 times in total. [AHK] 1.1.24.00 x64 Unicode [WIN] 7 Ultimate x64 SP1 | 10 Pro (10.0.10586) x64 Dropbox referrals (earn 500 MB of bonus and support me) Top Soft Posts: 147 Joined: 07 Jan 2015, 13:18 GitHub: visionary1 Location: Seoul Contact: Contact Soft Website Re: Fun with GDIPlus Report this post Quote 23 Jan 2015, 06:37 interesting!! AutoHotkey & AutoHotkey_H v1.1.22.07 Top jNizM Posts: 1581 Joined: 30 Sep 2013, 01:33 GitHub: jNizM Location: Germany Re: Fun with GDIPlus Report this post Quote 23 Jan 2015, 08:54 Wave: (by Jerome Herr) Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus #Warn #NoEnv #SingleInstance Force SetBatchLines -1   ; ===============================================================================================================================   global PI := 3.14159265, TWO_PI := PI * 2 global cnt := 25, step := 20 global wh := hue := theta := 0 global MaxRad := (cnt - 1) * step global GUI_W := GUI_H := MaxRad global pToken := pGraphics := pBitmap := pGraphicsCon := pPen := """"   OnExit, CleanUp   ; ===============================================================================================================================   if !(DllCall(""kernel32.dll\GetModuleHandle"", ""Str"", ""GdiPlus"", ""UPtr""))     GdiPDLL := DllCall(""kernel32.dll\LoadLibrary"", ""Str"", ""GdiPlus.dll"", ""UPtr"") VarSetCapacity(SI, 24, 0), Numput(1, SI, 0, ""Int"") if !(DllCall(""GdiPlus.dll\GdiplusStartup"", ""PtrP"", pToken, ""Ptr"", &SI, ""Ptr"", 0))     pToken := pToken   ; ===============================================================================================================================   Gui, +LastFound +hwndGDIFun Gui, Show, w%GUI_W% h%GUI_H%   DllCall(""GdiPlus.dll\GdipCreateFromHWND"", ""Ptr"", GDIFun, ""PtrP"", pGraphics), pGraphics := pGraphics DllCall(""GdiPlus.dll\GdipCreateBitmapFromGraphics"", ""Int"", GUI_W, ""Int"", GUI_H, ""Ptr"", pGraphics, ""PtrP"", pBitmap), pBitmap := pBitmap DllCall(""Gdiplus.dll\GdipGetImageGraphicsContext"", ""Ptr"", pBitmap, ""PtrP"", pGraphicsCon), pGraphicsCon := pGraphicsCon DllCall(""Gdiplus.dll\GdipSetSmoothingMode"", ""Ptr"", pGraphicsCon, ""UInt"", 2) DllCall(""Gdiplus.dll\GdipCreatePen1"", ""UInt"", 0xFFFFFFFF, ""Float"", 3, ""Int"", 2, ""PtrP"", pPen), pPen := pPen   loop {     DllCall(""GdiPlus.dll\GdipGraphicsClear"", ""Ptr"", pGraphicsCon, ""UInt"", 0x7F000000)     loop % cnt     {         i := A_Index - 1         , sz := i * step, offSet := TWO_PI / cnt * i, do := (MaxRad / 2) - (sz / 2)         , arcEnd := (Map(Sin(theta + offSet), -1, 1, PI, TWO_PI) - PI) * 57.29577951         , ARGB := 0xFF Hex(DllCall(""Shlwapi.dll\ColorHLSToRGB"", ""Short"", (hue + i), ""Short"", 120, ""Short"", 240))         , DllCall(""GdiPlus.dll\GdipSetPenColor"", ""Ptr"", pPen, ""UInt"", ARGB)         , DllCall(""GdiPlus.dll\GdipDrawArc"", ""Ptr"", pGraphicsCon, ""Ptr"", pPen, ""Float"", do, ""Float"", do, ""Float"", sz, ""Float"", sz, ""Float"", 0,   ""Float"", arcEnd)         , DllCall(""GdiPlus.dll\GdipDrawArc"", ""Ptr"", pGraphicsCon, ""Ptr"", pPen, ""Float"", do, ""Float"", do, ""Float"", sz, ""Float"", sz, ""Float"", 180, ""Float"", arcEnd)     }     theta += 0.0523, theta := (theta > TWO_PI) ? Mod(theta, TWO_PI) : theta, hue += 0.5, hue := (hue > 239) ? Mod(hue, 239) : hue     , DllCall(""Gdiplus.dll\GdipDrawImage"", ""Ptr"", pGraphics, ""Ptr"", pBitmap, ""Float"", 0, ""Float"", 0)     DllCall(""kernel32.dll\Sleep"", ""UInt"", 30) } return   ; ===============================================================================================================================   CleanUp: GuiClose:     DllCall(""GdiPlus.dll\GdipDeletePen"", ""Ptr"", pPen)     DllCall(""GdiPlus.dll\GdipDeleteGraphics"", ""Ptr"", pGraphicsCon)     DllCall(""Gdiplus.dll\GdipDisposeImage"", ""Ptr"", pBitmap)     DllCall(""GdiPlus.dll\GdipDeleteGraphics"", ""Ptr"", pGraphics)     DllCall(""GdiPlus.dll\GdiplusShutdown"", ""Ptr"", pToken)     DllCall(""kernel32.dll\FreeLibrary"", ""Ptr"", GdiPDLL)     ExitApp return   ; ===============================================================================================================================   Hex(v) {     VarSetCapacity(s, 65, 0), DllCall(""msvcrt.dll\_i64tow"", ""Int64"", v, ""Str"", s, ""UInt"", 16, ""CDECL"")     return s }   Map(nVar, min1, max1, min2, max2) {     return min2 + (max2 - min2) * ((nVar - min1) / (max1 - min1)) } Last edited by jNizM on 29 Jan 2015, 01:50, edited 1 time in total. [AHK] 1.1.24.00 x64 Unicode [WIN] 7 Ultimate x64 SP1 | 10 Pro (10.0.10586) x64 Dropbox referrals (earn 500 MB of bonus and support me) Top jNizM Posts: 1581 Joined: 30 Sep 2013, 01:33 GitHub: jNizM Location: Germany Re: Fun with GDIPlus Report this post Quote 23 Jan 2015, 09:38 Exuberant wave: (by Jerome Herr) Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus #Warn #NoEnv #SingleInstance Force SetBatchLines -1   ; ===============================================================================================================================   global PI := 3.14159265, TWO_PI := PI * 2 global cnt := 25, step := 20 global wh := hue := theta := 0 global MaxRad := (cnt - 1) * step global GUI_W := GUI_H := MaxRad global pToken := pGraphics := pBitmap := pGraphicsCon := pPen := """"   OnExit, CleanUp   ; ===============================================================================================================================   if !(DllCall(""kernel32.dll\GetModuleHandle"", ""Str"", ""GdiPlus"", ""UPtr""))     GdiPDLL := DllCall(""kernel32.dll\LoadLibrary"", ""Str"", ""GdiPlus.dll"", ""UPtr"") VarSetCapacity(SI, 24, 0), Numput(1, SI, 0, ""Int"") if !(DllCall(""GdiPlus.dll\GdiplusStartup"", ""PtrP"", pToken, ""Ptr"", &SI, ""Ptr"", 0))     pToken := pToken   ; ===============================================================================================================================   Gui, +LastFound +hwndGDIFun Gui, Show, w%GUI_W% h%GUI_H%   DllCall(""GdiPlus.dll\GdipCreateFromHWND"", ""Ptr"", GDIFun, ""PtrP"", pGraphics), pGraphics := pGraphics DllCall(""GdiPlus.dll\GdipCreateBitmapFromGraphics"", ""Int"", GUI_W, ""Int"", GUI_H, ""Ptr"", pGraphics, ""PtrP"", pBitmap), pBitmap := pBitmap DllCall(""Gdiplus.dll\GdipGetImageGraphicsContext"", ""Ptr"", pBitmap, ""PtrP"", pGraphicsCon), pGraphicsCon := pGraphicsCon DllCall(""Gdiplus.dll\GdipSetSmoothingMode"", ""Ptr"", pGraphicsCon, ""UInt"", 2) DllCall(""Gdiplus.dll\GdipCreatePen1"", ""UInt"", 0xFFFFFFFF, ""Float"", 3, ""Int"", 2, ""PtrP"", pPen), pPen := pPen   loop {     DllCall(""GdiPlus.dll\GdipGraphicsClear"", ""Ptr"", pGraphicsCon, ""UInt"", 0x7F000000)     loop % cnt     {         i := A_Index - 1         hue := Map(i, 0, cnt, 100, 200)         , sz := i * step, offSet := TWO_PI / cnt * i, do := (MaxRad / 2) - (sz * 0.5)         , arcEnd := (Map(Sin(theta + offSet / 2), -1, 1, PI, TWO_PI + PI / 2) - PI) * 57.29577951         , ARGB := 0xFF Hex(DllCall(""Shlwapi.dll\ColorHLSToRGB"", ""Short"", hue, ""Short"", 90, ""Short"", 90))         , DllCall(""GdiPlus.dll\GdipSetPenColor"", ""Ptr"", pPen, ""UInt"", ARGB)         , DllCall(""GdiPlus.dll\GdipDrawArc"", ""Ptr"", pGraphicsCon, ""Ptr"", pPen, ""Float"", do, ""Float"", do, ""Float"", sz, ""Float"", sz, ""Float"", 180, ""Float"", arcEnd)     }     theta += 0.0523, theta := (theta > TWO_PI) ? Mod(theta, TWO_PI) : theta     , DllCall(""Gdiplus.dll\GdipDrawImage"", ""Ptr"", pGraphics, ""Ptr"", pBitmap, ""Float"", 0, ""Float"", 0)     DllCall(""kernel32.dll\Sleep"", ""UInt"", 30) } return   ; ===============================================================================================================================   CleanUp: GuiClose:     DllCall(""GdiPlus.dll\GdipDeletePen"", ""Ptr"", pPen)     DllCall(""GdiPlus.dll\GdipDeleteGraphics"", ""Ptr"", pGraphicsCon)     DllCall(""Gdiplus.dll\GdipDisposeImage"", ""Ptr"", pBitmap)     DllCall(""GdiPlus.dll\GdipDeleteGraphics"", ""Ptr"", pGraphics)     DllCall(""GdiPlus.dll\GdiplusShutdown"", ""Ptr"", pToken)     DllCall(""kernel32.dll\FreeLibrary"", ""Ptr"", GdiPDLL)     ExitApp return   ; ===============================================================================================================================   Hex(v) {     VarSetCapacity(s, 65, 0), DllCall(""msvcrt.dll\_i64tow"", ""Int64"", v, ""Str"", s, ""UInt"", 16, ""CDECL"")     return s }   Map(nVar, min1, max1, min2, max2) {     return min2 + (max2 - min2) * ((nVar - min1) / (max1 - min1)) } Last edited by jNizM on 29 Jan 2015, 01:51, edited 2 times in total. [AHK] 1.1.24.00 x64 Unicode [WIN] 7 Ultimate x64 SP1 | 10 Pro (10.0.10586) x64 Dropbox referrals (earn 500 MB of bonus and support me) Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: Fun with GDIPlus Report this post Quote 23 Jan 2015, 11:36 Very nice! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Learning one Posts: 111 Joined: 04 Oct 2013, 13:59 Location: Croatia Contact: Contact Learning one Website Re: Fun with GDIPlus Report this post Quote 28 Jan 2015, 15:56 joedf wrote:Very nice!+1 Were you inspired by this? My Website • Recommended: AutoHotkey Unicode 32-bit • Join DropBox, Copy Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Fun with GDIPlus Report this post Quote 28 Jan 2015, 16:05 Would my GDI creation fit in here? Code: Spoiler Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus w:=600,h:=500,m:=50 Gui,+hWndn Gui,Show,w%w% h%h% Loop,% (w,x:=-1,d:=DllCall(""GetDC"",ptr,n)){ Loop,% (h,y:=-1,j:=++x*(3/w)-2.1){ k:=++y*(2.5/h)-1.25,a:=b:=i:=0 while,(a*a+b*b<4&&i<m) t:=a*a-b*b+j,b:=2*a*b+k,a:=t,i++ DllCall(""SetPixel"",ptr,d,int,x,int,y,int,i=m?0:i/m*255) }}MsgBox Edit: Also this (actually using GDI+) Code: Spoiler AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: Fun with GDIPlus Report this post Quote 28 Jan 2015, 20:56 @GeekDude nice fractal! Learning one wrote: joedf wrote:Very nice!+1 Were you inspired by this? here we go! http://www.openprocessing.org/sketch/152169 Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top jNizM Posts: 1581 Joined: 30 Sep 2013, 01:33 GitHub: jNizM Location: Germany Re: Fun with GDIPlus Report this post Quote 29 Jan 2015, 01:35 @Learning one (and joedf) yes yes yes [AHK] 1.1.24.00 x64 Unicode [WIN] 7 Ultimate x64 SP1 | 10 Pro (10.0.10586) x64 Dropbox referrals (earn 500 MB of bonus and support me) Top Nextron Posts: 606 Joined: 01 Oct 2013, 08:23 Location: Netherlands OS: Win7 x64 AHK: Unicode x32 Re: Fun with GDIPlus Report this post Quote 29 Jan 2015, 08:50 This would be cool as a mouse sonar replacement (the circles radiating from the cursor in case you lose it), but making the window transparent proves difficult. The black background is actually a mix of almost black (010101, 010001, 010100) and the anti aliasing makes it look ugly. The more I know: The more I know, I know nothing. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: GDI+ standard library 1.45 by tic Report this post Quote 02 Apr 2015, 21:11 Had some fun with dithering algorithms. Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #SingleInstance, Force #NoEnv SetBatchLines, -1 SetMouseDelay, 2 CoordMode, Mouse, Screen   ; Start gdi+ If !pToken := Gdip_Startup() {     MsgBox, 48, gdiplus error!, Gdiplus failed to start. Please ensure you have gdiplus on your system     ExitApp } OnExit, ExitSub Gui, +HwndHwnd Gui, Show, w640 h480   hDC := GetDC(hWnd) return   ^+x:: MouseGetPos, StartX, StartY FileSelectFile, FilePath   pBitmap := Gdip_CreateBitmapFromFile(FilePath) Width := Gdip_GetImageWidth(pBitmap) Height := Gdip_GetImageHeight(pBitmap)   Gdip_LockBits(pBitmap, x, y, Width, Height, Stride, Scan0, BitmapData)   n := 2 StartX += (445-Width*n)/2 StartY += (330-Height*n)/2 State := 0   Loop, %Height% { 	y := A_Index - 1 	Loop, %Width% 	{ 		x := A_Index - 1 		ARGB := Gdip_GetLockBitPixel(Scan0, x, y, Stride) 		Average := Round(((ARGB>>16&0xFF) + (ARGB>>8&0xFF) + (ARGB&0xFF)) / 3) 		Gdip_SetLockBitPixel(Average, Scan0, x, y, Stride) 	} }   hMemDC := CreateCompatibleDC(hDC) pBitmap := CreateCompatibleBitmap(hDC, Width, Height) oBitmap := SelectObject(hMemDC, pBitmap) ; Original Bitmap is stored to later be restored   Loop, %Height% { 	y := A_Index - 1 	Loop, %Width% 	{ 		x := A_Index - 1   		Shade := Gdip_GetLockBitPixel(Scan0, x, y, Stride) 		NewShade := Shade > 0x7F ? 0xFF : 0   		Error := Shade - NewShade   		ShiftLockBitPixel(Error * 7/16, Scan0, x+1, y,   Stride, Width, Height) 		ShiftLockBitPixel(Error * 3/16, Scan0, x-1, y+1, Stride, Width, Height) 		ShiftLockBitPixel(Error * 5/16, Scan0, x,   y+1, Stride, Width, Height) 		ShiftLockBitPixel(Error * 1/16, Scan0, x+1, y+1, Stride, Width, Height)   		DllCall(""SetPixel"", ""UPtr"", hMemDC, ""Int"", x, ""Int"", y, ""UInt"", NewShade<<16|NewShade<<8|NewShade) 	} 	BitBlt(hDC, 0, 0, Width, Height, hMemDC, 0, 0) }   SelectObject(hMemDC, oBitmap) DeleteObject(hBitmap) DeleteDC(hMemDC)   Gdip_UnlockBits(pBitmap, BitmapData) Gdip_DisposeImage(pBitmap) return   ExitSub: Gdip_Shutdown(pToken) ExitApp Return   ShiftLockBitPixel(Offset, Scan0, x, y, Stride, w, h) { 	if (x < 0 || x >= w || y >= h || y < 0) 		return 	Pixel := Gdip_GetLockBitPixel(Scan0, x, y, Stride) 	Gdip_SetLockBitPixel(Clamp(Pixel+Offset, 0, 0xFF), Scan0, x, y, Stride) }   AverageARGB(ARGB) { 	return }   Clamp(Var, Min, Max) { 	return Var < Min ? Min : Var > Max ? Max : Var } Spoiler AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: Fun with GDIPlus Report this post Quote 03 Apr 2015, 06:29 Very nice thread with beautiful examples. DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top serg Posts: 16 Joined: 21 Mar 2015, 05:33 Re: Fun with GDIPlus Report this post Quote 04 Apr 2015, 12:35 interesting stuff! Top tomoe_uehara Posts: 161 Joined: 05 Oct 2013, 12:37 Re: Fun with GDIPlus (GDI+) Report this post Quote 15 Sep 2015, 12:46 Draw a Cuboid Spoiler Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus #SingleInstance, Force #NoEnv SetBatchLines, -1   C1 := 0xff0000aa, C2 := 0xff00aa00, C3 := 0xffaa0000   ; Uncomment if Gdip.ahk is not in your standard library ;#Include, Gdip.ahk   If !pToken := Gdip_Startup() {    MsgBox, 48, gdiplus error!, Gdiplus failed to start. Please ensure you have gdiplus on your system    ExitApp } OnExit, Exit   Width := A_ScreenWidth, WC := Width//2 , Height := A_ScreenHeight, HC := Height//2     , TopLeftX := (A_ScreenWidth - Width)//2, TopLeftY := (A_ScreenHeight - Height)//2   Gui, 1: -Caption +E0x80000 +LastFound +AlwaysOnTop +ToolWindow +OwnDialogs Gui, 1: Show, NA   hwnd1 := WinExist(), hbm := CreateDIBSection(Width, Height), hdc := CreateCompatibleDC()     , obm := SelectObject(hdc, hbm), G := Gdip_GraphicsFromHDC(hdc), Gdip_SetSmoothingMode(G, 4)     , speed := 1, s := 120, d := 20, h := 120, 2h := h + h   Loop {     mcx := (mc := Cos(a := Mod(A_Index, 90)* 0.01745329252)) * s         , mcy := mc * d         , msx := (ms := Sin(a)) * s         , msy := ms * d       ; Points     x1 := WC - mcx,  y1 := HC - msy - h         , x2  := WC + msx, y2 := HC - mcy - h         , x3  := WC + mcx, y3 := HC + msy - h         , x4  := WC - msx, y4 := HC + mcy - h         , yb1 := y1 + 2h, yb2 := y2 + 2h         , yb3 := y3 + 2h, yb4 := y4 + 2h       ; Fill Top     P1 := x1 "","" y1 ""|"" x2 "","" y2 ""|"" x3 "","" y3 ""|"" x4 "","" y4         , DrawFace(P1, C3, G)       ; Fill Vertical Faces     P1 := x1 "","" y1 ""|"" x4 "","" y4 ""|"" x4 "","" yb4 ""|"" x1 "","" yb1         , P2 := x4 "","" y4 ""|"" x3 "","" y3 ""|"" x3 "","" yb3 ""|"" x4 "","" yb4         , P3 := x2 "","" y2 ""|"" x2 "","" yb2 ""|"" x3 "","" yb3 ""|"" x3 "","" y3         , i :=Mod(A_Index, 360)     if (i < 90 || (i < 270 && i >= 180))         DrawFace(x1 < x4 ? P1 : P3, C1, G)             , DrawFace(P2, C2, G)     else {         if (x1 < x4)             DrawFace(P1, C2, G)                 , DrawFace(P2, C1, G)         else             DrawFace(P2, C1, G)                 , DrawFace(P3, C2, G)     }       UpdateLayeredWindow(hwnd1, hdc, TopLeftX, TopLeftY, Width, Height)     if (!Mod(A_Index, speed))         Sleep, 30     Gdip_GraphicsClear(G) }   DrawFace(Points, Color, G) {     pBrush := Gdip_BrushCreateSolid(Color)         , Gdip_FillPolygon(G, pBrush, Points, 1)         , Gdip_DeleteBrush(pBrush)     return }   p::Pause   Right:: s++ Set_TT(""s"", s) return   Left:: s-- Set_TT(""s"", s) return   Up:: d++ Set_TT(""d"", d) return   Down:: if (d > 0)     d-- Set_TT(""d"", d) return   PGUP:: h++ 2h := h + h Set_TT(""h"", h) return   PGDN:: if (h > 0)     h-- 2h := h + h Set_TT(""h"", h) return   Home:: If (Speed < 3)     Speed++ Set_TT(""Speed"", Speed) return   End:: If (Speed > 1)     Speed-- Set_TT(""Speed"", Speed) return   Set_TT(s, v) {     ToolTip, % s "": "" v     SetTimer, TT, -1500     return }   TT: ToolTip return   Esc:: Exit: SelectObject(hdc, obm), DeleteObject(hbm), DeleteDC(hdc)     , Gdip_DeleteGraphics(G), Gdip_Shutdown(pToken) ExitApp Return Source: http://rosettacode.org/wiki/Draw_a_cuboid [Emoticon Database] ---> Download the latest version of AutoHotkey from here <--- Top tomoe_uehara Posts: 161 Joined: 05 Oct 2013, 12:37 Re: Fun with GDIPlus (GDI+) Report this post Quote 15 Sep 2015, 12:57 2D Fractals Spoiler Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ; L-system: http://en.wikipedia.org/wiki/L-system #SingleInstance, Off #NoEnv   Mem() ; include library   	setbatchlines -1 	process, priority, , high   	pToken := Gdip_Startup() 	OnExit, Cleanup   	;*** ;90deg Koch curve 	Koch90Iter  := 5 	Koch90Rules := ""F>F+F-F-F+F"" 	Koch90Start := ""F"" 	Koch90Cmds  := ""F+-"" 	Koch90Cmds2 := ""draw 5,angle -90,angle +90"" 	;*   	;*** ;Koch snowflake 	KochSnowFlakeIter  := 4 	KochSnowFlakeRules := ""F>F-F++F-F"" 	KochSnowFlakeStart := ""F++F++F"" 	KochSnowFlakeCmds  := ""F+-"" 	KochSnowFlakeCmds2 := ""draw 5,angle -60,angle +60"" 	;*   	;*** ;Sierpinski triangle 	SierpinskiIter  := 10 	SierpinskiRules := ""A>B-A-B,B>A+B+A"" 	SierpinskiStart := ""A"" 	SierpinskiCmds  := ""AB+-"" 	SierpinskiCmds2 := ""draw 2,draw 2,angle -60,angle +60"" 	;*   	;*** ;Dragon curve 	DragonCurveIter  := 15 	DragonCurveRules := ""X>X+YF,Y>FX-Y"" 	DragonCurveStart := ""FX"" 	DragonCurveCmds  := ""F+-"" 	DragonCurveCmds2 := ""draw 3,angle -90,angle +90"" 	;*   	;*** ;Penrose tiling 	PenroseP3Iter := 7 	PenroseP3Rules = 	(LTrim Join, 		6 > 81++91----71[-81----61]++ 		7 > +81--91[---61--71]+ 		8 > -61++71[+++81++91]- 		9 > --81++++61[+91++++71]--71 		1 > 	) 	PenroseP3Start := ""[7]++[7]++[7]++[7]++[7]"" 	PenroseP3Cmds  := ""1+-[]"" 	PenroseP3Cmds2 := ""draw 10,angle -36,angle +36,save,restore"" 	;*   	;*** ;Fractal plant 	FractalPlantIter  := 7 	FractalPlantRules := ""X>F-[[X]+X]+F[+FX]-X,F>FF"" 	FractalPlantStart := ""&X"" 	FractalPlantCmds  := ""F+-[]&"" 	FractalPlantCmds2 := ""draw 3,angle -25,angle +25,save,restore,angle -60"" 	;*   	;*** ; triangles 	trianglesIter  := 7 	trianglesRules := ""F>F+F-F"" 	trianglesStart := ""F-F-F"" 	trianglesCmds  := ""+-F"" 	trianglesCmds2 := ""angle -120,angle +120,draw 6"" 	;*   	;*** ; squares1 	squares1Iter  := 720 	squares1Rules := ""A>A+B,B>2B"" 	squares1Start := ""A"" 	squares1Cmds  := ""12345+"" 	squares1Cmds2 := ""draw 1,draw 2,draw 3,draw 4,draw 5,angle +91"" 	;*   	;*** ; squares2 	squares2Iter  := 90 	squares2Rules := ""A>A+B,B>2B,2>21"" 	squares2Start := ""A"" 	squares2Cmds  := ""12345+"" 	squares2Cmds2 := ""draw .25,draw .5,draw .75,draw 1,draw 1.25,angle +91"" 	;*   	; ----- choose the style from option below ----- 	;	name = triangles 	;	name = KochSnowFlake 	;	name = Sierpinski 	;	name = DragonCurve 	;	name = PenroseP3 		name = FractalPlant 	;	name = triangles 	;	name = squares1 	;	name = squares2   	linecount := DispLSystem( %name%Iter, %name%Rules, %name%Start, %name%Cmds, %name%Cmds2, 0 )   	MsgBox % ""Done!`nThere are "" linecount "" lines in this L-System.`nCreated in "" errorlevel "" seconds.`nThis is an average of "" (linecount / errorlevel) "" lines per second."" return   Esc::ExitApp   GuiClose: Cleanup: 	Gdip_Shutdown(pToken) 	ExitApp   DispLSystem( iter, rules, start, names, commands, live = 0 ) { 	DllCall(""QueryPerformanceFrequency"", ""int64*"", qpcf), DllCall(""QueryPerformanceCounter"", ""int64*"", qpcs)   	turtle := LSystem( iter, rules, start ) 	cnt := LSys2Lines( turtle, names, commands, lines, w, h )   	MakeLayeredWindow( hwnd, hdc, hbm, obm, gfx, w, h ) ;	UpdateLayeredWindow(hwnd, hdc) 	DrawLinesToLayeredWindow( lines, cnt, hwnd, hdc, gfx, live ) 	UpdateLayeredWindow(hwnd, hdc) 	CleanupLayeredWindow( hwnd, hdc, hbm, obm, gfx )   	DllCall(""QueryPerformanceCounter"", ""int64*"", qpce) 	return cnt, ErrorLevel := (qpce - qpcs) / qpcf }   LSystem( cn, Vr, st ) { ; ; cn: iterations ; Vr: list of variables and their rules ;    (V>Result)[,...] ;    Where ;      V: Any single-character variable (must be valid as an AHK variable) ;          a-z 1-9 _ (case insensitive) ;      Result: The rule that this variable results in when replaced ;          [All characters except for comma] (must not start with a quote char: "") ;          OR ;          ""[All characters]"" (starts and ends with quote char. any literal quote chars inside must be duplicated) ; st : start string ; ; Any non-variable character is treated as a constant ; 	it := 1 	while it := RegExMatch(Vr, ""\s*(\w)\s*>\s*(?:(?!"""")([^,]*)|""""((?:[^""""]|"""""""")*)"""")\s*(?:,|$)"", __, it + StrLen(__)) 		%__1% := __2 RegExReplace(__3, """""""""""", """"""""), Vl .= __1 ;parse Variables+Rules 	loop % cn 	{ 		tp := """" st, st := """" 		loop, parse, tp 			st .= InStr(Vl, A_LoopField) ? %A_LoopField% : A_LoopField 	} 	return st } LSys2Lines( ls, chars, commands, byref lines, byref w, byref h ) { ;based on l-system 	l := 0 	, st%l%x := 0 	, st%l%y := 0 	, st%l%a := 0 	, i := 0 	lines_cap := VarSetCapacity(lines, strlen(ls) * 8) 	maxx := maxy := minx := miny := 0 	loop, parse, commands, `,, %A_Space%%A_Tab% 		cmd%A_Index% := A_LoopField 	loop, parse, ls 	{ 		if !p := InStr(chars, A_LoopField) 			continue 		else if inStr(cmd%p%, ""save"") 			ol := l++ 			, st%l%x := st%ol%x 			, st%l%y := st%ol%y 			, st%l%a := st%ol%a 		else if inStr(cmd%p%, ""restore"") 			l-- 		else if inStr(cmd%p%, ""angle"") 			st%l%a += substr(cmd%p%, 6) 		else if inStr(cmd%p%, ""draw"") 		{ 			d  := SubStr(cmd%p%, 5) + 0     ;distance (in pixels) 			AddLine( lines, i 				, Round(st%l%x) 				, Round(st%l%y)                           				, Round(st%l%x += cos(st%l%a/57.2957795) * d) 				, Round(st%l%y += sin(st%l%a/57.2957795) * d) ) 			, maxx := maxx > st%l%x ? maxx : st%l%x 			, maxy := maxy > st%l%y ? maxy : st%l%y 			, minx := minx < st%l%x ? minx : st%l%x 			, miny := miny < st%l%y ? miny : st%l%y 		} 	} 	xoff := round(abs(minx)) + 5 	yoff := round(abs(miny)) + 5 	w := round(maxx) + xoff + 5 	h := round(maxy) + yoff + 5   	OffsetPoints(lines, i, xoff, yoff) 	return i//4 }   AddLine( ByRef lines, ByRef i, x1, y1, x2, y2 ) { 	static lines_sz = 0 	if (i = 0 || lines_sz = 0) 		lines_sz := VarSetCapacity(lines) 	if (lines_sz < i * 4 + 16) 		MemPreAlloc(lines, lines_sz, i + 16), lines_sz := VarSetCapacity(lines) 	  NumPut(x1, lines, 4 * i++, ""int"") 	, NumPut(y1, lines, 4 * i++, ""int"") 	, NumPut(x2, lines, 4 * i++, ""int"") 	, NumPut(y2, lines, 4 * i++, ""int"") }   OffsetPoints( ByRef lines, cnt, xoff, yoff ) { 	i := 0 	while i < cnt 		NumPut(NumGet(lines, i * 4, ""int"") + (i & 1 ? yoff : xoff), lines, 4 * i++, ""int"") }   DrawLinesToLayeredWindow( ByRef lines, cnt, hwnd, hdc, gfx, live = 0, color = 0xFF009900, lnw = 1 ) { 	cnt *= 4 	i := 0 	pPen := Gdip_CreatePen(color, 1) 	while i < cnt 	{ 		Gdip_DrawLine(gfx, pPen 			, NumGet(lines, 4 * i++, ""int"") 			, NumGet(lines, 4 * i++, ""int"") 			, NumGet(lines, 4 * i++, ""int"") 			, NumGet(lines, 4 * i++, ""int"")) 	;	if live && !Mod(A_Index, live) 	;		UpdateLayeredWindow(hwnd, hdc) 	} 	Gdip_DeletePen(pPen) }       ; Display functions MakeLayeredWindow( ByRef hwnd, ByRef hdc, ByRef hbm, ByRef obm, ByRef gfx, w, h, bg = 0xFFCCccCC, guiNum = 5 ) { 	w += 1, h += 1 	Gui, %guiNum%:+LastFound +AlwaysOnTop +Owner +E0x80000 -Caption 	Gui, %guiNum%:Show, w%w% h%h% 	OnMessage(0x201, ""WM_LBUTTONDOWN"")   	;gdi 	hwnd := WinExist() 	hdc  := CreateCompatibleDC() 	hbm  := CreateDIBSection(w, h) ;needs to be the same size as gui 	obm  := SelectObject(hdc, hbm) 	gfx  := Gdip_GraphicsFromHDC(hdc)   	;background 	pBr := Gdip_BrushCreateSolid(bg) 	Gdip_FillRoundedRectangle(gfx, pBr, 0, 0, w, h, 3) 	Gdip_DeleteBrush(pBr) } CleanupLayeredWindow( ByRef hwnd, ByRef hdc, ByRef hbm, ByRef obm, ByRef gfx ) { 	SelectObject(hdc, obm), DeleteObject(hbm), DeleteDC(hdc) 	, Gdip_DeleteGraphics(gfx) } WM_LBUTTONDOWN() { ;for dragging the gui 		static mx, my, wx, wy, hwnd 		hwnd := WinExist() 		CoordMode, Mouse, Screen 		mousegetpos, mx, my 		WinGetPos, wx, wy 		settimer, GuiDrag, 10 	return   	GuiDrag: 		CoordMode, Mouse, Screen 		setwindelay, -1 		if !GetKeyState( ""LButton"", ""P"" ) 			settimer, %A_ThisLabel%, Off 		else 		{ 			MouseGetPos, nmx, nmy 			WinMove, ahk_id %hwnd%, , wx + (nmx - mx), wy + (nmy - my) 		} 	return }     ; CX( a, len ) { ;change in x for an angle and length ; 	return cos(a/57.2957795) * len ; } ; CY( a, len ) { ;change in y for an angle and length ; 	return sin(a/57.2957795) * len ; }   ; memory functions ; by infogulch   ;*** ; testing ;	text := ""the quick brown fox jumps over the lazy dog"" ;	a := "" aaa "" ;	VarSetCapacity(text2, StrLen(text), 0) ;	 ;	MemMove(&text2, &text, StrLen(text)+1) ;	VarSetCapacity(text2, -1) ;	MsgBox % ""_"" text ""_`n_"" text2 ""_"" ;	 ;	While 0 != p := MemChr(&text2, Asc( "" "" ), len:=StrLen(text2)) ;		MemDel(text2, len, p-&text2, 1) ;	VarSetCapacity(text2, -1) ;	MsgBox % ""_"" text2 ""_"" ;	 ;	MemAdd(text, StrLen(text), a, StrLen(a)) ;	VarSetCapacity(text, -1) ;	MsgBox % ""_"" text ""_"" ; ;	MemIns(text, StrLen(text), a, StrLen(a), 4) ;	VarSetCapacity(text, -1) ;	MsgBox % ""_"" text ""_"" ;*   ;   Mem() { }   MemDel( ByRef var, varlen, off, b = 1 ) { 	; may need to call VarSetCapacity(var, -1) afterwards for display 	MemMove( &var+off, &var+off+b, varlen-off) } MemIns( ByRef var, varlen, ByRef add, addlen, off ) { 	; may need to call VarSetCapacity(var, -1) afterwards for display 	len := varlen + addlen 	VarSetCapacity(tp, len, 0)       ; create tp 	MemMove( &tp, &var, off )        ; copy beginning of var to tp 	MemMove( &tp+off, &add, addlen ) ; copy add into tp at off 	MemMove( &tp+off+addlen, &var+off, varlen-off) ; copy remaining var to tp 	VarSetCapacity(var, len, 0)      ; resize var 	MemMove( &var, &tp, len )        ; copy finished tp back to var } MemAdd( ByRef var, varlen, ByRef add, addlen ) { 	; may need to call VarSetCapacity(var, -1) afterwards for display 	len := varlen + addlen 	VarSetCapacity(tp, len, 0)          ; setup tp var 	MemMove(&tp, &var, varlen)          ; copy var into tp 	MemMove(&tp + varlen, &add, addlen) ; copy add to end of tp 	VarSetCapacity(var, len, 0)         ; resize var 	MemMove(&var, &tp, len)             ; copy finished tp back to var }   MemPreAlloc( ByRef var, len, add, fillbyte = 0 ) { 	VarSetCapacity(t, len+add, fillbyte) 	MemMove(&t, &var, len) 	VarSetCapacity(var, len+add, 0) 	MemMove(&var, &t, len+add) }   MemChr( ptr, chr, len ) { ;finds chr from ptr through len (char as ascii value) 	; returns pointer 	return DllCall( ""msvcrt\memchr"", ""UInt"", ptr+0, ""Int"", chr & 0xFF, ""Int"", len, ""Cdecl UInt"") } MemMove( dest, src, len ) { 	; may need to call VarSetCapacity(var, -1) afterwards for display 	DllCall( ""msvcrt\memmove"", ""UInt"", dest+0, ""UInt"", src+0, ""Int"", len, ""Cdecl int"" ) } Author: InfoGulch aka InfoG [Emoticon Database] ---> Download the latest version of AutoHotkey from here <--- Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Fun with GDIPlus (GDI+) Report this post Quote 15 Sep 2015, 13:14 @tomoe_uehara: Reminds me of some stuff I did a while ago. I'm not sure where the code went. Spoiler AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: Fun with GDIPlus (GDI+) Report this post Quote 18 Jan 2016, 04:14 Next step will be 3d shooter game with AutoHotkey DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Fun with GDIPlus (GDI+) Report this post Quote 20 Jan 2016, 12:43 There is this https://autohotkey.com/board/topic/6453 ... mo-opengl/ AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: Fun with GDIPlus (GDI+) Report this post Quote 20 Jan 2016, 12:48 Haha yes, that's Uberi for ya Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: Fun with GDIPlus (GDI+) Report this post Quote 20 Jan 2016, 14:32 GeekDude wrote:There is this https://autohotkey.com/board/topic/6453 ... mo-opengl/ Wow! thats nice DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 21 posts 1 2 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 12 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"Interesting GDI+ examples."	"true"
"GUI"	"Examples of Non-Standard GUIs (ActiveX, GDI, etc.)"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=3851"	"Examples of GUIs using non-standard methods to produce beautiful user interfaces."	"null"	"null"	"null"	"null"	"null"	""	"null"	"null"	"null"	"null"	"Examples of Non-Standard GUIs (ActiveX, GDI, etc.) - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:29 All times are UTC-05:00 Examples of Non-Standard GUIs (ActiveX, GDI, etc.) Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 173 posts Page 1 of 9 Jump to page: 1 2 3 4 5 … 9 Next cyruz Posts: 241 Joined: 30 Sep 2013, 13:31 Examples of Non-Standard GUIs (ActiveX, GDI, etc.) Report this post Quote 16 Feb 2014, 05:38 Hi guys, I'm not a GUI freak and sometime I can observe some really nice GUI implementations from community users. I would like we share our most original work so that we can reuse some ideas in ours projects... This is something I did, not so original, but at least not conventional: Image: Spoiler Code: Spoiler Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus Gui, -Caption +Border Gui, Margin, 10, 10   Gui, Add, Text,,                                        URL to save in MHTML: Gui, Add, Edit,   vEdit1  w500 h17      -E0x200 +Border Gui, Add, Text,   vText1  w500          C0000FF,        URL will be saved in <%A_ScriptDir%\url.mht> Gui, Add, Text,   vText2  w250 Gui, Add, Button,         w50  h20 x+35 +0x8000,        Browse Gui, Add, Button,         w50  h20 x+5  +0x8000,        Save Gui, Add, Button,         w50  h20 x+5  +0x8000,        Reset Gui, Add, Button,         w50  h20 x+5  +0x8000,        Close   Gui, Show, AutoSize, MHTML Saver   Last edited by cyruz on 16 Feb 2014, 16:19, edited 1 time in total. ABCza on the old forum. My GitHub. Top kon Posts: 1252 Joined: 29 Sep 2013, 17:11 Re: Alternative GUI styles (please contribute) Report this post Quote 16 Feb 2014, 12:06 This was originally coded by just me in this thread. I've made a couple small changes. I liked the style, so I've used it as a template a couple times. Image: Spoiler Gui Example.png (3.12 KiB) Viewed 11240 times Code: Spoiler Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; http://www.autohotkey.com/board/topic/90723-achieve-rainmeter-style-gui-via-gdip-library/?p=573445 Width := 210 Gui, +LastFound WinSet, Transparent, 180 Gui, Color, 808080 Gui, Margin, 0, 0 Gui, Font, s11 cD0D0D0 Bold Gui, Add, Progress, % ""x-1 y-1 w"" (Width+2) "" h31 Background404040 Disabled hwndHPROG"" Control, ExStyle, -0x20000, , ahk_id %HPROG% ; propably only needed on Win XP Gui, Add, Text, % ""x0 y0 w"" Width "" h30 BackgroundTrans Center 0x200 gGuiMove vCaption"", Example Gui, Font, s8 Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX1 gGeorge"", George Harrison Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX2 gJohn"", John Lennon Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX3 gPaul"", Paul McCartney Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX4 gRingo"", Ringo Starr Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX5 gClose"", Close Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""h5 vP"" GuiControlGet, P, Pos H := PY + PH Gui, -Caption WinSet, Region, 0-0 w%Width% h%H% r6-6 Gui, Show, % ""w"" Width "" NA"" "" x"" (A_ScreenWidth - Width) "" y150"" WinSet AlwaysOnTop return   GuiMove:    PostMessage, 0xA1, 2 return   George: MsgBox, You clicked George (%A_GuiControl%). return   John: MsgBox, You clicked John (%A_GuiControl%). return   Paul: MsgBox, You clicked Paul (%A_GuiControl%). return   Ringo: MsgBox, You clicked Ringo (%A_GuiControl%). return   Close: ExitApp Edit: Added image. Last edited by kon on 16 Feb 2014, 15:41, edited 2 times in total. Top cyruz Posts: 241 Joined: 30 Sep 2013, 13:31 Re: Alternative GUI styles (please contribute) Report this post Quote 16 Feb 2014, 12:20 kon wrote:This was originally coded by just me in this thread. I've made a couple small changes. I liked the style, so I've used it as a template a couple times. Yesss that fits perfectly what I mean with ""alternative GUI"" Awesome! Last edited by cyruz on 16 Feb 2014, 12:21, edited 1 time in total. ABCza on the old forum. My GitHub. Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: Alternative GUI styles (please contribute) Report this post Quote 16 Feb 2014, 12:21 very impressive! sehr beeindruckend! kon wrote:This was originally coded by just me in this thread. I've made a couple small changes. I liked the style, so I've used it as a template a couple times. Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; http://www.autohotkey.com/board/topic/90723-achieve-rainmeter-style-gui-via-gdip-library/?p=573445 Width := 210 Gui, +LastFound WinSet, Transparent, 180 Gui, Color, 808080 Gui, Margin, 0, 0 Gui, Font, s11 cD0D0D0 Bold Gui, Add, Progress, % ""x-1 y-1 w"" (Width+2) "" h31 Background404040 Disabled hwndHPROG"" Control, ExStyle, -0x20000, , ahk_id %HPROG% ; propably only needed on Win XP Gui, Add, Text, % ""x0 y0 w"" Width "" h30 BackgroundTrans Center 0x200 gGuiMove vCaption"", Example Gui, Font, s8 Gui, Add, Text, x7 y+10 w196 r1 +0x4000 vTX1 gGeorge, George Harrison Gui, Add, Text, x7 y+10 w196 r1 +0x4000 vTX2 gJohn, John Lennon Gui, Add, Text, x7 y+10 w196 r1 +0x4000 vTX3 gPaul, Paul McCartney Gui, Add, Text, x7 y+10 w196 r1 +0x4000 vTX4 gRingo, Ringo Starr Gui, Add, Text, x7 y+10 w196 r1 +0x4000 vTX5 gClose, Close Gui, Add, Text, x7 y+10 w196 h5 vP GuiControlGet, P, Pos H := PY + PH Gui, -Caption WinSet, Region, 0-0 w%Width% h%H% r6-6 Gui, Show, % ""w"" Width "" NA"" "" x"" (A_ScreenWidth - Width) "" y150"" WinSet AlwaysOnTop return   GuiMove:    PostMessage, 0xA1, 2 return   George: MsgBox, You clicked George (%A_GuiControl%). return   John: MsgBox, You clicked John (%A_GuiControl%). return   Paul: MsgBox, You clicked Paul (%A_GuiControl%). return   Ringo: MsgBox, You clicked Ringo (%A_GuiControl%). return   Close: ExitApp Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: Alternative GUI styles (please contribute) Report this post Quote 16 Feb 2014, 13:37 how can i bring this GUI SMACK to the center of the screen (always and by DEFAULT)? kon wrote:This was originally coded by just me in this thread. I've made a couple small changes. I liked the style, so I've used it as a template a couple times. Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; http://www.autohotkey.com/board/topic/90723-achieve-rainmeter-style-gui-via-gdip-library/?p=573445 Width := 210 Gui, +LastFound WinSet, Transparent, 180 Gui, Color, 808080 Gui, Margin, 0, 0 Gui, Font, s11 cD0D0D0 Bold Gui, Add, Progress, % ""x-1 y-1 w"" (Width+2) "" h31 Background404040 Disabled hwndHPROG"" Control, ExStyle, -0x20000, , ahk_id %HPROG% ; propably only needed on Win XP Gui, Add, Text, % ""x0 y0 w"" Width "" h30 BackgroundTrans Center 0x200 gGuiMove vCaption"", Example Gui, Font, s8 Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX1 gGeorge"", George Harrison Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX2 gJohn"", John Lennon Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX3 gPaul"", Paul McCartney Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX4 gRingo"", Ringo Starr Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX5 gClose"", Close Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""h5 vP"" GuiControlGet, P, Pos H := PY + PH Gui, -Caption WinSet, Region, 0-0 w%Width% h%H% r6-6 Gui, Show, % ""w"" Width "" NA"" "" x"" (A_ScreenWidth - Width) "" y150"" WinSet AlwaysOnTop return   GuiMove:    PostMessage, 0xA1, 2 return   George: MsgBox, You clicked George (%A_GuiControl%). return   John: MsgBox, You clicked John (%A_GuiControl%). return   Paul: MsgBox, You clicked Paul (%A_GuiControl%). return   Ringo: MsgBox, You clicked Ringo (%A_GuiControl%). return   Close: ExitApp Top kon Posts: 1252 Joined: 29 Sep 2013, 17:11 Re: Alternative GUI styles (please contribute) Report this post Quote 16 Feb 2014, 14:01 Guest10 wrote:how can i bring this GUI SMACK to the center of the screen (always and by DEFAULT)? Change this line: Gui, Show, % ""w"" Width "" NA"" "" x"" (A_ScreenWidth - Width) "" y150"" to this: Gui, Show, % ""w"" Width "" NA"" Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: Alternative GUI styles (please contribute) Report this post Quote 16 Feb 2014, 14:31 thanks, it worked! danke, es hat funktioniert! Top Morpheus Posts: 119 Joined: 04 Oct 2013, 05:09 Re: Alternative GUI styles (please contribute) Report this post Quote 16 Feb 2014, 15:18 This is the most complicated GUI I ever created. It's too complicated for me to separate out just the code for the GUI due to function calls, glabels, etc., but I will post the entire code if you want me to. Attachments Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: Alternative GUI styles (please contribute) Report this post Quote 16 Feb 2014, 15:29 yes, please post the code. ja, bitte poste den code. Morpheus wrote:This is the most complicated GUI I ever created. It's too complicated for me to separate out just the code for the GUI due to function calls, glabels, etc., but I will post the entire code if you want me to. Top cyruz Posts: 241 Joined: 30 Sep 2013, 13:31 Re: Alternative GUI styles (please contribute) Report this post Quote 16 Feb 2014, 16:08 Morpheus wrote:This is the most complicated GUI I ever created. It's too complicated for me to separate out just the code for the GUI due to function calls, glabels, etc., but I will post the entire code if you want me to. I'm scared to ask you what it does ABCza on the old forum. My GitHub. Top Morpheus Posts: 119 Joined: 04 Oct 2013, 05:09 Re: Alternative GUI styles (please contribute) Report this post Quote 16 Feb 2014, 16:56 It's complicated to explain if you have no idea what I am talking about, but the app is used to fuzzy match one file name to another. It's purpose is to match pictures and videos to rom names for use in front ends for Emulation, although there may be other uses. It was written in basic. It appears that some of the dll calls don't work properly in version 1.1.14.2. I attached the exe in case the code doesn't work properly for whatever version of AHK you are using. Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #NoTrayIcon #SingleInstance Force #NoEnv #WinActivateForce SetBatchLines, -1 DetectHiddenWindows, On ScriptName := ""Perfect Match"" ScriptIni = %A_ScriptDir%\%ScriptName%.ini SetWorkingDir, %A_ScriptDir% ShowSplash() InitializeVars() CreateGuis() OnMessage(0x47, ""WM_WINDOWPOSCHANGED"") OnMessage(0x112,""WM_SYSCOMMAND"") OnExit, ExitSub Menu, tray, Icon   Sleep, 3000 DllCall(""AnimateWindow"",""UInt"",Splash_ID,""Int"",1000,""UInt"",""0x90000"") ;Gosub, ShowCredits Return   #Include C:\Program Files (x86)\AutoHotkey\Lib\Robert's INI library Basic.ahk #Include C:\Program Files (x86)\AutoHotkey\Lib\UnHtm.ahk #Include C:\Program Files (x86)\AutoHotkey\Lib\Ansi2Unicode.ahk   ;*************************************** Show Splash Screen ****************************************   ShowSplash() {  Global  Gui, 1:Default  Gui, +LastFound  Gui1ID := WinExist()  LV_guiID := Gui1ID  GroupAdd, GuiNum1, ahk_id %Gui1ID%  Gui, 77:Default  Gui, +LastFound  Gui, +Owner1 +ToolWindow  Splash_ID:=WinExist()  Gui, -Caption +AlwaysOnTop +Border  Gui, Add, Picture, w1044 h798, PerfectLogo.jpg  Gui, Show, Hide  DllCall(""AnimateWindow"",""UInt"",Splash_ID,""Int"",250,""UInt"",""0x16"") }   ; ************************************* Initialize Variables ***************************************   InitializeVars() {  Global  Error := RIni_Read(1, ScriptIni)  IniSections := RIni_GetSections(1)  If (Error = -11) OR (IniSections = ""General"") OR (IniSections = """")  {   FileDelete, %ScriptIni%   FileAppend,   (LTrim    [General]    LastProject=Default    HideMessages=    MessageOption=2    MessageTips=0    [Default]    MatchedRoms=    LastRomFolder=    LastArtFolder=    ArtFolderList=    RomExtensions=zip,7z    ArtExtensions=avi,bmp,flv,jpg,jpeg,mpg,mpeg,png,mp4    Recurse=0    MoveFiles=0    RemoveExact=0    Remove99=0    RomSquareBracket=0    RomCurlyBracket=0    RomRoundBracket=0    ArtSquareBracket=0    ArtCurlyBracket=0    ArtRoundBracket=0    RomTrimLeft=0    RomTrimRight=0    ArtTrimLeft=0    ArtTrimRight=0    Regex=[^a-zA-Z0-9& ]    ReplaceLV=vs\versus\X\X|gp\grand prix\X\X|bros\brothers\X\X|one\1\X\X|two\2\X\X|three\3\X\X|four\4\X\X|five\5\X\X|six\6\X\X|seven\7\X\X|eight\8\X\X|nine\9\X\X|Ten\10\X\X|I\1\X\X|II\2\X\X|III\3\X\X|IV\4\X\X|V\5\X\X|VI\6\X\X|VII\7\X\X|VIII\8\X\X|IX\9\X\X|X\10\X\X|VV\55\X\X|A\\X\X|, The\\X\X|The\\X\|   ), %ScriptIni%  }    IniRead, LastProject, %ScriptIni%, General, LastProject, General  IniRead, HideMessages, %ScriptIni%, General, HideMessages  IniRead, MessageOption, %ScriptIni%, General, MessageOption  IniRead, MessageTips, %ScriptIni%, General, MessageTips  Keys := ""MatchedRoms,LastRomFolder,LastArtFolder,ArtFolderList,RomExtensions,ArtExtensions,Recurse,MoveFiles,RemoveExact,Remove99,RomSquareBracket  ,RomCurlyBracket,RomRoundBracket,ArtSquareBracket,ArtCurlyBracket,ArtRoundBracket,RomTrimLeft,RomTrimRight,ArtTrimLeft,ArtTrimRight,Regex,ReplaceLV""  Loop, Parse, Keys, `,    IniRead, %A_LoopField%, %ScriptIni%, %LastProject%, %A_LoopField%, %A_Space%  Loop, 3    MO%A_Index% := A_Index = MessageOption ? 1 : 0  Loop, 2    MT%A_Index% := A_Index = MessageTips ? 1 : 0  SplitPath, LastRomFolder,, OutExt  IllegalChars = \/:?<>*|""  Null =  Stop = 0  RefreshMatchLV = 1  ;Delete Brackets  BracketTypes := ""Round,Square,Curly""  RoundRegex := ""\(.+?\)""  SquareRegex := ""\[.+?]""  CurlyRegex := ""\{.+?}""  ; In Cell Editing  SetControlDelay,0  LV_EnableCVSmode = 0		;makes column headers ""A-Z""  LV_EnableLineNumbers=0	;0 or 1 - add line numbers in column one or not 	-	for in-cell editing  LV_FontSize = 10				;specify font size for listview, static, edit controls	-	for in-cell editing  LV_EnableSingleClick = 1	;whether or not to do cell highlighting on singleclick  LV_EnterRight = 1			;when enter pressed, move cell highlight down or right  LV_AddRowsOnScroll = 0	;if at last row and down arrow is pressed, add rows as needed  LV_AddColsOnScroll = 0		;if at last col and right arrow is pressed, add columns as needed  LV_NewColWidth = 100		;default width for new columns    Message1 := ""`n Settings saved for XXX ""  Message2 := ""`n There are no projects to open. ""  Message3 := ""`n Select a project to open. ""  Message4 := ""`nEither select a project from the list or`ntype a new name into the box. ""  Message5 := ""`n Could not create folder. XXX ""  Message6 := ""`n XXX extensions have not been changed. ""  Message7 := ""`n There are no files with XXX extensions. `n You will need to set extensions to add YYY ""  Message8 := ""`n Use [...] to change primary art folder. ""  Message9 := "" Unable to get Rom names from XXX `n If you are positive that this a rom dat or xml file `n please report this error along with your file. ""  Message10 := ""`n You need to match your files first. ""  Message11 := ""`n You need to select at least one row. ""  Message12 := ""`n You need to select at least one file. ""  Message13 := ""`n You Have Not Set Your XXX Path. ""  Message14 := ""`n No Roms found. Please check for directory and extensions settings ""  Message15 := ""`n It would appear that all of your roms have an art file. ""  Message16 := ""`n XXX has been saved. ""  Message17 := ""`n Settings saved for XXX ""  Message18 := ""`n You need to match your files first. ""  Message19 := ""`n You need to select at least one row. ""  Message20 := ""`n You Have Not Set Your XXX Path. ""  Message21 := ""`n XXX extensions have not been changed. ""  Message22 := ""`n You need to select at least one row. ""  Message23 := ""`n You need to select at least one file. "" }   ;*************************************************************************************************** ;****************************************** Create Gui's ******************************************* ;***************************************************************************************************   CreateGuis() {  Global  Gui, 1:Default  Gui, +OwnDialogs  Gui, Margin, 0, 0  Gui, Color, FBA441, FBA441 ;AC201C  SysGet, CBW, 71  SysGet, CBH, 72  CBW-=2  CBH-=2   ;******************************************* Match Tab *********************************************    Menu, ProjectMenu, Add, Open Project...%A_Tab%Ctrl+O, OpenProject  Menu, ProjectMenu, Add, Save Project%A_Tab%Ctrl+S, SaveProject  Menu, ProjectMenu, Add, Save Project As...%A_Tab%F12, SaveProjectAs  Menu, MyMenuBar, Add, Projects, :ProjectMenu  Menu, MyMenuBar, Add, Messages, MessageSettings ;:SettingsMenu  Menu, MyMenuBar, Add, Credits, ShowCredits  Menu, MyMenuBar, Color, FBA441  Gui, Menu, MyMenuBar    Gui, Add, Tab2, h708 w1010 vCurrentTab gChangeTabs, Settings||Match  Gui, Tab, Match  Gui, Add, Picture, x2 y22 w1006 h685 0x120E hwnddHwnd  Gui, Add, ListView, -ReadOnly x20 y40 r37 w800 +altsubmit vMatchLV gMatchLV_Events, RomName|Suggested ArtWork|Match `%|Hidden|Short Name  LV_ModifyCol(1,363)  LV_ModifyCol(2,363)  LV_ModifyCol(3,53)  LV_ModifyCol(3,""Integer"")  LV_ModifyCol(4,0)  LV_ModifyCol(5,0)    Gui, Add, StatusBar, -Theme BackgroundFBA441 ;FF8040 A04020  SB_SetParts(150)  SB_SetText(""   "" ScriptName "" by Matt McLemore AKA 'Tempest'"", 2)  SB_SetText(""   "" LastProject)    Gui, Add, Button, x860 y110 w100 h30 vB10 gSelectAll, Select &All  Gui, Add, Button, xp y+10 w100 h30 vB11 gSelectNone, Select &None    Gui, Add, Button, xp y+35 w100 h30 vB12 gStartMatch, &Start Match  Gui, Add, Button, xp y+10 w100 h30 vB13 gStopMatch, Stop Match    Gui, Add, Button, xp y+35 w100 h30 vB14 gSearchArt, Search &Art Folder  Gui, Add, Button, xp y+10 w100 h30 vB15 gViewArt, &View Art  Gui, Add, Button, xp y+35 w100 h30 vB16 gMissList, Miss List    Gui, Add, Button, xp y+10 w100 h30 vB17 gRename, Rename  Gui, Add, Button, xp y+35 w100 h30 vB18 gRestart, Start Over    Gui, Add, Button, xp y+10 w100 h30 vB19 gExitSub, Quit   ;****************************************** Settings Tab *******************************************    ;Paths and Extensions  Gui, Tab, Settings  Gui, Add, Picture, x2 y22 w1006 h685 0x120E hwndcHwnd  Gui, Add, Text, BackgroundTrans x20 y40 w87, Rom/dat/xml Path  Gui, Add, Edit, x+10 yp-3 w325 r1 vLastRomFolder, %LastRomFolder%  Gui, Add, Button, x+10 yp-2 w25 vB1 gGetRomFolder, ...  Gui, Add, Text, BackgroundTrans x20 y+15 w87, Rom Extensions  Gui, Add, Edit, x+10 yp-3 w325 vRomExtensions gGuiPreview, %RomExtensions%  Gui, Add, Button, x+10 yp-2 w25 vExtButton gSetRomExtensions, Set  Control_Colors(""ExtButton"", ""Set"", ""0x1C20AC"")    Gui, Add, Text, BackgroundTrans x20 y+15 w87, Rom Preview File  Gui, Add, Edit, x+10 yp-3 w325 vRomPreviewFile gGuiPreview  Gui, Add, Button, x+10 yp-2 w25 vB2 gGetRomPreviewFile, ...    StringTrimLeft, TempVar, ArtFolderList, 1  Gui, Add, Text, BackgroundTrans Section x490 y40 w73, Art Path  Gui, Add, DropDownList, cbFBA441 x+10 yp-3 w325 0x80 vLastArtFolder gSetArtPreview, %TempVar%  Gui, Add, Button, x+10 yp-2 w25 vNewArtFolder gGetArtFolder, ...  Control_Colors(""NewArtFolder"", ""Set"", ""0x1C20AC"")  Gui, Add, Button, x+8 yp w25 vAddArtFolder gGetArtFolder, Add  Control_Colors(""AddArtFolder"", ""Set"", ""0x1C20AC"")  Gui, Add, Button, x+8 yp w25 vDelArtFolder gDelArtFolder, Del  Control_Colors(""DelArtFolder"", ""Set"", ""0x1C20AC"")  Gui, Add, Text, BackgroundTrans xs y+15 w73, Art Extensions  Gui, Add, Edit, x+10 yp-3 w325 vArtExtensions gGuiPreview, %ArtExtensions%  Gui, Add, Button, x+10 yp-2 w25 vB3 gSetArtExtensions, Set    Gui, Add, Text, BackgroundTrans xs y+15 w73, Art Preview File  Gui, Add, Edit, x+10 yp-3 w325 vArtPreviewFile gGuiPreview  Gui, Add, Button, x+10 yp-2 w25 vB4 gGetArtPreviewFile, ...    ;Rom Brackets Options  Gui, Add, GroupBox, Section x25 y145 w250 h180  Gui, Add, Edit, Disabled xp+20 yp w117  Gui, Add, Text, xs+24 yp+3, Delete Brackets (Rom)  Gui, Add, Text, BackgroundTrans xs+20 yp+25, %A_Space%[ ... ]  Gui, Add, Edit, xp+35 yp-3 w30 Number vRomSquareBracket gGuiPreview Limit1  Gui, Add, UpDown, cRed x+5 yp Range-5-5 Wrap, %RomSquareBracket%  Gui, Add, Text, BackgroundTrans x+5 yp+3, Bracket Block  Gui, Add, Text, BackgroundTrans xs+20 yp+30, %A_Space%{ ... }  Gui, Add, Edit, xp+35 yp-3 w30 Number vRomCurlyBracket gGuiPreview Limit1  Gui, Add, UpDown, x+5 yp Range-5-5 Wrap, %RomCurlyBracket%  Gui, Add, Text, BackgroundTrans x+5 yp+3, Bracket Block  Gui, Add, Text, BackgroundTrans xs+20 yp+30, %A_Space%( ... )  Gui, Add, Edit, xp+35 yp-3 w30 Number vRomRoundBracket gGuiPreview Limit1  Gui, Add, UpDown, x+5 yp Range-5-5 Wrap, %RomRoundBracket%  Gui, Add, Text, BackgroundTrans x+5 yp+3, Bracket Block  Gui, Add, Text, BackgroundTrans xs+20 yp+35 w150, Rom Bracket Preview  Gui, Add, Edit, xp yp+20 w210 ReadOnly vRomBracketResult    ;RomTrim  Gui, Add, GroupBox, Section xs yp+47 w250 h155  Gui, Add, Edit, Disabled xp+20 yp w115  Gui, Add, Text, xs+24 yp+3, Trim Characters (Rom)  Gui, Add, Edit, xs+20 yp+25 w30 Number vRomTrimLeft gGuiPreview Limit1  Gui, Add, UpDown, yp Range0-9 Wrap, %RomTrimLeft%  Gui, Add, Text, BackgroundTrans xp+35 yp+3, Left Side  Gui, Add, Edit, xs+20 yp+30 w30 Number vRomTrimRight gGuiPreview Limit1  Gui, Add, UpDown, yp Range0-9 Wrap, %RomTrimRight%  Gui, Add, Text, BackgroundTrans xp+35 yp+3, Right Side  Gui, Add, Text, BackgroundTrans xs+20 yp+35 w150, Rom Trim Preview  Gui, Add, Edit, xp yp+20 w210 ReadOnly vRomTrimResult  Recurse = 0    ;Match Options  Gui, Add, GroupBox, Section xs yp+47 h200 w250  Gui, Add, Edit, Disabled xp+20 yp w78  Gui, Add, Text, xs+24 yp+3, Match Options  Gui, Add, CheckBox, xs+20 yp+30 w%CBW% h%CBH% vRecurse gGuiPreview Checked%Recurse%  Gui, Add, Text, BackgroundTrans x+0 yp, % ""  Scan Rom Sub-Folders""  Gui, Add, CheckBox, xs+20 yp+30 w%CBW% h%CBH% vMoveFiles gGuiPreview Checked%MoveFiles%  Gui, Add, Text, BackgroundTrans x+ yp, % ""  Delete Original Art""  Gui, Add, CheckBox, xs+20 yp+30 w%CBW% h%CBH% vRemoveExact gGuiPreview Checked%RemoveExact%  Gui, Add, Text, BackgroundTrans x+ yp, % ""  Remove 100`% matches from search""  Gui, Add, CheckBox, xs+20 yp+30 w%CBW% h%CBH% vRemove99 Checked%Remove99%  Gui, Add, Text, BackgroundTrans x+ yp, % ""  Remove 99.9`% matches from search""  Gui, Add, Text, BackgroundTrans x-20 y-20 vRegion, Region ; Gui, Add, Text, BackgroundTrans xp yp+30, Match Rom to Art    ;Art Brackets Options  Gui, Add, GroupBox, Section x298 y145 w250 h180  Gui, Add, Edit, Disabled xp+20 yp w107  Gui, Add, Text, xs+24 yp+3, Delete Brackets (Art)  Gui, Add, Text, BackgroundTrans xs+20 yp+25, %A_Space%[ ... ]  Gui, Add, Edit, xp+35 yp-3 w30 Number vArtSquareBracket gGuiPreview Limit1  Gui, Add, UpDown, x+5 yp Range-5-5 Wrap, %ArtSquareBracket%  Gui, Add, Text, BackgroundTrans x+5 yp+3, Bracket Block  Gui, Add, Text, BackgroundTrans xs+20 yp+30, %A_Space%{ ... }  Gui, Add, Edit, xp+35 yp-3 w30 Number vArtCurlyBracket gGuiPreview Limit1  Gui, Add, UpDown, x+5 yp Range-5-5 Wrap, %ArtCurlyBracket%  Gui, Add, Text, BackgroundTrans x+5 yp+3, Bracket Block  Gui, Add, Text, BackgroundTrans xs+20 yp+30, %A_Space%( ... )  Gui, Add, Edit, xp+35 yp-3 w30 Number vArtRoundBracket gGuiPreview Limit1  Gui, Add, UpDown, x+5 yp Range-5-5 Wrap, %ArtRoundBracket%  Gui, Add, Text, BackgroundTrans x+5 yp+3, Bracket Block  Gui, Add, Text, BackgroundTrans xs+20 yp+35 w150, Art Bracket Preview  Gui, Add, Edit, xp yp+20 w210 ReadOnly vArtBracketResult    ;ArtTrim  Gui, Add, GroupBox, xs yp+47 w250 h155  Gui, Add, Edit, Disabled xp+20 yp w105  Gui, Add, Text, xs+24 yp+3, Trim Characters (Art)  Gui, Add, Edit, xs+20 yp+25 w30 Number vArtTrimLeft gGuiPreview Limit1  Gui, Add, UpDown, yp Range0-9 Wrap, %ArtTrimLeft%  Gui, Add, Text, BackgroundTrans xp+35 yp+3, Left Side  Gui, Add, Edit, xs+20 yp+30 w30 Number vArtTrimRight gGuiPreview Limit1  Gui, Add, UpDown, yp Range0-9 Wrap, %ArtTrimRight%  Gui, Add, Text, BackgroundTrans xp+35 yp+3, Right Side  Gui, Add, Text, BackgroundTrans xs+20 yp+35 w150, Art Trim Preview  Gui, Add, Edit, xp yp+20 w210 ReadOnly vArtTrimResult    ; Regex  Gui, Add, GroupBox, xs yp+47 w250 h200  Gui, Add, Edit, Disabled xp+20 yp w82  Gui, Add, Text, xs+24 yp+3 cBlue vRegReplace, Regex Replace  Gui, Font, Norm  Gui, Add, Edit, xp yp+25 w210 gGuiPreview vRegex, %Regex%  Gui, Add, Text, BackgroundTrans xp yp+30 w150, Replacement Text  Gui, Add, Edit, xp yp+15 w210 gGuiPreview vReplaceText  Gui, Add, Text, BackgroundTrans xp yp+30 w150, Regex Preview (Rom)  Gui, Add, Edit, xp yp+15 w210 ReadOnly vRomRegexResult  Gui, Add, Text, BackgroundTrans xp yp+30 w150, Regex Preview (Art)  Gui, Add, Edit, xp yp+15 w210 ReadOnly vArtRegexResult    ;StringReplace  Gui, Add, GroupBox, Section x566 y145 w418 h556  Gui, Add, Edit, Disabled xs+20 yp w73  Gui, Add, Text, xs+24 yp+3, Replace Text  Gui, Add, ListView, xs+20 yp+25 w378 r18 AltSubmit vReplaceLV hwndLV_LView, Search For:|Replace With:|A|W  LV_ModifyCol(1, 162)  LV_ModifyCol(2, 162)  LV_ModifyCol(3, 25)  LV_ModifyCol(4, 25)  Gosub, LoadSRL  Gui, Add, Button, xp y+25 w85 h30 vB5 gAddSRL, Add New  Gui, Add, Button, x+15 yp w85 h30 vB6 gRemoveSRL, Delete  Gui, Add, Button, x+15 yp w85 h30 vB7 gClearSRL, Delete All  Gui, Add, Button, x+15 yp w38 h30 vB8 gMoveUp, /\  Gui, Add, Button, x+2 yp w38 h30 vB9 gMoveDown, \/  Gui, Add, Text, BackgroundTrans xs+20 yp+43 w150, Final Preview (Rom)  Gui, Add, Edit, xp yp+20 w378 ReadOnly vRomReplacementResult  Gui, Add, Text, BackgroundTrans xs+20 yp+43 w150, Final Preview (Art)  Gui, Add, Edit, xp yp+20 w378 ReadOnly vArtReplacementResult  Loop, 19    Control_Colors(""B"" A_Index, ""Set"", ""0x1C20AC"")  Control_Colors(Gui1ID, ""RCB"", 0, 0)  Gui, Show, Hide   ;*************************************** Regex Help (GUI 2) ****************************************    Gui, 2:Default  Gui, +Owner1 +OwnDialogs +Border +0x40000  Gui, Color, AC201C, FBA441  Gui, Font, s10  Gui, Add, Text,x10 y10,  A Perl-Compatible Regular Expression (PCRE) Pattern`n\.*?+[{|()^$ must be preceded by a backslash to be seen as literal.  Gui, Add, Text,y+10 x10, Examples:  Gui, Add, Edit, y+5 x10, 1.  [^a-zA-Z0-9& ] Only match characters a-z, A-Z, 0-9, &, and {space}  Gui, Add, Text, y+5 x30, Before:  'Game_Name!, The'  Gui, Add, Text, y+5 x30, After:       'Game Name The'  Gui, Add, Edit,y+10 x10, 2.  \_.* Matches up to the first _ {Underscore}  Gui, Add, Text, y+5 x30, Before:  'Game_Name!, The'  Gui, Add, Text, y+5 x30, After:       'Game'  Gui, Font, Underline  Gui, Add, Text, y+10 x120 cBlue gLink1 vURL_Link1, (RegEx) - Quick Reference  Gui, Add, Button, Default yp x+100 vClose, Close  GuiControl, Focus, Close  Gui, Font, norm   ;************************************** Search Roms (GUI 3) ****************************************    Gui, 3:Default  Gui, +Owner1 +OwnDialogs +Border +0x40000  Gui, Color, AC201C, FBA441  Gui, +LastFound  Gui3ID := WinExist()  GroupAdd, GuiNum3, ahk_id %Gui3ID%  Gui, Add, ListView, r20 w550 h368 vSearchLV gSearchLV AltSubmit -Hdr +Grid, Search Roms  Gui, Add, CheckBox, x20 y+15 vAnyWhere gSearch, Search anywhere in filename  Gui, Add, Text, x+20 yp, Search  Gui, Add, Edit, x+5 yp-3 w200 Lowercase Limit25 vSearch gSearch  Gui, Add, Button, x+30 yp w70, Close   ;***************************************  Miss List (Gui 4) ****************************************    Gui, 4:Default  Gui, +Owner1 +OwnDialogs +Border +0x40000  Gui, Color, AC201C, FBA441  Gui, Add, Text, r2 w550 vGui4Text  Gui, Add, ListView, r20 w550 h368 -hdr vMissListLV, A  Gui, Add, Button, w70 x400 gSaveList, Save  Gui, Add, Button, x+20 yp w70, Close   ;************************************* Set Extensions (Gui 5) **************************************    Gui, 5:Default  Gui, +Owner1 +OwnDialogs +Border +0x40000  Gui, Color, AC201C, FBA441  Gui, Add, Text, vExtGuiText w150, XXX XXXXXXXXXXX  Gui, Add, ListView, w200 r6 vExtLV checked -hdr, A  Gui, Add, Button, w60 y+10 xp+140, OK  Gui, Show, Hide   ;************************************ Get File/Folder (Gui 6) **************************************    Gui, 6:Default  Gui, +Owner1 +OwnDialogs +Border +0x40000  Gui, Color, AC201C, FBA441  If FoF_ImageListID =  {   FoF_Ext := ""dat,xml"" ; Comma Delimited List of Extensions. Leave Blank If No Filter Is Desired.   Loop, Parse, FoF_Ext, `,     FoF_Text .= FoF_Text = """" ? ""*."" A_LoopField : "",*."" A_LoopField   FoF_ImageListID := IL_Create(10)   Loop 12       IL_Add(FoF_ImageListID, ""shell32.dll"", A_Index)     Gui, +Resize -MaximizeBox -MinimizeBox -SysMenu +AlwaysOnTop   Gui, Add, Text, y10, Folder or File. (%FoF_Text%)   Gui, Add, TreeView, Section r10 w300 vFoF_Tree gFoF_AddChildren AltSubmit -Lines ImageList%FoF_ImageListID%   Gui, Add, Button, x148 y+10 w74 gFoF_OK Default, OK   Gui, Add, Button, x+6 yp w74 gFoF_Cancel, Cancel     FoF_ID := TV_Add(""DeskTop"", 0, ""icon3"")   FoF_AddFilesToTree(A_Desktop, FoF_ID, FoF_ImageListID)   FoF_ID := TV_Add(""Documents"", 0, ""icon4"")   FoF_AddFilesToTree(A_MyDocuments, FoF_ID, FoF_ImageListID)   FoF_ID := TV_Add(""Programs"", 0, ""icon4"")   FoF_AddFilesToTree(A_ProgramFiles, FoF_ID, FoF_ImageListID)   FoF_DriveTypes := ""Fixed,CdRom,Removable""   FoF_IconNumber := ""9,12,7""   StringSplit, FoF_IconNumber, FoF_IconNumber, `,   Loop, Parse, FoF_DriveTypes, `,   {    FoF_IconNumber := FoF_IconNumber%A_Index%    DriveGet, FoF_List, List, %A_LoopField%    Loop, Parse, FoF_List    {     FoF_ID := TV_Add(A_LoopField . "":"", 0, ""Icon"" FoF_IconNumber)     FoF_AddFilesToTree(A_LoopField . "":"", FoF_ID, FoF_ImageListID)    }   }  } ;******************************* Get Preview File From Dat (Gui 7) *********************************    Gui, 7:Default  Gui, +Owner1 +OwnDialogs +Border +0x40000  Gui, Color, AC201C, FBA441  Gui, +Resize -MaximizeBox -MinimizeBox -SysMenu +AlwaysOnTop  Gui, Add, Text, y10  Gui, Add, ListView, Section r10 w300 vRomFromDat gGetRomPreviewFile, File Name  Gui, Add, Button, x148 y+10 w74 Default, OK  Gui, Add, Button, x+6 yp w74, Cancel   ;************************************ Display Messages (Gui 8) *************************************    Gui, 8:Default  Gui, +Owner1 +Border +0x40000 ;+OwnDialogs  Gui, Color, AC201C, FBA441  Gui, Add, Text, BackgroundTrans r5 w220 vGui8Text  Gui, Add, Button, x65 y85 w70 Default vMBoxOK gMBoxOK, OK  Control_Colors(""MBoxOK"", ""Set"", ""0x1C20AC"")  Gui, Add, Button, x+20 yp w70 vMsgCancel gMsgCancel, Cancel  Control_Colors(""MBoxCancel"", ""Set"", ""0x1C20AC"")  Gui, Add, Checkbox, x20 y+15 vHideMessage, Do not show this message again.  Gui, Add, Edit, x10 y10 w50 vMsgNum  GuiControl, Hide, MsgNum   ;************************************** Project Gui (Gui 9) ****************************************    Gui, 9:Default  Gui, +Owner1 +OwnDialogs +Border +0x40000  Gui, Color, AC201C, FBA441  Gui, Add, Text, w300 vProjectText, Open Project  Gui, Add, ListView, r20 w300 r10 AltSubmit -Hdr vProjectsLV gProjectsLV, A  Gui, Add, Text, y+20, Project Name:  Gui, Add, Edit, x+5 yp-3 w228 vProjectEdit  Gui, Add, Button, w70 x150 y+20 vProjectSave, Save  Gui, Add, Button, w70 xp yp vProjectOpen, Open  Gui, Add, Button, x+20 yp w70, Cancel   ;***************************************  BackDrop (Gui10) *****************************************    Gui, 10:Default  Gui, +LastFound  Gui10ID := WinExist()  Gui, -caption +0x40000 +ToolWindow  Gui, Color, Black   ;************************************* Settings Gui (Gui 11) ***************************************    Gui, 11:Default  Gui, +Owner1 +OwnDialogs +Border +0x40000 ; Gui, Color, FBA441, FBA441  Gui, Color, AC201C, FBA441 ; Gui, Add, Picture, x0 y0 w600 h180 0x120E hwnddHwnd  Gui, Add, GroupBox, Section w300 h235  Gui, Add, Edit, Disabled xp+20 yp w117  Gui, Add, Text, xs+24 yp+3, Message Options  Gui, Font, Bold cFBA441  Gui, Add, Text, xs+15 ys+35, Show Messages  Gui, Font, Norm  Gui, Add, Radio, xs+25 y+15 Checked%MO1% vMessageOption, Hide all messsages  Gui, Add, Radio, xs+25 y+15 Checked%MO2%, Show all messages  Gui, Add, Radio, xs+25 y+15 Checked%MO3%, Do Not Show Hidden Messages  Gui, Font, Bold  Gui, Add, Text, xs+15 y+20, Tooltips  Gui, Font, Norm  Gui, Add, Radio, xs+25 y+15 Checked%MT1% vMessageTips, Show hidden messages as Tooltips  Gui, Add, Radio, xs+25 y+15 Checked%MT2%, Show all messages as Tooltips  Gui, Add, CheckBox, xs y+40 vResetMessages, Reset hidden messages  Gui, Font, Norm cBlack  Gui, Add, Button, w70 x150 yp-3, OK  Gui, Add, Button, w70 x+20 yp, Cancel   ;************************************** Credits GUI (Gui 12) ***************************************    CreditsText =  (                     `t       `t`tAuthor:`t Matt McLemore Aka 'Tempest'             `t`t`tFunctions by others:            `t`t`tAddFileIcon() by Icarus        http://www.autohotkey.com/community/viewtopic.php?t=29642             `t`t`tAnsi2Unicode() by Sean       http://www.autohotkey.com/community/viewtopic.php?t=17343             `t`tControl_Colors() by DerRaphael       http://www.autohotkey.com/community/viewtopic.php?p=208290             `t`tCreateGradientBitmap() by Skan       http://www.autohotkey.com/community/viewtopic.php?p=425387             `t`tListview In-Cell Editing by Micahs       `thttp://www.autohotkey.com/forum/topic19929.html             `t`tRobert's INI library Basic by Rseding       `thttp://www.autohotkey.net/~Rseding91/Fast ini library/       `tStdLib Compliant/Basic/RIni.ahk             `t`t`tSetTip() by Micahs       http://www.autohotkey.com/community/viewtopic.php?p=262187             `t`t   UnHtm() by Skan 19-Nov-2009       `t   www.autohotkey.com/forum/topic51342.html                )    WinH = 100          ; Height of GUI  YPos := WinH   ; Bottom of GUI Window  Gui, 12:Default  Gui,  +Owner1 +ToolWindow  Gui, Margin, 0, 0  Gui, Font, Bold s10  Gui, Add, Picture, x0 y0 w600 h180 0x120E hwnddHwnd  Gui, Add, Text, BackgroundTrans vCreditsGui x0 y%YPos% w600, %CreditsText%  Gui, Font, Normal   ;**************************************** Initialize Gui 1 *****************************************    Gui, 1:Default  Gui, Show, Hide Center AutoSize, % ScriptName "" by Matt McLemore AKA 'Tempest'""  Gui, Submit, Hide  DllCall( ""DeleteObject"", UInt,hBMP )  hBMP := GDI_CreateGradientBitmap( 3, ""FBA441"", ""AC201C"", 1024, 768 ) ;""FBA441"", ""AC201C"" ""FF8040"", ""A04020""  DllCall( ""SendMessage"", UInt,cHwnd, UInt,0x172, UInt,0, UInt,hBMP )  DllCall( ""SendMessage"", UInt,dHwnd, UInt,0x172, UInt,0, UInt,hBMP )  GuiControl, Focus, Region  SetPreviewFile(""Rom"", LastRomFolder)  SetPreviewFile(""Art"", LastArtFolder)  ClickLink()  WinGetPos, GuiX, GuiY, GuiW, GuiH, ahk_id%Gui1ID%  GuiW -= 10, GuiH -=10  Gui, 10:Show, x%GuiX% y%Guiy% w%GuiW% h%GuiH%  Gui, 1:Show  InitCellEditing(""ReplaceLV"", ""1"") } ; End Create Gui's   ;******************************************* On Message ********************************************   WM_SYSCOMMAND(wParam) {  Global Gui1ID  If (A_Gui = 1 && wParam = 0xF020) ; SC_MINIMIZE  {    Gui, 10: Hide    Gui, 1: Minimize  }  If (A_Gui = 1 && wParam = 0xF120) ; SC_RESTORE  {   Gui, 1: +AlwaysOnTop   Gui, 1: Restore   Sleep, 10   Gui, 10:Show   Gui, 1: -AlwaysOnTop  } }   WM_WINDOWPOSCHANGED() {  Global Gui1ID, Gui10ID  WinGetPos, GuiX, GuiY,,, ahk_id%Gui1ID%  GuiX -= 6, GuiY -=6  WinMove, ahk_id%Gui10ID%,, %GuiX%, %GuiY% }   ;****************************************** Project Menu *******************************************   OpenProject:  LoadProjectsLV(""Open"") Return   SaveProjectAs: LoadProjectsLV() Return   SaveProject:  IniSave()  MBox(1,LastProject) Return   LoadProjectsLV(Param="""") {  Global IniSections, ProjectsLV  Gui, +Disabled  Gui, 9:Default  Gui, 9:ListView, ProjectsLV  LV_Delete()  Flag = 0  Loop, Parse, IniSections, `,  {   If (A_LoopField <> ""General"")   {    LV_Add("""", A_LoopField)    Flag = 1   }  }  If Flag = 0  {   MBox(2)   Return  }  If Param = Open  {   GuiControl,, ProjectText, Open Project   GuiControl, Hide, ProjectSave   GuiControl, Show, ProjectOpen  }  Else  {   GuiControl,, ProjectText, Save Project as:   GuiControl, Hide, ProjectOpen   GuiControl, Show, ProjectSave  }  Gui, 9:Show,, %ScriptName%  WinGet,  GuiID, ID, A  WinWaitNotActive,  ahk_id %GuiID%  Gui, 1:Default  Gui, -Disabled  Gui, 1:Show }   ;********************************* Project Dialog (Gui 9) Actions **********************************   ProjectsLV: If A_GuiEvent = Normal {  RowNumber := LV_GetNext(0)  If RowNumber <> 0  {   LV_GetText(TempVar, RowNumber)   GuiControl,, ProjectEdit, %TempVar%  } } Return   9ButtonOpen:  GuiControlGet, ProjectEdit  If ProjectEdit =     Mbox(3)  Else  {   LastProject := ProjectEdit   Gui, 9:Hide   Loop, Parse, Keys, `,   {    IniRead, %A_LoopField%, %ScriptIni%, %LastProject%, %A_LoopField%    GuiControl, 1:, %A_LoopField%, % %A_LoopField%   }   GoSub, LoadSRL   SetTip(""Edit1"", LastRomFolder)   SetTip(""ComboBox1"", LastArtFolder)   SB_SetText(""   "" LastProject)  } Return   9ButtonSave:  GuiControlGet, ProjectEdit  If ProjectEdit =     Mbox(4)  Else  {   LastProject := ProjectEdit   If LastProject Not In %IniSections%      IniSections .= "","" LastProject   IniSave()   Gui, 9:Hide   SB_SetText(""   "" LastProject)   MBox(17, LastProject)  } Return   9ButtonCancel: 9GuiClose:  Gui, Hide Return   ;**************************************** Message Options ******************************************   MessageSettings:  Gui, 11:Default  Gui, Show  WinGet,  GuiID, ID, A  WinWaitNotActive,  ahk_id %GuiID% Return   11ButtonOK:  Gui, 11:Submit  If ResetMessages = 1  {   GuiControl,, ResetMessages, 0   HideMessages =  } 11ButtonCancel: 11GuiClose:  Gui, Hide  Gui, 1:Default  Gui, 1:Show Return   ;*********************************** Custom Message Box (Gui 8) ************************************   MBox(MsgNum, Var="""", Cancel=False) {  Global MBoxOK, HideMessages, MessageOption, MessageTips, TipActive, GuiPid  If (MessageOption = 1) OR (GuiPid = """")        ;Hide all messsages     Return  GuiControl, 8:, MsgNum, %MsgNum%  Var1 := ""XXX"", Var2 := ""YYY""  Message := Message%MsgNum%  Loop, Parse, Var, |     StringReplace, Message, Message, % Var%A_Index%, %A_LoopField%, A  Hidden = 0  If MsgNum In %HideMessages%     Hidden = 1  If MessageOption = 2        ;Show all messages  {   If MessageTips = 2         ;Show all Messages as ToolTips   {    Message .= ""`n ""    ToolTip, %Message%,,, 20    TipActive = 1   }   Else If Hidden = 1   {    Message .= ""`n ""    ToolTip, %Message%,,, 20    TipActive = 1   }   Else GoSub, ShowMessage  }  Else If (MessageOption = 3 AND Hidden = 0)  ;Do Not Show Hidden Messages  {   If MessageTips = 2   {    Message .= ""`n ""    ToolTip, %Message%,,, 20    TipActive = 1   }   Else Gosub, ShowMessage  } Return    ShowMessage:   MBoxOK = 1   StringReplace, Message, Message, `n, `n, UseErrorLevel   Loop, % 2 - ErrorLevel     Message := ""`n"" Message   Gui, 8:Default   GuiControl,, Gui8Text, %Message%   If Cancel   {    GuiControl, Show, MsgCancel    GuiControl, Move, MBoxOK, x65   }   Else   {    GuiControl, Hide, MsgCancel    GuiControl, Move, MBoxOK, x155   }   Gui, Show, w232 h155, %ScriptName%   WinGet,  GuiID, ID, A   WinWaitNotActive,  ahk_id %GuiID%  Return }   8GuiClose: MsgCancel:  MBoxOK = 0 MBoxOK:  GuiControlGet, HideMessage  If HideMessage = 1  {   GuiControlGet, MsgNum, 8:   HideMessages .= HideMessages = """" ? MsgNum : "","" MsgNum   Sort, HideMessages, D`, U   GuiControl,, HideMessage, 0  }  Gui, Hide  Gui, 1:Default Return   ;****************************************** GUI Previews *******************************************   GuiPreview:  Gui, Submit, NoHide  MatchedOnce = 0  If (A_GuiControl <> ""RemoveExact"") And (A_GuiControl <> ""Remove99"")  {   RefreshMatchLV = 1   GoSub, StringReplaceInit   GuiPreview(""Art"")   GuiPreview(""Rom"")  } Return   GuiPreview(Type) {  GuiControlGet, Text,, %Type%PreviewFile  If Text = No file found.     Text =  Text := DeleteBrackets(Text,Type)  Text := RemoveSpaces(Text)  GuiControl, 1:, %Type%BracketResult, %Text%  Text := TrimChars(Text,Type)  Text := RemoveSpaces(Text)  GuiControl, 1:, %Type%TrimResult, %Text%  Text := Regex(Text)  Text := RemoveSpaces(Text)  GuiControl, 1:, %Type%RegexResult, %Text%  Text := StringReplacement(Text)  Text := RemoveSpaces(Text)  GuiControl, 1:, %Type%ReplacementResult, %Text% }   ;***************************************** Get Rom Folder ******************************************   GetRomFolder:  GoSub, SelectFileFolder  If FoF_FullPath =     Return  GuiControl,1:, LastRomFolder, %FoF_FullPath%  Flag := SetPreviewFile(""Rom"", FoF_FullPath) Return   SelectFileFolder:  Gui, 6:Default  Gui, Show, h286 w317, Browse For File Or Folder  WinGet,  GuiID, ID, A  WinWaitNotActive,  ahk_id %GuiID% Return   FoF_Cancel: 6GuiClose:  FoF_FullPath = FoF_Ok:  Gui, 6:Hide  Gui, 1:Default Return   ;***************************************************************************************************   FoF_AddChildren:  If A_GuiEvent = Normal  {   FoF_ItemID := A_EventInfo   FoF_ParentID := FoF_ItemID   FoF_FullPath =   Loop   {    TV_GetText(ParentText, FoF_ParentID)    FoF_ParentID := TV_GetParent(FoF_ParentID)    If FoF_ParentID = 0    {     If ParentText = desktop        ParentText = %A_Desktop%     If ParentText = documents        ParentText = %A_MyDocuments%     If ParentText = programs        ParentText = %A_ProgramFiles%     FoF_FullPath = %ParentText%\%FoF_FullPath%     Break    }    Else FoF_FullPath = %ParentText%\%FoF_FullPath%   }   StringReplace, FoF_FullPath, FoF_FullPath, \\ , \   StringRight, FoF_LastChar, FoF_FullPath, 1   If FoF_LastChar = \      StringTrimRight, FoF_FullPath, FoF_FullPath, 1   FoF_AddFilesToTree(FoF_FullPath, FoF_ItemID, FoF_ImageListID, 1)  } Return   FoF_AddFilesToTree(Path, ParentID, FoF_ImageListID, Flag = 0) {  Static TreeMap := ""`n""  Global FoF_Ext  If Flag = 0  {   TreeMap .= ParentID ""`n""   Loop, %Path%\*.*, 1   {    SplitPath, A_LoopFileName,,, FoF_ThisExt    If (FoF_Ext = """") OR InStr(FoF_Ext, FoF_ThisExt)    {     FoF_IconNumber := AddFileIcon(A_LoopFileFullPath, FoF_ImageListID)     ChildID := TV_Add(A_LoopFileName, ParentID , ""Icon"" . FoF_IconNumber)     Loop, %A_LoopFileFullPath%\*.*, 1     {      SplitPath, A_LoopFileName,,, FoF_ThisExt      If (FoF_Ext = """") OR InStr(FoF_Ext, FoF_ThisExt)      {       FoF_IconNumber := AddFileIcon(A_LoopFileFullPath, FoF_ImageListID)       TV_Add(A_LoopFileName, ChildID , ""Icon"" . FoF_IconNumber)      }     }    }   }  }  Else  {   Pos := InStr( TreeMap, ""`n"" ParentID ""`n"" )   If Pos = 0   {    TreeMap .= ParentID ""`n""    ChildID := TV_GetChild(ParentID)    Loop    {     If ChildID = 0        Break     TV_GetText(Dir, ChildID)     Loop, %path%\%Dir%\*.*, 1     {      SplitPath, A_LoopFileName,,, FoF_ThisExt      If (FoF_Ext = """") OR InStr(FoF_Ext, FoF_ThisExt)      {       FoF_IconNumber := AddFileIcon(A_LoopFileFullPath, FoF_ImageListID)       TV_ADD(A_LoopFileName, ChildID , ""Icon"" . FoF_IconNumber)      }     }     ChildID := TV_GetNext(ChildID)    }   }  }  GuiControl, MoveDraw, FoF_Tree }   ;************* By Icarus - http://www.autohotkey.com/community/viewtopic.php?t=29642 ***************   AddFileIcon(File, ImageList) {  VarSetCapacity(Filename, 260)  sfi_size = 352  VarSetCapacity(sfi, sfi_size)    FileName := file  SplitPath, FileName,,, FileExt  If FileExt in EXE,ICO,ANI,CUR  {   ExtID := FileExt   IconNumber = 0  }  Else  {   ExtID = 0   Loop 7   {    StringMid, ExtChar, FileExt, A_Index, 1    If Not ExtChar      Break    ExtID := ExtID | (Asc(ExtChar) << (8 * (A_Index - 1)))   }   IconNumber := IconArray%ExtID%  }    If Not IconNumber  {   If not DllCall(""Shell32\SHGetFileInfoA"", ""str"", FileName, ""uint"", 0, ""str"", sfi, ""uint"", sfi_size, ""uint"", 0x101)     IconNumber = 9999999     Else   {    hIcon = 0    Loop 4    hIcon += *(&sfi + A_Index-1) << 8*(A_Index-1)    IconNumber := DllCall(""ImageList_ReplaceIcon"", ""uint"", imageList, ""int"", -1, ""uint"", hIcon) + 1    DllCall(""DestroyIcon"", ""uint"", hIcon)    IconArray%ExtID% := IconNumber   }  }  Return IconNumber }   ;***************************************** Get Art Folder ******************************************   GetArtFolder:  FileSelectFolder, ArtFolder, *%LastArtFolder%,, Skinny Match - Browse to your Art Folder  If Errorlevel  = 1     Return  GuiControl := A_GuiControl  Flag := SetPreviewFile(""Art"", ArtFolder)  If Flag = 1  {   ControlGet, ArtFolderList, List,, Combobox1   If GuiControl = NewArtFolder      ArtFolderList := ""|"" ArtFolder ""||""   Else   {    StringReplace, ArtFolderList, ArtFolderList, `n, |, A    ArtFolderList := ""|"" ArtFolderList ""|""    IfNotInstring, ArtfolderList, |%Artfolder%|       ArtFolderList .= ArtFolder ""||""    Else       StringReplace, ArtFolderList, ArtFolderList, |%Artfolder%|, |%Artfolder%||   }   GuiControl, 1:, LastArtFolder, %ArtFolderList%   IniWrite, |%ArtFolderList%, %ScriptIni%, %LastProject%, ArtFolderList  } Return   ;*************************************** Delete Art Folder *****************************************   DelArtFolder:  GuiControlGet, ArtFolder,, LastArtFolder  ControlGet, ArtFolderList, List,, Combobox1  IfInString, ArtFolderList, `n  {   StringReplace, ArtFolderList, ArtFolderList, `n, |, A   ArtFolderList := RegexReplace(ArtFolderList, ""^\Q"" ArtFolder ""\E\||\|\Q"" ArtFolder ""\E\||\|\Q"" ArtFolder ""\E$"", ""|"", Count)   ArtFolderList := RegexReplace(ArtFolderList, ""^\||\|$"")   IfInString, ArtFolderList, |     StringReplace, ArtFolderList, ArtFolderList, |, ||   Else ArtFolderList .= ""||""   GuiControl,, LastArtFolder, |%ArtFolderList%   GuiControlGet, ArtFolder,, LastArtFolder   SetPreviewFile(""Art"", ArtFolder)   IniWrite, |%ArtFolderList%, %ScriptIni%, %LastProject%, ArtFolderList  }  Else MBox(8) Return   ;************************************ Set Preview (Automatic) **************************************   SetArtPreview:  GuiControlGet, ArtFolder,, LastArtFolder  SetPreviewFile(""Art"", ArtFolder) Return   SetPreviewFile(Type, Folder) {  Global RefreshMatchLV, Data, ScriptIni, StartPos, LastProject, Needle, DataFileType  Flag = 0  SplitPath, Folder,,, OutExt  If OutExt = ;No extension means user selected a folder  {   GuiControlGet, Extensions, 1:, %Type%Extensions   If Extensions  =      Extensions = *   Recurse = 0   If Type = Rom      GuiControlGet, Recurse, 1:, Recurse   Loop, Parse, Extensions, `,   {    Loop, %Folder%\*.%A_LoopField%, 0, %Recurse%    {     Flag = 1     SplitPath, A_LoopFileName,,,, NameNoExt     If Type = Rom     {      GuiControl, Enable, Recurse      GuiControl, Enable, RomExtensions      GuiControl, Enable, ExtButton     }     Break    }   }   If Flag = 0   {    MBox(7, Extensions ""|"" Folder)    GuiControl,, %Type%PreviewFile, No file found.    Return   }  }  Else  {   FileRead, Data, %Folder%   DataFileType := ""SoftList""   Needle := ""m)^\s*<software name= ?""""(?!.*\[BIOS])(.+?)""""""   StartPos := InStr(Data, ""<softwarelist name="")   If StartPos = 0   {    DataFileType := ""HyperSpinXML""    Needle := ""m)^\s*<game name= ?""""(?!.*\[BIOS])(.+?)""""""    StartPos := InStr(Data, ""<game name="")   }   If StartPos = 0   {    DataFileType := ""CMP""    Needle := ""m)^\s*name ?""""(?!.*\[BIOS])(.+?)""""""    StartPos := InStr(Data, ""game ("")   }   ;\.*?+[{|()^$                                              ;<game name=""Activision Decathlon, The (USA)"">         HyperSpin   ;name ""[BIOS] Atari 5200 (USA)""                        CMP (NoIntro/Tosec) 	;rom ( name ""5200 Menu Program (2003) (PD).a52""        GoodSet 	;<software name=""aeroblst"">                            SoftList 	;	<description>Aero Blasters</description>   If DataFileType = SoftList      Flag := RegExMatch(Data, ""<description>(.+?)</description>"", NameNoExt, StartPos)   Else      Flag := RegExMatch(Data, Needle, NameNoExt, StartPos)   NameNoExt := UnHTM(NameNoExt1)   NameNoExt := UTF82Ansi(NameNoExt)   If (StartPos = 0) OR (Flag = 0)   {    DataFileType =    MBox(9,Folder)    Return   }   GuiControl, Disable, Recurse   GuiControl, Disable, RomExtensions   GuiControl, Disable, ExtButton  }  Class := Type = ""Rom"" ? ""Edit1"" : ""ComboBox1""  SetTip(Class, Folder)  Last%Type%Folder = %Folder%  IniWrite, %Folder%, %ScriptIni%, %LastProject%, Last%Type%Folder  GuiControl, 1:, %Type%PreviewFile, %NameNoExt%  RefreshMatchLV = 1  Return Flag }   ;********************************** Get Preview (User Selected) ************************************   GetRomPreviewFile:  GetPreviewFile(""Rom"") Return   GetArtPreviewFile:  GetPreviewFile(""Art"") Return   GetPreviewFile(Type) {  Global Data, StartPos, Needle, DataFileType  GuiControlGet, Folder, 1:, Last%Type%Folder  SplitPath, Folder,,, OutExt  If OutExt <>  {   Gui, 7:Default   Gui, 7:ListView, RomFromDat   LV_Delete()   Pos := StartPos   Loop   {    If DataFileType = SoftList       Pos := RegExMatch(Data, ""<description>(.+?)</description>"", TempVar, Pos)    Else       Pos := RegExMatch(Data, Needle, TempVar, Pos)    If Pos = 0       Break    Pos += StrLen(TempVar1)    NameNoExt := UnHTM(TempVar1)    NameNoExt := UTF82Ansi(NameNoExt)    LV_ADD("""", NameNoExt)   }  Gui, 7:Show,, %ScriptName%  WinGet,  GuiID, ID, A  WinWaitNotActive,  ahk_id %GuiID%  }  Else  {   GuiControlGet, Extensions, 1:, %Type%Extensions   StringReplace, TempVar, Extensions, `,, `;*., A   If TempVar =      TempVar := ""*""   TempVar = *.%TempVar%   FileSelectFile, PreviewFile,,%Folder%, Select %Type% Preview File, %TempVar%   If PreviewFile <>   {    SplitPath, PreviewFile, Name,, Ext, NameNoExt    GuiControl,, %Type%PreviewFile, %NameNoExt%   }  } }   7ButtonOK:  Gui +OwnDialogs  RowNumber := LV_GetNext()  LV_GetText(NameNoExt, RowNumber)  GuiControl, 1:, RomPreviewFile, %NameNoExt%   7ButtonCancel: 7GuiClose:  Gui, Hide  Gui, 1:Default  Gui, 1:Show Return   ;************************************* Handle Match LV Events ***************************************   MatchLV_Events:  If (A_GuiEvent == ""e"")  {   LV_GetText(NextText, EditRow)   Tooltip   If PrevText <> %NextText%      LV_Modify(EditRow,"""",PrevText,NextText,""Edit"")  }  Else  If (A_GuiEvent == ""E"")  {   EditRow := A_EventInfo   LV_GetText(PrevText, A_EventInfo)   ToolTip,%PrevText%  }  Else If (A_GuiEvent == ""F"")  {   RefreshMatchLV()  }  Else If A_GuiEvent = R  {   RowNumber := A_EventInfo   Goto, SearchArt  }  Else If (A_GuiEvent = ""DoubleClick"")  AND (MatchedOnce = 1)  {   GoSub, ViewArt  }  Else If (A_GuiEvent = ""RightClick"") AND (MatchedOnce = 1)  {   MenuRow := A_EventInfo   Gui, 1:Default   Menu, MyMenu, Add   Menu, MyMenu, DeleteAll   LV_GetText(MatchCount, MenuRow, 4)   Flag = 0   Loop, Parse, AltMatch%MatchCount%, `,   {    Flag = 1    StringSplit, TempVar, A_LoopField, |    MenuItem :=  s_ItemList%TempVar1% A_Tab TempVar2 ""%""    Menu, MyMenu, Add, %MenuItem%, MenuHandler   }   If Flag = 1      Menu, MyMenu, Show  } Return   MenuHandler:  StringSplit, MenuItem, A_ThisMenuItem, %A_Tab%  Gui, 1:ListView, MatchLV  LV_Modify(MenuRow,""-select Col2"",MenuItem1,""Menu"") Return   ;******************************* Refresh Match Lv if Options Change ********************************   RefreshMatchLV() {  Global  If RefreshMatchLV = 1  {   Gui, Submit, NoHide   Gui, 1:Default   Gui, 1:ListView, MatchLV   LV_Delete()   GuiControl, -Redraw, MatchLV   SplitPath, LastRomFolder,,, OutExt   If (OutExt = """")   {    Loop, Parse, RomExtensions, `,    {     Loop, %LastRomFolder%\*.%A_LoopField%, 0, %Recurse%     { ;     MsgBox, %A_LoopFileName%      IfNotInString, A_LoopFileName, [Bios]      {       SplitPath, A_LoopFileName, Name,, Ext, NameNoExt       If NameNoExt Not in %MatchedRoms%          LV_ADD("""", NameNoExt)      }     }    }   }   Else   {    Pos := StartPos    Loop    {     Pos := RegExMatch(Data, Needle , TempVar, Pos)     If Pos = 0        Break     Pos += StrLen(TempVar1)     NameNoExt := UnHTM(TempVar1)     NameNoExt := UTF82Ansi(NameNoExt)     If NameNoExt Not in %MatchedRoms%     {      If DataFileType = SoftList      {       ShortName := NameNoExt       Pos := RegExMatch(Data, ""<description>(.+?)</description>"" , TempVar, Pos)       NameNoExt := UnHTM(TempVar1)       NameNoExt := UTF82Ansi(NameNoExt)       LV_ADD("""", NameNoExt,"""","""","""", ShortName)      }      Else            LV_ADD("""", NameNoExt)     }    }   }   GuiControl, +Redraw, MatchLV   MatchedOnce = 0   Save = 0   RefreshMatchLV = 0  } }   ;*************************************************************************************************** ;********************************** GUI (1) Labels and Hot Keys ************************************ ;***************************************************************************************************   ; Hot Keys  ^Q:: ExitApp #IfWinActive ahk_group GuiNum1    Escape:: GoTo, StopMatch  ^A:: GoTo, Selectall  ^N:: GoTo, SelectNone  ~^V:: GoTo, ViewArt  ^R:: GoTo, SearchArt  F12:: GoTo, SaveProjectAs  ^O:: GoTo, OpenProject  ^S:: GoTo, SaveProject  DEL:: GoTo, HideTip #IfWinActive   HideTip:  If TipActive = 1  {   GuiControlGet, MsgNum, 8:   HideMessages .= HideMessages = """" ? MsgNum : "","" MsgNum   Tooltip,,,, 20  } Return   ChangeTabs:  GuiControlGet, CurrentTab  If CurrentTab = Match     RefreshMatchLV() Return   GuiContextMenu:  If A_GuiControl = RegReplace  {   Gui, 2:Default   Gui, 2:Show,,%ScriptName%  } Return   Restart:  Run, %A_ScriptName%   StopMatch:  GuiControlGet, CurrentTab  If CurrentTab = Match  {   Stop = 1   WinActivate, Matt McLemore  } Return   Selectall:  GuiControlGet, CurrentTab  Gui, 1:ListView, MatchLV  If CurrentTab = Match     LV_Modify(0, ""Select"") Return   SelectNone:  GuiControlGet, CurrentTab  Gui, 1:ListView, MatchLV  If CurrentTab = Match     LV_Modify(0, ""-Select"") Return   ;************************************** View Image - GUI (2) ***************************************   ViewArt:  If (CurrentTab = ""Match"")  {   If MatchedOnce = 0      MBox(10)   Else   {    Gui, ListView, MatchLV    RowNumber := LV_GetNext(0)    If Not RowNumber       MBox(11)    Else    {     GuiControlGet, ArtExtensions     WinGetActiveTitle, Title     RowNumber = 0     While RowNumber := LV_GetNext(RowNumber)     {      Loop, Parse, ArtExtensions, `,      {       LV_GetText(ArtFile, RowNumber, 2)       IfExist %ArtFolder%\%ArtFile%.%A_LoopField%         RunWait, %ArtFolder%\%ArtFile%.%A_LoopField%      }     }    }   }  } Return   ;********************************** Search Art Folder - GUI (3) ************************************   SearchArt:  If (CurrentTab = ""Match"")  {   If MatchedOnce = 0      MBox(18)   Else   {    RefreshMatchLV()    RowNumber := LV_GetNext(0)    If Not RowNumber       MBox(19)    Else    {     LV_GetText(Title,Rownumber)     Gui, 3:Default     Gui, 3:Show,, %Title%     ControlFocus, Edit1, %Title%     GuiControl,, Search, %Null%     LV_Modify( 1, ""Select"")    }   }  } Return   Search:  GuiControlGet, AnyWhere  GuiControlGet, Search  LV_Delete()  GuiControl, -Redraw, SearchLV  Loop, %OrigArtList0%  {   If OrigArtList%A_Index% =      Continue   If AnyWhere = 0   {    StringLeft, SearchText, OrigArtList%A_Index%, StrLen(Search)    If SearchText = %Search%       LV_Add("""", OrigArtList%A_Index%)   }   Else   {    IfInString, OrigArtList%A_Index%, %Search%      LV_Add("""", OrigArtList%A_Index%)   }  }  GuiControl, +Redraw, SearchLV  LV_Modify( 1, ""Select"") Return   ; Accept choice in Search GUI   #IfWinActive ahk_group GuiNum3  Enter::            EventInfo := ""1""   Enter()  Return #IfWinActive   SearchLV:  If(A_GuiEvent = ""Normal"")  {   EventInfo := A_EventInfo   Enter()  } Return   Enter()  {   Global RowNumber, EventInfo   Gui, 3:Default   Lv_GetText(SearchText, EventInfo)   Gui, 3:Hide   Gui, 1:Default   If RowNumber <> 0      LV_Modify( RowNumber, ""Col2"", SearchText,""Search"")   Gui, Show  }   ;************************************* Missing List - GUI (4) **************************************   MissList:  Gui, Submit, NoHide  SaveText=  If % LV_GetCount() = 0     MBox(14)  Else  {   Loop % LV_GetCount()   {    LV_GetText(NameNoExt, A_Index)    IfExist, % ArtFolder . ""\"" . NameNoExt . "".*""      Continue    IfExist, % ArtFolder . ""\Renamed\"" . NameNoExt . "".*""      Continue    SaveText.= NameNoExt . ""`n""   }   If SaveText <>   {    Gui, 4:Default    Gui, ListView, MissListLV    LV_Delete()    GuiControl,, Gui4Text, %ArtFolder%`n%Artfolder%\Renamed    Loop, Parse, SaveText, `n      LV_Add("""", A_LoopField)    Gui, 4:Show,, Roms Without Art   }   Else MBox(15)  } Return   SaveList:  Gui +OwnDialogs  Fileselectfile, savefile, s,,Save As:,*.txt  If ErrorLevel = 0  {   FileDelete, %SaveFile%   Loop, 50   {    Sleep, 50    IfNotExist, %SaveFile%      Break   }   FileAppend, %SaveText%, %SaveFile%   MBox(16, SaveFile)  }  4ButtonClose:  4GuiClose:  Gui, Hide  Gui, 1:Default  Gui, 1:Show Return   ;************************************ Set Extensions - GUI (5) *************************************   SetArtExtensions:  Type  := ""Art""  ControlGet, FolderList, List,, Combobox1  GoTo, ExtLV   SetRomExtensions:  Type  := ""Rom""  GuiControlGet, FolderList,, LastRomFolder   ExtLV:  If Last%Type%Folder =     MBox(20, Type)  Else  {   GuiControlGet, CurrentExt, 1:, %Type%Extensions   StringSplit, Folder, FolderList, `n, `r   If CurrentExt =      CurrentExt = *   Extensions := CurrentExt   Recurse = 0   If Type = Rom      GuiControlGet, Recurse   Loop, %Folder0%   {    Loop, % Folder%A_Index% ""\*.*"",, %Recurse%    {     IfNotInString, Extensions, %A_LoopFileExt%       IF StrLen(A_LoopFileExt) = 3         Extensions .=  "","" A_LoopFileExt    }   }   Sort, Extensions, U D,   StringLower, Extensions, Extensions   Gui, 5:Default   GuiControl,, ExtGuiText, %Type% Extensions:   Gui, ListView, ExtLV   LV_Delete()   Loop, Parse, Extensions, `,   {    If A_LoopField <>    {     If A_LoopField in %CurrentExt%        LV_add(""Check"", A_LoopField)     Else        LV_add("""", A_LoopField)    }   }   Gui, Show,, %ScriptName%   WinGet,  GuiID, ID, A   WinWaitNotActive,  ahk_id %GuiID%  } Return   5ButtonOK:  Extensions =  While RowNumber := LV_GetNext(RowNumber, ""Check"")  {   LV_GetText(Ext, RowNumber, 1)   Extensions .= Ext . "",""  }  Gui, Hide  Gui, 1:Default  StringTrimRight, Extensions, Extensions, 1  If Extensions = %CurrentExt%     MBox(21, Type)  Else  {   GuiControl, 1:, %Type%Extensions, %Extensions%   GuiControlGet, Folder,  1:, Last%Type%Folder   SetPreviewFile(Type, Folder)  } Return   5GuiClose: 3ButtonClose: 3GuiClose: 2ButtonClose:  Gui, Hide  Gui, 1:Default  Gui, 1:Show, Restore Return   ;************************************* Prepare Name For Match **************************************   PrepName4Match(Text, Type, NoSpaces = 0) { ; Gui, Submit, NoHide               ; this and ; GoSub, StringReplaceInit          ; this need to go before the line that calls this function.  OutText =  Loop, Parse, Text, `n  {   TempVar := DeleteBrackets(A_Loopfield, Type)   TempVar := TrimChars(TempVar, Type)   TempVar := Regex(TempVar)   OutText .= StringReplacement(TempVar) ""`n""  }  StringTrimRight, OutText, OutText, 1  If NoSpaces = 1     StringReplace, OutText, OutText, %A_Space%, %Null%, A  Else OutText := RemoveSpaces(OutText)  Return OutText }   ;************************************** Renaming Algorithms ****************************************   DeleteBrackets(Text, Type) {  Global  Loop, Parse, BracketTypes, `,  {   If %Type%%A_LoopField%Bracket <> 0   {    Pos = 1    BracketRegex = %A_LoopField%Regex    Count = %Type%%A_LoopField%Bracket    Limit := ABS(%Count%)    If %Count% < 0    {     Loop, %Limit%     {      Pos := RegexMatch(Text, %BracketRegex%,"""", Pos)      If Pos = 0         Break      Pos++     }    }    Text := RegexReplace(Text, %BracketRegex%, """", """", Limit, Pos)    Text = %Text%   }  }  Return Text }     TrimChars(Text,Type) {  Global ArtTrimLeft, ArtTrimRight, RomTrimLeft, RomTrimRight  TrimRight := Type . ""TrimRight""  TrimLeft := Type . ""TrimLeft""  StringTrimRight, Text, Text, % %TrimRight% + 0  StringTrimLeft, Text, Text, % %TrimLeft% + 0  Return Text }   Regex(Text) {  Global Regex, ReplaceText  If Regex <>  {   TempVar := RegexMatch(Text, ""([\[\{\(].+?[]}\)])"", BracketInfo)   StringReplace, Text, Text, %BracketInfo1%, ¬   StringSplit, Text, Text, ¬   Text1 := RegexReplace(Text1, Regex, ReplaceText)   Text = %Text1%%BracketInfo1%%Text2%  }  Return Text }   StringReplacement(Text) {  Global ReplacementCount, SearchString, ReplaceString, ReplaceWholeWords, ReplaceAll, IllegalChars  Loop, %ReplacementCount%  {   TempText := Text   TempSearchString := SearchString%A_Index%   TempReplaceString := ReplaceString%A_Index%   If ReplaceWholeWords%A_Index%   {    TempText := A_Space . TempText . A_Space    TempSearchString := A_Space . TempSearchString . A_Space    TempReplaceString := A_Space . TempReplaceString . A_Space   }   StringReplace, Text, TempText, %TempSearchString%, %TempReplaceString%, % ReplaceAll%A_Index%  }  Loop, Parse, IllegalChars     StringReplace, Text, Text, %A_loopfield%,, A  Text = %Text%  Return Text }   ;************************************** Remove Extra Spaces ****************************************   RemoveSpaces(Text) {  Loop  {   StringReplace, Text, Text, %A_Space%%A_Space%, %A_Space%, UseErrorLevel   If ErrorLevel = 0      Break  }  Return Text }   ;******************************* String Replacement LV Labels/Subs *********************************   StringReplaceInit:  Gui, 1:ListView, ReplaceLV  ReplacementCount = 0  Loop % LV_GetCount()  {   ReplacementCount := A_Index   LV_GetText(SearchString%A_Index%, A_Index, 1)   LV_GetText(ReplaceString%A_Index%, A_Index, 2)   LV_GetText(TempVar, A_Index, 3)   ReplaceAll%A_Index% := TempVar=X ? 0 : 1   LV_GetText(TempVar, A_Index, 4)   ReplaceWholeWords%A_Index% := TempVar=X ? 0 : 1  } Return   AddSRL:  Gui, 1:ListView, ReplaceLV  LV_ADD()  LV_Modify(LV_GetCount(),""Vis Focus Select"")  LV_mx := lv_lx +12  LV_my := LV_ly + LV_lh - 12  GoSub, DoubleClick Return   RemoveSRL:  Gui, 1:ListView, ReplaceLV  RowNumber := LV_GetNext(0)  IF RowNumber <> 0  {   LV_Delete(RowNumber)   If (LV_GetCount()<18)   {    LV_ModifyCol(1, 162)    LV_ModifyCol(2, 162)   }   Gosub, GuiPreview  } Return   ClearSRL:  Gui, 1:ListView, ReplaceLV  LV_Delete()  LV_ModifyCol(1, 162)  LV_ModifyCol(2, 162)  Gosub, GuiPreview Return   MoveUp: PgUp:  Gui, 1:ListView, ReplaceLV  LV_MoveRow()  Gosub, GuiPreview Return   MoveDown: PgDn:  Gui, 1:ListView, ReplaceLV  LV_MoveRow(false)  Gosub, GuiPreview Return   LV_MoveRow(moveup = true) {  Loop, % (allr := LV_GetCount(""Selected""))     max := LV_GetNext(max)  Loop, %allr%  {   cur := LV_GetNext(cur)   If ((cur = 1 && moveup) || (max = LV_GetCount() && !moveup))      Return   Loop, % (ccnt := LV_GetCount(""Col""))      LV_GetText(col_%A_Index%, cur, A_Index)   LV_Delete(cur), cur := moveup ? cur-1 : cur+1   LV_Insert(cur, ""Select Focus"", col_1)   Loop, %ccnt%      LV_Modify(cur, ""Col"" A_Index, col_%A_Index%), col_%A_Index% := """"  } }   LoadSRL:  Gui, 1:ListView, ReplaceLV  GuiControl, -Redraw, ReplaceLV  LV_Delete()  Loop, Parse, ReplaceLV, |  {   StringSplit, OutArray, A_LoopField, \   If OutArray0      LV_Add("""", OutArray1, OutArray2, OutArray3, OutArray4)  }  If LV_GetCount()> 15  {   LV_ModifyCol(1, 153)   LV_ModifyCol(2, 153)  }  GuiControl, +Redraw, ReplaceLV Return   ;****************************************** StartMatch ******************************************** ;**************** OrigArtList (string)  Contains the list of items to be searched ***************** ;**************************************************************************************************   StartMatch:  Gui, Submit, NoHide  If LastRomFolder =     Gosub, GetRomFolder  If LastRomFolder =    Return  If LastArtFolder =     GoSub, GetArtFolder  If LastArtFolder =     Return  Gui, 1:ListView, MatchLV  If % LV_GetCount(""Selected"") = 0  {   MBox(22)   Return  }    If (LastArtFolder <> PrevArtFolder) ; Shouldn't this IF include everything below it?  {   MatchedOnce = 0   PrevArtFolder := LastArtFolder   SB_SetText(""   Initializing "" LastArtFolder,2)   OrigArtList =   Loop, Parse, ArtExtensions, `,   {    Loop, %LastArtFolder%\*.%A_LoopField%    {     SplitPath, A_LoopFileName, Name,, Ext, NameNoExt     OrigArtList .= NameNoExt . ""`n""    }   }   Sort, OrigArtList, U   OrigArtList := ""`n"" OrigArtList  }    Gosub, StringReplaceInit  MatchCount = 0  StartTime := A_TickCount  Gui, 1:ListView, MatchLV  If MatchedOnce = 0  {   TempArtList := OrigArtList   PreppedArtList := PrepName4Match(TempArtList, ""Art"")   PreppedArtList_NoSpace := PrepName4Match(TempArtList, ""Art"", 1)   StringSplit, TempArtList, TempArtList, `n   RowNumber = 0   While RowNumber := LV_GetNext(RowNumber)    ; 100% Matches   {    LV_GetText(RomName, RowNumber)    SB_SetText(""   Searching for 100% Matches: "" RomName, 2)    IfInString TempArtList, `n%RomName%`n    {     MatchCount++     LV_Modify(RowNumber, ""Col2 -Select"", RomName, ""100%"", MatchCount)     If RemoveExact = 1        StringReplace, OrigArtList, OrigArtList, `n%RomName%`n, `n    }   }   While RowNumber := LV_GetNext(RowNumber)    ; 99.9% Matches   {    LV_GetText(RomName, RowNumber)    SB_SetText(""   Searching for 99.9% Matches: "" RomName, 2)    PreppedRom := PrepName4Match(RomName, ""Rom"")        Pos := InStr(PreppedArtList, ""`n"" PreppedRom ""`n"")    If Pos > 0    {     MatchCount++     TempVar := SubStr(PreppedArtList, 1, Pos)     StringReplace, TempVar, TempVar, `n, `n, UseErrorLevel     Index := ErrorLevel + 1     TempVar := TempArtList%Index%     LV_Modify(RowNumber, ""Col2 -Select"", TempVar, ""99.9%"", MatchCount)     If Remove99 = 1 ;    {        StringReplace, OrigArtList, OrigArtList, % ""`n"" TempVar ""`n"", `n ;       StringReplace, PreppedArtList, PreppedArtList, % ""`n"" PreppedRom ""`n"", `n ;    }    }    Else    {     StringReplace, PreppedRom, PreppedRom, %A_Space%,,A     Pos := InStr(PreppedArtList_NoSpace, ""`n"" PreppedRom ""`n"")      If Pos > 0     {      MatchCount++      TempVar := SubStr(PreppedArtList_NoSpace, 1, Pos)      StringReplace, TempVar, TempVar, `n, `n, UseErrorLevel      Index := ErrorLevel + 1      TempVar := TempArtList%Index%      LV_Modify(RowNumber, ""Col2 -Select"", TempVar, ""99.9%"", MatchCount)      If Remove99 = 1 ;     {       StringReplace, OrigArtList, OrigArtList, % ""`n"" TempVar ""`n"", `n ;      StringReplace, PreppedArtList_NoSpace, PreppedArtList_NoSpace, % ""`n"" PreppedRom ""`n"", `n ;      StringReplace, PreppedArtList, PreppedArtList, % ""`n"" PreppedRom ""`n"", `n ;     }     }    }   }   If Stop = 1   {    Stop = 0    SoundPlay, *64    SB_SetText(""    Matching Stopped by User"", 2)    Return   }  }  MatchedOnce = 1  TempRomList =  TempArtList =  SB_SetText(""   Preparing for Fuzzy Match..."", 2)  s_ItemList := PrepName4Match(OrigArtList, ""Art"")  StringSplit, S_ItemList, S_ItemList, `n  StringSplit, OrigArtList, OrigArtList, `n     ;create array of Trigrams for each word in Search Items  Loop, Parse, s_ItemList, `n  {   Index := A_Index   s_ItemTrigrams%Index% =   s_NumTrigrams%Index% =   StringReplace, TempItem, A_LoopField, %A_Space%,, All   Trigrams := StrLen(TempItem) - 2   Loop, %Trigrams%   {    s_NumTrigrams%Index%++    s_ItemTrigrams%Index% .= SubStr(TempItem,A_Index, 3) . ""`n""   }   StringTrimRight, s_ItemTrigrams%Index%, s_ItemTrigrams%Index%, 1  }    ;Begin Fuzzy Match  RowNumber = 0  While RowNumber := LV_GetNext(RowNumber)  {   LV_GetText(RomName, RowNumber)   SB_SetText(""   Fuzzy Matching: "" RomName, 2)   MatchCount++   m_Length := StrLen(RomName)    ;create List of Trigrams for Match Item   m_NumTrigrams =   m_ItemTrigrams =   StringReplace, TempItem, RomName, %A_Space%,, All   Trigrams := StrLen(TempItem) - 2   Loop, %Trigrams%   {    m_NumTrigrams++    m_ItemTrigrams .= SubStr(TempItem,A_Index, 3) . ""`n""   }   StringTrimRight, m_ItemTrigrams, m_ItemTrigrams, 1     Loop, 7   {    BestIndex%A_Index% = 0    BestFitness%A_Index% = 0   }     Loop, Parse, s_ItemList, `n ;Compare Match Item to Search List   {    If A_LoopField =       Continue    s_ItemIndex := A_Index    SearchItem = %A_LoopField%    s_Length := StrLen(SearchItem)     ;Match #1 Instr() Match    iLength := m_Length < s_Length ? m_Length : s_Length    tLength := m_Length > s_Length ? m_Length : s_Length    TempVar1 := SubStr(SearchItem,1,iLength)    IfInstring, RomName, %TempVar1%    {     TempFitness := Round(iLength / tLength *100)     If TempFitness > %BestFitness1%     {      BestIndex1 := s_ItemIndex      BestFitness1 := TempFitness     }    }   ;Match #2 Instr() Match    TempVar1 := SubStr(RomName,1,iLength)    IfInstring, SearchItem, %TempVar1%    {     TempFitness := Round(iLength / tLength *100)     If TempFitness > %BestFitness2%     {      BestIndex2 := s_ItemIndex      BestFitness2 := TempFitness     }    }    ; Match #3 Greatest number of matching words.    m_Fitness = 0    m_WordCount = 0    TempSearchItem := A_Space . SearchItem . A_Space    Loop, Parse, RomName, %A_Space%    {     m_WordCount++     LoopField := A_Space . A_LoopField . A_Space     IfInString, TempSearchItem, %LoopField%     {      StringReplace, TempSearchItem, TempSearchItem, %LoopField%, %A_Space%      m_Fitness++     }    }      s_Fitness = 0    s_WordCount = 0    TempMatchItem := A_Space . RomName . A_Space    Loop, Parse, SearchItem, %A_Space%    {     s_WordCount++     LoopField := A_Space . A_LoopField . A_Space     IfInString, TempMatchItem, %LoopField%     {      StringReplace, TempMatchItem, TempMatchItem, %LoopField%, %A_Space%      s_Fitness++     }    }    iWordCount := s_WordCount > m_WordCount ? s_WordCount : m_WordCount      m_Fitness := Round(m_Fitness / iWordCount * 100)    If m_Fitness > %BestFitness3%    {       BestIndex3 := s_ItemIndex     BestFitness3 := m_Fitness    }    s_Fitness := Round(s_Fitness / iWordCount * 100)    If s_Fitness > %BestFitness6%    {       BestIndex6 := s_ItemIndex     BestFitness6 := s_Fitness    }    ; Match #4 Greatest number of matching TriGrams.    TempFitness =    sTrigrams := s_ItemTrigrams%A_Index%    mTrigrams := m_ItemTrigrams    If s_NumTrigrams%A_Index% > %m_NumTrigrams%    {     sTrigrams := m_ItemTrigrams     mTrigrams := s_ItemTrigrams%A_Index%    }      Loop, Parse, mTrigrams, `n    {     IfInString, sTrigrams, %A_LoopField%     {      StringReplace, sTrigrams, sTrigrams, %A_LoopField%      TempFitness++     }    }    iTrigrams := m_NumTrigrams > s_NumTrigrams%s_ItemIndex% ? m_NumTrigrams : s_NumTrigrams%s_ItemIndex%    TempFitness := Round(TempFitness / iTrigrams * 100)    If TempFitness > %BestFitness4%    {     BestIndex5 := BestIndex4     BestFitness5 := BestFitness4     BestIndex4 := s_ItemIndex     BestFitness4 := TempFitness    }   }   ; Sort out the best match and alternative matches for context menu   AltMatch%MatchCount% =   Sort()   Loop, 6   {    If BestFitness%A_Index% <> 0    {     IfNotInstring, AltMatch%MatchCount%, % BestIndex%A_Index% . ""|""       AltMatch%MatchCount% .= BestIndex%A_Index% . ""|"" . BestFitness%A_Index% . "",""     If BestFitness%A_Index% > %BestFitness7%     {      BestIndex7 := BestIndex%A_Index%      BestFitness7 := BestFitness%A_Index%     }    }   }   StringTrimRight, AltMatch%MatchCount%, AltMatch%MatchCount%, 1     i_MatchName := ""NO MATCH FOUND""   If BestFitness7 = 100      BestFitness7 = 99.9   If BestFitness7 <> 0     i_MatchName := OrigArtList%BestIndex7%   LV_Modify(RowNumber, ""Col2 -Select"", i_MatchName, BestFitness7 ""%"", MatchCount)   If Stop = 1   {    Stop = 0    SoundPlay, *64    SB_SetText(""    Matching Stopped by User"", 2)    Return   }  }    SoundPlay, *64  ElapsedTime := (A_TickCount - StartTime)/1000  dt = 20000101000000  dt += ElapsedTime, seconds  FormatTime, ElapsedTime, %dt%, H:mm:ss  SB_SetText(""    Matched ""  MatchCount "" Items in "" ElapsedTime "" Seconds"", 2) Return   ;********************************************** Sort ***********************************************   Sort() {  Global  Loop, 5  {   Min := A_Index   Max := A_Index +1   While Max < 7   {    If (BestFitness%Min% < BestFitness%Max%)       Min := Max    Max++   }   Swap(BestFitness%A_Index%,BestFitness%Min%)   Swap(BestIndex%A_Index%,BestIndex%Min%)  } }   Swap(ByRef Old, ByRef New) {  temp := Old  Old := New  New := temp }   ;********************************************* Rename **********************************************   Rename:  Gui +OwnDialogs  If (CurrentTab = ""Match"") AND (MatchedOnce = 1)  {   Gui, 1:ListView, MatchLV   MatchCount = 0   RowNumber = 0   While RowNumber := LV_GetNext(RowNumber)   {    MatchCount++    RowNumber%MatchCount% := RowNumber   }   If MatchCount = 0   {    MBox(23)    Return   }   ControlGet, ArtFolderList, List,, Combobox1   StringReplace, TempVar, ArtFolderList, ||, |, A  ; StringTrimLeft, TempVar, TempVar, 1   StringSplit, Folder, TempVar, |   Loop, %Folder0%   {     IfNotExist, % Folder%A_Index% . ""\Renamed""     {       FileCreateDir, % Folder%A_Index% . ""\Renamed""       If ErrorLevel <> 0          MBox(5, ErrorLevel)     }   }   GuiControl, -Redraw, MatchLV   GuiControlGet, MoveFiles   GuiControlGet, ArtExtensions   Loop %MatchCount%   {    ThisRow := MatchCount - A_Index +1    LV_GetText(OldName, RowNumber%ThisRow%, 2)    If OldName =       Continue    If DataFileType = SoftList       LV_GetText(NewName, RowNumber%ThisRow%, 5)    Else       LV_GetText(NewName, RowNumber%ThisRow%, 1)    SB_SetText("" Renaming: "" OldName, 2)    Loop, %Folder0%    {     Index := A_Index     Loop, Parse, ArtExtensions, `,     {      If MoveFiles = 1         FileMove,  % Folder%Index% ""\"" OldName ""."" A_LoopField, % Folder%Index% ""\Renamed\"" NewName ""."" A_LoopField      Else         FileCopy,  % Folder%Index% ""\"" OldName ""."" A_LoopField, % Folder%Index% ""\Renamed\"" NewName ""."" A_LoopField     }    }    StringReplace, OldName, OldName, `,, |, A    MatchedRoms .= MatchedRoms = """" ? OldName : "","" OldName    LV_Delete(RowNumber%ThisRow%)   }   GuiControl, +Redraw, MatchLV   SoundPlay, *64   SB_SetText("" Renaming Completed."", 2)  }  If MatchedOnce = 0     MBox(10) Return   ;***************************************** Clickable Link ******************************************   ClickLink() {  Global  Process, Exist  GuiPid := ErrorLevel  WinGet, hw_gui, ID, ahk_class AutoHotkeyGUI ahk_pid %GuiPid% ; OnMessage(0x20, ""HandleMessage"") ; OnMessage(0x200, ""HandleMessage"") }   Link1:   Run, http://www.autohotkey.com/docs/misc/RegEx-QuickRef.htm,,, Pid   WinWaitActive, Regular Expressions (RegEx) - Quick Reference   WinWaitNotActive, Regular Expressions (RegEx) - Quick Reference   WinActivate, AHK_Group GuiNum1 Return   HandleMessage(p_w, p_l, p_m, p_hw) {  global   WM_SETCURSOR, WM_MOUSEMOVE,  static   URL_hover, h_cursor_hand, h_old_cursor, CtrlIsURL, LastCtrl  If (p_m = WM_SETCURSOR)  {    If URL_hover      Return, true  }  Else If (p_m = WM_MOUSEMOVE)  {   ; Mouse cursor hovers URL text control   StringLeft, CtrlIsURL, A_GuiControl, 3   If (CtrlIsURL = ""URL"")   {    If URL_hover=    {      Gui, Font, cBlue underline      GuiControl, Font, %A_GuiControl%      LastCtrl = %A_GuiControl%      h_cursor_hand := DllCall(""LoadCursor"", ""uint"", 0, ""uint"", 32649)      URL_hover := true    }                    h_old_cursor := DllCall(""SetCursor"", ""uint"", h_cursor_hand)   }   ; Mouse cursor doesn't hover URL text control   Else   {    If URL_hover    {     Gui, Font, norm cBlue     GuiControl, Font, %LastCtrl%     DllCall(""SetCursor"", ""uint"", h_old_cursor)     URL_hover=    }   }  } } ;****************************************** Show Credits *******************************************   ShowCredits:  Gui, +Disabled  Gui, 12:Default  Gui, Show, w500 h%WinH%, %ScriptName% Credits:  Loop  {   YPos := 0  ; Bottom of GUI Window   Loop   {      YPos--      GuiControl 12:Move, CreditsGui, y%YPos%      GuiControlGet CreditsGui, Pos      If (CreditsGuiY + CreditsGuiH < WinH)         Break      Sleep 50     }  } Return   #IfWinActive, RomData Magician Credits:    Pause::Pause, Toggle, 1 #IfWinActive   12GuiClose:  Gui, 1:Default  Gui, -Disabled  Gui, 12:Hide Return   ;********************************************** Exit ***********************************************   GuiClose: ExitApp   ExitSub:  IniSave() ExitApp   IniSave() {  Global  Gui, 1:Default  Gui, Submit, Nohide  GuiControlGet, ArtFolder,, LastArtFolder  ControlGet, ArtFolderList, List,, Combobox1, ahk_group GuiNum1  TempVar =  Loop, Parse, ArtFolderList, `n  {   IfNotInString, TempVar, %A_LoopField%|   TempVar .= A_LoopField = ArtFolder ? A_LoopField ""||"" : A_LoopField ""|""  }  ArtFolderList := TempVar  Gui, 1:ListView, ReplaceLV  ReplaceLV =  Loop % LV_GetCount()  {   LV_GetText(SearchString, A_Index, 1)   If SearchString <>   {    LV_GetText(ReplaceString, A_Index, 2)    LV_GetText(ReplaceAll, A_Index, 3)    LV_GetText(ReplaceWholeWords, A_Index, 4)    ReplaceLV .= SearchString ""\"" ReplaceString ""\"" ReplaceAll ""\"" ReplaceWholeWords ""|""   }  }  ArtFolderList := ""|"" ArtFolderList  Loop, Parse, Keys, `,  {   LoopField := %A_LoopField%   IniWrite, %LoopField%, %ScriptIni%, %LastProject%, %A_LoopField%  }  IniWrite, %LastProject%, %ScriptIni%, General, LastProject  IniWrite, %HideMessages%, %ScriptIni%, General, HideMessages  IniWrite, %MessageOption%, %ScriptIni%, General, MessageOption  IniWrite, %MessageTips%, %ScriptIni%, General, MessageTips }   ;********************************** Control_Colors by DerRaphael *********************************** ;*************** http://www.autohotkey.com/community/viewtopic.php?p=208290#p208290 ****************   Control_Colors(Hwnd, Msg, wParam, lParam = 0) {    ;Critical      If !(Hwnd+0) {      GuiControlGet, nHwnd, Hwnd, %Hwnd%      Hwnd := nhwnd    }      Static OldWinProc := """"          ; origin Windowprocedure    Static NewWinProc := """"          ; new Windowprocedure    Static SetValue := ""Set""         ; take over Values    Static Register := ""RCB""         ; RegisterCallBack    Static ValueList := """"           ; Values      ; Aufruf als Fensterprozedur?    If (A_EventInfo <> NewWinProc) {       If (Msg = SetValue) {          If (RegExMatch(ValueList, ""m)^"" . (Hwnd +0) . ""\|"")) {             ValueList := RegExReplace(ValueList                                      , ""m)^"" . (Hwnd + 0) . ""\|.*$""                                      , (Hwnd + 0) . ""|""                                      . (wParam + 0) . ""|""                                      . (lParam + 0))          } Else {             ValueList .= (Hwnd + 0) . ""|""                       .  (wParam + 0) . ""|""                       .  (lParam + 0) .  ""`r`n""          }          Return       }       If (Msg = Register) {          If (NewWinProc = """") {             NewWinProc := RegisterCallback(""Control_Colors"","""",4)             OldWinProc := DllCall(""SetWindowLong""                                  , UInt, Hwnd                                  , Int, -4                                  , Int, NewWinProc                                  , UInt)          }          Return       }       Return    }    ; 0x0133 : WM_CTLCOLOREDIT    ; 0x0138 : WM_CTLCOLORSTATIC    If (Msg = 0x0133 Or Msg = 0x0135 Or Msg = 0x0138) {       If (RegExMatch(ValueList, ""m)^""                      . (lParam + 0) . ""\|(?P<BG>\d+)\|(?P<TX>\d+)$""                      , C)) {          DllCall(""SetTextColor"", UInt, wParam, UInt, CTX)          DllCall(""SetBkColor"", UInt, wParam, UInt, CBG)          Return, DllCall(""CreateSolidBrush"", UInt, CBG)       }    }    Return DllCall(""CallWindowProcA""                   , UInt, OldWinProc                   , UInt, Hwnd                   , UInt, Msg                   , UInt, wParam                   , UInt, lParam) }   ;********************************** CreateGradientBitmap By Skan *********************************** ;*************** http://www.autohotkey.com/community/viewtopic.php?p=425387#p425387 ****************   GDI_CreateGradientBitmap( G=3, C1=""ABCDEF"", C2=""123456"", W=256, H=256 ) {  ; Thanks to HotkeyIt : www.autohotkey.com/forum/viewtopic.php?t=37376  ; This post : www.autohotkey.com/forum/viewtopic.php?p=425387#425387  D := ( G := G<1||G>5 ? 3:G ) < 3 ? 2 : 3,  SZ := D*D*4,  VarSetCapacity( B$,40+SZ,0 )  ; Init BITMAPINFOHEADER ( 40 Bytes )  NumPut(SZ,NumPut(0x180001,NumPut(D,NumPut(D,NumPut(40,B$))))+4), C1:=""0x"" C1, C2:=""0x"" C2  ; Dynamic BITMAP Data  _ := G=1 ? NumPut(C1,NumPut(C1,NumPut(C2,NumPut(C2,&B$+40)-1)+1)-1) : G=2 ? NumPut(C2  ,NumPut(C1,NumPut(C2,NumPut(C1,&B$+40)-1)+1)-1) : G=3 ? NumPut(C2,NumPut(C2,NumPut(C2  ,NumPut(C2,NumPut(C1,NumPut(C2,NumPut(C2,NumPut(C2,NumPut(C2,&B$+40)-1)-1)+2)-1)-1)+2)-1)  -1):G=4 ? NumPut(C2,NumPut(C1,NumPut(C2,NumPut(C2,NumPut(C1,NumPut(C2,NumPut(C2,NumPut(C1  ,NumPut(C2,&B$+40)-1)-1)+2)-1)-1)+2)-1)-1) :G=5 ? NumPut(C2,NumPut(C2,NumPut(C2,NumPut(C1  ,NumPut(C1,NumPut(C1,NumPut(C2,NumPut(C2,NumPut(C2,&B$+40)-1)-1)+2)-1)-1)+2)-1)-1) : 0  ; Obtain GDI Bitmap  hBM := DllCall( ""CreateDIBitmap"", UInt, hDC := DllCall( ""GetDC"", UInt,cHwnd   ), UInt,&B$       , Int,6, UInt,&B$+40, UInt,&B$, UInt,1 ), DllCall( ""ReleaseDC"", UInt,hDC )  ; Obtain Resized GDI Bitmap / Obtain a copy with DIB section  hBM := DllCall( ""CopyImage"", UInt,hBM, UInt,0, Int,W, Int,H, UInt,0x8, UInt )  Return DllCall( ""CopyImage"", UInt,hBM, UInt,0, Int,0, Int,0, UInt,0x2000|0x8, UInt ) }   ;******************************* Listview In-Cell Editing by Micahs ******************************** ;************************ http://www.autohotkey.com/forum/topic19929.html **************************   InitCellEditing(LV_lvname, LV_g=1)	;name of control	;LV_g = gui number, default = 1 { 	global 	LVS_SINGLESEL = 0x4							;allow one item to be selected 	LVS_SHOWSELALWAYS = 0x8					;shows selection highlighting even if no focus 	LVS_EX_FULLROWSELECT = LV0x20			;whole row selection 	debounce=0   	LV_listOptions = 		(Join`s LTrim 			+AltSubmit     			NoSort 			-Checked 			+Grid 			+%LVS_EX_FULLROWSELECT% 			+%LVS_SHOWSELALWAYS% 			+%LVS_SINGLESEL% 			+glistClick 		)   	LV_dhw := A_DetectHiddenWindows	;save current state 	DetectHiddenWindows,On ;	Gui,%LV_g%:+LastFound 	Gui,%LV_g%:Default ;	LV_guiID := WinExist()	;get id for gui 	DetectHiddenWindows, %LV_dhw%	;restore original state 	GuiControl, %LV_g%:%LV_listOptions%, %LV_lvname% ;	ControlGet, LV_LView, Hwnd,, %LV_lvname%, ahk_id %LV_guiID% ;~ OutputDebug,%LV_lvname%   ID: %LV_LView%,	on %LV_guiID% 	SysGet,SM_CXVSCROLL,2			;get width of vertical scrollbar 	LVIR_LABEL = 0x0002				;LVM_GETSUBITEMRECT constant - get label info 	LVM_GETITEMCOUNT = 4100		;gets total number of rows 	LVM_SCROLL = 4116					;scrolls the listview 	LVM_GETTOPINDEX = 4135		;gets the first displayed row 	LVM_GETCOUNTPERPAGE = 4136	;gets number of displayed rows 	LVM_GETSUBITEMRECT = 4152	;gets cell width,height,x,y   	Gui, %LV_g%:Add, Edit, x0 y-50 vLV_CellEdit hwndLV_Edit	;make edit control 	Gui, %LV_g%:Add, Text, x0 y-50 vCellHighlight hwndLV_Highlight +Border +BackgroundTrans -Wrap	;make static control 	LV_LV := getClassNN(LV_LView) 	LV_ED := getClassNN(LV_Edit) 	LV_ST := getClassNN(LV_Highlight) 	ControlGetPos,LV_lx,LV_ly,LV_lw,LV_lh,%LV_LV%,ahk_id %LV_guiID%	;get info on listview 	GroupAdd,LV_editKeypress,ahk_id %LV_guiID%	;for ENTER, ESC, and ARROW key handling 	Hotkey, IfWinActive, ahk_group LV_editKeypress	;create hotkeys 		Hotkey,Enter	,EnterPressed 		Hotkey,Esc		,CommandPressed 	Hotkey, IfWinActive   	If(!LV_Getcount()) 	{	    LV_Add() 	} 	;SetTimer, IsScrolling, 350 Return	;end init } 	listClick: 	 If (A_GuiEvent = ""ColClick"") 	 {     GuiControl,1:Hide,%LV_ST%	;hide static control 		GuiControl,1:Hide,%LV_ED%	;hide edit control 	  If A_EventInfo > 2 	  {      ColValue3 := ColValue3 = ""X"" ? """" : ""X""      ColValue4 := ColValue4 = ""X"" ? """" : ""X""      LV_Modify(0, ""Col""A_EventInfo, ColValue%A_EventInfo%) 	  }     Gosub, GuiPreview 	 } 		Else If(A_GuiEvent = ""DoubleClick"") 		{	       CoordMode,MOUSE,RELATIVE 			MouseGetPos,LV_mx,LV_my	;,LV_oID,LV_oCNN 			Gosub doubleclick 		} 		Else If(A_GuiEvent = ""Normal"" and LV_EnableSingleClick) 		{	       CoordMode,MOUSE,RELATIVE 			MouseGetPos,LV_mx,LV_my	;,LV_oID,LV_oCNN 			Gosub singleclick 		} 		Else If A_GuiEvent In D,d,e,S,s,RightClick	;hide edit on these events 		{	       GuiControl,1:Hide,%LV_ST%	;hide static control 			GuiControl,1:Hide,%LV_ED%	;hide edit control ;			GuiControl,+Redraw,ReplaceLV 		} 		Else If(A_GuiEvent = ""K"")	;user started typing 		{	      LV_tmp := RegExReplace(Chr(A_EventInfo),""\W"","""") 			If(LV_tmp) 			{	         VarSetCapacity(LV_XYstruct, 16, 0)	;recreate struct		;get the cell info before edit show 				;InsertInteger(LVIR_LABEL	,LV_XYstruct,0)	;get label info constant 				;InsertInteger(LV_currCol	,LV_XYstruct,4)	;subitem index 				NumPut(LVIR_LABEL, LV_XYstruct, 0)	;get label info constant 				NumPut(LV_currCol, LV_XYstruct, 4)	;subitem index 				SendMessage,LVM_GETSUBITEMRECT,%LV_currRow%,&LV_XYstruct,%LV_LV%,ahk_id %LV_guiID%	;get cell coords 				LV_mx := ExtractInteger(LV_XYstruct,0,4) + LV_lx	;row upperleft x = itempos x + listview x 				LV_my := ExtractInteger(LV_XYstruct,4,4) + LV_ly	;row upperleft y = itempos y + listview y 				Gosub CellInfo 				LV_DispControl := LV_ED	;make edit1 the default control 				LV_spacer = 				Gosub CellReSize 				GuiControl,+Redraw,ReplaceLV	;update the listview 				Gosub CellPosition 				GuiControl,Focus,%LV_DispControl%	;set focus	 				If !GetKeyState(""Shift"") or !GetKeyState(""Shiftlock"",""T"") 				{	          StringLower,LV_tmp, LV_tmp 				} 				GuiControl,1:,%LV_DispControl%,%LV_tmp%	;set the text 				Send,{End} 			} 		} 	Return   	doubleclick: 	  Gosub, CellInfo 		GuiControl,1:Hide,%LV_ED%	;hide edit control 		GuiControl,1:Hide,%LV_ST%	;hide static control 		If(LV_currCol = 1) OR (LV_currCol = 2)	;if not column one 		{	       LV_DispControl := LV_ED		;make edit1 the default control 			LV_spacer = 			Gosub CellReSize 			Gosub CellPosition ;			LV_Modify(LV_currRow, ""Focus Select"") 			GuiControl,1:Focus,%LV_DispControl%	;set focus       LV_Modify(LV_currRow, ""-Focus -Select"")	   			Send,+{End} 			SetTimer,isEditFocused,75	;start edit focus monitor 		} 	Return   	singleclick: 		GuiControl,1:Hide,%LV_ED%	;hide edit control 		GuiControl,1:Hide,%LV_ST%	;hide edit control 		Gosub CellInfo 		If (LV_currCol = 3) OR (LV_currCol = 4)	;if not column one 		{      LV_GetText(Option,LV_currRow,LV_currCol)      Option := Option = ""X"" ? """" : ""X""      LV_Modify(LV_currRow,""Col""LV_currCol,Option)      Gosub, GuiPreview      LV_Modify(LV_currRow, ""Focus Select"")     } 	Return   	;*************************cell size and position stuff****************************** 	CellInfo: 		SendMessage,LVM_GETITEMCOUNT,0,0,%LV_LV%,ahk_id %LV_guiID% 		LV_TotalNumOfRows := ErrorLevel	;get total number of rows 		SendMessage,LVM_GETCOUNTPERPAGE,0,0,%LV_LV%,ahk_id %LV_guiID% 		LV_NumOfRows := ErrorLevel	;get number of displayed rows 		SendMessage,LVM_GETTOPINDEX,0,0,%LV_LV%,ahk_id %LV_guiID% 		LV_topIndex := ErrorLevel	;get first displayed row 		VarSetCapacity(LV_XYstruct, 16, 0)	;create struct 		Loop,%LV_NumOfRows%	;gets the current row, and cell Y,H 		{	       LV_which := LV_topIndex + A_Index - 1	;loop through each displayed row 			NumPut(LVIR_LABEL	,LV_XYstruct,0)	;get label info constant 			NumPut(A_Index - 1	,LV_XYstruct,4)	;subitem index 			SendMessage,LVM_GETSUBITEMRECT,%LV_which%,&LV_XYstruct,%LV_LV%,ahk_id %LV_guiID%	;get cell coords 			LV_RowY  	:= ExtractInteger(LV_XYstruct,4,4) + LV_ly	;row upperleft y = itempos y + listview y 			LV_RowY2 	:= ExtractInteger(LV_XYstruct,12,4) + LV_ly	;row bottomright y2 = itempos y2 + listview y 			LV_currColHeight := LV_RowY2 - LV_RowY ;get cell height 			If(LV_my <= LV_RowY + LV_currColHeight)	;if mouse Y pos less than row pos + height 			{	         LV_currRow 	:= LV_which +1	;1-based current row 				LV_currRow0	:= LV_which		;0-based current row 				Break 			} 		}   		VarSetCapacity(LV_XYstruct, 16, 0)	;create struct 		Loop % LV_GetCount(""Col"")	;gets the current column, and cell X,W 		{ 			NumPut(LVIR_LABEL	,LV_XYstruct,0)	;get label info constant 			NumPut(A_Index - 1	,LV_XYstruct,4)	;subitem index 			SendMessage,LVM_GETSUBITEMRECT,%LV_currRow0%,&LV_XYstruct,%LV_LV%,ahk_id %LV_guiID%	;get cell coords 			LV_RowX 	:= ExtractInteger(LV_XYstruct,0,4) + LV_lx	;row upperleft x = itempos x + listview x 			LV_RowX2 	:= ExtractInteger(LV_XYstruct,8,4) + LV_lx	;row bottomright x2 = itempos x2 + listview x 			LV_currColWidth := LV_RowX2 - LV_RowX	;get cell width 			If(LV_mx <= LV_RowX + LV_currColWidth)	;if mouse X pos less than column pos+width 			{	         LV_currCol := A_Index	;get current column number 				Break 			} 		} 	Return   	CellReSize: 		If(LV_RowX < LV_lx)	;make sure the cell is in view, then get the cell x coord again if it wasn't 		{	       LV_hscrollVal := LV_RowX - LV_lx - 4 	;get the difference 			SendMessage,LVM_SCROLL,%LV_hscrollVal%,0,%LV_LV%,ahk_id %LV_guiID%	;scroll the column into view 			VarSetCapacity(LV_XYstruct, 16, 0)	;recreate struct 			NumPut(LVIR_LABEL	,LV_XYstruct,0)	;get just label coords 			NumPut(LV_currCol-1,LV_XYstruct,4)	;0-based subitem index 			SendMessage,LVM_GETSUBITEMRECT,%LV_currRow0%,&LV_XYstruct,%LV_LV%,ahk_id %LV_guiID%	;get cell coords 			LV_RowX := ExtractInteger(LV_XYstruct,0,4) + LV_lx	;row upperleft x = itempos x + listview x 		} 		LV_scrollWidth := LV_TotalNumOfRows > LV_NumOfRows ? SM_CXVSCROLL : 0	;0 if no vscroll, else = SM_CXVSCROLL 		If(LV_RowX+LV_currColWidth > LV_lx+LV_lw-LV_scrollWidth)	;if edit will be too wide, shrink it 		{	      LV_currColWidth -= ((LV_RowX+LV_currColWidth) - (LV_lx+LV_lw-LV_scrollWidth)) + 3 		} 	Return   	CellPosition: 		LV_CellX_LV := LV_currCol									;get cell column 		LV_CellY_LV := LV_currRow								;get cell row 		LV_GetText(LV_coltxt,LV_CellY_LV,LV_CellX_LV)	;get the text 		LV_edW := LV_currColWidth								;get control width 		LV_edH := LV_currColHeight + 1							;get control height 		LV_edX := LV_RowX + 2									;get control x pos 		LV_edY := LV_RowY + 1									;get control y pos 		ControlMove,%LV_DispControl%,LV_edX,LV_edY,LV_edW,LV_edH	;move and size control 		If(LV_DispControl = LV_ED) 		{	      GuiControl,1:,%LV_DispControl%,%LV_coltxt%	;set the text 		} 		GuiControl,1:Show,%LV_DispControl%					;show control 	Return   	CellHide: 		SetTimer,CellHide,Off	;just to let the hotkeys work - can't have hotkeys in a func 		GuiControl,1:Hide, %LV_ED%	;%LV_DispControl% 		LV_Modify(LV_currRow, ""Focus Select"") 	Return 	;*************************end cell size and position stuff******************************   	isEditFocused: 		GuiControlGet,LV_cFoc,Focus 		If(LV_cFoc != LV_DispControl) 		{	       SetTimer,isEditFocused,Off 			Gosub CellHide 		} 	Return   	EnterPressed:	;called from hotkey ""enter"" 	  If CurrentTab = Match 	     Return     Editing = 0  		GuiControlGet,LV_fControl,Focus	;get control with focus 		If(LV_fControl = LV_DispControl)	;if Edit, save any changes 		{	       Editing = 1       Gui,Submit,NoHide 			LV_clickedRow := LV_topIndex + LV_currRow 			LV_CellX_save = Col%LV_CellX_LV%	;save edit contents 			LV_Modify(LV_CellY_LV,LV_CellX_save,LV_CellEdit) 			Gosub CellHide 			LV_fControl := LV_LV 			LV_xChange = 1	;set default values for enter key event 			LV_yChange = 0 		}      GoSub, GuiPreview   		If(LV_fControl = LV_LV)	;listview has focus - arrows or enter pressed 		{	       LV_scrollChange = 0 			SendMessage,LVM_GETITEMCOUNT,0,0,%LV_LV%,ahk_id %LV_guiID% 			LV_TotalNumOfRows := ErrorLevel	;get total number of rows 			LV_TotalNumOfCols := LV_GetCount(""Column"")-1	;get total number of columns   			GuiControl,1:Hide,%LV_ST%	;hide static control to avoid artifacts   			LV_RowTmp := LV_currRow + LV_yChange < 1 ? 1 : LV_currRow + LV_yChange	;can't be less than one (up-down) 			LV_ColTmp := LV_currCol + LV_xChange < 1 ? 1 : LV_currCol + LV_xChange	;can't be less than two (left-right)   			LV_Modify(LV_RowTmp, ""Focus Select"")	;select new row 			VarSetCapacity(LV_XYstruct, 16, 0)	;recreate struct 			NumPut(LVIR_LABEL	,LV_XYstruct,0)	;get label info constant 			NumPut(LV_ColTmp	,LV_XYstruct,4)	;subitem index 			SendMessage,LVM_GETSUBITEMRECT,%LV_RowTmp%,&LV_XYstruct,%LV_LV%,ahk_id %LV_guiID%	;get cell coords 			LV_mx := ExtractInteger(LV_XYstruct,0,4) + LV_lx		;row upperleft x = itempos x + listview x 			LV_my := ExtractInteger(LV_XYstruct,4,4) + LV_ly	;row upperleft y = itempos y + listview y 			Gosub CellInfo   			;after all this must get cellinfo again if changed! 			If(LV_scrollChange)	;if listview scroll value changed, recalc cell pos 			{	         VarSetCapacity(LV_XYstruct, 16, 0)	;recreate struct		;get the cell info again after any changes 				NumPut(LVIR_LABEL	,LV_XYstruct,0)	;get label info constant 				NumPut(LV_ColTmp	,LV_XYstruct,4)	;subitem index 				SendMessage,LVM_GETSUBITEMRECT,%LV_currRow%,&LV_XYstruct,%LV_LV%,ahk_id %LV_guiID%	;get cell coords 				LV_mx := ExtractInteger(LV_XYstruct,0,4) + LV_lx	;row upperleft x = itempos x + listview x 				LV_my := ExtractInteger(LV_XYstruct,4,4) + LV_ly	;row upperleft y = itempos y + listview y 				Gosub CellInfo 			}       Keywait, Enter 			If(LV_currCol = 2) 			{         LV_DispControl := LV_ED	;make edit1 the default control 				LV_spacer = %A_Space% 				Gosub CellReSize 				Gosub CellPosition 				GuiControl,Focus,%LV_DispControl%	 				LV_Modify(LV_currRow, ""-Focus -Select"") 				Send,+{End} 			  SetTimer,isEditFocused,75 			} 		} 	Return   	CommandPressed: 		If(A_ThisHotkey=""Esc"") AND (CurrentTab <> ""Match"") 		{	       Gosub CellHide	;cancel 			GuiControl,1:Show,%LV_ST% 		} 	Return     getClassNN(kID,kTxt=0,g=1)	;kID = control Hwnd	;kTxt = control text, default=0	;g = gui number, default=1 { 	Gui,%g%:+LastFound 	guiID := WinExist()	;get the id for the gui 	If(kTxt) and (!kID)	;don't do this if the id is provided 	{	     mm := A_TitleMatchMode 		SetTitleMatchMode,3	;exact match only 		ControlGet,o,hWnd,,%kTxt%,ahk_id %guiID%	;get the id 		SetTitleMatchMode,%mm%	;restore previous setting 		If(o)	;found match 		{	      kID := o	;set sought-after id 		} 	} 	WinGet, controls, ControlList, ahk_id %guiID% 	Loop, Parse, controls, `n 	{	     ControlGet,o,hWnd,,%A_LoopField%,ahk_id %guiID%	;get the id 		If(o = kID)	;found it 		{	      Return A_Loopfield	;return the classnn 		} 	} }   InsertInteger(pInteger, ByRef pDest, pOffset = 0, pSize = 4) ; The caller must ensure that pDest has sufficient capacity.  To preserve any existing contents in pDest, ; only pSize number of bytes starting at pOffset are altered in it. { 	Loop %pSize%  ; Copy each byte in the integer into the structure as raw binary data. 	{	     ;DllCall(""RtlFillMemory"", ""UInt"", &pDest + pOffset + A_Index-1, ""UInt"", 1, ""UChar"", pInteger >> 8*(A_Index-1) & 0xFF) 		NumPut(pInteger, pDest + A_Index-1, pOffset, ""UChar"") 	} }   ExtractInteger(ByRef pSource, pOffset = 0, pIsSigned = false, pSize = 4) ; pSource is a string (buffer) whose memory area contains a raw/binary integer at pOffset. ; The caller should pass true for pSigned to interpret the result as signed vs. unsigned. ; pSize is the size of PSource's integer in bytes (e.g. 4 bytes for a DWORD or Int). ; pSource must be ByRef to avoid corruption during the formal-to-actual copying process ; (since pSource might contain valid data beyond its first binary zero). {     Loop %pSize%  ; Build the integer by adding up its bytes.         result += *(&pSource + pOffset + A_Index-1) << 8*(A_Index-1)     if (!pIsSigned OR pSize > 4 OR result < 0x80000000)         return result  ; Signed vs. unsigned doesn't matter in these cases.     ; Otherwise, convert the value (now known to be 32-bit) to its signed counterpart:     return -(0xFFFFFFFF - result + 1) }     ;***** Tooltip by Micahs - http://www.autohotkey.com/community/viewtopic.php?p=262187#p262187 ******   /* 	tooltipV2.ahk 	Version: 1.2 	By: Micahs   	CallWith: (You can use Hwnd, var, text, classnn) 	setTip(""Button1"", ""This button does absolutely nothing."")   ;using the classnn 	setTip(""Ok"", ""Begin the Process"")   ;using the caption 	setTip(""Cancel"", ""Cancel Whatever is Happening!"") 	setTip(DDL, ""Dropdownlist"")   ;using the variable 	setTip(MYEdit, ""The infamous edit control"")   ;using the hwnd */   SetTip(tipControl, tipText, guiNum=1)   ;tipControl - text,variable,hwnd,classnn ;   tipText - text to display ;   gui number, default is 1 { 	global 	local List_ClassNN 	Gui,%guiNum%:Submit,NoHide 	Gui,%guiNum%:+LastFound 	WinGet, tipGui_guiID, ID 	WinGet, List_ClassNN, ControlList 	StringReplace, List_ClassNN, List_ClassNN, `n, `,, All 	IfInString, tipControl, %List_ClassNN%	;it is a classnn 	{	tipGui_ClassNN := tipControl   ;use it as is 	} 	Else	;must be text/var or ID 	{	tipGui_ClassNN := tipGui_getClassNN(tipControl, guiNum)   ;get the classnn 	} 	tipGui_%guiNum%_%tipGui_ClassNN% := tipText   ;set the tip   	If(!tipGui_Init)	;enable tooltips when the first one is set, but only if TipsState has not been called (either to enable or disable) 	{	TipsState(1) 	} }   TipsState(ShowToolTips) { 	global tipGui_Init 	tipGui_Init = 1	;iniialize this latch 	If(ShowToolTips) 	{	OnMessage(0x200, ""WM_MOUSEMOVE"")   ;enable tips 	} 	Else 	{	OnMessage(0x200, """")   ;disable tips 	} }   WM_MOUSEMOVE() {  global  IfEqual, A_Gui,, Return  MouseGetPos,,,tipGui_outW,tipGui_outC  If(tipGui_outC != tipGui_OLDoutC)  {	tipGui_OLDoutC := tipGui_outC  	ToolTip,,,, 20  	tipGui_counter := A_TickCount + 500  	Loop  	{	 MouseGetPos,,,, tipGui_newC  		IfNotEqual, tipGui_outC, %tipGui_newC%, Return  		tipGui_looper := A_TickCount  		IfGreater, tipGui_looper, %tipGui_counter%, Break  		Sleep, 50  	}  	Gui, %A_Gui%:+LastFound  	tipGui_ID := WinExist()  	SetTimer, tipGui_killTip, 500  	tooltip, % tipGui_%A_Gui%_%tipGui_outC%,,, 20  }  Return    tipGui_killTip:  tipGui_killTipCounter++  MouseGetPos,,, tipGui_outWm  If(tipGui_outWm != tipGui_ID) or (tipGui_killTipCounter >= 8)	;(A_TimeIdle >= 4000)  {	SetTimer, tipGui_killTip, Off  	ToolTip,,,, 20   TipActive = 0  	tipGui_killTipCounter=0  }  Return }   tipGui_getClassNN(tipControl, g=1)   ;tipControl = text/var,Hwnd	;g = gui number, default=1 { 	Gui,%g%:+LastFound 	guiID := WinExist()   ;get the id for the gui 	WinGet, List_controls, ControlList 	StringReplace, List_controls, List_controls, `n, `,, All 	;if id supplied do nothing special 	IfNotInString, tipControl, %List_controls%	;must be the text/var - get the ID 	{	mm := A_TitleMatchMode 		SetTitleMatchMode, 3   ;exact match only 		ControlGet, o, hWnd,, %tipControl%	;get the id 		SetTitleMatchMode, %mm%   ;restore previous setting 		If(o)   ;found match 		{	tipControl := o   ;set sought-after id 		} 	} 	Loop, Parse, List_controls, CSV 	{	ControlGet, o, hWnd,, %A_LoopField%   ;get the id of current classnn 		If(o = tipControl)   ;if it is the one we want 		{	Return A_Loopfield   ;return the classnn 		} 	} } Attachments Perfect Match.03.exe.7z (244.53 KiB) Downloaded 326 times Top Morpheus Posts: 119 Joined: 04 Oct 2013, 05:09 Re: Alternative GUI styles (please contribute) Report this post Quote 16 Feb 2014, 17:03 Here is the description that was posted along with the app at EmuMovies.com Perfect Match is the sequel to Skinny Match New Features include: Perfect Match has the ability to save multiple projects that will allow matching to continue from the point at which the project was previously saved. Perfect Match can rename artwork from .dat files, and .xml files. When using SoftList .xml files, Perfect Match will rename your artwork to the 'Short Name' (See Screen Shots) Instant alternate matches in the match tab using right-click. Additional settings to help with better matching. Messages can be shown normally, as tool tips, or turned off completely. A brief description of the settings tab and matching using Perfect Match Quote The settings tab lets you make adjustments to your rom and artwork names to help with matching. If you have a rom named 123Tempest.rom, and trim 3 characters from the left, when the program starts matching it will use Tempest.rom as the name to use as the match name for the rom. The other side for the Artwork works the same way: If you have an art file named Tempest123.jpg and trim 3 characters from the right, when the program starts matching it will use Tempest.jpg as the name to use for the match name for the Artwork. When you switch to the match tab, and start matching, Tempest123 with be shown as the suggested artwork for the rom Tempest123, with a 99% probability of a match since with the settings that you have chosen, they are seen by the match program as an exact match. If the two file names had actually been an exact match (without applying the settings that you chose) they would have been shown as a 100% match. Given the example above, the match tab would display RomName | Suggested ArtWork | Match% 123Tempest | Tempest123 | 99.9% When you select that row to rename, The ARTWORK would be renamed to 123Tempest. Perfect Match NEVER alters the rom names themselves. You can use the project menu to save a project that you are working on. When you run Perfect Match again, that project will reopen, and everything should be as you left off, including all of the settings, and the Match Tab. You do not have to save a project. Perfect Match will create a default project when first run, and that is the project that will be used unless you save the default project as something else. Perfect Match ALWAYS save your settings for the current project on exit, whether it be the default project, or a project that you have saved. The current project name is shown in the bottom left corner of the GUI as shown in the screenshots as 'Default' I should also mention that you can work with more than one artwork folder at a time. Use the 'add' button to add a second (or third etc...) path. The path that is shown in the box is the 'Primary' path. Artwork in the secondary paths are also renamed at the same time, as long as the names in the primary and secondary folders match EXACTLY. In other words, you should be able to rename your boxes, carts, screenshots, etc all at the same time. Make sure and check out all of the credits by clicking on 'Credits' in the menu Bar. Top cyruz Posts: 241 Joined: 30 Sep 2013, 13:31 Re: Alternative GUI styles (please contribute) Report this post Quote 16 Feb 2014, 17:10 Quite complicated though I like the way you arranged all that fields together! ABCza on the old forum. My GitHub. Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: Alternative GUI styles (please contribute) Report this post Quote 16 Feb 2014, 21:37 i am speechless. Ich bin sprachlos. Top jNizM Posts: 1581 Joined: 30 Sep 2013, 01:33 GitHub: jNizM Location: Germany Re: Alternative GUI styles (please contribute) Report this post Quote 17 Feb 2014, 01:43 AutoHotkey Installer Gui [AHK] 1.1.24.00 x64 Unicode [WIN] 7 Ultimate x64 SP1 | 10 Pro (10.0.10586) x64 Dropbox referrals (earn 500 MB of bonus and support me) Top cyruz Posts: 241 Joined: 30 Sep 2013, 13:31 Re: Alternative GUI styles (please contribute) Report this post Quote 17 Feb 2014, 04:27 jNizM wrote:AutoHotkey Installer Gui Nice, I always used the zip version so I've never seen the Installer GUI. Can you post the source? Last edited by cyruz on 17 Feb 2014, 08:50, edited 1 time in total. ABCza on the old forum. My GitHub. Top jNizM Posts: 1581 Joined: 30 Sep 2013, 01:33 GitHub: jNizM Location: Germany Re: Alternative GUI styles (please contribute) Report this post Quote 17 Feb 2014, 05:47 Source: del Last edited by jNizM on 07 May 2015, 06:11, edited 1 time in total. [AHK] 1.1.24.00 x64 Unicode [WIN] 7 Ultimate x64 SP1 | 10 Pro (10.0.10586) x64 Dropbox referrals (earn 500 MB of bonus and support me) Top Blackholyman Posts: 928 Joined: 29 Sep 2013, 22:57 Facebook: socialjsz Google: +Jszapp Location: Denmark Contact: Contact Blackholyman Website Twitter YouTube Re: Alternative GUI styles (please contribute) Report this post Quote 17 Feb 2014, 05:53 I made this sometime back but never really used it for anything. But I liked the idea, so I've kept it as a template for later use. Image: Spoiler Code: Spoiler Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus OnMessage(0x201, ""OnMouseDown"") VarSetCapacity(TME,16,0), NumPut(16,TME,0), NumPut(2,TME,4), NumPut(Gui1,TME,8) ; TME is a Track Mouse Event Structure. onexit exit_   Guis := {} goUp := {} goDown := {} Active := {}   sFile1   := ""Cow.png"" sFile2   := ""rCow.png""   pToken    := Gdip_Startup()   settimer, gOver, 10 settimer, gOff, 10   DrawPic(""gui1"", 400, 300, 300, 300, sFile1, sFile2, ""myFunc"") DrawPic(""gui2"", 450, 300, 300, 300, ""dove.png"", ""rdove.png"", ""birdfunc"") DrawPic(""gui3"", 500, 300, 300, 300, ""fish.png"", ""rFish.png"", ""theFunc"") return     DrawPic(GuiName, X, Y, W, H, fImageFile, bImageFile, FunctionName=0) { global Guis, goUp, goDown, Active static hGui, hdc, obm, hbm, pGraphics, FrontImage, BackImage   FrontImage := fImageFile BackImage := bImageFile   Gui, %GuiName%:new Gui, %GuiName%: +LastFound -Caption +E0x80000 +Owner +AlwaysOnTop +hwndhGui Guis[hGui, ""Name""] := GuiName Guis[hGui, ""hwnd""] := hGui Guis[hGui, ""Frontimage""] := FrontImage Guis[hGui, ""BackImage""] := BackImage if IsFunc(FunctionName) 	Guis[hGui, ""Function""] := Func(FunctionName) Guis[GuiName] := hGui   hbm := CreateDIBSection(W,H) hdc := CreateCompatibleDC() obm := SelectObject(hdc, hbm) pGraphics := Gdip_GraphicsFromHDC(hdc) Gui, Show, NoActivate   UpdateLayeredWindow(hGui, hdc,0,0,W,H) WinMove, ahk_id %hGui%,,%X%,%Y%   Gdip_SetCompositingMode(pGraphics,1) pBrush:=Gdip_BrushCreateSolid(0x0000000) Gdip_FillRectangle(pGraphics, pBrush, 0, 0, W, H)   bImage    := Gdip_CreateBitmapFromFile(Guis[hGui].Backimage) pImage    := Gdip_CreateBitmapFromFile(Guis[hGui].FrontImage) nW        := Gdip_GetImageWidth(pImage) nH        := Gdip_GetImageHeight(pImage)   Gdip_DrawImage(pGraphics, pImage, 0, 0, nW, nH) UpdateLayeredWindow(hGui, hdc)   Gdip_DeleteBrush(pBrush) Gdip_DisposeImage(bImage) Gdip_DisposeImage(pImage) return       gOff: for key, val in goUp { 	Gdip_SetCompositingMode(pGraphics,1) 	pBrush:=Gdip_BrushCreateSolid(0x0000000) 	Gdip_FillRectangle(pGraphics, pBrush, 0, 0, nW, nH)   	bImage    := Gdip_CreateBitmapFromFile(Guis[key].Backimage) 	pImage    := Gdip_CreateBitmapFromFile(Guis[key].Frontimage) 	nW        := Gdip_GetImageWidth(pImage) 	nH        := Gdip_GetImageHeight(pImage)   	if (goUp[key].oH >= nH) 	{ 		goUp.remove(key) 		Gdip_DrawImage(pGraphics, pImage, 0, 0, nW, nH) 	} 	else 	{ 		goUp[key].oH+=10 		Gdip_DrawImage(pGraphics, bImage, 0, 0, nW, nH) 		Gdip_DrawImage(pGraphics, pImage, 0, nH-(goUp[key].oH), nW, (goUp[key].oH)) 	} 	UpdateLayeredWindow(key, hdc)   	Gdip_DeleteBrush(pBrush) 	Gdip_DisposeImage(bImage) 	Gdip_DisposeImage(pImage) } return       gOver: for key, val in goDown { 	Gdip_SetCompositingMode(pGraphics,1) 	pBrush:=Gdip_BrushCreateSolid(0x0000000) 	Gdip_FillRectangle(pGraphics, pBrush, 0, 0, nW, nH)   	bImage    := Gdip_CreateBitmapFromFile(Guis[key].BackImage) 	pImage    := Gdip_CreateBitmapFromFile(Guis[key].Frontimage) 	nW        := Gdip_GetImageWidth(bImage) 	nH        := Gdip_GetImageHeight(bImage)   	if (goDown[key].sH >= nH) 	{ 		goDown.remove(key) 		Gdip_DrawImage(pGraphics, bImage, 0, 0, nW, nH) 	} 	else 	{ 		goDown[key].sH+=10 		Gdip_DrawImage(pGraphics, bImage, 0, 0, nW, nH) 		Gdip_DrawImage(pGraphics, pImage, 0, (goDown[key].sH)>nH ? nH : (goDown[key].sH) , nW, nH-(goDown[key].sH)) 	} 	UpdateLayeredWindow(key, hdc)     	Gdip_DeleteBrush(pBrush) 	Gdip_DisposeImage(bImage) 	Gdip_DisposeImage(pImage) } return       }   !v::listvars   esc:: exit_: GuiClose: SelectObject(hdc, obm) DeleteObject(hbm) DeleteDC(hdc) Gdip_DeleteGraphics(pGraphics) Gdip_Shutdown(pToken) ExitApp     OnMouseMove(wParam, lParam, Msg, hwnd) { 	global t_hwnd, goDown, Guis, TME, Active 	if (t_hwnd != hwnd) 	;~ if !active.haskey(hwnd) 	{ 		if !goDown.haskey(hwnd) 		{ 			goDown[hwnd, ""hwnd""] := hwnd 			goDown[hwnd, ""sW""] := 0 			goDown[hwnd, ""sH""] := 0 		} 		t_hwnd := hwnd 		;~ Active[hwnd] := true 		if (hwnd = Guis[hwnd].hwnd) 		{ 			NumPut(hwnd,TME,8) 			DllCall(""TrackMouseEvent"", ""uint"", &TME) 			OnMessage(0x2A3, ""OnMouseLeave"") 		} 	} }   OnMouseLeave(wParam, lParam, Msg, hwnd) { 	global hGui, goUp, t_hwnd, Active   	if !goUp.haskey(hwnd) 	{ 		goUp[hwnd, ""hwnd""] := hwnd 		goUp[hwnd, ""oW""] := 0 		goUp[hwnd, ""oH""] := 0 	} 	t_hwnd := """" }     OnMouseDown(wParam, lParam, Msg, hwnd) { 	global Guis 	if Guis.haskey(hwnd) 		Guis[hwnd].function.() }     Myfunc() { 	msgbox, Hallo world! }   birdfunc() { 	msgbox, You clicked bird! }   thefunc() { 	msgbox, Foo bar! } Last edited by Blackholyman on 26 Jul 2014, 21:46, edited 1 time in total. Top cyruz Posts: 241 Joined: 30 Sep 2013, 13:31 Re: Alternative GUI styles (please contribute) Report this post Quote 17 Feb 2014, 08:50 Blackholyman wrote:I made a this sometime back but never really used it for anything yet. I liked the idea, so I've kept it as a template for later use... Very nice! Can be useful ABCza on the old forum. My GitHub. Top tmplinshi Posts: 836 Joined: 01 Oct 2013, 14:57 Re: Alternative GUI styles (please contribute) Report this post Quote 17 Feb 2014, 09:52 kon wrote:This was originally coded by just me in this thread. I've made a couple small changes. I liked the style, so I've used it as a template a couple times. Image: Spoiler Gui Example.png Code: Spoiler Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; http://www.autohotkey.com/board/topic/90723-achieve-rainmeter-style-gui-via-gdip-library/?p=573445 Width := 210 Gui, +LastFound WinSet, Transparent, 180 Gui, Color, 808080 Gui, Margin, 0, 0 Gui, Font, s11 cD0D0D0 Bold Gui, Add, Progress, % ""x-1 y-1 w"" (Width+2) "" h31 Background404040 Disabled hwndHPROG"" Control, ExStyle, -0x20000, , ahk_id %HPROG% ; propably only needed on Win XP Gui, Add, Text, % ""x0 y0 w"" Width "" h30 BackgroundTrans Center 0x200 gGuiMove vCaption"", Example Gui, Font, s8 Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX1 gGeorge"", George Harrison Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX2 gJohn"", John Lennon Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX3 gPaul"", Paul McCartney Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX4 gRingo"", Ringo Starr Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""r1 +0x4000 vTX5 gClose"", Close Gui, Add, Text, % ""x7 y+10 w"" (Width-14) ""h5 vP"" GuiControlGet, P, Pos H := PY + PH Gui, -Caption WinSet, Region, 0-0 w%Width% h%H% r6-6 Gui, Show, % ""w"" Width "" NA"" "" x"" (A_ScreenWidth - Width) "" y150"" WinSet AlwaysOnTop return   GuiMove:    PostMessage, 0xA1, 2 return   George: MsgBox, You clicked George (%A_GuiControl%). return   John: MsgBox, You clicked John (%A_GuiControl%). return   Paul: MsgBox, You clicked Paul (%A_GuiControl%). return   Ringo: MsgBox, You clicked Ringo (%A_GuiControl%). return   Close: ExitApp Edit: Added image. Thanks! I found the way to remove the progress's border in this code. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 173 posts Page 1 of 9 Jump to page: 1 2 3 4 5 … 9 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 12 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"Examples of GUIs using non-standard methods to produce beautiful user interfaces."	"true"
"Maths"	"Monster"	"https://autohotkey.com/board/topic/15675-monster-evaluate-math-expressions-in-strings/"	"evaluate math expressions in strings (calculator)."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Monster: evaluate math expressions in strings - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. Monster: evaluate math expressions in strings Started by Laszlo , Feb 28 2007 12:06 AM Page 1 of 6 1 2 3 Next » Please log in to reply 87 replies to this topic Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 Monster: evaluate math expressions in strings w/o external programs This script gradually grew from twenty lines to over 250 AHK code lines. It might not be the best approach, but each time only a few new lines were added, so it was never feasible to start all over for a more general expression parser. The main point is not providing a standalone calculator, because there are hundreds of free ones available, but to allow evaluating a math expression typed in an editor or word processor. The compiled script can run in a PC, where AHK is not installed. It is easy to add new functions of one variable. Follow the examples of SGN (the sign of its argument), Fib (the n-th Fibonacci number) and FAC (the factorial). Two argument functions are implemented as operators: ""9 gcd 6"" is the same as it would be in functional form gcd(9,6), which is 3. ""4choose2"" = 6, the binomial coefficient. Min and Max can be chained: ""-1 min 2 min -5"" gives -5; ""3 max 5 max 2"" = max(3,5,2) = 5. Further operators can be easily added to the script. User variables can be defined and used. They are kept in memory until the script is reloaded, with values assigned before they are used in expressions, like ""a:=1; b:=2; a+b"". In later evaluated expressions ""a"" and ""b"" still have their last assigned values. User functions (even recursive ones) can also be defined in expressions: f(x) := x < 2 ? 1 : x*f(x-1) Here the formal parameter x is not defined as a variable, it is a placeholder for the value given to the function at a call. The function definition also remains in memory until the script is terminated. As usage examples, two hotkeys obtain the math text from the current document. Ctrl+Win+- replaces the expression with the result, Ctrl+Win+= appends an ""="" and the result. If a (multi-line) expression is selected, it gets evaluated. If there is nothing selected, the script searches for the last back-quote in the current line, and uses the text after it, until the insertion point (caret). For example, after pressing Win+Ctrl+= the text ""The area is `125*32"" becomes ""The area is 125*32 = 4000"" If instead you press Win+Ctrl+- at the the original line above, it becomes ""The area is 4000"" There are many features supported in the expressions: - They can contain HEX (0x1ff), Decimal (123, 1.23e2) and Binary numbers ('1001, first bit = sign), - arbitrary number of nested parentheses (..) - variables (a, b), constants (e, pi, inch, foot, mile, ounce, pint, gallon, oz, lb) - user defined functions - ternary- (_? _ : _) and logical operators !; ||; && - relational operators =,<>; <,>,<=,>= - special operators: GCD, MIN, MAX, Choose; - bitwise operators ~; |; ^; &; <<, >> - arithmetic operators +, - (or #); *, /, \ (or % = mod); ** (or @ = power); (They are listed in the order of their precedence, from low to high, except the unary operators !,-, + and ~ are of highest precedence. The operators separated by commas are of equal precedence.) - Functions Abs,Ceil,Exp,Floor,Log,Ln,Round,Sqrt,Sin,Cos,Tan,ASin,ACos,ATan,SGN,Fib,fac The output format can also be specified. - If the expression does not contain the format specifier ""$"", 6 decimal digits are shown in the general form (%0.6g in C), and integers are in decimal - With ${k}: k (optional integer) decimal digits are shown after the decimal point, in case of floating point result - With ${k}e or ${k}g: k decimal digits are shown of floating point results, in exponential or general scientific form, respectively - With $x or $h: Rounded results are shown Hex - With $b{W}: Rounded results are shown in binary form (LS W-bits; W="""": first bit is sign: ""1000"" = -8, ""0111"" = 7) There are no precision limitations in version 1.1 or later. All intermediate results are computed and stored in full 64-bit accuracy. The ternary operator ""condition ? exp1 : exp2"" is implemented as two low precedence operators: ""a ? b"" (which returns ""b"" if ""a"" is true, that is nonempty and nonzero. It evaluates to the empty string if ""a"" is false, that is empty or 0. The other operator ""b : c"" returns ""c"" if ""b"" is the empty string, otherwise it returns ""b"". (It can also be used to set default values to uninitialized variables.) This saves time, because only the one of ""b"" or ""c"" is computed, which is returned. It also helps avoiding arithmetic errors, like in ""x=0 ? 0 : 1/x"". Here 1/x is not computed if x=0. There is, however, a little difference between this implementation and the true ternary operator ""a ? b : c"". In Monster if ""a"" is true, ""b"" is returned by the ""?"" operator. If it happens to be empty (an error in an arithmetic expression), the following "":"" operator does not know if ""a"" was false or this error occurred, and returns ""c"", instead of the empty ""b"". It was easy to change this behavior (e.g. ""?"" could return a special, non-numeric character when ""a"" is false and "":"" checks for this character), but then we'd loose the ""default value"" function of the "":"" operator ""x:0"". Function names are internally enclosed by ' characters, operators are enclosed by « and » characters, to prevent problems when their names happen to be the prefix or postfix of another name (like tan/atan/at). Please report bugs! Regular expressions are heavily used, and they are notoriously difficult to read (and to get them right). ; MONSTER Version 1.2 to EVALUATE ARITHMETIC EXPRESSIONS in strings (needs AHK 1.0.48+) ; Containing HEX, Signed Binary ('11 = -1, '011 = 3), scientific numbers (1.2e+5) ; Assignments :=, preceding an expression. E.g: a:=1; b:=2; a+b ; User defined functions: f(x) := expr; ; AHK Functions Abs|Ceil|Exp|Floor|Log|Ln|Round|Sqrt|Sin|Cos|Tan|ASin|ACos|ATan ; Predefined functions: SGN|Fib|Fac (sign, Fibonacci numbers, Factorials) ; '(',')'; Variables; Predefined operators GCD,MIN,MAX,Choose (2-parameter functions) ; Predefined constants: e, pi, inch, foot, mile, ounce, pint, gallon, oz, lb; ; Logic operators: !, ||, &&; ternary operator: (_?_:_); ; Relations: =,<>; <,>,<=,>= ; Binary operators: ~; |, ^, &, <<, >> ; Arithmetic operators: +, -; *, /, \ (or % = mod); ** (or @ = power) ; Output FORMAT: $x,$h: Hex; $b{W}: W-bit binary; ;    ${k}: k-digit fixpoint,  ${k}e,${k}g: k-digit scientific (Default $6g)  #SingleInstance Force #NoEnv SetBatchLines -1 Process Priority,,High  xe := 2.718281828459045, xpi := 3.141592653589793      ; referenced as ""e"", ""pi"" xinch := 2.54, xfoot := 30.48, xmile := 1.609344       ; [cm], [cm], [Km] xounce := 0.02841, xpint := 0.5682, xgallon := 4.54609 ; liters xoz := 28.35, xlb := 453.59237                         ; gramms  /* -test cases MsgBox % Eval(""1e1"")                                               ; 10 MsgBox % Eval(""0x1E"")                                              ; 30 MsgBox % Eval(""ToBin(35)"")                                         ; 100011 MsgBox % Eval(""$b 35"")                                             ; 0100011 MsgBox % Eval(""'10010"")                                            ; -14 MsgBox % Eval(""2>3 ? 9 : 7"")                                       ; 7 MsgBox % Eval(""$2E 1e3 -50.0e+0 + 100.e-1"")                        ; 9.60E+002 MsgBox % Eval(""fact(x) := x < 2 ? 1 : x*fact(x-1); fact(5)"")       ; 120 MsgBox % Eval(""f(ab):=sqrt(ab)/ab; y:=f(2); ff(y):=y*(y-1)/2/x; x := 2; y+ff(3)/f(16)"") ; 6.70711 MsgBox % Eval(""x := qq:1; x := 5*x; y := x+1"")                     ; 6 [if y empty, x := 1...] MsgBox % Eval(""x:=-!0; x<0 ? 2*x : sqrt(x)"")                       ; -2 MsgBox % Eval(""tan(atan(atan(tan(1))))-exp(sqrt(1))"")              ; -1.71828 MsgBox % Eval(""---2+++9 + ~-2 --1 -2*-3"")                          ; 15 MsgBox % Eval(""x1:=1; f1:=sin(x1)/x1; y:=2; f2:=sin(y)/y; f1/f2"")  ; 1.85082 MsgBox % Eval(""Round(fac(10)/fac(5)**2) - (10 choose 5) + Fib(8)"") ; 21 MsgBox % Eval(""1 min-1 min-2 min 2"")                               ; -2 MsgBox % Eval(""(-1>>1<=9 && 3>2)<<2>>1"")                           ; 2 MsgBox % Eval(""(1 = 1) + (2<>3 || 2 < 1) + (9>=-1 && 3>2)"")        ; 3 MsgBox % Eval(""$b6 -21/3"")                                         ; 111001 MsgBox % Eval(""$b ('1001 << 5) | '01000"")                          ; 100101000 MsgBox % Eval(""$0 194*lb/1000"")                                    ; 88 [Kg] MsgBox % Eval(""$x ~0xfffffff0 & 7 | 0x100 << 2"")                   ; 0x407 MsgBox % Eval(""- 1 * (+pi -((3%5))) +pi+ 1-2 + e-ROUND(abs(sqrt(floor(2)))**2)-e+pi $9"") ; 3.141592654 MsgBox % Eval(""(20+4 GCD abs(2**4)) + (9 GCD (6 CHOOSE 2))"")       ; 11 t := A_TickCount Loop 1000    r := Eval(""x:="" A_Index/1000 "";atan(x)-exp(sqrt(x))"")           ; simulated plot t := A_TickCount - t MsgBox Result = %r%`nTime = %t%                                    ; -1.93288: ~400 ms [on Inspiron 9300] */  ^#-::                                  ; Replace selection or `expression with result ^#=::                                  ; Append result to selection or `expression    ClipBoard =    SendInput ^c                        ; copy selection    ClipWait 0.5    If (ErrorLevel) {       SendInput +{HOME}^c              ; copy, keep selection to overwrite (^x for some apps)       ClipWait 1       IfEqual ErrorLevel,1, Return       If RegExMatch(ClipBoard, ""(.*)(``)(.*)"", y)          SendInput %  ""{RAW}"" y1 . (A_ThisHotKey=""^#="" ? y3 . "" = ""  : """") . Eval(y3)    } Else       SendInput % ""{RAW}"" . (A_ThisHotKey=""^#="" ? ClipBoard . "" = ""  : """") . Eval(ClipBoard) Return  Eval(x) {                              ; non-recursive PRE/POST PROCESSING: I/O forms, numbers, ops, "";""    Local FORM, FormF, FormI, i, W, y, y1, y2, y3, y4    FormI := A_FormatInteger, FormF := A_FormatFloat     SetFormat Integer, D                ; decimal intermediate results!    RegExMatch(x, ""\$(b|h|x|)(\d*[eEgG]?)"", y)    FORM := y1, W := y2                 ; HeX, Bin, .{digits} output format    SetFormat FLOAT, 0.16e              ; Full intermediate float precision    StringReplace x, x, %y%             ; remove $..    Loop       If RegExMatch(x, ""i)(.*)(0x[a-f\d]*)(.*)"", y)          x := y1 . y2+0 . y3           ; convert hex numbers to decimal       Else Break    Loop       If RegExMatch(x, ""(.*)'([01]*)(.*)"", y)          x := y1 . FromBin(y2) . y3    ; convert binary numbers to decimal: sign = first bit       Else Break    x := RegExReplace(x,""(^|[^.\d])(\d+)(e|E)"",""$1$2.$3"") ; add missing '.' before E (1e3 -> 1.e3)                                        ; literal scientific numbers between ‘ and ’ chars    x := RegExReplace(x,""(\d*\.\d*|\d)([eE][+-]?\d+)"",""‘$1$2’"")     StringReplace x, x,`%, \, All       ; %  -> \ (= MOD)    StringReplace x, x, **,@, All       ; ** -> @ for easier process    StringReplace x, x, +, ±, All       ; ± is addition    x := RegExReplace(x,""(‘[^’]*)±"",""$1+"") ; ...not inside literal numbers    StringReplace x, x, -, ¬, All       ; ¬ is subtraction    x := RegExReplace(x,""(‘[^’]*)¬"",""$1-"") ; ...not inside literal numbers     Loop Parse, x, `;       y := Eval1(A_LoopField)          ; work on pre-processed sub expressions                                        ; return result of last sub-expression (numeric)    If FORM = b                         ; convert output to binary       y := W ? ToBinW(Round(y),W) : ToBin(Round(y))    Else If (FORM=""h"" or FORM=""x"") {       SetFormat Integer, Hex           ; convert output to hex       y := Round(y) + 0    }    Else {       W := W="""" ? ""0.6g"" : ""0."" . W    ; Set output form, Default = 6 decimal places       SetFormat FLOAT, %W%       y += 0.0    }    SetFormat Integer, %FormI%          ; restore original formats    SetFormat FLOAT,   %FormF%    Return y }  Eval1(x) {                             ; recursive PREPROCESSING of :=, vars, (..) [decimal, no "";""]    Local i, y, y1, y2, y3                                        ; save function definition: f(x) := expr    If RegExMatch(x, ""(\S*?)\((.*?)\)\s*:=\s*(.*)"", y) {       f%y1%__X := y2, f%y1%__F := y3       Return    }                                        ; execute leftmost "":="" operator of a := b := ...    If RegExMatch(x, ""(\S*?)\s*:=\s*(.*)"", y) {       y := ""x"" . y1                    ; user vars internally start with x to avoid name conflicts       Return %y% := Eval1(y2)    }                                        ; here: no variable to the left of last "":=""    x := RegExReplace(x,""([\)’.\w]\s+|[\)’])([a-z_A-Z]+)"",""$1«$2»"")  ; op -> «op»     x := RegExReplace(x,""\s+"")          ; remove spaces, tabs, newlines     x := RegExReplace(x,""([a-z_A-Z]\w*)\("",""'$1'("") ; func( -> 'func'( to avoid atan|tan conflicts     x := RegExReplace(x,""([a-z_A-Z]\w*)([^\w'»’]|$)"",""%x$1%$2"") ; VAR -> %xVAR%    x := RegExReplace(x,""(‘[^’]*)%x[eE]%"",""$1e"") ; in numbers %xe% -> e    x := RegExReplace(x,""‘|’"")          ; no more need for number markers    Transform x, Deref, %x%             ; dereference all right-hand-side %var%-s     Loop {                              ; find last innermost (..)       If RegExMatch(x, ""(.*)\(([^\(\)]*)\)(.*)"", y)          x := y1 . Eval@(y2) . y3      ; replace (x) with value of x       Else Break    }    Return Eval@(x) }  Eval@(x) {                             ; EVALUATE PRE-PROCESSED EXPRESSIONS [decimal, NO space, vars, (..), "";"", "":=""]    Local i, y, y1, y2, y3, y4     If x is number                      ; no more operators left       Return x                                        ; execute rightmost ?,: operator    RegExMatch(x, ""(.*)(\?|:)(.*)"", y)    IfEqual y2,?,  Return Eval@(y1) ? Eval@(y3) : """"    IfEqual y2,:,  Return ((y := Eval@(y1)) = """" ? Eval@(y3) : y)     StringGetPos i, x, ||, R            ; execute rightmost || operator    IfGreaterOrEqual i,0, Return Eval@(SubStr(x,1,i)) || Eval@(SubStr(x,3+i))    StringGetPos i, x, &&, R            ; execute rightmost && operator    IfGreaterOrEqual i,0, Return Eval@(SubStr(x,1,i)) && Eval@(SubStr(x,3+i))                                        ; execute rightmost =, <> operator    RegExMatch(x, ""(.*)(?<![\<\>])(\<\>|=)(.*)"", y)    IfEqual y2,=,  Return Eval@(y1) =  Eval@(y3)    IfEqual y2,<>, Return Eval@(y1) <> Eval@(y3)                                        ; execute rightmost <,>,<=,>= operator    RegExMatch(x, ""(.*)(?<![\<\>])(\<=?|\>=?)(?![\<\>])(.*)"", y)    IfEqual y2,<,  Return Eval@(y1) <  Eval@(y3)    IfEqual y2,>,  Return Eval@(y1) >  Eval@(y3)    IfEqual y2,<=, Return Eval@(y1) <= Eval@(y3)    IfEqual y2,>=, Return Eval@(y1) >= Eval@(y3)                                        ; execute rightmost user operator (low precedence)    RegExMatch(x, ""i)(.*)«(.*?)»(.*)"", y)    If IsFunc(y2)       Return %y2%(Eval@(y1),Eval@(y3)) ; predefined relational ops     StringGetPos i, x, |, R             ; execute rightmost | operator    IfGreaterOrEqual i,0, Return Eval@(SubStr(x,1,i)) | Eval@(SubStr(x,2+i))    StringGetPos i, x, ^, R             ; execute rightmost ^ operator    IfGreaterOrEqual i,0, Return Eval@(SubStr(x,1,i)) ^ Eval@(SubStr(x,2+i))    StringGetPos i, x, &, R             ; execute rightmost & operator    IfGreaterOrEqual i,0, Return Eval@(SubStr(x,1,i)) & Eval@(SubStr(x,2+i))                                        ; execute rightmost <<, >> operator    RegExMatch(x, ""(.*)(\<\<|\>\>)(.*)"", y)    IfEqual y2,<<, Return Eval@(y1) << Eval@(y3)    IfEqual y2,>>, Return Eval@(y1) >> Eval@(y3)                                        ; execute rightmost +- (not unary) operator    RegExMatch(x, ""(.*[^!\~±¬\@\*/\\])(±|¬)(.*)"", y) ; lower precedence ops already handled    IfEqual y2,±,  Return Eval@(y1) + Eval@(y3)    IfEqual y2,¬,  Return Eval@(y1) - Eval@(y3)                                        ; execute rightmost */% operator    RegExMatch(x, ""(.*)(\*|/|\\)(.*)"", y)    IfEqual y2,*,  Return Eval@(y1) * Eval@(y3)    IfEqual y2,/,  Return Eval@(y1) / Eval@(y3)    IfEqual y2,\,  Return Mod(Eval@(y1),Eval@(y3))                                        ; execute rightmost power    StringGetPos i, x, @, R    IfGreaterOrEqual i,0, Return Eval@(SubStr(x,1,i)) ** Eval@(SubStr(x,2+i))                                        ; execute rightmost function, unary operator    If !RegExMatch(x,""(.*)(!|±|¬|~|'(.*)')(.*)"", y)       Return x                         ; no more function (y1 <> """" only at multiple unaries: --+-)    IfEqual y2,!,Return Eval@(y1 . !y4) ; unary !    IfEqual y2,±,Return Eval@(y1 .  y4) ; unary +    IfEqual y2,¬,Return Eval@(y1 . -y4) ; unary - (they behave like functions)    IfEqual y2,~,Return Eval@(y1 . ~y4) ; unary ~    If IsFunc(y3)       Return Eval@(y1 . %y3%(y4))      ; built-in and predefined functions(y4)    Return Eval@(y1 . Eval1(RegExReplace(f%y3%__F, f%y3%__X, y4))) ; LAST: user defined functions }  ToBin(n) {      ; Binary representation of n. 1st bit is SIGN: -8 -> 1000, -1 -> 1, 0 -> 0, 8 -> 01000    Return n=0||n=-1 ? -n : ToBin(n>>1) . n&1 } ToBinW(n,W=8) { ; LS W-bits of Binary representation of n    Loop %W%     ; Recursive (slower): Return W=1 ? n&1 : ToBinW(n>>1,W-1) . n&1       b := n&1 . b, n >>= 1    Return b } FromBin(bits) { ; Number converted from the binary ""bits"" string, 1st bit is SIGN    n = 0    Loop Parse, bits       n += n + A_LoopField    Return n - (SubStr(bits,1,1)<<StrLen(bits)) }  Sgn(x) {    Return (x>0)-(x<0) }  MIN(a,b) {    Return a<b ? a : b } MAX(a,b) {    Return a<b ? b : a } GCD(a,b) {      ; Euclidean GCD    Return b=0 ? Abs(a) : GCD(b, mod(a,b)) } Choose(n,k) {   ; Binomial coefficient    p := 1, i := 0, k := k < n-k ? k : n-k    Loop %k%                   ; Recursive (slower): Return k = 0 ? 1 : Choose(n-1,k-1)*n//k       p *= (n-i)/(k-i), i+=1  ; FOR INTEGERS: p *= n-i, p //= ++i    Return Round(p) }  Fib(n) {        ; n-th Fibonacci number (n < 0 OK, iterative to avoid globals)    a := 0, b := 1    Loop % abs(n)-1       c := b, b += a, a := c    Return n=0 ? 0 : n>0 || n&1 ? b : -b } fac(n) {        ; n!    Return n<2 ? 1 : n*fac(n-1) }Edit 20070228: Removed restrictions on user variable names, documented forbidden consecutive operators Edit 20070301: Version 0.3 handles unary operators after others, like 2*-3. Edit 20070302: Version 0.4 - minor speedup and fixed ATan, ASin, ACos. Edit 20070302: Version 0.5 - further speedup, unary ""!"" and the ternary ""? :"" implemented, internal function renaming. Edit 20070304: Version 0.6 - restores original number formats, to help using Monster in other scripts; removed work around fixed AHK bugs Edit 20070309: Version 0.7 - scientific constants (1.2e+5), minor simplifications, negative Fibonacci, • -> ' Edit 20070309: Version 0.8 - $b{W}: Width of binary output is supported; Rounded results at binary and hex output Edit 20070314: Version 1.0 - User defined functions; removed [..] around operators Edit 20070425: Version 1.1 - Full 64-bit internal precision, scientific output format with $6E, $9g type directives Edit 20080524: Bugfix. Order of converting hex to decimal and adding missing decimal point to scientific numbers is swapped (Thanks Rajat) Edit 20100511: gallon is now US, not imperial (thanks flyingDman) Edit 20100818: Version 1.2 - use dynamic function calls to shorten code, make adding predefined functions easier #1 - Posted 28 February 2007 - 12:06 AM Back to top jonny Members 2951 posts Last active: Feb 24 2008 04:22 AM Joined: 13 Nov 2004 Obviously very well thought-out. I don't have much time now, but as soon as I can I'll see if I can use it in my function grapher. #2 - Posted 28 February 2007 - 04:08 AM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 It sounds appealing: the user enters a math expression and the limits, the step size, and he gets it plotted. #3 - Posted 28 February 2007 - 04:14 AM Back to top ribbet.1 Members 198 posts Last active: Feb 07 2012 01:21 AM Joined: 20 Feb 2007 Now I will REALLY get girls! Thanks much! I see this one does use a clipboard wait, in order to not get the potential error discussed in your other thread, and that it also gives optional replacement of the equation with its solution, or the placement of a ""="" and then the solution as discussed there also. I am sure this calculator will be far more than adequate for my everyday needs. But as Rev. Dobbs says, too much is better than not enough! Assuming all goes well with it I sincerely hope you compile this calculator and post it to Simtel and others, Laszlo! That plotter idea sounds really nice too. Not something I need ATM but an item every math student could use. Super idea to be able to write a paper and have this type of thing generated for you in your own editor. #4 - Posted 28 February 2007 - 12:02 PM Back to top ribbet.1 Members 198 posts Last active: Feb 07 2012 01:21 AM Joined: 20 Feb 2007 if there is nothing selected, the script searches for the last back-quote in the current line, and uses the text after it, to the caret Not really a bug report but I note that you have to press either hotkey twice if text is not selected. Once selects the text, second time evaluates it. I suppose that allows you to review if that is what you wanted it to evaluate. Cheers, ribbet.1 #5 - Posted 28 February 2007 - 12:16 PM Back to top majkinetor Moderators 4512 posts Last active: Oct 02 2013 02:33 PM Joined: 24 May 2006 RTFM ribbet.zip The one thing is its hell slow, but again, its just anoying, you don't need this scritp to be superb fast. RE's are probably guilty. Other then that, its superb. I miss ability to add custom functions though. Like `d: f(x) = sin(x)/x; f(3) then later only ` f(3) as f is already defined You noticed I also suggest ; as expression separator. #6 - Posted 28 February 2007 - 12:22 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 For speed: the script wastes half a second waiting for the ClipBoard, if nothing is selected. You can avoid this delay by defining a separate hotkey for the case you want to evaluate the selection, another one if you want to search for the beginning of the expression. Allowing dynamic functions is a good idea. Internally we have to use subroutines, because AHK has no means to call functions dynamically, but it can be done. #7 - Posted 28 February 2007 - 03:20 PM Back to top majkinetor Moderators 4512 posts Last active: Oct 02 2013 02:33 PM Joined: 24 May 2006 Why do you wait 0.5 s for the clipboard ? You should set this as an option in the top of the script and default to be 0. Then if you get nothing from clipboard you could inform the user about this param eventualy + make him never see this message again if he knows it works but accidently pressed the the hotkey. OFC, its not worth the trouble as it will work without dealy in 99% of cases. ITs bad choice in programming to slow down everybody just cuz some might have problems. Always leave an option for that and run at maximum speed. Everybody else should RTFM. About dynamic function calls: This is very needed. We can even later connect this script with jonny's grapher and get function display on single hotkey, within the active editor. #8 - Posted 28 February 2007 - 03:31 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 Unfortunately, Windows sets up the ClipBoard asynchronously to AHK scripts. In every complex application (MS Word, MultiEdit, PowerPoint, Acrobat...) sending ^c and using the ClipBoard variable immediately afterwards sometimes fails. The ClipWait instruction is a must. Even the half sec delay is too little once in a while. If you are after speed, you cannot avoid separating the hotkeys. #9 - Posted 28 February 2007 - 03:48 PM Back to top jonny Members 2951 posts Last active: Feb 24 2008 04:22 AM Joined: 13 Nov 2004 There seems to be a few issues with unary minus (-): Eval(""3*3"")  ;works fine: 9 Eval(""-3*3"")  ;works fine: -9 Eval(""3*-3"")  ;huh? -3? Eval(""-3*-3"")  ;also -3 Also, you should use longer variable names internal to the function, to account for user variables. For instance, I have to use 'x' as a user variable name for this to be useful to me, but you're already using it inside Eval, so it screws the whole thing up. Also 'y' and 'z', which, like 'x', are very common variable names in math expressions. 'u' and 'i' are less common, but are also invalid. If you can't fix this, you should at least document it. #10 - Posted 01 March 2007 - 02:29 AM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 Thanks, Jonny. I prepended an x internally to the names of user variables. This way there are no restrictions, any normal name is valid (letters, digits). Even reserved AHK names, like ErrorLevel, A_Now. The case ""*- "" is not easy. In general, operators after each other are not allowed, not like in programming languages. Until I find a simple solution, I documented this restriction. User defined functions, as majkinetor suggested, are even harder. They can be done like C macros, but they blow up the expressions, and slow down the evaluation significantly. Monster was not meant for really large expressions, but for simple, general calculations. In these cases there is a workaround: ""x:=2; f2:=sin(x)/x; x:=3; f3:=sin(x)/x; f2/f3"". It is not much longer. #11 - Posted 01 March 2007 - 03:52 AM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 I updated Monster to handle unary operators after others, like 2*-3 (thanks jonny). Please check if nothing is broken with the changes. #12 - Posted 02 March 2007 - 03:46 AM Back to top jonny Members 2951 posts Last active: Feb 24 2008 04:22 AM Joined: 13 Nov 2004 Great! It works now, but unfortunately it's a lot slower than the old method. I'll explain more in the grapher topic. #13 - Posted 02 March 2007 - 04:30 AM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 If you don't intend to use logic-, bitwise-, user- or relational operators, you can comment out those parts, saving more than half of the RegExMatch calls, but the resulting code will not deserve to be called Monster. Maybe Speedy Gonzales :lol: ? Some speedup can be achieved by checking in the beginning of the script if the expression is already reduced to a number, before searching for the operators. I updated the original post, accordingly (and fixed atan, asin and acos). #14 - Posted 02 March 2007 - 05:37 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 Version 0.5 is posted. Changes: the top level Eval function is split into a non-recursive part (which handles the I/O formats and processes sub-expressions separated by "";""), and a recursive function Eval1 (which handles chained assignments, like a:=b:=sqrt(x)). This way a lot of duplicate work can be saved, and the process speeds up further. There are two missing operators implemented: ""!"", the logical not, and the ternary ""condition ? exp1 : exp2"". The later is implemented as two low precedence operators: ""a ? b"" (which returns ""b"" if ""a"" is true or nonzero, and the empty string if ""a"" is false or 0) and ""b : c"" (which returns ""c"" if ""b"" is the empty string, otherwise it returns ""c""). This can save time, because only the one of ""b"" or ""c"" is computed, which is returned. It also helps avoiding arithmetic errors, like in ""x=0 ? 0 : 1/x"". Here 1/x is not computed if x=0. Function names are internally enclosed between ANSI 0183 characters (∙), which more robustly prevents problems when a user function happens to be the prefix or postfix of another function name (like tan/atan/at). #15 - Posted 03 March 2007 - 04:17 AM Back to top Page 1 of 6 1 2 3 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"evaluate math expressions in strings (calculator)."	"true"
"Maths"	"Unit Converter"	"https://autohotkey.com/board/topic/39359-unit-converter/"	"unit converter that has most common english and scientific units and most common quantities from length to density to thermal conductivity. Also includes a section for physical and mathematic constants."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Unit Converter - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. Unit Converter Started by fuzz54 , Apr 03 2009 06:06 PM Page 1 of 2 1 2 Next Please log in to reply 24 replies to this topic fuzz54 Members 49 posts Last active: Feb 23 2012 09:51 PM Joined: 03 Apr 2009 Here is a fairly robust unit converter that has most common english and scientific units and most common quantities from length to density to thermal conductivity. Also includes a section for physical and mathematic constants. Conversion results can be saved to memory variables to be pasted into a simple calculator / expression evaluator. Note: Number format and displayed decimals are modifiable now The basic framework for this script was taken from Converter.ahk created by tidbit.  ;; by fuzz54 http://www.autohotkey.com/forum/viewtopic.php?t=42809 ; v1.3 (4-7-09) modded by Drugwash ; v1.4 (4-9-09) - Changed format/precision menu from Drugwash mod to radios and moved to bottom ;               - Changed to allow different decimals for scientific format ;               - Added units Angstrom, lightyear, parsec, and AU to distance and cm of water to pressure ; ; v1.5 (4-12-09) - Added section to list common physical constants.  made GUI wider as a result. ;                  Most of the constants are very small and show up the best in scientific format. ;                - Added an Easter egg coded by HugoV.  when To: is clicked the ;                  from and to units swap.  doesn't work with physical constants section. ; ; v1.6 (4-16-09) - Same as version 1.7, but used AHK version incompatible code for expression evaluator ;                  Expression evaluator is updated to all AHK version compatibility for 1.7 ; ; v1.7 (4-16-09) - Added acres to the distance units since I hope I'll be buying a house soon ;                - Fixed the problem with 0 decimals when using scientific format ;                - Added a save-result-to-memory function for conversions with 5 memory slots ;                - Added a calculator / expression evaluator as the last choice on the conversion dropdown. ;                  There is a dropdown to paste memory variables into the expression box. ;                  The expression evaluator is taken from Laszlo's Monster code at: ;                  http://www.autohotkey.com/forum/viewtopic.php?t=17058 ;                  Laszlo's code is modified slightly to work with number formatting. ;                  ; v1.8 (4-20-09) - Added section for mathematical constants ;                - Added Coefficient of Thermal Expansion to quantity list ;                - Added some more units to thermal quantities ;                - Up to 18 decimals can now be displayed instead of 9 ;                - In v1.9 conversions will be updated to have 18 decimals of precision ; v1.81 (4-22-09) - Slight change to the drop down list to make it cleaner ; ; v1.9  (6-2-09) - Changed ""cubic"" phrase to windows character map cubed character wherever needed. ; ; v2.0  (7-6-09) - Fixed mass conversion error when using ""slugs"". ; v2.1  (8-7-11) - Fixed Heat Capacity conflict with Specific Heat (both have the same units which caused errors for Heat Capacity)  xe := 2.718281828459045, xpi := 3.141592653589793   ;Number formatting, decimals, and groupbox dividers Gui, Margin, -2, -2 Gui, Add, GroupBox, x-5 y-8 w298 h93 cblack, Gui, Add, GroupBox, x-5 y-7 w298 h93 cblack, Gui, Add, GroupBox, x-5 y78 w167 h53 cblack, Gui, Add, GroupBox, x161 y78 w132 h53 cblack, Gui, Add, Radio, x10 y87 h20 checked greg, Regular Gui, Add, Radio, x10 y105 h20 gsci, Scientific Gui, Add, Edit, x95 y102 w40 h20 gRpre vRP, Gui, Add, UpDown, Range0-18 0x80, 2 Gui, Add, Text, x95 y87 Hide, decimals  ;Memory variable controls Gui, Add, Text, x180 y87 vgobyebye, save result to: Gui, Add, Text, x180 y87 vgone, paste memory: Gui, Add, DropDownList, x180 y102 w75 h17 r5 gmem vmem, Memory1|Memory2|Memory3|Memory4|Memory5 Gui, Add, DropDownList, x180 y102 w75 h17 r5 gmemrec vmemrec, Memory1|Memory2|Memory3|Memory4|Memory5  ;Top GUI control - quanitity dropdown list Gui, Add, DropDownList, x75 y4 w145 h20 r26 gunits vunits, Acceleration||Angle|Area|Coeff. of Thermal Expansion|Density|Distance|Electric Current|Energy|Force|Heat Capacity|Heat Transfer Coefficient|Mass|Power|Pressure|Specific Heat|Speed|Temperature|Thermal Conductivity|Time|Volume| |--------------------------------------------------|Physical Constants|Mathematical Constants|CALCULATOR  ;Middle GUI controls, from and to units Gui, Add, DropDownList, x6 y28 w125 h20 r30 vfrom gcalc, Gui, Add, Text, x138 y28 w17 h20 gswap vswap +Center, To: Gui, Add, DropDownList, x161 y28 w125 h20 r30 vto gcalc,  ;Bottom GUI controls, input and result Gui, Add, Edit, x6 y48 w125 h20 gcalc vtot, Gui, add, updown,range1-1000 +wrap 0x80 vgoaway,1 Gui, Add, Text, x131 y48 w30 h20 +Center vequal, = Gui, Add, Edit, x161 y48 w125 h20 vrez +readonly,  ;Calculator Gui Add, Edit, x4 y32 w165 h20 vcode Hidden, Gui Add, Edit, x187 y32 w100 h20 vres Hidden Readonly ; no scroll bar for results Gui Add, Button, x47 y58 w55 h20 Default Hidden vevaluate, &Evaluate Gui Add, Button, x4 y58 w40 h20 Hidden vclear, &Clear Gui Add, Button, x105 y58 w30 h20 Hidden vhelp, &Help Gui, Add, Text, x175 y35 w5 h20 +Center vequals, = Gui Add, Button, x160 y58 w16 h20 Hidden vlparen, ( Gui Add, Button, x177 y58 w16 h20 Hidden vrparen, ) Gui Add, Button, x194 y58 w16 h20 Hidden vmultiply, x Gui Add, Button, x211 y58 w16 h20 Hidden vdivide, / Gui Add, Button, x228 y58 w16 h20 Hidden vadd, + Gui Add, Button, x245 y58 w16 h20 Hidden vsubtract, - Gui Add, Button, x262 y58 w24 h20 Hidden vexponent,exp   gosub, units gosub reg Gui, Show, AutoSize, Unit Converter v2.1 Return  GuiClose: ExitApp  swap: If units=Physical Constants    return If units=Mathematical Constants    return Gui, submit, nohide GuiControlGet, From, , Combobox4 GuiControlGet, To, , Combobox5 ControlGet, List ,List, List, Combobox4 StringReplace, List, List, `n, |, all List .= ""|"" StringReplace, FromList, List, %From%|, %From%|| StringReplace, ToList, List, %To%|, %To%|| GuiControl, , Combobox4, | GuiControl, , Combobox4, %ToList% GuiControl, , Combobox5, | GuiControl, , Combobox5, %FromList% gosub calc Return   mem: Gui, submit, nohide If mem = Memory1      Mem1=%rez% If mem = Memory2      Mem2=%rez% If mem = Memory3      Mem3=%rez% If mem = Memory4      Mem4=%rez% If mem = Memory5      Mem5=%rez% return  memrec: Gui, submit, nohide If memrec = Memory1      Pastemem=%Mem1% If memrec = Memory2      Pastemem=%Mem2% If memrec = Memory3      Pastemem=%Mem3% If memrec = Memory4      Pastemem=%Mem4% If memrec = Memory5      Pastemem=%Mem5% coded=%code%%Pastemem% Guicontrol,, code, %coded% Guicontrol,focus,code Send, {END} gosub buttonevaluate Return  reg: pre = 0 If units=CALCULATOR      gosub buttonevaluate Else      gosub calc return  sci: pre = 1 If units=CALCULATOR      gosub buttonevaluate Else      gosub calc return  Rpre: Gui, submit, nohide RegP = 0.%RP% SetFormat, Float, %RegP% If Units=CALCULATOR      gosub buttonevaluate Else      gosub calc return   ButtonClear:    Gui Submit, Nohide    Guicontrol,, code,    Guicontrol,, res,    Guicontrol,focus,code Return  ButtonEvaluate:                                ; Alt-V or Enter: evaluate expression    Gui Submit, NoHide    if pre       SetFormat, float, %RegP%E    else       SetFormat, float, %RegP%    coded:=code    GuiControl,,Res,% Eval(coded)    Guicontrol,focus,code    Send, {END} return  Button(:    Gui Submit, Nohide    codeadd=%code%(    Guicontrol,, code, %codeadd%    Guicontrol,focus,code    Send, {END}    Return     Button):    Gui Submit, Nohide    codeadd=%code%)    Guicontrol,, code, %codeadd%    Guicontrol,focus,code    Send, {END}    Return  Buttonx:    Gui Submit, Nohide    codeadd=%code%*    Guicontrol,, code, %codeadd%    Guicontrol,focus,code    Send, {END}    Return     Button/:    Gui Submit, Nohide    codeadd=%code%/    Guicontrol,, code, %codeadd%    Guicontrol,focus,code    Send, {END}    Return  Button+:    Gui Submit, Nohide    codeadd=%code%+    Guicontrol,, code, %codeadd%    Guicontrol,focus,code    Send, {END}    Return  Button-:    Gui Submit, Nohide    codeadd=%code%-    Guicontrol,, code, %codeadd%    Guicontrol,focus,code    Send, {END} Return  ButtonExp:    Gui Submit, Nohide    codeadd=%code%**    Guicontrol,, code, %codeadd%    Guicontrol,focus,code    Send, {END} Return   units: Gui, submit, nohide  if units=CALCULATOR { Guicontrol,focus,code Guicontrol,Show,Code Guicontrol,Show,Res Guicontrol,Show,gone Guicontrol,Show,memrec Guicontrol,Show,Help Guicontrol,Show,Evaluate Guicontrol,Show,Clear Guicontrol,Show,multiply Guicontrol,Show,divide Guicontrol,Show,add Guicontrol,Show,subtract Guicontrol,Show,exponent Guicontrol,Show,equals Guicontrol,Show,lparen Guicontrol,Show,rparen Guicontrol,Show,RP Guicontrol,Hide,tot Guicontrol,Hide,rez Guicontrol,Hide,from Guicontrol,Hide,to Guicontrol,Hide,To: Guicontrol,Hide,goaway Guicontrol,Hide,gobyebye Guicontrol,Hide,mem Guicontrol,Hide,equal } else { Guicontrol,hide,Code Guicontrol,hide,Res Guicontrol,hide,gone Guicontrol,hide,memrec Guicontrol,hide,Help Guicontrol,hide,Evaluate Guicontrol,hide,Clear Guicontrol,hide,multiply Guicontrol,hide,divide Guicontrol,hide,add Guicontrol,hide,subtract Guicontrol,hide,exponent Guicontrol,hide,equals Guicontrol,hide,lparen Guicontrol,hide,rparen Guicontrol,show,tot Guicontrol,show,rez Guicontrol,show,from Guicontrol,show,to Guicontrol,show,To: Guicontrol,show,goaway Guicontrol,show,gobyebye Guicontrol,show,mem Guicontrol,show,equal Guicontrol,show,RP }   if units=Mass { Guicontrol,, from, | Guicontrol,, from, kilograms|grams|ounces||pounds|stone|ton|ton(uk)|slugs Guicontrol,, to, | Guicontrol,, to, kilograms|grams|ounces||pounds|stone|ton|ton(uk)|slugs }  if units=Distance { Guicontrol,, from, | Guicontrol,, from, feet|inches||mil|meters|centimeter|kilometer|millimeter|micron|mile|furlong|yard|Angstrom|light year|parsec|AU Guicontrol,, to, | Guicontrol,, to, feet|inches||mil|meters|centimeter|kilometer|millimeter|micron|mile|furlong|yard|Angstrom|light year|parsec|AU }  if units=Density { Guicontrol,, from, | Guicontrol,, from, lb/in³||lb/ft³|g/cm³|kg/m³|slugs/ft³ Guicontrol,, to, | Guicontrol,, to, lb/in³||lb/ft³|g/cm³|kg/m³|slugs/ft³ }  if units=Acceleration { Guicontrol,, from, | Guicontrol,, from, m/s²||in/s²|ft/s²|g's Guicontrol,, to, | Guicontrol,, to, m/s²||in/s²|ft/s²|g's }  if units=Force { Guicontrol,, from, | Guicontrol,, from, Newton||lbf|dyne Guicontrol,, to, | Guicontrol,, to, Newton||lbf|dyne }  if units=Pressure { Guicontrol,, from, | Guicontrol,, from, Pascal||psi|psf|torr|bar|atm|mm mercury|cm water Guicontrol,, to, | Guicontrol,, to, Pascal||psi|psf|torr|bar|atm|mm mercury|cm water }  if units=Energy { Guicontrol,, from, | Guicontrol,, from, Joule||BTU|in lbf|ft lbf|kcal|therm Guicontrol,, to, | Guicontrol,, to, Joule||BTU|in lbf|ft lbf|kcal|therm }  if units=Power { Guicontrol,, from, | Guicontrol,, from, Watt||BTU/sec|BTU/hour|hp|ft lbf/s Guicontrol,, to, | Guicontrol,, to, Watt||BTU/sec|BTU/hour|hp|ft lbf/s }  if units=Time { Guicontrol,, from, | Guicontrol,, from, seconds||minutes|hours|days|weeks|months(30d)|years Guicontrol,, to, | Guicontrol,, to, seconds||minutes|hours|days|weeks|months(30d)|years }  if units=Thermal Conductivity { Guicontrol,, from, | Guicontrol,, from, Watt/m-K||kiloWatt/m-K|BTU/hr-ft-F|BTU/hr-in-F|BTU-in/hr-ft²-F|cal/s-cm-C Guicontrol,, to, | Guicontrol,, to, Watt/m-K||kiloWatt/m-K|BTU/hr-ft-F|BTU/hr-in-F|BTU-in/hr-ft²-F|cal/s-cm-C }  if units=Specific Heat { Guicontrol,, from, | Guicontrol,, from, KiloJoule/kg-K||BTU/lb-F|cal/g-C Guicontrol,, to, | Guicontrol,, to, KiloJoule/kg-K||BTU/lb-F|cal/g-C }  if units=Heat Capacity { Guicontrol,, from, | Guicontrol,, from, J/kg-K||BTU/lb-C|BTU/lb-F|cal/g-C Guicontrol,, to, | Guicontrol,, to, J/kg-K||BTU/lb-C|BTU/lb-F|cal/g-C }  if units=Heat Transfer Coefficient { Guicontrol,, from, | Guicontrol,, from, Watt/m²-K||BTU/hr-ft²-F|cal/s-cm²-C|kcal/hr-ft²-C Guicontrol,, to, | Guicontrol,, to, Watt/m²-K||BTU/hr-ft²-F|cal/s-cm²-C|kcal/hr-ft²-C }  if units=Area { Guicontrol,, from, | Guicontrol,, from, m²||cm²|mm²|micron²|in²|ft²|yd²|mil²|acre Guicontrol,, to, | Guicontrol,, to, m²||cm²|mm²|micron²|in²|ft²|yd²|mil²|acre }  if units=Volume { Guicontrol,, from, | Guicontrol,, from, m³||cm³|mm³|in³|ft³|yd³|ounce|pint|quart|tsp|tbsp|liter Guicontrol,, to, | Guicontrol,, to, m³||cm³|mm³|in³|ft³|yd³|ounce|pint|quart|tsp|tbsp|liter }  if units=Angle { Guicontrol,, from, | Guicontrol,, from, radians||degrees|mils|minute|second|grad|cycle Guicontrol,, to, | Guicontrol,, to, radians||degrees|mils|minute|second|grad|cycle }  if units=Temperature { Guicontrol,, from, | Guicontrol,, from, Kelvin||Celsius|Fahrenheit|Rankine|Reaumur Guicontrol,, to, | Guicontrol,, to, Kelvin||Celsius|Fahrenheit|Rankine|Reaumur }  if units=Speed { Guicontrol,, from, | Guicontrol,, from, m/s||km/h|in/s|ft/s|yard/s|mph|Mach Number|speed of light Guicontrol,, to, | Guicontrol,, to, m/s||km/h|in/s|ft/s|yard/s|mph|Mach Number|speed of light }  if units=Electric Current { Guicontrol,, from, | Guicontrol,, from, ampere||coulomb/s|statampere Guicontrol,, to, | Guicontrol,, to, ampere||coulomb/s|statampere }  if units=Physical Constants { Guicontrol,, from, | Guicontrol,, from, Speed of Light (m/s)||Gravitation (m³/kg-s²)|Planck's Constant (J-s)|magnetic constant (N/A²)|electric constant (F/m)|Coulomb cons. (N-m²/C²)|elementary charge (C)|Electron Mass (kg)|Proton Mass (kg)|fine structure constant|Rydberg constant (1/m)|atomic mass unit (kg)|Avogadro's # (1/mol)|Boltzmann constant (J/K)|Faraday constant (C/mol)|gas constant (J/K-mol)|Stefan-Boltz. (W/m²-K^4) Guicontrol,Hide, to Guicontrol,Hide, swap }  if units=Coeff. of Thermal Expansion { Guicontrol,, from, | Guicontrol,, from, 1/°K||1/°C|1/°F|1/°R Guicontrol,, to, | Guicontrol,, to, 1/°K||1/°C|1/°F|1/°R }  if units=Mathematical Constants { Guicontrol,, from, | Guicontrol,, from, Pi||e|Euler-Mascheroni|Golden Ratio|Silver Ratio|Feigenbaum 1|Feigenbaum 2|Twin Prime constant|Meissel-Mertens|Laplace limit|Apéry's constant|Lévy's constant|Omega constant|Plastic Constant|Parabolic Constant|Brun's Twin Prime|Brun's Quad Prime|Khinchin's constant|Fransén-Robinson| Guicontrol,Hide, to Guicontrol,Hide, swap }  gosub, calc return  calc: gui, submit, nohide SetFormat, Float, 0.16E  ;distance from if from=feet from=1.0 if from=inches from:=.0833333 if from=mil from:=.0000833333 if from=microns from:=3.2808E-6 if from=meters from=3.2808 if from=kilometer from=3280.8399 if from=centimeter from=0.032808399 if from=millimeter from=0.0032808399 if from=mile from=5280 if from=furlong from=660 if from=yard from=3 if from=Angstrom from=3.280839895E-10 if from=light year from=31017896836000000 if from=parsec from=101236138050000000 if from=AU from=490806662370 ;distance to if to=feet to=1.0 if to=inches to:=.0833333 if to=mil to:=.0000833333 if to=micron to:=3.2808E-6 if to=meters to=3.2808 if to=kilometer to=3280.8399 if to=centimeter to=0.032808399 if to=millimeter to=0.0032808399 if to=mile to=5280 if to=furlong to=660 if to=yard to=3 if to=Angstrom to=3.280839895E-10 if to=light year to=31017896836000000 if to=parsec to=101236138050000000 if to=AU to=490806662370   ;Area from If From=m² From=1.0 If From=cm² From=.0001 If From=mm² From=0.000001 If From=micron² From=1.0E-12 If From=in² From=0.00064516 If From=ft² From=0.09290304 If From=yd² From=0.83612736 If From=mil² From=6.4516E-10 If From=acre From=4046.8564224 ;Area to If To=m² To=1.0 If To=cm² To=.0001 If To=mm² To=0.000001 If To=micron² To=1.0E-12 If To=in² To=0.00064516 If To=ft² To=0.09290304 If To=yd² To=0.83612736 If To=mil² To=6.4516E-10 If To=acre To=4046.8564224  ;Volume from If From=m³ From=1.0 If From=cm³ From=0.000001 If From=mm³ From=1.0E-9 If From=in³ From=0.000016387064 If From=ft³ From=0.028316846592 If From=yd³ From=0.76455485798 If From=cup From=0.0002365882365 If From=ounce From=0.000029573529563 If From=pint From=0.000473176473 If From=quart From=0.000946352946 If From=tsp From=0.0000049289215938 If From=tbsp From=0.000014786764781 If From=liter From=0.001 ;Volume to If To=m³ To=1.0 If To=cm³ To=0.000001 If To=mm³ To=1.0E-9 If To=in³ To=0.000016387064 If To=ft³ To=0.028316846592 If To=yd³ To=0.76455485798 If To=cup To=0.0002365882365 If To=ounce To=0.000029573529563 If To=pint To=0.000473176473 If To=quart To=0.000946352946 If To=tsp To=0.0000049289215938 If To=tbsp To=0.000014786764781 If To=liter To=0.001  ;Angle from If From=radians From=1.0 If From=degrees From=0.01745329252 If From=minute From=0.00029088820867 If From=second From=0.0000048481368111 If From=mils From=0.00098174770425 If From=grad From=0.015707963268 If From=cycle From=6.2831853072 If From=circle From=6.2831853072 ;Angle to If To=radians To=1.0 If To=degrees To=0.01745329252 If To=minute To=0.00029088820867 If To=second To=0.0000048481368111 If To=mils To=0.00098174770425 If To=grad To=0.015707963268 If To=cycle To=6.2831853072 If To=circle To=6.2831853072  ;weight from If From=Kilograms From=2.2046226218 If From=Grams From=0.0022046226218 If From=Ounces From=0.0625 If From=Pounds From=1 If From=Stone From=14 If From=Ton From=2000 If From=Ton(Uk) From=2240 If From=slugs From=32.174048695 ;weight to If To=Kilograms To=2.2046 If To=Grams To=0.0022046226218 If To=Ounces To=0.0625 If To=Pounds To=1 If To=Stone To=14 If To=Ton To=2000 If To=Ton(Uk) To=2240 If To=slugs To=32.174048695  ;density from If From=lb/in³ From=1 If From=lb/ft³ From=0.000578703 If From=Kg/m³ From=3.6127E-5 If From=slugs/ft³ From=515.31788206 If From=g/cm³ From=0.036127292927 ;density to If To=lb/in³ To=1 If To=lb/ft³ To=0.000578703 If To=Kg/m³ To=3.6127E-5 If To=slugs/ft³ To=515.31788206 If To=g/cm³ To=0.036127292927  ;acceleration from If From=m/s² From=1 If From=in/s² From=0.0254 If From=ft/s² From=0.3048 If From=g's From=9.80665 ;acceleration to If To=m/s² To=1 If To=in/s² To=0.0254 If To=ft/s² To=0.3048 If To=g's To=9.80665  ;Force from If From=Newton From=1 If From=lbf From=4.4482 If From=dyne From=10.0E-6 ;Force to If To=Newton To=1 If To=lbf To=4.4482 If To=dyne To=10.0E-6  ;Pressure from If From=Pascal From=1 If From=psi From=6894.757 If From=psf From=47.88025 If From=torr From=133.3224 If From=mm mercury From=133.3224 If From=bar From=1.0E5 If From=atm From=101325 If From=cm water From=98.0665 ;Pressure to If To=Pascal To=1 If To=psi To=6894.757 If To=psf To=47.88025 If To=torr To=133.3224 If To=mm mercury To=133.3224 If To=bar To=1.0E5 If To=atm To=101325 If To=cm water To=98.0665  ;Energy from If From=Joule From=1 If From=BTU From=1.055055E3 If From=in lbf From=0.112984 If From=ft lbf From=1.355817 If From=kcal From=4186.8 If From=therm From=105505585.257348 ;Energy to If To=Joule To=1 If To=BTU To=1.055055E3 If To=in lbf To=0.112984 If To=ft lbf To=1.355817 If To=kcal To=4186.8 If To=therm To=105505585.257348  ;Power from If From=Watt From=1 If From=BTU/hour From=0.293071 If From=BTU/sec From=1055.055 If From=hp From=735.49875 If From=ft lbf/s From=1.355817 ;Power to If To=Watt To=1 If To=BTU/hour To=0.293071 If To=BTU/sec To=1055.055 If To=hp To=735.49875 If To=ft lbf/s To=1.355817  ;Time from If From=seconds From=1 If From=minutes From=60 If From=hours From=3600 If From=days From=86400 If From=weeks From=604800 If From=months(30d) From=2592000 If From=years From=31536000 ;Time to If To=seconds To=1 If To=minutes To=60 If To=hours To=3600 If To=days To=86400 If To=weeks To=604800 If To=months(30d) To=2592000 If To=years To=31536000  ;Thermal Conductivity from If From=Watt/m-K From=1 If From=kiloWatt/m-K From=1000 If From=BTU/hr-ft-F From=1.729577 If From=BTU/hr-in-F From=20.754924 If From=BTU-in/hr-ft²-F From=0.144131 If From=cal/s-cm-C From=418.4 ;Thermal Conductivity to If To=Watt/m-K To=1 If To=kiloWatt/m-K To=1000 If To=BTU/hr-ft-F To=1.729577 If To=BTU/hr-in-F To=20.754924 If To=BTU-in/hr-ft²-F To=0.144131 If To=cal/s-cm-C To=418.4  ;Specific Heat from If units=Specific Heat { If From=KiloJoule/kg-K From=1 If From=BTU/lb-F From=4.1868 If From=cal/g-C From=4.1868 ;Specific Heat to If To=KiloJoule/kg-K To=1 If To=BTU/lb-F To=4.1868 If To=cal/g-C To=4.1868 }  ;Heat Capacity from If From=J/kg-K From=1 If From=BTU/lb-C From=2326 If From=BTU/lb-F From=4186.8 If From=cal/g-C From=4186.8 ;Heat Capacity to If To=J/kg-K To=1 If To=BTU/lb-C To=2326 If To=BTU/lb-F To=4186.8 If To=cal/g-C To=4186.8  ;Heat Transfer Coefficient from If From=Watt/m²-K From=1 If From=BTU/hr-ft²-F From=5.678263 If From=cal/s-cm²-C From=41868 If From=kcal/hr-ft²-C From=12.518428 ;Heat Transfer Coefficient to If To=Watt/m²-K To=1 If To=BTU/hr-ft²-F To=5.678263 If To=cal/s-cm²-C To=41868 If To=kcal/hr-ft²-C To=12.518428  ;Speed from If From=m/s From=1 If From=km/h From=0.277777777778 If From=in/s From=0.0254 If From=ft/s From=0.3048 If From=yard/s From=0.9144 If From=mph From=0.44704 If From=Mach Number From=340.2933 If From=speed of light From=299790000 ;Speed to If To=m/s To=1 If To=km/h To=0.277777777778 If To=in/s To=0.0254 If To=ft/s To=0.3048 If To=yard/s To=0.9144 If To=mph To=0.44704 If To=Mach Number To=340.2933 If To=speed of light To=299790000  ;Electric Current from If From=ampere From=1 If From=coulomb/s From=1 If From=statampere From=3.335641E-10 ;Electric Current to If To=ampere To=1 If To=coulomb/s To=1 If To=statampere To=3.335641E-10  ;Coefficient of Thermal Expansion from If From=1/°K From=1.0 If From=1/°C From=1.0 If From=1/°F From=1.8 If From=1/°R From=1.8 ;Coefficient of Thermal Expansion to If to=1/°K to=1.0 If to=1/°C to=1.0 If to=1/°F to=1.8 If to=1/°R to=1.8  val:=(from/to)*tot   ;Temperature Equation - SPECIAL CASE If units=Temperature    {    If From=Kelvin      {      If To=Kelvin         val:=tot      If To=Fahrenheit         val:=tot*9/5-459.67      If To=Celsius         val:=tot-273.15      If To=Rankine         val:=tot*9/5      If To=Reaumur         val:=(tot-273.15)*4/5      }    Else If From=Fahrenheit      {      If To=Kelvin         val:=(tot+459.67)*5/9      If To=Fahrenheit         val:=tot      If To=Celsius         val:=(tot-32)*5/9      If To=Rankine         val:=tot+459.67      If To=Reaumur         val:=(tot-32)*4/9      }    Else If From=Celsius      {      If To=Kelvin         val:=tot+273.15      If To=Fahrenheit         val:=tot*9/5+32      If To=Celsius         val:=tot      If To=Rankine         val:=(tot+273.15)*9/5      If To=Reaumur         val:=tot*4/5      }    Else If From=Rankine      {      If To=Kelvin         val:=tot*5/9      If To=Fahrenheit         val:=tot-459.67      If To=Celsius         val:=(tot-491.67)*5/9      If To=Rankine         val:=tot      If To=Reaumur         val:=(tot-491.67)*4/9      }    Else If From=Reaumur      {      If To=Kelvin         val:=tot*5/4+273.15      If To=Fahrenheit         val:=tot*9/4+32      If To=Celsius         val:=tot*5/4      If To=Rankine         val:=tot*9/4+491.67      If To=Reaumur         val:=tot      }    }  ;Physical Constants - SPECIAL CASE If Units=Physical Constants      {      If From=Speed of Light (m/s)           val:=299792458.      If From=Gravitation (m³/kg-s²)           val:=6.67428E-11      If From=Planck's constant (J-s)           val:=6.62606896E-34      If From=magnetic constant (N/A²)           val:=1.256637061E-6      If From=electric constant (F/m)           val:=8.854187817E-12      If From=Coulomb cons. (N-m²/C²)           val:=8.9875517873681764E9      If From=elementary charge (C)           val:=1.602176487E-19      If From=Electron Mass (kg)           val:=9.10938215E-31      If From=Proton Mass (kg)           val:=1.672621637E-27      If From=fine structure constant           val:=7.2973525376E-3      If From=Rydberg constant (1/m)           val:=10973731.568525      If From=atomic mass unit (kg)           val:=1.66053886E-27      If From=Avogadro's # (1/mol)           val:=6.0221415E23      If From=Boltzmann constant (J/K)           val:=1.3806503882381375462532721956135E-23      If From=Faraday constant (C/mol)           val:=96485.3371638995      If From=gas constant (J/K-mol)           val:=8.314472      If From=Stefan-Boltz. (W/m²-K^4)           val:=5.670400E-8      }  ;Mathematical Constants - SPECIAL CASE If Units=Mathematical Constants      {      If From=Pi           val:=3.14159265358979323846264338327950288      If From=e           val:=2.71828182845904523536028747135266249      If From=Euler-Mascheroni           val:=0.57721566490153286060651209008240243      If From=Golden Ratio           val:=1.61803398874989484820458683436563811      If From=Silver Ratio           val:=2.4142135623730949      If From=Feigenbaum 1           val:=4.66920160910299067185320382046620161      If From=Feigenbaum 2           val:=4.66920160910299067185320382046620161      If From=Twin Prime constant           val:=0.66016181584686957392781211001455577      If From=Meissel-Mertens           val:=0.26149721284764278375542683860869585      If From=Laplace limit           val:=0.66274341934918158097474209710925290      If From=Apéry's constant           val:=1.20205690315959428539973816151144999      If From=Lévy's constant           val:=3.27582291872181115978768188245384386      If From=Omega constant           val:= 0.56714329040978387299996866221035555      If From=Plastic Constant           val:=1.32471795724474602596090885447809734      If From=Brun's Twin Prime           val:=1.9021605823      If From=Brun's Quad Prime           val:=0.8705883800      If From=Khinchin's constant           val:=2.68545200106530644530971483548179569      If From=Fransén-Robinson           val:=2.80777024202851936522150118655777293      If From=Parabolic Constant           val:=2.29558714939263807403429804918949039                }  if pre    SetFormat, float, %RegP%E else    SetFormat, float, %RegP% val := val + 0 guicontrol,, rez, %val% return           ;============================================================================================================= ;============================================================================================================= ;============================================================================================================= ; Expression Evaluation code by Laszlo at http://www.autohotkey.com/forum/viewtopic.php?t=17058 ; ; ALL THE CODE FROM HERE AND BELOW IS ONLY FOR CALCULATOR / EXPRESSION EVALUATOR!! ; ;=============================================================================================================   SetFormat Float, 0.16e                         ; max precise AHK internal format  ButtonHelp:                                    ; Alt-H  If units=CALCULATOR {    MsgBox,                                     ; list of shortcuts, functions ( Shortcut commands:    Alt-V, Enter: evaluate expression    Alt-c, Clear: clear calculator  Functions (AHK's and the following):     MONSTER Version 1.1 (needs AHK 1.0.46.12+)    EVALUATE ARITHMETIC EXPRESSIONS containing HEX, Binary ('1001), scientific numbers (1.2e+5)    (..); variables, constants: e, pi;    (? :); logicals ||; &&; relationals =,<>; <,>,<=,>=; user operators GCD,MIN,MAX,Choose;    |; ^; &; <<, >>; +, -; *, /, \ (or  = mod); ** (or @ = power); !,~;        Functions AHK's and Abs|Ceil|Exp|Floor|Log|Ln|Round|Sqrt|Sin|Cos|Tan|ASin|ACos|ATan|SGN|Fib|fac;    User defined functions: f(x) := expr;  Math Constants:    pi  = pi       e   = e  ) } Return  Eval(x) {                              ; non-recursive PRE/POST PROCESSING: I/O forms, numbers, ops, "";""    Local FORM, FormF, FormI, i, W, y, y1, y2, y3, y4    FormI := A_FormatInteger, FormF := A_FormatFloat     SetFormat Integer, D                ; decimal intermediate results!    RegExMatch(x, ""\$(b|h|x|)(\d*[eEgG]?)"", y)    FORM := y1, W := y2                 ; HeX, Bin, .{digits} output format    SetFormat FLOAT, 0.16e              ; Full intermediate float precision    StringReplace x, x, %y%             ; remove $..    Loop       If RegExMatch(x, ""i)(.*)(0x[a-f\d]*)(.*)"", y)          x := y1 . y2+0 . y3           ; convert hex numbers to decimal       Else Break    Loop       If RegExMatch(x, ""(.*)'([01]*)(.*)"", y)          x := y1 . FromBin(y2) . y3    ; convert binary numbers to decimal: sign = first bit       Else Break    x := RegExReplace(x,""(^|[^.\d])(\d+)(e|E)"",""$1$2.$3"") ; add missing '.' before E (1e3 -> 1.e3)                                        ; literal scientific numbers between ‘ and ’ chars    x := RegExReplace(x,""(\d*\.\d*|\d)([eE][+-]?\d+)"",""‘$1$2’"")     StringReplace x, x,`%, \, All       ; %  -> \ (= MOD)    StringReplace x, x, **,@, All       ; ** -> @ for easier process    StringReplace x, x, +, ±, All       ; ± is addition    x := RegExReplace(x,""(‘[^’]*)±"",""$1+"") ; ...not inside literal numbers    StringReplace x, x, -, ¬, All       ; ¬ is subtraction    x := RegExReplace(x,""(‘[^’]*)¬"",""$1-"") ; ...not inside literal numbers     Loop Parse, x, `;       y := Eval1(A_LoopField)          ; work on pre-processed sub expressions                                        ; return result of last sub-expression (numeric)    If FORM = b                         ; convert output to binary       y := W ? ToBinW(Round(y),W) : ToBin(Round(y))    Else If (FORM=""h"" or FORM=""x"") {       if pre          SetFormat, float, %RegP%E       else          SetFormat, float, %RegP% ;      SetFormat Integer, Hex           ; convert output to hex       y := Round(y) + 0    }    Else {       W := W="""" ? ""0.6g"" : ""0."" . W    ; Set output form, Default = 6 decimal places       if pre          SetFormat, float, %RegP%E       else          SetFormat, float, %RegP% ;      SetFormat FLOAT, %W%       y += 0.0    }    if pre       SetFormat, float, %RegP%E    else       SetFormat, float, %RegP% ;   SetFormat Integer, %FormI%          ; restore original formats ;   SetFormat FLOAT,   %FormF%    Return y }  Eval1(x) {                             ; recursive PREPROCESSING of :=, vars, (..) [decimal, no "";""]    Local i, y, y1, y2, y3                                        ; save function definition: f(x) := expr    If RegExMatch(x, ""(\S*?)\((.*?)\)\s*:=\s*(.*)"", y) {       f%y1%__X := y2, f%y1%__F := y3       Return    }                                        ; execute leftmost "":="" operator of a := b := ...    If RegExMatch(x, ""(\S*?)\s*:=\s*(.*)"", y) {       y := ""x"" . y1                    ; user vars internally start with x to avoid name conflicts       Return %y% := Eval1(y2)    }                                        ; here: no variable to the left of last "":=""    x := RegExReplace(x,""([\)’.\w]\s+|[\)’])([a-z_A-Z]+)"",""$1«$2»"")  ; op -> «op»     x := RegExReplace(x,""\s+"")          ; remove spaces, tabs, newlines     x := RegExReplace(x,""([a-z_A-Z]\w*)\("",""'$1'("") ; func( -> 'func'( to avoid atan|tan conflicts     x := RegExReplace(x,""([a-z_A-Z]\w*)([^\w'»’]|$)"",""%x$1%$2"") ; VAR -> %xVAR%    x := RegExReplace(x,""(‘[^’]*)%x[eE]%"",""$1e"") ; in numbers %xe% -> e    x := RegExReplace(x,""‘|’"")          ; no more need for number markers    Transform x, Deref, %x%             ; dereference all right-hand-side %var%-s     Loop {                              ; find last innermost (..)       If RegExMatch(x, ""(.*)\(([^\(\)]*)\)(.*)"", y)          x := y1 . Eval@(y2) . y3      ; replace (x) with value of x       Else Break    }     Return Eval@(x) }  Eval@(x) {                             ; EVALUATE PRE-PROCESSED EXPRESSIONS [decimal, NO space, vars, (..), "";"", "":=""]    Local i, y, y1, y2, y3, y4     If x is number                      ; no more operators left       Return x                                        ; execute rightmost ?,: operator    RegExMatch(x, ""(.*)(\?|:)(.*)"", y)    IfEqual y2,?,  Return Eval@(y1) ? Eval@(y3) : """"    IfEqual y2,:,  Return ((y := Eval@(y1)) = """" ? Eval@(y3) : y)     StringGetPos i, x, ||, R            ; execute rightmost || operator    IfGreaterOrEqual i,0, Return Eval@(SubStr(x,1,i)) || Eval@(SubStr(x,3+i))    StringGetPos i, x, &&, R            ; execute rightmost && operator    IfGreaterOrEqual i,0, Return Eval@(SubStr(x,1,i)) && Eval@(SubStr(x,3+i))                                        ; execute rightmost =, <> operator    RegExMatch(x, ""(.*)(?<![\<\>])(\<\>|=)(.*)"", y)    IfEqual y2,=,  Return Eval@(y1) =  Eval@(y3)    IfEqual y2,<>, Return Eval@(y1) <> Eval@(y3)                                        ; execute rightmost <,>,<=,>= operator    RegExMatch(x, ""(.*)(?<![\<\>])(\<=?|\>=?)(?![\<\>])(.*)"", y)    IfEqual y2,<,  Return Eval@(y1) <  Eval@(y3)    IfEqual y2,>,  Return Eval@(y1) >  Eval@(y3)    IfEqual y2,<=, Return Eval@(y1) <= Eval@(y3)    IfEqual y2,>=, Return Eval@(y1) >= Eval@(y3)                                        ; execute rightmost user operator (low precedence)    RegExMatch(x, ""i)(.*)«(.*?)»(.*)"", y)    IfEqual y2,choose,Return Choose(Eval@(y1),Eval@(y3))    IfEqual y2,Gcd,   Return GCD(   Eval@(y1),Eval@(y3))    IfEqual y2,Min,   Return (y1:=Eval@(y1)) < (y3:=Eval@(y3)) ? y1 : y3    IfEqual y2,Max,   Return (y1:=Eval@(y1)) > (y3:=Eval@(y3)) ? y1 : y3     StringGetPos i, x, |, R             ; execute rightmost | operator    IfGreaterOrEqual i,0, Return Eval@(SubStr(x,1,i)) | Eval@(SubStr(x,2+i))    StringGetPos i, x, ^, R             ; execute rightmost ^ operator    IfGreaterOrEqual i,0, Return Eval@(SubStr(x,1,i)) ^ Eval@(SubStr(x,2+i))    StringGetPos i, x, &, R             ; execute rightmost & operator    IfGreaterOrEqual i,0, Return Eval@(SubStr(x,1,i)) & Eval@(SubStr(x,2+i))                                        ; execute rightmost <<, >> operator    RegExMatch(x, ""(.*)(\<\<|\>\>)(.*)"", y)    IfEqual y2,<<, Return Eval@(y1) << Eval@(y3)    IfEqual y2,>>, Return Eval@(y1) >> Eval@(y3)                                        ; execute rightmost +- (not unary) operator    RegExMatch(x, ""(.*[^!\~±¬\@\*/\\])(±|¬)(.*)"", y) ; lower precedence ops already handled    IfEqual y2,±,  Return Eval@(y1) + Eval@(y3)    IfEqual y2,¬,  Return Eval@(y1) - Eval@(y3)                                        ; execute rightmost */% operator    RegExMatch(x, ""(.*)(\*|/|\\)(.*)"", y)    IfEqual y2,*,  Return Eval@(y1) * Eval@(y3)    IfEqual y2,/,  Return Eval@(y1) / Eval@(y3)    IfEqual y2,\,  Return Mod(Eval@(y1),Eval@(y3))                                        ; execute rightmost power    StringGetPos i, x, @, R    IfGreaterOrEqual i,0, Return Eval@(SubStr(x,1,i)) ** Eval@(SubStr(x,2+i))                                        ; execute rightmost function, unary operator    If !RegExMatch(x,""(.*)(!|±|¬|~|'(.*)')(.*)"", y)       Return x                         ; no more function (y1 <> """" only at multiple unaries: --+-)    IfEqual y2,!,Return Eval@(y1 . !y4) ; unary !    IfEqual y2,±,Return Eval@(y1 .  y4) ; unary +    IfEqual y2,¬,Return Eval@(y1 . -y4) ; unary - (they behave like functions)    IfEqual y2,~,Return Eval@(y1 . ~y4) ; unary ~    If IsLabel(y3)       GoTo %y3%                        ; built-in functions are executed last: y4 is number    Return Eval@(y1 . Eval1(RegExReplace(f%y3%__F, f%y3%__X, y4))) ; user defined function Abs:    Return Eval@(y1 . Abs(y4)) Ceil:    Return Eval@(y1 . Ceil(y4)) Exp:    Return Eval@(y1 . Exp(y4)) Floor:    Return Eval@(y1 . Floor(y4)) Log:    Return Eval@(y1 . Log(y4)) Ln:    Return Eval@(y1 . Ln(y4)) Round:    Return Eval@(y1 . Round(y4)) Sqrt:    Return Eval@(y1 . Sqrt(y4)) Sin:    Return Eval@(y1 . Sin(y4)) Cos:    Return Eval@(y1 . Cos(y4)) Tan:    Return Eval@(y1 . Tan(y4)) ASin:    Return Eval@(y1 . ASin(y4)) ACos:    Return Eval@(y1 . ACos(y4)) ATan:    Return Eval@(y1 . ATan(y4)) Sgn:    Return Eval@(y1 . (y4>0)) ; Sign of x = (x>0)-(x<0) Fib:    Return Eval@(y1 . Fib(y4)) Fac:    Return Eval@(y1 . Fac(y4)) }  ToBin(n) {      ; Binary representation of n. 1st bit is SIGN: -8 -> 1000, -1 -> 1, 0 -> 0, 8 -> 01000    Return n=0||n=-1 ? -n : ToBin(n>>1) . n&1 } ToBinW(n,W=8) { ; LS W-bits of Binary representation of n    Loop %W%     ; Recursive (slower): Return W=1 ? n&1 : ToBinW(n>>1,W-1) . n&1       b := n&1 . b, n >>= 1    Return b } FromBin(bits) { ; Number converted from the binary ""bits"" string, 1st bit is SIGN    n = 0    Loop Parse, bits       n += n + A_LoopField    Return n - (SubStr(bits,1,1)<<StrLen(bits)) }  GCD(a,b) {      ; Euclidean GCD    Return b=0 ? Abs(a) : GCD(b, mod(a,b)) } Choose(n,k) {   ; Binomial coefficient    p := 1, i := 0, k := k < n-k ? k : n-k    Loop %k%                   ; Recursive (slower): Return k = 0 ? 1 : Choose(n-1,k-1)*n//k       p *= (n-i)/(k-i), i+=1  ; FOR INTEGERS: p *= n-i, p //= ++i    Return Round(p) }  Fib(n) {        ; n-th Fibonacci number (n < 0 OK, iterative to avoid globals)    a := 0, b := 1    Loop % abs(n)-1       c := b, b += a, a := c    Return n=0 ? 0 : n>0 || n&1 ? b : -b } fac(n) {        ; n!    Return n<2 ? 1 : n*fac(n-1) } Edit: v1.0 4-3-09 Grams added to weight units Edit: v1.1 4-3-09 Temperature added. Alphabetized quantity list. Edit: v1.2 4-7-09 Speed and Electric Current added. Some extra units added to mass and density. Edit: v1.3 4-7-09 Modified by Drugwash to add decimal and number format menu. Thanks! Edit: v1.4 4-9-09 Changed to put decimal and formats as radios at bottom of GUI. Added Angstrom, light year, parsec, and AU to distance. Added cm water to pressure. Scientific format can now have decimals modified too. Edit: v1.5 4-12-09 Added a section for physical constants, and made the GUI a little wider to accomodate it. Also, an Easter egg coded by HugoV is added to swap the from and to units when the To: text is clicked on. Edit: v1.51 4-14-09 Added option for 0 decimals back in. Only works for regular number format. Edit: v1.6 4-16-09 Big update with many new features. Added acres to the distance units since I hope I'll be buying a house soon. Fixed the problem with 0 decimals when using scientific format. Added a save-result-to-memory function for conversions with 5 memory slots. Added a calculator / expression evaluator as the last choice on the conversion dropdown. There is a dropdown to paste memory variables into the expression box. The expression evaluator is taken from version 1.3 of Laszlo's code at: <!-- m -->http://www.autohotke...pic.php?t=26435<!-- m --> Laszlo's code is modified to have many bells and whistles stripped out. It is modified in some places to work with the unit converter script. Edit: v1.7 4-16-09 Same as version 1.6, but the expression evaluation code has been changed to use the Monster evaluator by Laszlo at <!-- m -->http://www.autohotke...pic.php?t=17058<!-- m --> This expression evaluator is for the most part independent of AHK version. Thanks Laszlo! Edit: v1.8 4-20-09 Added a section for mathematical constants. Added Coefficient of Thermal Expansion. Added some more units to some of the thermal quantities. Up to 18 decimals can now be displayed instead of 9. Edit: v1.81 4-22-09 Changed the drop down list to make it a little cleaner. Edit: v2.0 7-6-09 Changed cubic phrase to windows character map ""cubed"" character. Fixed error in mass conversion when using slugs. Edit: v2.1 8-7-11 Fixed Heat Capacity conflict with Specific Heat (both have the same units) #1 - Posted 03 April 2009 - 06:06 PM Back to top SoggyDog Members 803 posts Last active: Mar 04 2013 06:27 AM Joined: 02 May 2006 I only played with it for like 45 seconds, but noticed right away... Does the result always have to be in scientific notation? Seems a little over-the-top for 60 seconds to equal 1.0000E+000 minutes. Otherwise, this could prove quite useful. Thanks - [edit] No temperature conversions? Celsius to Fahrenheit to Kelvin to Rankine to Reaumur? #2 - Posted 03 April 2009 - 06:24 PM SoggyDog Dwarf Fortress: ""The most intriguing game I've ever played."" Back to top fuzz54 Members 49 posts Last active: Feb 23 2012 09:51 PM Joined: 03 Apr 2009 Only played with it for like 45 seconds, but noticed right away... Does the result always have to be in scientific notation? Seems a little over-the-top for 60 seconds to equal 1.0000E+000 minutes. Otherwise, this could prove quite useful. Thanks - If you want this in normal number formatting then try changing the first line to SetFormat, float, 0.4. You might even change the 0.4 to 0.2 if you don't care that much about getting out to 4 decimal places. I messed around with trying to add a couple radio buttons for scientific or normal number formatting by messing with SetFormat (top of script) but it wasn't working. Maybe SetFormat can't be changed in a script once it is set, but I have a feeling it was just lack of programming skill on my part. I also wanted to add a button for number of decimal places displayed, but couldn't figure out an easy way to do that. #3 - Posted 03 April 2009 - 06:33 PM Back to top SoggyDog Members 803 posts Last active: Mar 04 2013 06:27 AM Joined: 02 May 2006 All-in-all, great effort! I like it. Note: While you were replying, I edited my post... No temperature conversions? #4 - Posted 03 April 2009 - 06:36 PM SoggyDog Dwarf Fortress: ""The most intriguing game I've ever played."" Back to top fuzz54 Members 49 posts Last active: Feb 23 2012 09:51 PM Joined: 03 Apr 2009 [edit] No temperature conversions? Celsius to Fahrenheit to Kelvin to Rankine to Reaumur? Temperature would have to be done in some other way since it doesn't use ratios and needs an addition or subtraction operator. It'd be easy to do with an IF statement at the bottom for a special form of ""val"" variable just for temperatures. I'll add temperature to it soon since I agree that it would be useful. #5 - Posted 03 April 2009 - 06:36 PM Back to top jmanx Members 110 posts Last active: Mar 20 2011 07:55 PM Joined: 14 May 2008 Grams and temp would be nice new features if you know how to #6 - Posted 03 April 2009 - 06:46 PM Back to top fuzz54 Members 49 posts Last active: Feb 23 2012 09:51 PM Joined: 03 Apr 2009 Grams and temp would be nice new features if you know how to Grams has been added to the script. #7 - Posted 03 April 2009 - 06:55 PM Back to top tidbit Administrators 2709 posts Hates playing Janitor Last active: Jan 15 2016 11:37 PM Joined: 09 Mar 2008 hehe, nice improvement ^^ maybe I'll take it. edit: I could probably do the temperature system for you. Will try it later. #8 - Posted 03 April 2009 - 07:50 PM rawr. be very afraid *poke* . Populate the AutoHotkey city. Pointless but somewhat fun. . Back to top fuzz54 Members 49 posts Last active: Feb 23 2012 09:51 PM Joined: 03 Apr 2009 hehe, nice improvement ^^ maybe I'll take it. edit: I could probably do the temperature system for you. Will try it later. Thanks tidbit. I just added temperature. There could be an error with that since it requires a 5x5 matrix instead of ratios, but I think I got it with 5 nested If statements. I also alphabetized the quantities to be converted since that seemed less annoying. #9 - Posted 03 April 2009 - 08:43 PM Back to top fuzz54 Members 49 posts Last active: Feb 23 2012 09:51 PM Joined: 03 Apr 2009 For anyone that cares, I added speed and electric current to the unit converter. That probably covers everything that most people would need to convert, so this will be the last revision unless I'm wrong. #10 - Posted 07 April 2009 - 09:34 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 Cool! It often comes very handy. I missed under pressure ""cm Water"". - under distance: Ångström, light-year, parsec Adding links to the corresponding Wikipedia page would make the definitions also easily accessible. You could have separate controls for the decimal modifiers, like deci, centi, milli... and deka, hecto, kilo... #11 - Posted 08 April 2009 - 12:26 AM Back to top Drugwash Members 1078 posts Last active: May 24 2016 04:20 PM Joined: 07 Sep 2008 A small enhancement to the script. Could be done differently, of course, so feel free to change it if you want. ; by fuzz54 http://www.autohotkey.com/forum/viewtopic.php?t=42809 ; v1.3 (4-7-09) modded by Drugwash  Menu, opt, Add, &Regular, reg Menu, opt, Add, &Scientific, sci Menu, ConvMenu, Add, &Precision, :opt Gui, Menu, ConvMenu Gui, Add, Edit, x6 y4 w30 h20 gRpre vRP Hidden, Gui, Add, UpDown, Range0-8 -wrap 0x80, 1 Gui, Add, Text, x+1 yp+3 Hide, decimals Gui, Add, DropDownList, x86 y4 w150 h20 r19 gunits vunits, Acceleration||Angle|Area|Density|Distance|Electric Current|Energy|Force|Heat Capacity|Heat Transfer Coefficient|Mass|Power|Pressure|Specific Heat|Speed|Temperature|Thermal Conductivity|Time|Volume|   Gui, Add, DropDownList, x6 y28 w100 h20 r13 vfrom gcalc, Gui, Add, Text, x106 y28 w30 h20 +Center, To: Gui, Add, DropDownList, x136 y28 w100 h20 r13 vto gcalc,  Gui, Add, Edit, x6 y48 w100 h20 gcalc vtot, Gui, add, updown,range1-5500 +wrap 0x80,1 Gui, Add, Text, x106 y48 w30 h20 +Center, = Gui, Add, Edit, x136 y48 w100 h20 vres +readonly,  gosub, units gosub sci Gui, Show, , Unit Converter Return  reg: Menu, opt, Uncheck, &Scientific Menu, opt, Check, &Regular GuiControl, Show, RP GuiControl, Show, msctls_updown321 GuiControl, Show, Static1 pre = 0 gosub calc return  sci: Menu, opt, Uncheck, &Regular Menu, opt, Check, &Scientific GuiControl, Hide, RP GuiControl, Hide, msctls_updown321 GuiControl, Hide, Static1 pre = 1 gosub calc return  Rpre: Gui, submit, nohide SetFormat, Float, 0.1 RegP := RP/10 SetFormat, Float, %RegP% gosub calc return  units: Gui, submit, nohide if units=Mass { Guicontrol,, from, | Guicontrol,, from, kilograms|grams|ounces||pounds|stone|ton|ton(uk)|slugs Guicontrol,, to, | Guicontrol,, to, kilograms|grams|ounces||pounds|stone|ton|ton(uk)|slugs }  if units=Distance { Guicontrol,, from, | Guicontrol,, from, feet|inches||mil|meters|centimeter|kilometer|millimeter|micron|mile|furlong|yard Guicontrol,, to, | Guicontrol,, to, feet|inches||mil|meters|centimeter|kilometer|millimeter|micron|mile|furlong|yard }  if units=Density { Guicontrol,, from, | Guicontrol,, from, lb/cubic inch||lb/cubic foot|kg/cubic meter|slugs/cubic foot Guicontrol,, to, | Guicontrol,, to, lb/cubic inch||lb/cubic foot|kg/cubic meter|slugs/cubic foot }  if units=Acceleration { Guicontrol,, from, | Guicontrol,, from, m/s2||in/s2|ft/s2|g's Guicontrol,, to, | Guicontrol,, to, m/s2||in/s2|ft/s2|g's }  if units=Force { Guicontrol,, from, | Guicontrol,, from, Newton||lbf|dyne Guicontrol,, to, | Guicontrol,, to, Newton||lbf|dyne }  if units=Pressure { Guicontrol,, from, | Guicontrol,, from, Pascal||psi|psf|torr|mm mercury|bar|atm Guicontrol,, to, | Guicontrol,, to, Pascal||psi|psf|torr|mm mercury|bar|atm }  if units=Energy { Guicontrol,, from, | Guicontrol,, from, Joule||BTU|in lbf|ft lbf|kcal|therm Guicontrol,, to, | Guicontrol,, to, Joule||BTU|in lbf|ft lbf|kcal|therm }  if units=Power { Guicontrol,, from, | Guicontrol,, from, Watt||BTU/sec|BTU/hour|hp|ft lbf/s Guicontrol,, to, | Guicontrol,, to, Watt||BTU/sec|BTU/hour|hp|ft lbf/s }  if units=Time { Guicontrol,, from, | Guicontrol,, from, seconds||minutes|hours|days|weeks|months(30d)|years Guicontrol,, to, | Guicontrol,, to, seconds||minutes|hours|days|weeks|months(30d)|years }  if units=Thermal Conductivity { Guicontrol,, from, | Guicontrol,, from, Watt/m-K||kiloWatt/m-K|BTU/hr-ft-F|BTU-in/hr-ft2-F|cal/s-cm-C Guicontrol,, to, | Guicontrol,, to, Watt/m-K||kiloWatt/m-K|BTU/hr-ft-F|BTU-in/hr-ft2-F|cal/s-cm-C }  if units=Specific Heat { Guicontrol,, from, | Guicontrol,, from, KiloJoule/kg-K||BTU/lb-F|cal/g-C Guicontrol,, to, | Guicontrol,, to, KiloJoule/kg-K||BTU/lb-F|cal/g-C }  if units=Heat Capacity { Guicontrol,, from, | Guicontrol,, from, J/kg-K||BTU/lb-C|BTU/lb-F|cal/g-C Guicontrol,, to, | Guicontrol,, to, J/kg-K||BTU/lb-C|BTU/lb-F|cal/g-C }  if units=Heat Transfer Coefficient { Guicontrol,, from, | Guicontrol,, from, Watt/m2-K||BTU/hr-ft2-F|cal/s-cm2-C|kcal/hr-ft2-C Guicontrol,, to, | Guicontrol,, to, Watt/m2-K||BTU/hr-ft2-F|cal/s-cm2-C|kcal/hr-ft2-C }  if units=Area { Guicontrol,, from, | Guicontrol,, from, m2||cm2|mm2|micron2|in2|ft2|yd2|mil2 Guicontrol,, to, | Guicontrol,, to, m2||cm2|mm2|micron2|in2|ft2|yd2|mil2 }  if units=Volume { Guicontrol,, from, | Guicontrol,, from, cubic meters||cubic centimeters|cubic millimeters|cubic inches|cubic feet|cubic yards|ounce|pint|quart|tsp|tbsp|liter Guicontrol,, to, | Guicontrol,, to, cubic meters||cubic centimeters|cubic millimeters|cubic inches|cubic feet|cubic yards|ounce|pint|quart|tsp|tbsp|liter }  if units=Angle { Guicontrol,, from, | Guicontrol,, from, radians||degrees|mils|minute|second|grad|cycle Guicontrol,, to, | Guicontrol,, to, radians||degrees|mils|minute|second|grad|cycle }  if units=Temperature { Guicontrol,, from, | Guicontrol,, from, Kelvin||Celsius|Fahrenheit|Rankine|Reaumur Guicontrol,, to, | Guicontrol,, to, Kelvin||Celsius|Fahrenheit|Rankine|Reaumur }  if units=Speed { Guicontrol,, from, | Guicontrol,, from, m/s||km/h|in/s|ft/s|yard/s|mph|Mach Number|speed of light Guicontrol,, to, | Guicontrol,, to, m/s||km/h|in/s|ft/s|yard/s|mph|Mach Number|speed of light }  if units=Electric Current { Guicontrol,, from, | Guicontrol,, from, ampere||coulomb/s|statampere Guicontrol,, to, | Guicontrol,, to, ampere||coulomb/s|statampere }  gosub, calc return  calc: gui, submit, nohide  ;distance from if from=feet from=1.0 if from=inches from:=.0833333 if from=mil from:=.0000833333 if from=microns from:=3.2808E-6 if from=meters from=3.2808 if from=kilometer from=3280.8399 if from=centimeter from=0.032808399 if from=millimeter from=0.0032808399 if from=mile from=5280 if from=furlong from=660 if from=yard from=3 ;distance to if to=feet to=1.0 if to=inches to:=.0833333 if to=mil to:=.0000833333 if to=micron to:=3.2808E-6 if to=meters to=3.2808 if to=kilometer to=3280.8399 if to=centimeter to=0.032808399 if to=millimeter to=0.0032808399 if to=mile to=5280 if to=furlong to=660 if to=yard to=3  ;Area from If From=m2 From=1.0 If From=cm2 From=.0001 If From=mm2 From=0.000001 If From=micron2 From=1.0E-12 If From=in2 From=0.00064516 If From=ft2 From=0.09290304 If From=yd2 From=0.83612736 If From=mil2 From=6.4516E-10 ;Area to If To=m2 To=1.0 If To=cm2 To=.0001 If To=mm2 To=0.000001 If To=micron2 To=1.0E-12 If To=in2 To=0.00064516 If To=ft2 To=0.09290304 If To=yd2 To=0.83612736 If To=mil2 To=6.4516E-10  ;Volume from If From=cubic meters From=1.0 If From=cubic centimeters From=0.000001 If From=cubic millimeters From=1.0E-9 If From=cubic inches From=0.000016387064 If From=cubic feet From=0.028316846592 If From=cubic yards From=0.76455485798 If From=cup From=0.0002365882365 If From=ounce From=0.000029573529563 If From=pint From=0.000473176473 If From=quart From=0.000946352946 If From=tsp From=0.0000049289215938 If From=tbsp From=0.000014786764781 If From=liter From=0.001 ;Volume to If To=cubic meters To=1.0 If To=cubic centimeters To=0.000001 If To=cubic millimeters To=1.0E-9 If To=cubic inches To=0.000016387064 If To=cubic feet To=0.028316846592 If To=cubic yards To=0.76455485798 If To=cup To=0.0002365882365 If To=ounce To=0.000029573529563 If To=pint To=0.000473176473 If To=quart To=0.000946352946 If To=tsp To=0.0000049289215938 If To=tbsp To=0.000014786764781 If To=liter To=0.001  ;Angle from If From=radians From=1.0 If From=degrees From=0.01745329252 If From=minute From=0.00029088820867 If From=second From=0.0000048481368111 If From=mils From=0.00098174770425 If From=grad From=0.015707963268 If From=cycle From=6.2831853072 If From=circle From=6.2831853072 ;Angle to If To=radians To=1.0 If To=degrees To=0.01745329252 If To=minute To=0.00029088820867 If To=second To=0.0000048481368111 If To=mils To=0.00098174770425 If To=grad To=0.015707963268 If To=cycle To=6.2831853072 If To=circle To=6.2831853072  ;weight from If From=Kilograms From=2.2046226218 If From=Grams From=0.0022046226218 If From=Ounces From=0.0625 If From=Pounds From=1 If From=Stone From=14 If From=Ton From=2000 If From=Ton (Uk) From=2240 If From=slugs From=14.593903 ;weight to If To=Kilograms To=2.2046 If To=Grams To=0.0022046226218 If To=Ounces To=0.0625 If To=Pounds To=1 If To=Stone To=14 If To=Ton To=2000 If To=Ton (Uk) To=2240 If To=slugs To=14.593903  ;density from If From=lb/cubic inch From=1 If From=lb/cubic foot From=0.000578703 If From=Kg/cubic meter From=3.6127E-5 If From=slugs/cubic foot From=515.31788206 ;density to If To=lb/cubic inch To=1 If To=lb/cubic foot To=0.000578703 If To=Kg/cubic meter To=3.6127E-5 If To=slugs/cubic foot To=515.31788206  ;acceleration from If From=m/s2 From=1 If From=in/s2 From=0.0254 If From=ft/s2 From=0.3048 If From=g's From=9.80665 ;acceleration to If To=m/s2 To=1 If To=in/s2 To=0.0254 If To=ft/s2 To=0.3048 If To=g's To=9.80665  ;Force from If From=Newton From=1 If From=lbf From=4.4482 If From=dyne From=10.0E-6 ;Force to If To=Newton To=1 If To=lbf To=4.4482 If To=dyne To=10.0E-6  ;Pressure from If From=Pascal From=1 If From=psi From=6894.757 If From=psf From=47.88025 If From=torr From=133.3224 If From=mm mercury From=133.3224 If From=bar From=1.0E5 If From=atm From=101325 ;Pressure to If To=Pascal To=1 If To=psi To=6894.757 If To=psf To=47.88025 If To=torr To=133.3224 If To=mm mercury To=133.3224 If To=bar To=1.0E5 If To=atm To=101325  ;Energy from If From=Joule From=1 If From=BTU From=1.055055E3 If From=in lbf From=0.112984 If From=ft lbf From=1.355817 If From=kcal From=4186.8 If From=therm From=105505585.257348 ;Energy to If To=Joule To=1 If To=BTU To=1.055055E3 If To=in lbf To=0.112984 If To=ft lbf To=1.355817 If To=kcal To=4186.8 If To=therm To=105505585.257348  ;Power from If From=Watt From=1 If From=BTU/hour From=0.293071 If From=BTU/sec From=1055.055 If From=hp From=735.49875 If From=ft lbf/s From=1.355817 ;Power to If To=Watt To=1 If To=BTU/hour To=0.293071 If To=BTU/sec To=1055.055 If To=hp To=735.49875 If To=ft lbf/s To=1.355817  ;Time from If From=seconds From=1 If From=minutes From=60 If From=hours From=3600 If From=days From=86400 If From=weeks From=604800 If From=months(30d) From=2592000 If From=years From=31536000 ;Time to If To=seconds To=1 If To=minutes To=60 If To=hours To=3600 If To=days To=86400 If To=weeks To=604800 If To=months(30d) To=2592000 If To=years To=31536000  ;Thermal Conductivity from If From=Watt/m-K From=1 If From=kiloWatt/m-K From=1000 If From=BTU/hr-ft-F From=1.729577 If From=BTU-in/hr-ft2-F From=0.144131 If From=cal/s-cm-C From=418.4 ;Thermal Conductivity to If To=Watt/m-K To=1 If To=kiloWatt/m-K To=1000 If To=BTU/hr-ft-F To=1.729577 If To=BTU-in/hr-ft2-F To=0.144131 If To=cal/s-cm-C To=418.4  ;Specific Heat from If From=KiloJoule/kg-K From=1 If From=BTU/lb-F From=4.1868 If From=cal/g-C From=4.1868 ;Specific Heat to If To=KiloJoule/kg-K To=1 If To=BTU/lb-F To=4.1868 If To=cal/g-C To=4.1868  ;Heat Capacity from If From=J/kg-K From=1 If From=BTU/lb-C From=2326 If From=BTU/lb-F From=4186.8 If From=cal/g-C From=4186.8 ;Heat Capacity to If To=J/kg-K To=1 If To=BTU/lb-C To=2326 If To=BTU/lb-F To=4186.8 If To=cal/g-C To=4186.8  ;Heat Transfer Coefficient from If From=Watt/m2-K From=1 If From=BTU/hr-ft2-F From=5.678263 If From=cal/s-cm2-C From=41868 If From=kcal/hr-ft2-C From=12.518428 ;Heat Transfer Coefficient to If To=Watt/m2-K To=1 If To=BTU/hr-ft2-F To=5.678263 If To=cal/s-cm2-C To=41868 If To=kcal/hr-ft2-C To=12.518428  ;Speed from If From=m/s From=1 If From=km/h From=0.277777777778 If From=in/s From=0.0254 If From=ft/s From=0.3048 If From=yard/s From=0.9144 If From=mph From=0.44704 If From=Mach Number From=340.2933 If From=speed of light From=299790000 ;Speed to If To=m/s To=1 If To=km/h To=0.277777777778 If To=in/s To=0.0254 If To=ft/s To=0.3048 If To=yard/s To=0.9144 If To=mph To=0.44704 If To=Mach Number To=340.2933 If To=speed of light To=299790000  ;Electric Current from If From=ampere From=1 If From=coulomb/s From=1 If From=statampere From=3.335641E-10 ;Electric Current to If To=ampere To=1 If To=coulomb/s To=1 If To=statampere To=3.335641E-10  val:=(from/to)*tot  ;Temperature Equation - SPECIAL CASE If units=Temperature    {    If From=Kelvin      {      If To=Kelvin         val:=tot      If To=Fahrenheit         val:=tot*9/5-459.67      If To=Celsius         val:=tot-273.15      If To=Rankine         val:=tot*9/5      If To=Reaumur         val:=(tot-273.15)*4/5      }    Else If From=Fahrenheit      {      If To=Kelvin         val:=(tot+459.67)*5/9      If To=Fahrenheit         val:=tot      If To=Celsius         val:=(tot-32)*5/9      If To=Rankine         val:=tot+459.67      If To=Reaumur         val:=(tot-32)*4/9      }    Else If From=Celsius      {      If To=Kelvin         val:=tot+273.15      If To=Fahrenheit         val:=tot*9/5+32      If To=Celsius         val:=tot      If To=Rankine         val:=(tot+273.15)*9/5      If To=Reaumur         val:=tot*4/5      }    Else If From=Rankine      {      If To=Kelvin         val:=tot*5/9      If To=Fahrenheit         val:=tot-459.67      If To=Celsius         val:=(tot-491.67)*5/9      If To=Rankine         val:=tot      If To=Reaumur         val:=(tot-491.67)*4/9      }    Else If From=Reaumur      {      If To=Kelvin         val:=tot*5/4+273.15      If To=Fahrenheit         val:=tot*9/4+32      If To=Celsius         val:=tot*5/4      If To=Rankine         val:=tot*9/4+491.67      If To=Reaumur         val:=tot      }    } if pre 	SetFormat, floatfast, 0.4E else 	SetFormat, floatfast, %RegP% val := val + 0 guicontrol,, res, %val% return  GuiClose: ExitApp  #12 - Posted 09 April 2009 - 01:20 PM Back to top fuzz54 Members 49 posts Last active: Feb 23 2012 09:51 PM Joined: 03 Apr 2009 A small enhancement to the script. Could be done differently, of course, so feel free to change it if you want. It couldn't have been done differently by me since you have more autohotkey knowledge than I do. I never would have figured it out without this example. And thanks for that, because it also solves problems I was having with setting number format in a similar material property script I'm writing. I'll update the code at top of post later today to use your enhancements. I might tweak a couple things, but it'll look pretty much the same. Also, I changed ""floatfast"" at the bottom to be ""float"" since that was giving me problems in getting the script to run. It works fine after that. Again, Thanks! #13 - Posted 09 April 2009 - 04:33 PM Back to top Drugwash Members 1078 posts Last active: May 24 2016 04:20 PM Joined: 07 Sep 2008 You're welcome, glad to be of help! As for FloatFast, it's been introduced with AHK 1.0.48 and you're probably running an older version, that's why it wouldn't work for you; no problem though, it should run fine with Float as well. #14 - Posted 09 April 2009 - 04:57 PM Back to top fuzz54 Members 49 posts Last active: Feb 23 2012 09:51 PM Joined: 03 Apr 2009 The script now has Angstrom, light year, parsec, and AU added to length and cm water added to pressure. I changed the mod from Drugwash to use radio buttons instead of menu for number format. Number of decimals is now always visible and allows both regular and scientific formats to change # of decimals. Just my personal preference. #15 - Posted 09 April 2009 - 08:58 PM Back to top Page 1 of 2 1 2 Next Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"unit converter that has most common english and scientific units and most common quantities from length to density to thermal conductivity. Also includes a section for physical and mathematic constants."	"true"
"Mouse"	"EitherMouse"	"http://www.eithermouse.com/"	"Multiple mice, individual settings, auto swap mouse buttons on second mouse. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"EitherMouse EitherMouse Setup.exe or EitherMouse.exe or EitherMouse.zip EitherMouse Multiple mice, individual settings Instantly changes settings when any mouse is used: swap buttons mirror cursor adjust speeds and more... Leave multiple mice on a pc and automatically swap buttons on each mouse. Have a left-handed and a right-handed mouse always connected and ready to use. Match speeds across different mice, ie touchpad and mouse with different speeds. Accommodate left and right handed users easily on multi-user or public workstations. Helps prevent RSI/injury issues by allowing seemless switching between hands. Quickly change mouse settings from system tray if only one mouse is used Freeware! no ads, no nags, free software, suggestions appreciated! Always virus, malware, and spyware free... Tested on: Windows 10, 8.1, 8, 7, Vista, and XP feedback greatly appreciated via email: gwarble@gmail.com or on the forum here: EitherMouse - Multiple mice, individual settings..."	"null"	"null"	"Multiple mice, individual settings, auto swap mouse buttons on second mouse. Forum thread:."	"true"
"Mouse"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=3648"	"Multiple mice, individual settings, auto swap mouse buttons on second mouse. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"EitherMouse 0.64 - Multiple mice, individual settings... - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:29 All times are UTC-05:00 EitherMouse 0.64 - Multiple mice, individual settings... Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 130 posts Page 1 of 7 Jump to page: 1 2 3 4 5 … 7 Next gwarble Posts: 92 Joined: 30 Sep 2013, 15:01 EitherMouse 0.64 - Multiple mice, individual settings... Report this post Quote 29 May 2014, 13:49 EitherMouse Setup.exe v0.64 EitherMouse.exe v0.64 http://www.EitherMouse.com Multiple mice, individual settings... Instantly changes settings when any mouse is used: swap buttons mirror cursor adjust speeds and more... Leave multiple mice on a pc and automatically swap buttons on each mouse Have a left-handed and a right-handed mouse always connected and ready to use Match speeds across different mice, great for slow touchpad and fast mouse Great for multi-user/public workstations to accomodate both left and right handed users. Helps prevent RSI/injury issues by allowing seemless switching between hands. Quickly change mouse settings from system tray if only one mouse is used Freeware! no ads, no nags, free software, suggestions appreciated! Tested on: Windows XP, Windows Vista, Windows 7, Windows 8 & 8.1 Please post feedback as i'm new to AHK this app as been a test for going public for me... and i love hearing how its used! - aug '09 new website and major program revamp, started may '12 transition to ahkscript.org thread started may '14 old thread on ahk.com can be found here: EitherMouse - auto swap mouse buttons on second mouse - gwarble Last edited by gwarble on 05 Feb 2016, 01:09, edited 7 times in total. EitherMouse - Multiple mice, individual settings... Top gwarble Posts: 92 Joined: 30 Sep 2013, 15:01 Re: EitherMouse 0.6 - Multiple mice, individual settings... Report this post Quote 29 May 2014, 13:50 To add/do: language/translation load user cursors hotkeys for quick change of settings (and tray icon action) ""Advanced"" gui for configuring all devices ""hide tray icon"" option (re-run for gui (and no autoclose)) about gui/website update tooltip/timeout set per mouse colored cursors toggle gui icon with mouse change In Beta version: large and extra large cursors ""enable pointer precision"" modules/scripts - plugin system via windows messages axis inversion? - via plugin faster than 20 mouse movement - via plugin Done: ahkscript.org thread finish uninstaller tray icon option Removed unless requested again: ini option optional old method of swapping (hotkey, for VNC/remoteDesktop) per window/application settings ""always run as admin"" option History: v0.599 - plugin system via windows messages - - - - - - Enhance Pointer Precision option - - - - - - Large and Extra Large Cursors (mirrored) v0.59 - - font/gui size fixes (dpi awareness) - - - - - - admin rights fixes - - - - - - multicursor tooltip made optional v0.562 - new MultiCursor mode - - - - - - gui replacement for tray menu - - - - - - installer created v0.48 - - No external files created! - - - - - - Loads cursors from EXE resources - - - - - - Settings moved from ini to registry - - - - - - Automatic updates implemented... v0.47 - - bug fixes, major code cleanup v0.46 - - system method for swapping buttons by default - - - - - - - - settings and other fixes v0.43 - - mirrored cursors added - - - - - - Extract source option and -source parameter - - - - - - ""-delay seconds"" command line parameter v0.41 - - fixed ctrl-shift bug, thanks epicondylitis v0.4 - - improved interface/settings/installation/third mouse - - - - - - added quick swap of mouse buttons for single-mouse systems - - - - - - fixed bug if initially swapped, wouldnt drag v0.3 - - cleaned up UI and code, fixed hotkeys (for dragging) - - - - - - improved initial detection - - - - - - added settings saving - - - - - - added install/startup settings v0.1 - - initial idea test - - - - - - detect different HID device mouse - - - - - - swap buttons on second mouse - - - - - - show active mouse visually with tray icon - - - - - - define which mouse is which at initialization Last edited by gwarble on 02 Oct 2014, 01:00, edited 5 times in total. EitherMouse - Multiple mice, individual settings... Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 29 May 2014, 20:37 Nice! I remember this Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top timeFlies Posts: 146 Joined: 22 Oct 2013, 20:54 Location: Somewhere in the northern hemisphere. Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 30 May 2014, 13:09 I use it all the time to set different mouse wheel speeds for different mice. I have corded mice that scrolls super slow, but then my wireless mouse goes at hyper speed when I adjust the speed for the corded mouse. I also use both mice in multi-cursor mode sometimes for my two monitors. Top gwarble Posts: 92 Joined: 30 Sep 2013, 15:01 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 15 Jun 2014, 00:19 glad to hear it... I'm digging into the code and found an updating permission bug (trying to RunAsAdmin while already forced as admin) Anyway, if you have any updating problems (it says ""downloading"" but then no ""updating""), you can redownload or run ""EitherMouse_Update.exe in the local dir Sorry for the inconvenience... http://www.EitherMouse.com - joel Edit: been working on the installer and uninstall process, feedback appreciated Edit: all my testing yields success, please prove me wrong... Updated main version so now users will see the update failure and have to re-install (or run EitherMouse_Update.exe in local folder Now to add some features (and hopefully get some bug reports come in)... EitherMouse - Multiple mice, individual settings... Top danig Posts: 1 Joined: 07 Aug 2014, 03:57 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 07 Aug 2014, 04:13 Hi there! I'm using this software to be able to set different cursor speeds for my mouse and my trackpad. Happy with it so far. Recently it started showing this message about updating, something like ""Click here to update... latest version: 0.5987"", but when I click on it nothing happens. It also mentions an eithermouse_update.exe file, but I can't see it anywhere... :-? Anyway I haven't noticed any bug in the app that makes me want to update it, so I would be happy if I could just disable the update message :) Regards, Danig My FB | My favs Top gwarble Posts: 92 Joined: 30 Sep 2013, 15:01 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 09 Aug 2014, 00:19 Sorry but you can't disable it... I'll add that ability to my todo list, but just download the latest version and you won't get that message anymore In my last post i explained that i accidently created a bug, its now fixed but i broke updates from that version Www.eithermouse.com EitherMouse - Multiple mice, individual settings... Top miketvsubs Posts: 1 Joined: 13 Aug 2014, 11:49 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 13 Aug 2014, 11:57 EitherMouse seems to be the product I'm looking for, but I'm having one problem: I need to adjust the orientation of my Left hand mouse 180 degrees, but leave the Right hand mouse in its default orientation at the same time. Could I get tips on how to accomplish this? thanks in advance Top gwarble Posts: 92 Joined: 30 Sep 2013, 15:01 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 15 Aug 2014, 18:39 without editing the code this is not possible with EitherMouse... I have ""invert mouse axis"" on my to do list, but unsure when i'll get to implementing it, sorry. If you search around the forums there are mouse hook examples to accomplish this, that you could merge into eithermouse - gwarble EitherMouse - Multiple mice, individual settings... Top peter723pan Posts: 2 Joined: 01 Sep 2014, 15:21 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 01 Sep 2014, 15:23 Finally find a software deal with Multiple mice , individual settings. I have a stupid handheld trackball which I hope make forward , backward buttons work as left and right buttons. And make left and right buttons do the forward , backward. When play games I use normal mouse not trackball. There are many ways to redefine buttons, but all of them work on all the mice at the same time same setting. Is it possible to add more buttons swap else than just left and right . Top elcomm Posts: 1 Joined: 06 Sep 2014, 22:05 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 06 Sep 2014, 22:10 Thank you, this made my day. I cant believe this is the only way to match up the speeds of your mouse and touchpad, seems like such an important feature with laptops, and no one else has done it. Anyways, thanks! Top dzid_ Posts: 1 Joined: 08 Sep 2014, 07:01 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 08 Sep 2014, 07:04 Can you give even more sensitivity to our mouses (more than 20) ? I have one mouse maxed out but I still would like more speed. Top gwarble Posts: 92 Joined: 30 Sep 2013, 15:01 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 09 Sep 2014, 23:26 elcomm: you're welcome dzid_: i've never tried, i'll look into it peter723pan: this isn't currently possible, and while i don't see it being a useful addition for most, it should be easy enough to implement... i'll try to work on a custom build, and ultimately implement the ""custom script"" i've been planning for this type of thing... theflysurfer: that sounds like a big project, if you look through the eithermouse code you should be able to see how the ""isolation"" works (which isn't really isolation, but more of a ""toggle"" of settings when the active mouse uses... if you focus on getting the rest of your system working with any mouse, you should be able to add those features into the ""toggle"" of eithermouse pretty easily... i can't say the rest will be easy but could be fun to figure out EitherMouse - Multiple mice, individual settings... Top JeremyRegnerus Posts: 2 Joined: 10 Sep 2014, 21:25 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 10 Sep 2014, 21:31 I wasn't sure if this was the appropriate place to make specific requests for EitherMouse. Anyway, I really like the tool, and it's solving a bit of a nerd need. I'm using it to run Virtual Table Top software for RPGs on a single machine. First monitor, I control what the players see. On the second monitor that interact with 'tokens'. I would really like for each player to have their own mouse, and limit their ability to accidentally go off screen to my main monitor. Today we just do this by passing the second mouse around to the players. I was wondering if it would be possible, or even that much harder to add this? Likewise, the only other thing I could think of is the ability to lock a mouse to a specific monitor. Top gwarble Posts: 92 Joined: 30 Sep 2013, 15:01 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 12 Sep 2014, 15:38 yeah this is the appropriate place to ask, but in all honesty I rarely have time to work on this much... i will add ""screen locking per mouse"" to my to do list as i think it could be useful for many types of users... I'm not sure how it would be accomplished, but I'll look in to it at some point... If you want to dig into the code you might be able to add this yourself... start by figuring out how to lock ""the"" mouse to a specific monitor (i'm sure there are ahk solutions for this already on the forums) and then start or stop this ability within eithermouse where it toggles the mouse settings (ie when switched to mouse1, lock to primary monitor, when switched to mouse2, lock to secondary monitor) I don't see any reason you can't have a mouse for each user, especially if this was implemented (and using ""Multicursor mode"") EitherMouse - Multiple mice, individual settings... Top JeremyRegnerus Posts: 2 Joined: 10 Sep 2014, 21:25 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 12 Sep 2014, 17:15 I actually 'accidentally' found it it already supports more than two mice last night when I bumped the track pad on my laptop. All of a sudden there was a mouse3 cursor on the screen. I was going to experiment with this more. Is the source available somewhere (SF or GIT), and what is it written in? I'm fairly familiar with VB and C# .NET. Top Bort Posts: 1 Joined: 16 Sep 2014, 16:19 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 16 Sep 2014, 16:28 I recently acquired a new Windows 8.1 64-bit laptop. After installing EitherMouse 0.5897, the settings for mouse, double click, and wheel speeds are all disabled (see attached screenshot). The sliders are dark, and cannot be moved. Everything above those three sliders appear to work fine (swap buttons, multi-cursor, etc). The issue persists for touchpad, usb, and bluetooth mouse. I tried running EM as admin but still get the same results. I think I had this issue before on my old computer some time ago with a previous version of EM, but I don't remember the fix. It may have simply been an update. To add to my woes, the links to previous versions are all dead (404)! Attachments Sreenshot of EM with settings disabled Top vosvos Posts: 1 Joined: 19 Sep 2014, 15:13 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 19 Sep 2014, 16:44 Thank you for excellent software. I have never seen real 2 mice working at once before. I have probably stupid question about modification of your program. Installation of EitherMouse includes .ahk files (EitherMouse.ahk etc.) that, I suppose, meant to be compiled into “EitherMouse.exe”. After compilation using Ahk2Exe.exe (as I did with my previous very simple scripts) I have got exe file. But this exe compiled from EitherMouse.ahk shows me error: “Error: Can’t load icon …” What should I do? Do I need to find those icons and put them in the same folder with EitherMouse.ahk? I would really appreciate if you will share those icons or if you will give any ideas about this error or compilation. Attachments error.png (3.96 KiB) Viewed 8397 times Top borahshadow Posts: 1 Joined: 22 Sep 2014, 02:38 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 22 Sep 2014, 02:42 Bort wrote:I recently acquired a new Windows 8.1 64-bit laptop. After installing EitherMouse 0.5897, the settings for mouse, double click, and wheel speeds are all disabled (see attached screenshot). The sliders are dark, and cannot be moved. Everything above those three sliders appear to work fine (swap buttons, multi-cursor, etc). The issue persists for touchpad, usb, and bluetooth mouse. I tried running EM as admin but still get the same results. I think I had this issue before on my old computer some time ago with a previous version of EM, but I don't remember the fix. It may have simply been an update. To add to my woes, the links to previous versions are all dead (404)! I have the same problem. I'm also running Windows 8.1 x64 Thank you so much for making this. It is exactly what I need but I need it for the mouse speed settings. Not the right and left handed swap. Top gwarble Posts: 92 Joined: 30 Sep 2013, 15:01 Re: EitherMouse 0.59 - Multiple mice, individual settings... Report this post Quote 22 Sep 2014, 12:33 re: Slider issue, see below vosvos: after modifying the code for eithermouse, just run the EitherMouse.ahk file instead of compiling it manually with ahk2exe, it will self-compile and maintain the icons when the script is run... JeremyReg: its written in autohotkey, and the code can be included with installation (tick the checkbox)... to learn about AHK see http://www.ahkscript.org ———————————————————————————————————— Thanks for the report guys, I'm investigating a cause and solution for this (disabled sliders)... Edit: And yes, old versions have been purged from the site (404)... i don't think they would have helped with this though Edit: I found the problem with the help of a user, and will try to get a fixed version updated soon... explanation and workaround can be derived from our communication: Do you have a custom font size? Maybe the slider isnt actually disabled but too small to move with the mouse? Can you try opening the window, tabbing down to a slider, and using left right cursors to see if it changes? Excellent. That did work. I wasn't super hopeful that it would because it looked like it was grayed out but when I tabbed down to it I could move it with the arrow keys. This is on my Lenovo Yoga 2 Pro which has a QHD screen (3200 x 1800) resolution. It's actually fairly common that I run into programs that have issues with the high DPI screen so I should have thought of that. It should be a relatively easy fix to change the size of the sliders to be a size that is relative to the system detected DPI right? so yes, a solution should be easy and I'll work on it as soon as I can, thanks again all for the bug reports Edit: Quick fix implemented, I'll let people test it out if desired before updating the main release: http://www.EitherMouse.com/0.5988/ Thanks - Joel EitherMouse - Multiple mice, individual settings... Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 130 posts Page 1 of 7 Jump to page: 1 2 3 4 5 … 7 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 12 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"Multiple mice, individual settings, auto swap mouse buttons on second mouse. Forum thread:."	"true"
"Mouse"	"MouseGestureL"	"http://www.vector.co.jp/download/file/winnt/util/fh633547.html"	"Control applications by mouse gestures. Gestures and actions can be defined via customizable interface. Documentation in English and Japanese - Japanese Homepage"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Vector：MouseGestureL.ahk (Windows10/8/7/Vista/XP/2000/NT / ユーティリティ) Vectorトップへ Vectorトップへ MouseGestureL.ahk 1.30 MGLahk130.zip ( Filesize:  4,352,025 ) ヒントダウンロードがうまくできない場合の解決方法 ヒントGoogle Chrome等でのダウンロード時の警告について ダウンロードはこちら ※ボタンを押すとダウンロードが始まります。 【7/21(木)迄】アメリカNo.1セキュリティが【53％OFF】　 詳しくはコチラ！ (c) 2016 Vector Inc.All Rights Reserved."	"null"	"null"	"Control applications by mouse gestures. Gestures and actions can be defined via customizable interface. Documentation in English and Japanese - Japanese Homepage"	"true"
"Mouse"	"link"	"http://hp.vector.co.jp/authors/VA018351/mglahk.html"	"Control applications by mouse gestures. Gestures and actions can be defined via customizable interface. Documentation in English and Japanese - Japanese Homepage"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"MouseGestureL.ahk MouseGestureL.ahk MouseGestureL.ahkは汎用マウスジェスチャーツールです。 マウスジェスチャーとは、「右ボタンを押しながらカーソルを上に移動」や、「右ボタンを押しながら左クリック」といったマウス入力によって、閉じる、最小化、サイズ変更などのウィンドウ操作や、キーボード操作、画面上のボタンを押す操作の疑似的な再現など、様々な操作を可能にするユーティリティーです。 マウスジェスチャーを使えば、メニューやツールバーなどの小さなボタンに狙いを定めてカーソルを移動させる必要がなくなるため、作業効率が飛躍的に向上します。 ◆ ダウンロード MouseGestureL.ahk Version 1.30 (2014/06/25) (ヘルプ作成: Shirubadappuru氏) Wacom対応差し替えモジュール (2014/10/02) ※ Wacom社製ペンタブレットとの組み合わせで不具合が出る 　 場合は、こちらに差し替えてご利用ください。 バージョン履歴 以前のバージョン プラグインなど 評価・コメント ◆ MouseGestureL.ahkの特徴 MouseGestureL.ahkは、AutoHotkey上で動作します。 AutoHotkeyはマウスやキーボード操作の自動化などを可能にするスクリプトエンジン。そしてMouseGestureL.ahkはマウスジェスチャーが入力されると、AutoHotkey用に記述されたスクリプトを実行する仕組みになっています。 そのため設定次第で出来ないことはない、と言っても過言ではないぐらいの自由度があります。 ただし簡単な動作は画面選択だけで設定できるようにデザインされているため、自分でスクリプトを記述する必要はありません。またAutoHotkeyのスクリプトは、プログラミングの知識がない人でも扱えるように配慮されているため、慣れることで少しずつ複雑な動作を割り当てることも可能になります。 　【その他の特徴】 ボタンを押したままジェスチャーを繰り返すことで連続的に割り当て動作を実行させるなど、特殊なジェスチャーの設定が可能です。 入力操作にマッチするジェスチャーを逐次絞り込みながら、動的に一覧表示するナビゲーション機能「リアルナビ」を搭載しています。 プラグインを導入することにより機能の拡張が出来ます。 クリップボード経由で、選択したジェスチャー設定だけを個々にエクスポート、インポートできます。 レジストリを使用していないためポータブルでの利用も可能です。 オープンソースなので将来別の開発者へ引き継がれる可能性もあり、開発打ち切りのリスクは低くなります。 64-bit版のWindowsでも動作します。 ◆ インストール ダウンロードしたMGLahk***.zipを適当な場所へ解凍してください。 ※ C:\Program Files など、UAC管理下での書き込みが制限される場所は避けてください。 【既にAutoHotkeyをご利用の場合】 　MouseGestureL.ahkを起動してください。 【MouseGestureL.ahkだけを使いたい場合】 　同梱のSetup.vbsを実行してください。 　ポータブルで利用する場合も同様です。 ◆ アンインストール フォルダごと削除してください。 レジストリは使用していません。 ◆ 手動インストール 万一Setup.vbsでのインストールに失敗した場合は、以下の手順で導入してください。 （Setup.vbsは手順1～4を自動的に実行するスクリプトです） 下記のリンクより、ご利用のWindows環境に適合するバージョンのAutoHotkeyをダウンロードします。 　　AutoHotkey 32-bit Unicode版 　　AutoHotkey 64-bit Unicode版 MouseGestureL.ahkのフォルダ直下へ、ダウンロードしたAutoHotkey******.zipを解凍します。 解凍されたAutoHotkey.exeをMouseGestureL.exeにリネームします。 ↓↓↓↓↓↓↓ MouseGestureL.exeを起動すると初回設定画面がオープンします。 以降の操作は添付のヘルプを参照してください。設定画面の「ヘルプ」ボタンを押せば表示されます。 Windowsの起動時に自動起動させたい場合は、スタートアップに登録してください。設定画面よりスタートアップへ登録できます。 ◆ オリジナル版からの変更内容 MouseGestureL.ahkは、かつてAutoHotkeyの普及活動をされていたlukewarm氏の手に成るMouseGesture.ahkの派生バージョンです。 MouseGestureL.ahkには、lukewarm氏から許諾を得て以下のような改良を加えています。 ジェスチャー認識処理の改善 稀に発生していたストロークの認識漏れが修正されています。 追加ナビの実装 矢印ナビ２、アドバンスドナビ、リアルナビの３種類が追加されています。 ジェスチャー軌跡表示機能の実装 マウスジェスチャーソフトでは一般的な機能ですが、オリジナルバージョンには実装されていませんでした。 設定画面のユーザーインタフェースの改善 ターゲットの階層管理やアイコン表示に対応し、煩雑な設定手順も大幅に簡略化されています。 プラグイン機能の実装 自作のスクリプトや、他の人が公開したスクリプトのファイルをコピーするだけで、機能を拡張することができます。 Unicode環境、および64-bit版Windows環境への対応 MouseGestureL.ahkは、""AutoHotkey 1.1""(旧名AutoHotkey_L)専用のスクリプトになっています。 オリジナルバージョンでも64-bit環境でほぼ問題なく動作しますが、一部の機能が正常に動作していなかったため、それらを修正しています。 多言語対応 標準で日本語と英語に対応し、言語モジュールの追加で他の言語にも対応できるようになっています。 その他 その他、細部挙動の改善と多くの不具合修正を行っています。 [PR]川越まつり"	"null"	"null"	"Control applications by mouse gestures. Gestures and actions can be defined via customizable interface. Documentation in English and Japanese - Japanese Homepage"	"true"
"Mouse"	"link"	"https://autohotkey.com/board/topic/46856-radial-menu-scripts-updated-07122014/"	"Powerful hotkey, launcher, mouse gestures system, and much more (skinable) - Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"RADIAL MENU scripts - migrated to new forum - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. RADIAL MENU scripts - migrated to new forum Started by Learning one , Nov 06 2009 03:08 PM Page 1 of 88 1 2 3 Next » Please log in to reply 1310 replies to this topic Learning one Members 1483 posts Last active: Jan 02 2016 02:30 PM Joined: 04 Apr 2009 WARNING: This is old thread. It is continued here. Here you can find my radial menu works: 1. Radial menu v4 - portable application which helps you to control computers with minimal effort. It's a thing to explore. 2. [module] RM2module 3. Radial menu designer (RMD) 4. Radial menu ""mg"" method 5. [module] Radial menus and docks - obsolete 6. Simple radial menu - obsolete 7. Radial menu v3 - obsolete 8. Radial menu v2 - obsolete 9. Radial menu v1 - obsolete work in progress - [module] RM3module   All menus are skinnable. All except 6,8,9 are using Tic's GDI+ function library. Thank you Tic! You can also find some radial menu experiments from other AHK community members here. Keywords: radial menu, pie menu, circle menu, circular menu, ring menu, Boris Mudrinić, Learning one Radial menu v4 Short description: Radial menu is a new method of giving commands to computers. It's a powerful hotkey, launcher, mouse gestures system, and much more. Packed in ergonomic interface, driven by AutoHotkey, highly adjustable and extendible, can do almost anything you wish. It consist of following components: - radial menu - mouse gestures - all AutoHotkey features (hotkeys, hotstrings, etc.) - some other extra features (Navigator, always on top toggle, etc.) For further information, please read Radial menu help file which is included in Radial menu package. Read releasing post. Default hotkeys: Rbutton (right mouse button): - Drag down and hold to show radial menu, release it to select item. - Drag in other directions to execute mouse gestures. Drag up shows Navigator. Lbutton (left mouse button): shows/hides submenus Download: - Radial menu v4.zip (portable application) - last change: 21.12.2015. (day.month.year) - last version: 4.43   32-bit and 64-bit versions. Download Radial menu v4.zip, which is 32-bit version, and follow instructions in RM help if you want to turn it into 64-bit version.   License is included in Radial menu package - last license change: 21.12.2015. (day.month.year) (updated links) Contact: contact link   Changelog: v4.00, v4.01, v4.20, v4.25, v4.26, v4.27, v4.29,  v4.30, v4.31, v4.32,  v4.33, v4.34,  v4.35, v4.36, v4.37, v4.38, v4.39, v4.40, v4.41, v4.42, v4.43. Starting form v4.43, further updates will be continued in new Radial menu scripts thread. ___________________ Notes: RM license prohibits (re)distribution without my written permission. Read also: Posting Radial menu code - regulation. RM license is only temporary, I can change it whenever I want, on any way I want. It's good to know that the author of this program is a lawyer. However, I hope that you will obey license/authorship terms and act like moral person in general not because you fear me as a lawyer, but because you respect my hard work and decision to share it with community.   #1 - Posted 06 November 2009 - 03:08 PM Back to top HotKeyIt Moderators 7439 posts Last active: Jun 22 2016 09:14 PM Joined: 18 Jun 2008 Looks nice May I give some comments While it is nice that mouse jumps back to the middle, a timer before execution would be good as well. So I would need to point on an item for defined mseconds before it gets executed. This way I could leave the area when accessed by accident as well Also would be great if this could be in a function style + variable hotkeys and easy to define menu. Something like ;Define menu = ItemName1|FunctionOrLabelOrFilePath:ItemName2|FunctionOrLabelOrFilePath... MenuItems=Notepad|notepad.exe:Windows`nExplorer|%A_WinDir%\explorer.exe ;User defined Hotkey Hotkey=RButton ;function RadialMenu(MenuItems, Hotkey=""RButton"") Each time you add/delete/change an Item you would need to change the code and this is not very practical, I think. #2 - Posted 06 November 2009 - 05:12 PM http://ahkscript.org/boards/ - AHK_H (2alpha) AHF TT _Struct WatchDir Yaml _Input ObjTree RapidHotkey DynaRun WinAPI Back to top MarcInSpace Members 33 posts Last active: Sep 04 2013 06:17 AM Joined: 23 Feb 2009 Wow, amazing! Thanks for this great script. Yet, I do agree completely with HotKeyIt about the timer (in fact that was my second reaction! [The first was suprise]) and the ""function style"". :wink: Greetings, Marc #3 - Posted 06 November 2009 - 06:53 PM Back to top Delusion Members 272 posts Last active: Jul 13 2014 09:04 PM Joined: 16 Jul 2008 nice looks great heres something similar : <!-- m -->http://www.autohotke... ... adial menu<!-- m --> #4 - Posted 06 November 2009 - 10:15 PM QuickSubs | Popcorn Movie Catalog All my scripts are just in AutoHotkey v1.0.48.05 Back to top Learning one Members 1483 posts Last active: Jan 02 2016 02:30 PM Joined: 04 Apr 2009 HotKeyIt, MarcInSpace, Delusion, thank you for compliments! @ HotKeyIt, MarcInSpace a timer before execution would be good as well. So I would need to point on an item for defined mseconds before it gets executed.Hmm... I prefer ""touch to select"". It's faster and simpler. Required actions to select comparison: * touch to select 1. click&hold Rbutton 2. drag mouse at some angle * point on an item for defined mseconds before it gets executed 1. click&hold Rbutton 2. drag mouse at some angle 3. you have to think how far you move your mouse 4. after you ""aimed"" item, you have to wait for defined mseconds Also would be great if this could be in a function styleYes, I definitely agree. But that will wait for a while... RADIAL MENU v2 I'm currently working on RADIAL MENU v2. It will look much better. I think I will be able to upload it tomorrow. So visit this topic again! #5 - Posted 07 November 2009 - 03:59 PM Back to top netfun81 Members 58 posts Last active: Feb 21 2010 09:32 AM Joined: 28 Oct 2006 Very nice. You might consider making an ini file or an easier way to add/change applications for those more new to AHK. #6 - Posted 07 November 2009 - 06:21 PM Back to top Learning one Members 1483 posts Last active: Jan 02 2016 02:30 PM Joined: 04 Apr 2009 Check out Radial menu v2! @netfun81 Very nice. You might consider making an ini file or an easier way to add/change applications for those more new to AHK.Thanks netfun81. Unfortunately, Radial menu v2 still don't use .ini file. #7 - Posted 08 November 2009 - 12:45 PM Back to top Delusion Members 272 posts Last active: Jul 13 2014 09:04 PM Joined: 16 Jul 2008 nice but i liked the buttons in the first on better...these bigger ones dont look so nice and yeah using an ini file for quickly adding and removing items would be nice #8 - Posted 08 November 2009 - 12:49 PM QuickSubs | Popcorn Movie Catalog All my scripts are just in AutoHotkey v1.0.48.05 Back to top Learning one Members 1483 posts Last active: Jan 02 2016 02:30 PM Joined: 04 Apr 2009 nice but i liked the buttons in the first on better...these bigger ones dont look so nice If you prefer smaller, 50x50 buttons - download this: <!-- m -->http://www.autohotke... ... 050x50.ahk<!-- m --> Creating .ini file will wait for a while... #9 - Posted 08 November 2009 - 06:05 PM Back to top Moebius Members 39 posts Last active: May 11 2015 08:46 PM Joined: 08 Mar 2009 nice script! The setting ""build effect = 0"" does not show the menu instantly. Maybe the menu should be configurable in a settings file? Submenus would also be nice. easyGestures in firefox uses the same method, so it conflicts with radialmenu... If you like, take a look at my page - i also tried to do a pie menu tool, but its vb6 & flash based. #10 - Posted 08 November 2009 - 08:09 PM http://monschein.org Back to top Learning one Members 1483 posts Last active: Jan 02 2016 02:30 PM Joined: 04 Apr 2009 Check out new script, Simple radial menu Different approach, best results. @ReflexNPG Thanks. use: BuildDelay = 0 BuildEffect = 0 I took a look at your page. I like your MoWaMouse. #11 - Posted 09 November 2009 - 10:16 AM Back to top Delusion Members 272 posts Last active: Jul 13 2014 09:04 PM Joined: 16 Jul 2008 nice i rewrote your new simple radial menu and made some small changes and improvements :  /*   Simple radial menu (40x40 buttons)       by Learning one   Modified by Delusion   AHK forum location: http://www.autohotkey.com/forum/viewtopic.php?p=308352#308352 */  ;________START_________________________________________|  #NoEnv #SingleInstance Force #Persistent SetBatchLines -1 SetWinDelay -1 SetControlDelay -1  ;________SETTINGS______________________________________|  $ProgramName := ""Radial Menu"", $Version := ""Simple Version"", $MainGui := ""1"" $BuildDelay := ""200"", $ButtonBack := ""Button5.png""  Item1 := ""Test"" Item2 := ""Meow"" Item3 := ""123"" Item4 := ""Boring"" Item5 := ""Test 2"" Item6 := ""blabla"" Item7 := ""000"" Item8 := ""15HFF""  ;________AUTO EXEC_____________________________________|  IFNotExist, %A_ScriptDir%\%$ButtonBack% {   URLDownloadToFile, http://www.autohotkey.net/~Delusion/%$ButtonBack%, %A_ScriptDir%\%$ButtonBack%   Sleep 500 }    GoSub BuildGui   Menu Tray, Tip, % $ProgramName A_Space $Version ""`n by Learning one (Modified by Delusion)""   Menu Tray, Icon, Shell32.dll, 44    RETURN  ;________BUILD GUI_____________________________________|  BuildGui:   Gui %$MainGui%: +AlwaysOnTop +ToolWindow -Caption +LastFound   WinSet, Region, 1-0 W180 H180 R180-180   Gui %$MainGui%: Font, s7 cwhite, Arial   Gui %$MainGui%: Color, fffffd   PicturePositions = x70 y10|x115 y25|x130 y70|x115 y115|x70 y130|x25 y115|x10 y70|x25 y25   TextPositions = x73 y13|x118 y28|x133 y73|x118 y118|x73 y133|x28 y118|x13 y73|x28 y28   Loop 8   {     Loop, Parse, PicturePositions, `|       Gui %$MainGui%: Add, Picture, %A_LoopField% w40 h40 BackgroundTrans gSub%A_Index%, %A_ScriptDir%\%$ButtonBack%     Loop, Parse, TextPositions, `|       Gui %$MainGui%: Add, Text, %A_LoopField% w34 h34 Center Bold BackgroundTrans gSub%A_Index%, % Item%A_Index%   }   Gui %$MainGui%:Add, Picture, x70 y70 w40 h40 gGuiHide, %A_ScriptDir%\%$ButtonBack%   Gui %$MainGui%:Add, Text, x73 y78 w34 h24 Center BackgroundTrans gGuiHide, Close`nMenu RETURN  ;________SUBROUTINES___________________________________|  Sub1: RETURN  Sub2: RETURN  Sub3: RETURN  Sub4: RETURN  Sub5: RETURN  Sub6: RETURN  Sub7: RETURN  Sub8: RETURN  ;________HOTKEY________________________________________|  RButton::   Sleep %$BuildDelay%   IF not (GetKeyState(""RButton"",""p""))   {     SendInput {RButton}     RETURN   }   CoordMode Mouse, Screen   MouseGetPos mx1, my1   RMGuiX := mx1 - 90   RMGuiY := my1 - 90   Gui %$MainGui%: Show, x%RMGuiX% y%RMGuiY% w180 h180, % $ProgramName   WinSet TransColor, fffffd 255, % $ProgramName RETURN  GuiHide:   SendInput {LButton up}   Gui %$MainGui%: Hide   CoordMode Mouse, Relative RETURN  #12 - Posted 09 November 2009 - 11:59 AM QuickSubs | Popcorn Movie Catalog All my scripts are just in AutoHotkey v1.0.48.05 Back to top Moebius Members 39 posts Last active: May 11 2015 08:46 PM Joined: 08 Mar 2009 i've set builddelay = 0 and buildeffect = 0 but it still draws each item one by one which takes some time... I like the simple radial menu - it works instantly. Here i have another 2 cents What about a dynamic number of menu items? And what about a taskmanager as radial menu? Thanks for sharing your scripts! #13 - Posted 09 November 2009 - 12:17 PM http://monschein.org Back to top Learning one Members 1483 posts Last active: Jan 02 2016 02:30 PM Joined: 04 Apr 2009 @Delusion eh, I also rewrote Simple radial menu before I saw your (nice ) modification... Simple radial menu is now in ""newbie friendly style"" one interesting new setting: UnfocusMenu = 1 ; Activates window that was active before pressing hotkey, so you can scroll it, type text, etc... @ReflexNPG In fact Gui-s are always shown one by one, but with this (0) settings, ti should be almost invisible. It is almost invisible on my computer... :roll: #14 - Posted 09 November 2009 - 09:11 PM Back to top doyle Members 335 posts Last active: Mar 02 2012 04:47 PM Joined: 14 Nov 2007 Great Script. I customised v2, so you can specify how many icons you want, and can define them at the start. I found that I didnt always require 8 icons. If you think it is a good idea, please add it. Thanks again. I have messed around with the button sizes though, so I wouldnt recommend using mine as is. Number = 5         ; Number of Icons  TextSize = 8		; Item's text size      Once when you get used to your radial menu, you will remember item's positions, and text size won't be so important to you. So you will select items by position in your mind, not by reading item's text.   TextColor = black	; Item's text color Font = Calibri		; Item's font  BuildDelay = 170	; menu will start to show itself after %BuildDelay% miliseconds. To show it instantly, set 0. This delay gives you opportunity to send normal RButton click without annoying menu showing. THE BEST THING TO DO is to change hotkey to XButton1 or XButton1 (if you have them - I don't) and use BuildDelay = 0. MButton is also good idea.  BuildEffect = 50	; menu items will show themself, one by one, in interval of %BuildEffect% ms. To show them all instantly, set 0.  ItemBounce = 1      ; 1 means: items will bounce when you select them. 0 means: items will not bounce. SoundOnSelect = 1	; 1 means: play sound when item is selected. 0 means: don't play sound. Of course, you can change sound... ; SoundOnShow		; Play with effects: you can easily add this by slightly modifying script... ; SoundOnDestroy	  Color = Black		; this is alternative background color, if script can't load picture (button picture). ButtonBack =  Button3.png	; button's background  Item1 = Calc Item2 = NotePad Item3 = Explorer Item4 = About Item5 = Item6 = Item7 = Item8 =  ;===Auto-execute======================================================================  StringTrimRight, Sname, A_ScriptName, 4 Menu, Tray, Tip, %Sname% Loop, %Number%                ; load item's background (fake button), set altenative background and font {    ; If you want to change item's background, try to use 50x50 images. Some other backgrounds are available on:    ; http://www.autohotkey.net/~Learning one/Radial Menu        ; Play with effects: small deviations in Add, Picture options have interesting effect:    ; x0 y-1 w69 h69     ; small shadow    ; x0 y-1 w71 h71     ; no shadow    Gui 9%A_Index%:Add, Picture, x0 y0 w32 h32 , %A_scriptdir%\%ButtonBack%    Gui 9%A_Index%:Font,  s%TextSize%, %Font%    Gui, Color, EEAA99    Gui +LastFound  ; Make the GUI window the last found window for use by the line below.    WinSet, TransColor, EEAA99 }  ;======Set item names====== ; This is just example. Build your own menu! You don't need to manually reposition item's text (like in Radial menu v1).  ; Play with effects: Remove BackgroundTrans in GuiTextOptions and set Color = 757500 (GUI's color) GuiTextOptions = x2 y28 w32 h32 c%TextColor% BackgroundTrans  Loop, %Number% {    current := Item%A_Index%    Gui 9%A_Index%:Add, Text, %GuiTextOptions% , %current%	; Auto build items 1-5 } ;==========================   ;===Hotkey============================================================================== RButton::   ; Press & hold to show menu. Touch items with mouse to select them. Release RButton to hide menu. THE BEST THING TO DO is to change hotkey to XButton1 or XButton1 if you have them ( I don't :( ) PressedTime = 0 CoordMode, mouse, Screen MouseGetPos, mx1, my1 SetTimer, RadialMenuClose, 35  Loop, %Number%      ; Draw items (GUIs) at exact positions --> 50x50 buttons {    if A_index = 1    {      RMx := mx1-25      RMy := my1-95       if BuildDelay       {          Sleep , %BuildDelay%      ; menu will start to show itself after %BuildDelay% ms          if not (GetKeyState(""RButton"",""p""))          Return       }    }    Else if A_index = 2    {       RMx := mx1+25       RMy := my1-75    }    Else if A_index = 3    {       RMx := mx1+45       RMy := my1-25    }    Else if A_index = 4    {       RMx := mx1+25       RMy := my1+25    }    Else if A_index = 5    {       RMx := mx1-25       RMy := my1+45    }    Else if A_index = 6    {       RMx := mx1-75       RMy := my1+25    }    Else if A_index = 7    {       RMx := mx1-95       RMy := my1-25    }    Else if A_index = 8    {       RMx := mx1-75       RMy := my1-75    }     Gui 9%A_Index%: +AlwaysOnTop +ToolWindow -caption +LastFound    ;WinSet, Region, 1-0 W50 H50 R25-25    Gui 9%A_Index%: Show, x%RMx% y%RMy% h40 w48, Item%A_Index%       WinSet, Transparent, 255, Item%A_Index%        Sleep, %BuildEffect%    if not (GetKeyState(""RButton"",""p""))    Return }  SetTimer, GetSelectedItem, 15 Return   ;===Subroutines========================================================================= GetSelectedItem:            ; menu items are identified by GUI's title! MouseGetPos, , , WinID WinGetTitle, Item, ahk_id %WinID%  if Item contains Item      ; This is just example. Build your own menu! {    CoordMode, mouse, Screen    MouseMove, %mx1%, %my1%    if Item = Item8         ; About Radial menu    {       if ItemBounce = 1 	  Gosub, ItemBounceOnSel 	  MsgBox, 64, About, Title:%A_Tab%Radial menu v2`nAuthor:%A_Tab%Boris Mudrinic (Learning one on AHK forum)`nContact:%A_Tab%boris-mudrinic@net.hr`n`nLicence:`nFree for non-commercial use.`nFor commercial use, e-mail me please.`n`nIf you will use Radial menu in your free software,`nmention author's name and contact.       Return    }    else if Item = Item7   ; Runs Windows Explorer    {       if SoundOnSelect = 1       SoundPlay, *-1    ; plays simple beep.       Run, %A_WinDir%\explorer.exe 	  if ItemBounce = 1 	  Gosub, ItemBounceOnSel       Return    }    else if Item = Item6   ; Runs Notepad    {       if SoundOnSelect = 1       SoundPlay, *-1    ; plays simple beep.       Run, notepad 	  if ItemBounce = 1 	  Gosub, ItemBounceOnSel       Return    }    else if Item = Item5   ; Runs Calculator    {       if SoundOnSelect = 1       SoundPlay, *-1    ; plays simple beep.       Run, %A_WinDir%\system32\calc.exe 	  if ItemBounce = 1 	  Gosub, ItemBounceOnSel       Return    }    else    {       if ItemBounce = 1       Gosub, ItemBounceOnSel       MsgBox,, You selected:, %Item%,1 	} } Return     RadialMenuClose: PressedTime++ if not (GetKeyState(""RButton"",""p"")) {    if (PressedTime < 7)   ; if user holded RButton for less than 210ms ...    SendInput, {RButton}   ; ... script will send normal RButton click        SetTimer, GetSelectedItem, off    SetTimer, RadialMenuClose, off     	; Fade out effect 	InitialTrans = 255  	Loop, 17 	{ 		Loop, %Number% 		WinSet, Transparent, %InitialTrans%, Item%A_Index% 		InitialTrans -= 15 		Sleep, 25			; change fade out speed if you wish 	} 	Loop, %Number% 	Gui 9%A_index%: Hide 	Return } Return  ItemBounceOnSel:        ; bounce effect Critical WinGetPos, XBounce, YBounce,,, %Item% SetTimer, RadialMenuClose, off SetTimer, GetSelectedItem, off SetWinDelay, 5          ; bounce speed  if Item = Item1 {    Loop, %Number%     {       if A_Index <= 4       YBounce -= 4      ; bounce lenght       Else       YBounce += 4       WinMove, %Item%, , %XBounce%, %YBounce%    } } else if Item = Item2 {    Loop, %Number%     {       if A_Index <= 4       {          XBounce += 4           YBounce -= 4       }       Else       {          XBounce -= 4           YBounce += 4       }       WinMove, %Item%, , %XBounce%, %YBounce%    } } else if Item = Item3 {    Loop, %Number%     {       if A_Index <= 4       XBounce += 4        Else       XBounce -= 4       WinMove, %Item%, , %XBounce%, %YBounce%    } } else if Item = Item4 {    Loop, %Number%     {       if A_Index <= 4       {          XBounce += 4           YBounce += 4       }       Else       {          XBounce -= 4           YBounce -= 4       }       WinMove, %Item%, , %XBounce%, %YBounce%    } } else if Item = Item5 {    Loop, %Number%     {       if A_Index <= 4       YBounce += 4       Else       YBounce -= 4       WinMove, %Item%, , %XBounce%, %YBounce%    } } else if Item = Item6 {    Loop, %Number%     {       if A_Index <= 4       {          XBounce -= 4           YBounce += 4       }       Else       {          XBounce += 4           YBounce -= 4       }       WinMove, %Item%, , %XBounce%, %YBounce%    } } else if Item = Item7 {    Loop, %Number%     {       if A_Index <= 4       XBounce -= 4        Else       XBounce += 4       WinMove, %Item%, , %XBounce%, %YBounce%    } } else if Item = Item8 {    Loop, %Number%     {       if A_Index <= 4       {          XBounce -= 4           YBounce -= 4       }       Else       {          XBounce += 4           YBounce += 4       }       WinMove, %Item%, , %XBounce%, %YBounce%    } }  SetWinDelay, 100    ; default SetTimer, GetSelectedItem, on SetTimer, RadialMenuClose, on Return   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; ExitApp Pause:: Suspend Pause,,1 return  Escape:: Suspend ExitApp Return  F7::Reload ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  #15 - Posted 10 November 2009 - 09:26 AM Back to top Page 1 of 88 1 2 3 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"Powerful hotkey, launcher, mouse gestures system, and much more (skinable) - Forum thread:"	"true"
"Typing"	"AutoComplete"	"https://github.com/Uberi/Autocomplete"	"Suggests and completes words as you type. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"39"	"7"	"16"	"GitHub - Uberi/Autocomplete: Suggests and completes words as you type! Write faster and more efficiently. Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 7 Star 39 Fork 16 Uberi/Autocomplete Code Issues 1 Pull requests 1 Pulse Graphs Suggests and completes words as you type! Write faster and more efficiently. http://www.autohotkey.com/board/topic/60998-autocomplete/ 16 commits 1 branch 4 releases 2 contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show 1.3 1.2 1.1 1.0 Nothing to show New pull request Latest commit c5eeb78 Dec 20, 2015 Uberi Update README.md Permalink Failed to load latest commit information. Autocomplete.ahk Fix unknown cursor positions. Dec 20, 2015 Icon.ico Add icon. Apr 24, 2014 README.md Update README.md Dec 20, 2015 Screenshot.png Add selection of suggestion by Alt + 1 to Alt + 0, speed up suggestin… Apr 24, 2014 WordList.txt Add selection of suggestion by Alt + 1 to Alt + 0, speed up suggestin… Apr 24, 2014 README.md Autocomplete by Uberi Suggests and completes words as you type! Write faster and more efficiently. Get the latest version See stable releases/binaries Using Extract the archive to a safe location. If you downloaded the binaries, open Autocomplete.exe. If you downloaded the source, make sure you have a recent version of AutoHotkey installed, and run Autocomplete.ahk. Start typing somewhere. After the first few characters, a suggestion box will appear. Use the Up and Down arrow keys to select an entry if the currently selected one is not the desired word. Press Enter or Tab to trigger the completion with the currently selected word. Alternatively, press one of Alt + 1, Alt + 2, ..., Alt + 9, Alt + 0 to trigger completion with the 1st, 2nd, ..., 9th, and 10th word, repectively. Advanced Click on the tray icon to bring up the settings dialog. The dialog allows you to configure settings such as the maximum number of results to show at a time and the number of characters to type before showing suggestions. The dialog also allows you to edit the wordlist by adding or removing words. All settings are saved automatically upon program exit. The wordlist is contained in WordList.txt. Each line represents a word. The list can be edited with a text editor, but ensure the editor supports larger files before doing so! Some may crash or hang upon editing such files. Settings are stored in Settings.ini in the program directory. This contains a few more settings not accessible in the settings dialog, mainly the key settings. Key settings are URL encoded lists of key names such as Space and d where each entry is separated by a newline (the URL encoded version of a newline is %0A). They can be edited to change the keys accepted by the program. Licence This program is provided under the 3-clause BSD license. In short, this gives you the right to modify and distribute the program as you please, as long as you make sure the notice below is accessible to the user. Copyright (c) 2013, Anthony Zhang All rights reserved.  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:  Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. Neither the name of the <ORGANIZATION> nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/Uberi/Autocomplete"	"Suggests and completes words as you type. Forum thread:."	"true"
"Typing"	"link"	"https://autohotkey.com/board/topic/60998-autocomplete/"	"Suggests and completes words as you type. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"39"	"7"	"16"	"GitHub - Uberi/Autocomplete: Suggests and completes words as you type! Write faster and more efficiently. Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 7 Star 39 Fork 16 Uberi/Autocomplete Code Issues 1 Pull requests 1 Pulse Graphs Suggests and completes words as you type! Write faster and more efficiently. http://www.autohotkey.com/board/topic/60998-autocomplete/ 16 commits 1 branch 4 releases 2 contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show 1.3 1.2 1.1 1.0 Nothing to show New pull request Latest commit c5eeb78 Dec 20, 2015 Uberi Update README.md Permalink Failed to load latest commit information. Autocomplete.ahk Fix unknown cursor positions. Dec 20, 2015 Icon.ico Add icon. Apr 24, 2014 README.md Update README.md Dec 20, 2015 Screenshot.png Add selection of suggestion by Alt + 1 to Alt + 0, speed up suggestin… Apr 24, 2014 WordList.txt Add selection of suggestion by Alt + 1 to Alt + 0, speed up suggestin… Apr 24, 2014 README.md Autocomplete by Uberi Suggests and completes words as you type! Write faster and more efficiently. Get the latest version See stable releases/binaries Using Extract the archive to a safe location. If you downloaded the binaries, open Autocomplete.exe. If you downloaded the source, make sure you have a recent version of AutoHotkey installed, and run Autocomplete.ahk. Start typing somewhere. After the first few characters, a suggestion box will appear. Use the Up and Down arrow keys to select an entry if the currently selected one is not the desired word. Press Enter or Tab to trigger the completion with the currently selected word. Alternatively, press one of Alt + 1, Alt + 2, ..., Alt + 9, Alt + 0 to trigger completion with the 1st, 2nd, ..., 9th, and 10th word, repectively. Advanced Click on the tray icon to bring up the settings dialog. The dialog allows you to configure settings such as the maximum number of results to show at a time and the number of characters to type before showing suggestions. The dialog also allows you to edit the wordlist by adding or removing words. All settings are saved automatically upon program exit. The wordlist is contained in WordList.txt. Each line represents a word. The list can be edited with a text editor, but ensure the editor supports larger files before doing so! Some may crash or hang upon editing such files. Settings are stored in Settings.ini in the program directory. This contains a few more settings not accessible in the settings dialog, mainly the key settings. Key settings are URL encoded lists of key names such as Space and d where each entry is separated by a newline (the URL encoded version of a newline is %0A). They can be edited to change the keys accepted by the program. Licence This program is provided under the 3-clause BSD license. In short, this gives you the right to modify and distribute the program as you please, as long as you make sure the notice below is accessible to the user. Copyright (c) 2013, Anthony Zhang All rights reserved.  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:  Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. Neither the name of the <ORGANIZATION> nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/Uberi/Autocomplete"	"Suggests and completes words as you type. Forum thread:."	"true"
"Typing"	"Half-QWERTY"	"https://autohotkey.com/board/topic/1257-half-qwerty-one-handed-typing/page-6#entry216183"	"One-handed Typing. Using the space bar as a modifier, the user can generate the characters of either side of a full-sized keyboard using only one hand. More information via Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Half-QWERTY: One-handed Typing - Page 6 - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. Half-QWERTY: One-handed Typing Started by jonny , Nov 16 2004 03:13 AM « Prev Page 6 of 12 4 5 6 7 8 Next » Please log in to reply 175 replies to this topic Calibran Guests Last active: Joined: -- I feel kinda lonely on this thread. My modest line is too modest to work, and is even redundant. Cool start. aCkRiTe has dug up and pointed this script, thank you aCkRiTe and thank you for the author   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; ; Capitalize letters after 1 second hold ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  #SingleInstance Force #Persistent #NoEnv SendMode, Input SetBatchLines, -1  KeyIsDown = 0 UpperDelay = 1000 UpperDelay *= -1 Return   KeyDown(key)    {         Global KeyIsDown         Global LastKey         If (KeyIsDown < 1 or Key <> LastKey)            {                 KeyIsDown := True                 LastKey := Key                 Send %Key%                 SetKeyDelay, 65535                 SetTimer, ReplaceWithUpper, %UpperDelay%            }         Return    }  KeyUp(Key)    {         Global KeyIsDown         Global LastKey         SetTimer, ReplaceWithUpper, Off         KeyIsDown := False         Return    }  ReplaceWithUpper: SetKeyDelay, -1 Send {Backspace}+%LastKey% Return  a:: KeyDown(""a"") b:: KeyDown(""b"") c:: KeyDown(""c"") d:: KeyDown(""d"") e:: KeyDown(""e"") f:: KeyDown(""f"") g:: KeyDown(""g"") h:: KeyDown(""h"") i:: KeyDown(""i"") j:: KeyDown(""j"") k:: KeyDown(""k"") l:: KeyDown(""l"") m:: KeyDown(""m"") n:: KeyDown(""n"") o:: KeyDown(""o"") p:: KeyDown(""p"") q:: KeyDown(""q"") r:: KeyDown(""r"") s:: KeyDown(""s"") t:: KeyDown(""t"") u:: KeyDown(""u"") v:: KeyDown(""v"") w:: KeyDown(""w"") x:: KeyDown(""x"") y:: KeyDown(""y"") z:: KeyDown(""z"")  a Up:: KeyUp(""a"") b Up:: KeyUp(""b"") c Up:: KeyUp(""c"") d Up:: KeyUp(""d"") e Up:: KeyUp(""e"") f Up:: KeyUp(""f"") g Up:: KeyUp(""g"") h Up:: KeyUp(""h"") i Up:: KeyUp(""i"") j Up:: KeyUp(""j"") k Up:: KeyUp(""k"") l Up:: KeyUp(""l"") m Up:: KeyUp(""m"") n Up:: KeyUp(""n"") o Up:: KeyUp(""o"") p Up:: KeyUp(""p"") q Up:: KeyUp(""q"") r Up:: KeyUp(""r"") s Up:: KeyUp(""s"") t Up:: KeyUp(""t"") u Up:: KeyUp(""u"") v Up:: KeyUp(""v"") w Up:: KeyUp(""w"") x Up:: KeyUp(""x"") y Up:: KeyUp(""y"") z Up:: KeyUp(""z"")   But I'm at a loss to make it compatible with Markus script. Any idea please? #76 - Posted 28 October 2008 - 01:27 PM Back to top SoLong&Thx4AllTheFish Members 4999 posts Last active: Joined: 27 May 2007 Note about AutoHotkey_L Unicode version: If you are running the AutoHotkey_L Unicode version be sure to save the script in Unicode encoding as well, otherwise you will get an error: Error at line 64. Line Text: ' Error: The leftmost character above is illegal in an expression. Edit3a - 2011-02-21 - Added URLDownloadToFile for missing icon and keyboard layout images downloaded from github if not found in %A_ScriptDir% - Added menu option to show keyboard layout in an AlwaysOnTop Gui (via Tray)  #SingleInstance, force ; Half-QWERTY: One-handed Typing - version 3a ; http://www.autohotkey.com/forum/viewtopic.php?p=228783#228783 ; ; HalfKeyboard invented by Matias Corporation between 1992 and 1996 ; Originally coded in AutoHotkey by jonny in 2004 ; Many thanks to Chris for helping him out with this script. ; Capslock hacks and `~ remap to '"" by Watcher ; This implementation was done by mbirth in 2007 ; ; version 3a script, mod by hugov: ; 2008-10-31: ; - mixed with ""Capitalize letters after 1 second hold"" at request of Calibran ;   http://www.autohotkey.com/forum/post-228311.html#228311 ;   just tested very briefly so try at your own peril :-) ; ; 2011-02-21 ; - Added URLDownloadToFile for missing icon and keyboard layout  ;   images downloaded from www.autohotkey.net if not found in %A_ScriptDir% ; - Added menu option to show keyboard layout in an AlwaysOnTop Gui (via Tray)  ; 2011-02-21 IfNotExist, %A_ScriptDir%\halfkeyboard.ico 	iICO=0 IfNotExist, %A_ScriptDir%\halfkeyboard_help.gif 	iHELP=0 If (iICO=0) or (iHELP=0) 	{ 	 MsgBox 4, Some Graphics files are missing, do you wish to download them from www.github.com? 	 IfMsgBox, Yes 		{ 		 URLDownloadToFile, https://raw.githubusercontent.com/hi5/_resources/master/halfqwertyfiles/halfkeyboard.ico, %A_ScriptDir%\halfkeyboard.ico ; for tray 		 URLDownloadToFile, https://raw.githubusercontent.com/hi5/_resources/master/halfqwertyfiles/halfkeyboard_help.gif, %A_ScriptDir%\halfkeyboard_help.gif ; for 5 sec help at caret pos, transparent GIF 		 URLDownloadToFile, https://raw.githubusercontent.com/hi5/_resources/master/halfqwertyfiles/halfkeyboard_help.png, %A_ScriptDir%\halfkeyboard_help.png ; for permanent gui transparent PNG 		} 	} ; /2011-02-21	 	 KeyIsDown = 0 UpperDelay = 1000 UpperDelay *= -1  IfExist, %A_ScriptDir%\halfkeyboard.ico ; mod 2011-02-21 	{ 	 Menu Tray, Icon, %A_ScriptDir%\HalfKeyboard.ico 	 Menu Tray, Tip, HalfKeyboard emulator 	 Menu Tray, Add, &Show Keyboard layout, MenuShowKeyboardLayout 	 Menu Tray, Add, E&xit, MenuExit 	 Menu Tray, NoStandard 	}    RegRead KLang, HKEY_CURRENT_USER, Keyboard Layout\Preload, 1 StringRight KLang, KLang, 4 If (!KLang)   KLang := A_Language  If (KLang = ""0407"") {   ; 0407 DE_de QWERTZ mirror set   original := ""^12345qwertasdfgyxcvb""   mirrored := ""ß09876poiuzölkjh-.,mn"" } Else If (KLang = ""040c"" || KLang = ""040C"") {   ; 040c FR_fr AZERTY mirror set            original := ""²&é"" . """""""" . ""'(azertqsdfgwxcvb""   ; split up string for better   mirrored := "")àç"" . ""_""  . ""è-poiuymlkjh!:;,n""   ; human readability } Else {   ; 0409 US_us QWERTY mirror set   original := ""``"" . ""12345qwertasdfgzxcvb""   ; split up string for better   mirrored := ""'""  . ""09876poiuy;lkjh/.,mn""   ; human readability }   ; Now define all hotkeys Loop % StrLen(original) {   c1 := SubStr(original, A_Index, 1)   c2 := SubStr(mirrored, A_Index, 1)   Hotkey Space & %c1%, DoHotkey   Hotkey Space & %c2%, DoHotkey   Hotkey %c1%, KeyDown   Hotkey %c1% UP, KeyUP   Hotkey %c2%, KeyDown ; see post by guest below seems to improve the script haven't tried this myself so comment these two lines if it doesn't work   Hotkey %c2% UP, KeyUP ; }  return   ; This key may help, as the space-on-up may get annoying, especially if you type fast. Control & Space::Suspend  ; Not exactly mirror but as close as we can get, Capslock enter, Tab backspace. Space & CapsLock::Send {Enter} Space & Tab::Send {Backspace}  ; If spacebar didn't modify anything, send a real space keystroke upon release. +Space::Send {Space} Space::Send {Space}  ; Define special key combos here (took them from RG's mod): ^1::Send {Home} ^2::Send {End} ^3::Send {Del}  ; General purpose DoHotkey:   StartTime := A_TickCount   StringRight ThisKey, A_ThisHotkey, 1   i1 := InStr(original, ThisKey)   i2 := InStr(mirrored, ThisKey)   If (i1+i2 = 0) {     MirrorKey := ThisKey   } Else If (i1 > 0) {     MirrorKey := SubStr(mirrored, i1, 1)   } Else {     MirrorKey := SubStr(original, i2, 1)   }     Modifiers := """"   If (GetKeyState(""LWin"") || GetKeyState(""RWin"")) {     Modifiers .= ""#""   }   If (GetKeyState(""Control"")) {     Modifiers .= ""^""   }   If (GetKeyState(""Alt"")) {     Modifiers .= ""!""   }   If (GetKeyState(""Shift"") + GetKeyState(""CapsLock"", ""T"") = 1) {     ; only add if Shift is held OR CapsLock is on (XOR) (both held down would result in value of 2)     Modifiers .= ""+""   }  /*   KeyWait, %ThisKey%, T1   Send %Modifiers%{%MirrorKey%}   If (A_TickCount - StartTime >= 1000)      {         StringUpper, MirrorKey, MirrorKey    Send {Backspace}+%MirrorKey% */  If (KeyIsDown < 1 or ThisKey <> LastKey)           {                KeyIsDown := True                LastKey := ThisKey                Send %Modifiers%{%MirrorKey%}                SetKeyDelay, 65535                SetTimer, ReplaceWithUpperMirror, %UpperDelay%           }  Return  Space & F1::   ; Help-screen using SplashImage   CoordMode Caret, Screen   y := A_CaretY + 20   If (y > A_ScreenHeight-100)     y := A_CaretY - 20 - 100   IfExist, %A_ScriptDir%\HalfKeyboard_help.gif ; 2011-02-21 for safety   	{ 	  SplashImage %A_ScriptDir%\HalfKeyboard_help.gif, B X%A_CaretX% Y%y% 	  Sleep 5000 	  SplashImage Off 	}   return  MenuShowKeyboardLayout: ; 2011-02-21 IfWinNotExist, HalfKeyboard - permanent keyboard layout 	{  	 Gui, +Owner +Toolwindow +AlwaysOnTop  	 Gui, Add, picture, x0 y0 w310 h104, %A_ScriptDir%\halfkeyboard_help.png 	 Gui, Show, w310 h104 NA, HalfKeyboard - permanent keyboard layout 	 Menu, Tray, Check, &Show Keyboard layout 	} Else 	{ 	 Gosub, GuiClose	 	}  Return  GuiClose: Menu, Tray, UnCheck, &Show Keyboard layout Gui, Destroy Return   MenuExit:   ExitApp Return  KeyDown:    Key:=A_ThisHotkey         If (KeyIsDown < 1 or Key <> LastKey)            {                 KeyIsDown := True                 LastKey := Key                 Send %Key%                 SetKeyDelay, 65535                 SetTimer, ReplaceWithUpper, %UpperDelay%            }         Return  KeyUp:    Key:=A_ThisHotkey         SetTimer, ReplaceWithUpper, Off         SetTimer, ReplaceWithUpperMirror, Off         KeyIsDown := False         Return  ReplaceWithUpper: SetKeyDelay, -1 Send {Backspace}+%LastKey% Return  ReplaceWithUpperMirror: SetKeyDelay, -1 Send {Backspace}+%MirrorKey% Return  Script below is the same as above apart from the built-in checks for the images and downloading... Edit3 - yet another attempt   #SingleInstance  ; HalfKeyboard invented by Matias Corporation between 1992 and 1996 ; Originally coded in AutoHotkey by jonny in 2004 ; Many thanks to Chris for helping him out with this script. ; Capslock hacks and `~ remap to '"" by Watcher ; This implementation was done by mbirth in 2007 ; ; mixed with ""Capitalize letters after 1 second hold"" at request of Calibran ; http://www.autohotkey.com/forum/post-228311.html#228311 ; just tested very briefly so try at your own peril :-)  KeyIsDown = 0 UpperDelay = 1000 UpperDelay *= -1  Menu Tray, Icon, HalfKeyboard.ico Menu Tray, Tip, HalfKeyboard emulator Menu Tray, Add, E&xit, MenuExit Menu Tray, NoStandard FileInstall HK_dn.gif, HalfKeyboard_help.gif  RegRead KLang, HKEY_CURRENT_USER, Keyboard Layout\Preload, 1 StringRight KLang, KLang, 4 If (!KLang)   KLang := A_Language  If (KLang = ""0407"") {   ; 0407 DE_de QWERTZ mirror set   original := ""^12345qwertasdfgyxcvb""   mirrored := ""ß09876poiuzölkjh-.,mn"" } Else If (KLang = ""040c"" || KLang = ""040C"") {   ; 040c FR_fr AZERTY mirror set            original := ""²&é"" . """""""" . ""'(azertqsdfgwxcvb""   ; split up string for better   mirrored := "")àç"" . ""_""  . ""è-poiuymlkjh!:;,n""   ; human readability } Else {   ; 0409 US_us QWERTY mirror set   original := ""``"" . ""12345qwertasdfgzxcvb""   ; split up string for better   mirrored := ""'""  . ""09876poiuy;lkjh/.,mn""   ; human readability }   ; Now define all hotkeys Loop % StrLen(original) {   c1 := SubStr(original, A_Index, 1)   c2 := SubStr(mirrored, A_Index, 1)   Hotkey Space & %c1%, DoHotkey   Hotkey Space & %c2%, DoHotkey   Hotkey %c1%, KeyDown  Hotkey %c1% UP, KeyUP [color=red]   Hotkey %c2%, KeyDown ; see post by guest below seems to improve the script haven't tried this myself so comment these two lines if it doesn't work   Hotkey %c2% UP, KeyUP ; [/color]  }  return   ; This key may help, as the space-on-up may get annoying, especially if you type fast. Control & Space::Suspend  ; Not exactly mirror but as close as we can get, Capslock enter, Tab backspace. Space & CapsLock::Send {Enter} Space & Tab::Send {Backspace}  ; If spacebar didn't modify anything, send a real space keystroke upon release. +Space::Send {Space} Space::Send {Space}    ; Define special key combos here (took them from RG's mod): ^1::Send {Home} ^2::Send {End} ^3::Send {Del}  ; General purpose DoHotkey:   StartTime := A_TickCount   StringRight ThisKey, A_ThisHotkey, 1   i1 := InStr(original, ThisKey)   i2 := InStr(mirrored, ThisKey)   If (i1+i2 = 0) {     MirrorKey := ThisKey   } Else If (i1 > 0) {     MirrorKey := SubStr(mirrored, i1, 1)   } Else {     MirrorKey := SubStr(original, i2, 1)   }     Modifiers := """"   If (GetKeyState(""LWin"") || GetKeyState(""RWin"")) {     Modifiers .= ""#""   }   If (GetKeyState(""Control"")) {     Modifiers .= ""^""   }   If (GetKeyState(""Alt"")) {     Modifiers .= ""!""   }   If (GetKeyState(""Shift"") + GetKeyState(""CapsLock"", ""T"") = 1) {     ; only add if Shift is held OR CapsLock is on (XOR) (both held down would result in value of 2)     Modifiers .= ""+""   }  /*   KeyWait, %ThisKey%, T1   Send %Modifiers%{%MirrorKey%}   If (A_TickCount - StartTime >= 1000)       {         StringUpper, MirrorKey, MirrorKey    Send {Backspace}+%MirrorKey% */  If (KeyIsDown < 1 or ThisKey <> LastKey)           {                KeyIsDown := True                LastKey := ThisKey                Send %Modifiers%{%MirrorKey%}                SetKeyDelay, 65535                SetTimer, ReplaceWithUpperMirror, %UpperDelay%           }  Return  Space & F1::   ; Help-screen using SplashImage   CoordMode Caret, Screen   y := A_CaretY + 20   If (y > A_ScreenHeight-100)     y := A_CaretY - 20 - 100   SplashImage HalfKeyboard_help.gif, B X%A_CaretX% Y%y%   Sleep 5000   SplashImage OFF return  MenuExit:   ExitApp Return  KeyDown:    Key:=A_ThisHotkey         If (KeyIsDown < 1 or Key <> LastKey)            {                 KeyIsDown := True                 LastKey := Key                 Send %Key%                 SetKeyDelay, 65535                 SetTimer, ReplaceWithUpper, %UpperDelay%            }         Return  KeyUp:    Key:=A_ThisHotkey         SetTimer, ReplaceWithUpper, Off         SetTimer, ReplaceWithUpperMirror, Off         KeyIsDown := False         Return  ReplaceWithUpper: SetKeyDelay, -1 Send {Backspace}+%LastKey% Return  ReplaceWithUpperMirror: SetKeyDelay, -1 Send {Backspace}+%MirrorKey% Return   Edit3a: See post by guest below for  Hotkey %c2%, KeyDown   Hotkey %c2% UP, KeyUP  - tip June 8 2009 #77 - Posted 31 October 2008 - 12:56 PM TF : Text files & strings lib Back to top Calibran Guests Last active: Joined: -- Thank you for your work HugoV, this is close to perfection. It works fine without space bar, but on mirrored upper keys it prints a second letter, in lower case. I'm no programmer and don't know what to do about it, but I'd sure appreciate any help. #78 - Posted 31 October 2008 - 03:13 PM Back to top SoLong&Thx4AllTheFish Members 4999 posts Last active: Joined: 27 May 2007 removed: script didn't perform as desired #79 - Posted 31 October 2008 - 03:55 PM TF : Text files & strings lib Back to top Calibran Guests Last active: Joined: -- HugoV, I've tested and re-tested your second edit, but it always doubles the pressed letter on key-up. Works fine on direct instances, but duplicates on mirrored ones. I'm pretty sure there's an easier way to do it - easier than the long string of remapped keys. By grabbing the key just before being printed, as it's in a variable, it might be possible to put it through an 'if' that's going to test how long it's been pressed, and then capitalize it with something along the line of the mirroring string. I don't know how to program it, I just got the idea, but I have a hunch the whole capitalization story might hold in a little scripted paragraph. Let me know if you got any idea... #80 - Posted 02 November 2008 - 11:13 PM Back to top SoLong&Thx4AllTheFish Members 4999 posts Last active: Joined: 27 May 2007 Bump. Try Edit3 above. #81 - Posted 04 November 2008 - 10:46 AM TF : Text files & strings lib Back to top saseith Guests Last active: Joined: -- Thank you very much for posting this great script. I broke my left hand about 4 weeks ago and this has been a lifesaver. I am using Jonny's original version of the script and I can type around 30-40 wpm on this now (though I type more like 80-100 two handed). As a computer science master's student this has been pretty much essential. Thank you again. #82 - Posted 05 November 2008 - 11:48 PM Back to top Calibran Guests Last active: Joined: -- HugoV, I've tested the edit 3 and it does a lot of funny things. I'm going away for a couple of weeks and I'll draft a proper bug report when I return. #83 - Posted 09 November 2008 - 12:31 PM Back to top Guest2 Guests Last active: Joined: -- just wanted to say thank you for this I'm using it right now #84 - Posted 21 November 2008 - 05:21 PM Back to top Calibran Guests Last active: Joined: -- HugoV, sorry was away longer than I thought. Any way I look at the edit 3 it does not work. It just doesn't. Maybe it's not doable. Ah well, thanks for trying anyway. Best to you! #85 - Posted 16 December 2008 - 03:43 AM Back to top SoLong&Thx4AllTheFish Members 4999 posts Last active: Joined: 27 May 2007 The Odd thing is that I have TYPED this with edit3 withOUT problems. Running WinXP, US keyboard/layout. Sorry it doesn't work for you. #86 - Posted 16 December 2008 - 04:08 PM TF : Text files & strings lib Back to top kdoske Members 138 posts Last active: Nov 06 2012 01:58 AM Joined: 17 Dec 2008 this is really great guys. I am typing one handed at this very moment. Im not really sure what problems you other guys are having but the edit three script works great for me. unfortunately my typing is pretty slow but i can see it getting better pretty quick. I love this and just wanted to say thanks for all the hours put into it. #87 - Posted 17 December 2008 - 05:14 AM Back to top Calibran Guests Last active: Joined: -- Ok so, I probably got a clash between the edit 3 and another script (I got a lot running). I'm flying away this morning (after a white night, yes), and get back in a month. I'll fix it then. Let you know the outcome. I'm delighted you got it to work HugoV. I look forward to using it. Thanks a lot for your expertise. #88 - Posted 20 December 2008 - 02:24 AM Back to top drowhunter Members 3 posts Last active: Sep 19 2010 05:29 PM Joined: 28 Dec 2008 i just stimbled across this thread and thought how perfect this script is for use with this! http://www.belkin.co...04_07n52te.html #89 - Posted 29 December 2008 - 02:31 AM Back to top Guests Last active: Joined: -- edit 3 works better if you add two lines in the loop defining the hotkeys    Hotkey %c2%, KeyDown   Hotkey %c2% UP, KeyUP  #90 - Posted 07 June 2009 - 11:03 PM Back to top « Prev Page 6 of 12 4 5 6 7 8 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"One-handed Typing. Using the space bar as a modifier, the user can generate the characters of either side of a full-sized keyboard using only one hand. More information via Forum thread:"	"true"
"Typing"	"link"	"https://autohotkey.com/board/topic/1257-half-qwerty-one-handed-typing/"	"One-handed Typing. Using the space bar as a modifier, the user can generate the characters of either side of a full-sized keyboard using only one hand. More information via Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Half-QWERTY: One-handed Typing - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. Half-QWERTY: One-handed Typing Started by jonny , Nov 16 2004 03:13 AM Page 1 of 12 1 2 3 Next » Please log in to reply 175 replies to this topic jonny Members 2951 posts Last active: Feb 24 2008 04:22 AM Joined: 13 Nov 2004 One-handed typing as a theory has been floating around for a long time. In fact, the first prototypes of the mouse were tested while using a one-handed keyboard, which usually mirrors both sides onto one. For more information on one-handed typing and the Half-qwerty layout I used for this, visit this link. There are already programs that do this, but I have yet to find a free one. Of course, if you really like this, you might consider a half-qwerty keyboard, a true half-keyboard, or a more exotic (and more proprietary) Frogpad. What this script does is it remaps the spacebar to be a modifier. When space is held, the keyboard is inverted, with the line of symmetry between g and h. Thus, e would become i, b would become n, p would become q, and so on. If the spacebar is depressed and released without pressing any other keys, a single space is sent. Modifier keys such as shift or control can be used in conjuction with Half-qwerty. ; Many thanks to Chris for helping me out with this script.  mirror_1 = 0 mirror_2 = 9 mirror_3 = 8 mirror_4 = 7 mirror_5 = 6 mirror_q = p mirror_w = o mirror_e = i mirror_r = u mirror_t = y mirror_a = `; mirror_s = l mirror_d = k mirror_f = j mirror_g = h mirror_z = / mirror_x = . mirror_c = , mirror_v = m mirror_b = n mirror_6 = 5 mirror_7 = 4 mirror_8 = 3 mirror_9 = 2 mirror_0 = 1 mirror_y = t mirror_u = r mirror_i = e mirror_o = w mirror_p = q mirror_h = g mirror_j = f mirror_k = d mirror_l = s mirror_n = b mirror_m = v return   ; This key may help, as the space-on-up may get annoying, especially if you type fast. Control & Space::Suspend  ; These keys are optional, but they may help if you are typing on the left-hand side. CapsLock::Send, {BackSpace} Space & CapsLock::Send, {Enter}  ; If spacebar didn't modify anything, send a real space keystroke upon release. space:: Send {space} return  space & 1:: space & 2:: space & 3:: space & 4:: space & 5:: space & q:: space & w:: space & e:: space & r:: space & t:: space & a:: space & s:: space & d:: space & f:: space & g:: space & z:: space & x:: space & c:: space & v:: space & b:: space & `;:: space & ,:: space & .:: space & /:: space & 6:: space & 7:: space & 8:: space & 9:: space & 0:: space & y:: space & u:: space & i:: space & o:: space & p:: space & h:: space & j:: space & k:: space & l:: space & n:: space & m:: ; Determine the mirror key, if there is one: if A_ThisHotkey = space & `;    MirrorKey = a else if A_ThisHotkey = space & ,    MirrorKey = c else if A_ThisHotkey = space & .    MirrorKey = x else if A_ThisHotkey = space & /    MirrorKey = z else  ; To avoid runtime errors due to invalid var names, do this part last. {    StringRight, ThisKey, A_ThisHotkey, 1    StringTrimRight, MirrorKey, mirror_%ThisKey%, 0  ; Retrieve ""array"" element.    if MirrorKey =  ; No mirror, script probably needs adjustment.       return }  Modifiers = GetKeyState, state1, LWin GetKeyState, state2, RWin state = %state1%%state2% if state <> UU  ; At least one Windows key is down.    Modifiers = %Modifiers%# GetKeyState, state1, Control if state1 = D    Modifiers = %Modifiers%^ GetKeyState, state1, Alt if state1 = D    Modifiers = %Modifiers%! GetKeyState, state1, Shift if state1 = D    Modifiers = %Modifiers%+ Send %Modifiers%{%MirrorKey%} return #1 - Posted 16 November 2004 - 03:13 AM Back to top Chris Administrators 10727 posts Last active: Joined: 02 Mar 2004 Looks great. Might be especially useful for players of flight sims who want to type messages without crashing the plane #2 - Posted 16 November 2004 - 12:51 PM Back to top cr33p Members 5 posts Last active: Nov 17 2004 06:45 PM Joined: 21 Oct 2004 Xlnt! I've been looking for a one-handed keyboard for some time - gotta prep the one-handed typing for when our next son arrives in January, so's I can still chat and hold the baby at the same time, heh. Awesome to see this accomplished in AHK :] Now, where to turn for tutorials and drills on how to actually learn how to type faster than two words a minute ... Incidentally, how difficult would it be to remap this setup to use only the number pad, as seen here: http://www.fourtytwo...d/one-hand.html - cause that's just pretty sexy. #3 - Posted 16 November 2004 - 01:04 PM Back to top jonny Members 2951 posts Last active: Feb 24 2008 04:22 AM Joined: 13 Nov 2004 I actually have heard of this before, but it didn't come to my mind as I was making this because I have a laptop. The numpad is almost impossible to use since it takes up half of the keyboard if it's activated. However, I do have a spare keyboard I can plug in if I need, which I do quite often. I'll see if I can whip something up. (As soon as I figure the logistics out. The page is somewhat confusing) #4 - Posted 16 November 2004 - 05:48 PM Back to top Guests Last active: Joined: -- I'll see if I can whip something up. (As soon as I figure the logistics out. The page is somewhat confusing) This looks like a much simpler system for using the numpad - two keystrokes per letter http://www.thumbscri...howitworks.html #5 - Posted 17 November 2004 - 06:27 AM Back to top jonny Members 2951 posts Last active: Feb 24 2008 04:22 AM Joined: 13 Nov 2004 Thank you VERY much, guest. Heh. That system was confusing to say the least, and it's three-letter combos and quoting were driving me crazy. The script should be up sometime today. I'll release it first with only the defined combos, then I may add some of my own, to bring it closer to the regular keyboard functionality. (One area that old numpad method didn't lack in) #6 - Posted 17 November 2004 - 04:11 PM Back to top Watcher Members 60 posts Last active: Apr 06 2005 01:57 PM Joined: 27 Dec 2004 I am typing this one handed as we speak, I find it strange that I already seem to know the fingering. I am going to try to use this exclusively for a while and give it an honest try, thanks for writing it! #7 - Posted 27 December 2004 - 11:44 PM Back to top Watcher Members 60 posts Last active: Apr 06 2005 01:57 PM Joined: 27 Dec 2004 I'm working on this part of your code: ; If spacebar didn't modify anything, send a real space keystroke upon release. space::   if A_TimeSinceThisHotkey < 300   { ;    msgbox OK, %A_TimeSinceThisHotkey% ms since %A_ThisHotkey% was pressed     Send {space}   } return  EDIT: Ok, I see now why that didn't work, but the question still remains, its it possible for me to know how long the user has been holding the space key and based on that time possibly ignore the keystroke all together? to attempt to remove the problem of pressing space and realizing that you didn't need to in the first place as mentioned the paper you refered to:  If the user depresses the space bar (state 1) and holds it down past the timeout value, the state changes to 2. The timeout serves to reduce the number of erroneous spaces generated as a side-effect of using the space bar as a modifier key. Occasionally, a typist will depress the space bar with the intention of mirroring the state of another key but then change their mind and release. Without the timeout, such actions would result in an unwanted space character. With it, the problem is alleviated.  but it seems the TimeSinceThisHotkey is always 0 no matter what. Any ideas on this? #8 - Posted 28 December 2004 - 10:11 AM Back to top Watcher Members 60 posts Last active: Apr 06 2005 01:57 PM Joined: 27 Dec 2004 Unless there is a way to determine how long the space has been pressed that I have yet too find, I would say this is about all I can do with this script. I have had, and am still having a blast with it. Yea, I'm easily entertained. :shock: Here is the final version of the script.  ; Many thanks to Chris for helping me out with this script. ; Capslock hacks and `~ remap to '"" by Watcher  mirror_1 = 0 mirror_2 = 9 mirror_3 = 8 mirror_4 = 7 mirror_5 = 6 mirror_q = p mirror_w = o mirror_e = i mirror_r = u mirror_t = y mirror_a = `; mirror_s = l mirror_d = k mirror_f = j mirror_g = h mirror_z = / mirror_x = . mirror_c = , mirror_v = m mirror_b = n mirror_6 = 5 mirror_7 = 4 mirror_8 = 3 mirror_9 = 2 mirror_0 = 1 mirror_y = t mirror_u = r mirror_i = e mirror_o = w mirror_p = q mirror_h = g mirror_j = f mirror_k = d mirror_l = s mirror_n = b mirror_m = v return  ; This key may help, as the space-on-up may get annoying, especially if you type fast. Control & Space::Suspend  ; Not exactly mirror but as close as we can get, Capslock enter, Tab backspace. Space & CapsLock::Send {Enter} Space & Tab::Send {Backspace}  ; Without this capslock would shift only letters, this resolves that issue. +CapsLock::   ; Must catch capslock and Shift capslock to make this work. CapsLock::   if CapsState = D   {     CapsState = U     Send {LShift Up}   }   else   {     CapsState = D     Send {LShift Down}   }   return  Shift::CapsState = U  ; User pressed shift which toggles shift back up. ; The only strange part of this setup is that although capslock will toggle ; shift state, hitting the shift key will not toggle, it will act as a shift ; key reguardless of the capslock state and release afterward.   ; If spacebar didn't modify anything, send a real space keystroke upon release. space:: Send {space} return  space & `:: space & 1:: space & 2:: space & 3:: space & 4:: space & 5:: space & q:: space & w:: space & e:: space & r:: space & t:: space & a:: space & s:: space & d:: space & f:: space & g:: space & z:: space & x:: space & c:: space & v:: space & b:: space & `;:: space & ,:: space & .:: space & /:: space & 6:: space & 7:: space & 8:: space & 9:: space & 0:: space & y:: space & u:: space & i:: space & o:: space & p:: space & h:: space & j:: space & k:: space & l:: space & n:: space & m:: ; Determine the mirror key, if there is one: if A_ThisHotkey = space & ``    MirrorKey = ' else if A_ThisHotkey = space & `;    MirrorKey = a else if A_ThisHotkey = space & ,    MirrorKey = c else if A_ThisHotkey = space & .    MirrorKey = x else if A_ThisHotkey = space & /    MirrorKey = z else  ; To avoid runtime errors due to invalid var names, do this part last. {    StringRight, ThisKey, A_ThisHotkey, 1    StringTrimRight, MirrorKey, mirror_%ThisKey%, 0  ; Retrieve ""array"" element.    if MirrorKey =  ; No mirror, script probably needs adjustment.       return }  Modifiers = GetKeyState, state1, LWin GetKeyState, state2, RWin state = %state1%%state2% if state <> UU  ; At least one Windows key is down.    Modifiers = %Modifiers%# GetKeyState, state1, Control if state1 = D    Modifiers = %Modifiers%^ GetKeyState, state1, Alt if state1 = D    Modifiers = %Modifiers%! GetKeyState, state1, Shift if state1 = D    Modifiers = %Modifiers%+ Send %Modifiers%{%MirrorKey%} return  #9 - Posted 28 December 2004 - 05:32 PM Back to top jonny Members 2951 posts Last active: Feb 24 2008 04:22 AM Joined: 13 Nov 2004 Thanks for sharing, Watcher! I'll give it a go. #10 - Posted 28 December 2004 - 10:32 PM Back to top vorchatwo Guests Last active: Joined: -- Why not just open your Keymap prog in: start/programs/accessories/system tools Then just double-click the text you want and hit the copy button. It will copy it to the clipboard where you can paste it anywhere, in some instances it will put it directly into a prog (I think) such as Word. Now if someone would write a program similar to Keymap but also include a clickable spot for us to customize. I.e. have 10 or so ""letters"" that can be customized to put out an entire word (like yes, no, the, etc), that would rock. Then all you would need to do is to click the letter or custom letter, hit copy, and paste it into what ever you want. Heck, a good programmer might be able to make the letters/strings show up (as it MIGHT with Word) in other programs like ICQ, AOL IM, etc. If I knew how to write a font file it would be easy to just have your own font file (which is what the keymap prog works off from, i believe) and get rid of the keys you dont need. You just would have the customizable ""letters"" to use. thats all, c-ya's P.S. Check out the mouse stroke program called StrokeIt, it helps alot. #11 - Posted 29 December 2004 - 06:19 AM Back to top Watcher Members 60 posts Last active: Apr 06 2005 01:57 PM Joined: 27 Dec 2004 Why not just open your Keymap prog in: start/programs/accessories/system tools Then just double-click the text you want and hit the copy button. I think you misunderstand what this program does. The purpose of the script is to permit one handed typing. Now if someone would write a program similar to Keymap but also include a clickable spot for us to customize. I.e. have 10 or so ""letters"" that can be customized to put out an entire word (like yes, no, the, etc), that would rock. This is just the type of thing AutoHotkey was made for, you might want to check into its ability to do something like type in 'btw' and have AutoHotkey translate that on the fly for you to 'by the way'. Is that what you were looking for? #12 - Posted 30 December 2004 - 06:16 AM Back to top Assistive Tech Guests Last active: Joined: -- I was wondering if you could insert a onscreen keyboard that reflects the key-layout while the spacebar was pressed? i.e. http://www.autohotke...ardOnScreen.htm Thanks, Assistive Tech #13 - Posted 31 March 2005 - 02:25 PM Back to top Chris Administrators 10727 posts Last active: Joined: 02 Mar 2004 Do you mean show the on-screen keyboard while spacebar is pressed and hide it when space bar is released? If you add the following two lines near the bottom of the script, that is close to a complete solution (the window appears upon startup but goes away the first time you release the space bar): ~space::Gui, Show ~space up::Gui, Hide As a possibly better alternative, you could make Win+Space a hotkey to hide/show the keyboard by adding the following line right above K_ShowHide: #Space:: k_ShowHide: ; << This line is already present. (but you should remove the ~space hotkeys if you use the above method) #14 - Posted 31 March 2005 - 06:53 PM Back to top Assistive Tech Guests Last active: Joined: -- No. Actually reverse. So the keyboard keys switch position. i.e. F switches to J and G to H. Assistive Tech #15 - Posted 31 March 2005 - 07:36 PM Back to top Page 1 of 12 1 2 3 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"One-handed Typing. Using the space bar as a modifier, the user can generate the characters of either side of a full-sized keyboard using only one hand. More information via Forum thread:"	"true"
"Typing"	"Lintalist"	"http://lintalist.github.io/"	"Searchable interactive lists to copy & paste text with plugins. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Lintalist - Searchable interactive texts to copy & paste text, run scripts, using easily exchangeable bundles Lintalist allows you to store and (incrementally) search and edit texts in bundles and paste a selected text in your active program. The text can be interactive, for example you can automatically insert the current time and date, ask for (basic) user input or make a selection from a list etc and finally it can also run a script. You can use keyboard shortcuts or abbreviations to paste the text (or run the script) without opening the search window. You can extend Lintalist by writing your own plugins. Lintalist is open source and developed in AutoHotkey, an easy to learn scripting language for Windows. [WinXP(sp3)/Vista/7/8] As of LintaList v1.1 several types of formatted text are supported in Snippets. doc rev. 20160625 Program Introduction Installing Lintalist Start searching Using Shortcuts (Hotkeys) Using Shorthand (Abbrev.) Lintalist Keyboard Shortcuts Tray Menu Configuration Command line parameters FAQ & Known Issues History (changelog) Bundles Lintalist Bundles Introduction Snippets & Bundles plugins (how to) Formatted Text Snippets Editing Bundles and Snippets Managing Bundles Load All Bundles (via tray) Reload Bundles (via tray) Feedback Issues at GH (preferred) autohotkey.com forum (Guest posting allowed) Portablefreeware.com Donationcoder.com AlternativeTo Download Lintalist 1.8.1 Download (incl. source): Latest release (720 kb) Simply unpack and run lintalist.ahk or lintalist.exe Lintalist is a portable application. It stores all settings and bundles in the folder the program resides in. More... Lintalist Source code: github.com/lintalist/lintalist Lintalist Bundles: github.com/lintalist/lintalist-bundles/ Videos: General; HTML/MD; Formatted; and Plugins   Introduction  As noted above Lintalist allows you to store and (incrementally) search and edit texts in bundles and paste a selected text in your active program.  The texts, shortcuts, abbreviations and scripts are called snippets and they are stored in a so called bundle. A bundle is a simple text file, making it easy to understand, maintain and exchange bundles between users.  The bundles are context sensitive: based on the (partial) window title of the currently active program it will try to load one or more matching bundles, this will allow you to use the same shortcuts and shorthands in different applications and files making it even more flexible. You don't have to use or remember any shortcuts or shorthands because you can search your bundles at any time by opening the search window. Think of it as text-expander which will save you countless keystrokes and has a number of additional features: hotkeys, full text search, plugins and scripts. Some might compare it to the ""tag list"" or ""clip libraries"" you might find in many text editors.  Bundles and Snippets can be edited using the Lintalist Bundle & Snippet Editors OR in your preferred text editor.  For example: If you are editing a HTML file, Lintalist could use both a HTML and CSS bundle, but if you are editing a CSS file only the CSS Bundle is loaded. So, in your HTML file the shortcut ctrl+b can insert <strong></strong> at the caret position (or wrap the tag around the selected text) and while editing your CSS file the shortcut ctrl+b can insert font-style: bold; at the caret position. If a shortcut is found in multiple active bundles a pop-up-menu will appear so you can choose which snippet & bundle you prefer.  Note: although Lintalist can expand abbreviations it is not intended to replicate or replace the native AutoHotkey Hotstrings features, see autohotkey.com/docs/Hotstrings.htm for an introduction and description of all the options.  If you find this inconvenient, edit one of the snippets and change the shortcut or shorthand. This program is written in AutoHotkey, a free, open-source (scripting) utility for Windows. Learn more at autohotkey.com.  Lintalist is a portable application. It stores all settings and bundles in the folder the program resides in.   When you run it for the very first time it does ask if you want a shortcut on your desktop or would like to automatically start it with Windows but you don't have to do that. You can run the program from a USB drive or dropbox account for example.  If you want to take your copy of Lintalist with you all you have to do is copy the Lintalist folder. Same goes for making a backup.   Full Feature List:  - Full text snippet search using four different search modes - Context sensitive bundles - Abbreviations for your favourite snippets (Hotstrings in AutoHotkey terminology) - Shortcuts for your favourite snippets (Hotkeys in AutoHotkey terminology) - Run (AutoHotkey-)scripts - Local variables (user specific) - Bundle converters (simple lists, CSV, UltraEdit, Texter) - Portable application - Plugins are easy to develop, included by default are:   - return caret to position in text   - insert date & time incl. dates and time math   - calendar   - user input   - select item from a list   - use clipboard   - use selected text   - counters (can be created on the fly)   - chain snippets (insert the text of one snippet into another)   - insert text from file   - formatted text and images using HTML, Markdown, RTF and Image   Installing Lintalist  Installing Lintalist is easy, just download the ZIP file and unpack it in a folder of your preference. Make sure you have write permissions for the destination folder (i.e. don't unpack into a folder like ""C:\Program Files""). It is probably easiest to work with if you place it in your ""My Documents"" folder as this will make it easier for Lintalist to update your bundles while you are using them. Lintalist is fully portable and doesn't write any settings to the registry, so you can run it directly from a USB flash drive or DropBox folder for example.  If you are already an AutoHotkey user and have it installed, it is recommended to run Lintalist.ahk, this will ensure you will be running Lintalist with your preferred version of AutoHotkey. If you don't have AutoHotkey installed you can start Lintalist.exe.  Notes: - Lintalist.exe: A renamed AutoHotkey.exe (v1.1.24 32-bit Unicode, See https://autohotkey.com/ and/or https://autohotkey.com/download/) - Lintalist.ahk: The actual (main) source code of the program (see https://github.com/lintalist/lintalist)   Normal use: Starting Lintalist and searching for a Snippet  If Lintalist is running you can activate the search window by pressing CAPSLOCK, the default hotkey. You can change this hotkey via the configuration menu accessible via the tray menu by right clicking on the Lintalist icon ).  Based on the active program title, one or more bundles will be loaded into the search window so you can start searching:  Lintalist search window:  1: Type query. 2: Menu + search options. 3: Result list with Part 1, Part 2, Key(board shortcut), Short(hand, abbreviation). Columns are dynamic, if part 2, key or short are not present in the loaded bundle(s) they will not be displayed. 4: Preview of top most or selected snippet text. In statusbar: loaded bundle(s) and hits / number of snippets.  If you press the same hotkey again while the Lintalist Search window is active it will toggle between the Wide & Narrow view. You can set the width and height of both views via the configuration menu.  While you type, the number of results will decrease (called incremental search or quick filter). A small icon indicates if it is purely a text snippet  or if it actually will run a script .  You can turn the icons on and off via the configuration menu (ShowIcons setting), you can also influence the order of the results by setting various sorting options (see SortByUsage and ColumnSort settings).  After pressing ENTER on a selected entry from the results list, by default the text (Part1) is pasted in the active program (note the explanation above). SHIFT+ENTER and ENTER will use the first item in the results list unless you have selected another item with the arrow keys. Depending on the snippet either a text is pasted OR a script is run (note explanation above).   You can also use the Up, Down, Page Up and Page Down keys to navigate through the list. You can select a different bundle or load all bundles via the Bundle menu. If you choose a bundle from the bundle menu (Alt+b), that bundle will be locked and always remain active until you unlock it (Alt+l).  What happens when you (double) click on an entry in the list is determined by a setting in the configuration menu. (SingleClickSends and DoubleClickSends setting)  Default bundle: there is also a default bundle which is always loaded - unless you lock a specific bundle - that way you always have your generic snippets available in every program.   If you have no need for context sensitive bundles, simply make use of the default bundle and put in all your snippets. In such a case you could also lock the default bundle although there should be no need to do so.   Search options:  You can search for text in your bundles using four different methods:     Method Description    Rglr Alt+r is Regular or Normal search: the text you type must be found literally Example: Typing 'searching text' will find 'searching text' but NOT 'searching for text' Fzzy Alt+z is Fuzzy search: the text you type can be found anywhere making it more flexible to narrow down the results. Example: Typing 'sea tex' will find 'searching text' but ALSO 'searching for text' or 'text about the sea' RgEx Alt+x is Regular Expression search (Perl-compatible, PCRE) so you can search for patterns Example: se\w*g will find 'searching' 'sewing' etc. See autohotkey.com/docs/commands/RegExMatch.htm for more information about using Regular expression for searching [see notes about RgEx search below for some background info as not ALL Regular Expressions may produce the expected results] Magc Alt+m is Magic search (QuickSilver like search - experimental) Example: Typing 'sax' will find 'searching text'    Case (in)sensitive search    Use Case Alt+c to make your searches case sensitive.  In the area below the search results you will see the preview window of the currently active item in the bundle (Part1 by default but this can be changed via the configuration menu and settings.ini).  The statusbar shows which bundles are loaded and how many items were found out of the total items.  You can control the maximum number of search results and the maximum number of snippets that you can see in the results list.   Which sections of the snippets are searched?  It will search for a match in Part1, Part2 and Shorthand (so not in the Shortcut and not in the Script code). Note that in order to show a more legible text in the results list, Part1 and Part2 are shown differently if they are multi-line texts:  A new line is replaced by \n and a tab by \t and it will search these texts and not the original multi-line (but the original ones will be used when the texts are pasted, once you see it in action couple of times you will get used to it pretty quickly)   RegEx & Case sensitive search  <techtalk> If the Case check-box is not checked your searches will be case-insensitive. When using the RegEx search method the ""i)"" option for the regular expression will automatically be inserted before each snippet is searched. This may lead to unexpected results if you pass on other options for your RegEx search.   Example: The case-insensitive RegEx 'se\w*g' it is actually using the following regular expression 'i)se\w*g' while searching. This is done for convenience (otherwise you would have to type i) every time you wanted to do a case-insensitive search (RegEx is by default case sensitive). If you want to pass on extra options it is best to turn Case sensitive ON and add the options you need as described here autohotkey.com/docs/commands/RegExMatch.htm#Options. This behaviour may change in future version of Lintalist. </techtalk>  Search letter variations [v1.7+]   Sometimes accented letters are part of the text you are searching for. These can be difficult or slow to type. By adding the variations of these letters to the search string you can search for cafe but still find café. So the 'e' in the query will be translated to searching for 'eéèêḙěĕẽḛẻėëēȩęᶒɇȅếềễểḝḗḕȇẹệæǽǣœᵫ'. When active all search modes will use a Regular Expression (Regular and Fuzzy) (De)Activate the setting via the Lv? checkbox in the Search GUI (Alt+v) or the SearchLetterVariations setting in the Configuration menu. More information in the comments of 'include\LetterVariations.ahk'   Omnisearch (search all bundles)  By default you are only searching in the loaded bundles, you can however search in all bundles using the following methods:  1. Load All Bundles  You can Load all bundles:  - use the tray many, select Load all bundles and bring up the search GUI; or - bring up the search GUI, bundle menu, first option: Load all bundles  This has the disadvantage that it also sets the Locked state so next time you bring up the search GUI you are searching in all bundles again and you have to unlock it.  2. Omnisearch query  When you start your query with a predefined character (@ by default) Lintalist will search in all bundles independent of the ones that are currently loaded or locked in the search Gui. You can define this character in the settings (OmniChar). If you don't want to use Omnisearch while typing a query simply disable it by erasing the OmniChar in the settings menu.  Query: state -> will find ""state"" in the currently loaded bundle(s) Query: @state -> will find ""state"" in all bundles  3. Omnisearch shortcuts  - While search GUI is active: press F2 to toggle the Omnisearch. - If you press Ctrl+Capslock the search GUI is opened in Omnisearch mode (tip: use F2 to toggle). You can define the hotkey in the settings (StartOmniSearchHotkey)  Note: while using option 2 & 3 the text ""(All)"" will be added to the statusbar (bottom right) to indicate you are using Omnisearch when the results are updated.     Using Shortcuts (Hotkeys)  If the snippet definition includes a shortcut and is part of a currently active bundle you can insert the text from Part 1 OR run the script by pressing the hotkey WITHOUT activating the Lintalist search window. Shortcuts are disabled while the Lintalist search window is active.   You can enable / disable the use of Shortcuts via the Tray menu   Using Shorthand (Abbreviations)  If the snippet definition includes a shorthand and is part of a currently active bundle you can insert the text from Part 1 OR run the script by typing the abbreviation (= the shorthand) followed by a Space or Tab WITHOUT activating the Lintalist search window. Shorthand is disabled while the Lintalist search window is active.  You can enable / disable the use of Shorthands via the Tray menu   Lintalist Keyboard Shortcuts  Apart from the hotkeys defined in bundles, Lintalist has two general sets of hotkeys, one while Lintalist waits in the background and one while the search window is active. Bring up the search window just press CAPSLOCK (default setting)  Shortcuts while search window is not active    Keys Description   Capslock Start Searching (Open Lintalist searching window, change via config). If already active you can toggle between Wide and Narrow view. Ctrl+Capslock Start Searching in Omnisearch mode (Open Lintalist searching window, change via config). Winkey+z Start Quick search Ctrl+Winkey+q Quit Lintalist    Active Lintalist Gui     Keys Description   Esc Close Search Window Enter Paste Found Text (Part 1) or Run Script *1 Shift+Enter Paste Found Text (Part 2) or Run Script *1 Ctrl+Enter Paste Found Text (Part 1) and DO NOT run script Ctrl+Shift+Enter Paste Found Text (Part 2) and DO NOT run script F2 Omnisearch (toggle) search in all bundles F4 Edit Snippet F5 Copy Snippet and Edit (current bundle) F6 Move Snippet to another bundle F7 Add new Snippet F8 Delete Snippet F10 Bundle properties Ctrl+1..5 1: Sort Part 1 (toggle) 2: Sort Part 2 (toggle) 3: Sort Shorthand (toggle) 4: Sort Key (toggle) 5: Sort Bundle name (toggle) The sort will work even the column is not visible - for example if you do not show the Bundle name in the search results (see DisplayBundle) you can still sort it.    *1 - If Scripts are Paused the script - if any - will not run and text will be sent    - The action for a single- or doubleclick with the left mouse button can be defined in the Configuration menu      (SingleClickSends and DoubleClickSends)   Tray Menu  - Load All Bundles - Configuration - Reload Bundles - Pause Lintalist - Pause Shortcut - Pause Shorthand - Pause Scripts - Help - Exit   Load All Bundles  You can tell Lintalist to simply load all bundles via the Tray menu or Bundle menu (Alt+b), these will automatically be locked until you either choose a specific bundle from the Bundle menu OR unlock it (Alt+l) in search window).   Reload Bundles  If you have added or removed a new bundle you must reload them all to ensure they are read in memory so they can be searched and new or changed shortcuts and shorthands are correctly updated.    Pause  You can pause Lintalist entirely or pause Shortcuts, Shorthand and Scripts separately. Note: you can also bypass a script with Ctrl-Enter and Ctrl-Shift-Enter, see Lintalist Keyboard Shortcuts if you select a snippet in the search window.   Configuration  You can either edit the settings.ini file directly with a text editor (like notepad) or use the more user friendly configuration window which is available via the tray-menu. In order for the changes to take effect you must reload the application after changing any settings. If you edit settings.ini manually be sure to exit Lintalist first otherwise any changes you make might be overwritten by reloading Lintalist.  A description of all settings can also be found in settings.ini or in the Wiki.  Some important options:    Config Description   SendMethod If you experience any problems with the way text is sent to the various applications you use, you should try various methods to see if it resolves the issue: 1 = SendInput 2 = SendEvent 3 = SendPlay 4 = ControlSend PasteDelay If the text of the snippet is not pasted in to your application after a search, shortcut or shorthand you could try to increase the number of Milliseconds before the text is pasted. TriggerKeys If Shorthand is activate by default pressing a TAB and SPACE key will expand abbreviations. You can limit this to just the TAB or SPACE by editing this setting. You can also use other keys such as F1-F12 for example. More options may be added in future versions such as special hotkeys. DoubleClickSends You can change what happens if you double click on an entry in the search results: 1 = Paste Part1, as enter e.g. run script if present 2 = Paste Part2, as shift-enter e.g. run script if present 3 = Paste Part1, as ctrl-enter e.g. always paste part1 even if script present 4 = Paste Part2, as ctrl-shift-enter e.g. always paste part2 even if script present 5 = Edit snippet 6 = New snippet SingleClickSends as of v1.4 you can also use a single click for the same actions above. DefaultBundle File name e.g. default.txt If no matching bundle can be found based on the window title load this bundle. AlwaysLoadBundles File name(s) e.g. default.txt,bbcode.txt,css.txt Bundles you always want to be loaded as comma separated list. So Lintalist will try to load one or more specific bundles based on the currently active application AND will always add the bundles listed here as well. MaxRes The number of maximum results while searching (loaded bundle(s) may be very large, this will make the program more responsive) StartSearchHotkey The Shortcut (Hotkey) used to launch the Lintalist search window (Capslock by default) If you press this Shortcut while the Lintalist search window is active it will toggle between Wide & Narrow view (you can set the width and height of both views via the configuration menu) QuickSearchHotkey Hotkey used to start quick search: It will cut (ctrl-x) the word to the left, open Lintalist and starts a search. If only one match is found it simply pastes or runs the result directly. Note that some editors cut or copy an entire line if no selection is made (UltraEdit, Sublime Text, Editpad ...) so it may lead to some unexpected results. If you work with such an editor make sure you have always selected some text before you start this. Some editors will allow you to change this behaviour (UE). If you want to disable QuickSearchHotkey simply delete the hotkey in the configuration (make it empty) PreviewSection What to show in the preview area: 1 = Text of part one of snippet (recommended) 2 = Text of part two of snippet (fall back on Part 1 if Part 2 is empty) 3 = Script code of snippet (fall back to Part 1 if 3 is empty) PasteMethod Retain current clipboard or set it as current clipboard content 0 = Paste snippet and retain current clipboard content (=default behaviour) 1 = Paste snippet and keep it as the current clipboard content (so you can manually paste it again) 2 = Don't paste snippet content but copy it to the clipboard so you can manually paste it. OnPaste Exit Lintalist after pasting snippet? 0 = No 1 = Yes   Edit settings.ini or choose configuration in the tray menu for more options.  Settings    Lintalist Bundles  Basic structure of a Lintalist bundle  Although the preferred format for many applications that support bundles, taglists, clip-lists, or snippets appears to be XML or INI, the Lintalist Bundle Format is just a formatted text file which is easy to understand and edit.  Due to its YAML like structure* it is not as cumbersome as XML to edit in a regular everyday text editor. You can edit bundles using Lintalist as it has a built-in editor which can edit, copy, move, add, or remove snippets from bundles or create new bundles from scratch. There are also some bundle converters available to import data from other applications.  * Inspired by Textpow http://textpow.rubyforge.org/svn/mm/manual.mm  A Lintalist bundle has some resemblance to YAML. [ For those interested in YAML and AutoHotkey, there is a parser available for AHK, see www.autohotkey.com/forum/viewtopic.php?t=60670; www.autohotkey.com/forum/topic70559.html ]  The bundles (text-)files are stored in the bundles\ directory. Once you start editing bundles, a backup will be made and copied to bundles\backup\.   Snippets & Bundles  A bundle consists of one or more snippets. A snippet consists of five sections:     Section Description   Part1 *1 Text to paste into active application by pressing Enter, OR run script Part2 *1 Text to paste into active application by pressing Shift-Enter, OR run script Hotkey Paste text from Part1 in active application without searching OR run script Shorthand Expand abbreviations, similar to AutoHotkey. Paste text from Part1 in active application without searching OR run script. Script *2 If a snippet has a script the Text from Part1 will NOT be pasted but instead the script will be run if Enter or the Shortcut-key keys are pressed.   What happens when you double click on an entry in the list is determined by a setting in the configuration menu. (DoubleClickSends setting)  It is advised to always have some useful content in Part1, this will ensure you can always see what you select while searching, even it if the selected snippet runs a script.  *1 This allows you to search for one thing while pasting another, useful for translations or help texts or ... whatever you can think of. Look at the countries.txt or ahk.txt bundles for examples. Note: If the part you are trying to paste is empty it will revert to the other part if possible.  *2 The script is regular AutoHotkey code, see Bundle format for more info.  Example of a Bundle with one Snippet: (Light blue texts are comments and are not part of the format)     BundleFormat: 1 ; This value may change in future in case of a change in format, can not be changed in Bundle Editor Name: CSS ; Name used in Lintalist for Menu and Status-bar, can be changed in Bundle Editor Description: Bundle for Lintalist ; Can be used extra information, can be changed in Bundle Editor Author: Author ; Not actually used in Lintalist, can be changed in Bundle Editor TitleMatch: .css ; Comma separated list of partial window title matches Patterns: ; Snippets start below, each new snippet starts with ""- LLPart1"" - LLPart1: border-radius: ^|px; ; Start of snippet, text pasted with Enter or Double-click   LLPart2: border-radius: [[input=Border radius]]px; -moz-border-radius: [[input=Border radius]]px; -webkit-border-radius: [[input=Border radius]]px; ; Text pasted with Shift-Enter   LLKey: ^+b ; Shortcut, if pressed Text from LLPart1 will automatically be inserted OR script will be run if present   LLShorthand: bdrs ; Type this shorthand followed by space or tab and Text from LLPart1 will automatically be inserted OR script will be run if present   LLScript: ; If present, this AHK code will be run if the snippet is selected via Enter, shortcut or shorthand    Part1 & Part2  As described above, a snippet consists of two parts which are both shown in the search results (if both are present).  While you can perfectly use Lintalist without ever having to use the Part2 of the snippet, it can be of value in a number of cases.  Usage 1 - having two options to paste  By having a snippet consisting of two parts, you can search for one type of information, but paste something else. This is illustrated by the Countries bundle here.   In Part1 of the snippet you will find the official ISO name, and in Part2 the two letter alpha code, e.g GB for United Kingdom, CA for Canada. This lets you look up a country and either paste the official name by pressing Enter, or if you need it, the two letter alpha code by pressing Shift+Enter.     Paste Part1 (enter) Paste Part2 (shift-enter) United Kingdom GB Canada CA  Usage 2 - description / title  You can also use Part2 as a short title to describe the purpose of Part1. In the Markdown bundle below Part2 is used as a description, that way you can for example search for 'bold' to find the bold snippet, this would not be possible without a useful description in Part2 as the markup code in Part1 does not have any useful information to search for.     Paste Part1 (enter) Paste Part2 (shift-enter) ### ^| Heading 3 **[[selected]]** Bold __[[selected]]__ Italic   If you have several very similar snippets in a bundle, you can add some info in Part2 of the snippet so the second column in the search results will help you find the correct one:     Paste Part1 (enter) Paste Part2 (shift-enter) very long snippet that looks similar to many other snippets in the bundle.... FAQ very long snippet that looks similar to many other snippets in the bundle.... Email very long snippet that looks similar to many other snippets in the bundle.... Excel   Another example would be time-sheet management. Often certain types of jobs or clients have special codes assigned to them. Instead of having to remember these codes you can simply create a bundle which would allow you to search for a clients name and paste the code in your time-sheet.     Paste Part1 (enter) Paste Part2 (shift-enter) 1578A John Smith 6335D Ms. Jones X-7685 Replaced plumbing    Interactive bundle text (or Plugins)  Part1 and/or Part2 of a snippet can have special codes to insert specific data. The following Snippet Codes (or plugins) are available.  You can develop your own if you learn to write AutoHotkey scripts, see plugins\readme-howto.txt for more info.  Reminder: You can also use Formatted Text Snippets (html, markdown, image and RTF).  Plugins are processed as follows:  1. Local variables first 2. Process each plugin in the order they are presented in the snippet e.g. left to right. 3. If it is a nested plugin: the order is from the left to right AND from the inside out.  Consider the following example:    This is [[plugin1]] we continue with a triple nested plugin: [[plugin2 [[plugin2-1 [[plugin2-1-1]] ]] ]] and ending with [[plugin3]]   The plugins are processed in the following order: 1. [[plugin1]] is processed first 2. followed by [[plugin2-1-1]] followed by [[plugin2-1]] followed by [[plugin2]] 3. and finally [[plugin3]]  Available plugins:     Code & Parameters Description   ^| Caret position after pasting. Basic example: ""Hello, this is a sample ^|text"" The ^| code will be removed from the text and the caret will be placed before the word text. [v1.8+] If you paste a snippet into an editor which supports Multi-caret/edit you can use those in Lintalist snippets by placing multiple caret locations in your snippet. If you don't want to use MultiCaret simply avoid using multiple ^| in a Lintalist snippet. Supported editors: Atom, Brackets, EverEdit, Komodo Edit, Sublime Text, TextAdept, UltraEdit 23+. See docs/MultiCaret.md for details. [[C=Char|Repeat]] By default pasted texts are trimmed which means spaces and tabs will be trimmed from the snippet. You can use this plugin to insert one or more spaces and/or tabs at the beginning or end of a snippet. Or you can use it as a shorthand-code to insert a repeating text or character. Basic example [[C=-|30]] insert 30 -'s Use [[C=space]] or [[C=\s]] for a space, [[C=tab]] or [[C=\t]] for a tab, and [[C=enter]] or [[C=\n]] for a new line. Neat trick: using a local variable or User input [[C=[[Var=localvar]]|10]] Repeat the local variable 'localvar' 10 times. [[C=[[Input=Repeat which character|-]]|[[Input=How many times?|10]]]] Repeat the entered character(s) 10 times. [[Calc=]] *2 Evaluation of the math expressions - see documentation below. [[Calendar=Format|LCID]] Displays a calendar window to allow you to select a date in a specific format (see DateTime below). Basic example [[Calendar=dd-MMM-yyyy]] --> Select a date and it will be inserted like so: 25-Jan-2011 [v1.8+] You can now specify an LCID. If you do not define one, the current user's locale is used to format the Date string. To use the system's locale instead, specify LSys. To use a specific locale, specify the letter L followed by a hexadecimal or decimal locale identifier (LCID). You can find a list of Locale IDs Assigned by Microsoft here msdn.microsoft.com/goglobal/bb964664.aspx [[Choice=item1|item2|..]] Selected an item from a list. The options are delimited by a | character . Basic example [[Choice=Red|Green|Blue]] inserts the selected colour in the text. [[Clipboard]] *1 Insert current Clipboard content. * Additional parameters are available, see Extending Clipboard & Selected text. [[Counter=Name|Value]] You can use multiple counters across bundles. Basic example [[Counter=InvoiceNumber]] --> increment by one and insert value of InvoiceNumber. By default it will increment the counter by one, you can change that by specifying the Value. [[Counter=InvoiceNumber|5]] Add 5 and insert. text … [[counter=cName]] … text … 2nd instance [[counter=cName|0]] with same value These counters are saved between sessions and stored in settings.ini You can manage these counters (add, edit, delete) via the tray menu option: Manage counters. Tips: 1. if you want to use the same counter multiple times in a snippet without incrementation simply ""Add zero"" (|0) for the second and subsequent instances. 2. if a counter is not created/managed using the ""Mange counters"" tool the unknown counter will be automatically created. This way you can create counters 'on the fly' using for example the [[Input=]] plugin. [[DateTime=Format|Value|TimeUnits|LCID]] Insert current Date and/or Time using the FormatTime options, autohotkey.com/docs/commands/FormatTime.htm (Date & Time formats, may be dependent on your user locale). Basic example [[DateTime=dd-MMM-yyyy]] --> 25-Jan-2011 (Todays date) You can also perform some calculations, example: [[DateTime=dd-MMM-yyyy|5|Days]] --> 30-Jan-2011, 5 days from today. TimeUnits can be either Seconds, Minutes, Hours, or Days. [v1.8+] You can now specify an LCID, see Calendar above. Example: [[DateTime=dd MMMM yyyy|||L1036]] --> show month in French. [[File=Filename|select|clean]] Will insert text from specified file into the text, either full path or relative to Lintalist directory. Basic example [[File=c:\file.txt]] inserts content from that file into the text. [v1.6+] The file plugin has two options |Select and |Clean. |Select: if you want to select a file to use add |Select. The ""filename"" is now used as the directory where you want the Select File dialog to start. If you leave it empty it will start in the Lintalist folder, you can use relative paths (..) Basic example: [[File=..|select]] --> select a text file in the parent folder of Lintalist. |Clean: if you know the text file has the following characters in them |[] AND you are using the File plugin as an input for another plugin you need to tell Lintalist to remove the []| characters by using the |Clean option. Otherwise the plugin using the file as an input will most likely fail. The order of Select and Clean doesn't matter, you can use one or both at the same time. [[Input=Text|Default]] Ask for user input (simple inputbox) Basic example [[Input=Customer's name?]] Note: If you want to use the same user input more than once you can do so by simply repeating the [[Input=Question]] code. You can provide a default response after the question by using the pipe char (|), example [[Input=My favourite color|Green]] [[Random=1|10]] or [[Random=a|b|c]] There are two methods to use Random. 1: Return a random number, 2: Return a random item from a pipe delimited list. [[Random=1|10]] -> return value between 1 and 10 [[Random=item|from|a list of|entries]] -> returns random item from one of these four items [v1.8+] [[Selected]] *1 Replace by selected text if any. This will allow you to insert any selected text, for example to wrap selected text in a HTML tag. * Additional parameters are available, see Extending Clipboard & Selected text. [[Snippet=Shorthand]] Will insert text from another snippet at the specified location. Use the Shorthand code of another snippet from the same bundle. This way you can chain snippets together. Basic example [[Snippet=shorthandcode]] [[Split=input|?1|?2]] *3 Split input into variables - see Split and SplitRepeat below. [[SplitRepeat=input|?1|?2|?3]] *3 Split input into variables - see Split and SplitRepeat below. [[Var=Name]] *4 Insert local variables. These variables are available across bundles. See Local bundle variables below. As of v1.0.3 local variables are also available in scripts (making it the only plugin available in scripts for the time being) [[html]], [[md]], [[rtf=]], [[image=]] Use these for Formatted Text Snippets.     *1 Extending Clipboard & Selected text  Additional parameters are available for the [[Clipboard]] and [[Selected]] plugins.  Parameters are defined as followed:  [[Clipboard=options]] and [[Selected=options]]     Options Shorthand Purpose Upper U Transforms selected text or clipboard to: UPPERCASE. Lower L Transforms selected text or clipboard to: lowercase. Title T Transforms selected text or clipboard to: Title Case. Sentence S Transforms selected text or clipboard to: Sentence case. Wrap|before|after W Wraps selected text or clipboard with the defined before and after texts. If the selection of clipboard has multiple lines each line is wrapped in these texts individually. Example: [[Selected=Wrap|<li>|</li>]] will wrap each line in li html tags. Before: After: line1 <li>line1</li> line2 <li>line2</li> line3 <li>line3</li>    *2 Calc plugin  The evaluations of the math expressions in the Calc plugin are done by the Monster/Eval function by Laszlo. It is capable of basic and advanced math operations including standard AutoHotkey and predefined functions. A number of predefined constants are also available. Source: forum thread  • Arithmetic operators: +, -, *, /, \ (or % = mod), ** (or @ = power) • AHK Functions:        Abs, Ceil, Exp, Floor, Log, Ln, Round, Sqrt, Sin, Cos, Tan, ASin, ACos, ATan • Predefined functions: SGN, Fib, Fac (=sign, Fibonacci numbers, Factorials) • Predefined constants: e, pi, inch, foot, mile, ounce, pint, gallon, oz, lb.     In [[calc=]] Outcome 1 + 1 2 6 / 2 3 12 + 3 * 4 / 2 - 1 17 5 \ 2 1 (5 mod 2 = 1) 100/3 $2 33.33 (2 decimal places)   Example using input:   Converting Celsius to Fahrenheit °C x 9/5 + 32. Today it was: [[Calc=([[Input=What is todays temperature in C?]]*(9/5))+32]]°F (=[[Input=What is todays temperature in C?]]°C) ... you can check this conversion at http://www.wbuf.noaa.gov/tempfc.htm    Example using input & local variable:   You have bought [[Input=Number bought]] items at a price of [[var=itemprice]] each. That brings the total to: [[Calc=[[Input=Number bought]]*[[var=itemprice]]]].    Example rounding off the result to a specific number of Decimal places $N (N decimal places):   100 divided by 3 is: [[Calc=100/3 $2]].    Note about trigonometry functions: Sin(), Cos(), Tan() etc use radians. To convert a radians value to degrees, multiply it by 180/pi (approximately 57.29578). To convert a degrees value to radians, multiply it by pi/180 (approximately 0.01745329252). The value of pi (approximately 3.141592653589793) is 4 times the arctangent of 1. Source: AHK Docs	 In calc you can use this as follows:  	sin(30/180*pi) 	180/pi*asin(0.5)  Advanced math: examples of the more advanced options are available in the forum thread (or study the code in plugins\calc.ahk). Should you have a requirement for such advanced operations you are encouraged to experiment with a standalone Eval script before applying this to the Calc plugin.   *3 Split and SplitRepeat  [[Split=input|?1|?2]] and [[SplitRepeat=input|?1|?2|?3]]  The Split plugin creates an ""array"" of sequentially numbered temporary variables which you can place anywhere in your snippet. This can for example be useful if you copy multiple columns and / or rows from a spreadsheet and want to insert them at specific locations in your snippet text.     Option Meaning input Can be text, another plugin, or the reserved keywords: selected and clipboard. Note: the input must not contain the following three characters: []| ?1 the character to split the input at. There are a number of reserved options \s = space, \t = tab, \n = new line - but you should be able to use any character apart from these: []| If only use ?1 it will create a simple array of variables you can use like so [[sp=1]] [[sp=2]] [[sp=3]] etc Think of it as a column marker. ?2 You can omit this, but if you do use a second parameter it will create a two-dimensional array of variables you can use like so [[sp=1,1]] [[sp=1,2]] [[sp=3,2]] etc. If you use both ?1 and ?2 - ?1 is the row marker, and ?2 the column marker.   Examples  This selected text: word1 word2 word3    [[Split=selected|\s]] Hello [[sp=1]] Hello [[sp=2]] Hello [[sp=3]]   Result:   Hello word1 Hello word2 Hello word3    Read a text file and use the third line:   [[Split=[[File=example.txt]]|\n]] The third line of the text file is [[sp=3]]    Two-dimensional example - this selected text:  wordA1 wordA2 wordA3 wordB1 wordB2 wordB3  using this snippet   [[Split=selected|\n|\s]] Hello [[sp=1,1]] ; wordA1 Hello [[sp=1,2]] Hello [[sp=1,3]] Hello [[sp=2,1]] Hello [[sp=2,2]] ; wordB2 Hello [[sp=2,3]]   Result:   Hello wordA1 Hello wordA2 Hello wordA3 Hello wordB1 Hello wordB2 Hello wordB3      SplitRepeat is similar to Split but has the unique ability to repeat a snippet until all ""parts"" have been processed. It takes up to three ""split"" parameters. ?1|?2|?3.  This can be useful if you don't know in advance how many lines or rows you need to process from your input source.     Option Meaning input Can be text, another plugin, or the reserved keywords: selected and clipboard ?1 the character to ""repeat"" the input at. There are a number of reserved options \s = space, \t = tab, \n = new line - but you should be able to use any character apart from []| This is useful of you want to process each line from an input. ?2 Think of ?2 as the row marker - see Split above. ?3 Think of ?3 as the column marker - see Split above.    Basic example: this selected text a,b,c,d using this snippet    [[SplitRepeat=selected|,]] Hello [[sp=1]][[C=\n]]   Result:   Hello a Hello b Hello c Hello d    Works with two-dimensions as well, this selected text  wordA1,cA1	wordA2,cA2	wordA3,cA3 wordB1,cB1	wordB2,cB2	wordB3,cB3 wordC1,cC1	wordC2,cC2	wordC3,cC3  Using this snippet:   [[SplitRepeat=selected|\n|\t|,]] 1-1 Hello [[sp=1,1]] 1-2 Hello [[sp=1,2]]   Result:   1-1 Hello wordA1 1-2 Hello cA1 1-1 Hello wordB1 1-2 Hello cB1 1-1 Hello wordC1 1-2 Hello cC1    Named Splits  [[Split_name=input|?1|?2]] and [[SplitRepeat_name=input|?1|?2|?3]]  If need to use multiple split in the same snippet you can make use of named Splits to prevent the output of the first split to interfere with the second split - see issue #48. This will also allow you to combine Split and SplitRepeat in the same snippet.  Examples  This selected text: WordA1 WordA2 WordA3	WordB1 WordB2	WordC1 WordC2    [[Split_MyName=selected|\t]] [[SplitRepeat_OtherName=[[sp_MyName=2]]|\s]] result=[[sp_OtherName=1]]   Result:   result=WordB1 result=WordB2    This selected text: wordA1,cA1	wordA2,cA2	wordA3,cA3  Read a text file and use the third line:   [[Split_File=[[File=example.txt]]|\n]] The third line of the text file is [[sp_File=3]] [[Split_Sel=Selected|\t|,]] [[sp_Sel=1,2]] [[sp_Sel=3,1]]   Result:   The third line of the text file is: [...] cA2 wordA3    Combining Split and Choice to create a Snippet with Logic.  You select an option using the Choice plugin and use the result to insert specific information later on. The chosen item (output of Choice) is used as input for a named Split. As the SP will always be the first (e.g. 1), you can use that as a ""variable"" to select an option in a second named Split.   [[Split_C1=[[choice=1 Option1|2 Option2|3 Option3|4 Option4]]|\t]] [[Split_CSub=sub1 sub2 sub3 sub4|\s]]  You made Choice Number [[SP_C1=1]] And the sub-selection that goes with it is: [[SP_CSub=[[SP_C1=1]]]]   Result (if you chose option 3):   You made Choice Number 3 And the sub-selection that goes with it is: sub3   The above method could also be used with Local variables   [[Split_C1=[[choice=1 Option1|2 Option2|3 Option3|4 Option4]]|\t]]  You made Choice Number [[SP_C1=1]] And the sub-selection that goes with it is: [[var=LocalVariable[[SP_C1=1]]]] ; [[SP_C1=1]] would be replaced by 1, 2, 3 or 4 so it would insert the contents of LocalVariable1..4      *4 Local bundle (Variables) [[Var=...]]  By using the [[Var=]] code in your texts you can insert variables which are defined in a special bundle and are stored in local\local.txt. This file has a similar setup to a regular bundle but only has two parts: a name and the content. You can use this to store (personal) information which you can reuse so you do not have to update it multiple times or share it with someone else. This could be your name or address for example:    - LLVarName: MyAddress   LLContent: Agent Cooper   The Black Lodge   Twin Peaks    You can now insert your address in your snippets/bundles by using [[Var=MyAddress]] anywhere in the text.  So if your address changes you only have to update the Address variable and all your bundles will be up to date. This makes it also easier to share a bundle with other users as they don't have to update your bundle by editing all your address entries, they can simply add the Address variable to their local bundle.   Manage local variables (Local bundle editor)  You can edit your local variables using the Local bundle editor. You can access the editor via the Tray menu or via the Edit menu in the Search GUI (Manage local variables)  Local bundle editor  You can use the Scan button to scan your bundles for new local variables and add them.   Example Text Snippet (Part1 or Part2):    Dear [[Input=Enter Name of Customer]],  thank you for your order of your pair of [[Choice=Red|Blue|Black|Pink|Brown]] shoes  at [[DateTime=dd-MMM-yyyy]].  Your sincerely, [[Var=Name]] [[Var=Address]]     Script  You can include any valid AutoHotkey script into a snippet. The code is saved to a temporary file and run with AutoHotkey. The temporary script is written to tmpscrpts\ in your Lintalist directory. After the script has finished it is deleted.  You can enable / disable the use of Scripts via the Tray menu  Special Script Function: LLInit()  If you include LLInit() in your script (at the start) the following variables and functions will be available:  Variables:  - ActiveWindowID (use with ahk_id) - ActiveWindowProcessName (use with ahk_exe) - ActiveWindowClass (use with ahk_class) - ActiveWindowTitle - ActiveControl - SendMethod (settings) - PasteDelay (settings)  These Active* variables contain the information about the application that was active when the Lintalist Search window was activated OR in case of shortcut or shorthand the current active application. You can use these variables in your ""Snippet"" script to ensure your script operates on the correct window if need be. See Configuration for information about SendMethod, PasteDelay.  Functions:  - GetActiveWindowStats()   Get Active Window & Control information    - SendKey(Method = 1, Keys = """")   Send text of keystrokes using the defined method (SendMethod)   Method: 1, 2, 3 or 4.    1 = SendInput, 2 = SendEvent, 3 = SendPlay, 4 = ControlSend   For more background info see the AutoHotkey Send documentation   autohotkey.com/docs/commands/Send.htm  - ClipSet(Task,ClipNum=1,SendMethod=1,Value="""")    Used by Lintalist to set/restore clipboard.   SendMethod as above with SendKey, set by configuration.   See include\default.ahk for full details as ClipSet has a number of   other functions which may be of interest for more advanced use(r)s.   Formatted Text Snippets  As of LintaList v1.1 several types of formatted text are supported in Snippets.  Formatted text, styled text, or rich text, as opposed to plain text, has styling information beyond the minimum of semantic elements: colours, styles (boldface, italic), sizes, and special features (such as hyperlinks). Source: wikipedia  General Notes: 1. The application where you paste the snippet INTO does have to accept the formatted text, otherwise nothing will be pasted. Pasting an image into Notepad for example will have no result. Some applications will not accept RTF but will accept HTML or vice versa. 2. Plugins are supported in HTML, Markdown and RTF, not Image. Note that support in RTF may depend on how the RTF file is written (line breaks, formatting etc.) so you may have to experiment and also try to avoid applying styles to the plugin text. 3. The Caret position after pasting - ^| - does not work with any of these Formatted Text Snippets. 4. In the Listview these formatted snippets are indicated by HTML/Markdown, RTF and Image icons (if Icons are shown)   HTML  To paste HTML code as formatted text you have to include [[html]] in your snippet, usually at the start of the snippet but it can be anywhere. You are allowed to omit the html, head and body tags. You can nest or chain various HTML snippets using the [[Snippet=]] plugin. If one or more of the nested snippets contains the [[html]] plugin the entire snippet will be converted to HTML. Do not mix and match HTML and MD snippets to avoid unexpected end results.    [[html]] <h3>Hello: [[Input=What is your name]]</h3>  <p>This <b>is</b> a <em>sentence</em> with formatting.</p>  <p>Today is <em>[[DateTime=dd MMMM yyyy]]</em>.</p>  <ul> 	<li>list item</li> 	<li>list item</li> 	<li>list item</li> </ul>  <p>Images also work - either use an http URI: (http://lintalist.github.io/img/lintalist.png)<br /> <img src='http://lintalist.github.io/img/lintalist.png'></p>  <p>or a file URI: ()<br />  <img src='docs/lintalist.png'></p>    Notes: 1. Some applications will need a HTTP URI for images to work (webmail for example) - background info on file URI: wikipedia. If you want to use an image file on your computer you can omit adding the entire file path ""file://c:/..../path/to/file.jpg"" Lintalist will automatically insert the full path relative to the folder where lintalist is installed.   Examples:  An image in a Images sub-folder:  	<img src='Images/lintalist.jpg'>   An image two folders ""up"" from the Lintalist folder:  	<img src='../../anotherimage.png'>   Markdown  To paste Markdown code as formatted text you have to include [[md]] in your snippet. Note that only basic Markdown code is properly converted, nested lists are not supported (yet) for example and table formatting is rudimentary - see remarks below. You can nest or chain several MD snippets, but do not mix and match with HTML snippets to avoid unexpected end results.    [[md]] # Heading 1  * unordered list entry * unordered list entry 	 this is a **normal line** of *text* with some markup  1. numbered list entry 2. numbered list entry  Inserting a link [AutoHotkey](https://autohotkey.com) also works  As does an image:  ![Lintalist](https://raw.github.com/lintalist/lintalist/master/docs/img/lintalist.png)  Or a table (slightly deferring from the original markdown)  |cells in the first row are treated | as header cells (th) cell 1   |cell 2 cell 3   |cell 4  Credits: This markdown conversion to HTML function comes from [GenDocs](https://autohotkey.com/boards/viewtopic.php?f=6&t=1797)  Example of HTML block:  ~~~ <ul> 	<li>list item</li> 	<li>list item</li> 	<li>list item</li> </ul> ~~~  The above should be displayed as a unordered list.    This markdown conversion to HTML function comes from GenDocs, which uses a simplified version of the Markdown syntax. It supports:  - Paragraphs: blocks of text delimited by blank lines. Equivalent to HTML <p>...</p>. - In-paragraph line breaks: end a line with two spaces. Equivalent to HTML <br />. - Headings: start a line with up to three hash (#) characters, followed by space. Equivalent to HTML <hN>...</hN> - Emphasis marks: *...*. Equivalent to HTML <em>...</em> - Strong emphasis marks: **...**. Equivalent to HTML <strong>...</strong>. - Inline code marks: `...`. Equivalent to HTML <code>...</code>. - Code sections: unlike standard Markdown, they use the blockquote syntax: blocks of text whose lines start with > followed by a space. - Unordered lists: lines that start with *. Equivalent to HTML <ul>...<li>...</li>...</ul>. - Ordered lists: lines that start with a number, dot and space (e.g. 1. ); or letter, dot and space (e.g. a. ). Equivalent to HTML <ol>...</ol> and <ol style=""list-style-type: lower-alpha"">...</ol> respectively. - Escape sequences: the sequences \*, \`, \[, \], \! and \\ are recognized, and yield literal characters. - Links: [Link text](Link URL). Equivalent to HTML <a href=""..."">...</a>. - Images: ![Image ALT text](Image file name). Equivalent to HTML <img src=""..."" alt=""...""/>.  Insert HTML: - You can include HTML code by placing it between two sections of ~~~ like so ~~~ <p>HTML code here</p> ~~~  Tables are defined as follows: - If a line starts with pipe character (|) it indicates the start of a table (<table>). - The end of a table is marked by an empty line (</table>). - Cells in the first row are treated as header cells (<th>).  - You should not define the start and end of a row, each line is treated as a row (<tr><td>...</td></tr>) - Use a single | to mark a cell division (</td><td>) - Not supported: Text-alignment in cells (always left aligned), Cell- and Rowspans.  Example, a 3x3 table:  |Table     | Description | headers Cell       | Cell        | Cell Cell       | Cell        | Cell   RTF  Using RTF is similar to the File plugin, it will insert the formatted text including images from the specified file. Either use the full path to the RTF file or a path relative to Lintalist directory. All other text in the snippet will be discarded.    [[rtf=Extras\examples\example.rtf]]    You can find an example RTF file including a plugin in the Extras\formatted\ folder.   Image  Using Image is similar to the File plugin, it will insert the image from the specified file. Either use the full path to the image or a path relative to Lintalist directory. All other text in the snippet will be discarded.    [[image=Extras\examples\image.png]]    You can find an example image file in the Extras\formatted\ folder.   Editing Snippets and Bundles   F4 (Edit Snippet)  Start searching your bundle and select the snippet you want to edit (highlight with cursor or mouse) and use F4 to edit it. The Lintalist Bundle Editor will be shown so you can now edit the shortcut, shorthand, both text parts and the script. If you prefer to edit the texts or scripts in your default text editor* click the corresponding 'Edit in Editor' button. It will open the text or script in a new editor window. Save the temporary file and close the editor to automatically copy any changes back to the Lintalist Bundle Editor. You can use the plugins menu to insert plugins including the available local variables and counters.  To store the modified snippet click the save button, the changes are immediately available.  * [v1.7+] you can change the editor used via the ""SnippetEditor"" setting in the configuration menu.  Snippet editor   To modify the bundle properties such as the name, titlematch etc use Lintalist Bundle Editor.   F5 (Copy Snippet and Edit)  Start searching your bundle and select the snippet you want to copy (highlight with cursor or mouse) and use F5 to edit it. The Lintalist Bundle Editor will be shown so you can now edit the shortcut, shorthand, both text parts and the script. If you prefer to edit the texts or scripts in your default text editor click corresponding 'Edit in Editor' button. It will open the text or script in a new editor window. Save the temporary file and close the editor to automatically copy any changes back to the Lintalist Bundle Editor.   To store the modified snippet click the save button, the changes are immediately available.  You can also modify the bundle properties such as the name, titlematch etc on the second tab of the Lintalist Bundle Editor.  Note: this action (F5) is not thoroughly tested.   F6 (Move Snippet to another Bundle)  Start searching your bundle and select the snippet you want to move (highlight with cursor or mouse) and use F6 to move it. A popup menu will allow you to select the bundle you wish the snippet to move to.  Note: this action (F6) is not thoroughly tested.   F7 (Add new Snippet)		  To add a new snippet to bundle make sure the bundle you wish to add the snippet to is loaded in the search window. If multiple bundles are loaded you are asked to select the bundle to which you want to add the new snippet first.  To add the new snippet to the selected bundle click the save button, the changes are immediately available.   F8 (Delete Snippet)		  Start searching your bundle and select the snippet you want to edit (highlight with cursor or mouse) and use F8 to delete it. After confirmation the snippet is removed from the bundle.  Backup: Whenever a snippet is edited (F4) or a deleted (F8) a backup of the bundle will be made in a backup folder when Lintalist is re-started or the program is closed. These can be found in the bundles directory: bundles\backup\. If you are not happy with the changes you have made you can copy back the prior version of the bundle. You may have to re-add any new snippets you have added after the last backup was made.   Managing Bundles  - If you have a new bundle you can add it to Lintalist by simply copying the file into the Bundles directory and (re)starting Lintalist  - If you want to create a new bundle, start Lintalist, open the search window and press F10. The new bundle will be saved in your Bundles directory.  - If you no longer wish to use a particular Bundle, Exit Lintalist first and then simply remove the file from the Bundles folder and start Lintalist or use the Bundle Editor and delete it there.  - You can also use a bundle converter to convert files from a variety of formats to the Lintalist format.   F10 (Bundle properties)			  If you want to change the properties of an existing bundle such as the name (appears in the Menu) or the TitleMatch you can use the bundle properties editor. Press F10 or use the menu to open it while the Search window is active. Select the bundle in the list and change the properties and click SAVE.  New bundle  There are two methods of adding a new Bundle to Lintalist.  1. Create a new bundle in your text editor and copy that file to the \bundle\ folder and reload. 2. Use Lintalist to create a bundle and start adding snippets.  To add a new bundle (a collection of snippets) open the Lintalist search window and use the Edit, Bundle properties menu (or press F10). The Lintalist bundle editor will be opened where you can enter the name and other information. When you click save you will be asked for a file name of your bundle.   The most important fields are Name and TitleMatch. The name is used in the Bundle menu and can be displayed in the search results (see configuration) and the TitleMatch field will allow you to make a Bundle context sensitive which means the search, abbreviations and shortcuts will only be available in Windows which match the title you enter in the TitleMatch field.  New bundles are stored in the bundle directory. Lintalist is restarted after you add a new bundle. A first snippet is automatically added when a new bundle is created.  Once you have created a bundle you can add new snippets via the Edit, New snippet menu or press F7 - make sure the bundle is loaded first by selecting it via the Bundle menu in the Search window. You can add as many snippets as you like. Once ready do not forget to unlock the bundle by ticking the Lock check box in the Lintalist search window.  An illustrated guide is available in the Wiki.  Bundle editor    Bundle Converters  The following converters are available via Extras\BundleConverters\ (requires AutoHotkey) or available via the Tools menu in the Search window and the Bundle editor.  - List.ahk		Regular lists (plain text file, one item per line) - UltraEdit.ahk		UltraEdit Taglists (http://www.ultraedit.com/downloads/extras/tags-autocomplete.html) - CSV.ahk		Comma-Separated Values (CSV) files (en.wikipedia.org/wiki/Comma-separated_values) 			(Uses ReturnDSVArray by DerRaphael) - Texter.ahk		Texter (Exported) Bundles (No known (general) repositories, experimental convertor,  			github.com/adampash/texter/)  If you have made a converter let me know so I can add a link to it or possible include it with Lintalist.  Also, if you know of taglists, bundles, etc of other editors and programs you would like to see converted drop a line at the AutoHotkey forum or GH and include a link to some examples if possible.   Command line parameters  [v1.2+]  -Active: starting Lintalist and open the search window  	Usage Running lintalist.exe installed: lintalist.exe lintalist.ahk -Active 	Usage AutoHotkey installed:            lintalist.ahk -Active  There is also a configuration setting that can do this: ActivateWindow  -Bundle=filename.txt: load specific bundle and lock  -Ini=filename-for-settings.ini: use a different settings file (default is settings.ini) [v1.8+]   F.A.Q & Known Issues   Faq  Q1: Nothing gets pasted / I just see the letter v A1: You probably need to increase the PasteDelay setting. Right-click tray icon, configuration, PasteDelay.      Increase the milliseconds. You may need to experiment a bit to find a good setting.  Q2: It still does not work! A2: There are a number of SendMethods you can try. There are 4, Right-click tray icon, configuration, SendMethod.      Try various methods until you find one that works, see Q1 as well as you might need to try a number of combinations.     A good program to test it in is Notepad.  Q3: My editor(s) selects a line of text even if nothing is selected. A3: There are a number of editors that automatically select an entire line - even it it is empty - when selecting      a snippet with [[selected]] or script. Known editors:      - UltraEdit (can be turned off in configuration), - EditPad, - Sublime Text and possibly others.     If you can not turn off this behaviour, make sure something is selected before you use a snippet OR     modify the snippet by removing [[selected]].  Q4: I want to do an OR search as in ""this OR that""? Is that possible? A4: Yes, choose RgEx (Regular Expression) search (alt-r) and use a | (pipe)     Example: this|that     will find find snippets with either THIS or THAT as part of the text (part1, part2, shorthand)  Q5: I type the shorthand (abbreviation) or press the shortcut but nothing happens! A4: - Make sure shortcuts and shorthand are not disabled (tray menu). Perhaps Lintalist is paused.     - Another bundle may be locked so the bundle you think should be active isn't, unlock it.     - Make sure the title match of the bundle is set correctly if it is not the default bundle.   Known Issues  K1: I can not append a new snippet to my bundle! A1: If this happens try ""Reload Bundles"" or restart Lintalist, for some reason Lintalist can not find      or access the bundle or possibly it has lost track of which bundle it should append to.     This should be fixed in a future update of Lintalist     History  History  > version 1.1 see changelog.md * Version 1.1 - Formatted text support. * Version 1.0.x - Minor improvements and bug fixes. * Version 1.0 - First public release. < Version 1.0 - private versions only (small set of users) * See also credits.txt    Disclaimer: Use at your own risk. If you find a new bundle take a look at the script sections of each snippet. As Lintalist can run any AutoHotkey script it can also run faulty or insecure code. Be sensible, if you simply want to try a bundle selecting 'Pause scripts' via the tray menu might be a useful idea.    © Copyright 2009-2015 Lintalist. See license.txt This page uses Google Analytics."	"null"	"null"	"Searchable interactive lists to copy & paste text with plugins. Forum thread:."	"true"
"Typing"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=3378"	"Searchable interactive lists to copy & paste text with plugins. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Lintalist 1.8 Searchable interactive lists to copy & paste text with plugins - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:30 All times are UTC-05:00 Lintalist 1.8 Searchable interactive lists to copy & paste text with plugins Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 43 posts 1 2 3 Next list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Lintalist 1.8 Searchable interactive lists to copy & paste text with plugins Report this post Quote 18 Apr 2014, 07:32 Lintalist: Searchable interactive lists to copy & paste text, run scripts, using easily exchangeable bundles v1.8 New: cmd line parameter INI, Multi-Caret, Random plugin, LCID for datetime/calender, various fixes - see https://github.com/lintalist/lintalist/releases for changelog v1.7 New: Split plugin now accepts ""named Split"", Settings (SearchLetterVariations, SnippetEditor, PlaySound), Added 'Help' and 'About' to GUIs - see https://github.com/lintalist/lintalist/releases for changelog v1.6 improved plugin parser, new Split* plugin, column settings and various other updates, check for updates in tray menu - see https://github.com/lintalist/lintalist/releases for changelog v1.5 Bundle name in search results, set font/size and Omnisearch and various other updates, check for updates in tray menu - see https://github.com/lintalist/lintalist/releases for changelog v1.4 New calc plugin, extended clipboard & selected plugins and various other updates, check for updates in tray menu - see https://github.com/lintalist/lintalist/releases for changelog v1.3 New config option, check for updates in tray menu - see https://github.com/lintalist/lintalist/releases v1.2 Several new config options and other updates v1.1 introduces formatted text support - Snippets can now have HTML or Markdown markup which will be pasted as formatted text, or you can read a RTF or Image file which will be pasted into your current application. Source: https://github.com/lintalist/lintalist Website: http://lintalist.github.io/ Introduction Lintalist allows you to store and (incrementally) search and edit texts in bundles and paste a selected text in your active program. The text can be interactive, for example, you can automatically insert the current time and date, ask for (basic) user input or make a selection from a list etc. and finally it can also run a script. You can use keyboard shortcuts or abbreviations to paste the text (or run the script) without opening the search window (see screenshot below). Bundles can be context sensitive and multiple bundles can be used at the same time (if they match the criteria). (more videos below) Background: this is a script I've developed and used for a long time and I thought Easter was a nice time to finally share it. It was inspired by the Textmate Bundle/Snippet concept which a few years back was hardly available in a Windows text editor. Lintalist has the advantage it should work in any program (as long as it allows AutoHotkey to paste text) - not just your editor. Features: A novel feature is the ability to use two parts of text depending Assign keyboard shortcuts to your favourite Snippets Use abbreviations (shorthand) for your favourite Snippets Run scripts which can be included in a Bundle Standard Plugins: Caret position after pasting Insert date & time (incl. math operations) Pick date from a Calendar Choose item from a list Use counters Use selected text Use the clipboard Insert text from a file Chain snippets (insert the contents of one snippet into another snippet) Insert a character Use local variables Read more in the documentation... Screenshot Type query (multiple search modes) Menu + search options. Result list with Part 1, Part 2, Key(board shortcut), Short(hand, abbreviation). Columns are dynamic, if part 2, key or short are not present in the loaded bundle(s) they will not be displayed. Preview of top most or selected snippet text. In statusbar: loaded bundle(s) and hits / number of snippets. Videos (not the best of quality, YT reduces the quality I'm afraid after uploading) Introduction: http://youtu.be/XfjZPAhHB8c HTML/Markdown: http://youtu.be/Q6SFkttjUQk Formatted text: http://youtu.be/J1StUarGHmI Plugins: http://youtu.be/Rtd_ChyRVkM Notes: Some example bundles are available here https://github.com/lintalist/lintalist-bundles/ simply copy these to the Bundles\ folder and restart Lintalist - right click tray menu. The release (see GH) contains lintalist.exe - it is simply a renamed autohotkey.exe included for convenience. In order for Lintalist to run scripts it needs a copy of AutoHotkey - Lintalist is not meant to be compiled. Last edited by list on 25 Jun 2016, 08:45, edited 12 times in total. Lintalist: website - source (github) Top tank Posts: 1582 Joined: 28 Sep 2013, 22:15 Facebook: charlie.simmons.7334 GitHub: ttnnkkrr Location: Louisville KY Contact: Contact tank Website Re: Lintalist: Searchable interactive lists to copy & paste Report this post Quote 18 Apr 2014, 08:01 havent tried this YET but i will. I think this is a superb Idea We are troubled on every side‚ yet not distressed; we are perplexed‚ but not in despair; Persecuted‚ but not forsaken; cast down‚ but not destroyed; https://www.facebook.com/ahkscript.org Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: Lintalist: Searchable interactive lists to copy & paste Report this post Quote 21 Apr 2014, 00:04 this does look quite impressive Top hoppfrosch Posts: 197 Joined: 07 Oct 2013, 04:05 GitHub: hoppfrosch Location: Rhine-Maine-Area, Hesse, Germany Contact: Contact hoppfrosch Website Re: Lintalist: Searchable interactive lists to copy & paste Report this post Quote 23 Apr 2014, 00:19 Awesome work - including suberb documentation! Top list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Re: Lintalist: Searchable interactive lists to copy & paste Report this post Quote 25 Apr 2014, 14:01 v1.0.2 is now available at https://github.com/lintalist/lintalist/releases Changelog v1.0.2 New: Added Quick start guide to program and tray menu (can be turn on/off) New: Tray tip on Tray icon shows ""hotkey"" to start a search as visual reminder Fixed: Better handling of new (empty) bundles Fixed: Double click to edit snippet (method 5) was actually creating new snippet and it was missing from the INI - New: method 6 to create new snippet Fixed: Missing ""tmpscrpts"" folder from repo - @hoppfrosch - https://github.com/lintalist/lintalist/issues/1 Fixed: Now actually implemented the center & mouse(alternative) settings for Lintalist window position + New: remember position set by user - these can now also be set via the Configuration gui Change: Removed ""fake"" text menu and now using a proper Gui menubar Do read the upgrading notes on the release page (you need to delete your current settings.ini) Thanks for the feedback so far. Lintalist: website - source (github) Top list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Re: Lintalist: Searchable interactive lists to copy & paste Report this post Quote 25 May 2014, 03:53 v1.0.3 is now available at https://github.com/lintalist/lintalist/releases Changelog v1.0.3 * New: you can now use Local variables in your script code as well - ht: tpr * Fixed: minor fixes local bundle editor (adding, removing) - ht: tpr * Fixed: minor fix local counter editor (double click on empty row) Source & Releases at https://github.com/lintalist/lintalist/ Lintalist: website - source (github) Top list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Re: Lintalist: Searchable interactive lists to copy & paste Report this post Quote 03 Jan 2015, 08:09 Lintalist v1.1 - Formatted text support (HTML, Markdown, RTF, Image) Snippets can now have HTML or Markdown markup which will be pasted as formatted text, or you can read a RTF or Image file which will be pasted into your current application. Documentation: http://lintalist.github.io/#FormattedText Thanks to: WinClip() by Deo - http://www.apathysoftworks.com/ahk/index.html - and Markdown2HTML() from GenDocs by fincs - https://github.com/fincs/GenDocs Lintalist: website - source (github) Top list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Re: Lintalist 1.2 Searchable interactive lists 2 copy&paste Report this post Quote 17 Jan 2015, 12:48 v1.2 some new config options - see https://github.com/lintalist/lintalist/releases Also some videos (not the best of quality, YT reduces the quality I'm afraid after uploading) Introduction: Other videos HTML/Markdown: http://youtu.be/Q6SFkttjUQk Formatted text: http://youtu.be/J1StUarGHmI Plugins: http://youtu.be/Rtd_ChyRVkM Lintalist: website - source (github) Top list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Re: Lintalist 1.2 Searchable interactive lists 2 copy&paste Report this post Quote 25 Jan 2015, 08:36 Update: Lintalist v1.3.1 - https://github.com/lintalist/lintalist/releases New: Configuration setting ""AutoExecuteOne"" if only one result is left during the search AutoExecute (no need to press enter) New: Right menu Check for updates and install update if possible (some videos have been updated with a white background, looks better) Lintalist: website - source (github) Top danielo515 Posts: 58 Joined: 18 Feb 2015, 15:06 Re: Lintalist 1.3 Searchable interactive lists 2 copy&paste Report this post Quote 10 Mar 2015, 14:20 Hello, I don't know if I misunderstood the titleMatch thing, but as I understand it is not working for it. Let's say I have a couple of snippets for Oracle, and I want them to be available only when I'm using Oracle SQL developer. Then I will create a bundle called oracle and I will set the titleMathc to Oracle, and I will add the snippets there. I tried in other windows, for example notepad, and the hotstrings are still responsive. How can I change this? Thanks in advance. Top list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Re: Lintalist 1.3 Searchable interactive lists 2 copy&paste Report this post Quote 10 Mar 2015, 15:44 Hi danielo515, it seems you've understood it correctly, I google the program name and found some screenshots and it seems the program always has ""Oracle SQL developer"" in the window title. So the bundle should look something like the example below and if you have in \bundles\ and you can see it in the Gui it is loaded properly. Did you make it the default bundle by any chances or did you lock it or used ""load all bundles"" (there would be a checkmark in the tray menu if that was the case) Code: [Select all] [Download] GeSHi © Codebox Plus BundleFormat: 1 Name: Oracle SQL Description: Bundle for Oracle SQL developer Author: danielo515 TitleMatch: Oracle SQL developer Patterns: - LLPart1: Oracle1   LLPart2: SQL1   LLKey:   LLShorthand: sqx   LLScript: I think Oracle SQL developer is a java program is that correct? Perhaps that is the problem and AHK has a problem getting the windows title from the program - you can test that with a small script Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus ^F12:: WinGetActiveTitle, ActiveWindowTitle MsgBox % ActiveWindowTitle Return Make sure Oracle SQL developer is the active application and press ctrl-f12 - it should show the ""Oracle SQL developer"" in the msgbox. Lintalist: website - source (github) Top danielo515 Posts: 58 Joined: 18 Feb 2015, 15:06 Re: Lintalist 1.3 Searchable interactive lists 2 copy&paste Report this post Quote 11 Mar 2015, 01:59 Hello list, Thank you for taking so much efforts. Here is one of my bundles: BundleFormat: 1 Name: Oracle Description: Author: Danielo TitleMatch: Oracle SQL Developer Patterns: As you can see it is empty. I created another bundle, called MySQL for toad, and it don't even appear on the bundles folder. When are the bundles saved? If I open the ""configuration"" of each pattern the bundle configuration is correct, but, as I said, this is not reflected on the bundles folder. Another weird thing is that The latest created bundle is always the selected one, no matter which window is active, and I don't see the default one anymore. I checked your script and it works properly with Oracle SQL developer, the window title is displayed correctly. As I said, this seems to be a problem with all the windows. Maybe bundles not being saved. When are bundles saved to disk? I create the bundles ""on the fly"" when I create a new snippet. Should I create the bundle first? Top danielo515 Posts: 58 Joined: 18 Feb 2015, 15:06 Re: Lintalist 1.3 Searchable interactive lists 2 copy&paste Report this post Quote 11 Mar 2015, 02:26 Hello again, I'm making some more test and the title match does not seems to work on any window. I tried with browsers and editors. The latest selected bundle is always the selected one. Another question: is there any way to edit a bundle once created? The edit bundle option shows a ""variables manager"". Top danielo515 Posts: 58 Joined: 18 Feb 2015, 15:06 Re: Lintalist 1.3 Searchable interactive lists 2 copy&paste Report this post Quote 11 Mar 2015, 03:16 Wow! It is now working. Here is how I fixed it: 1 I selected ""load all bundles"" from the bundle menu 2 Then I deselect that option 3 it started to work But I'm still curious about the other things I asked: * How can I edit a bundle from your program? * What is the purpose of the bundle tab when you create a new snippet? Top list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Re: Lintalist 1.3 Searchable interactive lists 2 copy&paste Report this post Quote 11 Mar 2015, 13:26 danielo515 wrote:It is now working. Glad to hear you managed to solve it yourself. Adding a new bundle can be a bit complicated the first (few) times. I've prepared an illustrated HOWTO in the Lintalist wiki here: https://github.com/lintalist/lintalist/ ... -Lintalist danielo515 wrote:But I'm still curious about the other things I asked: * How can I edit a bundle from your program? * What is the purpose of the bundle tab when you create a new snippet? 1. Open the Lintalist search window and use the Edit menu which will allow you to edit, copy, move, add new or delete a snippet. Or add a new bundle as now shown in the Wiki. It is briefly addressed in the Help Documentation as well online here http://lintalist.github.io/#Editing or use the Tray menu, help option. 2. When adding a new Bundle you must at least give it a name so you can access the bundle via the Bundle menu in the Lintalist search window. When editing a snippet in an existing bundle you can modify the name and titlematch properties of the bundle by switching to the second tab. So in your case: if you want to add ""Microsoft MySQL Server"" as a window title simply edit a snippet from your Oracle SQL Bundle and switch to the second tab and add "",Microsoft MySQL"" to the TitleMatch (sans quotes). Click save - it never hurts to reload Lintalist after adding a new Bundle or changing its properties. I hope the above answers your question and you find Lintalist to be useful. Lintalist: website - source (github) Top danielo515 Posts: 58 Joined: 18 Feb 2015, 15:06 Re: Lintalist 1.3 Searchable interactive lists 2 copy&paste Report this post Quote 11 Mar 2015, 17:20 list wrote:Glad to hear you managed to solve it yourself. But not in the best way. I did not noticed the ""lock"" tick near to the search box. Unlocking it will be definitively easier,faster and cleaner than my method. It's an important part of using your program and can frustrate users. I think it deserves at least an screenshot in the wiki. list wrote:Adding a new bundle can be a bit complicated the first (few) times. I've prepared an illustrated HOWTO in the Lintalist wiki here: https://github.com/lintalist/lintalist/ ... -Lintalist Thank you very much for this guide. It clarifies some important points. Please consider including the above suggestion. list wrote:1. Open the Lintalist search window and use the Edit menu which will allow you to edit, copy, move, add new or delete a snippet. Or add a new bundle as now shown in the Wiki. It is briefly addressed in the Help Documentation as well online here http://lintalist.github.io/#Editing or use the Tray menu, help option. So there is no clear way to manage bundles directly, just indirectly by moving and creating snippets. list wrote:2. When adding a new Bundle you must at least give it a name so you can access the bundle via the Bundle menu in the Lintalist search window. When editing a snippet in an existing bundle you can modify the name and titlematch properties of the bundle by switching to the second tab. Here, again, there is no direct way to edit a bundle. You have to select a snippet, edit that snippet and then switch to the bundle tab. Not very intuitive. I would prefer to have an option on the menu where I can select which bundle to edit and edit it directly. Did you noticed that if you create a new snippet without selecting a bundle, and you switch to the bundle tab and fill the bundle information that information goes to some kind of limbo? And, here goes an important suggestion: I would love to have a ""bundle belonging"" column in the snippets list. It's hard to determine to which bundle belongs each snippet when many of them are selected. This is specially important because you have to edit bundles indirectly by selecting a snippet that belongs to that bundle. list wrote:I hope the above answers your question and you find Lintalist to be useful. It is very useful. I was thinking in create something similar myself, but I though: ""hey, maybe someone has spend a good amount of time doing what I want to do"" and then I found your program, which fit my needs like it has been made with my instructions plus some better ideas. Top list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Re: Lintalist 1.3 Searchable interactive lists 2 copy&paste Report this post Quote 12 Mar 2015, 12:58 danielo515 wrote:I did not noticed the ""lock"" tick near to the search box ... I think it deserves at least an screenshot in the wiki. I will highlight it in the ""Step 6"" image. There is no particular need to Select (and thus Lock) the bundle but it makes it easier if you want to add multiple snippets in a row to a (new) bundle. If the bundle is loaded into the Gui you can add snippets to it, as several bundles can be loaded you would have to select the bundle first when you add the snippet. danielo515 wrote:So there is no clear way to manage bundles directly, just indirectly by moving and creating snippets. ... You have to select a snippet, edit that snippet and then switch to the bundle tab. Not very intuitive. I would prefer to have an option on the menu where I can select which bundle to edit and edit it directly. The way I use it is that I add a new bundle, add its properties and then only edit/modify snippets and don't touch the bundle properties again. You have to bring up the search Gui and make sure the Bundle you want to modify is loaded, either by making sure the Window which matches the TitleMatch is active before opening the search so it is loaded automatically. But it is true, it does require some ""thought"" and might not the most intuitive method (although it comes natural to me as I made it of course). danielo515 wrote:Did you noticed that if you create a new snippet without selecting a bundle, and you switch to the bundle tab and fill the bundle information that information goes to some kind of limbo? Yes and no. Yes if you don't add anything in the snippet (tab 1) before editing the properties (tab 2), if you do add something in tab 1 changes in tab 2 will be saved (after reloading). I've been contemplating a different snippet/bundle editor for a while, nothing planned yet but it would have to be easier to use and lesss error-prone. If you were to look at the code of the editor (not recommended) you might notice the spaghetti-code (it evolved over a long period of time adding ""quick"" fixes to make it work) and it should be rewritten. danielo515 wrote:And, here goes an important suggestion: I would love to have a ""bundle belonging"" column in the snippets list.... For me that would make the Gui a bit cramped but of course it could be added and also be user configurable. A method I'm (also) considering would be to allow for colours in the listview so each bundle would have its own color (user configurable) - I would also like to introduce settings for the font & font size used in the listview and preview area - I'll add these ideas to the ISSUE at GH. danielo515 wrote:It is very useful. Thank you. Lintalist: website - source (github) Top FanaticGuru Posts: 332 Joined: 30 Sep 2013, 22:25 Re: Lintalist 1.3 Searchable interactive lists 2 copy&paste Report this post Quote 13 Mar 2015, 18:57 Nice script! I have run into a problem. I updated from AHK 1.1.14 to 1.1.20.02 and then noticed problems with Lintalist. If I hit caplock to open it when the desktop or a folder is active I get an error at line 234: Gui, Show, w%Width% h%Height% x%Pos1% y%Pos2%, %AppWindow% Which traces back to line 230 which has: XY:=StayOnMonXY(Width, Height, Mouse, MouseAlternative, Center) ; was XY:=StayOnMonXY(Width, Height, 0, 1, 0) This is returning an XY of null which then causes an invalid option in the Gui, Show because Pos1 and Pos2 end up being null. I do not have this problem if something like a Notepad window or an email has focus which is the normal type places you would paste to but then other windows do cause this error like if I hit Caplock in this forum post. I can avoid the issue by running the Exe Lintalist as it uses an older version of AHK. I don't know if this is something buggy with this version of AHK that will change or if this is a change in behavior of AHK that is permanent going forward. Just thought you would want to know. Also you mention adding the option for font size. I would find this useful as my display is 2560x1600 which makes the letters smaller than I would like. Great job. I especially like the [[html]]. FG Hotkey Help - Help Dialog for Currently Running AHK Scripts AHK Startup - Consolidate Multiply AHK Scripts with one Tray Icon [Function] Timer - Create and Manage Timers Top list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Re: Lintalist 1.3 Searchable interactive lists 2 copy&paste Report this post Quote 14 Mar 2015, 03:18 Glad you like it and thanks for reporting the error - I noticed that too, it is an error in the script - an old bit of code that never got updated correctly but also never caused an error - will be fixed in the next update. If you want it fixed now you can change lines 232 & 233 from Code: [Select all] [Download] GeSHi © Codebox Plus If (x="""") or (y="""") 	x:=100, y:=100 to Code: [Select all] [Download] GeSHi © Codebox Plus If (Pos1="""") or (Pos2="""")     Pos1:=100, Pos2:=100 If you already want a bigger font in the listview you can change alter line 220 to Gui, 1:Font,s12, for example. Lintalist: website - source (github) Top list Posts: 52 Joined: 26 Mar 2014, 14:03 Contact: Contact list Website Re: Lintalist 1.4 Searchable interactive lists 2 copy&paste Report this post Quote 14 Mar 2015, 12:38 You can use the tray menu, check for updates, to upgrade, or download it manually via https://github.com/lintalist/lintalist/releases Changelog v1.4 New: Extended Clipboard & Selected plugins (upper, lower, sentence, title, wrap*) New: Calc plugin - Evaluate arithmetic expressions (using Laszlo's Eval/Monster) New: Plugins & Tools menu in Bundle Editor including dynamic submenus for clipboard, selected, counter & local variables plugins New: Setting for Single click in listview to act as double click New: Command line parameters -Bundle: load specific bundle and lock Fix: Minor bug which would allow last snippet to be pasted again if enter was given on an empty results list Fix: Up & Down arrow navigation should now work in the Bundle menu (Search GUI) this includes sending additional hidden keystrokes to the search control, do report errors if you experience any. Fix: Error on Gui, Show in lintalist.ahk for AHK v1.1.20+ The wrap is a nice option, example this Code: [Select all] [Download] GeSHi © Codebox Plus <ul> [[selected=wrap|<li>|</li>]] </ul> turns this selected text: line1 line2 line3 into: <ul> <li>line1</li> <li>line2</li> <li>line3</li> </ul> Lintalist: website - source (github) Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 43 posts 1 2 3 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 11 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"Searchable interactive lists to copy & paste text with plugins. Forum thread:."	"true"
"Typing"	"Portable Keyboard Layout"	"http://pkl.sourceforge.net/"	"helps people to learn better, more efficient keyboard layouts such as Dvorak, Colemak or Asset. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Portable Keyboard Layout                 Portable Keyboard Layout: Project Web Hosting - Open Source Software Portable Keyboard Layout   Welcome to the official site of Portable Keyboard Layout! This open source program by Máté FARKAS helps people to learn better, more efficient keyboard layouts and then use them anywhere, anytime, even on someone else's computer. If you want to stave off RSI (Repetitive Strain Injury) and CTS (Carpal Tunnel Syndrome) - try one of the scientificially designed keyboard layouts such as Dvorak, Colemak, or Asset and take it with you on a flash drive using PKL. You can also use your favorite national layout - Russian, Hebrew, Greek or some other language - without installing it on the computer that you have to use (in an Internet Cafe, at school, or somewhere else). It's quite easy to start using PKL, especially if you are trying to learn a new layout and need some reminders about key positions: download the program itself and some ready-made layouts, then check a few settings in the pkl.ini file (they are well documented inside) - and launch the program. If you want to take it with you to some computer that doesn't have any alternative layouts installed - just copy it to a flash drive and launch it when you need it, there is no installation, it's ready to use immediately. Currently PKL supports only Windows-based computers, so don't expect it to work on Linux or Mac, though. PKL allows for some pretty sophisticated manipulation of key modifiers and keyboard states, so entering even most complex characters is a pleasure - various diacritics/accents, special characters, etc present no problem. It's also quite friendly to other users: if you keep forgetting to exit it when you leave - you can set it to auto-disable itself after short period of inactivity. All these settings can be set up in the abovementioned pkl.ini file and individual layouts settings. Of course, you can make your own layouts for any language, including the keyboard help images for various modes, using free tools. Note that PKL is, essentially, a compiled AutoHotKey script, and its source is available for download (including all needed tools to create your own layouts), so if you want to change or improve something - you are welcome! Don't forget to visit the official forum if you need some question answered or have some suggestion. Project Web Hosted by ©Copyright 1999-2008 - SourceForge, Inc., All Rights Reserved About - Legal - Help"	"null"	"null"	"helps people to learn better, more efficient keyboard layouts such as Dvorak, Colemak or Asset. Forum thread:."	"true"
"Typing"	"link"	"https://autohotkey.com/board/topic/25991-portable-keyboard-layout/"	"helps people to learn better, more efficient keyboard layouts such as Dvorak, Colemak or Asset. Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Portable Keyboard Layout - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. Portable Keyboard Layout Started by MateFARKAS , Feb 09 2008 09:07 AM Page 1 of 13 1 2 3 Next » Please log in to reply 190 replies to this topic MateFARKAS Members 75 posts Last active: Apr 01 2013 06:38 PM Joined: 28 Oct 2007 I create a Portable Keyboard Layout program. You can use your favorite keyboard layout everywhere. It supports Colemak, DDvorak, ENTI-key, Hebrew (with CapsState, Unicode chars) etc. See at <!-- m -->http://pkl.sourceforge.net/<!-- m --> #1 - Posted 09 February 2008 - 09:07 AM Portable Keyboard Layout Happy Sunday Back to top BoBo¨ Guests Last active: Joined: -- Thanks for sharing, might come in handy Go on scripting !!! 8) #2 - Posted 09 February 2008 - 10:53 AM Back to top rubo77 Members 10 posts Last active: Joined: 02 Jun 2007 hey, nice work! i just changed the ini file: \Portable Keyboard Layout\pkl.ini layout = enti-key++ can you corrected the foldername? this is wrong: 'entykey' it should be 'enti-key++' and how did you generate the help-images? and can you please include the latest enti-key++-Version 21? i included the layout in a rar file: #3 - Posted 09 February 2008 - 11:43 AM Einhändig schreiben mit http://entikey.z11.de/ Back to top MateFARKAS Members 75 posts Last active: Apr 01 2013 06:38 PM Joined: 28 Oct 2007 can you corrected the foldername? this is wrong: 'entykey' it should be 'enti-key++'No. Folder must contain only a-z (lowercase) and '_' for variations, like colemak_french. The correct name is ENTI-key++, I know. I change it to entikey (sorry my mispelling). You can set the correct name of the layout in the layout.ini: [informations] layoutname           = ENTI-Code++ ver.15 and how did you generate the help-images?source.zip/utilities/ini2html.pl (perl script), Firefox(!), and a screen capture program. and can you please include the latest enti-key++-Version 21?If you send it to me (in email!). You can use my klc2ini.pl perl script in the source.zip to generate your new layout's ini file. It's recomenend to use WinMerge (or a similar program) to show to you the old and the new ini file, to show what things must you change. Sorry, I can not speak english. To special characters, you can use 2 mode, for example to Ctrl+Space: *{space} ; Send {space} == space  ={space} ; Send {Blind}{space} == ctrl+space now.  i included the layout in a rar file...If you would like create a portable version ENTI-key++, use compactMode = 1 in the pkl.ini (see the Portable Colemak) #4 - Posted 09 February 2008 - 12:27 PM Portable Keyboard Layout Happy Sunday Back to top rubo77 Members 10 posts Last active: Joined: 02 Jun 2007 ok i will try To special characters, you can use 2 mode, for example to Ctrl+Space: *{space} ; Send {space} == space  ={space} ; Send {Blind}{space} == ctrl+space now.  what does this mean? #5 - Posted 10 February 2008 - 08:16 AM Einhändig schreiben mit http://entikey.z11.de/ Back to top rubo77 Members 10 posts Last active: Joined: 02 Jun 2007 ok i sent you a PM here and in sourceforge what about a small README file? you can use most of the text, you posted here already #6 - Posted 10 February 2008 - 09:38 AM Einhändig schreiben mit http://entikey.z11.de/ Back to top MateFARKAS Members 75 posts Last active: Apr 01 2013 06:38 PM Joined: 28 Oct 2007 To special characters, you can use 2 mode, for example to Ctrl+Space: *{space} ; Send {space} == space  ={space} ; Send {Blind}{space} == ctrl+space now.  what does this mean? With MS KLC you can not set special characters, like Del, Enter, BackSpace, etc. Please, see the difference between the old (my) ini file and your new! #7 - Posted 10 February 2008 - 09:15 PM Portable Keyboard Layout Happy Sunday Back to top MateFARKAS Members 75 posts Last active: Apr 01 2013 06:38 PM Joined: 28 Oct 2007 what about a small README file?The idea is very good my english is bad. :oops: I create some ,,sample layouts'', like enti-key++ (special characters), hebrew (CapsState), extend_* layouts (extend the built-in layout). I hope, this helps. #8 - Posted 10 February 2008 - 09:46 PM Portable Keyboard Layout Happy Sunday Back to top asr Members 3 posts Last active: Jun 04 2008 12:28 PM Joined: 29 Apr 2008 We (fr-dvorak-bépo) are working on the fr-dvorak-bépo layout of the package. <!-- m -->http://www.clavier-d...rg/wiki/Accueil<!-- m --> All our work is available at <!-- m -->http://dvorak.ryckeboer.org<!-- m --> : - pkl sources - bépo layout - modified ini files and certainly ahk in a small way. We would be pleased to reverse our patches to the project. #9 - Posted 29 April 2008 - 04:20 PM Back to top A2 Members 1 posts Last active: Jun 01 2008 11:01 PM Joined: 15 May 2008 Hi! I'm working on fr-dvorak-bépo layout too. This won't help non-french because the layout is optimized for french with Dvorak method but here it is: * a modified version of what asr made can be found in this zip file (it is a bit documented if you can read french); * the modified sources files to obtain this can be found in our svn in configGenerator (klc2ini.pl, ini2html.pl essentially); * the .klc. The only bug is when using a deadkey and the same key, it doesn't work. Máté will look at this. Thanks again for these ahk and perl scripts. #10 - Posted 15 May 2008 - 06:45 PM http://www.clavier-dvorak.org french dvorak keyboard layout Back to top asr Members 3 posts Last active: Jun 04 2008 12:28 PM Joined: 29 Apr 2008 The [D] key is mapped to ""i"", and is dead with Alt+Ctrl combination. While we try to use the sequence [Dead D] [D], it doesn't work. After a few hours of investigation, I have a few more elements : On PKL.AHK, lines 480-500 : DeadKey(DK) { …/… ToolTip % DK Input, nk, L1, {F1}{F2}{F3}{F4}{F5}{F6}{F7}{F8}{F9}{F10}{F11}{F12}{Left}{Right}{Up}{Down}{Home}{End}{PgUp}{PgDn}{Del}{Ins}{BS} ToolTip % nk KeyHistory …/… 1* The second tooltip is not displayed if [D] is pressed, only displayed if another key is pressed. 2* In the key history, all the [D] pressed are present. 3* if I change the value of many variables, there is no effect on the [D] keypress ignored. So, it seems that a handle intercepts the deadkey, while pressed, on the ""Input"" function. PS: It is the same problem for each deadkey: impossible to build a layout with a deadkey combination of the deadkey itself. #11 - Posted 21 May 2008 - 02:35 PM Back to top MateFARKAS Members 75 posts Last active: Apr 01 2013 06:38 PM Joined: 28 Oct 2007 PS: It is the same problem for each deadkey: impossible to build a layout with a deadkey combination of the deadkey itself.Thanks, now I know the problem. Pressing a Deadkey, the process control (sorry my english) goes to the Deadkey(DK) function, and wait for a key. If you press a key, it calculates the result and return. But AutoHotkey don't start a new thread, if the previous didn't return. 1) Force AutoHotkey to start a new thread, even the old is not returned 2) Return immediately and process after return Please, wait patiently, I will correct this. (But If you know, how can I the (1), please, tell me!) #12 - Posted 21 May 2008 - 05:12 PM Portable Keyboard Layout Happy Sunday Back to top asr Members 3 posts Last active: Jun 04 2008 12:28 PM Joined: 29 Apr 2008 1) Force AutoHotkey to start a new thread, even the old is not returned 2) Return immediately and process after return Hum. Why not flag a global var, return, and recall the Deadkey() on keypressed ? In fact, exactly like an automation, with a ""state"" variable, and a whole bunch of ""case statements"" function of the ""state"" var ? #13 - Posted 22 May 2008 - 06:20 AM Back to top MateFARKAS Members 75 posts Last active: Apr 01 2013 06:38 PM Joined: 28 Oct 2007 PS: It is the same problem for each deadkey: impossible to build a layout with a deadkey combination of the deadkey itself.Fixed. You can checkout the SVN: <!-- m -->http://pkl.svn.sourc...net/viewvc/pkl/<!-- m --> #14 - Posted 23 May 2008 - 04:40 PM Portable Keyboard Layout Happy Sunday Back to top Jag02 Members 44 posts Last active: Feb 15 2010 08:46 AM Joined: 16 Apr 2008 Could you make the program so that if I press Backspace it suspends the portable colemak layout and if I press capslock, this starts it again? #15 - Posted 28 May 2008 - 08:43 AM Back to top Page 1 of 13 1 2 3 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"helps people to learn better, more efficient keyboard layouts such as Dvorak, Colemak or Asset. Forum thread:."	"true"
"Typing"	"Thumbscript"	"https://autohotkey.com/board/topic/27198-beta-thumbscript-ahk/"	"Allows you to type using the number pad, with only 2 number presses for every letter. Documentation:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[BETA] Thumbscript AHK - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. [BETA] Thumbscript AHK Started by Conquer , Mar 16 2008 09:29 PM Please log in to reply 8 replies to this topic Conquer Members 385 posts Last active: Jan 10 2013 02:14 AM Joined: 27 Jun 2006 Hey, here's my BETA script on thumbscript. Heres the design: <!-- m -->http://thumbscript.com/howitworks.html<!-- m --> The script allows you type only using the number pad, with only 2 number presses for every letter. The script: ; Thumbscript By Conquer ; www.autohotkey.com  #SingleInstance,Force SendMode,Input SetKeyDelay,-1  gosub BuildList  ; Assign all the letters to variables for later  keys=0 Caps = false  CapsTip = True  ; Show traytip when toggling caps state TipDelay = 1000 ; Milliseconds to show traytip for  Numpad1::NumCom(1) Numpad2::NumCom(2) Numpad3::NumCom(3) Numpad4::NumCom(4) Numpad5::NumCom(5) Numpad6::NumCom(6) Numpad7::NumCom(7) Numpad8::NumCom(8) Numpad9::NumCom(9) NumPad0::Space NumPadSub::Backspace  NumpadAdd:: disp := Caps(""Toggle"") If CapsTip = True {   Traytip,Thumbscript,%Disp%,10,1   SetTimer,TrayTipClear,%TipDelay% } return  TrayTipClear: SetTimer,TrayTipClear,Off TrayTip return  Caps(state)   ; Caps(On/True)|Caps(Off/False)|Caps(Toggle) {   global   if state = toggle   {     if caps = true     {       caps = false       return ""caps""     }     if caps = false     {       caps = true       return ""CAPS""     }   }   if state = on     state = true   if state = off     state = false   Caps = %State%   If Caps = True     return ""CAPS""   Else If Caps = False   return ""caps"" }  NumCom(key) {   global   ;Msgbox %Keys%/%Key%`n%Keeptrack%`n%Char%   keys += 1   IfLess,Keys,3     keeptrack=%keeptrack%%key%   If Keys > 1     gosub SetKey   return }  SetKey: ;Tooltip Com: %Keeptrack%`n`nChar: %Char% ;sleep 1000 ;ToolTip  Char := Char%KeepTrack%  If ( Char = ""{Enter}"" or Char = ""."" )   CapsSet = 1   ; (For Mode 3) Time to use a new capital WinGetActiveTitle,CurrentWin If CurrentWin <> %OldWin% {   CapsSet = 1   ; (For Mode 3) New window is active, so use a capital   OldWin := CurrentWin }  If Caps = True   StringUpper,Char, Char If Caps = 3 {   Char := Char%KeepTrack%   If ( CapsSet = ""True"" or CapsSet = ""3"" )     StringUpper, Char, Char   If CapsSet = 1  ; Capital for beginning of sentence     Capset = 0 } ;return  Send: If Char =  ; Invalid combo, clean up the com   goto Cleanup Send %Char% ;goto Cleanup ;return Cleanup: NumPadDiv:: keeptrack= keys=0 Char = return  BuildList: ; Letters, all on the outer 9 pad target ; Vowels all cross the middle in an unbent line Char13 = a Char83 = b Char93 = c Char81 = d Char91 = e Char92 = f Char96 = g Char43 = h Char82 = i Char84 = j Char89 = k Char86 = l Char12 = m Char42 = n Char46 = o Char74 = p Char76 = q Char23 = r Char63 = s Char62 = t Char73 = u Char78 = v Char79 = w Char71 = x Char72 = y Char41 = z  ; Commands:  ; Single Tap (Planned feature) or Double tap to use Char1 = , Char11 = , Char3 = . Char33 = . Char4 = {Tab} Char44 = {Tab} Char9 = {BackSpace} Char99 = {BackSpace} Char6 = {Enter} Char66 = {Enter}  ; Note that Numpad Enter also works.  ; Numbers: ; Start by pressing 5 then press  ; the number you want to type ; Note that this is different then the normal Thumpad's method. Char50 = 0 Char51 = 1 Char52 = 2 Char53 = 3 Char54 = 4 Char55 = 5 Char56 = 6 Char57 = 7 Char58 = 8 Char59 = 9 Char64 = 0  ; Backwards combo of O (letter) produces 0 if you hate using the 0 button  ; Symbols: Char39 = ( Char18 = ? Char19 = / Char29 = `{ Char69 = < Char28 = | Char48 = = Char98 = ' Char68 = `+ Char21 = ~ Char24 = ] Char47 = > Char67 = {ESC} Char32 = _ Char36 = : Char26 = [ Char37 = \ Char87 = ` Char97 = "" Char17 = ) Char27 = `} Char14 = `; return And the learning program I'm working on: (Not done yet) #SingleInstance, Force #Persistent SendMode,Input SetKeyDelay,-1 SetWinDelay,-1 SetControlDelay,-1 SetMouseDelay,-1 gosub VarInit  Gui,+AlwaysOnTop +ToolWindow Gui,Add,Text,x7,Tutorial Mode: Gui,Add,Text,vModeWp yp x+15, %Mode% Gui,Add,Text,x7 y+15,Current Character: Gui,Add,Picture,vPicWp x+5 h105 w83 Gui,Add,Edit,x7 w175 vInWp +Default Gui,Show,,Thumbscript If IsLabel(Mode)   goto %Mode% return  VarInit: Gui2Width = 100 Gui2Height = 100 T_ScreenWidth := A_ScreenWidth - Gui2Width T_ScreenHeight = 0 CurrentC = Red  ; Colour of the current letter in the gui. Warmup = abcdefghijklmnopqrstuvwxyz Ex1 = The quick brown fox jumps over the lazy brown dog. Mode = StartWarmup Nextletter = false Char = Loop,Parse,Warmup   Hotkey,%A_LoopField%,NextLetter,Off UseErrorLevel return  GuiClose: ExitApp return  StartWarmup: StringReplace,Ex1,Ex1,%A_Space%,,A PriorList = Loop,Parse,warmup {   If A_Loopfield =     continue   Char := A_LoopField   If Char   {     ;IfInString,Piror,%Char%       Hotkey,%Char%,On       /*     IfNotInString,Prior,%Char%     {       Prior .= Char       Hotkey,%Char%,NextLetter,On UseErrorLevel     }     */     GuiControl,,PicWp,%A_LoopField%.jpg      gosub WaitForLetter   } } Gui,Hide ; Hide the GUI, its AlwaysOnTop and will block the msgbox. Msgbox Warmup Complete. ExitApp return  Random: Char := RandomLetter() If Char =   goto Random ; Re-randomize if Char = %OldChar%   goto Random ; Re-randomize GuiControl,,Curent,%Char% gosub ShowLetter Nextletter = false If Char {   IfInString,Piror,%Char%     Hotkey,%Char%,On,UseErrorLevel   IfNotInString,Prior,%Char%   {     Prior .= Char     Hotkey,%Char%,NextLetter,On UseErrorLevel   } } If ErrorLevel   goto Random ; Re-randomize gosub WaitForLetter ;goto Random return  WaitForLetter: Loop  ; Wait for next key to be pressed {   If NextLetter = True   {     NextLetter = false     break   }   sleep 10 } return  NextLetter: Send %Char% OldChar := Char If Char ; If there was a previous character   Hotkey,%Char%,Off ; Remove prior hotkeys NextLetter = true ;If islabel(Mode) ;  goto %Mode% return  ShowLetter: If Char =   return If Char = %OldChar%   return GuiControl,,PicWp,%Char%.jpg  return  RandomLetter() {     global     Random,Generated,1,26     If Generated = 1       return ""a""     If Generated = 2       return ""b""     If Generated = 3       return ""c""     If Generated = 4       return ""d""     If Generated = 5       return ""e""     If Generated = 6       return ""f""     If Generated = 7       return ""g""     If Generated = 8       return ""h""     If Generated = 9       return ""i""     If Generated = 10       return ""j""     If Generated = 11       return ""k""     If Generated = 12       return ""l""     If Generated = 13       return ""m""     If Generated = 14       return ""n""     If Generated = 15       return ""o""     If Generated = 16       return ""p""     If Generated = 17       return ""q""     If Generated = 18       return ""r""     If Generated = 19       return ""s""     If Generated = 20       return ""t""     If Generated = 21       return ""u""     If Generated = 22       return ""v""     If Generated = 23       return ""w""     If Generated = 24       return ""x""     If Generated = 25       return ""y""     If Generated = 26       return ""z""     return }  NumpadMult::Reload Required Picture files for the Learner Script: <!-- m -->http://rapidshare.co... ... s.zip.html<!-- m --> Special thanks to HugoV for the startup post here <!-- m -->http://www.autohotke...538.html#184538<!-- m --> #1 - Posted 16 March 2008 - 09:29 PM Back to top Maddog! Guests Last active: Joined: -- Very cool! Now in thumbscript: very cool #2 - Posted 18 March 2008 - 11:41 AM Back to top BoBo¨ Guests Last active: Joined: -- Special thanks to me for the startup post [here] :wink::lol: 8) #3 - Posted 18 March 2008 - 11:48 AM Back to top BoBo¨ Guests Last active: Joined: -- A btw, thx for sharing it #4 - Posted 18 March 2008 - 11:49 AM Back to top Conquer Members 385 posts Last active: Jan 10 2013 02:14 AM Joined: 27 Jun 2006 Actually Bobo, I got the idea from here: 5th post down, by a guest (maybe you?) <!-- m -->http://www.autohotke... ... halfqwerty<!-- m --> :lol: But your topic is appreciated too. In thumbscript: Im actually getting decent at it, too, #5 - Posted 18 March 2008 - 11:11 PM Back to top BoBo¨ Guests Last active: Joined: -- Holy moly, looks like the price goes to ""Guuuuuuuuest"" ! *fanfare* #6 - Posted 19 March 2008 - 02:24 PM Back to top Scrooge Guests Last active: Joined: -- You forgot to support the numbers. PS: Thumbscript forgot about the exclamation mark!!!! #7 - Posted 03 September 2009 - 07:11 PM Back to top Scrooge Guests Last active: Joined: -- Nevermind, you just got the numbers backwards, fixed it on my version. Thanks. #8 - Posted 03 September 2009 - 07:14 PM Back to top randallf Members 711 posts Last active: Jan 07 2014 11:45 PM Joined: 06 Jul 2009 You should port this to windows mobile or w/e format so you can use it on cell phones without keypads. #9 - Posted 04 September 2009 - 03:44 PM Back to top Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"Allows you to type using the number pad, with only 2 number presses for every letter. Documentation:"	"true"
"Typing"	"link"	"http://thumbscript.com/howitworks.html"	"Allows you to type using the number pad, with only 2 number presses for every letter. Documentation:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"How Thumbscript Works ® How Thumbscript Works The unique idea behind Thumbscript is that the keypad can be seen as a simple 9 pixel drawing tablet. Just connect the dots to draw letters: On pen or touchpad devices draw letters from START to STOP. Tap once for commands. (For phones and keypads, press START then STOP and double press same key for commands.) Julie Streitelmeier of The-Gadgeteer.com says, ""I was able to memorize the actual letters A thru Z pretty quickly and was using the [Feather Touch Input] device to write short sentences in Microsoft Word within 10mins or so."" The Complete Thumbscript Key: Hints: 1.   Letters A-Z Start and Stop on the outer points of the keypad or 9-dot target. 2.   All letters go from top to bottom, or from left to right. (Reverse for Punctuation and symbols.) 3.   The vowels E,I,O,U are drawn with a straight line through the center. Now you try it! (Please give Java time to load.) Also download FREE software and information. Please join Friends of Thumbscript to receive a more information on this universal text input system for all kinds of gadgets! Home   Free   FAQs   Technical Notes   Opportunities   Contacts"	"null"	"null"	"Allows you to type using the number pad, with only 2 number presses for every letter. Documentation:"	"true"
"Typing"	"TypingAid"	"https://github.com/ManiacDC/TypingAid/releases"	"Suggests and completes words as you type. Forum thread: GitHub."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"25"	"9"	"12"	"Releases · ManiacDC/TypingAid · GitHub Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 9 Star 25 Fork 12 ManiacDC/TypingAid Code Issues 42 Pull requests 3 Pulse Graphs Releases Tags Latest release v2.22.0.0 deda168 TypingAid v2.22.0 ManiacDC released this Jun 26, 2015 · 26 commits to master since this release Various Wordlist.txt files may be found here 2.22.0 6/26/2015 * Added the ability to exact match on Window Titles (enquote, or tick the checkbox) ** Added Word Replacements. In wordlist.txt, use the form |r|. To define more than one replacement per word, simply add the word again on a different line. If Case Correction is off, the case of the first letter will be changed to match the word being replaced ** Added Word Descriptions. In wordlist.txt, use the form |d|. Replacements and Descriptions are compatible and can exist on the same word. With fixed width fonts, the description will show in a separate column ** Added a setting to control the width of the List Box in pixels ** Added Numpad Enter as an autocomplete key ** Fixed issues with words that had apostrophes (') in them ** Set journal_mode to TRUNCATE so the db journal isn't deleted every time ** Minor performance improvements when loading the wordlist ** Added a progress bar when loading the wordlist ** Added a progress bar when cleaning the wordlist (when exiting the script, the box may appear blank. I think this is because the script is exiting) ** Added framework for database conversions ** Fixed issue with overriding the default font Downloads 1.83 MB TypingAid.zip Source code (zip) Source code (tar.gz) v2.21.1.0 e21c162 TypingAid v2.21.1 ManiacDC released this May 4, 2015 · 41 commits to master since this release Various Wordlist.txt files may be found here 2.21.1 5/4/2015 * Fixed clicking on a word in the 64-bit version Downloads 1.67 MB TypingAid.zip Source code (zip) Source code (tar.gz) v2.21.0.0 eac6abf TypingAid v2.21.0 ManiacDC released this May 1, 2015 · 45 commits to master since this release Various Wordlist.txt files may be found here 2.21.0 5/1/2015 * Added the ability to insert a word by clicking on it in the Wordlist (turn of Single Click in the settings to require a double click for insertion) ** Added a setting to sort Learned Words before words in Wordlist.txt ** Added a setting to specify charactes which will terminate the current word, add the character to the end of the word, and permanently learn the word ** Added Setting back in for NumPresses (if set to 2, double hit the number to insert the word) ** Reorganized Settings Window to move more Wordlist Box settings to the Wordlist Box tab ** Changed ""Save & Exit"" in the settings window to ""Save & Close"" ** Minor code fixes Downloads 1.67 MB TypingAid.zip Source code (zip) Source code (tar.gz) v2.20.0 95f827d TypingAid v2.20.0 ManiacDC released this Apr 9, 2015 · 61 commits to master since this release Various Wordlist.txt files may be found here 2.20.0 4/9/2015 * Added a Settings window (thanks to HugoV for doing much of the coding). ** Changed the learned words to use an SQLite3 database backend. This should help with future enhancements ** Changing settings no longer requires a script restart ** Added Active/Inactive Notification Area icons ** Added working Pause functionality ** Detecting Window switches now uses Windows Event Hooks, rather than a timer ** Added weighting based on number of characters left to type ** Changed license to GPLv3 for compatibility with AhkDBA SQLite3 interface ** Added the ability to learn words with no alpha characters when hitting Ctrl-Shift-C, or to read them in from Wordlist.txt ** Fixed Wordlist drawing on the mouse when unable to detect the caret position ** Fixed words not being learned when hitting Ctrl-Shift-C while Learning is off ** Large amounts of code refactoring, including renaming all global variables and fixing function scope ** Fixed having length of 1 not work with ForceNewWordCharacters Downloads 1.65 MB TypingAid.zip Source code (zip) Source code (tar.gz) v2.19.9 9598c04 TypingAid v2.19.9 ManiacDC released this Dec 18, 2014 · 136 commits to master since this release 2.19.9 12/18/2014 * Fixed bug when creating TerminatingCharacters when generating preferences file. Broken TerminatingCharacters will be repaired if not already modified. ** Added ""Threading"" during the input loop to cause less missed keys ** Auto-launch 64 bit exe if present and launching a compiled script (name 64 bit script ""64.exe"") ** Fixed some poorly named variables Downloads 848 KB TypingAid.exe 1.18 MB TypingAid64.exe Source code (zip) Source code (tar.gz) v2.19.8 eac3d50 TypingAid v2.19.8 ManiacDC released this Nov 24, 2014 · 140 commits to master since this release 2.19.8 11/24/2014 * Fixed bug with generation of preferences file ** Fixed sent characters being detected when SendMethod=3 Downloads 847 KB TypingAid.exe 1.18 MB TypingAid64.exe Source code (zip) Source code (tar.gz) v2.19.7 b5c1343 TypingAid v2.19.7 ManiacDC released this Nov 6, 2014 · 141 commits to master since this release 2.19.7 11/6/2014 * The script is no longer compatible with AHK Basic. Please get the newest version from http://www.ahkscript.org. ** Fixes for Unicode - the script would stop reading the preferences file ** Fixes for how the Defaults.ini works when a Preferences.ini exists ** Consolidation of ini reading code ** Auto-correction of Preferences and Wordlist when swapping to/from Unicode version of AHK Downloads 847 KB TypingAid.exe 1.18 MB TypingAid64.exe Source code (zip) Source code (tar.gz) v2.19.6 8d263db TypingAid v2.19.6 ManiacDC released this Oct 30, 2014 · 150 commits to master since this release 2.19.6 10/30/2014 * Fix issue with AHK v1.1. Sometimes the script would stop detecting Input. ** Fixes to support Diacritic and Unicode characters. ** Fixes to support alternative keyboard layouts. Downloads 844 KB TypingAid.exe 1.18 MB TypingAid64.exe Source code (zip) Source code (tar.gz) v2.19.5 1ad7a3e TypingAid v2.19.5 ManiacDC released this Oct 7, 2014 · 159 commits to master since this release 2.19.5 10/7/2014 * Detect when SendPlay will not work and switch to SendInput (SendPlay requires Administrative Rights) ** Added ability to use a Defaults.ini file. Downloads 843 KB TypingAid.exe Source code (zip) Source code (tar.gz) Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/ManiacDC/TypingAid/releases"	"Suggests and completes words as you type. Forum thread: GitHub."	"true"
"Typing"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=5644"	"Suggests and completes words as you type. Forum thread: GitHub."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"TypingAid v2.22.0 - Word AutoCompletion Utility - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:30 All times are UTC-05:00 TypingAid v2.22.0 - Word AutoCompletion Utility Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 58 posts 1 2 3 Next Maniac Posts: 45 Joined: 24 Oct 2014, 07:15 GitHub: ManiacDC TypingAid v2.22.0 - Word AutoCompletion Utility Report this post Quote 18 Dec 2014, 11:03 Archived thread from old AHK forums. TypingAid is a simple, compact, and handy auto-completion utility. It is customizable enough to be useful for regular typing and for programming. Download: TypingAid v2.22.0 Precompiled Executable TypingAid v2.22.0 AHK Script As of version 2.19.7.0, the script is no longer compatible with AHK Basic. Please get the newest version from http://www.ahkscript.org. English Wordlists: 1200 English Words Weighted By Frequency 2000 Common English Words 2000 Common English Words (Alternative) 3600 English Words Large English Wordlist (Unfiltered, may contain curse words, etc) Large English Wordlist by rommmcek Large English Wordlist (words with only 4+ letters) by rommmcek 350,000+ English words (extracted from Project Gutenberg), found here 235,000+ English words (extracted from /usr/share/dict/words), found here Non-English Wordlists Large French Wordlist by rommmcek Large German Wordlist by rommmcek Large Italian Wordlist by rommmcek Romanian Wordlist (282,000+ words) Thanks to Ochisor. Extracted from here. Large Spanish Wordlist by jamesw77bp Large Spanish Wordlist by rommmcek AHK Keyword Wordlist: Wordlist AHK.txt (Thanks tidbit.) Wordlist AHK with parameter descriptions by rommmcek Wordlist AHK with parameter descriptions and comments by rommmcek Wordlist AHK with parameters autocompleted by rommmcek Screenshots: Change Log Features: As you type your word, up to 10 (or as defined in Settings) matches will appear in a drop-down dialog, numbered 1 - 0 (10th). To choose the match you want just hit the associated number on your keyboard (numpad does not work). Alternatively you can select an item from the drop-down using the Up/Down arrows or the mouse. You can define a fixed position for the drop-down dialog to appear by hitting Ctrl-Shift-H to open a small helper window, or by specifying a list of programs in the preferences file. Please note that in Firefox, Thunderbird, and certain other programs you will probably need to open the helper window due to issues detecting the caret position. Words should be stored in a file named 'Wordlist.txt' which should be located in the script directory. These words may be commented out by prefixing with a semicolon or simply removed or added. Words may include terminating characters (such as space), but you must select the word before typing the terminating character. In addition to being able to use the number keys to select a word, you can select words from the drop-down via the Up/Down arrows. Hitting Up on the first item will bring you to the last and hitting Down on the last item will bring you to the first. Hitting Page Up will bring you up 10 items, or to the first item. Hitting Page Down will bring you down 10 items, or to the last item. You can hit Tab, Right Arrow, Ctrl-Space, or Ctrl-Enter to autocomplete the selected word. This feature can be disabled or have some of its behavior modified via Settings. The script will learn words as you type them if ""Learn new words as you type"" is set to On in Settings. If you type a word more than 5 times (or as defined in ""Minimum length of word to learn"") in a single session the word will be permanently added to the list of learned words. Learned words will always appear below predefined words, but will be ranked and ordered among other learned words based on the frequency you type them. You can permanently learn a word by highlighting a word and hitting Ctrl-Shift-C (this works even if ""Learn new words as you type"" is set to Off). You may use Ctrl-Shift-Del to remove the currently selected Learned Word. Learned words are stored in the WordlistLearned.db sqlite3 database. Learned words are backed up in WordlistLearned.txt. To modify the list of Learned words manually, delete the WordlistLearned.db database, then manually edit the WordlistLearned.txt file. On the next launch of the script, the WordlistLearned.db database will be rebuilt. Word descriptions can be added to 'Wordlist.txt' that will appear in the wordlist next to the word. These descriptions should be in the form of <word>|d|<description>, e.g., Tylenol|d|Pain Reliever. This could be used for things like definitions, translation aids, or function arguments. When Fixed Width fonts are used in the wordlist, the description columns will be tabbed evenly so they line up. Word replacements can be added to 'Wordlist.txt' that will appear in the wordlist next to the word. These replacements should be in the form of <word>|r|<description>, e.g., fire|r|fuego. When the word is chosen, it will be backspaced out and replaced with the new word. If Case Correction is off, the first letter will be changed to match the case of the word being replaced. This could be used for spelling replacements, text expansion, or translation aids. Multiple replacements can be defined for a word (put each on a separate line). A description and a replacement can both be added to the same word. When Settings are changed, the script will automatically create a file named Preferences.ini in the script directory. This file allows for sharing settings between users. Users are encouraged to only edit settings by using the Settings window. To allow for distribution of standardized preferences, a Defaults.ini may be distributed with the same format as Preferences.ini. If the Defaults.ini is present, this will override the hardcoded defaults in the script. A user may override the Defaults.ini by changing settings in the Settings window. Customizable features include: Enable or disable learning mode. Number of characters a word needs to have in order to be learned. Number of times you must type a word before it is permanently learned. List of strings which will prevent any word which contains one of these strings from being learned. Number of times you must press a number hotkey to select the associated word. Change whether single or double clicking is required to autocomplete a word with the mouse. Disable certain keys for autocompleting a word selected via the arrow keys. Change the method used to send the word to the screen. Change whether the script simply completes or actually replaces the word (capitalization change based on the wordlist file). Enable or disable the resetting of the Wordlist Box on a mouseclick. Change whether a space should be automatically added after the autocompleted word or not. Number of items to show in the list at once. Number of characters before the list of words appears. Choose whether to display learned words before words in Wordlist.txt. Enable, disable, or customize the arrow key's functionality. Change whether the typed word should appear in the word list or not. Number of pixels below the caret to display the Wordlist Box. Wordlist Box Default Font of fixed (Courier New) or variable (Tahoma) width. Wordlist Box Font Size. Wordlist Box Opacity setting to set the transparency of the List Box. Wordlist Box Character Width to override the computed character width. Wordlist Box Default Font override. Wordlist Box Max Width List of programs for which you want %g_ScriptTitle% enabled. List of programs for which you do not want %g_ScriptTitle% enabled. List of programs for which you want the Helper Window to automatically open. List of characters which terminate a word. List of characters which terminate a word and start a new word. List of characters which end a word, add that character to the word, and force the word to be learned.Unicode Support: Full support for UTF-8 character set. Known Issues Workarounds Future Features Credits: Maniac Jordi S HugoV kakarukeys Asaptrad j4hangir Theclaw rommmcek jamesw77bp Original Thread Last edited by Maniac on 03 Nov 2015, 09:31, edited 10 times in total. Top zotune Posts: 53 Joined: 17 Nov 2014, 17:57 Re: TypingAid v2.19.9 - Word AutoCompletion Utility Report this post Quote 30 Jan 2015, 06:55 Love this script. Is there any way to make this work with IP-addresses such as 10.211.110.21? I think it registers . (dot) as end of a word. Thank you for your wonderful work. Top Maniac Posts: 45 Joined: 24 Oct 2014, 07:15 GitHub: ManiacDC Re: TypingAid v2.19.9 - Word AutoCompletion Utility Report this post Quote 30 Jan 2015, 07:14 It does register a . as the end of the word (you can disable that, but I wouldn't recommend it). If you only need to learn a specific (and small) set of IP addresses, you can do the following: 1. Set ""Length"" to 2 in preferences.ini (make sure the script is not running when you do this). This will cause the wordlist to pop up when you've only typed 2 letters (if your IP addresses all begin with 3 characters, you can skip this step). 2. Type out the IP address, highlight it, and then hit Ctrl-Shift-C. This should learn the word. 3. Type out the first octal of the IP address, and then you should be able to autocomplete it (don't hit the .!) If #2 doesn't work, just manually add the IP address to your wordlist. Top zotune Posts: 53 Joined: 17 Nov 2014, 17:57 Re: TypingAid v2.19.9 - Word AutoCompletion Utility Report this post Quote 30 Jan 2015, 07:17 Thanks for the quick reply. It doesn't seem to work with numbers for me (for some reason). Top Maniac Posts: 45 Joined: 24 Oct 2014, 07:15 GitHub: ManiacDC Re: TypingAid v2.19.9 - Word AutoCompletion Utility Report this post Quote 30 Jan 2015, 08:45 OK, I see the issue. I specifically added checks which suppressed the ability to learn/read any words without alpha characters. I've added this back when reading from Wordlist.txt or hitting ctrl-shift-c. This will be in the next release, but you can grab my development branch if you want. It has a bunch of other changes though (including a whole rewrite of the database backend). Go here: https://github.com/ManiacDC/TypingAid/tree/SQLite Hit ""Download Zip"" on the right. Top zotune Posts: 53 Joined: 17 Nov 2014, 17:57 Re: TypingAid v2.19.9 - Word AutoCompletion Utility Report this post Quote 30 Jan 2015, 10:04 Okay, thanks I will add it when it's available (I need to edit parts of the scripts anyhow). Top bonami Posts: 1 Joined: 31 Mar 2015, 22:23 Re: TypingAid v2.19.9 - Word AutoCompletion Utility Report this post Quote 01 Apr 2015, 04:12 Do I have to run it as a serparate ahk? I tried to include it from my script, but it tried to undefine my hotkeys. Then, how to call this script from mine? Top Maniac Posts: 45 Joined: 24 Oct 2014, 07:15 GitHub: ManiacDC Re: TypingAid v2.19.9 - Word AutoCompletion Utility Report this post Quote 01 Apr 2015, 05:47 You'll need to run it standalone, unless you plan on really tweaking the contents of this script. Thanks! Top Maniac Posts: 45 Joined: 24 Oct 2014, 07:15 GitHub: ManiacDC Re: TypingAid v2.20.0 - Word AutoCompletion Utility Report this post Quote 09 Apr 2015, 07:24 2.20.0 has been released! *2.20.0 4/9/2015 ** Added a Settings window (thanks to HugoV for doing much of the coding). ** Changed the learned words to use an SQLite3 database backend. This should help with future enhancements ** Changing settings no longer requires a script restart ** Added Active/Inactive Notification Area icons ** Added working Pause functionality ** Detecting Window switches now uses Windows Event Hooks, rather than a timer ** Added weighting based on number of characters left to type ** Changed license to GPLv3 for compatibility with AhkDBA SQLite3 interface ** Added the ability to learn words with no alpha characters when hitting Ctrl-Shift-C, or to read them in from Wordlist.txt ** Fixed Wordlist drawing on the mouse when unable to detect the caret position ** Fixed words not being learned when hitting Ctrl-Shift-C while Learning is off ** Large amounts of code refactoring, including renaming all global variables and fixing function scope ** Fixed having length of 1 not work with ForceNewWordCharacters Top zotune Posts: 53 Joined: 17 Nov 2014, 17:57 Re: TypingAid v2.20.0 - Word AutoCompletion Utility Report this post Quote 29 Apr 2015, 01:40 New version with settings GUI looks promising, great job. Though where is the wordlist now? (Can I change it in the settings Window?) Also, with this new Database wordlist, I don't think I'll be able to incorporate it into my own script (I share the .txt file on the network). Is there any way to fix the IP issue in 2.19, or perhaps use 2.20 without database? Kind regards Mikael Top Maniac Posts: 45 Joined: 24 Oct 2014, 07:15 GitHub: ManiacDC Re: TypingAid v2.20.0 - Word AutoCompletion Utility Report this post Quote 29 Apr 2015, 06:03 Thanks! Wordlist.txt is the same as it always was. WordlistLearned.txt has been replaced (it's still written to, but it's not read from unless WordlistLearned.db does not exist). If you need to manually edit WordlistLearned, right now the only way is to shut down the script, delete the .db file, and edit the .txt file. The .db will then be rebuilt. Why can't you share the WordlistLearned.db over the network? It should work even better... I *think* you may even be able to access and use it from both PC's at once. One thing you won't have to do is close the script anymore before the file is updated on the other PC - updates should all be live. The code changes since 2.19 have been so drastic that I have no plans to make further changes in 2.19. Top Maniac Posts: 45 Joined: 24 Oct 2014, 07:15 GitHub: ManiacDC Re: TypingAid v2.21.0 - Word AutoCompletion Utility Report this post Quote 01 May 2015, 14:16 TypingAid 2.21.0.0 has been released! *2.21.0 5/1/2015 ** Added the ability to insert a word by clicking on it in the Wordlist (turn of Single Click in the settings to require a double click for insertion) ** Added a setting to sort Learned Words before words in Wordlist.txt ** Added a setting to specify charactes which will terminate the current word, add the character to the end of the word, and permanently learn the word ** Added Setting back in for NumPresses (if set to 2, double hit the number to insert the word) ** Reorganized Settings Window to move more Wordlist Box settings to the Wordlist Box tab ** Changed ""Save & Exit"" in the settings window to ""Save & Close"" ** Minor code fixes The new ""End Word Characters"" setting is pretty useful for programming. For example, if I had ( in my End Word Characters, I could type: MyFunction(A,B) MyFunction( would be learned, and would appear, with the (, the next time I start typing MyF... Top Maniac Posts: 45 Joined: 24 Oct 2014, 07:15 GitHub: ManiacDC Re: TypingAid v2.21.0 - Word AutoCompletion Utility Report this post Quote 01 May 2015, 22:16 Oops, download links fixed! Top Maniac Posts: 45 Joined: 24 Oct 2014, 07:15 GitHub: ManiacDC Re: TypingAid v2.21.1 - Word AutoCompletion Utility Report this post Quote 04 May 2015, 12:41 *2.21.1 5/4/2015 ** Fixed clicking on a word in the 64-bit version Top zotune Posts: 53 Joined: 17 Nov 2014, 17:57 Re: TypingAid v2.21.1 - Word AutoCompletion Utility Report this post Quote 21 May 2015, 15:30 Oh okay, sweet. Great work mate. IP still doesn't work though. Our network starts with 10. Example: 10.211.114.38 I added it to Wordlist.txt with no luck :S Edit: Removing . from terminating characters seems to have fixed it Awesome! Top Maniac Posts: 45 Joined: 24 Oct 2014, 07:15 GitHub: ManiacDC Re: TypingAid v2.21.1 - Word AutoCompletion Utility Report this post Quote 21 May 2015, 18:48 Alternatively, you could set the number of characters to show the word list at to 2. Glad it works for you Top rommmcek Posts: 139 Joined: 15 Aug 2014, 15:18 Re: TypingAid v2.21.1 - Word AutoCompletion Utility Report this post Quote 22 May 2015, 07:02 Hi! I like your script. Even this writing I do with its help. I did some minor changes for displaying ListBox. Maybe you could include some of them into your official script. Especially that in line 535 of my version. Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ;These functions and labels are related to the shown list of words   InitializeListBox() {    global      Gui, ListBoxGui: -Caption +AlwaysOnTop +ToolWindow +Delimiter%g_DelimiterChar%      Local ListBoxFont    IfNotEqual, prefs_ListBoxFontOverride,       ListBoxFont := prefs_ListBoxFontOverride    else {          IfEqual, prefs_ListBoxFontFixed, On               ListBoxFont = Courier New          else ListBoxFont = Tahoma       }      Gui, ListBoxGui:Font, s%prefs_ListBoxFontSize%, %ListBoxFont%    Loop, %prefs_ListBoxRows%    {       GuiControl, ListBoxGui:-Redraw, g_ListBox%A_Index%       ;can't use a g-label here as windows sometimes passes the click message when spamming the scrollbar arrows       Gui, ListBoxGui: Add, ListBox, vg_ListBox%A_Index% R%A_Index% X0 Y0 hwndg_ListBoxHwnd%A_Index%    }      Return }   ListBoxClickItem(wParam, lParam, msg, ClickedHwnd) {    global    Local NewClickedItem    Local TempRows    static LastClickedItem      TempRows := GetRows()      if (ClickedHwnd != g_ListBoxHwnd%TempRows%)    {       return    }      ; if we clicked in the scrollbar, jump out    if (A_GuiX > (g_ListBoxPosX + g_ListBoxContentWidth))    {       SetSwitchOffListBoxTimer()       Return    }      GuiControlGet, g_MatchPos, ListBoxGui:, g_ListBox%TempRows%      if (msg == g_WM_LBUTTONUP)    {       if prefs_DisabledAutoCompleteKeys not contains L       {          SwitchOffListBoxIfActive()          EvaluateUpDown(""$LButton"")         } else {          ; Track this to make sure we're double clicking on the same item          NewClickedItem := g_MatchPos          SetSwitchOffListBoxTimer()       }      } else if (msg == g_WM_LBUTTONDBLCLK)    {       SwitchOffListBoxIfActive()         if prefs_DisabledAutoCompleteKeys contains L       {          if (LastClickedItem == g_MatchPos)          {             EvaluateUpDown(""$LButton"")            }       }    } else {       SwitchOffListBoxIfActive()    }      ; clear or set LastClickedItem    LastClickedItem := NewClickedItem      Return }   SetSwitchOffListBoxTimer() {    static DoubleClickTime      if !(DoubleClickTime)    {       DoubleClickTime := DllCall(""GetDoubleClickTime"")    }    ;When single click is off, we have to wait for the double click time to pass    ; before re-activating the edit window to allow double click to work    SetTimer, SwitchOffListBoxIfActiveSub, -%DoubleClickTime% }     SwitchOffListBoxIfActiveSub: SwitchOffListBoxIfActive() Return   ListBoxScroll(Hook, Event, EventHwnd) {    global      Local MatchEnd    Local SI    Local TempRows    Local Position      if (g_ListBox_Id)    {         TempRows := GetRows()       if (g_ListBoxHwnd%TempRows% != EventHwnd)       {          return       }         if (Event == g_EVENT_SYSTEM_SCROLLINGSTART)       {          ; make sure the timer is clear so we don't switch while scrolling          SetTimer, SwitchOffListBoxIfActiveSub, Off          return       }         SI:=GetScrollInfo(g_ListBoxHwnd%TempRows%)         if (!SI.npos)       {          return       }         if (SI.npos == g_MatchStart)       {          return       }         g_MatchStart := SI.npos         SetSwitchOffListBoxTimer()      } }   ; based on code by HotKeyIt ;  http://www.autohotkey.com/board/topic/78829-ahk-l-scrollinfo/ ;  http://www.autohotkey.com/board/topic/55150-class-structfunc-sizeof-updated-010412-ahkv2/ GetScrollInfo(ctrlhwnd) {   global g_SB_VERT   global g_SIF_POS   SI:=new _Struct(""cbSize,fMask,nMin,nMax,nPage,nPos,nTrackPos"")   SI.cbSize:=sizeof(SI)   SI.fMask := g_SIF_POS   If !DllCall(""GetScrollInfo"",""PTR"",ctrlhwnd,""Int"",g_SB_VERT,""PTR"",SI[""""])     Return false   else Return SI }   ListBoxChooseItem(Row) {    global    GuiControl, ListBoxGui: Choose, g_ListBox%Row%, %g_MatchPos% }   ;------------------------------------------------------------------------   CloseListBox() {    global g_ListBox_Id    IfNotEqual, g_ListBox_Id,    {       Gui, ListBoxGui: Hide       ListBoxEnd()    }    Return }   DestroyListBox() {    Gui, ListBoxGui:Destroy    ListBoxEnd()    Return }   ListBoxEnd() {    global g_ScrollEventHook    global g_ScrollEventHookThread    global g_ListBox_Id    global g_WM_LBUTTONUP    global g_WM_LBUTTONDBLCLK      g_ListBox_Id =      OnMessage(g_WM_LBUTTONUP, """")    OnMessage(g_WM_LBUTTONDBLCLK, """")      if (g_ScrollEventHook) {       DllCall(""UnhookWinEvent"", ""Uint"", g_ScrollEventHook)       g_ScrollEventHook =       g_ScrollEventHookThread =       MaybeCoUninitialize()    }    DisableKeyboardHotKeys()    return }   ;------------------------------------------------------------------------   SavePriorMatchPosition() {    global g_MatchPos    global g_MatchStart    global g_OldMatch    global g_OldMatchStart    global g_singlematch    global prefs_ArrowKeyMethod      if !(g_MatchPos)    {       g_OldMatch =       g_OldMatchStart =    } else IfEqual, prefs_ArrowKeyMethod, LastWord    {       g_OldMatch := g_singlematch[g_MatchPos]       g_OldMatchStart =    } else IfEqual, prefs_ArrowKeyMethod, LastPosition    {       g_OldMatch := g_MatchPos       g_OldMatchStart := g_MatchStart    } else {       g_OldMatch =       g_OldMatchStart =    }      Return }   SetupMatchPosition() {    global g_MatchPos    global g_MatchStart    global g_MatchTotal    global g_OldMatch    global g_OldMatchStart    global g_singlematch    global prefs_ArrowKeyMethod    global prefs_ListBoxRows      IfEqual, g_OldMatch,    {       IfEqual, prefs_ArrowKeyMethod, Off       {          g_MatchPos =          g_MatchStart = 1       } else {          g_MatchPos = 1          g_MatchStart = 1       }    } else IfEqual, prefs_ArrowKeyMethod, Off    {       g_MatchPos =       g_MatchStart = 1    } else IfEqual, prefs_ArrowKeyMethod, LastPosition    {       IfGreater, g_OldMatch, %g_MatchTotal%       {          g_MatchStart := g_MatchTotal - (prefs_ListBoxRows - 1)          IfLess, g_MatchStart, 1             g_MatchStart = 1          g_MatchPos := g_MatchTotal       } else {          g_MatchStart := g_OldMatchStart          If ( g_MatchStart > (g_MatchTotal - (prefs_ListBoxRows - 1) ))          {             g_MatchStart := g_MatchTotal - (prefs_ListBoxRows - 1)             IfLess, g_MatchStart, 1                g_MatchStart = 1          }          g_MatchPos := g_OldMatch       }      } else IfEqual, prefs_ArrowKeyMethod, LastWord    {       ListPosition =       Loop, %g_MatchTotal%       {          if ( g_OldMatch == g_singlematch[A_Index] )          {             ListPosition := A_Index             Break          }       }       IfEqual, ListPosition,       {          g_MatchPos = 1          g_MatchStart = 1       } Else {          g_MatchStart := ListPosition - (prefs_ListBoxRows - 1)          IfLess, g_MatchStart, 1             g_MatchStart = 1          g_MatchPos := ListPosition       }    } else {       g_MatchPos = 1       g_MatchStart = 1    }      g_OldMatch =    g_OldMatchStart =    Return }   RebuildMatchList() {    global g_Match    global g_MatchLongestLength    global g_MatchPos    global g_MatchStart    global g_MatchTotal    global g_OriginalMatchStart    global g_singlematch    global prefs_ListBoxRows      g_Match =    g_MatchLongestLength =      if (!g_MatchPos)    {       ; do nothing    } else if (g_MatchPos < g_MatchStart)    {       g_MatchStart := g_MatchPos    } else if (g_MatchPos > (g_MatchStart + (prefs_ListBoxRows - 1)))    {       g_MatchStart := g_MatchPos - (prefs_ListBoxRows -1)    }      g_OriginalMatchStart := g_MatchStart      Loop, %g_MatchTotal%    {       CurrentLength := AddToMatchList(A_Index,g_singlematch[A_Index])       IfGreater, CurrentLength, %g_MatchLongestLength%          g_MatchLongestLength := CurrentLength         }    StringTrimRight, g_Match, g_Match, 1        ; Get rid of the last linefeed    Return }   AddToMatchList(position,value) {    global g_DelimiterChar    global g_Match    global g_MatchStart    global g_NumKeyMethod      IfEqual, g_NumKeyMethod, Off    {       prefix =    } else IfLess, position, %g_MatchStart%    {       prefix =    } else if ( position > ( g_MatchStart + 9 ) )    {       prefix =    } else {       prefix := Mod(position - g_MatchStart +1,10) . "" ""    }      g_Match .= prefix . value . g_DelimiterChar    Return, StrLen(""8 "" . value) }   ;------------------------------------------------------------------------   ;Show matched values ShowListBox() {    global      IfNotEqual, g_Match,    {       Local BorderWidthX       Local ListBoxActualSize       Local ListBoxActualSizeH       Local ListBoxActualSizeW       Local ListBoxPosY       Local ListBoxSizeX       Local ListBoxThread       Local MatchEnd       Local Rows       Local ScrollBarWidth       static ListBox_Old_Cursor         Rows := GetRows()         IfGreater, g_MatchTotal, %Rows%       {          SysGet, ScrollBarWidth, %g_SM_CXVSCROLL%          if ScrollBarWidth is not integer                ScrollBarWidth = 17               } else ScrollBarWidth = 0         ; Grab the internal border width of the ListBox box       SysGet, BorderWidthX, %g_SM_CXFOCUSBORDER%       If BorderWidthX is not integer          BorderWidthX = 1           ;Use 8 pixels for each character in width       ListBoxSizeX := g_ListBoxCharacterWidthComputed * g_MatchLongestLength + g_ListBoxCharacterWidthComputed + ScrollBarWidth + (BorderWidthX * 2)           g_ListBoxPosX := HCaretX()       ; + ListBoxOffset Move ListBox down a little so as not to hide the caret.       ListBoxPosY := HCaretY() + prefs_ListBoxOffset + 5 + 2 * prefs_ListBoxFontSize   ; <--------- RRR modification         MatchEnd := g_MatchStart + (prefs_ListBoxRows - 1)         Loop, %prefs_ListBoxRows%       {          IfEqual, A_Index, %Rows%          {             GuiControl, ListBoxGui: -Redraw, g_ListBox%A_Index%             GuiControl, ListBoxGui: Move, g_ListBox%A_Index%, w%ListBoxSizeX%             GuiControl, ListBoxGui: ,g_ListBox%A_Index%, %g_DelimiterChar%%g_Match%             IfNotEqual, g_MatchPos,             {                GuiControl, ListBoxGui: Choose, g_ListBox%A_Index%, %MatchEnd%                GuiControl, ListBoxGui: Choose, g_ListBox%A_Index%, %g_MatchPos%             }             GuiControl, ListBoxGui: +AltSubmit +Redraw, g_ListBox%A_Index%             GuiControl, ListBoxGui: Show, g_ListBox%A_Index%             GuiControlGet, ListBoxActualSize, ListBoxGui: Pos, g_ListBox%A_Index%             Continue          }            GuiControl, ListBoxGui: Hide, g_ListBox%A_Index%          GuiControl, ListBoxGui: -Redraw, g_ListBox%A_Index%          GuiControl, ListBoxGui: , g_ListBox%A_Index%, %g_DelimiterChar%       }         ForceWithinMonitorBounds(g_ListBoxPosX,ListBoxPosY,ListBoxActualSizeW,ListBoxActualSizeH,Rows)         g_ListBoxContentWidth := ListBoxActualSizeW - ScrollBarWidth - BorderWidthX         ; In rare scenarios, the Cursor may not have been detected. In these cases, we just won't show the ListBox.       IF (!(g_ListBoxPosX) || !(ListBoxPosY))       {          return       }         IfEqual, g_ListBox_Id,       {            if prefs_DisabledAutoCompleteKeys not contains L          {             if (!ListBox_Old_Cursor)             {                ListBox_Old_Cursor := DllCall(g_SetClassLongFunction, ""Uint"", g_ListBoxHwnd%Rows%, ""int"", g_GCLP_HCURSOR, ""int"", g_cursor_hand)             }               DllCall(g_SetClassLongFunction, ""Uint"", g_ListBoxHwnd%Rows%, ""int"", g_GCLP_HCURSOR, ""int"", g_cursor_hand)            ; we only need to set it back to the default cursor if we've ever unset the default cursor          } else if (ListBox_Old_Cursor)          {             DllCall(g_SetClassLongFunction, ""Uint"", g_ListBoxHwnd%Rows%, ""int"", g_GCLP_HCURSOR, ""int"", ListBox_Old_Cursor)          }         }         Gui, ListBoxGui: Show, NoActivate X%g_ListBoxPosX% Y%ListBoxPosY% H%ListBoxActualSizeH% W%ListBoxActualSizeW%, Word List Appears Here.       Gui, ListBoxGui: +LastFound +AlwaysOnTop         IfEqual, g_ListBox_Id,       {            EnableKeyboardHotKeys()         }         WinGet, g_ListBox_Id, ID, Word List Appears Here.         ListBoxThread := DllCall(""GetWindowThreadProcessId"", ""UPtr"", g_ListBox_Id)       if (g_ScrollEventHook && (ListBoxThread != g_ScrollEventHookThread))       {          DllCall(""UnhookWinEvent"", ""Uint"", g_ScrollEventHook)          g_ScrollEventHook =          g_ScrollEventHookThread =          MaybeCoUninitialize()       }         if (!g_ScrollEventHook) {          MaybeCoInitializeEx()          g_ScrollEventHook := DllCall(""SetWinEventHook"", ""Uint"", g_EVENT_SYSTEM_SCROLLINGSTART, ""Uint"", g_EVENT_SYSTEM_SCROLLINGEND, ""Ptr"", g_NULL, ""Uint"", g_ListBoxScrollCallback, ""Uint"", g_PID, ""Uint"", ListBoxThread, ""Uint"", g_NULL)          g_ScrollEventHookThread := ListBoxThread       }         OnMessage(g_WM_LBUTTONUP, ""ListBoxClickItem"")       OnMessage(g_WM_LBUTTONDBLCLK, ""ListBoxClickItem"")         IfNotEqual, prefs_ListBoxOpacity, 255          WinSet, Transparent, %prefs_ListBoxOpacity%, ahk_id %g_ListBox_Id%    } }   ForceWithinMonitorBounds(ByRef ListBoxPosX,ByRef ListBoxPosY,ListBoxActualSizeW,ListBoxActualSizeH,Rows) {    global prefs_ListBoxOffset    global prefs_ListBoxFontSize              ; <---------- RRR modification   ;Grab the number of non-dummy monitors    SysGet, NumMonitors, 80      IfLess, NumMonitors, 1       NumMonitors =1      Loop, %NumMonitors%    {       SysGet, Mon, Monitor, %A_Index%       IF ( ( ListBoxPosX < MonLeft ) || (ListBoxPosX > MonRight ) || ( ListBoxPosY < MonTop ) || (ListBoxPosY > MonBottom ) )          Continue         If ( (ListBoxPosX + ListBoxActualSizeW + 6 * prefs_ListBoxFontSize) > MonRight ) ; <---------- RRR modification       {          ListBoxPosX := MonRight - ListBoxActualSizeW - 6 * prefs_ListBoxFontSize      ; <---------- RRR modification          If ( ListBoxPosX < MonLeft )             ListBoxPosX := MonLeft       }   If ((ListBoxPosY + ListBoxActualSizeH + 3 * prefs_ListBoxFontSize) > (MonBottom ))       ; <---------- RRR modification { ListBoxPosY := HCaretY() - ListBoxActualSizeH - 2 * prefs_ListBoxFontSize * Rows / 5 - 2 ; <---------- RRR modification          If ( ListBoxPosY < 1 )       ; <---------- RRR modification             ListBoxPosY := 1          ; <---------- RRR modification }       Break    }      Return      }   ;------------------------------------------------------------------------   GetRows() {    global g_MatchTotal    global prefs_ListBoxRows    IfGreater, g_MatchTotal, %prefs_ListBoxRows%       Rows := prefs_ListBoxRows    else Rows := g_MatchTotal      Return, Rows } ;------------------------------------------------------------------------   ; function to grab the X position of the caret for the ListBox HCaretX() {    global g_Helper_Id      WinGetPos, HelperX,,,, ahk_id %g_Helper_Id%    if HelperX !=    {       return HelperX    }    if ( CheckIfCaretNotDetectable() )    {       MouseGetPos, MouseX       return MouseX    }    return A_CaretX }   ;------------------------------------------------------------------------   ; function to grab the Y position of the caret for the ListBox HCaretY() {    global g_Helper_Id      WinGetPos,,HelperY,,, ahk_id %g_Helper_Id%    if HelperY !=    {       return HelperY    }    if ( CheckIfCaretNotDetectable() )    {       MouseGetPos, , MouseY       return MouseY + 20    }    return A_CaretY }   ;------------------------------------------------------------------------   CheckIfCaretNotDetectable() {    ;Grab the number of non-dummy monitors    SysGet, NumMonitors, 80      IfLess, NumMonitors, 1       NumMonitors = 1      if !(A_CaretX)    {       Return, 1    }      ;if the X caret position is equal to the leftmost border of the monitor +1, we can't detect the caret position.    Loop, %NumMonitors%    {       SysGet, Mon, Monitor, %A_Index%       if ( A_CaretX = ( MonLeft ) )       {          Return, 1       }      }      Return, 0 }What I like less is slow loading of large WorldList and no suggest by very wrong spelling. That's why I sometimes switch to Uberi's AutoComplete. Did you ever think about unifying both approaches? Best wishes and many thanks! Top Maniac Posts: 45 Joined: 24 Oct 2014, 07:15 GitHub: ManiacDC Re: TypingAid v2.21.1 - Word AutoCompletion Utility Report this post Quote 22 May 2015, 07:18 I won't be able to take a look until the middle of June, but I will then. Are you sure large wordlists still load slowly? I would have expected 2.20 to fix that. Top rommmcek Posts: 139 Joined: 15 Aug 2014, 15:18 Re: TypingAid v2.21.1 - Word AutoCompletion Utility Report this post Quote 22 May 2015, 13:11 With that insert into your code Code: [Select all] [Download] GeSHi © Codebox Plus StartTime := A_TickCount ;Read in the WordList ReadWordList() ElapsedTime := A_TickCount - StartTime MsgBox,  %ElapsedTime% milliseconds have elapsed.I get following result: 39250 milliseconds have elapsed. I'm using WordList with 593820 lines (6.925.178 bytes) on Windows 8 64-bit What you could do in a few minutes is to type some long word on the bottom of the screen to see positioning of the diminishing ListBox above the cursor with my version of your ListBox.ahk Top Maniac Posts: 45 Joined: 24 Oct 2014, 07:15 GitHub: ManiacDC Re: TypingAid v2.21.1 - Word AutoCompletion Utility Report this post Quote 22 May 2015, 22:44 Do you ever change your wordlist? You could add them to WordlistLearned.txt and skip the loading time. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 58 posts 1 2 3 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 11 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"Suggests and completes words as you type. Forum thread: GitHub."	"true"
"Typing"	"link"	"https://github.com/ManiacDC/TypingAid"	"Suggests and completes words as you type. Forum thread: GitHub."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"25"	"9"	"12"	"GitHub - ManiacDC/TypingAid: Word AutoCompletion Utility Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 9 Star 25 Fork 12 ManiacDC/TypingAid Code Issues 42 Pull requests 3 Pulse Graphs Word AutoCompletion Utility http://www.autohotkey.com/board/topic/49517-ahk-11typingaid-v2200-word-autocompletion-utility/ 163 commits 1 branch 9 releases 2 contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show v2.22.0.0 v2.21.1.0 v2.21.0.0 v2.20.0 v2.19.9 v2.19.8 v2.19.7 v2.19.6 v2.19.5 Nothing to show New pull request Latest commit f495682 Oct 27, 2015 ManiacDC Merge branch 'master' of https://github.com/ManiacDC/TypingAid … Conflicts: 	Readme.txt Permalink Failed to load latest commit information. Images updated Settings and Changelog.txt May 1, 2015 Source Fix issue with word not being capitalized after normalization Oct 27, 2015 Wordlists Added new English Wordlists Oct 27, 2015 Changelog.txt Word replacements respect original capitalization if Case Correction … Jun 26, 2015 DBA license.txt Initial Pass using SQLite Oct 10, 2014 LICENSE Create LICENSE - GPL v3 Nov 24, 2014 Readme.txt Added new English Wordlists Oct 27, 2015 Readme.txt TypingAid is a simple, compact, and handy auto-completion utility.  It is customizable enough to be useful for regular typing and for programming.  [b]Download:[/b] [url=https://github.com/ManiacDC/TypingAid/releases/download/v2.22.0.0/TypingAid.zip]TypingAid v2.22.0 Precompiled Executable[/url] [url=https://github.com/ManiacDC/TypingAid/archive/v2.22.0.0.zip]TypingAid v2.22.0 AHK Script[/url]  As of version 2.19.7.0, the script is no longer compatible with AHK Basic. Please get the newest version from [url]http://www.ahkscript.org[/url].  English Wordlists: [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/Wordlist%201200%20frequency%20weighted.txt]1200 English Words Weighted By Frequency[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/Wordlist%202000%20common.txt]2000 Common English Words[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/Wordlist%202000%20common%202.txt]2000 Common English Words (Alternative)[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/Wordlist%203600.txt]3600 English Words[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/English%20wordlist%20unfiltered.txt]Large English Wordlist (Unfiltered, may contain curse words, etc)[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/WordList_English%20rommmcek.txt]Large English Wordlist[/url] by [url=http://ahkscript.org/boards/memberlist.php?mode=viewprofile&u=59845]rommmcek[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/WordList_English%20rommmcek%20(4%2B%20letter%20words%20only).txt]Large English Wordlist (words with only 4+ letters)[/url] by [url=http://ahkscript.org/boards/memberlist.php?mode=viewprofile&u=59845]rommmcek[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/WordList%20English%20Gutenberg.txt]350,000+ English words (extracted from Project Gutenberg)[/url], [url=https://github.com/dwyl/english-words]found here[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/WordList%20English%20Unix.txt]235,000+ English words (extracted from /usr/share/dict/words)[/url], [url=https://github.com/dwyl/english-words]found here[/url]  Non-English Wordlists [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/WordList_French%20rommmcek.txt]Large French Wordlist[/url] by [url=http://ahkscript.org/boards/memberlist.php?mode=viewprofile&u=59845]rommmcek[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/WordList_German%20rommmcek.txt]Large German Wordlist[/url] by [url=http://ahkscript.org/boards/memberlist.php?mode=viewprofile&u=59845]rommmcek[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/WordList_ItalianAbc%20rommmcek.txt]Large Italian Wordlist[/url] by [url=http://ahkscript.org/boards/memberlist.php?mode=viewprofile&u=59845]rommmcek[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/Wordlist%20Romanian.txt]Romanian Wordlist (282,000+ words)[/url] Thanks to [url=http://www.autohotkey.com/board/user/38990-ochisor/]Ochisor[/url]. Extracted from [url=http://www.ub-filosofie.ro/~solcan/wt/gnu/s/aspell-ro.html]here[/url]. [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/Wordlist%20Spanish.txt]Large Spanish Wordlist[/url] by [url=https://github.com/jamesw77bp]jamesw77bp[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/WordList_SpanishAbc%20rommmcek.txt]Large Spanish Wordlist[/url] by [url=http://ahkscript.org/boards/memberlist.php?mode=viewprofile&u=59845]rommmcek[/url]  AHK Keyword Wordlist: [url=https://github.com/ManiacDC/TypingAid/raw/master/Wordlists/WordList%20AHK.txt]Wordlist AHK.txt[/url] (Thanks [url=http://www.autohotkey.com/board/topic/49517-typingaid-v219-word-autocompletion-utility/page-22#entry425973]tidbit[/url].) [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/WordList%20AHK%20with%20parameter%20descriptions.txt]Wordlist AHK with parameter descriptions[/url] by [url=http://ahkscript.org/boards/memberlist.php?mode=viewprofile&u=59845]rommmcek[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/WordList%20AHK%20with%20parameter%20descriptions%20and%20comments.txt]Wordlist AHK with parameter descriptions and comments[/url] by [url=http://ahkscript.org/boards/memberlist.php?mode=viewprofile&u=59845]rommmcek[/url] [url=https://raw.githubusercontent.com/ManiacDC/TypingAid/master/Wordlists/WordList%20AHK%20with%20parameters%20autocompleted.txt]Wordlist AHK with parameters autocompleted[/url] by [url=http://ahkscript.org/boards/memberlist.php?mode=viewprofile&u=59845]rommmcek[/url]  [b]Screenshots:[/b] [img]https://github.com/ManiacDC/TypingAid/raw/master/Images/TypingAidListBox.png[/img] [img]https://github.com/ManiacDC/TypingAid/raw/master/Images/TypingAidSettings.png[/img]  [b][url=https://github.com/ManiacDC/TypingAid/raw/master/Changelog.txt]Change Log[/url][/b]  [b]Features:[/b] As you type your word, up to 10 (or as defined in Settings) matches will appear in a drop-down dialog, numbered 1 - 0 (10th). To choose the match you want just hit the associated number on your keyboard (numpad does not work). Alternatively you can select an item from the drop-down using the Up/Down arrows or the mouse. You can define a fixed position for the drop-down dialog to appear by hitting Ctrl-Shift-H to open a small helper window, or by specifying a list of programs in the preferences file. Please note that in Firefox, Thunderbird, and certain other programs you will probably need to open the helper window due to issues detecting the caret position.  Words should be stored in a file named 'Wordlist.txt' which should be located in the script directory. These words may be commented out by prefixing with a semicolon or simply removed or added. Words may include terminating characters (such as space), but you must select the word before typing the terminating character.  In addition to being able to use the number keys to select a word, you can select words from the drop-down via the Up/Down arrows. Hitting Up on the first item will bring you to the last and hitting Down on the last item will bring you to the first. Hitting Page Up will bring you up 10 items, or to the first item. Hitting Page Down will bring you down 10 items, or to the last item. You can hit Tab, Right Arrow, Ctrl-Space, or Ctrl-Enter to autocomplete the selected word. This feature can be disabled or have some of its behavior modified via Settings.  The script will learn words as you type them if ""Learn new words as you type"" is set to On in Settings. If you type a word more than 5 times (or as defined in ""Minimum length of word to learn"") in a single session the word will be permanently added to the list of learned words. Learned words will always appear below predefined words, but will be ranked and ordered among other learned words based on the frequency you type them. You can permanently learn a word by highlighting a word and hitting Ctrl-Shift-C (this works even if ""Learn new words as you type"" is set to Off). You may use Ctrl-Shift-Del to remove the currently selected Learned Word. Learned words are stored in the WordlistLearned.db sqlite3 database. Learned words are backed up in WordlistLearned.txt. To modify the list of Learned words manually, delete the WordlistLearned.db database, then manually edit the WordlistLearned.txt file. On the next launch of the script, the WordlistLearned.db database will be rebuilt.  Word descriptions can be added to 'Wordlist.txt' that will appear in the wordlist next to the word. These descriptions should be in the form of <word>|d|<description>, e.g., Tylenol|d|Pain Reliever. This could be used for things like definitions, translation aids, or function arguments. When Fixed Width fonts are used in the wordlist, the description columns will be tabbed evenly so they line up.  Word replacements can be added to 'Wordlist.txt' that will appear in the wordlist next to the word. These replacements should be in the form of <word>|r|<description>, e.g., fire|r|fuego. When the word is chosen, it will be backspaced out and replaced with the new word. If Case Correction is off, the first letter will be changed to match the case of the word being replaced. This could be used for spelling replacements, text expansion, or translation aids. Multiple replacements can be defined for a word (put each on a separate line).  A description and a replacement can both be added to the same word.  When Settings are changed, the script will automatically create a file named Preferences.ini in the script directory. This file allows for sharing settings between users. Users are encouraged to only edit settings by using the Settings window. To allow for distribution of standardized preferences, a Defaults.ini may be distributed with the same format as Preferences.ini. If the Defaults.ini is present, this will override the hardcoded defaults in the script. A user may override the Defaults.ini by changing settings in the Settings window.  Customizable features include: [LIST] [*]Enable or disable learning mode.[/*] [*]Number of characters a word needs to have in order to be learned.[/*] [*]Number of times you must type a word before it is permanently learned.[/*] [*]List of strings which will prevent any word which contains one of these strings from being learned.[/*] [*]Number of times you must press a number hotkey to select the associated word.[/*] [*]Change whether single or double clicking is required to autocomplete a word with the mouse.[/*] [*]Disable certain keys for autocompleting a word selected via the arrow keys.[/*] [*]Change the method used to send the word to the screen.[/*] [*]Change whether the script simply completes or actually replaces the word (capitalization change based on the wordlist file).[/*] [*]Enable or disable the resetting of the Wordlist Box on a mouseclick.[/*] [*]Change whether a space should be automatically added after the autocompleted word or not.[/*] [*]Number of items to show in the list at once.[/*] [*]Number of characters before the list of words appears.[/*] [*]Choose whether to display learned words before words in Wordlist.txt.[/*] [*]Enable, disable, or customize the arrow key's functionality.[/*] [*]Change whether the typed word should appear in the word list or not.[/*] [*]Number of pixels below the caret to display the Wordlist Box.[/*] [*]Wordlist Box Default Font of fixed (Courier New) or variable (Tahoma) width.[/*] [*]Wordlist Box Font Size.[/*] [*]Wordlist Box Opacity setting to set the transparency of the List Box.[/*] [*]Wordlist Box Character Width to override the computed character width.[/*] [*]Wordlist Box Default Font override.[/*] [*]Wordlist Box Max Width[/*] [*]List of programs for which you want %g_ScriptTitle% enabled.[/*] [*]List of programs for which you do not want %g_ScriptTitle% enabled.[/*] [*]List of programs for which you want the Helper Window to automatically open.[/*] [*]List of characters which terminate a word.[/*] [*]List of characters which terminate a word and start a new word.[/*] [*]List of characters which end a word, add that character to the word, and force the word to be learned.[/*] [/LIST] [b]Unicode Support:[/b] Full support for UTF-8 character set.  [b][url=https://github.com/ManiacDC/TypingAid/issues?q=is%3Aopen+is%3Aissue]Known Issues[/url][/b]  [b][url=https://github.com/ManiacDC/TypingAid/issues?q=is%3Aissue+is%3Aclosed+label%3Awontfix]Workarounds[/url][/b]  [b][url=https://github.com/ManiacDC/TypingAid/issues?q=is%3Aopen+is%3Aissue+label%3Aenhancement]Future Features[/url][/b]  [b]Credits:[/b] Maniac Jordi S HugoV kakarukeys Asaptrad j4hangir Theclaw rommmcek jamesw77bp    [b][url=http://www.autohotkey.com/board/topic/636-intellisense-like-autoreplacement-with-multiple-suggestions/]Original Thread[/url][/b]  Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/ManiacDC/TypingAid"	"Suggests and completes words as you type. Forum thread: GitHub."	"true"
"Window Management"	"bug.n"	"https://github.com/fuhsjr00/bug.n"	"Tiling Window Manager. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"524"	"44"	"55"	"GitHub - fuhsjr00/bug.n: Tiling Window Manager for Windows Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 44 Star 524 Fork 55 fuhsjr00/bug.n Code Issues 17 Pull requests 1 Wiki Pulse Graphs Tiling Window Manager for Windows 423 commits 1 branch 4 releases 12 contributors AutoHotkey 98.8% C++ 1.1% Batchfile 0.1% AutoHotkey C++ Batchfile Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show v9.0.0-beta.1 v8.4.0 v8.3.1 v8.3.0 Nothing to show New pull request Latest commit 8c3412a Jul 2, 2016 joten committed on GitHub Merge pull request #108 from yehya/patch-1 … Fix typo Permalink Failed to load latest commit information. build provide command to compile ahk to exe Apr 14, 2016 doc Fix typo Jun 22, 2016 src Fixed bugs from issues #95, #101 and #102 Jun 11, 2016 test Made the ""remote control"" support multiple lines. Feb 12, 2015 usr added rule 18 to usr-config.ini Apr 13, 2016 LICENSE.md moved from .asciidoc to .md due to not properly rendered lists Mar 6, 2014 README.md initial src commit of v10 Feb 12, 2016 bugn.exe Fixed bugs from issues #95, #101 and #102 Jun 11, 2016 README.md bug.n -- Tiling Window Management bug.n is a tiling window manager add-on for the Explorer shell of Microsoft Windows. It is written in the scripting language AutoHotkey. What it can do Provide layouts for resizing and moving windows, utilizing all available screen estate and customizable to your specific needs and workflow Provide views (i. e. virtual desktops) for showing only those windows, which you need to do your work. Dynamically resize and move your windows, applying a specified layout, without you having to care about moving them all by mouse Increase the available screen estate by hiding and therewith freeing up the space occupied by the Microsoft Windows Taskbar and the title bar for every single window and replacing all with a single slim status bar (-- but bug.n is not a shell replacement) Show window management information in the status bar: active window title, active layout, overview of the views used Show system information in the status bar: time and date, CPU and memory usage, disk and network load, battery and volume level Store your settings, i. e. which windows and layout were set on a specific view Support multiple monitors What it enables you to do You can resize and move windows specified by the active layout and initialized by hotkey. You can toggle the visibility of the Windows Taskbar. You can toggle the visibility of the Windows title bar of the active window. You can change the layout for the tiling window management suitable to your needs. Tile: Lay out all windows like tiles on a master area, which can be further split up, and a stacking area, where remaining windows can be stacked or shown side by side. Monocle: All windows are maximized and only one is shown at any time. Floating: Windows are not dynamically tiled. You can further customize the layouts for each view. You can move windows to another view (virtual desktop) by tagging them with a number. You can share windows between views by tagging them with more than one number. You can move between views, hiding the windows, you do not want to see, and showing those, you want to see, by pressing a simple hotkey. What it can look like Installing and running bug.n Requirements Microsoft Windows 2000 or higher AutoHotkey 1.1.10 or higher (if running bug.n from source as a script) You may either download the stable version of bug.n from the repository, or download the current development version as the repository itself. Either way, you will have a zip file including an executable (bugn.exe), the source (src\*) and documentation (doc\*) files. There is no installation process for bug.n. Unpack the zip file, and you should be able to run either the executable as it is or the main script (src\Main.ahk) with AutoHotkey. Documentation Please see the documentation for more information on installing and running, customizing and using bug.n and for a list of changes made with the current version, in particular the changes in the user interface (configuration variables and hotkeys). Please see the CREDITS file for a list of people and projects, which contributed to bug.n. License bug.n is licensed under the GNU General Public License version 3. Please see the LICENSE file for the full license text. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/fuhsjr00/bug.n"	"Tiling Window Manager. Forum thread:"	"true"
"Window Management"	"link"	"https://autohotkey.com/board/topic/30332-bugn-tiling-window-manager/"	"Tiling Window Manager. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"bug.n - Tiling Window Manager - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. bug.n - Tiling Window Manager Started by joten' , Jun 28 2008 12:02 PM Page 1 of 3 1 2 3 Next Please log in to reply 43 replies to this topic joten' Guests Last active: Joined: -- Please see http://www.autohotkey.net./~joten/ for updated information and the latest version. ' wanted to share this one: dWm - dynamic window management function (1) ""tiling window management"" by positioning and sizing windows according to a specified layout selected by key stroke (2) ""virtual desktops"" with the slightly different concept of tagging windows and restricting the view to windows with the same tag download dWm 0.3.5 known bug If windows are resized and positioned automatically (autoResizeAndPositionWindowsFlag := true), this is triggered by shell messages (HSHELL_WINDOWCREATED and HSHELL_WINDOWDESTROYED). Sometimes this happens unexpectedly, if an application in systray pops up (in my case it seems to be the commodo firewall) or in firefox with popup blocker and an according website or with windows explorer and its child windows. history Most times I use linux for my ""personal computer experience"" and became addicted to tiling window management in form of dwm and wmii. So I wanted to have something similar when working with windows, but could not find anything usable - no shell replacement seems to do this and none of these seems to be up to date for windows vista, the only thing I found was ""siaynoq"" :shock: . Finally I found GridMove and with this in mind and a lot of forum search I assembled all to fit in dWm . I hope it is usefull for someone else but me. I have listed the whole code below for direct review and forum search. dWm.ahk /* 	title: 		dWm (dynamic window managment for Windows) 	author: 	joten 	version: 	0.3.5 	date: 	27.06.2008 	function: 	""tiling window management"" by positioning and sizing windows according to a specified layout selected by key stroke 			""virtual desktops"" with the slightly different concept of tagging windows and restricting the view to windows with the same tag 	comment: 	first impression of dynamic (tiling) window management: http://www.suckless.org/wiki/dwm 			hints at implementing window management with AutoHotkey: http://jgpaiva.donationcoders.com/gridmove.html (no code copied) 			source for virtual desktops (tagging): http://www.autohotkey.com/forum/topic6182.html (code copied, but mostly rewritten to support arrays storing the window ids) 			source for array handling (AHKArray): http://www.autohotkey.com/forum/topic14881.html (olegbl) 			If code was copied AutoHotkey from the forum, it has been commented at the end of the code snippet. 	license: 	The code written by joten is licensed under the GPL (version 2) like AutoHotkey itself (see license.txt). */  ; <init (editable in parts)> 	OnExit, CleanUp 	; clean up (virtual desktops) in particular in case of an error (otherwise some windows might get lost) and show the window titlebars 	SetBatchLines, -1 	SetWinDelay, 0 	IfExist %A_ScriptDir%\images\dWm.ico 		Menu, Tray, Icon, %A_ScriptDir%\images\dWm.ico  	; <options (editable)> 		maxViewNumber := 4 		autoDisplayViewNumberFlag := true 		OSDFontName 	:= ""Tahoma"" 		OSDFontColor 	:= ""FF8000"" 		OSDFontFormat	= 600 		OSDOpacity 	:= 70  		layoutMode 	= s 		; m/b/s 		numberOfAreas	:= 1 		; < 9 		splitLayout 	= v 		; v/h 		splitRatio 		:= 0.5 	; <= 1 		hideTitlebarFlag	:= true 		autoResizeAndPositionWindowsFlag := true 		autoDisplayLayoutGridFlag 	:= true 		exceptions 			= Button,Shell_TrayWnd,WindowsForms10.Window.8.app.0.3d893c,#32770 	; </options>  	activeView 	:= 1 	noViewAction 	:= true 	; ""autoResizeAndPositionWindows"" does not work together with the tagging/view functions, because after a reload of the script and switching the view or tagging a window, HSHELL_WINDOWDESTROYED or HSHELL_WINDOWCREATED are detected and the ""windows"" array is rewritten, while windows are hidden or shown.  	viewWindows 	:= AHKANewArray() 	windows 		:= AHKANewArray() 	Loop, %maxViewNumber% 		windows 	:= AHKAAdd(windows, viewWindows)  	If hideTitlebarFlag 		hideTitlebars(true) 	getWorkingAreaSizeAndPosition() 	resizeAndPositionWindows() ; </init>  ; <main> 	Gui +LastFound 	hWnd := WinExist()  	DllCall(""RegisterShellHookWindow"", UInt, hWnd) 	MsgNum := DllCall(""RegisterWindowMessage"", Str, ""SHELLHOOK"") 	OnMessage(MsgNum, ""ShellMessage"")  	; Return 	; End of Auto-Execute Section 	; source: http://www.autohotkey.com/forum/viewtopic.php?p=123323#123323 (SKAN) ; </main>  ; <hotkeys (editable in parts)> 	Loop, %maxViewNumber% 		Hotkey, !%A_Index%, switchToView 	Hotkey, !-, displayViewNumber 				; editable 	Hotkey, !0, displayOverView 				; editable  	Loop, 9 		Hotkey, #%A_Index%, setNumberOfAreas 	Hotkey, #0, setNumberOfAreas 			; editable 	Hotkey, #m, setLayoutMode 	Hotkey, #b, setLayoutMode 	Hotkey, #s, setLayoutMode 	Hotkey, #v, setSplitLayout 	Hotkey, #h, setSplitLayout  	Hotkey, IfWinActive 		Loop, %maxViewNumber% 		{ 			Hotkey, ^!%A_Index%, setTagOfActiveWindow 			Hotkey, ^+!%A_Index%, addTagToActiveWindow 		}  	#BS::Reload 							; editable 	#Esc::ExitApp 							; editable  	LWin & Right::AltTab 						; editable 	LWin & Left::ShiftAltTab		 			; editable 	#g::displayLayoutGrid()  	;<shortcuts (editable)> 		#F1::Run, Firefox 	;</shortcuts>  	#IfWinActive 		#c::closeWindow() 					; editable ; </hotkeys>  ; <functions> 	getWindows(view) { 		Global  		WinGet, windowList, List,,, Program Manager 		viewWindows := AHKANewArray() 		Loop, %windowList% { 	; write the list to an array and remove the task bar window id 			id := windowList%A_Index% 			WinGetClass, windowClass, ahk_id %id% 			If windowClass in %exceptions% 				Continue 			Else 				viewWindows 	:= AHKAAdd(viewWindows, id) 		} 		windows := AHKASet(windows, viewWindows, view) 	}  	ShellMessage(wParam, lParam) { 		Global  		If ( hideTitlebarFlag and (wParam = 1) ) {	; HSHELL_WINDOWCREATED = 1 			WinSet, Style, -0xC00000, ahk_id %lParam%, 		} 		If ( autoResizeAndPositionWindowsFlag and noViewAction and ( (wParam = 1) or (wParam = 2) ) ) {	; HSHELL_WINDOWCREATED = 1, HSHELL_WINDOWDESTROYED = 2 			autoResizeAndPositionWindows() 		} 	}  	autoResizeAndPositionWindows() { 		Global  		getWindows(activeView) 		viewWindows := AHKAGet(windows, activeView) 		numberOfAreas := AHKASize(viewWindows) 		resizeAndPositionWindows() 	}  	#include functions\AHKArray.ahk 	#include functions\tagging.ahk 	#include functions\window_management.ahk 	#include functions\OSD.ahk ; </functions>  CleanUp: 	; show all windows from all desktops and the according titlebars on exit  Loop, %maxViewNumber% 	showWindows(A_Index, true) hideTitlebars(false) ExitApp window_management.ahk /* 	title: 		dWm (dynamic window managment for Windows) 	author: 	joten 	version: 	0.3.5 	date: 	27.06.2008 	comment: 	If code was copied from the AutoHotkey forum, it has been commented at the end of the code snippet. 	license: 	The code written by joten is licensed under the GPL (version 2) like AutoHotkey itself (see license.txt). */  getWorkingAreaSizeAndPosition() { 	Global 	 	getTaskbarSizeAndPosition() 	SysGet, monitor, Monitor 	If ( (taskbarPosition = ""top"") or (taskbarPosition = ""bottom"") ) { 		workingAreaWidth 	:= monitorRight - monitorLeft 		workingAreaHeight 	:= monitorBottom - monitorTop - taskbarHeight 		workingAreaX 		:= monitorLeft 		If (taskbarPosition = ""top"") { 			workingAreaY 	:= monitorTop + taskbarHeight 		} Else { 			workingAreaY 	:= monitorTop 		} 	} Else { 		workingAreaWidth 	:= monitorRight - monitorLeft - taskbarWidth 		workingAreaHeight 	:= monitorBottom - monitorTop 		workingAreaY 		:= monitorTop 		If (taskbarPosition = ""left"") { 			workingAreaX 	:= monitorLeft + taskbarWidth 		} Else { 			workingAreaX 	:= monitorLeft 		} 	} }  getTaskbarSizeAndPosition() { 	Global  	; get dimensions and position of taskbar (specialcase autohide ?) 	WinGetPos, taskbarX, taskbarY, taskbarWidth, taskbarHeight, ahk_class Shell_TrayWnd 	taskbarWidth += taskbarX 	taskbarHeight += taskbarY  	; find out if its on top/left/bottom/right with its x,y 	; x0,y0 ( width < height )  means its on top 	if ( taskbarX < 10 and taskbarWidth < taskbarHeight ) 		taskbarPosition = left  	; x0,y0 ( width >=  height )  means its on left 	if ( taskbarX < 10 and taskbarWidth >= taskbarHeight )      		taskbarPosition = top  	; x+,y0 means its on right 	if ( taskbarX > 10 ) 		taskbarPosition = right  	; x0,y+ means its on bottom 	if ( taskbarY > 10 ) 		taskbarPosition = bottom  	Return } ; source: http://www.autohotkey.com/forum/topic8597.html (holomind)  resizeAndPositionWindows() { 	Global  	getSizesAndPositions() 	viewWindows := AHKAGet(windows, activeView) 	viewWindowsTotal := AHKASize(viewWindows) 	Loop, %viewWindowsTotal% 	{ 		id 	:= AHKAGet(viewWindows, A_Index) 		If (layoutMode = ""m"") { 			If ( (numberOfAreas = 1) or (A_Index = 1) ) { 				index := 1 			} Else { 				index := Mod(A_Index - 1, numberOfAreas - 1) + 1 				If index = 1 					index := numberOfAreas 			} 		} Else If (layoutMode = ""b"") { 			If ( (numberOfAreas = 1) or (A_Index = 1) ) { 				index := 1 			} Else If ( (numberOfAreas = 2) or (A_index = 2) ) { 				index := 2 			} Else { 				index := Mod(A_Index - 2, numberOfAreas - 2) + 2 				If index = 2 					index := numberOfAreas 			} 		} Else If (layoutMode = ""s"") { 			index := Mod(A_Index, numberOfAreas) 			If index = 0 				index := numberOfAreas 		} 		x 		:= AHKAGet(positionsX, index) 		y 		:= AHKAGet(positionsY, index) 		width 	:= AHKAGet(sizesWidth, index) 		height 	:= AHKAGet(sizesHeight, index) 		WinMove, ahk_id %id%, , %x%, %y%, %width%, %height% 	} }  getSizesAndPositions() { 	Global  	positionsX 	:= AHKANewArray() 	positionsY 		:= AHKANewArray() 	sizesWidth 	:= AHKANewArray() 	sizesHeight 	:= AHKANewArray() 	If (layoutMode = ""m"") { 		positionsX	:= AHKAAdd(positionsX, workingAreaX) 		positionsY 	:= AHKAAdd(positionsY, workingAreaY) 		If (splitLayout = ""v"") { 			sizeWidth 		:= workingAreaWidth/(1+splitRatio) 			sizesWidth 	:=AHKAAdd(sizesWidth, sizeWidth) 			sizesHeight	:=AHKAAdd(sizesHeight, workingAreaHeight) 			positionX 		:= workingAreaX+workingAreaWidth/(1+splitRatio) 			positionY 		:= workingAreaY 			sizeWidth 		:= splitRatio/(1+splitRatio)*workingAreaWidth 			sizeHeight		:= Round(workingAreaHeight/(numberOfAreas-1)) 			Loop, % numberOfAreas-1 			{ 				positionsX 	:= AHKAAdd(positionsX, positionX) 				positionsY 		:= AHKAAdd(positionsY, positionY) 				sizesWidth 	:= AHKAAdd(sizesWidth, sizeWidth) 				sizesHeight 	:= AHKAAdd(sizesHeight, sizeHeight) 				positionY += sizeHeight 			} 		} Else If (splitLayout = ""h"") { 			sizesWidth 	:=AHKAAdd(sizesWidth, workingAreaWidth) 			sizeHeight 	:= workingAreaHeight/(1+splitRatio) 			sizesHeight 	:= AHKAAdd(sizesHeight, sizeHeight) 			positionX 		:= workingAreaX 			positionY 		:= workingAreaY+workingAreaHeight/(1+splitRatio) 			sizeWidth 		:= Round(workingAreaWidth/(numberOfAreas-1)) 			sizeHeight		:= splitRatio/(1+splitRatio)*workingAreaHeight 			Loop, % numberOfAreas-1 			{ 				positionsX 	:= AHKAAdd(positionsX, positionX) 				positionsY 		:= AHKAAdd(positionsY, positionY) 				sizesWidth 	:= AHKAAdd(sizesWidth, sizeWidth) 				sizesHeight 	:= AHKAAdd(sizesHeight, sizeHeight) 				positionX += sizeWidth 			} 		} 	} Else If (layoutMode = ""b"") { 		positionsX 	:= AHKAAdd(positionsX, workingAreaX) 		positionsY 		:= AHKAAdd(positionsY, workingAreaY) 		If (splitLayout = ""v"") { 			sizeWidth 		:= workingAreaWidth/(1+splitRatio) 			sizesWidth 	:= AHKAAdd(sizesWidth, sizeWidth) 			sizeHeight 	:= workingAreaHeight/2 			sizesHeight 	:= AHKAAdd(sizesHeight, sizeHeight) 			positionsX 	:= AHKAAdd(positionsX, workingAreaX) 			positionY 		:= workingAreaY+sizeHeight 			positionsY 		:= AHKAAdd(positionsY, positionY) 			sizesWidth 	:= AHKAAdd(sizesWidth, sizeWidth) 			sizesHeight 	:= AHKAAdd(sizesHeight, sizeHeight) 			positionX 		:= workingAreaX+workingAreaWidth/(1+splitRatio) 			positionY 		:= workingAreaY 			sizeWidth 		:= splitRatio/(1+splitRatio)*workingAreaWidth 			sizeHeight		:= Round(workingAreaHeight/(numberOfAreas-2)) 			Loop, % numberOfAreas-2 			{ 				positionsX 	:= AHKAAdd(positionsX, positionX) 				positionsY 		:= AHKAAdd(positionsY, positionY) 				sizesWidth 	:= AHKAAdd(sizesWidth, sizeWidth) 				sizesHeight 	:= AHKAAdd(sizesHeight, sizeHeight) 				positionY += sizeHeight 			} 		} Else If (splitLayout = ""h"") { 			sizeWidth 		:= workingAreaWidth/2 			sizesWidth 	:= AHKAAdd(sizesWidth, sizeWidth) 			sizeHeight 	:= workingAreaHeight/(1+splitRatio) 			sizesHeight 	:= AHKAAdd(sizesHeight, sizeHeight) 			positionX 		:= workingAreaX+sizeWidth 			positionsX 	:= AHKAAdd(positionsX, positionX) 			positionsY 		:= AHKAAdd(positionsY, workingAreaY) 			sizesWidth 	:= AHKAAdd(sizesWidth, sizeWidth) 			sizesHeight 	:= AHKAAdd(sizesHeight, sizeHeight) 			positionX 		:= workingAreaX 			positionY 		:= workingAreaY+workingAreaHeight/(1+splitRatio) 			sizeWidth 		:= Round(workingAreaWidth/(numberOfAreas-2)) 			sizeHeight		:= splitRatio/(1+splitRatio)*workingAreaHeight 			Loop, % numberOfAreas-2 			{ 				positionsX 	:= AHKAAdd(positionsX, positionX) 				positionsY 		:= AHKAAdd(positionsY, positionY) 				sizesWidth 	:= AHKAAdd(sizesWidth, sizeWidth) 				sizesHeight 	:= AHKAAdd(sizesHeight, sizeHeight) 				positionX += sizeWidth 			} 		} 	} Else If (layoutMode = ""s"") { 		If (splitLayout = ""v"") { 			positionX 	:= workingAreaX 			sizeWidth 	:= Round(workingAreaWidth/numberOfAreas) 			Loop, %numberOfAreas% 			{ 				positionsX 	:= AHKAAdd(positionsX, positionX) 				positionsY 		:= AHKAAdd(positionsY, workingAreaY) 				sizesWidth 	:= AHKAAdd(sizesWidth, sizeWidth) 				sizesHeight 	:= AHKAAdd(sizesHeight, workingAreaHeight) 				positionX += sizeWidth 			} 		} Else If (splitLayout = ""h"") { 			positionY 	:= workingAreaY 			sizeHeight	:= Round(workingAreaHeight/numberOfAreas) 			Loop, %numberOfAreas% 			{ 				positionsX 	:= AHKAAdd(positionsX, workingAreaX) 				positionsY 		:= AHKAAdd(positionsY, positionY) 				sizesWidth 	:= AHKAAdd(sizesWidth, workingAreaWidth) 				sizesHeight 	:= AHKAAdd(sizesHeight, sizeHeight) 				positionY += sizeHeight 			} 		} 	} }  setNumberOfAreas: 	StringReplace, numberOfAreas, A_ThisHotkey, #, 	getWindows(activeView) 	If (numberOfAreas+0 = 0) { 		viewWindows := AHKAGet(windows, activeView) 		numberOfAreas := AHKASize(viewWindows) 	} 	resizeAndPositionWindows() 	If autoDisplayLayoutGridFlag 		displayLayoutGrid() Return  setLayoutMode: 	StringReplace, layoutMode, A_ThisHotkey, #, 	getWindows(activeView) 	resizeAndPositionWindows() 	If autoDisplayLayoutGridFlag 		displayLayoutGrid() Return  setSplitLayout: 	StringReplace, splitLayout, A_ThisHotkey, #, 	getWindows(activeView) 	resizeAndPositionWindows() 	If autoDisplayLayoutGridFlag 		displayLayoutGrid() Return  activateWindow(index) { 	Global  	getWindows(activeView) 	viewWindows := AHKAGet(windows, activeView) 	id := AHKAGet(viewWindows, index) 	WinActivate, ahk_id %id% }  closeWindow() { 	WinGet, id, ID, A 	WinClose, ahk_id %id% }  hideTitlebars(hide) { 	Global  	getWindows(activeView) 	viewWindows := AHKAGet(windows, activeView) 	viewWindowsTotal := AHKASize(viewWindows) 	If (hide) { 		Loop, %viewWindowsTotal% 		{ 			id := AHKAGet(viewWindows, A_Index) 			WinSet, Style, -0xC00000, ahk_id %id%, 		} 	} Else { 		Loop, %viewWindowsTotal% 		{ 			id := AHKAGet(viewWindows, A_Index) 			WinSet, Style, +0xC00000, ahk_id %id%, 		} 	} }tagging.ahk /* 	title: 		dWm (dynamic window managment for Windows) 	author: 	joten 	version: 	0.3.5 	date: 	27.06.2008 	comment: 	If code was copied from the AutoHotkey forum, it has been commented at the end of the code snippet. 	license: 	The code written by joten is licensed under the GPL (version 2) like AutoHotkey itself (see license.txt). */  switchToView: 	StringReplace, newView, A_ThisHotkey, !, 	If (activeView <> newView+0) { 		getWindows(activeView) 		showWindows(activeView, false)  		showWindows(newView, true) 		activeView := newView 		activateLastActiveWindow(activeView) 		If autoResizeAndPositionWindowsFlag 			autoResizeAndPositionWindows() 		If autoDisplayViewNumberFlag 			OSD(activeView) 	} Return  showWindows(view, show) { 	; if show is true then the windows with the tag %view% are shown, else hidden 	Global  	noViewAction := false 	viewWindows := AHKAGet(windows, view) 	viewWindowsTotal := AHKASize(viewWindows) 	Loop, %viewWindowsTotal% { 		id := AHKAGet(viewWindows, A_Index) 		If (show) { 			WinShow, ahk_id %id% 		} Else { 			WinHide, ahk_id %id% 		} 	} 	noViewAction := true }  activateLastActiveWindow(view) { 	Global  	viewWindows := AHKAGet(windows, view) 	id := AHKAGet(viewWindows, 1) 	WinActivate, ahk_id %id% }  setTagOfActiveWindow: 	StringReplace, newTag, A_ThisHotkey, ^!, 	WinGet, id, ID, A 	removeWindowTags(id) 	addWindowTag(id, newTag)  	noViewAction := false 	If newTag+0 <> activeView 		WinHide, ahk_id %id% 	noViewAction := true 	activateLastActiveWindow(activeView) 	If autoResizeAndPositionWindowsFlag 		autoResizeAndPositionWindows() Return  removeWindowTags(id) { 	Global  	Loop, %maxViewNumber% { 		viewWindows := AHKAGet(windows, A_Index) 		index := AHKAFind(viewWindows, id, 1) 		If index > 0 			viewWindows := AHKARemove(viewWindows, index) 		windows := AHKASet(windows, viewWindows, A_Index) 	} }  addWindowTag(id, newTag) { 	Global 	 	viewWindows := AHKAGet(windows, newTag) 	viewWindows := AHKAAdd(viewWindows, id) 	windows := AHKASet(windows, viewWindows, newTag) } 	 addTagToActiveWindow: 	StringReplace, newTag, A_ThisHotkey, ^+!, 	WinGet, id, ID, A 	addWindowTag(id, newTag+0) Return OSD.ahk /* 	title: 		dWm (dynamic window managment for Windows) 	author: 	joten 	version: 	0.3.5 	date: 	27.06.2008 	comment: 	If code was copied from the AutoHotkey forum, it has been commented at the end of the code snippet. 	license: 	The code written by joten is licensed under the GPL (version 2) like AutoHotkey itself (see license.txt). */  displayViewNumber: 	OSD(activeView) Return  OSD(text, OSDFontSize=80, time=500) { 	Global OSDFontName, OSDFontColor, OSDOpacity, OSDFontFormat  	Gui, 2: Default 	wndTitle = ""blkOsdWnd2"" 	If (wndTitle) { 		IfWinExist, %wndTitle% 			WinClose 			Gui, Destroy 	} 	Gui, +LastFound +AlwaysOnTop +ToolWindow -Caption 	Gui, Margin, 0, 0 	; pixels of space to leave at the left/right and top/bottom sides of the window when auto-positioning. 	Gui, Color, ffffff 	; background color 	Gui, Font, c%OSDFontColor% s%OSDFontSize% w%OSDFontFormat%, %OSDFontName% 	Gui, Add, Text, +0x80 v & ""blkOsdCtrlName2"", %text% 	; 0x80 = SS_NOPREFIX -> Ampersand (&) is shown instead of underline one letter for Alt+letter navigation 	WinSet, ExStyle, +0x20 	; WS_EX_TRANSPARENT -> mouse klickthrough 	opacity := OSDOpacity * 255 / 100 	WinSet, TransColor, ffffff %opacity% 	Gui, Show, xCenter yCenter +NoActivate, %wndTitle% 	Sleep, %time% 	Gui, Destroy } ; source: http://www.autohotkey.com/forum/topic8959.html  displayOverView: 	wndTitle = ""blkOsdWnd3"" 	If (wndTitle) { 		Gui, 3: Default 		IfWinExist, %wndTitle% 		{ 			WinClose 			Gui, Destroy 		} Else { 			OSDFontSize := 16 			rows := Round(workingAreaHeight/OSDFontSize*0.4) 			width := Round(workingAreaWidth*0.7) 			Gui, +LastFound +AlwaysOnTop +ToolWindow -Caption 			Gui, Margin, 0, 0 			Gui, Color, ffffff 			Gui, Font, c%OSDFontColor% s%OSDFontSize% w%OSDFontFormat%, %OSDFontName% 			Gui, Add, ListView, r%rows% w%width%, View|Window Title  			DetectHiddenWindows, on 			Loop, %maxViewNumber% 			{ 				viewNumber 	:= A_Index 				viewWindows 	:= AHKAGet(windows, viewNumber) 				viewWindowsTotal := AHKASize(viewWindows) 				Loop, %viewWindowsTotal% 				{ 					id := AHKAGet(viewWindows, A_Index) 					WinGetTitle, windowTitle, ahk_id %id% 					If (A_Index = 1) { 						 LV_Add("""", viewNumber, windowTitle) 					} Else { 						LV_Add("""", """", windowTitle) 					} 				} 			} 			DetectHiddenWindows, off  			LV_ModifyCol(2)  ; Auto-size each column to fit its contents. 			; WinSet, ExStyle, +0x20 	; WS_EX_TRANSPARENT -> mouse klickthrough 			opacity := OSDOpacity * 255 / 100 			WinSet, TransColor, ffffff %opacity% 			Gui, Show, xCenter yCenter +NoActivate, %wndTitle% 		} 	} Return  displayLayoutGrid() { 	Global  	wndTitle = ""blkOsdWnd4"" 	If (wndTitle) { 		Gui, 4: Default 		IfWinExist, %wndTitle% 		{ 			WinClose 			Gui, Destroy 		} Else { 			OSDFontSize := 24 			thickness := 2 			Gui, +LastFound +AlwaysOnTop +ToolWindow -Caption 			Gui, Margin, 0, 0 			Gui, Color, ffffff 			Gui, Font, c%OSDFontColor% s%OSDFontSize% w%OSDFontFormat%, %OSDFontName%  			getSizesAndPositions() 			Loop, %numberOfAreas% 			{ 				x 		:= AHKAGet(positionsX, A_Index) 				y 		:= AHKAGet(positionsY, A_Index) 				width 	:= AHKAGet(sizesWidth, A_Index) 				height 	:= AHKAGet(sizesHeight, A_Index) 				x1 := x, 				y1 := y, 				w1 := width, 		h1 := thickness 				x2 := x, 				y2 := y, 				w2 := thickness, 	h2 := height 				x3 := x+width-thickness, 	y3 := y, 				w3 := thickness, 	h3 := height 				x4 := x, 				y4 := y+height-thickness, 	w4 := width, 		h4 := thickness 				cx := x+(width-OSDFontSize)/2, cy := y+(height-OSDFontSize)/2 				Gui, Add, Picture, w%w1% h%h1% x%x1% y%y1%, images\grid.bmp 				Gui, Add, Picture, w%w2% h%h2% x%x2% y%y2%, images\grid.bmp 				Gui, Add, Picture, w%w3% h%h3% x%x3% y%y3%, images\grid.bmp 				Gui, Add, Picture, w%w4% h%h4% x%x4% y%y4%, images\grid.bmp 				Gui, Add, Text, x%cx% y%cy% +0x80 v & ""blkOsdCtrlName2"", %A_Index% 			}  			WinSet, ExStyle, +0x20 	; WS_EX_TRANSPARENT -> mouse klickthrough 			opacity := OSDOpacity * 255 / 100 			WinSet, TransColor, ffffff %opacity% 			GUIWidth = %A_ScreenWidth% 			GUIHeight = %A_ScreenHeight% 			Gui, Show, x0 y0 w%GUIWidth% h%GUIHeight% +NoActivate, %wndTitle% 			Sleep, 1000 			Gui, Destroy 		} 	} }help.txt ===================== =       About       = ===================== title:    dWm (dynamic window managment for Windows) author:   joten version:  0.3.5 date:     27.06.2008 function: ""tiling window management"" by positioning and sizing windows according to a specified layout selected by key stroke           ""virtual desktops"" with the slightly different concept of tagging windows and restricting the view to windows with the same tag comment:  first impression of dynamic (tiling) window management: http://www.suckless.org/wiki/dwm           hints at implementing window management with AutoHotkey: http://jgpaiva.donationcoders.com/gridmove.html (no code copied)           source for virtual desktops (tagging): http://www.autohotkey.com/forum/topic6182.html (code copied, but mostly rewritten to support arrays storing the window ids)           source for array handling (AHKArray): http://www.autohotkey.com/forum/topic14881.html (olegbl)           If code was copied AutoHotkey from the forum, it has been commented at the end of the code snippet. license:  The code written by joten is licensed under the GPL (version 2) like AutoHotkey itself (see license.txt).  ===================== =      Options      = ===================== maxViewNumber             : Maximum number of views/tags; the absolute maximum is 9 autoDisplayViewNumberFlag : If set to true, the view number is displayed when switching the view. OSDFontName               : The font name for the OSD (on screen display) OSDFontColor              : The font color for the OSD (on screen display) OSDFontFormat             : The font format (boldness) for the OSD (on screen display) OSDOpacity                : The opacity of the OSD (on screen display) layoutMode                : Default value for the layout mode                                m = mono or master (one window in a master area, the other in a stacking area)                                b = bi (two windows in a splitted master area, the other in a stacking area)                                s = stack (no master, all windows are in teh stacking area) numberOfAreas             : The number of areas, in which the windows can be positioned; e. g.                                1 with mode s: 		all windows are maximized                                2 with mode m or s: 	split screen                                5 with mode m: 		one window in the master area, 4 in the stacking area splitLayout               : the direction of the stacking area                                v = vertical                                h = horizontal splitRatio                : The ratio in which the current column or row will be split (right to left column or upper to                              lower row) when the window is moved.		 hideTitlebarFlag          : If set to true, the titlebar of all windows is hidden leaving more space to the content. autoResizeAndPositionWindowsFlag: If set to true, the number of areas is automatically set to the number of windows and all  				windows are resized and positioned accordingly; this action is triggered by opening or closing a window. autoDisplayLayoutGridFlag : If set to true, the layout grid is displayed, when the layout is changed (by pressing Win+<m/b/s/v/h/<number>> exceptions                : Classes of windows, which are excluded from the list of windows and therefor are not resized                              and positioned; there seem to be windows, which are not shown in the taskbar (Shell_TrayWnd is                              obvious) and therefor have to be excluded from the list of managed windows.  ===================== =      Hotkeys      = ===================== Alt+<number>            : Switch to the <number>th view; number < maxViewNumber (see options) Alt+-                   : Display the view number; ß is the key next to 0 on a german keyboard Alt+0                   : Display a list of windows according to their tag (number) Ctrl+Alt+<number>       : Set <number> as the only tag of the active window; number < maxViewNumber (see options) Ctrl+Shift+Alt+<number> : Add <number> to the tags of the active windsow; number < maxViewNumber (see options)  Win+<number>            : Set the number of areas used to position the windows Win+0                   : Set the number of areas to the number of windows on the active view Win+<m/b/s>             : Set the layout mode                                m = mono or master (one window in a master area, the other in a stacking area)                                b = bi (two windows in a splitted master area, the other in a stacking area)                                s = stack (no master, all windows are in teh stacking area) Win+<v/h>               : Set the direction of the stacking area                                v = vertical                                h = horizontal Win+g                   : Display the grid of the layout Win+<Left Arrow>        : Open the ""Alt+Tab"" menu, switching to the next window; like Alt+Tab Win+<Right Arrow>       : Open the ""Alt+Tab"" menu, switching to the previous window; like Alt+Shift+Tab Win+c                   : Closing the active window  Win+Backspace           : Reload the script Win+Escape              : Exit the script  =     Shortcuts     = Shortcuts can be added as needed, if they are not conflicting with the existing ones. #1 - Posted 28 June 2008 - 12:02 PM Back to top joten Guests Last active: Joined: -- I have added some features and therfor post a new version. download dWm 0.4.1 new features (1) A new layout mode: f = fullscreen (no splitting, all windows are in fullscreen size; in effect this mode is like s1, but if the automatically resizing and positioning of windows is activated, the mode will not be changed, when a new window is opened.) (2) Set the active window as the primary master by pressing Win+Enter (3) Toggling the state (hidden or shown) of the taskbar by pressing Win+t (4) Moving the deviding line in a master mode (b/m) to the right/left or down/up by de-/increasing ""splitRatio"" by ""splitRatioIncrement"" known bug The same as above; I could not imagine a solution for this yet. But also no bug reports :roll:. comments For further explanation: dWm is unexceptional keyboard driven; therefor all functionality can be read from the ""hotkeys"" and ""options"" section. According to that these sections are explained in the help file. help.txt ===================== =       About       = ===================== title:    dWm (dynamic window managment for Windows) author:   joten version:  0.4.1 date:     07.07.2008 (last change: 07.07.2008) function: ""tiling window management"" by positioning and sizing windows according to a specified layout selected by key stroke           ""virtual desktops"" with the slightly different concept of tagging windows and restricting the view to windows with the same tag comment:  first impression of dynamic (tiling) window management: http://www.suckless.org/wiki/dwm           hints at implementing window management with AutoHotkey: http://jgpaiva.donationcoders.com/gridmove.html (no code copied)           source for virtual desktops (tagging): http://www.autohotkey.com/forum/topic6182.html (code copied, but mostly rewritten to support            arrays storing the window ids)           source for array handling (AHKArray): http://www.autohotkey.com/forum/topic14881.html (olegbl)           If code was copied AutoHotkey from the forum, it has been commented at the end of the code snippet. license:  The code written by joten is licensed under the GPL (version 2) like AutoHotkey itself (see license.txt).  ===================== =      Options      = ===================== maxViewNumber             : Maximum number of views/tags; the absolute maximum is 9 autoDisplayViewNumberFlag : If set to true, the view number is displayed when switching the view. OSDFontName               : The font name for the OSD (on screen display) OSDFontColor              : The font color for the OSD (on screen display) OSDFontFormat             : The font format (boldness) for the OSD (on screen display) OSDOpacity                : The opacity of the OSD (on screen display) layoutMode                : Default value for the layout mode                                m = mono or master (one window in a master area, the other in a stacking area)                                b = bi (two windows in a splitted master area, the other in a stacking area)                                s = stack (no master, all windows are in the stacking area)                                f = fullscreen (no splitting, all windows are in fullscreen size; in effect this mode is like s1, but if the                                     automatically resizing and positioning of windows is activated, the mode will not be changed, when a new                                     window is opened.) numberOfAreas             : The number of areas, in which the windows can be positioned; e. g.                                1 with mode s: 		all windows are maximized                                2 with mode m or s: 	split screen                                5 with mode m: 		one window in the master area, 4 in the stacking area splitLayout               : the direction of the stacking area                                v = vertical                                h = horizontal splitRatio                : The ratio in which the current column or row will be split (right to left column or upper to                              lower row) when the window is moved. splitRatioIncrement       : Increment by wich ""splitRatio"" is decreased or increased when the master area is resized hideTitlebarFlag          : If set to true, the titlebar of all windows is hidden leaving more space to the content. hideTaskbarFlag           : If set to true, the taskbar is hidden at start time (see hotkey ""Win+t"" for toggling this option at run time). autoResizeAndPositionWindowsFlag: If set to true, the number of areas is automatically set to the number of windows and all                                    windows are resized and positioned accordingly; this action is triggered by opening or closing a window. autoDisplayLayoutGridFlag : If set to true, the layout grid is displayed, when the layout is changed (by pressing Win+<m/b/s/v/h/<number>> exceptions                : Classes of windows, which are excluded from the list of windows and therefor are not resized                              and positioned; there seem to be windows, which are not shown in the taskbar (Shell_TrayWnd is                              obvious) and therefor have to be excluded from the list of managed windows.  ===================== =      Hotkeys      = ===================== Alt+<number>            : Switch to the <number>th view; number < maxViewNumber (see options) Alt+ß                   : Display the view number; ""ß"" is the key next to ""0"" on a german keyboard, on an US-keyboard the key is ""-"".                           This hotkey has to be changed, if not using a german (latin1-de) keyboard. Alt+0                   : Display a list of windows according to their tag (number) Ctrl+Alt+<number>       : Set <number> as the only tag of the active window; number < maxViewNumber (see options) Ctrl+Shift+Alt+<number> : Add <number> to the tags of the active windsow; number < maxViewNumber (see options)  Win+<number>            : Set the number of areas used to position the windows Win+0                   : Set the number of areas to the number of windows on the active view Win+<m/b/s/f>           : Set the layout mode                                m = mono or master (one window in a master area, the other in a stacking area)                                b = bi (two windows in a splitted master area, the other in a stacking area)                                s = stack (no master, all windows are in the stacking area)                                f = fullscreen (no splitting, all windows are in fullscreen size; in effect this mode is like s1, but if the                                     automatically resizing and positioning of windows is activated, the mode will not be changed, when a new                                     window is opened.) Win+<v/h>               : Set the direction of the stacking area                                v = vertical                                h = horizontal Win+<Down Arrow>        : Decrease ""splitRatio"" by ""splitRatioIncrement"" and resize and position all windows, if in master (b/m) mode; moves                            the deviding line to the right or down Win+<Up Arrow>          : Increase ""splitRatio"" by ""splitRatioIncrement"" and resize and position all windows, if in master (b/m) mode; moves                            the deviding line to the left or up Win+Enter               : Set the active window as the primary master Win+g                   : Display the grid of the layout Win+<Left Arrow>        : Open the ""Alt+Tab"" menu, switching to the next window; like Alt+Tab Win+<Right Arrow>       : Open the ""Alt+Tab"" menu, switching to the previous window; like Alt+Shift+Tab Win+c                   : Closing the active window Win+t                   : Toggling the state of the taskbar (see option hideTaskbarFlag)  Win+Backspace           : Reload the script Win+Escape              : Exit the script  =     Shortcuts     = Shortcuts can be added as needed, if they are not conflicting with the existing ones. #2 - Posted 07 July 2008 - 06:05 PM Back to top pomj Members 30 posts Last active: Jun 10 2016 09:21 AM Joined: 22 Feb 2007 Aaah GREAT !! I will test this when i come home from work. I myself is addicted to larsWm when I'm on a linux machine. I've been searching for something similar in windows. NICE #3 - Posted 10 July 2008 - 08:32 AM Back to top joten Guests Last active: Joined: -- I have to admit, that until now dWm was a one PC, one OS, one user software - on my PC with Windows Vista and the taskbar on top it worked. :wink: But I have done some improvements, added features for usability and tested the result more seriously. download dWm 0.5.4 (exe) dWm 0.5.4 (zip) new features (1) The options are moved to an INI file (2) A tray menu, with which the options can be set (3) A more elaborated help (also accessible through the tray menu) (4) An option for starting dWm with Windows (link in autostart) (5) A shortcut editor for the hotkeys Win+Fx (6) The executable version dWm was tested with the following system configurations: Operating system: Windows Vista Home Premium (SP 1) AutoHotkey version: 1.0.47.06 Screen resolution: 1280x800 (Notebook) Operating system: Windows XP Home AutoHotkey version: 1.0.47.06 Screen resolution: 1024x768 (Notebook) known bugs - There is no support for multiple monitors. (no feature) - At least on one PC with Windows XP the Win+ hotkey with the Alt+Tab replacement is just going forward, if the has been pressed once. (minor bug) - At least on one PC with Windows Vista the ""Start"" button sometimes stays, when the taskbar is hidden. (bug, not reproducable) * I have implemented a ShellhookDelay, added two more exception lists and extended these, so that the old bug should no longer appear. * There also was a bug in the window management functions, which caused all windows to disappear, when starting dWm with the taskbar at the bottom or right of the screen. help.txt (help.html)     About  	  title    dWm (dynamic window managment for Windows) author   joten version  0.5.4 date     12.07.2008  function ""tiling window management"" by positioning and sizing windows according to a specified layout selected by key stroke ""virtual desktops"" with the slightly different concept of tagging windows and restricting the view to windows with the same tag  comment first impression of dynamic (tiling) window management: about - dwm - suckless.org <http://www.suckless.org/wiki/dwm> hints at implementing window management with AutoHotkey: GridMove - DonationCode.com <http://jgpaiva.donationcoders.com/gridmove.html> source for virtual desktops (tagging): Multiple virtual desktops <http://www.autohotkey.com/forum/topic6182.html> (code copied, but mostly rewritten to support arrays storing the window ids) source for array handling: AHKArray (olegbl) <http://www.autohotkey.com/forum/topic14881.html> source for embedding the internt explorer (IEControl/CoHelper): Internet Explorer Control - AutoHotkey <http://www.autohotkey.com/wiki/index.php?title=Internet_Explorer_Control> If code was copied AutoHotkey from the forum, it has been commented at the end of the code snippet.  license The code written by joten is licensed under the GPL (version 2) like AutoHotkey itself (see docs/license.html <license.html>).     Help  	       Description  *dWm* does, like its acronym says, *dynamic window management*. This means, it arranges the windows either automatically when a window is opened or closed, or on pressing a key combination according to a specific layout. These layouts imply showing up to nine windows (or just one) or all, arranging all side by side or up on each other, all in fullscreen or in a mode called ""master and stacking"". All layouts have in common, that they use the whole screen leaving no empty space. If setting the option for automatically sizing and positioning windows (all windows are shown), this will result in the concept of *tiling window management*. The ""master and stacking"" mode means, that one window or two (equally sized side by side) is/are shown in a master area (most part of the screen) and all others are shown equally sized in a stacking area.   Example showing a vertical master and stacking area with four windows  Additionally windows can be managed by *tagging* them with a number between one and nine. By selecting the according *view*, just the windows with the given tag are shown, the others are hidden. This is quite like virtual desktops, but with tagging you can also give one window two or more tags and therefor show this window on different views.   Example showing a horizontal master and stacking area with two windows in the master area; also showing an OSD with an overview of all windows with their given tags (stating on which views they reside)  All actions a user can do, beside setting the options, which is done over the tray menu of dWm, are keyboard driven. All hotkeys are listed below and briefly explained. Additionally the hotkeys Win+<function key (Fx)> can be mapped to user defined files or folders, which then can be executed or opened by pressing the according hotkey. These hotkeys (shortcuts) are edited with the shortcut editor, which is accessible over the tray menu. The files or folders can either be written in the edit fields directly with the full path or selected by means of the appropriate dialog, which is accessible by pressing the icons right to the edit fields.   Example showing three windows in vertical stacking mode, titlebars hidden and the shortcut editor on top.       Installation  You can either use the script version or the executable. The script version contains all files including images, documentation and the AHK files in a folder or ZIP file (which has to be unpacked); you will need AutoHotkey installed or associated to the AK exctension in order to run the script. At start the folder containing the dWm.ahk file must also contain the folders docs, images and functions including the according files, thus the main script needs the AHK files in the functions folder and copies the images and documentation into the user profile (subfolder %A_AppData%\dWm) %A_AppData% is a variable, whose value depends on the operating system, in case of Windows Vista it is ""AppData\Roaming"", in case of Windows XP it is ""Application Data"". dWm creates a subfolder ""dWm"" before copying the files and also saves the options in an INI file, which is stored in the same folder. When using the executable version of dWm, the AHK scripts are compiled in to this one executable and the images and documentation are packaged into it as well. When executed dWm will copy the images and documentation into the user profile and creates the INI file in there.       Known issues  dWm was tested with the following system configurations:  Operating system	Windows Vista Home Premium (SP 1) AutoHotkey version	1.0.47.06 Screen resolution	1280x800 (Notebook)   Operating system	Windows XP Home AutoHotkey version	1.0.47.06 Screen resolution	1024x768 (Notebook)       * There is no support for multiple monitors. (no feature)     * At least on one PC with Windows XP the Win+<left / right arrow>       hotkey with the Alt+Tab replacement is just going forward, if the       <right arrow> has been pressed once. (minor bug)     * At least on one PC with Windows Vista the ""Start"" button sometimes       stays, when the taskbar is hidden. (bug, not reproducable)   Hotkeys Alt+<number>	Switch to the <number>th view; number < maxViewNumber (see options) Alt+-	Display the view number; ""ß"" is the key next to ""0"" on a german keyboard, on an US-keyboard the key is ""-"". This hotkey has to be changed, if not using a german (latin1-de) keyboard. Alt+0	Display a list of windows according to their tag (number) Ctrl+Alt+<number>	Set <number> as the only tag of the active window; number < maxViewNumber (see options) Ctrl+Shift+Alt+<number>	Add <number> to the tags of the active windsow; number < maxViewNumber (see options) Win+<number>	Set the number of areas used to position the windows Win+0	Set the number of areas to the number of windows on the active view Win+<m/b/s/f>	Set the layout mode      * m = mono or master (one window in a master area, the other in a       stacking area)     * b = bi (two windows in a splitted master area, the other in a       stacking area)     * s = stack (no master, all windows are in the stacking area)     * f = fullscreen (no splitting, all windows are in fullscreen size;       in effect this mode is like s1, but if the automatically resizing       and positioning of windows is activated, the mode will not be       changed, when a new window is opened.)  Win+<v/h>	Set the direction of the stacking area      * v = vertical     * h = horizontal  Win+<Down Arrow>	Decrease ""splitRatio"" by ""splitRatioIncrement"" and resize and position all windows, if in master (b/m) mode; moves the deviding line to the right or down. Win+<Up Arrow>	Increase ""splitRatio"" by ""splitRatioIncrement"" and resize and position all windows, if in master (b/m) mode; moves the deviding line to the left or up Win+Enter	Set the active window as the primary master Win+g	Display the grid of the layout Win+<Left Arrow>	Open the ""Alt+Tab"" menu, switching to the next window; like Alt+Tab Win+>Right Arrow>	Open the ""Alt+Tab"" menu, switching to the previous window; like Alt+Shift+Tab Win+c	Closing the active window Win+t	Toggling the state of the taskbar (see option hideTaskbarFlag) Ctrl+Shift+Win+e	Add/Replace the class of the active window to/from the window management exceptions, causing windows with the given class not to be handled by the window management functions. Ctrl+Shift+Win+s	Opening the shortcut editor. Win+Backspace	Reload the script Win+Escape	Exit the script   Options maxViewNumber	Maximum number of views/tags; the absolute maximum is 9 autoDisplayViewNumberFlag	If set to true, the view number is displayed when switching the view. OSDColor	The font and line color for the OSD (on screen display) OSDOpacity	The opacity of the OSD (on screen display) layoutMode	Default value for the layout mode      * m = mono or master (one window in a master area, the other in a       stacking area)     * b = bi (two windows in a splitted master area, the other in a       stacking area)     * s = stack (no master, all windows are in the stacking area)     * f = fullscreen (no splitting, all windows are in fullscreen size;       in effect this mode is like s1, but if the automatically resizing       and positioning of windows is activated, the mode will not be       changed, when a new window is opened.)  numberOfAreas	The number of areas, in which the windows can be positioned; e. g.      * 1 with mode s: all windows are maximized     * 2 with mode m or s: split screen     * 5 with mode m: one window in the master area, 4 in the stacking area  splitLayout	the direction of the stacking area      * v = vertical     * h = horizontal  splitRatio	The ratio in which the current column or row will be split (right to left column or upper to lower row) when the window is moved. splitRatioIncrement	Increment by wich ""splitRatio"" is decreased or increased when the master area is resized hideTitlebarFlag	If set to true, the titlebar of all windows is hidden leaving more space to the content. hideTaskbarFlag	If set to true, the taskbar is hidden at start time (see hotkey ""Win+t"" for toggling this option at run time). autoResizeAndPositionWindowsFlag	If set to true, the number of areas is automatically set to the number of windows and all windows are resized and positioned accordingly; this action is triggered by opening or closing a window. autoDisplayLayoutGridFlag	If set to true, the layout grid is displayed, when the layout is changed (by pressing Win+<m/b/s/v/h/<number>>) exceptions	Classes of windows, which are excluded from the list of windows and therefor are not resized and positioned or examined when changing the view; there seem to be windows, which are not shown in the taskbar (Shell_TrayWnd is obvious) and therefor have to be excluded from the list of managed windows. wmClassExceptions	Classes of windows, which are not accounted for the window management. wmTitleExceptions	Titles of windows, which are not accounted for the window management. startWithWindows	Automatically start dWm with Windows by setting a link to the executable in the autostart menu. Naturally I appreciate any bug reports :?: , comments :!: :evil: or feature suggestions :idea: . #4 - Posted 12 July 2008 - 12:29 PM Back to top Joy2DWorld Members 562 posts Last active: Jun 30 2014 07:48 PM Joined: 04 Dec 2006 nicely done. small suggest, within lib. use only lib_ funct. names. eg. window_management.ahk to windowm.ahk and all func windowm_this and windowm_that. #5 - Posted 12 July 2008 - 06:51 PM Joyce Jamce Back to top pomj Members 30 posts Last active: Jun 10 2016 09:21 AM Joined: 22 Feb 2007 nice. I really like it (although I need a little adjustment ) Great that you can remove the windowborders. It sometimes behaves a little unexpected. Don't know yet if it is me haveing to learn the behaviour or if it is a bug. I'll keep you posted. one thing though. some applications do not behave very good in tiling mode so maybe a way to exclude some windows from the tiling (if that's possible) once again. great program. I've missed the tiling soo much. #6 - Posted 15 July 2008 - 09:49 AM Back to top joten Guests Last active: Joined: -- I have tested dWm on Windows 98 (VMware). It works - basically, but: - To display the help without opening the HTML files in Internet Explorer you need an Internet Explorer version greater than 5.0; it was successfully tested with version 6.0. (bug) - The OSD is flickering or just visible for less then a second. (bug) - The OSD has no transparent, but white background. (minor bug) - Hiding the titlebars does not work. (bug) - Automatically resizing and positioning the windows does not work. (bug) - The hotkeys ""Win+m"" and ""Win+f"" do not work as expected, because the explorer Win keys cannot be overridden. (bug) - The hotkeys ""Win+"" and ""Win+"" do not work. (bug) Test environment Operating system: Windows 98 SE Internet Explorer version: 5.0 (6.0 after the initial tests) AutoHotkey version: 1.0.47.06 Screen resolution: 1024x768 (VMware) download dWm 0.5.5 (zip) @Joy2DWorld: Thanks for your suggestion; I will consider it when making some more changes to the basic functions. Actually, it is my first AHK script, thus there is not much pragramming style or techniques in it. @pomj: The unexpected behaviour sounds like the bug I noticed in version 0.3.5 and 0.4.1; version 0.5.4 should solve the problem and allows to edit three exception lists: (1) General exceptions: A list of classes like ShellTray_Wnd, which are just editable in the INI file (2) Window management exceptions: A list of classes, which are editable in the INI file and addable over the hotkey Ctrl+Shift+Win+e (3) Window management exceptions: A list of titles, which are editable in the INI file and addable over the hotkey Ctrl+Win+e #7 - Posted 17 July 2008 - 02:57 PM Back to top krustyjonez Members 2 posts Last active: Jul 18 2008 09:40 PM Joined: 17 Jul 2008 I am a big fan of XMonad and Awesome on Unix desktops. I am thrilled and grateful you wrote this for Windows. It's fantastic. Unfortunately, I can't replicate the tiled screenshot in the help documentation-where the main window is on the left & the other windows are stacked on the right. In any mode of than the new fullscreen, I can't get the main window (the one with focus from Win-Enter) into Grid Box #1. #1 seems always reserved for the desktop. Any ideas on how to make this work? My specs : IBM Thinkpad T61p w/Nvidia Quadro FX, Vista x64 sp1, 4MB RAM. This happens whether or not I use the .exe or the .zip. #8 - Posted 17 July 2008 - 07:02 PM Back to top Joy2DWorld Members 562 posts Last active: Jun 30 2014 07:48 PM Joined: 04 Dec 2006 if helpful, note that *very* complex function set. would make a trayicon rightclick accessible 'simple' feature set. #9 - Posted 17 July 2008 - 09:32 PM Joyce Jamce Back to top joten Guests Last active: Joined: -- @krustyjonez Your problem sounds familiar from the beginning of my testing. It looks like you have a window, which is always on top, but not visible; this can be a tooltip (easy case) or some application, which resides in the SysTray. To deal with the problem, I need some more information: (1) Have you enabled the automatically resizing and positioning of windows? (2) When facing the problem, did you press Win+0 to reset the windows? (3) How does it look like in ""b"" mode (pressing Win+? (4) Did you use a version prior to 0.5.4 before? (5) Please try to press Ctrl+Shift+Win+e when this ominous window is in the master area; this would add the window title to the according exception list assuming that this window is indeed active. If the stated title in the appearing message box does not look like a match, you can remove it from the exception list by pressing Ctrl+Shift+Win+e again. Regards, Joerg #10 - Posted 18 July 2008 - 09:46 AM Back to top krustyjonez Members 2 posts Last active: Jul 18 2008 09:40 PM Joined: 17 Jul 2008 Yes, I ran it from the first version you put up on here. Are there registry settings? I think it's using a new INI. #11 - Posted 18 July 2008 - 04:21 PM Back to top joten Guests Last active: Joined: -- @krustyjonez Version 0.5.4 is the first one, which explicitly uses an INI file. No version uses registry keys. You may delete all files from %A_AppData%\dWm and run the latest version. But the most likely cause for your problem is a missing entry in the exception lists, which I did not consider, since the window in question did not pop up in my configurations. #12 - Posted 18 July 2008 - 06:27 PM Back to top joten Guests Last active: Joined: -- First I renamed the project to bug.n to avoid confusion with dwm from suckless.org (the capital w was not enough distinction in my opinion). I did some bug fixing, especially to increase compatibility with legacy versions of Windows, and added some minor features. download dWm 0.5.8 (exe) dWm 0.5.8 (zip) comments Since I renamed the project, the folder were renamed to; thus the old folders and links are no longer valid. Please delete the folder %A_AppData%\dWm with all its contents and the file %A_StartUp%\dWm.lnk. new features - hotkeys Ctrl+Shift+Win+a: Toggling the function ""Automatically resize and position windows"". Ctrl+Shift+Win+h: Opening the about/help documents. Ctrl+Shift+Win+i: Opening the INI file. Ctrl+Shift+Win+o: Opening the options. Ctrl+Shift+Win+s: Opening the shortcut editor. Ctrl+Shift+Win+q: Showing a message box with the titles and classes of the windows on the active view, which are handled by the window management functions. With this information hints are given for the exception lists, if windows are not sized and positioned correctly. new features - options binocularLayoutModeHotkey: The key, which completes the hotkey to switch to the binocular layout mode. fullscreenLayoutModeHotkey: The key, which completes the hotkey to switch to the full screen layout mode. monocularLayoutModeHotkey: The key, which completes the hotkey to switch to the monocular layout mode. stackingLayoutModeHotkey: The key, which completes the hotkey to switch to the stacking layout mode. With these options it is possible to change the hotkeys for setting the layout mode; this avoids the conflicts with the already set Windows keys in Windows 98. known bugs General * There is no support for multiple monitors. (no feature) Windows Vista * Bug: At least on one PC with Windows Vista the ""Start"" button is not hidden, when the taskbar is hidden and if not in full screen layout mode. Windows XP - no bugs Windows 98 * Problem: The Internet Explorer cannot be embedded, therefor the help is not displayed in the appropriate window. Solution: Open the help files from the %A_AppData%\bugn directory in Internet Explorer or install an Internet Explorer version greater than 5.0; it was successfully tested with version 6.0. * Bug: The OSD is flickering or just visible for less then a second. * Bug (minor): The OSD has no transparent, but white background. * Problem: Hiding the titlebars does not work. No solution possible: Windows 95/98/Me: The SetWindowLong function may fail if the window specified by the hWnd parameter does not belong to the same process as the calling thread. (http://msdn.microsof...y/ms633591.aspx) * Problem: Automatically resizing and positioning the windows does not work, when opening or closing a window. No solution possible: Minimum operating systems: Windows 2000 (http://msdn.microsof.../ms644989(VS.85).aspx) * Problem: The hotkeys ""Win+m"", ""Win+f"", ""Win+F1"" and ""Win+F3"" do not work as expected, because the explorer Win keys cannot be overridden. Solution: Edit the options and set different keys for switching the layout mode. @krustyjonez: You might be interested in the hotkey ""Ctrl+Shift+Win+q"". If you find any title or classe in the list, which seems not to belong to any visible window, this could be the missing entry in one of the exception lists. Pease post any results. #13 - Posted 27 July 2008 - 08:06 PM Back to top krustyjonez_guest Guests Last active: Joined: -- Everything is working smooth as silk. Ctrl-Shft-Win-Q really helped. I identified that the Tablet Input Panel on Vista was taking up grid space #1. Once I eliminated that window class, everything is perfect. Thanks for such an awesome application! #14 - Posted 29 July 2008 - 05:44 AM Back to top joten Guests Last active: Joined: -- I created a small website for this project :arrow: http://freenet-homepage.de/bug.n/ Amongst others it provides an alternate download site for at least the latest version: bug.n - donwload The first download site at filedropper.com is 'instable' since the pages and files are deleted after some time of inactivity. #15 - Posted 31 July 2008 - 10:14 AM Back to top Page 1 of 3 1 2 3 Next Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"Tiling Window Manager. Forum thread:"	"true"
"Window Management"	"Min2Tray"	"http://junyx.breadfan.de/Min2Tray/"	"Minimize window to tray & more. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Min2Tray - Junyx Software Home Min2Tray Klipp3r! Min2Tray Current version is Min2Tray v1.7.9 (2011-10-11). Some virus scanners report that Min2Tray.exe contains a virus, keylogger or malware Some virus scanners for MS WindowsTM (namely AVG Free) report that the Min2Tray executable Min2Tray.exe contains some sort of virus, keylogger, malware or trojan horse. This is definitely not true. The executable is compressed by the UPX packer via AutoHotkey's compiler. This compression leads to the false positive virus report by these virus scanners. You may use the Min2Tray script Min2Tray.ahk provided within the archive you can download below. It provides exactly the same functionality as the executable. But you will of course also need the AutoHotkey interpreter installed to run the script! Also have a look at my forum post regarding this issue. What Min2Tray can do for you Min2Tray - a utility for MS WindowsTM NT and higher to minimize and hide a window to system tray area of taskbar as icon. Created by Junyx in June 2005. Contact me via the AutoHotkey forum hosting the Min2Tray thread. Does have even more nifty bits like: localization: English and German utilizes the third (middle) mouse button if present minimize a window by right clicking on its close button user may define hotkeys for almost everything BossKey: hide all visible windows (exceptions possible) with one keypress StartupMinimize: auto-hide certain windows upon startup of Min2Tray TriggerActions: do fancy stuff when windows are un-/hidden or opened like: position window maximize window (any direction supported) make window always-on-top send keystrokes to minimized window and controls run arbitrary programs or scripts manipulate master volume (mute/unmute/toggle) play a soundfile and more... StealthMode: Min2Tray does not show any tray icons show a hidden window automatically when its title changed (regular expressions supported) UserMenu: add custom menu entries to tray icon of minimized window: comes in handy to quickly launch specific actions of the underlying program i.e. open ""New Mail"" window of MS OutlookTM 2003 without the need to restore the minimized window first example registry file is included (for your inspiration) hotkeys to maximize a window only vertically or horizontally and even more stuff: always-on-top, no button mode, nice GUI Just give it a try. It won't hurt. But please make sure to read the Readme.txt and Changelog.txt included in the archive for latest information. Full source code is included (ahk, AutoHotkey scripting language). Get it now You can download Min2Tray as 7-zip archive and enjoy the show at once (no installation required). You will need the 7-Zip archiver to unpack the archive. By the way: this is a very good and open source packer! Alternatively you can download Min2Tray as zip archive or - if you trust me (d'oh!) - as self extracting archive (exe file). Min2Tray v1.7.9 Date 2011-10-11 Download min2tray_1.7.9_install.7z min2tray_1.7.9_install.zip min2tray_1.7.9_install.exe Changelog + new feature: use right mouse click on the close button of   the window's titlebar to minimize it. this is not totally   foolproof as we assume that the close button is always   in the upper rightmost corner of the window, but then, who   has a different setup on windows, anyways [thx franc] + added check for presence of 2-button mouse (Mac, anyone? :-) + from the path where <name.exe> is located use <name.ico>   (if existing) as tray icon of the minimized window [thx franc] * fixed bugs with middle mouse click behaviour on titlebar   and on desktop if no window is visible * replaced functions f_SubstEvilClass(), f_FindFile() and   subroutine h_ChangeIcon by much faster routines from   Forms Framework v0.8 by majkinetor (New BSD and GPLv2 licenses),   see: <http://code.google.com/p/mm-autohotkey/> [thx majkinetor] - removed option to add an application's window to ""evil class""   substitution list. superseded by new f_GetOwnerOrSelf()   function that replaces f_SubstEvilClass() . renamed Opt-Out/Opt-In modes to Blacklist/Whitelist modes . Min2Tray.exe compiled with AutoHotkey v1.0.48.05 Contact User reply is highly appreciated! The preferred way to get in contact with me is the AutoHotkey forum hosting the Min2Tray thread. You may have to wait some time for my reply - sorry for that. History of Min2Tray Have a look at all releases so far. On the edge If you wanna see your brain or computer (or both) crumble like a cookie have a look at the beta section. Dough Like this program? Please donate some bitcoins to: 12iiV6uJN14fFcyWWa9hsRVishshZA3RWm Get more information about bitcoins. Min2Tray (last edited 2016-02-25 by Junyx)"	"null"	"null"	"Minimize window to tray & more. Forum thread:"	"true"
"Window Management"	"link"	"https://autohotkey.com/board/topic/4173-min2tray-v179-minimize-window-to-tray-much-more/"	"Minimize window to tray & more. Forum thread:"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Min2Tray v1.7.9 - minimize window to tray & much more! - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. Min2Tray v1.7.9 - minimize window to tray & much more! Started by Junyx , Jul 11 2005 09:25 PM Page 1 of 15 1 2 3 Next » Please log in to reply 224 replies to this topic Junyx Members 124 posts Last active: Nov 01 2015 06:37 PM Joined: 11 Jul 2005 And another one! my contribution to the ahk community: Min2Tray (v1.7.9, 2011/10/11) minimize a window to system tray area of taskbar as icon. BossKey feature for minimizing several windows at once. make window always-on-top and maximize window vertically or horizontally. StartupMinimize can hide certain windows upon start of Min2Tray or assign actions. and much, much more! requires ms windows nt/2000/xp/vista/7 or newer - not tested under win 8, yet ;-) partial changelog for Min2Tray v1.7.9: + new feature: use right mouse click on the close button of the window's titlebar to minimize it. * replaced some functions by much faster routines from Forms Framework v0.8 by majkinetor. this speeded up systray icon creation and other things enormously! please use it, test the new features extensively, give reply and suggest new features or implement them yourself thx... Junyx #1 - Posted 11 July 2005 - 09:25 PM C.R.E.A.M. Back to top Chris Administrators 10727 posts Last active: Joined: 02 Mar 2004 I looked at the package you put together and it seems quite useful and well explained. Thanks for sharing your work. #2 - Posted 11 July 2005 - 09:57 PM Back to top skrommel Members 193 posts Last active: Jun 07 2010 08:30 AM Joined: 30 Jul 2004 :oops: Why didn't I think of that? One script is much better than my two script attempt in http://www.autohotke...hlight=skrommel. Nice, Junyx! Skrommel #3 - Posted 12 July 2005 - 11:25 PM Back to top Junyx Members 124 posts Last active: Nov 01 2015 06:37 PM Joined: 11 Jul 2005 well, nothing is perfect. the same for my script. :wink: currently i'm looking for a way to only allow one instance of the ""main"" program to be started and run. ""#singleinstance on"" doesn't work due to the 2-in-1 script (it has to be started several times as ""helper""). any ideas? Junyx #4 - Posted 13 July 2005 - 04:19 PM Back to top skrommel Members 193 posts Last active: Jun 07 2010 08:30 AM Joined: 30 Jul 2004 None. You need multiple instances to show multiple icons. Skrommel #5 - Posted 13 July 2005 - 06:39 PM Back to top TheLeO Members 264 posts Last active: Jan 02 2012 01:51 AM Joined: 11 Jun 2005 qiet nifty,,. thanx #6 - Posted 15 July 2005 - 01:24 PM :: I Have Spoken :: Back to top Junyx Members 124 posts Last active: Nov 01 2015 06:37 PM Joined: 11 Jul 2005 look at the topmost message! :roll: Junyx #7 - Posted 21 July 2005 - 06:29 PM Back to top twhyman Members 348 posts Last active: Sep 17 2014 01:55 AM Joined: 07 Dec 2005 file not found , cant download... #8 - Posted 08 December 2005 - 08:22 PM Back to top twhyman Members 348 posts Last active: Sep 17 2014 01:55 AM Joined: 07 Dec 2005 does someone has this file? #9 - Posted 10 December 2005 - 08:54 AM Back to top mE Guests Last active: Joined: -- Can't load it too... #10 - Posted 10 December 2005 - 12:48 PM Back to top Junyx Members 124 posts Last active: Nov 01 2015 06:37 PM Joined: 11 Jul 2005 does someone has this file? sorry for the inconvenience, folks :shock: have just updated the file location... Junyx #11 - Posted 11 December 2005 - 06:09 PM C.R.E.A.M. Back to top twhyman Members 348 posts Last active: Sep 17 2014 01:55 AM Joined: 07 Dec 2005 hi, thanks for posting the script back iam a total noob at AHK ,can u help me integrate the script so i can make my application minimize to tray? do i need the whole script for that? thanks Twhyman #12 - Posted 18 December 2005 - 02:56 PM Back to top Junyx Members 124 posts Last active: Nov 01 2015 06:37 PM Joined: 11 Jul 2005 iam a total noob at AHK ,can u help me integrate the script so i can make my application minimize to tray? do i need the whole script for that? well, in order to get a tray icon for the minimized windows you have to start a new instance of AHK - everytime. that's the catch. 1) you need to place my script somewhere (i.e. in the directory where your script is located). 2) include this in your script: Min2TrayGo:   WinWait, A,, 2			; set ""last used window""   If ( ErrorLevel )	; It timed out, so do nothing      Return    WinGet, h_WinStyle, Style      ; checks for minimizable window: (WS_CAPTION | WS_SYSMENU | WS_MINIMIZEBOX)   If ( h_WinStyle & 0xCA0000 = 0xCA0000 )   {   	WinGet, h_ID, ID  		Run, C:\AutoHotkey\AutoHotkey.exe C:\AutoHotkey\Min2Tray\Min2Tray.ahk %h_ID%, , UseErrorLevel   	If ( ErrorLevel = ""ERROR"" )	; helper could not be started   		Return   } Returnchange paths to my script and AHK.exe according to your needs! 3) to hide the window and create a tray icon just call in your prog: Gosub, Min2TrayGo that should do it for you. please do make your program public domain or GPLv2 and give some credit :-) Junyx #13 - Posted 21 December 2005 - 11:54 AM C.R.E.A.M. Back to top Junyx Members 124 posts Last active: Nov 01 2015 06:37 PM Joined: 11 Jul 2005 #14 - Posted 23 December 2005 - 11:07 AM C.R.E.A.M. Back to top ezuk Members 149 posts Last active: Jan 02 2013 08:54 AM Joined: 04 Jun 2005 For your info: Doesn't work for me when I put the script in a long path (with spaces in it) such as C:\My Documents\AHK\Scripts . #15 - Posted 25 December 2005 - 03:01 PM Back to top Page 1 of 15 1 2 3 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"Minimize window to tray & more. Forum thread:"	"true"
"Window Management"	"NiftyWindows"	"http://www.enovatic.org/products/niftywindows/introduction/"	"control of all basic window interactions such as dragging, resizing, maximizing, minimizing, closing, snap-to-grid, ""keep window aspect ratio"", rolling up a window to its title bar, transparency control."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Enovatic-Solutions (NiftyWindows) INTRODUCTION Welcome to NiftyWindows! This free tool provides many helpful features for an easier handling of your Windows (c) operating system. It does not need any complex installation nor does it read or save any information on your system other than the application dependent files itself. The release package includes only the main executable and some additional text files. Redistribution of NiftyWindows and linking to the website are welcome and strongly encouraged. In other words, feel free to share this tool with the public, provided that the enclosed license is met. Enovatic-Solutions is an IT Service Provider. We create custom solutions for professional users in all fields of Information Technology. If you have any demands or specific requirements, please feel free to let us know. The various features of NiftyWindows are based on innovative ideas reported to us by countless users. These ideas were adapted and implemented from the scratch to provide maximum usability and robustness. We really appreciate to receive as much user feedback on common usability or innovative ideas for new features/improvements as possible. Our motivation has been driven by user comments so do not hesitate to contact us. Special thanks go to Chris Mallett for implementing and sharing the free scripting language AutoHotkey that provides the framework behind NiftyWindows. Note: This software is free and will remain free forever. Unlike most other tools the tool itself is the target, and not just a method to reach another target (like money). NiftyWindows is not designed to be commercial software. We designed it to meet certain needs of our own and believe that others may find it useful as well. This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License (GPL) as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version."	"null"	"null"	"control of all basic window interactions such as dragging, resizing, maximizing, minimizing, closing, snap-to-grid, ""keep window aspect ratio"", rolling up a window to its title bar, transparency control."	"true"
"Window Management"	"SnapX"	"https://github.com/benallred/SnapX/releases"	"Enhances Windows/Aero Snap by taking over its hotkeys (Win+Left/Right, etc) and providing more fine-grained control over snap location and size. Works with multiple monitors, resolutions, and DPI levels."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"2"	"2"	"2"	"Releases · benallred/SnapX · GitHub Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 2 Star 2 Fork 2 benallred/SnapX Code Issues 1 Pull requests 0 Pulse Graphs Releases Tags Latest release 1.1.3 dd49116 SnapX v1.1.3 benallred released this Jan 14, 2016 · 2 commits to master since this release Improvements Allow horizontal movement to move to another monitor Win+Left/Right on maximized window performs Win+Shift+Left/Right Allow horizontal and vertical sizing from maximized state Resnap windows to new grid when grid size changed Downloads 529 KB SnapX_1.1.3_x32.zip 635 KB SnapX_1.1.3_x64.zip Source code (zip) Source code (tar.gz) 1.1.2 ca1a965 SnapX v1.1.2 benallred released this Jan 7, 2016 · 8 commits to master since this release Improvements Add Help GUI and display it on first run Buffer hotkeys for better responsiveness when pressed in quick succession When pressing Win+Alt+Up/Down (move vertically) from an unsnapped position set height to 1 Maintain snap position when moving across monitors (Win+Shift+Left/Right) Custom icon in tray when program is suspended Bug fixes Handle DPI scaling Fix width calculation of monitor on left side of primary monitor (when its right side is 0) Downloads 529 KB SnapX_1.1.2_x32.zip 635 KB SnapX_1.1.2_x64.zip Source code (zip) Source code (tar.gz) 1.1.1 576164d SnapX v1.1.1 benallred released this Dec 28, 2015 · 16 commits to master since this release Improvements Set various properties of final executable (version information, etc) Bug fixes Fix error on some older OSes due to missing icons Downloads 507 KB SnapX_1.1.1_x32.zip 613 KB SnapX_1.1.1_x64.zip Source code (zip) Source code (tar.gz) 1.1.0 0ce1e56 SnapX v1.1.0 benallred released this Dec 24, 2015 · 19 commits to master since this release New features Add hotkeys and support for vertical snaps Win+Alt+PgUp Sizes toward the top of the screen Win+Alt+PgDn Sizes toward the bottom of the screen Win+Alt+arrow key Moves snap in the specified direction (Win+Alt+Left/Right are overloaded with the original Win+Left/Right) Add Settings GUI Add 'run on startup' option Downloads 410 KB SnapX_1.1.0_x32.zip 516 KB SnapX_1.1.0_x64.zip Source code (zip) Source code (tar.gz) 1.0.1 fd771a5 SnapX v1.0.1 benallred released this Dec 21, 2015 · 32 commits to master since this release New features Add automatic update check on program start (can be disabled via ini file) and 'Check for update' tray menu item Improvements Maintain minimized/maximized status on exit but set restore position to pre-snap state Allow Win+Down to minimize non-resizable but minimizable windows and don't allow to minimize resizable but non-minimizable windows (both like original Win+Down) Bug fixes Fix case where quick Win+Down, Win+Up combo would not activate window Fix bug that caused some windows to maximize on program exit Fix snap position when taskbar on left or top Downloads 408 KB SnapX_1.0.1_x32.zip 514 KB SnapX_1.0.1_x64.zip Source code (zip) Source code (tar.gz) 1.0.0 fb2e63f SnapX v1.0.0 benallred released this Dec 17, 2015 · 43 commits to master since this release Initial release of SnapX, a replacement for Windows/Aero Snap. Usage Win+Left If not snapped, snap If snapped, move snap left Win+Right If not snapped, snap If snapped, move snap right Win+Up If not snapped, snap and increase snap width by 1 If snapped, increase snap width by 1 Win+Down If not snapped, minimize If snapped, decrease snap width by 1 If snapped and current width is 1, restore Settings Settings are configurable on first run and from an .ini file thereafter. Downloads 407 KB SnapX_1.0.0_x32.zip 513 KB SnapX_1.0.0_x64.zip Source code (zip) Source code (tar.gz) Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/benallred/SnapX/releases"	"Enhances Windows/Aero Snap by taking over its hotkeys (Win+Left/Right, etc) and providing more fine-grained control over snap location and size. Works with multiple monitors, resolutions, and DPI levels."	"true"
"Window Management"	"WindowPadX"	"https://github.com/hoppfrosch/WindowPadX"	"tool which provides some useful functionality within multi monitor environments."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"125"	"22"	"18"	"GitHub - hoppfrosch/WindowPadX: Enhancements on original WindowPad (by Lexikos) Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 22 Star 125 Fork 18 hoppfrosch/WindowPadX Code Issues 5 Pull requests 0 Pulse Graphs Enhancements on original WindowPad (by Lexikos) http://hoppfrosch.github.com/WindowPadX 44 commits 2 branches 8 releases Fetching contributors AutoHotkey 83.6% HTML 16.4% AutoHotkey HTML Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags gh-pages master Nothing to show v0.1.0 WindowPadX_v1.2.2 WindowPadX_v1.2.1 WindowPadX_v1.2.0 WindowPadX_v1.1.1 WindowPadX_v1.1.0 WindowPadX_v1.0.1 WindowPadX_v1.0.0 Nothing to show New pull request Latest commit 59c0699 May 26, 2015 hoppfrosch Merge pull request #13 from artemisart/master … Mouse handling when moving/resizing windows Permalink Failed to load latest commit information. _inc [*] Notify V 0.499 Jun 20, 2012 icons [*] Initial Jan 12, 2012 .gitignore fix #8, add *.exe to .gitignore Aug 6, 2014 Doc-Adding_Commands.txt [+] Kleinere Korrekturen Jun 20, 2012 Doc-Commandline_Usage.txt [+] Kleinere Korrekturen Jun 20, 2012 Readme.md [*] Link to gh-pages adapted May 3, 2012 WPXA.ahk wp_RecenterMouse : added support for MaximizeToggle May 24, 2015 WindowPadX.Default.ini added default options for wp_RecenterWindow May 24, 2015 WindowPadX.ahk fix May 24, 2015 WindowPadX.html [*] adapted to WindowPadX Jan 12, 2012 WindowPadX.ini add options to control the behaviour of wp_RecenterMouse May 24, 2015 Readme.md WindowPadX Detailed Documentation can be found here: http://hoppfrosch.github.com/WindowPadX/files/WindowPadX-ahk.html Introduction WindowPadX is an enhancement of WindowPad, originally released by Lexikos (see: http://http://www.autohotkey.com/forum/viewtopic.php?t=21703) WindowPadX is a tool which provides some useful functionality within multi monitor environments. Features Possible actions to be configured on hotkeys Window actions Multi-Monitor WPXA_MoveWindowToMonitor: Move window between screens, preserving relative position and size. WPXA_MinimizeWindowsOnMonitor: Minimize all windows on the given Screen WPXA_GatherWindowsOnMonitor: ""Gather"" windows on a specific screen. WPXA_FillVirtualScreen: Expand the window to fill the virtual screen (all monitors). General WPXA_MaximizeToggle: Maximize or restore the window. WPXA_TopToggle: Toogles ""AlwaysOnTop"" for given window WPXA_RollToggle: Toggles ""Roll/Unroll"" for given window WPXA_Move: move and resize window based on a ""pad"" concept. WPXA_TileLast2Windows: Tile active and last window Mouse actions Multi-Monitor WPXA_MoveMouseToMonitor: Moves mouse to center of given monitor WPXA_ClipCursorToCurrentMonitorToggle: Toogles clipping mouse to current monitor WPXA_ClipCursorToMonitor: Clips (Restricts) mouse to given monitor General WPXA_MouseLocator: Easy find the mouse For more details see http://hoppfrosch.github.com/WindowPadX/files/WindowPadX-ahk.html Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/hoppfrosch/WindowPadX"	"tool which provides some useful functionality within multi monitor environments."	"true"
"Window Management"	"link"	"https://autohotkey.com/board/topic/19990-windowpad-window-moving-tool/"	"tool which provides some useful functionality within multi monitor environments."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"WindowPad - window-moving tool - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. WindowPad - window-moving tool Started by Lexikos , Aug 02 2007 01:14 PM Page 1 of 26 1 2 3 Next » Please log in to reply 378 replies to this topic Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 WindowPad Uses a virtual ""pad"" to arrange windows. Original concept based on HiRes Screen Splitter by JOnGliko. Use the Numpad or your own custom layout to move and resize a window to fill the appropriate section of the screen. Features include: Move windows within the current monitor or between monitors (in multi-monitor setups). Customize hotkeys via WindowPad.ini with AutoHotkey-like command syntax. Define custom commands as labels or functions in WindowPad.ahk. Execute WindowPad commands specified on the command-line.Note: WindowPad hasn't been updated in over two years. hoppfrosch's WindowPadX is an enhancement of WindowPad, providing additional functionality useful for multi-monitor setups. WindowPad is public domain or closest equivalent; see CC0. Attached Files  WindowPad.zip   283.85KB   15182 downloads #1 - Posted 02 August 2007 - 01:14 PM Back to top bobbo Members 15 posts Last active: Oct 10 2010 01:08 AM Joined: 19 Mar 2007 Absolutely love this tool, it is fast and effective at what it does. Instantly earned a place in my startup script. One suggestion: please add using the NumpadDot key to move the window to the next monitor without resizing the window. It's often nice to just throw a window to another screen without resizing first. Otherwise, great job! #2 - Posted 09 August 2007 - 05:07 PM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 Updated to v1.1: [*:3bhlzhj3]Added ""Gather windows"" hotkeys (NumpadDiv and NumpadMult) [*:3bhlzhj3]Added Win+NumpadDot to move window to next monitor [*:3bhlzhj3]Added more EasyKey combos (for symmetry) [*:3bhlzhj3]Original functionality of EasyKey is now retained (on key-release) [*:3bhlzhj3]Added SetWinDelay, -1 to reduce lag when making multiple moves (quickly) #3 - Posted 10 August 2007 - 01:16 AM Back to top Charon the Hand Members 8 posts Last active: Feb 24 2010 02:16 AM Joined: 07 Aug 2007 This is a splendid tool, thank you very much. #4 - Posted 10 August 2007 - 07:46 PM Back to top lukemh Guests Last active: Joined: -- This is AWESOME! Keep up the great work. #5 - Posted 11 August 2007 - 04:27 AM Back to top bobbo Members 15 posts Last active: Oct 10 2010 01:08 AM Joined: 19 Mar 2007 Again, great work, and thanks for the quick inclusion of my suggestion! I made a couple of minor edits for myself: This allows the NumpadDot to work for maximized windows: MoveWindowToNextScreen:     gosub WP_SetLastFoundWindowByHotkey     WinGet, state, MinMax     if state 	{         WinRestore 		MoveWindowToNextScreen()         WinMaximize 	}     else 		MoveWindowToNextScreen() return Similarly, this allows the ""Gather Windows"" to work with maximized windows (I only the changed last line of the original function, but I'm posting the whole function for completeness): GatherWindows(md=1) {     ;SetWinDelay, -1 ; Makes a BIG difference to perceived performance.          ; List all visible windows.     WinGet, win, List          ; Copy bounds of all monitors to an array.     SysGet, mc, MonitorCount     Loop, %mc%         SysGet, mon%A_Index%, MonitorWorkArea, %A_Index%          ; Destination monitor     mdx := mon%md%Left     mdy := mon%md%Top     mdw := mon%md%Right - mdx     mdh := mon%md%Bottom - mdy          Loop, %win%     {         ; Set Last Found Window.         if (!WinExist(""ahk_id "" . win%A_Index%))             continue                  WinGetPos, x, y, w, h                  ; Determine which monitor this window is on.         xc := x+w/2, yc := y+h/2         ms := 1         Loop, %mc%             if (xc >= mon%A_Index%Left && xc <= mon%A_Index%Right                 && yc >= mon%A_Index%Top && yc <= mon%A_Index%Bottom)             {                 ms := A_Index                 break             }         ; If already on destination monitor, skip this window.         if (ms = md)             continue                  ; Source monitor         msx := mon%ms%Left         msy := mon%ms%Top         msw := mon%ms%Right - msx         msh := mon%ms%Bottom - msy                  ; If the window is resizable, scale it by the monitors' resolution difference.         if (IsResizable()) {             w *= (mdw/msw)             h *= (mdh/msh)         }                  ; Move window, using resolution difference to scale co-ordinates. 	    WinGet, state, MinMax 	    if state 		{ 	        WinRestore 			WinMove,,, mdx + (x-msx)*(mdw/msw), mdy + (y-msy)*(mdh/msh), w, h 	        WinMaximize 		} 	    else 			WinMove,,, mdx + (x-msx)*(mdw/msw), mdy + (y-msy)*(mdh/msh), w, h     } } And finally, I removed the ""SetWinDelay, -1"" because of its AHK Command Reference entry: Although a delay of -1 (no delay at all) is allowed, it is recommended that at least 0 be used, to increase confidence that the script will run correctly even when the CPU is under load. #6 - Posted 13 August 2007 - 05:42 PM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 This allows the NumpadDot to work for maximized windows:It already worked for maximized windows (for me?; it resizes based on screen size difference.) :? Restoring then maximizing again just adds a delay. The same applies to gather windows. [Edit] Heh, I just realised maximized windows go back to their original screen when you restore them. I guess using WinRestore before and WinMaximize after moving the window (like bobbo suggests) would fix this. For now, I'd rather omit it so the window moves ""instantly."" [/Edit] And finally, I removed the ""SetWinDelay, -1"" because of its AHK Command Reference entry:I ignored that because... This is done to improve the reliability of scripts because a window sometimes needs a period of ""rest"" after being created, activated, minimized, etc. so that it has a chance to update itself and respond to the next command that the script may attempt to send to it....if you're only sending one command to each window, there is no ""next command."" And it seemed to work reliably (and faster) with SetWinDelay,-1. Oh well, whatever works for you. #7 - Posted 13 August 2007 - 09:12 PM Back to top silkcom Guests Last active: Joined: -- First, let me tell you, awesome script. This is exactly what I've been looking for. I found a small problem though: When I use the 6 to move to the right side, then to the next monitors left side, etc, it works, but when I use the 4 to try and do the same thing the opposite way it doesn't work. My setup: I have my secondary monitor on the right side of my main monitor. I did switch the variables in the GatherWindowsLeft and RIght, but I'm not sure if there is another place that I'm suppose to change it? #8 - Posted 14 August 2007 - 05:03 PM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 GatherWindows uses absolute monitor index, so it should be the only part you'd need to change. So you can move to the secondary, which is on the right, but not back to the primary? It seems to work fine for me (after moving my secondary to the right of my primary.) What's the exact setup of your monitors? (Easiest answer is to run this script and copy-paste the mon* variables.) SysGet, m, MonitorCount Loop, %m%     SysGet, mon%A_Index%, Monitor, %A_Index% ListVars Pause #9 - Posted 15 August 2007 - 12:37 AM Back to top silkcom Guests Last active: Joined: -- Global Variables (alphabetical) -------------------------------------------------- 0[1 of 3]: 0 dir[0 of 0]: dir0[0 of 0]: dir1[0 of 0]: dir2[0 of 0]: Directions0[0 of 0]: Directions1[0 of 0]: EasyKey[0 of 0]: ErrorLevel[1 of 3]: 0 heightFactor[0 of 0]: m[1 of 3]: 2 mon1[0 of 0]: mon1Bottom[3 of 3]: 800 mon1Left[1 of 3]: 0 mon1Right[4 of 7]: 1280 mon1Top[1 of 3]: 0 mon2[0 of 0]: mon2Bottom[3 of 3]: 658 mon2Left[4 of 7]: 1280 mon2Right[4 of 7]: 2960 mon2Top[4 of 7]: -392 Prefix_Active[0 of 0]: Prefix_Other[0 of 0]: state[0 of 0]: widthFactor[0 of 0]: 2nd question: I'm interested in changing the hotkeys. I know that I would have to change them in the Loop at the beginning but I'm not exactly sure how DoMoveWindowInDirection works, so I'm not sure if that would need to be changed too. The problem is that I'm on a laptop, so the numpad is a bit annoying to work with . I'd prefer to be able to do the move with one hand (I want to do Alt+Win+a to move left, and Alt+Win+d to move right, etc). Thanks again. #10 - Posted 15 August 2007 - 02:38 PM Back to top silkcom Guests Last active: Joined: -- Ok, so I'm pretty sure that the problem is that my monitors are setup such that the tops don't line up (when I lined them up, in display properties, so that the tops were at the same level the script moved back and forth perfectly). Not sure how to fix it, but it's definately trying to get a monitor possition where the top is negative (which it is on my big monitor, but would return a bad number otherwise I would think). #11 - Posted 15 August 2007 - 02:42 PM Back to top silkcom Guests Last active: Joined: -- A quick fix that I put in is: In GetMonitorAt() as the first line I put: y := 100 Not a bad answer, but if u positioned ur monitors such that 100 is below or above one of the monitors, then it would break again. #12 - Posted 15 August 2007 - 02:49 PM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 I see the problem. It works by getting some point that is probably in the right monitor: x := (sideX>0 ? monBRight : monBLeft) + sideX y := (sideY>0 ? monBBottom : monBTop) + sideYThis needs to be fixed so that if sideX|Y = 0, the current window position on that axis is used. At the moment it would use the top/left of the monitor. Edit: done. (It now uses the center of the window when sideX|Y=0.) #13 - Posted 15 August 2007 - 09:05 PM Back to top kmccoy Members 1 posts Last active: Aug 17 2007 09:35 AM Joined: 17 Aug 2007 This is really great. One thing I noticed is that when I gather windows, it gathers things that really shouldn't move, like the Vista Sidebar and desktop. It'd be great to be able to rule those things out, but I can't find anything in common to these items so that I can conveniently make it ignore them... #14 - Posted 17 August 2007 - 09:39 AM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 My original need for gather windows was to move all windows to my secondary monitor when my primary isn't ""hooked up""* to my PC - so I didn't have much need for an exclusion list. (Also, I find the Vista sidebar next to useless. ) * for lack of a better term; it has dual inputs, so I use it with my Xbox360 occasionally. I can see how it might be useful to exclude some windows, so I've added two methods of exclusion:[*:2kgsycec]Exclude by title, class, etc. (GroupAdd, GatherExclude, ...) [*:2kgsycec]Exclude by process name (ProcessGatherExcludeList; comma-delimited.)By default it excludes the sidebar and its gadgets. Simply uncomment ProcessGatherExcludeList and add process.exe to the list to exclude entire applications. (e.g. ...List = sidebar.exe,firefox.exe) I'm interested in changing the hotkeys. I know that I would have to change them in the Loop at the beginning but I'm not exactly sure how DoMoveWindowInDirection works, so I'm not sure if that would need to be changed too.I forgot to reply to this. :oops: After using WindowPad for a while, I think I'd also like to change the keys. The main issue at the moment is the way DoMoveWindowInDirection maps keys (specifically, the numbers at the end of the key names) to directions - via the Directions array (which is initialized at the top of DoMoveWindowInDirection.) I realised when I wrote it that it wouldn't allow for proper customization, but I was in a hurry. :roll: When I get time, I'll rewrite it to allow keys to be customized; probably similar to: key_list = ( C #Numpad4=-1,0  ; left #Numpad5=0,0  ; middle #Numpad6=1,0  ; right ... !#Numpad1=2:-1,1  ; second window down-left #NumpadMult=all:2  ; gather at monitor 2 #NumpadDot=+1 ; next monitor )One possible complication (with the ""n:..."" convention) is determining the true order for always-on-top windows. For instance, on Vista, windows 1 and 2 are the start button orb and taskbar (which are always-on-top.) I think the most accurate way would be to track window activation, and maintain a list of the last %n% active windows... #15 - Posted 17 August 2007 - 01:11 PM Back to top Page 1 of 26 1 2 3 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"tool which provides some useful functionality within multi monitor environments."	"true"
"Window Management"	"WindowSaver"	"https://github.com/KroniK907/WindowSaver"	"Save and restore window layouts in Windows10 with support for virtual desktops and changing monitor setups."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"6"	"1"	"0"	"GitHub - KroniK907/WindowSaver: An AutoHotkey script that will save your window positions and then restore them to the saved position Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 1 Star 6 Fork 0 KroniK907/WindowSaver Code Issues 0 Pull requests 0 Pulse Graphs An AutoHotkey script that will save your window positions and then restore them to the saved position 16 commits 1 branch 1 release Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show WindowSaver-v0.1.1 Nothing to show New pull request Latest commit 74979f7 Dec 10, 2015 KroniK907 Update README.md Permalink Failed to load latest commit information. source Version 0.1 Release Dec 10, 2015 LICENCE.txt Create LICENCE.txt Dec 10, 2015 README.md Update README.md Dec 10, 2015 WindowSaver.exe Version 0.1 Release Dec 10, 2015 WindowSaver.exe.sig Version 0.1 Release Dec 10, 2015 sha1sum.txt Version 0.1 Release Dec 10, 2015 README.md WindowSaver An AutoHotkey Script v0.1 Created by Daniel Kranich Based on DockWin v0.3 by Paul Troiano PGP Key-ID: 9313709B Daniel Kranich (KroniK907) Description This is a script that can save the location and size of all of your windows and then restore those windows to their correct positions at a later time. Features Specifically designed to work with Windows10 Virtual Desktops Assigns a desktop to each window Restores to the appropriate desktop Works well with multiple monitors Can save multiple layouts depending on monitor setup If you switch between a single monitor and a dual screen setup, you can save a layout with each monitor setup Restores the correct layout depending on number of monitors connected Saves weather a window is maximized or minimized Call from any ahk script Uses I use this script when I need to do a windows update or need to restart my computer for any reason. I can simply save my layout before shutdown and then when I have rebooted, I can re open all the programs I had running and hit a hotkey and have it all back the way it was before. I also have a laptop which I may or may not have connected to a secondary monitor. I can save a layout, with and without my second monitor and every time I switch I can hit a hotkey and have all my windows arranged the way I like. Installation Simple Install Download WindowSaver.exe The exe must be run with one of the two following paramaters snap Takes a snapshot of your current layout and saves the details to WinPos.txt restore Figures out which saved layout it should restore Restores all windows to their appropriate places Example: ""C:\path\to\exe\WindowSaver.exe snap"" ""C:\path\to\exe\WindowSaver.exe restore"" Install With Source Downlad the source .ahk files. Use the same method as above but by calling your local AutoHotkey.exe Example: ""C:\path\to\AutoHotkey.exe C:\path\to\WindowSaver.ahk snap"" ""C:\path\to\AutoHotkey.exe C:\path\to\WindowSaver.ahk restore"" Set Up Hotkey You can set up a hotkey using the following key:: Run ""C:\path\to\WindowSaver.exe"" snap key:: Run ""C:\path\to\WindowSaver.exe"" restore  or key:: Run ""C:\path\to\AutoHotkey.exe"" ""C:\path\to\WindowSaver.ahk"" snap key:: Run ""C:\path\to\AutoHotkey.exe"" ""C:\path\to\WindowSaver.ahk"" restore  Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/KroniK907/WindowSaver"	"Save and restore window layouts in Windows10 with support for virtual desktops and changing monitor setups."	"true"
"Window Management"	"DockWin v0.3"	"https://autohotkey.com/board/topic/112113-dockwin-storerecall-window-positions/"	"Save and restore window layouts in Windows10 with support for virtual desktops and changing monitor setups."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"DockWin (Store/Recall window positions) - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. DockWin (Store/Recall window positions) Started by AutoPaul , Jul 05 2014 06:35 PM Page 1 of 3 1 2 3 Next Please log in to reply 31 replies to this topic AutoPaul Members 10 posts Last active: Feb 26 2015 09:36 PM Joined: 05 Jul 2014 I hate how Windows can't remember the position of all of your program windows. This is especially apparent when I undock my laptop and it goes from _dual_ 1920x1080 displays to its small, single display. When I redock I need to manually move the windows back to my preferred positions.   I really thought there would be a AHK script to record the current window locations and then be able to recall them when you want. I found some scripts (including one in French) but none really worked for me.   So I wrote the following script. Use Win-Shift-0 (zero above the P key, not on the numpad) to record the current window positions. The positions are stored in a file called WinPos.txt which is saved in the same folder as the script. You can then edit the window titles to be more generic (i.e., just ""Mozille Firefox"" instead of including the URL) and remove any you do not want saved.   To restore the window positions, use Win-0 (zero above the P key, not on the numpad).   The nice thing is the script creates a separate section that depends on the number of monitors, the primary monitor, and the total resolution. That means the script recognizes when the laptop is docked (and how you like your windows positioned) and also when it's undocked (and how you like your windows positioned).   This is my first real script and so I'm sure it's ripe for improvements. Please have at it and we will all benefit!  ;DockWin v0.3 - Save and Restore window positions when docking/undocking (using hotkeys) ; Paul Troiano, 6/2014 ; ; Hotkeys: ^ = Control; ! = Alt; + = Shift; # = Windows key; * = Wildcard; ;          & = Combo keys; Others include ~, $, UP (see ""Hotkeys"" in Help)  ;#InstallKeybdHook #SingleInstance, Force SetTitleMatchMode, 2		; 2: A window's title can contain WinTitle anywhere inside it to be a match.  SetTitleMatchMode, Fast		;Fast is default DetectHiddenWindows, off	;Off is default SetWorkingDir %A_ScriptDir%  ; Ensures a consistent starting directory. CrLf=`r`n FileName:=""WinPos.txt""    ;Win-0 (Restore window positions from file) #0::   WinGetActiveTitle, SavedActiveWindow   ParmVals:=""Title x y height width""   SectionToFind:= SectionHeader()   SectionFound:= 0     Loop, Read, %FileName%   {     if !SectionFound     {       ;Read through file until correction section found       If (A_LoopReadLine<>SectionToFind)  	Continue     }	    		;Exit if another section reached 		If ( SectionFound and SubStr(A_LoopReadLine,1,8)=""SECTION:"") 			Break                  SectionFound:=1 		Win_Title:="""", Win_x:=0, Win_y:=0, Win_width:=0, Win_height:=0  		Loop, Parse, A_LoopReadLine, CSV  		{ 			EqualPos:=InStr(A_LoopField,""="") 			Var:=SubStr(A_LoopField,1,EqualPos-1) 			Val:=SubStr(A_LoopField,EqualPos+1) 			IfInString, ParmVals, %Var% 			{ 				;Remove any surrounding double quotes ("") 				If (SubStr(Val,1,1)=Chr(34))  				{ 					StringMid, Val, Val, 2, StrLen(Val)-2 				} 				Win_%Var%:=Val   			} 		}  		If ( (StrLen(Win_Title) > 0) and WinExist(Win_Title) ) 		{	 			WinRestore 			WinActivate 			WinMove, A,,%Win_x%,%Win_y%,%Win_width%,%Win_height% 		}    }    if !SectionFound   {     msgbox,,Dock Windows, Section does not exist in %FileName% `nLooking for: %SectionToFind%`n`nTo save a new section, use Win-Shift-0 (zero key above letter P on keyboard)   }    ;Restore window that was active at beginning of script   WinActivate, %SavedActiveWindow% RETURN   ;Win-Shift-0 (Save current windows to file) #+0::   MsgBox, 4,Dock Windows,Save window positions?  IfMsgBox, NO, Return   WinGetActiveTitle, SavedActiveWindow   file := FileOpen(FileName, ""a"")  if !IsObject(file)  { 	MsgBox, Can't open ""%FileName%"" for writing. 	Return  }    line:= SectionHeader() . CrLf   file.Write(line)    ; Loop through all windows on the entire system   WinGet, id, list,,, Program Manager   Loop, %id%   {     this_id := id%A_Index%     WinActivate, ahk_id %this_id%     WinGetPos, x, y, Width, Height, A ;Wintitle     WinGetClass, this_class, ahk_id %this_id%     WinGetTitle, this_title, ahk_id %this_id%  	if ( (StrLen(this_title)>0) and (this_title<>""Start"") ) 	{ 		line=Title=""%this_title%""`,x=%x%`,y=%y%`,width=%width%`,height=%height%`r`n 		file.Write(line)    	}   }    file.write(CrLf)  ;Add blank line after section   file.Close()    ;Restore active window   WinActivate, %SavedActiveWindow% RETURN  ; -------  ;Create standardized section header for later retrieval SectionHeader() { 	SysGet, MonitorCount, MonitorCount 	SysGet, MonitorPrimary, MonitorPrimary 	line=SECTION: Monitors=%MonitorCount%,MonitorPrimary=%MonitorPrimary%          WinGetPos, x, y, Width, Height, Program Manager 	line:= line . ""; Desktop size:"" . x . "","" . y . "","" . width . "","" . height  	Return %line% }  ;<EOF>  Paul #1 - Posted 05 July 2014 - 06:35 PM Back to top pomj Members 30 posts Last active: Jun 10 2016 09:21 AM Joined: 22 Feb 2007 Perfect! Just what I have been looking for. On initial test seems to work perfectly. Will try it out tomorrow in a multimonitor environment. #2 - Posted 06 July 2014 - 06:17 AM Back to top AutoPaul Members 10 posts Last active: Feb 26 2015 09:36 PM Joined: 05 Jul 2014 To give folks a better idea of how this works, here is my WinPos.Txt file. It has three sections for which I commonly use: my laptop docked with dual screens, my laptop plugged into an external monitor (at home), and just the free-standing laptop. I just use Win-0 and the script recongnizes which setup it is operating under and resets the windows accordingly. Note that you can see how I generalized the window names so that they are not tied to specific documents. (You could actually do this if you wanted to.)  SECTION: Monitors=1,MonitorPrimary=1; Desktop size:0,0,1366,768 Title=""Calendar - Paul"",x=150,y=0,width=1055,height=728 Title=""Inbox - Paul"",x=150,y=0,width=1055,height=728 Title=""Mozilla Firefox"",x=76,y=0,width=1283,height=728 Title=""Microsoft Excel"",x=120,y=0,width=1246,height=728 Title=""Microsoft PowerPoint"",x=65,y=0,width=1295,height=728 Title=""Reminder"",x=623,y=235,width=473,height=336  SECTION: Monitors=2,MonitorPrimary=2; Desktop size:-1920,0,3840,1080 Title=""Calendar - Paul"",x=-1921,y=0,width=871,height=1080 Title=""Inbox - Paul"",x=-1056,y=0,width=1055,height=1080 Title=""Internet Explorer"",x=-1477,y=20,width=1265,height=995 Title=""Microsoft PowerPoint"",x=291,y=41,width=1506,height=945 Title=""Mozilla Firefox"",x=180,y=72,width=1359,height=937 Title=""Microsoft Excel"",x=398,y=17,width=1424,height=996 Title=""Reminder"",x=623,y=235,width=473,height=336  SECTION: Monitors=1,MonitorPrimary=1; Desktop size:0,0,1920,1080 Title=""Calendar - Paul"",x=205,y=0,width=871,height=1040 Title=""Inbox - Paul"",x=127,y=0,width=1055,height=1040 Title=""Windows Internet Explorer"",x=289,y=46,width=1332,height=955 Title=""Mozilla Firefox"",x=227,y=17,width=1329,height=968 Title=""Microsoft Excel"",x=399,y=0,width=1424,height=1040 Title=""Microsoft PowerPoint"",x=662,y=0,width=1256,height=1040 Title=""Reminder"",x=623,y=235,width=473,height=336   Again you don't need to create this file, the script will append a section every time you use Win-Shift-0.   #3 - Posted 07 July 2014 - 12:32 PM Back to top Run1e Moderators 173 posts ( ͡° ͜ʖ ͡°) Last active: Nov 06 2015 01:46 PM Joined: 18 Aug 2013 That file syntax looks pretty awesome. Nice work! #4 - Posted 07 July 2014 - 02:50 PM Take a look at my WIP website! - http://runie.me/ Check out my scripts! - Columbus - program launcher / focus switcher BF4 NoRecoil - Assault Back to top AutoPaul Members 10 posts Last active: Feb 26 2015 09:36 PM Joined: 05 Jul 2014 That file syntax looks pretty awesome. Nice work! Thanks! I'm finding this small tool to be a big time saver. #5 - Posted 07 July 2014 - 11:36 PM Back to top Skrell Members 384 posts Last active: Jul 07 2016 05:03 PM Joined: 23 Aug 2011 Any chance this script could be made more transparent by automatically recording the location and size of windows upon closing them and then restoring them when the windows are then respawned?  #6 - Posted 10 July 2014 - 07:50 PM Back to top tin0men Members 2 posts Last active: Feb 03 2016 06:20 PM Joined: 11 Jun 2014 Excellent piece of work!   I'm in a similar situation: laptop screen as monitor2 at work, and sole-display when working remotely; hibernating Win7 on trips between and fighting/dragging windows around to keep things in the right places to stay productive.   I was contemplating writing my own script (for the nth time), and actively looking again for some code in the niche, when I found your new post: Your script quickly snaps everything exactly where I want it!   Only observation I had, was that I had some issues running it when I tried to splice it into my master .ahk (fileopen issues, seemed unable to create/find the WinPost.txt file). But it works just fine run from it's own ahk. Probably a conflict with my use of SetTitleMatchMode RegEx   Thanks! #7 - Posted 11 July 2014 - 04:42 PM Back to top AutoPaul Members 10 posts Last active: Feb 26 2015 09:36 PM Joined: 05 Jul 2014 Any chance this script could be made more transparent by automatically recording the location and size of windows upon closing them and then restoring them when the windows are then respawned?  Possibly, but I don't think I could do it. The only way I know of how to even attempt something like this is to constantly scan the windows and look for one that ""disappears"" (i.e., is closed) or one that was just newly created (i.e., opened). I would think this would create a tremendous amout of overhead and slow the computer down substantially. So it would take some with much greater knowledge of the inner workings of windows (maybe there are events that fire when windows open/close). Hopefully someone more knowledgable than me will  contribute their ideas   At the end of the day, it sounds like the approach you want to managing windows is solving for a different problem than what my script does.   Excellent piece of work! ... Only observation I had, was that I had some issues running it when I tried to splice it into my master .ahk (fileopen issues, seemed unable to create/find the WinPost.txt file). But it works just fine run from it's own ahk. Probably a conflict with my use of SetTitleMatchMode RegEx   Thanks! I too use a master AHK file to keep my shortcuts but I have not tried pulling this code into it. If the problem is the RegEx setting, you could try modifiying the #0:: (restore window postions) section to change the TitleMatchMode to ""2"". (Actually I would save the value in A_TitleMatchMode to a variable, change the setting to 2, and then before the RETURN line restore the TitleMatchMode to the saved value. I would also make sure to move the setting of the ""global"" variables (CrLF,  FileName, SetWorkingDIr, etc.) to the top of your master script file. I believe they don't run if they are not at the top.   If I have a chance this weekend, I'll see if I can pull the DockWin scripts into my master script file. #8 - Posted 12 July 2014 - 12:03 PM Back to top AutoPaul Members 10 posts Last active: Feb 26 2015 09:36 PM Joined: 05 Jul 2014 Any chance this script could be made more transparent by automatically recording the location and size of windows upon closing them and then restoring them when the windows are then respawned?  Possibly, but I don't think I could do it. The only way I know of how to even attempt something like this is to constantly scan the windows and look for one that ""disappears"" (i.e., is closed) or one that was just newly created (i.e., opened). I would think this would create a tremendous amout of overhead and slow the computer down substantially. So it would take some with much greater knowledge of the inner workings of windows (maybe there are events that fire when windows open/close). Hopefully someone more knowledgable than me will  contribute their ideas   At the end of the day, it sounds like the approach you want to managing windows is solving for a different problem than what my script does.   Excellent piece of work! ... Only observation I had, was that I had some issues running it when I tried to splice it into my master .ahk (fileopen issues, seemed unable to create/find the WinPost.txt file). But it works just fine run from it's own ahk. Probably a conflict with my use of SetTitleMatchMode RegEx   Thanks! I too use a master AHK file to keep my shortcuts but I have not tried pulling this code into it. If the problem is the RegEx setting, you could try modifiying the #0:: (restore window postions) section to change the TitleMatchMode to ""2"". (Actually I would save the value in A_TitleMatchMode to a variable, change the setting to 2, and then before the RETURN line restore the TitleMatchMode to the saved value. I would also make sure to move the setting of the ""global"" variables (CrLF,  FileName, and the SetWorkingDIr) to the top of your master script file. I believe they don't run if they are not at the top.   If I have a chance this weekend, I'll see if I can pull the DockWin scripts into my master script file and post how it goes. #9 - Posted 12 July 2014 - 12:05 PM Back to top Skrell Members 384 posts Last active: Jul 07 2016 05:03 PM Joined: 23 Aug 2011 Possibly, but I don't think I could do it. The only way I know of how to even attempt something like this is to constantly scan the windows and look for one that ""disappears"" (i.e., is closed) or one that was just newly created (i.e., opened). I would think this would create a tremendous amout of overhead and slow the computer down substantially. So it would take some with much greater knowledge of the inner workings of windows (maybe there are events that fire when windows open/close). Hopefully someone more knowledgable than me will  contribute their ideas   At the end of the day, it sounds like the approach you want to managing windows is solving for a different problem than what my script does.     What about if you used the ONMESSAGE function of autohotkey?  I'm not expert, but i would think that every time a window is created or destroyed a message would be generated by windows that you could pick up and then execute your function with.  This shouldn't slow down a PC at all i would think.  What do you think ?  #10 - Posted 13 July 2014 - 03:45 PM Back to top AutoPaul Members 10 posts Last active: Feb 26 2015 09:36 PM Joined: 05 Jul 2014 What about if you used the ONMESSAGE function of autohotkey?  I'm not expert, but i would think that every time a window is created or destroyed a message would be generated by windows that you could pick up and then execute your function with.  This shouldn't slow down a PC at all i would think.  What do you think ?    I think you're right that ONMESSAGE could be leveraged to potentially do what you want. I really know nothing about the internal messaging system in Windows and what they all mean. It would take a fair amount of research and experimentation for me to figure it out.   I don't find pressing Win-0 to restore my window locations to be a big deal, and so I am still thinking you are trying to solve for different problem. Hopefully our conversation will plant a seed in someone with the right skills and needs similar to yours. #11 - Posted 27 July 2014 - 01:58 PM Back to top vertigoelectric Members 53 posts Last active: Apr 14 2016 03:48 PM Joined: 06 May 2009 This script is something I'm looking for but I'm having a very strange problem.  When I try to run it I get an error for a call to a nonexistent function:       Same error when script is compiled:       I'm using the latest version of AHK.   Why in the world would this be happening? #12 - Posted 21 August 2014 - 08:26 PM Back to top AutoPaul Members 10 posts Last active: Feb 26 2015 09:36 PM Joined: 05 Jul 2014 This script is something I'm looking for but I'm having a very strange problem.  When I try to run it I get an error for a call to a nonexistent function: ...   I'm using the latest version of AHK.   Why in the world would this be happening?   Actually I don't think you are using the latest version. I was having a similar problem when I was testing the script on my home PC. I'm running Version v1.1.14.03 (check your version # by looking at the initial Help screen).   You can download from http://ahkscript.org. My mistake was trying to download from autohotkey.com which seems to have an older version. I'm really not sure why there are two websites for ahk.   Good luck.   Paul   #13 - Posted 22 August 2014 - 05:43 PM Back to top HudsonMC Members 1 posts Last active: Nov 03 2014 09:19 PM Joined: 03 Nov 2014 I'm getting the following erros when I press win-shift-0 and clicking ""yes""   Can't open """" for writing.    I don't know why the filename isn't saving. Is there something that must be done to ""initialize"" the script?   EDIT: Never mind. I re-read some of these posts in here, and realized they were, in fact, talking about the same problem. Got it fixed by moving the dockwin script to the top of the ahk file.  #14 - Posted 03 November 2014 - 04:25 PM Back to top Winkyboy Members 2 posts Last active: Nov 04 2014 02:52 PM Joined: 21 Oct 2014 Argh.  Sadly, this does not remember all ""satellite"" windows of Visual Studio.... but thank you for this script - it's awesome nonetheless! #15 - Posted 04 November 2014 - 02:37 PM Back to top Page 1 of 3 1 2 3 Next Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"Save and restore window layouts in Windows10 with support for virtual desktops and changing monitor setups."	"true"
"Interpreter"	"AutoHotkey"	"https://autohotkey.com/download/"	"AutoHotkey interpreter installer and binaries."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"733"	"122"	"150"	"GitHub - Lexikos/AutoHotkey_L: AutoHotkey - macro-creation and automation-oriented scripting utility for Windows. Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 122 Star 733 Fork 150 Lexikos/AutoHotkey_L Code Issues 2 Pull requests 5 Pulse Graphs AutoHotkey - macro-creation and automation-oriented scripting utility for Windows. https://autohotkey.com/ 1,218 commits 3 branches 224 releases 6 contributors C++ 74.5% C 25.4% Other 0.1% C++ C Other Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags alpha edge master Nothing to show v2.0-a075 v2.0-a074 v2.0-a073 v2.0-a072 v2.0-a071 v2.0-a070 v2.0-a069 v2.0-a068 v2.0-a067 v2.0-a066 v2.0-a065 v2.0-a064 v2.0-a063 v2.0-a062 v2.0-a061 v2.0-a060 v2.0-a059 v2.0-a058 v2.0-a057 v2.0-a056 v2.0-a055 v2.0-a054 v2.0-a053 v2.0-a052 v2.0-a051 v2.0-a050 v2.0-a049 v2.0-a048 v2.0-a047 v2.0-a046 v2.0-a045 v2.0-a044 v2.0-a043 v2.0-a042 v2.0-a041 v2.0-a040 v2.0-a039 v2.0-a038 v2.0-a037 v2.0-a036 v2.0-a035 v2.0-a034 v2.0-a033 v2.0-a032 v2.0-a031 v2.0-a030 v2.0-a029 v2.0-a028 v2.0-a027 v2.0-a026 v2.0-a025 v2.0-a024 v2.0-a023 v2.0-a022 v2.0-a021 v2.0-a020 v2.0-a019 v2.0-a018 v2.0-a017 v2.0-a016 v2.0-a015 v2.0-a014 v2.0-a013 v2.0-a012 v2.0-a011 v2.0-a010 v2.0-a009 v2.0-a008 v2.0-a007 v2.0-a006 v2.0-a005 v2.0-a004 v2.0-a003 v2.0-a002 v2.0-a001 v1.1.24.00 v1.1.23.07 v1.1.23.06 v1.1.23.05 v1.1.23.04 v1.1.23.03 v1.1.23.02 v1.1.23.01 v1.1.23.00 v1.1.22.09 v1.1.22.08 v1.1.22.07 v1.1.22.06 v1.1.22.05 v1.1.22.04 v1.1.22.03 v1.1.22.02 v1.1.22.01 v1.1.22.00 v1.1.21.03 v1.1.21.02 v1.1.21.01 v1.1.21.00 v1.1.20.03 v1.1.20.02 Nothing to show New pull request Latest commit 810e7d4 May 22, 2016 Lexikos v1.1.24.00 Permalink Failed to load latest commit information. source v1.1.24.00 May 22, 2016 .gitattributes Added .gitattributes to avoid EOL problems when core.autocrlf = false. Sep 3, 2012 .gitignore Add more VC++ files to .gitignore Aug 30, 2011 AutoHotkeyx.sln v1.0.96.00 Mar 21, 2011 AutoHotkeyx.vcxproj Adjusted build settings to detect absence of Win2k support in toolset. Mar 14, 2016 AutoHotkeyx.vcxproj.filters Fixed manifest to disable UAC installer detection heuristics. Jan 4, 2015 Config.vcxproj Adjusted build settings to detect absence of Win2k support in toolset. Mar 14, 2016 README.md Updated README.md Sep 11, 2015 license.txt 1.0.48.05 Oct 19, 2009 README.md AutoHotkey_L AutoHotkey is a free, open source macro-creation and automation software utility that allows users to automate repetitive tasks. It is driven by a custom scripting language that is aimed specifically at providing keyboard shortcuts, otherwise known as hotkeys. AutoHotkey_L started as a fork of AutoHotkey but has been the main branch for some time. http://ahkscript.org/ How to Compile AutoHotkey is developed with Microsoft Visual Studio Community 2015 Express, which is a free download from Microsoft. Get the source code. Open AutoHotkeyx.sln in Visual Studio. Select the appropriate Build and Platform. Build. The project is configured to build with the Visual C++ 2010 toolset if available, primarily to facilitate Windows 2000 support but also because it appears to produce smaller 32-bit binaries than later versions. If the 2010 toolset is not available for a given platform, the project should automatically fall back to v140 (2015), v120 (2013) or v110 (2012). Note that the fallback toolsets do not support targetting Windows XP. For that, install VS 2010 or change the platform toolset to v110_xp, v120_xp or v140_xp (if installed). The project should also build in Visual C++ 2010, 2012 or 2013. Build Configurations AutoHotkeyx.vcxproj contains several combinations of build configurations. The main configurations are: Debug: AutoHotkey.exe in debug mode. Release: AutoHotkey.exe for general use. Self-contained: AutoHotkeySC.bin, used for compiled scripts. Secondary configurations are: (mbcs): ANSI (multi-byte character set). Configurations without this suffix are Unicode. (minimal): Alternative project settings for producing a smaller binary, possibly with lower performance and added dependencies. Platforms AutoHotkeyx.vcxproj includes the following Platforms: Win32: for Windows 32-bit. x64: for Windows x64. Visual C++ 2010 officially supports XP SP2 and later. AutoHotkey supports Windows XP pre-SP2 and Windows 2000 via an asm patch (win2kcompat.asm). Older versions are not supported. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/Lexikos/AutoHotkey_L"	"AutoHotkey interpreter installer and binaries."	"true"
"Interpreter"	"AutoHotkey DLL"	"https://github.com/HotKeyIt/ahkdll-v1-release/"	"AutoHotkey.dll opens the world of AutoHotkey to other programming and scripting languages. Forum thread:. Documentation."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"15"	"6"	"2"	"GitHub - HotKeyIt/ahkdll-v1-release: AutoHotkey_H v1 release Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 6 Star 15 Fork 2 HotKeyIt/ahkdll-v1-release Code Issues 1 Pull requests 0 Pulse Graphs AutoHotkey_H v1 release http://hotkeyit.github.io/v2/ 192 commits 1 branch 0 releases 1 contributor AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit 3e0636a Jul 10, 2016 HotKeyIt Added upx.exe Permalink Failed to load latest commit information. Compiler Added upx.exe Jul 10, 2016 Win32a Uninitialize COM after variables are freed Jun 24, 2016 Win32w Uninitialize COM after variables are freed Jun 24, 2016 lib Fixed a bug in ObjTree May 15, 2016 x64w Uninitialize COM after variables are freed Jun 24, 2016 AutoHotkey_H.chm Added GetEnv to resource library Nov 21, 2015 LICENSE WinApi added psapi.dll Jan 31, 2015 README.md WinApi added psapi.dll Jan 31, 2015 README.md ahkdll-v1-release ahkdll v1 release Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/HotKeyIt/ahkdll-v1-release/"	"AutoHotkey.dll opens the world of AutoHotkey to other programming and scripting languages. Forum thread:. Documentation."	"true"
"Interpreter"	"link"	"https://autohotkey.com/board/topic/39588-autohotkeydll/"	"AutoHotkey.dll opens the world of AutoHotkey to other programming and scripting languages. Forum thread:. Documentation."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"AutoHotkey.dll - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. AutoHotkey.dll Started by tinku99 , Apr 09 2009 07:28 PM Page 1 of 89 1 2 3 Next » Please log in to reply 1328 replies to this topic tinku99 Members 560 posts Last active: Feb 08 2015 12:54 AM Joined: 03 Aug 2007 AUTOHOTKEY.DLL, AUTOHOTKEY_H * AutoHotkey.dll is a a shared library that allows the AutoHotkey interpreter to be embedded into another application or language. It provides AutoHotkey functionality that might be more difficult to implement in another language. * AutoHotkey_H is HotkeyIt's custom build (most uptodate). * AutoHotkey_N is tinku99's custom build, outdated now (link for history). * Features: - All features of AutoHotkey_L + others below - dynamic #includes - wildcards in #include - subclass windows in host process - COM support - multi-threading with multiple embedded ahk interpreters - builtin lowlevel functions (equivalent to the machine code functions in lowlevel.ahk by Lexikos.) ( compatible lowlevel.ahk) * Maintainers: Naveen Garg, HotkeyIt * License: GPLv2 * No Warranty. Like all free software, use at your own risk wiki Download: AutoHotkey_H(recommended) ahk2exe.exe, Documentation ( Documentation AHK_H v2 ) source on github #1 - Posted 09 April 2009 - 07:28 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 This looks wonderful, but nothing happens if I hit the hotkeys. What should we do to try the dll? #2 - Posted 09 April 2009 - 08:34 PM Back to top n-l-i-d Guests Last active: Joined: -- Very cool indeed! 8) #3 - Posted 09 April 2009 - 08:39 PM Back to top tinku99 Members 560 posts Last active: Feb 08 2015 12:54 AM Joined: 03 Aug 2007 After F1 and F3, you should see 2 script icons. then try F5 and F6. look at the script variables, are they what you expect? anyways, I am uploading a more self testing version... try redownloading. just run ahkahk.ahk I will be posting more complete framework for IPC for lisp that should be usable with anything else including ahk itself. I know its ludicrous, but as a perversity this actually runs 1.0.48 code in the same process as 1.0.46 code. (untested) #4 - Posted 09 April 2009 - 09:33 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 It works! Thanks! I wonder, is it possible to use a pipe to feed the text of the second script to the dll, instead of reading it from a file? #5 - Posted 09 April 2009 - 10:07 PM Back to top tinku99 Members 560 posts Last active: Feb 08 2015 12:54 AM Joined: 03 Aug 2007 Unfortunately, ahk reads and rewinds the file, and pipes are not seekable as far as i know. Edit: However, lexikos had a partial solution here: http://www.autohotke...pt pipe dynamic see if it works unmodified. #6 - Posted 10 April 2009 - 02:04 AM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 Interesting. Laszlo, I think it should be relatively simple. Currently the loading process does two things that are not supported by pipes: [*:1y7g2dw0]It tries to call GetFileAttributes(), in order to determine if a valid filename was specified. This would not be applicable to a file/pipe handle anyway. [*:1y7g2dw0]It reads three bytes, then tries to seek if they do not equal the UTF-8 BOM. Currently it only does this to skip over the BOM and avoid interpreting it as part of the script. This could be left up to the caller. An ""encoding"" parameter could be reserved for future use, if it could become useful.(I see tinku99 posted while I continued this post; note that the point above is the only time AutoHotkey attempts to seek within the script file.) tinku99, the current source code seems to be based on revision 14 of AutoHotkey_L, which is based on an old pre-v1.0.48 beta. There have since been numerous improvements to both AutoHotkey and AutoHotkey_L. Are you planning to update soon? What is the reason ahkdll() creates a new thread? I think it might be the easiest way, given how involved AutoHotkey's current message loop is. However, it isn't a good idea to call ahkgetvar() from any thread other than the script's thread. If ahkdll() automatically starts a new thread, ahkgetvar() should automatically synchronise with it. The same goes for any other functions you make available. It appears ahkclose() only release the script's thread handle - it does not terminate the thread or have any other effect. Additionally, the !q hotkey in ahkahk.ahk calls FreeLibrary, but passes the empty variable fredll. It does not matter since the !q hotkey in ahkclinit.ahk overrides it. Freeing the DLL is not sufficient anyway, since it does not do any cleanup. For instance, all windows created by AutoHotkey.dll still exist, but the window procedure code is unloaded. As soon as a message is sent to a window, the program crashes. #7 - Posted 10 April 2009 - 06:14 AM Back to top tinku99 Members 560 posts Last active: Feb 08 2015 12:54 AM Joined: 03 Aug 2007 Laszlo and Lexikos: Thank you for trying out the autohotkey.dll I appreciate the feedback. the loading process does two things that are not supported by pipes:It seems to reparse some parts of the script depending on if and where you have #directives, autoexecute sections and functions. If you limit yourself to #directives, you can probably have just one round.  	if (fgets(aBuf, aMaxCharsToRead, fp) == NULL) // end-of-file or error  in script.cpp in function  size_t Script::GetLine(char *aBuf, int aMaxCharsToRead, int aInContinuationSection, FILE *fp)  Are you planning to update soon?I am working on my first release of ahklisp. But soon, I will try to merge with the latest changes... Have you considered using git? it isn't a good idea to call ahkgetvar() from any thread other than the script's thread. ahkgetvar() should automatically synchronise with itahkgetvar() isn't strictly necessary, because first contact is already made from the lisp side with ahkdll(file, callback). But I don't know how to synchronise threads... ahkclose() only release the script's thread handle - it does not terminate the thread or have any other effect.I know. I tried to do some cleanup, but everything i did also made the script crash. I was able to get another round of dll loads and unloads by using separate thread handles (its commented out in my code for now). Slash and burn is so much easier than cleanup... :evil: For now, lets just say, unloading the dll is not recommended without exiting. #8 - Posted 10 April 2009 - 08:12 AM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 It seems to reparse some parts of the script depending on if and where you have #directives, autoexecute sections and functions.I was certain it parses the script line by line. I see only one instance of rewind(); can you point out any specific cases where it seeks? (The code in your previous post only uses fgets, which reads up to the first newline and does not seek.) I have a few more observations and suggestions: ""Reloading"" the script merely re-executes the auto-execute section. This would rarely be sufficient, so perhaps it should simply do nothing? On the other hand, I suppose a script could be specifically designed to ""reload"" itself if the auto-execute section is executed a second time. Reload essentially acts as gosub auto-execute; the auto-execute section re-executes, and when it finishes, the thread which called Reload resumes. Also note that the DLL uses the command line arguments of the parent process (via __argv). For instance, if I launch the parent script with /ErrorStdOut, both scripts will output errors to stdout. If I launch the parent script with /Debug, both scripts will attempt to connect to the debugger (separately). This could be useful, but the command-line arguments passed to the parent process may not necessarily be meaningful. For instance, if the parent process accepts three arguments and none of them are recognised by AutoHotkey.dll as switches, the first is ignored and the others are assigned to variables. One solution would be to remove the loop which begins with: for (int i = 1; i < __argc; ++i) Perhaps it would be more appropriate to treat the second parameter of ahkdll() as the command line args? I think that the variable name sbclpointer is not very intuitive... Is there a reason you restrict it to integer values? sbclvar->Assign([color=red]atoi([/color]nameHinstanceP.sbclp[color=red])[/color]);If you removed atoi(), it would simply copy the string value as is. Have you considered using git?For AutoHotkey_L? I had not seen git before today. I was using Subversion, but stopped (at revision 15) for a few reasons, not least of which was that it seemed unreasonably slow. Since AutoHotkey_L was never intended to be a collaborative project, I don't see much benefit to using Subversion (or git, from what little I've seen). #9 - Posted 10 April 2009 - 10:04 AM Back to top tinku99 Members 560 posts Last active: Feb 08 2015 12:54 AM Joined: 03 Aug 2007 All good observations. I had glossed over the command line processing... the second parameter of ahkdll() as the command line args If you removed atoi(), it would simply copy the string value as is. That is reasonable. I can change the variable name to argv or something. I see only one instance of rewind(); I put a breakpoint and msgbox(aBuf) call right after that fgets() and saw every line in my script come up one by one. However, before the script launched. The autoexecute lines came up again one by one. It also depends on how the script is structured as far as where in the script the #directives are, on when the duplicate fgets() calls happen... I tried changing what was in aBuf after the fgets() call, but got memory access violations... I know there is only one rewind(), but there are other ways of going backward... I couldn't find them, but they must be happening, maybe in the precompiled code, or after some function name has been aliased... #10 - Posted 10 April 2009 - 11:08 PM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 I put a breakpoint and msgbox(aBuf) call right after that fgets() and saw every line in my script come up one by one. However, before the script launched. The autoexecute lines came up again one by one.Can you post a script with which I may reproduce this? After adding MsgBox(aBuf), I see each line exactly once. if (fgets(aBuf, aMaxCharsToRead, fp) == NULL) // end-of-file or error { 	*aBuf = '\0';  // Reset since on error, contents added by fgets() are indeterminate. 	return -1; } MsgBox(aBuf); I know there is only one rewind(), but there are other ways of going backward... I couldn't find them,After searching thoroughly through every use of fp (the file pointer variable), I am confident the only file I/O functions which are used on it are: fgets, rewind (for BOM only), feof and fclose. Anyway, I haven't had any problems with my script-piping function. If it did attempt to seek within the file, the pipe would break... Since the Release build in the project file is still set to output an EXE, I suppose you've only been using Debug builds? Release builds are much smaller and faster. Btw, I'd like you to remove the file AutoHotkey_L.txt... #11 - Posted 11 April 2009 - 12:40 AM Back to top tinku99 Members 560 posts Last active: Feb 08 2015 12:54 AM Joined: 03 Aug 2007 I have replaced the ""AutoHotkey_L.txt"" file with a README. I will put out a release build in my next version. I will also work on the cleanup issues on exiting the dllclient script. I think being able to reload different scripts arbitrarily or run multiple scripts would be nice. Maybe start with a different global var on the main script structure... I am confident the only file I/O functions which are used on it are: fgets, rewind (for BOM only), feof and fclose. Anyway, I haven't had any problems with my script-piping function.Ok, sorry, my mistake. You were right. I started clean and confirm your observations. I was even able to replace the line read by fgets in memory without problems. But your piping methods seems to work largely unmodified, and should be sufficient.  ; run script through pipe in autohotkey.dll ; based on run script through pipe by lexikos ;; http://www.autohotkey.com/forum/topic25867.html #NoEnv  start: ahkdll := DllCall(""LoadLibrary"", ""str"", ""AutoHotkey.dll"")  InputBox, Script, Script, Enter a line of script to execute.,,, 120,,,,, MsgBox :D  ; To prevent ""collision"", pipe_name could be something mostly ""unique"", like: ;   pipe_name := A_TickCount pipe_name := ""testpipe"" fullpipe_name := ""\\.\pipe\"" . pipe_name ; Before reading the file, AutoHotkey calls GetFileAttributes(). This causes ; the pipe to close, so we must create a second pipe for the actual file contents. ; Open them both before starting AutoHotkey, or the second attempt to open the ; ""file"" will be very likely to fail. The first created instance of the pipe ; seems to reliably be ""opened"" first. Otherwise, WriteFile would fail. pipe_ga := CreateNamedPipe(pipe_name, 2) pipe    := CreateNamedPipe(pipe_name, 2) if (pipe=-1 or pipe_ga=-1) {     MsgBox CreateNamedPipe failed.     ExitApp }   DllCall(""AutoHotkey\ahkdll"", ""str"", fullpipe_name, ""str"" , ""1234567"", ""Cdecl Int"") sleep, 1000   ; Run, %A_AhkPath% ""\\.\pipe\%pipe_name%"" ; Wait for AutoHotkey to connect to pipe_ga via GetFileAttributes(). DllCall(""ConnectNamedPipe"",""uint"",pipe_ga,""uint"",0) ; This pipe is not needed, so close it now. (The pipe instance will not be fully ; destroyed until AutoHotkey also closes its handle.) DllCall(""CloseHandle"",""uint"",pipe_ga) ; Wait for AutoHotkey to connect to open the ""file"". DllCall(""ConnectNamedPipe"",""uint"",pipe,""uint"",0)  ; AutoHotkey reads the first 3 bytes to check for the UTF-8 BOM ""ï»¿"". If it is ; NOT present, AutoHotkey then attempts to ""rewind"", thus breaking the pipe. Script := chr(239) chr(187) chr(191) Script if !DllCall(""WriteFile"",""uint"",pipe,""str"",Script,""uint"",StrLen(Script)+1,""uint*"",0,""uint"",0)     MsgBox WriteFile failed: %ErrorLevel%/%A_LastError% DllCall(""CloseHandle"",""uint"",pipe) CreateNamedPipe(Name, OpenMode=3, PipeMode=0, MaxInstances=255) {     return DllCall(""CreateNamedPipe"",""str"",""\\.\pipe\"" Name,""uint"",OpenMode         ,""uint"",PipeMode,""uint"",MaxInstances,""uint"",0,""uint"",0,""uint"",0,""uint"",0) } !q::ExitApp   #12 - Posted 11 April 2009 - 11:20 PM Back to top tinku99 Members 560 posts Last active: Feb 08 2015 12:54 AM Joined: 03 Aug 2007 Thanks to Lexikos for most of these suggestions Version 2: Merged with AutoHotkey_1.0.48_L26 building release version as well as debug version as it is smaller changed sbclPointer to argv. any string can now be passed as the second var to hkdll(name, argv) #13 - Posted 15 April 2009 - 02:40 AM Back to top tinku99 Members 560 posts Last active: Feb 08 2015 12:54 AM Joined: 03 Aug 2007 a single commandline option is simulated with the second argument to ahkdll(filename, option, parameter) now. /Debug is allowed and works with http://www.autohotke...ng_Features.htm #14 - Posted 18 April 2009 - 11:33 PM Back to top tinku99 Members 560 posts Last active: Feb 08 2015 12:54 AM Joined: 03 Aug 2007 new dll functions: linePointer := createLine(line) ; eg. ""click, 200, 200"" or ""StrLen(string)"" ; (no control flow yet) createFunction(prototype) ; eg. ""func(param1, param2)"" example scripts: <!-- m -->http://www.autohotke... ... onHost.ahk<!-- m --> <!-- m -->http://www.autohotke... ... nction.ahk<!-- m --> it may actually even be possible for the host and client scripts to share line structures. (untested) #15 - Posted 22 April 2009 - 05:18 AM Back to top Page 1 of 89 1 2 3 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"AutoHotkey.dll opens the world of AutoHotkey to other programming and scripting languages. Forum thread:. Documentation."	"true"
"Interpreter"	"link"	"http://hotkeyit.ahk4.net/files/AutoHotkey-txt.html"	"AutoHotkey.dll opens the world of AutoHotkey to other programming and scripting languages. Forum thread:. Documentation."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"AutoHotkey_H AutoHotkey_H Custom AutoHotkey Build. AutoHotkey_H was invented by tinku99 and enhanced by HotKeyIt.  It is a custom build of AutoHotkey_L (http://l.autohotkey.net/ by Lexikos) AutoHotkey.dll opens the world of AutoHotkey to other programming and scripting languages.  It allows multi-threading by loading a dll multiple times and using its exported functions as well as build-in features like Alias, CriticalObject and other.  You can use AutoHotkey in many other programming languages like C#, C++, VB, .Net, Python and many more by loading the dll or using COM Interface.  For example you can run AutoHotkey scripts from Excel or Word macro as if it was a build-in feature. Summary AutoHotkey_H Custom AutoHotkey Build. Features AHK_H includes all AHK_L features and some new features as well. How to install AutoHotkey_H needs to be installed manually. ANSI/UNICODE/32/64-bit Choose required version. Multi-threaded Dll Share process heap between threads. Software License: GNU General Public License. Download Available Downloads. Help Credits Features AHK_H includes all AHK_L features and some new features as well. Access Input variable while Input is running.  See Other Changes Create referenced variable / share variables to other threads using Alias. Create thread-safe objects using CriticalObject. Import and predefine Dll functions and use object syntax to call them using DynaCall. Sleep functionality in Send command (for example Send abc{100}def will send “abc”, sleep 100ms and then send “def”) Additional lib folder as lib.lnk and a lib folder in Resource.  Lib.lnk must link to a folder with ahk library files. Compile any dll and exe, keeping full functionality of AutoHotkey.  Use /E switch to execute different script than compiled one. MemoryLoadLibrary allows loading a dll from Memory, used for example in AhkDllThread(). Build-in Struct() and sizeof() functions. All relevant AutoHotkey.dll functions are also available in AutoHotkey.exe.  See Functions List. How to install AutoHotkey_H needs to be installed manually. Each folder includes AutoHotkey.exe + AutoHotkey.dll + AutoHotkeySC.bin + AutoHotkeyMini.dll If you have AutoHotkey installed and you want to replace it with AutoHotkey_H simply replace your AutoHotkey.exe with one from the package.(remember to backup) If you got latest AutoHotkey_L you can do the same for AutoHotkeySC.bin in Compiler folder. AutoHotkey.dll and AutoHotkeyMini.dll can be saved in script folder or in Windows\system32 if you want them to be available in any script. To register AutoHotkey COM Server, run regsvr32 Path of AutoHotkey.dll from command line or run window. ANSI/UNICODE/32/64-bit Choose required version. Which version you need depends on your system / OS and the script.  For backward compatibility for AutoHotkey-Basic Win32a should be used. AutoHotkey V1 package includes ANSI and UNICODE 32-bit versions as well as UNICODE 64-bit version. AutoHotkey V2 package includes only UNICODE 32 and 64-bit versions. Multi-threaded Dll Share process heap between threads. Each package also includes a Multi-threaded Dll version of every dll and exe (compiled with /MD flag) Multi-threaded Dll version allows sharing heap so a thread can create/delete memory in other thread. These versions require msvcrt100.dll to be in same folder where AutoHotkey.exe or AutoHotkey.dll is. Alternatively you can copy msvcr100.dll to Windows\system32 folder once and it will be available to any exe/dll. Software License: GNU General Public License.  See License.txt. Download Available Downloads. AutoHotkey Version 1.1 http://hotkeyit.ahk4.net/AutoHotkey.zip AutoHotkey Version 2.0 alpha http://hotkeyit.ahk4.net/AutoHotkey2Alpha.zip Help English Help http://hotkeyit.ahk4.net/AhkDll_Help_EN.zip 中文帮助 Chinese Help http://hotkeyit.ahk4.net/AhkDll_Help_CN.zip Credits tinku99 @ AutoHotkey http://www.autohotkey.com/forum/profile.php?mode=viewprofile&u=6056 HotKeyIt @ AutoHotkey http://www.autohotkey.com/forum/profile.php?mode=viewprofile&u=9238 Lexikos @ AutoHotkey http://www.autohotkey.com/forum/profile.php?mode=viewprofile&u=3754 amnesiac @ AutoHotkey http://www.autohotkey.com/forum/profile.php?mode=viewprofile&u=47646 About Compiled with http://www.naturaldocs.org/ Generated by Natural Docs AutoHotkey_H AutoHotkey.dll AutoHotkeyMini COM Interface Functions List Other Changes License CREATE THREAD ahkdll ahktextdll DETERMINE THREAD’S STATE ahkReady CONTROL THREAD ahkTerminate ahkReload ahkPause ADD NEW CODE addFile addScript EXECUTE SOME CODE ahkExec ahkExecuteLine ahkLabel ahkFunction ahkPostFunction WORK WITH VARIABLES ahkassign ahkgetvar WORKING WITH STRUCTURES Struct sizeof Build-in data types MULTI-THREADING Alias CriticalObject Lock / Unlock / TryLock DYNACALL DynaCall MEMORYMODULE MemoryLoadLibrary ResourceLoadLibrary MemoryGetProcAddress MemoryFreeLibrary LOW LEVEL FUNCTIONS GetVar ahkgetvar FindFunc ahkFindFunc FindLabel ahkFindLabel Alias Static CacheEnable GetTokenValue Everything Variable Index EverythingVariables Differences to AutoHotkey_L.exe and other changes. Build in function Alias is used to convert a variable into a pointer to another variable. Build in function to make an object multi-thread safe. Build in function, similar to DllCall but works with DllCall structures and Object syntax. Build in function to load a dll multiple times from Memory. List of exported functions GNU GENERAL PUBLIC LICENSE Version 2, June 1991 Close"	"null"	"null"	"AutoHotkey.dll opens the world of AutoHotkey to other programming and scripting languages. Forum thread:. Documentation."	"true"
"Interpreter"	"AutoHotkey build for CE"	"http://www.autohotkey.net/~Micha/AutohotkeyCE/AutoHotkeyCEUni.CAB"	"Autohotkey for Pocket PCs / WinCE / Smartphones. Forum thread:. Documentation."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Autohotkey for Pocket PCs / WinCE / Smartphones. Forum thread:. Documentation."	"false"
"Interpreter"	"link"	"https://autohotkey.com/board/topic/24776-autohotkey-for-pocket-pcs-wince-smartphones/"	"Autohotkey for Pocket PCs / WinCE / Smartphones. Forum thread:. Documentation."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Autohotkey for Pocket PCs / WinCE / Smartphones - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. Autohotkey for Pocket PCs / WinCE / Smartphones Started by Micha , Jan 01 2008 07:42 PM Page 1 of 32 1 2 3 Next » Please log in to reply 466 replies to this topic Micha Members 539 posts Last active: Dec 31 2011 01:43 PM Joined: 15 Nov 2005 Please have a look at http://www.autohotke.../html/index.htm Hi, My aim is to support a kind of batch files for CE devices (Filecopy, loop, expressions), window automation (Send, Winactivate) and most common gui commands. Some functions are not working, because there's no API-call for some functions on WindowsCE. Some functions are requiring system-dlls, which are not present on i.e. a PNA so I had to comment them out. Some functions are different between Win and WinCE so they have to be reimplemented. Such less important functions (i.e. sound) will not be implement, but the code can be changed by everybody else of course. ---------------------- NEW: If AHKCE is working on your device, please pm me and tell me the name of your device. I'll create a list of working devices. Thank you ---------------------- If you are starting the EXE it looks for a file AutohotkeyCE.ahk which is started automatically. The best thing to start is using the following script from sergeich. Please copy his code to a file named ""autohotkeyCE.ahk"" and run the exe. Now the extension ahk is ""bundled"" with the autohotkeyce.exe. You can now start your favorite script directly. RegWrite, REG_SZ, HKEY_CLASSES_ROOT, .ahk, , AutoHotkeyScript  RegWrite, REG_SZ, HKEY_CLASSES_ROOT, AutoHotkeyScript, , AutoHotkey Script  RegWrite, REG_SZ, HKEY_CLASSES_ROOT, AutoHotkeyScript\Shell\Open\Command, , ""%A_AhkPath%"" ""`%1""  RegWrite, REG_SZ, HKEY_CLASSES_ROOT, AutoHotkeyScript\DefaultIcon, , %A_AhkPath%`,`-160  Place the AutohotkeyCE.ahk file in the same folder as the EXE and ahkCE is starting the script The main problem is the memory (or stack) space. A lot of functions are not working because the stack is corrupt after a function call. These functions have to be rewritten or the allocation must be done with new/delete. The first attempt of a compiler. Please read that post: http://www.autohotke...p=260966#260966 Download You can find a list of working / not working commands here The changelog is here #1 - Posted 01 January 2008 - 07:42 PM Back to top Fry Members 885 posts Last active: Jan 17 2011 09:57 PM Joined: 01 Nov 2007 wow this is AwSoMe :shock: #2 - Posted 02 January 2008 - 10:51 PM Back to top Rhys Members 761 posts Last active: Aug 09 2013 04:53 PM Joined: 17 Apr 2007 Wow, I've been looking for a reason to pull my old Axim out of mothballs. This might be fun to play with. #3 - Posted 03 January 2008 - 12:03 AM [Join IRC!] Back to top halweg Members 127 posts Last active: Jul 06 2015 06:54 AM Joined: 27 Jan 2005 Micha, you should remark that MSGBOX works! The most import command for testing and trying. Btw., how can I start my own scripts? AutohotkeyCE.exe starts the autohotkey.ahk script only What about GUI-commands? Do we have a chance to get self made clickable bitmaps on the PPC screen? #4 - Posted 03 January 2008 - 09:35 AM Back to top Micha Members 539 posts Last active: Dec 31 2011 01:43 PM Joined: 15 Nov 2005 Micha, you should remark that MSGBOX works! Btw., how can I start my own scripts? AutohotkeyCE.exe starts the autohotkey.ahk script only What about GUI-commands? Do we have a chance to get self made clickable bitmaps on the PPC screen?Hi halweg, thank's, I've mentioned MsgBox now. I'm not sure how you can start a program with command line parameters. Perpaps you have to use ""start / run / \temp\autohotkeyCE.exe script2run.ahk ??? The debugger can start autohotkey with a parameter so it must work somehow. I own only a navigation system (the reason why I'm working on autohotkeyCE) and there autohotkeyce isn't working at all.... I just begun to work with CE devices, so I'm not an expert at all... Well I fear that gui-commands are much more difficult than all the other stuff. Just for basic functions (Msgbox, sin, cos...) I had to rewrite a lot of ahk-code. I'm not sure how much time I can spend for that... (je nachdem, wie lange ich Lust dazu habe...) Ciao Micha #5 - Posted 03 January 2008 - 11:48 AM Back to top halweg Members 127 posts Last active: Jul 06 2015 06:54 AM Joined: 27 Jan 2005 PPCs have a registry, there you can assign File types with registered programs. A way to do this (except a registry editor) are programs like resco explorer or sk tools. I'm using resco explorer, so I can do a ""open with..."" and select either editor (notes.exe) or compiler (autohotkeyce.exe) to open .ahk files. Micha, please keep on this interesting project. It's a twist of fate that you needed a navigating system. :wink: Have a look at <!-- w -->www.ppc-welt.de<!-- w -->, there you will find a lot of helping people with knowledge in all details about PPCs. I'm member of the PPC Club Saxony; if you're interested visit our next meeting (.net Workshop, Dresden, 17.01.2008). #6 - Posted 03 January 2008 - 12:18 PM Back to top Micha Members 539 posts Last active: Dec 31 2011 01:43 PM Joined: 15 Nov 2005 Hi, cool, easy guis are working: #7 - Posted 03 January 2008 - 07:59 PM Back to top Micha Members 539 posts Last active: Dec 31 2011 01:43 PM Joined: 15 Nov 2005 Hi, are there any volunteers who could test Gui-commands with (v6) of the autohotkeyCE? Ciao Micha #8 - Posted 04 January 2008 - 11:28 AM Back to top Fry(un logged in) Guests Last active: Joined: -- hey, in your last picture how did you have windows ce on windows xp? i see a pocket pc on your desktop #9 - Posted 05 January 2008 - 01:57 AM Back to top ahklerner Members 1386 posts Last active: Oct 08 2014 10:29 AM Joined: 26 Jun 2006 it is called an emulator. #10 - Posted 05 January 2008 - 04:20 AM ʞɔпɟ əɥʇ ʇɐɥʍ Back to top Micha Members 539 posts Last active: Dec 31 2011 01:43 PM Joined: 15 Nov 2005 Hi, yes it's an emulator. I have to work with just this emulator, because I only own a navigation system and AutohotkeyCE does not run on this device :-( #11 - Posted 05 January 2008 - 10:24 AM Back to top Fry Members 885 posts Last active: Jan 17 2011 09:57 PM Joined: 01 Nov 2007 can you show me where you got it? #12 - Posted 05 January 2008 - 03:15 PM Back to top ahklerner Members 1386 posts Last active: Oct 08 2014 10:29 AM Joined: 26 Jun 2006 can you show me where you got it?Read this post: <!-- m -->http://www.autohotke...opic.php?t=8711<!-- m --> #13 - Posted 05 January 2008 - 03:18 PM ʞɔпɟ əɥʇ ʇɐɥʍ Back to top Fry Members 885 posts Last active: Jan 17 2011 09:57 PM Joined: 01 Nov 2007 you should take off the (DEMO) because this has almost all functionality as regular autohotkey #14 - Posted 06 January 2008 - 12:02 AM Back to top halweg Members 127 posts Last active: Jul 06 2015 06:54 AM Joined: 27 Jan 2005 I tried out this example script: Gui, Add, Text,, First name: Gui, Add, Text,, Last name: Gui, Add, Edit, vFirstName ym  ; The ym option starts a new column of controls. Gui, Add, Edit, vLastName Gui, Add, Button, default, OK  ; The label ButtonOK (if it exists) will be run when the button is pressed. Gui, Show,, Simple Input Example return  ; End of auto-execute section. The script is idle until the user does something.  GuiClose: ButtonOK: Gui, Submit  ; Save the input from the user to each control's associated variable. MsgBox You entered ""%FirstName% %LastName%"". ExitAppMy PPC shows an oversized white dialog box with two small lines ""First name"" and """"Last name"". No input fields, no posibility to input anything. When I start AHK a second time one my device, it's not able to automaticly remove the first instanace of autohotkey.exe. #15 - Posted 06 January 2008 - 12:32 PM Back to top Page 1 of 32 1 2 3 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"Autohotkey for Pocket PCs / WinCE / Smartphones. Forum thread:. Documentation."	"true"
"Interpreter"	"link"	"http://www.autohotkey.net/~Micha/AutohotkeyCE/html/index.htm"	"Autohotkey for Pocket PCs / WinCE / Smartphones. Forum thread:. Documentation."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"AutoHotkeyCE - Free Mouse and Keyboard Macro Program with Hotkeys and AutoText for CE devices Autohotkey build for CE devices Hi, here you can find a port of autohotkey for windows CE devices. A lot of functions are working but there's a lot of work still undone. Some things aren't working because wince does not support them (drive, recyclebin functions, environment...and others). Some things must be rewritten because you need them on wince devices but they do not exist on win32 (tap and hold) The main aim is to port most commands of ahk. New wince features are at the end of the todo list. The source code is from Autohotkey 1.0.48.02 but this does not mean that everything is working yet. 03-04-10 Used Autohotkey_L (unicode) as source. How to start: To make things easier for you there is a wince setup. The AutohotkeyCE.exe (shrinked with upx so the exe is just 312 KB on the file system) is wrapped with a cab file.  Just transfer the file to your CE device and run the cab file. AutohokeyCE.exe is installed in the program folder: ""/program files/AutohotkeyCE/AutohotkeyCE.exe"". The installer automatically registers the ahk extension so you can start your script directly just like on win32 systems. To edit the script ""pword"" of the OS is used. Please have a look at the Working commands A yet small list of ""known"" working devices Downloads:Unicode-Build 1.0.48.760: AutohotkeyCEUni.cab Not maintained NON-unicode build: V36: AutohotkeyCE.cab Source: SVN Repository on Autohotkey.net Source unicode: SVN Repository on Autohotkey.net Compiler:  Changelog TODO list The following ahk commands are not supported by the OS. Drive: There are no drives on ce devices. The root starts with / and every file system is mounted there Winset (Transparent, Transcolor): The api for WINSET does not exist on ce devices. There is a chance to rewrite the code to achive the same.  The following system folders do not exist on ce devices: A_appdata / A_AppDataCommon / A_AppData / A_AppDataCommon / A_DesktopCommon / A_StartMenuCommon / A_ProgramsCommon / A_StartupCommon EnvSet: There are no environment variables on ce devices FileRecycle FileRecycleEmpty: No recycle bin found :-) A_TimeIdle/ A_TimeIdlePhysical RunAs: Are there users / groups on ce devices? I haven't found them on my PNA. Get / SetWorkingDir: The concept of the current folder does not exist  * a_iscompiled ComSpec A_Language  A_IPAddress1-4  DllCall RegisterCallback  FileInstall   Compiler: Edit 09-06-09 Now the compiler is working. You can compile your script directly on your device. Edit 23-05-09 fincs sent me source code  for the functions in the closed source dll. Now it's possible to compile a real ahk-compiler. In the download file is just a windows 32 exe. You can launch it, compile your script and transfer the resulting exe to the ce device. The compiled exe should run. You can compile windows 32 (ahk) text files or multibyte / unicode files (0xfffe) The compiler is included within the installer. The long version of the explaination.. ...some short information for developers Thanks: Chris for Autohotkey. Titan for this webspace (autohotkey.net). Fincs for the code needed to create a compiler. Barry for his help, bugfixes, funcions and infos Sergeich for his script to register the ahk extension and all others who helps on the forum to answer questions. If you have corrections, wishes or questions please leave me a pm. Micha Last change: 15-02-11"	"null"	"null"	"Autohotkey for Pocket PCs / WinCE / Smartphones. Forum thread:. Documentation."	"true"
"Interpreter"	"IronAHK"	"https://github.com/polyethene/IronAHK"	"Cross platform.NET rewrite -."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"264"	"39"	"44"	"GitHub - polyethene/IronAHK: Cross platform .NET rewrite of the popular AutoHotkey scripting language for desktop automation. Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 39 Star 264 Fork 44 polyethene/IronAHK Code Issues 21 Pull requests 1 Wiki Pulse Graphs Cross platform .NET rewrite of the popular AutoHotkey scripting language for desktop automation. http://www.ironahk.net/ 1,480 commits 1 branch 7 releases Fetching contributors C# 81.6% AutoHotkey 18.3% Other 0.1% C# AutoHotkey Other Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show v0.7 v0.5.7 v0.5.5 v0.5 v0.3 v0.1.1 v0.1 Nothing to show New pull request Latest commit a4ff409 Nov 20, 2011 polyethene Don't assume all short inline branch targets are the same opcode. Permalink Failed to load latest commit information. Deploy Fixed common compile warnings. May 3, 2011 IronAHK Use HTML5. Sep 4, 2011 Rusty Replace char arrays with string arrays. Nov 18, 2011 Scripting Don't assume all short inline branch targets are the same opcode. Nov 20, 2011 Tests Fixed common compile warnings. May 3, 2011 .gitattributes Fixed EOL. Nov 13, 2010 .gitignore Ignore VS upgrade files. Jul 12, 2010 IronAHK.sln Switched to WinForms only. May 12, 2010 Makefile Delete auto-generated documentation folders in 'make clean' target. Jun 27, 2010 license.txt Changed names on copyright notice. Feb 23, 2010 make.bat Delete auto-generated documentation folders in 'make clean' target. Jun 27, 2010 readme.txt Added readme file. Oct 19, 2010 readme.txt IronAHK is a rewrite of AutoHotkey, a powerful and easy to use scripting language for automation on the desktop It is developed in C# for .NET and Mono which brings cross-platform compatibility, increased performance, enhanced security, Unicode, native 64-bit support, smaller file sizes for compiled binaries and much more.  Follow development on:  	- GitHub http://github.com/polyethene/IronAHK 	- Twitter http://twitter.com/ironahk 	- Google Groups mailing list http://groups.google.com/group/ironahk 	- AutoHotkey.com forum topic http://www.autohotkey.com/forum/topic54494.html 	- Official site http://www.ironahk.net/  Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/polyethene/IronAHK"	"Cross platform.NET rewrite -."	"true"
"Debugging"	"[Class] Console"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=2116"	"This class is meant to simplify debugging for scripts from simple text handling, to outputting and logging data & arrays. GitHub."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"[Class] Console - Standardized Console GUI with Methods - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:31 All times are UTC-05:00 [Class] Console - Standardized Console GUI with Methods Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 45 posts 1 2 3 Next AfterLemon Posts: 83 Joined: 30 Sep 2013, 14:27 Location: Arizona, USA [Class] Console - Standardized Console GUI with Methods Report this post Quote 13 Feb 2014, 15:29 Class: Console - Standardized Console GUI with Methods by: tidbit, AfterLemon Version 1.8 | Tue March 11, 2014 [Downloads][Screenshot] Thank you for your interest! Good ol' tidbit and I worked on this with ease of use, seamless handling, and robust ability in mind. We hope you like it. As always, we're both here, and on the IRC channel (irc.freenode.net #ahk & #ahkscript) to help. Now on to the details: This class is meant to simplify debugging for scripts from simple text handling, to outputting and logging data & arrays. There's a lot here, so jump in and test it out using our demo scripts below, or write your own setup and tell us what you think we need to add! Thanks again! Without further adieu.... Description Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus Name:			[Class] Console Version:			1.8 (Tue March 11, 2014) Created:		Tue February 11, 2014 Authors:		AfterLemon tidbit GitHub:			https://github.com/AfterLemon/Class_Console AutoHotkey:	http://www.autohotkey.com/board/topic/101881-class-console-standardized-console-gui-with-methods/ AHKScript:		http://ahkscript.org/boards/viewtopic.php?f=6&t=2116&p=14026   Functions Available: Class_Console		to build the console object - use this in place of Console:=new console() Desc_Console		to view the description of the class Methods_Console	to view the documentation for the methods Documentation Spoiler Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus Class: 	Class_Console(Name,x,y,w,h [,Timestamp,HTML,Font,Fontsize]) 	This creates a new console object with the name of ""Name"".   All the below stuff will use the console defined above. You may use any name you like in your code.   Methods: 	aaa.append([text,delim,justify,pad,colsep]) 		Add text to the end of the console without a timestamp. 	aaa.catch([line,var,value]) 		Detect when a variable is a certain value or a certain line of code is executed. 	aaa.clear() 		Remove all the text on the console. 	aaa.close() 		Close the console but don't destroy it. Basically you Hide it. 	aaa.color([c]) 		Sets text color for following lines. Default is white. 		Specify ""list"" to see the color table. 	aaa.cmd(command [,breakOn,AppendConsole]) 		Run (and return) a command-prompt command and get the input line-by-line. 	aaa.cmdWait(command [,AppendConsole]) 		Run (and return) a command-prompt command and wait for it to fully finish. 	aaa.destroy() 		Destroy the console, it can not be shown until recreated. 	aaa.debug(debugType) 		Show AHK's debug info: KeyHistory, ListVars (Vars), ListLines (Lines), and ListHotkeys (Hotkeys). 	aaa.eval(In [,Append]) 		Evaluate expression with numbers,+ # - / and *. 	aaa.log([text,delim,justify,pad,colsep]) 		Same as append, but with a timestamp. 	aaa.prepend([text,delim,justify,pad,colsep]) 		Same as append, but adds the text to the TOP (line 1) of the console. 	aaa.pull() 		Get the current console text. 	aaa.save([FileName,Overwrite (flag)]) 		Save the console to a file. 	aaa.show(GuiName) 		Show a closed or recently created console. 	aaa.timeSinceLastCall([id,reset]) 		Get the amount of time (in MS) since the last time this function was called. 	aaa.update(debugType) 		This is similar to doing a CLEAR and then LOG(DEBUG()).   Color Table .-----------------. | Name   | Color  | | ----------------| | yellow | yellow | | orange | orange | | white  | white  | <- default | red    | red    | | blue   | cyan   | | lime   | lime   | | green  | green  | | gray   | gray   | | black  | black  | '-----------------'   ConsoleBar_Commands   [!ExitApp] Desc:    Exits entire script. Syntax:  ExitApp   [*Catch] Desc:    Detect when a variable is a certain value, OR       Detect when a line in ListLines exists. Syntax:  catch var varName Value command Syntax:  catch var line DebugLineNum Command Example: catch var d 4 prepend %d% Example: catch line 11 log line 11 was accessed!   [*Settimer] Desc:    Run a   [command] every N milliseconds (1000=1 second, 5000=5 seconds, etc). Syntax:  SetTimer N command Example: SetTimer 1000 var Banana   [?About] Desc:    Show information about this Console and its Creators. Syntax:  About   [Append] Desc:    Add text to the end of the console. You may use variables such as %varName%. Syntax:  Append Text Example: Append I'm at the end of the log! For now...   [Clear] Desc:    Clear all text in the console. Syntax:  Clear   [Close] Desc:    Close (or hide) the console. It can be re-shown. Syntax:  Close   [Cmd] Desc:    Run cmd.exe commands here. You can ping, run programs, whatever you want. Output will go to the console. This gets stuff line-by-line. Syntax:  cmd cmd.exe stuff Example: Cmd ipconfig   [CmdWait] Desc:    Run cmd.exe commands here. You can ping, run programs, whatever you want. Output will go to the console. This waits for the whole command to finish before printing to the console. Syntax:  CmdWait cmd.exe stuff Example: CmdWait ipconfig   [Color] Desc:    Apply a color   [N] to all below lines. Available colors: Yellow, Orange, White, Red, Blue, Lime, Green, Gray, Black. Or type 'color list' for a visual list of all the colors. Syntax:  Color N|List Example: color blue Example: color list   [Debug] Desc:    Get various AHK debugging info such as Last Lines. UNIT should be one of the following: Hotkeys, KeyHistory, Lines or Vars Syntax:  debug UNIT Example: Debug Vars   [Destroy] Desc:    Destroy the console. It can NOT be re-shown. Syntax:  Destroy Example: Destroy   [Log] Desc:    Add text to the end of the console with a formatted timestamp above the new text. You may use variables such as %varName%. Syntax:  Log Text Example: Log Some new data   [Operators] Desc:    Create and/or do math or do other unforsaken things to variables, such as append text. You do not need to use quotes around text. Available Operators: := .= += -= *= /= //= &= ^= |= Syntax:  var+=5 Example: SomeVar.=New text at the end.   [Prepend] Desc:    Adds text to the TOP of the console, not the bottom. You may use variables such as %varName%. Syntax:  Prepend Text Example: Prepend I'M ON TOP OF THE WOR... CONSOLE!   [Pull] Desc:    Pulls data from console window (line/lines specifies the line numbers) and saves it in a variable (or the clipboard). Syntax:  Pull   [lines|line First-Last|N] VarName|Clipboard Example: Pull banana OR       Pull lines 1-10 banana OR       Pull line 3 banana   [Run] Desc:    Runs a label within the script. Syntax:  Run Label Example: Run BananaLabel -> BananaLabel: ....   [Save] Desc:    Save the console text to the specified file. Syntax:  Save Filepath Example: Save C:\blah\log.txt   [Show] Desc:    Show a specified closed (not destroyed) console or reshow the current one. Syntax:  Show NAME Example: Show Variable   [TimeSinceLastCall] Desc:    ID and Reset are optional. Appends time in milliseconds since the last time this command was run. Syntax:  TimeSinceLastCall ID Reset Example: TimeSinceLastCall 1   [Update] Desc:    Uses last Debug UNIT, clearing the log and re-running the debug. Syntax:  Update Example: Debug vars --> SetTimer 3000 Update   [Var] Desc:    Print the value of a variable to the console. no %'s needed. -1 = Prepend, 1 = Log. Default is Append. Syntax:  Var VariableName (-1,0,1) Example: Var Banana   ---------------- <><><><><><><> <> example: <> <><><><><><><> ; create the console with a long time/date timestamp. ; it can now be called using ""a."" followed by the above method list. a.new console(""title"", 100, 100, 500, 300, 1) a.show() ; show the console we just made a.log(""Hello!"")            ; Print your message to it with a timestamp. a.append(""console class!"") ; Add another message but with no timestamp. sleep, 2000                ; Wait two seconds before we clear it. a.clear()                  ; Clear (empty the view) console. a.cmdWait(""ipconfig"")      ; Show the 'ipconfig' data in your console. sleep, 3000                ; Wait three second. a.destroy()                ; Permenantly destroy the ""a."" console. It'll need to be recreated for further use.   ... Please view the demo files for other examples.   Demos - removed - Please see the Download link at the top (Github has the demos). Attachments Last edited by AfterLemon on 14 Mar 2014, 14:54, edited 3 times in total. Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: Class: Console - Standardized Console GUI with Methods Report this post Quote 14 Feb 2014, 10:31 Great release I would also like to thank Lexikos as the PrintArray function is based on his ExploreObj() (but pretty much unnoticeable now). rawr. fear me. *poke* Is it December 21, 2012 yet? Top MasterFocus Posts: 145 Joined: 01 Oct 2013, 09:47 GitHub: MasterFocus Location: Rio de Janeiro - RJ - Brasil Contact: Contact MasterFocus Website Re: Class: Console - Standardized Console GUI with Methods Report this post Quote 14 Feb 2014, 22:29 Looks promising! I'll definitely keep an eye on this. Thanks guys! Antonio França - git.io | github.com | ahk4.net | sites.google.com Member of the AHK community since 08/Apr/2009. Moderator since mid-2012. Need help? Please post on the forum before sending me a PM. Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: Class: Console - Standardized Console GUI with Methods Report this post Quote 15 Feb 2014, 11:20 You're welcome small update 1.1 when using console.log(OBJECT or ARRAY), any keys with strings are now quoted. Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus {""deer"":1,33:[11,{""q"":1,""w"":2,""e"":3,1:4},2],""apple"":""car""} arr[33]     arr[33,1] = 11     arr[33,2]         arr[33,2,1] = 4         arr[33,2,""e""] = 3         arr[33,2,""q""] = 1         arr[33,2,""w""] = 2     arr[33,2,3] = 2 arr[""apple""] = car arr[""deer""] = 1   Edit: I see an issue with this. arr[33,2,3] = 2 should be arr[33,3] = 2 rawr. fear me. *poke* Is it December 21, 2012 yet? Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: Class: Console - Standardized Console GUI with Methods Report this post Quote 16 Feb 2014, 12:22 fixed the above bug Code: [Select all] [Download] GeSHi © Codebox Plus a:= new console(""a"",32,232,400,452,0) a.show() o:={""deer"":""animal"",33:[11,{""q"":1,""w"":2,""e"":3,1:4},2],""apple"":""car""} a.log(o) a.log() o:=[1,2,[11,22,[111,222,333,[1111,2222]],33],3,4] a.log(o) return   esc::exitApp I used this class to debug this class rawr. fear me. *poke* Is it December 21, 2012 yet? Top TLM Posts: 703 Joined: 01 Oct 2013, 07:52 Re: Class: Console - Standardized Console GUI with Methods Report this post Quote 22 Feb 2014, 14:48 excellent work guys! AfterLemon, just moving this 'feature request' item here (stdout > var), Its from tidbit's dropbox (verbatim): Spoiler Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus ; ------------------------------------------------------ ; ------------- RETRIEVE CONSOLE'S OUTPUTS ------------- ; ------------------------------------------------------ ;http://msdn.microsoft.com/en-us/library/cbxxzwb5%28v=VS.85%29.aspx ;http://technet.microsoft.com/en-us/library/ee156605.aspx objShell := ComObjCreate(""WScript.Shell"") objExec := objShell.Exec(""ipconfig.exe"") While !objExec.Status	;wait until ipconfig.exe starts     Sleep 100 strLine := objExec.StdOut.ReadAll()	;read the output at once msgbox % strLine     ; ping objExec := objShell.Exec(""cmd /c ping -n 3 -w 1000 www.google.com"") While !objExec.StdOut.AtEndOfStream ;read the output line by line 	if InStr(objExec.StdOut.ReadLine(), ""Reply"") { 		Msgbox Reply received. 		Break 	} The endless API function calls I had to make back in vanilla to return the consoles stdout buffer to a var, now reduced to a few lines, as I said to tidbit, its almost not fair, but amazing that it can be done this way. If you could add a method for this it would be greatly appreciated. Top AfterLemon Posts: 83 Joined: 30 Sep 2013, 14:27 Location: Arizona, USA Re: Class: Console - Standardized Console GUI with Methods Report this post Quote 22 Feb 2014, 18:15 Minor Update STDout to the console is now available. TWO new methods now support STDout: StdOutFull -- Wait until CMD stdout is finished and append it all to the console StdOutStream -- Stream the CMD stdout appended to the console An Example: Code: [Select all] [Download] (STDout Console Demo.ahk)GeSHi © Codebox Plus a:=new console(""a"",100,100,400,435) a.show() a.StdOutFull(""ipconfig.exe"") Sleep,3000 a.clear() Sleep,3000 a.StdOutFull() return This can also be done manually once the object has been created by either of the 2 methods above: Code: [Select all] [Download] (Manual Demo.ahk)GeSHi © Codebox Plus objExec:=a.objShell.Exec(""ipconfig.exe"") While !objExec.StdOut.AtEndOfStream 	a.append(objExec.StdOut.ReadLine()) Top TLM Posts: 703 Joined: 01 Oct 2013, 07:52 Re: Class: Console - Standardized Console GUI with Methods Report this post Quote 22 Feb 2014, 21:09 awesome tidbit and I ( mostly tidbit ) tried to figure out how to get the cmd to exec() without the window. He ended up using the `shell hook event` approach to hide it, it still flashes but seems to work ok. Still beats a million dllcalls() Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: Class: Console - Standardized Console GUI with Methods Report this post Quote 23 Feb 2014, 10:19 aww man. you guys released it before me! I was going to fix some bugs you made before releasing, afterlemon Mine also has a Break feature. I'll show it to you over irc before merging. I also added a new function and redid the docs/description page a little. rawr. fear me. *poke* Is it December 21, 2012 yet? Top hd0202 Posts: 60 Joined: 04 Oct 2013, 03:07 Location: Germany near Cologne Re: Class: Console - Standardized Console GUI with Methods Report this post Quote 24 Feb 2014, 01:27 I think here is a problem in class source lines 9 and 13: TimeFormat should be FormatTime Hubert Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: Class: Console - Standardized Console GUI with Methods Report this post Quote 24 Feb 2014, 10:20 hd0202: that is the bug i fixed mentioned above there were also 2 or 3 other bugs related to timestamps. I have fixed those. Just waiting for afterlemon to show his face on irc. If he doesn't today I'll just post my fixes and additions. edit: Update to 1.3 3 new functions: cmd() cmdWait() timeSinceLastCall() Bug fixes: timestamp issues issues with displaying arrays properly (st_printarr()) misc: generated console names (if the name was left blank) now uses A_Now instead of a random number. updated the docs a bit. rawr. fear me. *poke* Is it December 21, 2012 yet? Top ahk7 Posts: 72 Joined: 06 Nov 2013, 16:35 Re: Class: Console - Standardized Console GUI with Methods Report this post Quote 26 Feb 2014, 16:12 Nice class. But I prefer mine with a splash of color - I'm just messing around with it a bit by replacing the edit control with a listview, this makes it possible to use ""line numbers"" and color text for certain types of data using https://github.com/AHK-just-me/Class_LV_Colors You can see very early demo here https://github.com/hi5/Class_Console/tree/dev run Demo_LV1.ahk to see a green ""array"" Not sure of LVs are the way to go, a scintilla control might do it OR a simple html control which would allow tables, bullet lists, colors ... One thing I'd also like to see is a resizable window but haven't worked on that yet. Top AfterLemon Posts: 83 Joined: 30 Sep 2013, 14:27 Location: Arizona, USA Re: Class: Console - Standardized Console GUI with Methods Report this post Quote 26 Feb 2014, 16:36 I like the idea of having it handle in a way that looks a little bit nicer, but the sacrifices you're making are too much in my opinion. Take a look at the overall size of the project. Nearly 600 lines, and many of the methods must still be extended. As well things like Console.Pull() will fail and or cause unreliability due to their slow looping data dump. LOVE the idea, that's for sure. Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: [Class] Console - Standardized Console GUI with Methods Report this post Quote 01 Mar 2014, 14:43 Updated to 1.5! - Major release ----- A new Command Bar has been added! The TV parameter/effect has been removed. many updates and bug fixes. .Eval() (a simple, not a full featured eval) many command bar commands. other stuff. Woohoo! rawr. fear me. *poke* Is it December 21, 2012 yet? Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: [Class] Console - Standardized Console GUI with Methods Report this post Quote 06 Mar 2014, 18:05 1.7 now uses an html (mshtml) control line numbers colors themeable (html/css) catch color other stuff bug fixes more fixes enjoy! rawr. fear me. *poke* Is it December 21, 2012 yet? Top cyruz Posts: 241 Joined: 30 Sep 2013, 13:31 Re: [Class] Console - Standardized Console GUI with Methods Report this post Quote 06 Mar 2014, 18:40 Hi guys, thanks for the nice work. Just a request... This class, most probably, will be put in the Lib folder, so it would be nice to have description and documentation inside the class file itself. Of course anyone can do it by himself, so no real need... ABCza on the old forum. My GitHub. Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: [Class] Console - Standardized Console GUI with Methods Report this post Quote 06 Mar 2014, 19:38 I had that originally, but that adds another ~150 lines. Until AHK has support for classes in the lib (or does it already? maybe it has a different name structure?), I don't see it being useful. Currently I just copy/paste it at the bottom of my script. since you can't name the file Console.ahk and AHK recognizes it like it does functions. I guess there is always the use of #include, but that has issues. for some users (like me) simply doing ""#include console.ahk"" gives an error. I need an absolute path. I find it simpler to just copy/paste instead of fetch the full path every time. rawr. fear me. *poke* Is it December 21, 2012 yet? Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: [Class] Console - Standardized Console GUI with Methods Report this post Quote 06 Mar 2014, 20:23 very interesting Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top cyruz Posts: 241 Joined: 30 Sep 2013, 13:31 Re: [Class] Console - Standardized Console GUI with Methods Report this post Quote 07 Mar 2014, 10:08 tidbit wrote:I had that originally, but that adds another ~150 lines. Until AHK has support for classes in the lib (or does it already? maybe it has a different name structure?), I don't see it being useful. Currently I just copy/paste it at the bottom of my script. since you can't name the file Console.ahk and AHK recognizes it like it does functions. I guess there is always the use of #include, but that has issues. for some users (like me) simply doing ""#include console.ahk"" gives an error. I need an absolute path. I find it simpler to just copy/paste instead of fetch the full path every time. I'm using the ""#Include <Console>"" approach, I find it very convenient. Now that joedf is here and because I didn't dig deeper in the code, may I ask one of you what are the main differences between Console and LibCon? ABCza on the old forum. My GitHub. Top AfterLemon Posts: 83 Joined: 30 Sep 2013, 14:27 Location: Arizona, USA Re: [Class] Console - Standardized Console GUI with Methods Report this post Quote 07 Mar 2014, 10:36 (Not much experience with LibCon, it fails to start due to VarSetCapacity not implemented) From a not-so-extensive look-over of LibCon, I see that while it has many of the features you would expect a console to have, it is not necessarily built for debugging. Class_Console is built with the debugging of issues in mind. .Catch() allows you to monitor execution automatically (this feature is something I've wanted since starting AHK 5 years ago), .Debug() allows you to view the script logs, and to the extent possible, everything is self-contained, as small and efficient as possible, and dedicated to finding and fixing the problems in your other scripts. I'd like to see this as an #Include simply for the efficiency of fixing any script any time. We'll see what we can do. HOME: Windows 7 x64 SP1 Ultimate | AMD FX 8350 8-Core @ 4.00GHZ | 16GB Ram WORK: Windows 7 x64 SP1 Home Premium | AMD Athlon II X4 640 @ 3.00GHz | 8GB Ram MOBILE: Samsung Galaxy Note 3 | 2012 Asus Nexus 7 | Zune 80Gb Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 45 posts 1 2 3 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 12 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"This class is meant to simplify debugging for scripts from simple text handling, to outputting and logging data & arrays. GitHub."	"true"
"Debugging"	"link"	"https://github.com/AfterLemon/Class_Console"	"This class is meant to simplify debugging for scripts from simple text handling, to outputting and logging data & arrays. GitHub."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"7"	"3"	"3"	"GitHub - AfterLemon/Class_Console: Class: Console - Standardized Console GUI with Methods Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 3 Star 7 Fork 3 AfterLemon/Class_Console Code Issues 0 Pull requests 0 Pulse Graphs Class: Console - Standardized Console GUI with Methods 50 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Fetching latest commit… Cannot retrieve the latest commit at this time. Permalink Failed to load latest commit information. Class_Console Description Class_Console Documentation Class_Console.ahk Demo_1.ahk Demo_2.ahk Demo_3_STDout.ahk LICENSE README.md README.md Class_Console Thank you for your interest! Good ol' tidbit and I worked on this with ease of use, seamless handling, and robust ability in mind. We hope you like it. As always, we're both here, and on the IRC channel (irc.freenode.net #ahk & #ahkscript) to help. Now on to the details: This class is meant to simplify debugging for scripts from simple text handling, to outputting and logging data & arrays. There's a lot here, so jump in and test it out using our demo scripts below, or write your own setup and tell us what you think we need to add! Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/AfterLemon/Class_Console"	"This class is meant to simplify debugging for scripts from simple text handling, to outputting and logging data & arrays. GitHub."	"true"
"Debugging"	"Print Array"	"https://autohotkey.com/board/topic/70490-print-array/"	"Function that prints array content in GUI."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Print Array - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. Print Array Started by Guest , Aug 21 2011 11:12 AM Please log in to reply 8 replies to this topic Guests Last active: Joined: -- Array2 := Object(""test"", ""123"")  Array := [{Name:""d"", Location:""D:\tmp"", Access:40, Date:20110821} 	, {Name:""c"", Location:""D:\tmp\b"", Access:999, Date:20110819} 	, {Name:""e"", Location:""D:\somethingelse"", Access:3, Date:20100115} 	, {Name:""a"", Location:""E:\apps\data"", Access:8, Date:20110730} 	, {Name:""b"", Location:""C:\Windows\"", Access:21, Date:20091230} 	, {Name:""f"", ModifiedDate:20100910, Data:Array2}] 	 PrintArr(Array)  	 PrintArr(Arr, GuiNum=90, Option=""x2 y0 w400 h500"") { 	For index, obj in Arr { 		if ( A_Index = 1 ) { 			For key, value in obj { 				Columns .= key ""|""	 				numColumn++ 			}	 			Gui, %GuiNum%: Add, ListView, %Option%, %Columns% 		} 		RowNum := A_Index		 		Gui, %GuiNum%: default						;this is necessary 		LV_Add("""")									;add a row 		For key, value in obj { 			LV_GetText(Header, 0, A_Index)			;check if the inserting value is in the correct column 			if (key <> Header) {	 				FoundHeader := False 				Loop % LV_GetCount(""Column"") {		;search the matching column 					LV_GetText(Header, 0, A_Index) 					if (key <> Header) 						continue 					else { 						FoundHeader := A_Index 						Break 					} 				} 				if !FoundHeader { 					LV_InsertCol(numColumn + 1, """", key) 					numColumn++ 					ColNum := ""Col"" numColumn 				} else 					ColNum := ""Col"" FoundHeader 			} else 				ColNum := ""Col"" A_Index 			LV_Modify(RowNum, ColNum, (IsObject(value) ? ""Object()"" : value)) 	;insert the value 		} 	} 	Loop % LV_GetCount(""Column"") 		;the number of colums 		LV_ModifyCol(A_Index, ""AutoHdr"")		;adjust each column width 		 	Gui, %GuiNum%: Show,, Array }Feel free to modify it. Maybe object() can be displayed in a different color and if the user clicks on it, it creates another GUI or updates the current one to show the contents of the clicked object. I don't have enough time to develop it, so just throwing this idea to the community. #1 - Posted 21 August 2011 - 11:12 AM Back to top trueski Members 121 posts Last active: Jun 25 2014 09:12 PM Joined: 08 Apr 2008 I made a similar function that I think works a little cleaner. It will display up to ten levels deep. I could get it to allow more levels, but I don't have the need to right now, and it can get kind of confusing when trying to add more. Thanks to Polythene for the anchor function. Syntax: PrintArray(Array, [DisplayOutput? = 0|1]) Array := Object() Array[1] := ""Test 1"" Array[2] := ""Test 2"" Array[3] := Object() Array[3][1] := ""Test 3-1"" Array[3][2] := Object() Array[3][2][1] := ""Test 3-2-1"" Array[3][2][2] := ""Test 3-2-2"" Array[3][3] := ""Test 3-3"" Array[4] := ""Test 4""  PrintArray(Array, 1) ExitApp  PrintArray(Array, Display=0) { 	Global PrintArray 	 	If (!IsObject(Array)) 	Return """" 	 	Text := ""Array"" . ""`r`n"" . ""("" 	For Key1, Value1 in Array 	{ 		If !(IsObject(Value1)) 		     Text .= ""`r`n`t["" . Key1 . ""] => "" . Value1 		Else Text .= ""`r`n`t["" . Key1 . ""] => "" . ""Array"" 		 		If (IsObject(Value1)) 		{ 			Text .= ""`r`n`t"" . ""("" 			 			For Key2, Value2 in Value1 			{ 				If !(IsObject(Value2)) 		         Text .= ""`r`n`t`t["" . Key2 . ""] => "" . Value2 		    Else Text .= ""`r`n`t`t["" . Key2 . ""] => "" . ""Array"" 		 				If (IsObject(Value2)) 		    { 					Text .= ""`r`n`t`t"" . ""("" 					 					For Key3, Value3 in Value2 			    { 						If !(IsObject(Value3)) 		             Text .= ""`r`n`t`t`t["" . Key3 . ""] => "" . Value3 		        Else Text .= ""`r`n`t`t`t["" . Key3 . ""] => "" . ""Array"" 				 						If (IsObject(Value3)) 		        { 							Text .= ""`r`n`t`t`t"" . ""("" 							 							For Key4, Value4 in Value3 			        { 								If !(IsObject(Value4)) 		                 Text .= ""`r`n`t`t`t`t["" . Key4 . ""] => "" . Value4 		            Else Text .= ""`r`n`t`t`t`t["" . Key4 . ""] => "" . ""Array"" 								 								If (IsObject(Value4)) 		            { 									Text .= ""`r`n`t`t`t`t"" . ""("" 									 									For Key5, Value5 in Value4 			            { 										If !(IsObject(Value5)) 		                     Text .= ""`r`n`t`t`t`t`t["" . Key5 . ""] => "" . Value5 		                Else Text .= ""`r`n`t`t`t`t`t["" . Key5 . ""] => "" . ""Array"" 								 										If (IsObject(Value5)) 		                { 											Text .= ""`r`n`t`t`t`t`t"" . ""("" 											 											For Key6, Value6 in Value5 			                { 												If !(IsObject(Value6)) 		                         Text .= ""`r`n`t`t`t`t`t`t["" . Key6 . ""] => "" . Value6 		                    Else Text .= ""`r`n`t`t`t`t`t`t["" . Key6 . ""] => "" . ""Array"" 										 												If (IsObject(Value6)) 		                    { 													Text .= ""`r`n`t`t`t`t`t`t"" . ""("" 													 													For Key7, Value7 in Value6 			                    { 														If !(IsObject(Value7)) 		                             Text .= ""`r`n`t`t`t`t`t`t`t["" . Key7 . ""] => "" . Value7 		                        Else Text .= ""`r`n`t`t`t`t`t`t`t["" . Key7 . ""] => "" . ""Array"" 														 														If (IsObject(Value7)) 		                        { 															Text .= ""`r`n`t`t`t`t`t`t`t"" . ""("" 															 															For Key8, Value8 in Value7 			                        { 																If !(IsObject(Value8)) 		                                 Text .= ""`r`n`t`t`t`t`t`t`t`t["" . Key8 . ""] => "" . Value8 		                            Else Text .= ""`r`n`t`t`t`t`t`t`t`t["" . Key8 . ""] => "" . ""Array"" 																 																If (IsObject(Value8)) 		                            { 																	Text .= ""`r`n`t`t`t`t`t`t`t`t"" . ""("" 																	 																	For Key9, Value9 in Value8 			                            { 																		If !(IsObject(Value9)) 		                                     Text .= ""`r`n`t`t`t`t`t`t`t`t`t["" . Key9 . ""] => "" . Value9 		                                Else Text .= ""`r`n`t`t`t`t`t`t`t`t`t["" . Key9 . ""] => "" . ""Array"" 																		 																		If (IsObject(Value9)) 		                                { 																			Text .= ""`r`n`t`t`t`t`t`t`t`t`t"" . ""("" 																			 																			For Key10, Value10 in Value9 			                                { 																				If !(IsObject(Value10)) 		                                         Text .= ""`r`n`t`t`t`t`t`t`t`t`t`t["" . Key10 . ""] => "" . Value10 		                                    Else Text .= ""`r`n`t`t`t`t`t`t`t`t`t`t["" . Key10 . ""] => "" . ""Array"" 																			} 																		   																			Text .= ""`r`n`t`t`t`t`t`t`t`t`t"" . "")"" 																		} 																	} 																	 																	Text .= ""`r`n`t`t`t`t`t`t`t`t"" . "")"" 																} 															} 															 															Text .= ""`r`n`t`t`t`t`t`t`t"" . "")"" 														} 													} 													 													Text .= ""`r`n`t`t`t`t`t`t"" . "")"" 												} 											} 										 										  Text .= ""`r`n`t`t`t`t`t"" . "")"" 										} 									} 								 								  Text .= ""`r`n`t`t`t`t"" . "")"" 								} 							} 						 						  Text .= ""`r`n`t`t`t"" . "")"" 						} 					} 				 				  Text .= ""`r`n`t`t"" . "")"" 				} 			} 		 		  Text .= ""`r`n`t"" . "")"" 		} 	}    Text .= ""`r`n"" . "")"" 	 	If (!Display) 	Return Text 	 	Gui, PrintArray:+MaximizeBox 	Gui, PrintArray:Add, Edit, x12 y10 w450 h350 vPrintArray ReadOnly, %Text%   Gui, PrintArray:Show, w476 h374, PrintArray 	Gui, PrintArray:+LastFound 	ControlSend, , {Right} 	WinWaitClose   Return Text  	PrintArrayGuiSize:   Anchor(""PrintArray"", ""wh"")   Return    PrintArrayGuiClose:   Gui, PrintArray:Destroy   Return }  /* 	Function: Anchor 		Defines how controls should be automatically positioned relative to the new dimensions of a window when resized.  	Parameters: 		cl - a control HWND, associated variable name or ClassNN to operate on 		a - (optional) one or more of the anchors: 'x', 'y', 'w' (width) and 'h' (height), 			optionally followed by a relative factor, e.g. ""x h0.5"" 		r - (optional) true to redraw controls, recommended for GroupBox and Button types  	Examples: > ""xy"" ; bounds a control to the bottom-left edge of the window > ""w0.5"" ; any change in the width of the window will resize the width of the control on a 2:1 ratio > ""h"" ; similar to above but directrly proportional to height  	Remarks: 		To assume the current window size for the new bounds of a control (i.e. resetting) simply omit the second and third parameters. 		However if the control had been created with DllCall() and has its own parent window, 			the container AutoHotkey created GUI must be made default with the +LastFound option prior to the call. 		For a complete example see anchor-example.ahk.  	License: 		- Version 4.60a <http://www.autohotkey.net/~Titan/#anchor> 		- Simplified BSD License <http://www.autohotkey.net/~Titan/license.txt> */ Anchor(i, a = """", r = false) { 	static c, cs = 12, cx = 255, cl = 0, g, gs = 8, gl = 0, gpi, gw, gh, z = 0, k = 0xffff 	If z = 0 		VarSetCapacity(g, gs * 99, 0), VarSetCapacity(c, cs * cx, 0), z := true 	If (!WinExist(""ahk_id"" . i)) { 		GuiControlGet, t, Hwnd, %i% 		If ErrorLevel = 0 			i := t 		Else ControlGet, i, Hwnd, , %i% 	} 	VarSetCapacity(gi, 68, 0), DllCall(""GetWindowInfo"", ""UInt"", gp := DllCall(""GetParent"", ""UInt"", i), ""UInt"", &gi) 		, giw := NumGet(gi, 28, ""Int"") - NumGet(gi, 20, ""Int""), gih := NumGet(gi, 32, ""Int"") - NumGet(gi, 24, ""Int"") 	If (gp != gpi) { 		gpi := gp 		Loop, %gl% 			If (NumGet(g, cb := gs * (A_Index - 1)) == gp) { 				gw := NumGet(g, cb + 4, ""Short""), gh := NumGet(g, cb + 6, ""Short""), gf := 1 				Break 			} 		If (!gf) 			NumPut(gp, g, gl), NumPut(gw := giw, g, gl + 4, ""Short""), NumPut(gh := gih, g, gl + 6, ""Short""), gl += gs 	} 	ControlGetPos, dx, dy, dw, dh, , ahk_id %i% 	Loop, %cl% 		If (NumGet(c, cb := cs * (A_Index - 1)) == i) { 			If a = 			{ 				cf = 1 				Break 			} 			giw -= gw, gih -= gh, as := 1, dx := NumGet(c, cb + 4, ""Short""), dy := NumGet(c, cb + 6, ""Short"") 				, cw := dw, dw := NumGet(c, cb + 8, ""Short""), ch := dh, dh := NumGet(c, cb + 10, ""Short"") 			Loop, Parse, a, xywh 				If A_Index > 1 					av := SubStr(a, as, 1), as += 1 + StrLen(A_LoopField) 						, d%av% += (InStr(""yh"", av) ? gih : giw) * (A_LoopField + 0 ? A_LoopField : 1) 			DllCall(""SetWindowPos"", ""UInt"", i, ""Int"", 0, ""Int"", dx, ""Int"", dy 				, ""Int"", InStr(a, ""w"") ? dw : cw, ""Int"", InStr(a, ""h"") ? dh : ch, ""Int"", 4) 			If r != 0 				DllCall(""RedrawWindow"", ""UInt"", i, ""UInt"", 0, ""UInt"", 0, ""UInt"", 0x0101) ; RDW_UPDATENOW | RDW_INVALIDATE 			Return 		} 	If cf != 1 		cb := cl, cl += cs 	bx := NumGet(gi, 48), by := NumGet(gi, 16, ""Int"") - NumGet(gi, 8, ""Int"") - gih - NumGet(gi, 52) 	If cf = 1 		dw -= giw - gw, dh -= gih - gh 	NumPut(i, c, cb), NumPut(dx - bx, c, cb + 4, ""Short""), NumPut(dy - by, c, cb + 6, ""Short"") 		, NumPut(dw, c, cb + 8, ""Short""), NumPut(dh, c, cb + 10, ""Short"") 	Return, true }  #2 - Posted 23 February 2012 - 06:10 PM -trueski- Back to top fragman Members 1591 posts Last active: Nov 12 2012 08:51 PM Joined: 13 Oct 2009 I made a similar function that I think works a little cleaner. It will display up to ten levels deep. I could get it to allow more levels, but I don't have the need to right now, and it can get kind of confusing when trying to add more. Thanks to Polythene for the anchor function. Syntax: PrintArray(Array, [DisplayOutput? = 0|1]) Array := Object() Array[1] := ""Test 1"" Array[2] := ""Test 2"" Array[3] := Object() Array[3][1] := ""Test 3-1"" Array[3][2] := Object() Array[3][2][1] := ""Test 3-2-1"" Array[3][2][2] := ""Test 3-2-2"" Array[3][3] := ""Test 3-3"" Array[4] := ""Test 4""  PrintArray(Array, 1) ExitApp  PrintArray(Array, Display=0) { 	Global PrintArray 	 	If (!IsObject(Array)) 	Return """" 	 	Text := ""Array"" . ""`r`n"" . ""("" 	For Key1, Value1 in Array 	{ 		If !(IsObject(Value1)) 		     Text .= ""`r`n`t["" . Key1 . ""] => "" . Value1 		Else Text .= ""`r`n`t["" . Key1 . ""] => "" . ""Array"" 		 		If (IsObject(Value1)) 		{ 			Text .= ""`r`n`t"" . ""("" 			 			For Key2, Value2 in Value1 			{ 				If !(IsObject(Value2)) 		         Text .= ""`r`n`t`t["" . Key2 . ""] => "" . Value2 		    Else Text .= ""`r`n`t`t["" . Key2 . ""] => "" . ""Array"" 		 				If (IsObject(Value2)) 		    { 					Text .= ""`r`n`t`t"" . ""("" 					 					For Key3, Value3 in Value2 			    { 						If !(IsObject(Value3)) 		             Text .= ""`r`n`t`t`t["" . Key3 . ""] => "" . Value3 		        Else Text .= ""`r`n`t`t`t["" . Key3 . ""] => "" . ""Array"" 				 						If (IsObject(Value3)) 		        { 							Text .= ""`r`n`t`t`t"" . ""("" 							 							For Key4, Value4 in Value3 			        { 								If !(IsObject(Value4)) 		                 Text .= ""`r`n`t`t`t`t["" . Key4 . ""] => "" . Value4 		            Else Text .= ""`r`n`t`t`t`t["" . Key4 . ""] => "" . ""Array"" 								 								If (IsObject(Value4)) 		            { 									Text .= ""`r`n`t`t`t`t"" . ""("" 									 									For Key5, Value5 in Value4 			            { 										If !(IsObject(Value5)) 		                     Text .= ""`r`n`t`t`t`t`t["" . Key5 . ""] => "" . Value5 		                Else Text .= ""`r`n`t`t`t`t`t["" . Key5 . ""] => "" . ""Array"" 								 										If (IsObject(Value5)) 		                { 											Text .= ""`r`n`t`t`t`t`t"" . ""("" 											 											For Key6, Value6 in Value5 			                { 												If !(IsObject(Value6)) 		                         Text .= ""`r`n`t`t`t`t`t`t["" . Key6 . ""] => "" . Value6 		                    Else Text .= ""`r`n`t`t`t`t`t`t["" . Key6 . ""] => "" . ""Array"" 										 												If (IsObject(Value6)) 		                    { 													Text .= ""`r`n`t`t`t`t`t`t"" . ""("" 													 													For Key7, Value7 in Value6 			                    { 														If !(IsObject(Value7)) 		                             Text .= ""`r`n`t`t`t`t`t`t`t["" . Key7 . ""] => "" . Value7 		                        Else Text .= ""`r`n`t`t`t`t`t`t`t["" . Key7 . ""] => "" . ""Array"" 														 														If (IsObject(Value7)) 		                        { 															Text .= ""`r`n`t`t`t`t`t`t`t"" . ""("" 															 															For Key8, Value8 in Value7 			                        { 																If !(IsObject(Value8)) 		                                 Text .= ""`r`n`t`t`t`t`t`t`t`t["" . Key8 . ""] => "" . Value8 		                            Else Text .= ""`r`n`t`t`t`t`t`t`t`t["" . Key8 . ""] => "" . ""Array"" 																 																If (IsObject(Value8)) 		                            { 																	Text .= ""`r`n`t`t`t`t`t`t`t`t"" . ""("" 																	 																	For Key9, Value9 in Value8 			                            { 																		If !(IsObject(Value9)) 		                                     Text .= ""`r`n`t`t`t`t`t`t`t`t`t["" . Key9 . ""] => "" . Value9 		                                Else Text .= ""`r`n`t`t`t`t`t`t`t`t`t["" . Key9 . ""] => "" . ""Array"" 																		 																		If (IsObject(Value9)) 		                                { 																			Text .= ""`r`n`t`t`t`t`t`t`t`t`t"" . ""("" 																			 																			For Key10, Value10 in Value9 			                                { 																				If !(IsObject(Value10)) 		                                         Text .= ""`r`n`t`t`t`t`t`t`t`t`t`t["" . Key10 . ""] => "" . Value10 		                                    Else Text .= ""`r`n`t`t`t`t`t`t`t`t`t`t["" . Key10 . ""] => "" . ""Array"" 																			} 																		   																			Text .= ""`r`n`t`t`t`t`t`t`t`t`t"" . "")"" 																		} 																	} 																	 																	Text .= ""`r`n`t`t`t`t`t`t`t`t"" . "")"" 																} 															} 															 															Text .= ""`r`n`t`t`t`t`t`t`t"" . "")"" 														} 													} 													 													Text .= ""`r`n`t`t`t`t`t`t"" . "")"" 												} 											} 										 										  Text .= ""`r`n`t`t`t`t`t"" . "")"" 										} 									} 								 								  Text .= ""`r`n`t`t`t`t"" . "")"" 								} 							} 						 						  Text .= ""`r`n`t`t`t"" . "")"" 						} 					} 				 				  Text .= ""`r`n`t`t"" . "")"" 				} 			} 		 		  Text .= ""`r`n`t"" . "")"" 		} 	}    Text .= ""`r`n"" . "")"" 	 	If (!Display) 	Return Text 	 	Gui, PrintArray:+MaximizeBox 	Gui, PrintArray:Add, Edit, x12 y10 w450 h350 vPrintArray ReadOnly, %Text%   Gui, PrintArray:Show, w476 h374, PrintArray 	Gui, PrintArray:+LastFound 	ControlSend, , {Right} 	WinWaitClose   Return Text  	PrintArrayGuiSize:   Anchor(""PrintArray"", ""wh"")   Return    PrintArrayGuiClose:   Gui, PrintArray:Destroy   Return }  /* 	Function: Anchor 		Defines how controls should be automatically positioned relative to the new dimensions of a window when resized.  	Parameters: 		cl - a control HWND, associated variable name or ClassNN to operate on 		a - (optional) one or more of the anchors: 'x', 'y', 'w' (width) and 'h' (height), 			optionally followed by a relative factor, e.g. ""x h0.5"" 		r - (optional) true to redraw controls, recommended for GroupBox and Button types  	Examples: > ""xy"" ; bounds a control to the bottom-left edge of the window > ""w0.5"" ; any change in the width of the window will resize the width of the control on a 2:1 ratio > ""h"" ; similar to above but directrly proportional to height  	Remarks: 		To assume the current window size for the new bounds of a control (i.e. resetting) simply omit the second and third parameters. 		However if the control had been created with DllCall() and has its own parent window, 			the container AutoHotkey created GUI must be made default with the +LastFound option prior to the call. 		For a complete example see anchor-example.ahk.  	License: 		- Version 4.60a <http://www.autohotkey.net/~Titan/#anchor> 		- Simplified BSD License <http://www.autohotkey.net/~Titan/license.txt> */ Anchor(i, a = """", r = false) { 	static c, cs = 12, cx = 255, cl = 0, g, gs = 8, gl = 0, gpi, gw, gh, z = 0, k = 0xffff 	If z = 0 		VarSetCapacity(g, gs * 99, 0), VarSetCapacity(c, cs * cx, 0), z := true 	If (!WinExist(""ahk_id"" . i)) { 		GuiControlGet, t, Hwnd, %i% 		If ErrorLevel = 0 			i := t 		Else ControlGet, i, Hwnd, , %i% 	} 	VarSetCapacity(gi, 68, 0), DllCall(""GetWindowInfo"", ""UInt"", gp := DllCall(""GetParent"", ""UInt"", i), ""UInt"", &gi) 		, giw := NumGet(gi, 28, ""Int"") - NumGet(gi, 20, ""Int""), gih := NumGet(gi, 32, ""Int"") - NumGet(gi, 24, ""Int"") 	If (gp != gpi) { 		gpi := gp 		Loop, %gl% 			If (NumGet(g, cb := gs * (A_Index - 1)) == gp) { 				gw := NumGet(g, cb + 4, ""Short""), gh := NumGet(g, cb + 6, ""Short""), gf := 1 				Break 			} 		If (!gf) 			NumPut(gp, g, gl), NumPut(gw := giw, g, gl + 4, ""Short""), NumPut(gh := gih, g, gl + 6, ""Short""), gl += gs 	} 	ControlGetPos, dx, dy, dw, dh, , ahk_id %i% 	Loop, %cl% 		If (NumGet(c, cb := cs * (A_Index - 1)) == i) { 			If a = 			{ 				cf = 1 				Break 			} 			giw -= gw, gih -= gh, as := 1, dx := NumGet(c, cb + 4, ""Short""), dy := NumGet(c, cb + 6, ""Short"") 				, cw := dw, dw := NumGet(c, cb + 8, ""Short""), ch := dh, dh := NumGet(c, cb + 10, ""Short"") 			Loop, Parse, a, xywh 				If A_Index > 1 					av := SubStr(a, as, 1), as += 1 + StrLen(A_LoopField) 						, d%av% += (InStr(""yh"", av) ? gih : giw) * (A_LoopField + 0 ? A_LoopField : 1) 			DllCall(""SetWindowPos"", ""UInt"", i, ""Int"", 0, ""Int"", dx, ""Int"", dy 				, ""Int"", InStr(a, ""w"") ? dw : cw, ""Int"", InStr(a, ""h"") ? dh : ch, ""Int"", 4) 			If r != 0 				DllCall(""RedrawWindow"", ""UInt"", i, ""UInt"", 0, ""UInt"", 0, ""UInt"", 0x0101) ; RDW_UPDATENOW | RDW_INVALIDATE 			Return 		} 	If cf != 1 		cb := cl, cl += cs 	bx := NumGet(gi, 48), by := NumGet(gi, 16, ""Int"") - NumGet(gi, 8, ""Int"") - gih - NumGet(gi, 52) 	If cf = 1 		dw -= giw - gw, dh -= gih - gh 	NumPut(i, c, cb), NumPut(dx - bx, c, cb + 4, ""Short""), NumPut(dy - by, c, cb + 6, ""Short"") 		, NumPut(dw, c, cb + 8, ""Short""), NumPut(dh, c, cb + 10, ""Short"") 	Return, true }  This is what recursion is used for usually #3 - Posted 23 February 2012 - 07:09 PM Back to top kenn Members 407 posts Last active: Jan 14 2015 08:16 PM Joined: 11 Oct 2010 Is recursive function calls itself? #4 - Posted 23 February 2012 - 07:12 PM Back to top nimda Members 4368 posts Last active: Aug 09 2015 02:36 AM Joined: 26 Dec 2010 Yes. #5 - Posted 23 February 2012 - 07:24 PM Back to top trueski Members 121 posts Last active: Jun 25 2014 09:12 PM Joined: 08 Apr 2008 This is what recursion is used for usually Could you provide an example? #6 - Posted 23 February 2012 - 08:13 PM -trueski- Back to top Guests Last active: Joined: -- This is what recursion is used for usually Could you provide an example? factorial( n ) { ; recursively calculate N! Return n < 1 ? """" : n < 2 ? n : n * factorial( n - 1 ) } #7 - Posted 23 February 2012 - 08:27 PM Back to top fragman Members 1591 posts Last active: Nov 12 2012 08:51 PM Joined: 13 Oct 2009 Sure, here's a function by Lexikos: ExploreObj(Obj, NewRow=""`n"", Equal=""  =  "", Indent=""`t"", Depth=12, CurIndent="""") {       for k,v in Obj           ToReturn .= CurIndent . k . (IsObject(v) && depth>1 ? NewRow . ExploreObj(v, NewRow, Equal, Indent, Depth-1, CurIndent . Indent) : Equal . v) . NewRow       return RTrim(ToReturn, NewRow)   } #8 - Posted 23 February 2012 - 08:48 PM Back to top trueski Members 121 posts Last active: Jun 25 2014 09:12 PM Joined: 08 Apr 2008 Sure, here's a function by Lexikos: I've updated my function to make it recursive. Cut out ~120 lines. I also made a few minor modifications to the window. Thanks fragman. Array := Object() Array[1] := ""Test 1"" Array[2] := ""Test 2"" Array[3] := Object() Array[3][1] := ""Test 3-1"" Array[3][2] := Object() Array[3][2][1] := ""Test 3-2-1"" Array[3][2][2] := ""Test 3-2-2"" Array[3][3] := ""Test 3-3"" Array[4] := ""Test 4""  PrintArray(Array) ExitApp  PrintArray(Array, Display=1, Level=0) 	{ 		Global PrintArray 				 		Loop, % 4 + (Level*8) 		Tabs .= A_Space 		 		Output := ""Array`r`n"" . SubStr(Tabs, 5) . ""(""  		 		For Key, Value in Array 		  { 				If (IsObject(Value)) 				  {             Level++ 						Value := PrintArray(Value, 0, Level) 						Level-- 					} 				 				Output .= ""`r`n"" . Tabs . ""["" . Key . ""] => "" . Value 			} 		 		Output .= ""`r`n"" . SubStr(Tabs, 5) . "")"" 		 		 		If (!Display) 	  Return Output 	   		Gui, PrintArray:+MaximizeBox +Resize 		Gui, PrintArray:Font, s9, Courier New 	  Gui, PrintArray:Add, Edit, x12 y10 w450 h350 vPrintArray ReadOnly HScroll, %Output%     Gui, PrintArray:Show, w476 h374, PrintArray 	  Gui, PrintArray:+LastFound 	  ControlSend, , {Right} 	  WinWaitClose     Return Output  	  PrintArrayGuiSize:     Anchor(""PrintArray"", ""wh"")     Return      PrintArrayGuiClose:     Gui, PrintArray:Destroy     Return 	}  /* 	Function: Anchor 		Defines how controls should be automatically positioned relative to the new dimensions of a window when resized.  	Parameters: 		cl - a control HWND, associated variable name or ClassNN to operate on 		a - (optional) one or more of the anchors: 'x', 'y', 'w' (width) and 'h' (height), 			optionally followed by a relative factor, e.g. ""x h0.5"" 		r - (optional) true to redraw controls, recommended for GroupBox and Button types  	Examples: > ""xy"" ; bounds a control to the bottom-left edge of the window > ""w0.5"" ; any change in the width of the window will resize the width of the control on a 2:1 ratio > ""h"" ; similar to above but directrly proportional to height  	Remarks: 		To assume the current window size for the new bounds of a control (i.e. resetting) simply omit the second and third parameters. 		However if the control had been created with DllCall() and has its own parent window, 			the container AutoHotkey created GUI must be made default with the +LastFound option prior to the call. 		For a complete example see anchor-example.ahk.  	License: 		- Version 4.60a <http://www.autohotkey.net/~Titan/#anchor> 		- Simplified BSD License <http://www.autohotkey.net/~Titan/license.txt> */ Anchor(i, a = """", r = false) { 	static c, cs = 12, cx = 255, cl = 0, g, gs = 8, gl = 0, gpi, gw, gh, z = 0, k = 0xffff 	If z = 0 		VarSetCapacity(g, gs * 99, 0), VarSetCapacity(c, cs * cx, 0), z := true 	If (!WinExist(""ahk_id"" . i)) { 		GuiControlGet, t, Hwnd, %i% 		If ErrorLevel = 0 			i := t 		Else ControlGet, i, Hwnd, , %i% 	} 	VarSetCapacity(gi, 68, 0), DllCall(""GetWindowInfo"", ""UInt"", gp := DllCall(""GetParent"", ""UInt"", i), ""UInt"", &gi) 		, giw := NumGet(gi, 28, ""Int"") - NumGet(gi, 20, ""Int""), gih := NumGet(gi, 32, ""Int"") - NumGet(gi, 24, ""Int"") 	If (gp != gpi) { 		gpi := gp 		Loop, %gl% 			If (NumGet(g, cb := gs * (A_Index - 1)) == gp) { 				gw := NumGet(g, cb + 4, ""Short""), gh := NumGet(g, cb + 6, ""Short""), gf := 1 				Break 			} 		If (!gf) 			NumPut(gp, g, gl), NumPut(gw := giw, g, gl + 4, ""Short""), NumPut(gh := gih, g, gl + 6, ""Short""), gl += gs 	} 	ControlGetPos, dx, dy, dw, dh, , ahk_id %i% 	Loop, %cl% 		If (NumGet(c, cb := cs * (A_Index - 1)) == i) { 			If a = 			{ 				cf = 1 				Break 			} 			giw -= gw, gih -= gh, as := 1, dx := NumGet(c, cb + 4, ""Short""), dy := NumGet(c, cb + 6, ""Short"") 				, cw := dw, dw := NumGet(c, cb + 8, ""Short""), ch := dh, dh := NumGet(c, cb + 10, ""Short"") 			Loop, Parse, a, xywh 				If A_Index > 1 					av := SubStr(a, as, 1), as += 1 + StrLen(A_LoopField) 						, d%av% += (InStr(""yh"", av) ? gih : giw) * (A_LoopField + 0 ? A_LoopField : 1) 			DllCall(""SetWindowPos"", ""UInt"", i, ""Int"", 0, ""Int"", dx, ""Int"", dy 				, ""Int"", InStr(a, ""w"") ? dw : cw, ""Int"", InStr(a, ""h"") ? dh : ch, ""Int"", 4) 			If r != 0 				DllCall(""RedrawWindow"", ""UInt"", i, ""UInt"", 0, ""UInt"", 0, ""UInt"", 0x0101) ; RDW_UPDATENOW | RDW_INVALIDATE 			Return 		} 	If cf != 1 		cb := cl, cl += cs 	bx := NumGet(gi, 48), by := NumGet(gi, 16, ""Int"") - NumGet(gi, 8, ""Int"") - gih - NumGet(gi, 52) 	If cf = 1 		dw -= giw - gw, dh -= gih - gh 	NumPut(i, c, cb), NumPut(dx - bx, c, cb + 4, ""Short""), NumPut(dy - by, c, cb + 6, ""Short"") 		, NumPut(dw, c, cb + 8, ""Short""), NumPut(dh, c, cb + 10, ""Short"") 	Return, true } #9 - Posted 24 February 2012 - 05:18 AM -trueski- Back to top Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"Function that prints array content in GUI."	"true"
"Debugging"	"Yunit"	"https://github.com/Uberi/Yunit"	"by Uberi and infogulch - Simple unit testing framework for AutoHotkey."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"11"	"3"	"5"	"GitHub - Uberi/Yunit: Super simple testing framework for AutoHotkey. Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 3 Star 11 Fork 5 Uberi/Yunit Code Issues 3 Pull requests 0 Pulse Graphs Super simple testing framework for AutoHotkey. 70 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit d5f8953 Apr 21, 2016 infogulch Merge pull request #11 from aviaryan/patch-1 … link to Main.md in README Permalink Failed to load latest commit information. doc fixed a typo Apr 19, 2016 LICENSE.txt Add README and license. Oct 31, 2012 README.md link to Main.md in README Apr 21, 2016 Stdout.ahk Fix capitalization in Stdout.ahk Jan 2, 2013 Window.ahk Merge remote-tracking branch 'mmikeww/add-icon'. Oct 1, 2014 Yunit.ahk v2 uses .InsertAt() instead of .Insert() Sep 19, 2014 README.md Yunit Super simple unit testing framework for AutoHotkey. Usage See doc/Main.md License Copyright 2012 Anthony Zhang (Uberi) and Joe Taber (infogulch). This file is part of Yunit. Source code is available at https://github.com/Uberi/Yunit. Yunit is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more details. You should have received a copy of the GNU Affero General Public License along with this program. If not, see http://www.gnu.org/licenses/. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/Uberi/Yunit"	"by Uberi and infogulch - Simple unit testing framework for AutoHotkey."	"true"
"Decompilers"	"AutoHotkey decompiler"	"https://gist.github.com/Uberi/3334552#file-decompiler-ahk"	"for AHK 1.1+ Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"AHK script decompiler with GUI. Based on IsNull's [decompiler](http://www.autohotkey.com/board/topic/82986-ahk-l-decompiler-payload-method/). · GitHub Skip to content All gists GitHub Sign up for a GitHub account Sign in Create a gist now Instantly share code, notes, and snippets. Star 5 Fork 0 Uberi/Decompiler.ahk Last active Apr 27, 2016 Embed What would you like to do? Embed Embed this gist in your website. Embed Share Copy sharable URL for this gist. Share Clone via HTTPS Clone with Git or checkout with SVN using the repository's web address. HTTPS Learn more about clone URLs Download ZIP Code Revisions 6 Stars 5 AHK script decompiler with GUI. Based on IsNull's [decompiler](http://www.autohotkey.com/board/topic/82986-ahk-l-decompiler-payload-method/). Raw Decompiler.ahk #NoEnv SetBatchLines, -1 Gui, Font, s16, Arial Gui, Add, Edit, x10 y10 w450 h30 vPath gUpdate Gui, Add, Button, x460 y10 w30 h30 gSelectFile, ... Gui, Font, s12, Courier New Gui, Add, Edit, x10 y50 w480 h340 vCode ReadOnly -Wrap, <Output> Gui, Show, w496 h398, AutoHotkey Decompiler If 0 = 1 GuiControl,, Path, %1% Return GuiClose: ExitApp Update: SetTimer, Decompile, -800 Return GuiDropFiles: Loop, Parse, A_GuiEvent, `n { GuiControl,, Path, %A_LoopField% Break } Return SelectFile: FileSelectFile, Path, 3,, Select an AutoHotkey executable to decompile, *.exe If !ErrorLevel GuiControl,, Path, %Path% Return Decompile: GuiControlGet, Path,, Path Attributes := FileExist(Path) If !Attributes { GuiControl,, Code, <Error>`nInvalid path: ""%Path%"". Return } If InStr(Attributes,""D"") { GuiControl,, Code, <Error>`nInvalid file: %Path%. Return } GuiControl,, Code, <Decompiling> try Code := Decompile(Path) catch e { GuiControl,, Code, % ""<Error>`n"" . e.Message . ""`nFunction: "" . e.What . "" (Line "" . e.Line . "")"" Return } GuiControl,, Code, %Code% Return Decompile(Path) { ExtractDir := A_ScriptDir . ""\ExtractFiles"" PatchedPath := ExtractDir . ""\Patched.exe"" Payload := ExtractDir . ""\winmm.dll"" ;set up temporary directory try FileCreateDir, %ExtractDir% catch e throw Exception(""Could not create temporary extraction directory: """""" . ExtractDir . """"""."") ;make a copy of the executable to work with try FileCopy, %Path%, %PatchedPath%, 1 catch e { try FileRemoveDir, %ExtractDir%, 1 ;clean up temporary directory throw Exception(""Invalid executable path: """""" . Path . """"""."") } ;read the executable contents Executable := FileOpen(PatchedPath,""rw"") If !Executable { try FileRemoveDir, %ExtractDir%, 1 ;clean up temporary directory throw Exception(""Could not access executable: """""" . PatchedPath . """"""."") } Length := Executable.RawRead(Buffer,Executable.Length) If Length < 64 ;minimum executable size { try FileRemoveDir, %ExtractDir%, 1 ;clean up temporary directory throw Exception(""Could not read executable: """""" . PatchedPath . """"""."") } try SectionLength := GetSectionOffset(Buffer,"".rsrc"",SectionDataOffset) ;search for the resources section catch e { try FileRemoveDir, %ExtractDir%, 1 ;clean up temporary directory throw e } PatchedNames := ["">UHK WITH ICON<"","">UUTOHOTKEY SCRIPT<""] Success := False For Index, Name In ["">AHK WITH ICON<"","">AUTOHOTKEY SCRIPT<""] { ;obtain resource name in UTF-16 Size := StrLen(Name) VarSetCapacity(uName,Size << 1) StrPut(Name,&uName,Size,""UTF-16"") ;patch resource name if found Offset := SearchBuffer(&Buffer + SectionDataOffset,SectionLength,uName,Size) If Offset = -1 Continue Offset += SectionDataOffset ;obtain absolute offset Success := True ;obtain new resource name in UTF-16 NewName := PatchedNames[Index] Size := StrLen(NewName) VarSetCapacity(uName,Size << 1) StrPut(NewName,&uName,Size,""UTF-16"") ;patch the resource name to prevent access by executable If !Executable.Seek(Offset) { try FileRemoveDir, %ExtractDir%, 1 ;clean up temporary directory throw Exception(""Could not seek to resource position: "" . Offset . ""."") } If !Executable.RawWrite(uName,Size << 1) { try FileRemoveDir, %ExtractDir%, 1 ;clean up temporary directory throw Exception(""Could not patch resource: """""" . NewName . """"""."") } } If !Success ;resources not found { try FileRemoveDir, %ExtractDir%, 1 ;clean up temporary directory throw Exception(""Invalid executable script resources: """""" . PatchedPath . """"""."") } Executable.Close() ;determine the correct payload to use BinaryType := 0 If !DllCall(""GetBinaryType"" . (A_IsUnicode ? ""W"" : ""A""),""Str"",PatchedPath,""UInt*"",BinaryType) throw Exception(""Could not determine executable type: """""" . PatchedPath . """"""."") If BinaryType = 0 ;SCS_32BIT_BINARY PayloadPath := A_ScriptDir . ""\payload.dll"" Else If BinaryType = 6 ;SCS_64BIT_BINARY PayloadPath := A_ScriptDir . ""\payload64.dll"" Else { try FileRemoveDir, %ExtractDir%, 1 ;clean up temporary directory throw Exception(""Invalid executable type: """""" . BinaryType . """"""."") } ;deploy payload try FileCopy, %PayloadPath%, %Payload%, 1 catch e { try FileRemoveDir, %ExtractDir%, 1 ;clean up temporary directory throw Exception(""Could not deploy payload: """""" . PayloadPath . """"""."") } ;run the executable try RunWait, %PatchedPath%, %ExtractDir% catch e { try FileRemoveDir, %ExtractDir%, 1 ;clean up temporary directory throw Exception(""Could not run executable: """""" . PatchedPath . """"""."") } ;obtain script extracted by payload SplitPath, PatchedPath,, OutDir,, OutNameNoExt ScriptPath := OutDir . ""\"" . OutNameNoExt . ""-uncompiled.ahk"" try FileRead, Code, %ScriptPath% catch e { try FileRemoveDir, %ExtractDir%, 1 ;clean up temporary directory throw Exception(""Could read script code: """""" . ScriptPath . """"""."") } try FileRemoveDir, %ExtractDir%, 1 ;clean up temporary directory Return, Code } GetSectionOffset(ByRef Buffer,Name,ByRef DataOffset) { If NumGet(Buffer,0,""UShort"") != 0x5A4D ;MS-DOS executable marker throw Exception(""Invalid MS-DOS signature."") Offset := NumGet(Buffer,60,""UInt"") ;read the ""e_lfanew"" field of the MS-DOS header for the file address of the PE header If NumGet(Buffer,Offset,""UInt"") != 0x4550 ;IMAGE_NT_SIGNATURE throw Exception(""Invalid NT signature."") Offset += 4 ;move past the file signature SectionsCount := NumGet(Buffer,Offset + 2,""UShort"") ;read the ""NumberOfSections"" field of the IMAGE_FILE_HEADER structure for the number of sections present OptionalHeaderSize := NumGet(Buffer,Offset + 16,""UShort"") ;read the ""SizeOfOptionalHeader"" field of the IMAGE_FILE_HEADER structure for the size of the optional header Offset += 20 ;move past the IMAGE_FILE_HEADER structure Marker := NumGet(Buffer,Offset,""UShort"") ;IMAGE_OPTIONAL_HEADER marker If (Marker != 0x10B && Marker != 0x20B) ;IMAGE_NT_OPTIONAL_HDR32_MAGIC, IMAGE_NT_OPTIONAL_HDR64_MAGIC throw Exception(""Invalid PE signature."") Offset += OptionalHeaderSize ;move past the IMAGE_OPTIONAL_HEADER structure Loop, %SectionsCount% ;loop through each section header { If StrGet(&Buffer + Offset,8,""UTF-8"") = Name ;found header { DataLength := NumGet(Buffer,Offset + 16,""UInt"") DataOffset := NumGet(Buffer,Offset + 20,""UInt"") Return, DataLength } Offset += 40 ;move past the IMAGE_SECTION_HEADER structure } throw Exception(""Could not find PE file section: """""" . Name . """"""."") } SearchBuffer(pBuffer,BufferSize,ByRef Search,SearchSize) ;Boyer-Moore-Horspool algorithm { ;preprocess search input ShiftTable := [] Loop, 255 ShiftTable[A_Index] := SearchSize Loop, % SearchSize - 1 ShiftTable[NumGet(Search,A_Index - 1,""UChar"")] := SearchSize - A_Index ;search buffer Offset := 0 While, BufferSize >= SearchSize { ;scan from the end of the search input Position := SearchSize - 1 While, NumGet(pBuffer + Offset,Position,""UChar"") = NumGet(Search,Position,""UChar"") { If Position = 0 Return, Offset Position -- } ;shift buffer if not found Value := ShiftTable[NumGet(pBuffer + Offset,SearchSize - 1,""UChar"")] Offset += Value BufferSize -= Value } ;search input not found Return, -1 } Sign up for free to join this conversation on GitHub. Already have an account? Sign in to comment Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://gist.github.com/Uberi/3334552#file-decompiler-ahk"	"for AHK 1.1+ Forum thread:."	"true"
"Decompilers"	"link"	"https://autohotkey.com/board/topic/82986-ahk-l-decompiler-payload-method/"	"for AHK 1.1+ Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"AHK_L Decompiler (Payload Method) - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. AHK_L Decompiler (Payload Method) Started by IsNull , Jul 25 2012 02:59 PM Page 1 of 5 1 2 3 Next » Please log in to reply 69 replies to this topic IsNull Moderators 990 posts Last active: May 15 2014 11:56 AM Joined: 10 May 2007 This tool helps to extract the source from a compiled AHK_L Script. It uses a payload (injected dll) which is able to extract any resource. This method was discovered by fincs, and the payload dll bases upon his code. (thx!) By default, the resource-name gets patched, so the AHK Script cannot be executed.   AHK Basic compiled executables are NOT supported nor is any support planned. There are two common use-cases: You have lost your Source. This Tool will help you. You have to check the Contents of a compiled AHK Program for malware. The script-contents will not be executed by the payload method. In theory, most packers/crypter are tricked by this method. The following packers are known to be bypassed:   UPX Mpress XPack/XComp Engima     AHK_L Decompiler        /* * AHK_L Decompiler / Source Extractor * Written by IsNull 2012 * the payload method bases on fincs injection example * * This Script suports generic resource extraction * * * This version is based upon a dll injection which can extract the resources. This method was discovered by fincs, so credits go to him! * */ global DEBUG := false  global POSSIBLE_RESOURCE_NAMES := ["">AHK WITH ICON<"", "">AUTOHOTKEY SCRIPT<""] global PATCHED_RESOURCE_NAMES  := ["">UHK WITH ICON<"", "">UUTOHOTKEY SCRIPT<""]  global ExtractionDir := A_ScriptDir ""\ExtractionTemp""  ;EXTERNAL RESOURCES:  global DecompilerPayload_URL := ""http://dl.securityvision.ch/tools/decompiler_payload.dll"" global DecompilerPayload64_URL := ""http://dl.securityvision.ch/tools/decompiler_payload_64.dll""  global DecompilerPayload_BIN := A_ScriptDir ""\payload.dll"" global DecompilerPayload64_BIN := A_ScriptDir ""\payload64.dll""  global CurrentPayload_BIN := ExtractionDir ""\winmm.dll""  Gui, new, +Resize Gui, Color, White Gui, add, Edit, w800 h20 gExtractNow vAHKExe, [drag your compiled exe here] Gui, Font,, Consolas Gui, add, Edit, +ReadOnly vMyLog w800 h200 Gui, add, Edit, +ReadOnly vScriptSource w800 h500 c4A708B Gui, Font Gui, show,, AHK_L Decompiler by IsNull  LogLn(""<Running on: AHK Version ""A_AhkVersion "" - "" (A_IsUnicode ? ""Unicode"" : ""Ansi"") "" "" (A_PtrSize == 4 ? ""32"" : ""64"") ""bit>"") return   GuiClose:  ExitApp  GuiSize: Anchor(""AHKExe"",""w"") Anchor(""MyLog"",""w"") Anchor(""ScriptSource"",""wh"") return  ExtractNow: 	Gui,submit, nohide  	LogClear() 	GuiCodeSet("""")  	if(PrepareFile(AHKExe, preparedFile)) 	{ 		 		; file was prepared successfull 		if(EnsurePayloadIsPresent()) 		{ 			LogLn(""<Injecting payload...>"")  			PlacePayload(preparedFile)  			RunWait, % preparedFile, % ExtractionDir, UseErrorLevel 			if(ErrorLevel == ""ERROR"") 			{ 				LogLn(""<The Target could not be started. Is this a valid PE Executable?>"") 			}else{ 				SplitPath, preparedFile, OutFileName, OutDir, OutExtension, OutNameNoExt 				tmpCodePath = %OutDir%\%OutNameNoExt%-uncompiled.ahk  				try { 					WaitForFile(tmpCodePath, 10000) ; wait maximum 10secs for the file, this should be enough for even very slow harddisks. 				}catch e{ 					LogLn(""<"" e.Message "">"") 					LogLn(""<Missing: "" tmpCodePath "">"") 				}  				if(FileExist(tmpCodePath)) 				{ 					LogLn(""<Payload succeeded. Recovering Script.>"") 					FileRead, script, % tmpCodePath 					if(!DEBUG) 						FileDelete, % tmpCodePath 					GuiCodeSet(script) 				}else{ 					LogLn(""<Script could not be extracted.>"") 				} 				if(!DEBUG) 					FileDelete, % CurrentPayload_BIN ; remove the winmm.dll as it causes trouble if it get accedintially injected.^^ 			} 		}else{ 			LogLn(""<Missing payload. Aborting now.>"") 			return 		} 	}else{ 		LogLn(""<File seems not to be a valid compiled AHK Script or it uses an unknown protection.>"") 	} 	if(!DEBUG) 		FileDelete, % preparedFile  return  GuiDropFiles:     GuiControl,,AHKExe, % A_GuiEvent return  /* * Waits until the file is present * can be aborted by the timeout * * file      File-Path to check * timeout   Timeout in Milliseconds (Max waittime) */ WaitForFile(file, timeout=5000){    start := A_TickCount        while(!FileExist(file))    {       if((A_TickCount - start) > timeout)          throw Exception(""TimeoutException: File was not present whithin the expected time."")    } }  PlacePayload(preparedFile){    success := false    SplitPath, preparedFile, OutFileName, OutDir        if(Is64BitAssembly(preparedFile))    {       LogLn(""<Target Application is 64bit.>"")       payloadSrc := DecompilerPayload64_BIN     }else{       LogLn(""<Target Application is 32bit.>"")       payloadSrc := DecompilerPayload_BIN    }        if(FileExist(payloadSrc))    {       FileCopy, % payloadSrc, % CurrentPayload_BIN, 1       success := true    }    return success }  Is64BitAssembly(appName){    static GetBinaryType := ""GetBinaryType"" (A_IsUnicode ? ""W"" : ""A"")    static SCS_32BIT_BINARY := 0    static SCS_64BIT_BINARY := 6     ret := DllCall(GetBinaryType       ,""Str"", appName       ,""int*"", binaryType)        return binaryType == SCS_64BIT_BINARY }  EnsurePayloadIsPresent(){    if(!FileExist(DecompilerPayload_BIN))    {       URLDownloadToFile, % DecompilerPayload_URL, % DecompilerPayload_BIN       LogLn(""<"" DecompilerPayload_BIN "" downloaded.>"")    }    if(!FileExist(DecompilerPayload64_BIN))    {       URLDownloadToFile, % DecompilerPayload64_URL, % DecompilerPayload64_BIN       LogLn(""<"" DecompilerPayload64_BIN "" downloaded.>"")    }        return FileExist(DecompilerPayload_BIN) }  PrepareFile(fileToPrepare, byref preparedFile){        success := false        if(!FileExist(ExtractionDir))       FileCreateDir, % ExtractionDir        if(FileExist(fileToPrepare))    {              LogLn(""<Recover Source for "" fileToPrepare "">"")                  binaryTarget := ExtractionDir ""\patched.exe""       preparedFile := binaryTarget       FileCopy, % fileToPrepare, % binaryTarget, 1       LogLn(""<Starting file analysis...>"")       ;##########              ofile := FileOpen(binaryTarget, ""rw"")       VarSetCapacity(buffer, ofile.Length)        bytesRead := ofile.RawRead(buffer, ofile.Length)              LogLn(""<Readed "" bytesRead "" bytes from file.>"")                     if(HasPEHeaderMagic(buffer))       {          LogLn(""<Seems to be a valid PE File.>"")                              for i, resName in POSSIBLE_RESOURCE_NAMES          {             ahkResourceName := StringToUTFByteArray(POSSIBLE_RESOURCE_NAMES[i])             patch := StringToUTFByteArray(PATCHED_RESOURCE_NAMES[i])  			LogLn(""<Searching for "" ByteArrayToHex(ahkResourceName) "" in "" bytesRead ""bytes.>"") 			 			if(pos := FindMagic(buffer, bytesRead, ahkResourceName)) 			{ 				if(PatchBinary(ofile, pos, patch)){ 				   LogLn(""<Patched successfull>"") 				   success := true 				   break 				} 			}          } 		  		 ofile.Close() ; Flush       }else{          LogLn(""<Whatever you dragged here, this is NOT a valid PE file.>"")       }              ;##########           }else{       LogLn(""<File Not Found!>"")    }        return success }  HasPEHeaderMagic(ByRef buffer){    return (NumGet(buffer,0,""UChar"") == 77 && (NumGet(buffer,1,""UChar"") == (A_IsUnicode ? 90 : 82))) }  PatchBinary(targetfile, pos, byteArrayReplacement){        written := false        if(!IsObject(targetfile)){       throw ""targetfile: must be a valid file instance""    }     if(pos != -1)    {       LogLn(""<Found Resource-Name @"" pos "">"")       LogLn(""<Patching Resource-Name...>"")              targetfile.Seek(pos)          size := ByteArrayToBuffer(byteArrayReplacement, patched)       written := targetfile.RawWrite(patched, size)              LogLn(""<PatchBinary: Written "" written "" bytes.>"")    }else{       LogLn(""<Could not find pattern: "" ByteArrayToHex(arr) "">"")    }        return written }   global mylogData := """" LogLn(line){    global    mylogData .= line ""`n""    GuiControl,,MyLog, % mylogData } LogClear(){    global    mylogData := """"    GuiControl,,MyLog, % mylogData }  GuiCodeSet(scriptcode){    global    GuiControl,,ScriptSource, % scriptcode }  StringToUTFByteArray(str){    bufSize := StringToUTFBUffer(str, buf)    return BufferToByteArray(buf, bufSize) }  StringToUTFBUffer(str, byref buf){    ;size := StrPut(str, ""UTF-16"") ; seems the size is not calculated correctly for UTF-16 Strings...    size := (StrPut(str, ""UTF-16"") - 1) * 2    VarSetCapacity( buf, size, 0x00)    StrPut(str, &buf, size, ""UTF-16"")    return size }  BufferToHex( ptr, size ) {    myhexdmp := """"    SetFormat, integer, hex    Loop, % size    {       byte := NumGet(ptr+0, A_index-1,""UChar"") + 0       myhexdmp .= byte    }    return myhexdmp }  ByteArrayToHex(arr){    s := """"    SetFormat, integer, hex    for each, byte in arr    {       byte += 0       s .= (StrLen(x := SubStr(byte, 3)) < 2 ? ""0"" x : x ) "" ""    }    SetFormat, integer, dez    StringUpper, s, s    return s }  PrintArr(obj) {      str := """"    for i, val in obj       str .= ""["" i ""] -> "" val  ""`n""    return str } PrintArrAsStr(obj) {      str := """"    for each, val in obj       str .= val ""("" (val != 0 ? chr(val) : ""null"") "")""  ""`n""    return str }  ToByteArray(str){    bytes := []    Loop, parse, str       bytes[A_index] := asc(A_LoopField)    return bytes }  ByteArrayToBuffer(byteArray, byref buf){    bufferSize := byteArray.MaxIndex()    VarSetCapacity(buf, bufferSize, 0x00)    for each, byte in byteArray       NumPut(byte, buf, A_Index-1, ""uchar"")    return bufferSize }  BufferToByteArray(byref buffer, size){    arr := []    loop, % size       arr[A_index] := NumGet(buffer, A_Index-1, ""UChar"")    return arr }  /************************************************ * FindMagic * * Search in binary data for a given byte-Pattern * * buffer   binary data * size      size of the buffer * magic      Byte-Array of the pattern to search * offset   start offset to skip * * returns the position where the found magic starts *         -1 indicates that no match was found ************************************************* */ FindMagic(byref buffer, size, magic, offset=0){    magicLen := ByteArrayToBuffer(magic, magicBuffer)    magicByte := magic[1]    searchPtr := &buffer + offset    searchEnd := &buffer + size - magicLen + 1  ; First byte must precede searchEnd.    if(searchPtr >= searchEnd)       return -1    while searchPtr := DllCall(""msvcrt\memchr"", ""ptr"", searchPtr, ""int"", magicByte                               , ""ptr"", searchEnd - searchPtr, ""ptr""){       if !DllCall(""msvcrt\memcmp"", ""ptr"", searchPtr, ""ptr"", &magicBuffer, ""ptr"", magicLen)          return searchPtr - &buffer  ; I think this is what the script expects...       ++searchPtr  ; Resume search at the next byte.    }    return -1 }     /*    Function: Anchor by Polyethene       Defines how controls should be automatically positioned relative to the new dimensions of a window when resized.    See http://www.autohotkey.com/community/viewtopic.php?t=4348 */ Anchor(i, a = """", r = false) {    static c, cs = 12, cx = 255, cl = 0, g, gs = 8, gl = 0, gpi, gw, gh, z = 0, k = 0xffff    If z = 0       VarSetCapacity(g, gs * 99, 0), VarSetCapacity(c, cs * cx, 0), z := true    If (!WinExist(""ahk_id"" . i)) {       GuiControlGet, t, Hwnd, %i%       If ErrorLevel = 0          i := t       Else ControlGet, i, Hwnd, , %i%    }    VarSetCapacity(gi, 68, 0), DllCall(""GetWindowInfo"", ""UInt"", gp := DllCall(""GetParent"", ""UInt"", i), ""UInt"", &gi)       , giw := NumGet(gi, 28, ""Int"") - NumGet(gi, 20, ""Int""), gih := NumGet(gi, 32, ""Int"") - NumGet(gi, 24, ""Int"")    If (gp != gpi) {       gpi := gp       Loop, %gl%          If (NumGet(g, cb := gs * (A_Index - 1)) == gp) {             gw := NumGet(g, cb + 4, ""Short""), gh := NumGet(g, cb + 6, ""Short""), gf := 1             Break          }       If (!gf)          NumPut(gp, g, gl), NumPut(gw := giw, g, gl + 4, ""Short""), NumPut(gh := gih, g, gl + 6, ""Short""), gl += gs    }    ControlGetPos, dx, dy, dw, dh, , ahk_id %i%    Loop, %cl%       If (NumGet(c, cb := cs * (A_Index - 1)) == i) {          If a =          {             cf = 1             Break          }          giw -= gw, gih -= gh, as := 1, dx := NumGet(c, cb + 4, ""Short""), dy := NumGet(c, cb + 6, ""Short"")             , cw := dw, dw := NumGet(c, cb + 8, ""Short""), ch := dh, dh := NumGet(c, cb + 10, ""Short"")          Loop, Parse, a, xywh             If A_Index > 1                av := SubStr(a, as, 1), as += 1 + StrLen(A_LoopField)                   , d%av% += (InStr(""yh"", av) ? gih : giw) * (A_LoopField + 0 ? A_LoopField : 1)          DllCall(""SetWindowPos"", ""UInt"", i, ""Int"", 0, ""Int"", dx, ""Int"", dy             , ""Int"", InStr(a, ""w"") ? dw : cw, ""Int"", InStr(a, ""h"") ? dh : ch, ""Int"", 4)          If r != 0             DllCall(""RedrawWindow"", ""UInt"", i, ""UInt"", 0, ""UInt"", 0, ""UInt"", 0x0101) ; RDW_UPDATENOW | RDW_INVALIDATE          Return       }    If cf != 1       cb := cl, cl += cs    bx := NumGet(gi, 48), by := NumGet(gi, 16, ""Int"") - NumGet(gi, 8, ""Int"") - gih - NumGet(gi, 52)    If cf = 1       dw -= giw - gw, dh -= gih - gh    NumPut(i, c, cb), NumPut(dx - bx, c, cb + 4, ""Short""), NumPut(dy - by, c, cb + 6, ""Short"")       , NumPut(dw, c, cb + 8, ""Short""), NumPut(dh, c, cb + 10, ""Short"")    Return, true }  This project is more an experiment than anything else, but I think it could be interesting for some fellows here. Cheers #1 - Posted 25 July 2012 - 02:59 PM securityvision.ch DBA (OOP-SQL DataBase access Framework for SQLite, MySQL, and ADO) Back to top Nostalgia Guests Last active: Joined: -- I remember that back in the day you've been against ""decompilers"" for AHK... and now you create your own? :? #2 - Posted 25 July 2012 - 03:05 PM Back to top IsNull Moderators 990 posts Last active: May 15 2014 11:56 AM Joined: 10 May 2007 Hi Nostalgia, This is a tool like Exe2AHK, just for AHK_L. Back then, Autohotkey Basic had a password functionality and stated public that it is ""protected"". I just took up a project which patched the Exe so that the Decompiler could not automatically find the password. However, I've come to the conclusion, that it is nonsense to propagate security when none exists. We are better off, accepting the fact that there is no protection in a interpreted scripting-language. Nowadays, we have a more open system, by default the source is attached as resource. Given the fact, that almost everything here is open source, I don't expect any harm to the public. If you rely on the belief that your compiled script is not visible to anyone, you potentially store passwords etc. in plaintext in your script. I think in knowing that extraction of the source is easy brings people away from storing such things in their script. My motivation btw was, to check some suspicious files for malware. As this task comes very often over me, I wanted it automated. Et voilà! #3 - Posted 25 July 2012 - 03:30 PM securityvision.ch DBA (OOP-SQL DataBase access Framework for SQLite, MySQL, and ADO) Back to top Guests Last active: Joined: -- Very nice #4 - Posted 25 July 2012 - 03:39 PM Back to top Guests Last active: Joined: -- By the way, it works on ANSI version of Ahk_l, not Unicode. #5 - Posted 25 July 2012 - 03:40 PM Back to top IsNull Moderators 990 posts Last active: May 15 2014 11:56 AM Joined: 10 May 2007 By the way, it works on ANSI version of Ahk_l, not Unicode.Thanks, I had a little issue in the encoding. Its now fixed. However, the first method - Resource-Loading - will not work, when the running decompiler is not in the same bit mode. 32bit Decompiler will not be able to decompile 64bit-Exe and vice-versa. The generic Unpacker will work always at the cost of executing the target and consuming some processing time. #6 - Posted 25 July 2012 - 04:09 PM securityvision.ch DBA (OOP-SQL DataBase access Framework for SQLite, MySQL, and ADO) Back to top Guests Last active: Joined: -- Added it to faq <!-- m -->http://www.autohotke...html#protection<!-- m --> :wink: #7 - Posted 25 July 2012 - 05:26 PM Back to top guest Guests Last active: Joined: -- Doesn't work on http://macro-bar.com/link/ref.php?id=6 #8 - Posted 25 July 2012 - 09:38 PM Back to top IsNull Moderators 990 posts Last active: May 15 2014 11:56 AM Joined: 10 May 2007 Added it to faqThanks. I think its very important that users are aware of the existence, so they will protect important data in better ways. Doesn't work onActually, it does work with the current version. However, please do not ask for specific Tools to be supported by the decompiler. I may add enough configuration possibilities to help skilled people to manage it, but I decided to not include predefined configurations. Anyway, you can always find the script in the minidump if you search for common keywords like ""return"". #9 - Posted 26 July 2012 - 09:00 AM securityvision.ch DBA (OOP-SQL DataBase access Framework for SQLite, MySQL, and ADO) Back to top Guests Last active: Joined: -- Added it to faqThanks. I think its very important that users are aware of the existence, so they will protect important data in better ways. I agree - not sure if it has been added as I don't compile but I suggested to fincs to incorporate a warning ""your script is NOT automatically protected by compiling it"" in the compiler Gui. You see people posting compiled scripts with ftp / email passwords etc they should be aware it is might not be secure as they think. #10 - Posted 26 July 2012 - 09:48 AM Back to top IsNull Moderators 990 posts Last active: May 15 2014 11:56 AM Joined: 10 May 2007 #11 - Posted 26 July 2012 - 10:10 AM securityvision.ch DBA (OOP-SQL DataBase access Framework for SQLite, MySQL, and ADO) Back to top fragmannli Guests Last active: Joined: -- nice one! while we're at it, how would you protect sensitive data like passwords or API keys in a script without relying on an external server? I only have some API keys which are currently encoded, but anyone with AHK knowledge could simply decode them. #12 - Posted 26 July 2012 - 11:01 AM Back to top IsNull Moderators 990 posts Last active: May 15 2014 11:56 AM Joined: 10 May 2007 Hey fragman, Well there are very diffrent usecases. The script uses or generates sensitive User data For integrity and authentication purposes, you can rely on hashes most time. You do not save the original pw, but a hash of it. To protect high sensitive data, you encrypt it with a secure algorithm. The password must not be stored/cached somewhere, or its not secure. (All ""remember my password"" methods are mutually insecure) The Script Author wants to protect something Anything which is locally encrypted but will be decrypted automatically at runtime by the script itself is mutually insecure. Accessing directly administrative services such as (S)FTP or Databases is insecure when the connection is not encrypted. Even if the password is obfuscated or a simple encryption is used, its very easy to sniff the data by man in the middle attacks and also manipulate the data. Do not access any administrative service directly. Instead: Accept that the API is public accessible, and therefore design it as such and handle user authentication by your self. Example: Use Server-Side code (PHP etc) as the only interface to your internal services like DBs As you can see, as long as you store the API keys (accessing external services from 3th parties) local on the users hard drive, it is insecure as hell. Obfuscation is very often easy to break - especally when the source is open accessible like here. On the other hand, even without the source, netowork sniffers offer an easy way to grab such keys. You could either force the user to be responsible for his own key (each user has a unique key). If this is not possible, you are forced to use a proxy server, which will offer the same interface as the API but has a custom authentication system. If a user has authenticated successfully, you simply redirect requests to the real API service and using the key only server side. This way, you can also deal with leaked user accounts - if a user account does access from multiple ips at the same time you can block them easily. Personally, I would base every online system with server side authentication. This is the only secure way. Virtually any offline system can not be protected, you just can obfuscate things - refer to cracked Games etc. #13 - Posted 26 July 2012 - 12:03 PM securityvision.ch DBA (OOP-SQL DataBase access Framework for SQLite, MySQL, and ADO) Back to top fragman Members 1591 posts Last active: Nov 12 2012 08:51 PM Joined: 13 Oct 2009 That's what I thought so far as well, I was just wondering if there were better local methods I'm only concerned about some Google APIs and an image hoster API, but it's still bothersome... #14 - Posted 26 July 2012 - 02:03 PM Back to top IsNull Moderators 990 posts Last active: May 15 2014 11:56 AM Joined: 10 May 2007 I've added an native shellcode to search for the pattern in the dump. (Credits @ Mr. Laszlo) If you are using 64bit AHK, the 64bit version of the shellcode doesnt work so well, thus for now a separate dll is required. (It will be downloaded automatically) C++  __declspec(dllexport) long __cdecl PatternScan(unsigned char *targetBuffer, unsigned long targetSize, unsigned char *needle, unsigned long needleSize);   long PatternScan(unsigned char *targetBuffer, unsigned long targetSize, unsigned char *pattern, unsigned long patternSize){ 	 	long pos = -1; 	int iPattern = 0;  	for(int i = 0; i < targetSize; i++) 	{ 		if(targetBuffer[i] == pattern[iPattern]) 		{ 			 			// the byte matches our pattern 			// check if we are done (and found a match)  			if(patternSize == iPattern+1){ 				return i; 			}else 				iPattern++;  		}else 			iPattern = 0; // reset the pattern 	}  	return pos; }  The speed-improvement is enormous #15 - Posted 26 July 2012 - 05:51 PM securityvision.ch DBA (OOP-SQL DataBase access Framework for SQLite, MySQL, and ADO) Back to top Page 1 of 5 1 2 3 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"for AHK 1.1+ Forum thread:."	"true"
"Decompilers"	"AutoHotkey decompiler - classic"	"https://autohotkey.com/docs/Scripts.htm#exe2ahk"	"for AHK 1.0 does not work with password or /nodecompile protected files."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"AutoHotkey Scripts and Macros Scripts Table of Contents Introduction The Top of the Script (the Auto-execute Section): This portion executes automatically when the script starts. Escape Sequences: When to use `% and `, to indicate a literal percent sign or comma. Comments in Scripts: The use of semicolon and the symbols /*...*/ to add remarks to a script. Splitting a Long Line into a Series of Shorter Ones: This can improve a script's readability and maintainability. Convert a Script to an EXE (ahk2exe): Convert a .ahk script into a .exe file that can run on any PC. Passing Command Line Parameters to a Script: The variables %1%, %2%, etc. contain the incoming parameters. Script File Codepage: Using non-ASCII characters safely in scripts. Debugging a Script: How to find the flaws in a misbehaving script. Portability of AutoHotkey.exe: Having a copy of AutoHotkey.exe is enough to execute any .ahk file. Installer Options: How to do unattended/silent installations or uninstallations. Introduction Each script is a plain text file containing lines to be executed by the program (AutoHotkey.exe). A script may also contain hotkeys and hotstrings, or even consist entirely of them. However, in the absence of hotkeys and hotstrings, a script will perform its commands sequentially from top to bottom the moment it is launched. The program loads the script into memory line by line, and each line may be up to 16,383 characters long. During loading, the script is optimized and validated. Any syntax errors will be displayed, and they must be corrected before the script can run. The Top of the Script (the Auto-execute Section) After the script has been loaded, it begins executing at the top line, continuing until a Return, Exit, hotkey/hotstring label, or the physical end of the script is encountered (whichever comes first). This top portion of the script is referred to as the auto-execute section. A script that is not persistent and that lacks hotkeys, hotstrings, OnMessage, and GUI will terminate after the auto-execute section has completed. Otherwise, it will stay running in an idle state, responding to events such as hotkeys, hotstrings, GUI events, custom menu items, and timers. Every thread launched by a hotkey, hotstring, menu item, GUI event, or timer starts off fresh with the default values for the following attributes as set in the auto-execute section. If unset, the standard defaults will apply (as documented on each of the following pages): DetectHiddenWindows, DetectHiddenText, SetTitleMatchMode, SetBatchLines, SendMode, SetKeyDelay, SetMouseDelay, SetWinDelay, SetControlDelay, SetDefaultMouseSpeed, CoordMode, SetStoreCapslockMode, AutoTrim, SetFormat, StringCaseSense, Thread, and Critical. If the auto-execute section takes a long time to complete (or never completes), the default values for the above settings will be put into effect after 100 milliseconds. When the auto-execute section finally completes (if ever), the defaults are updated again to be those that were in effect at the end of the auto-execute section. Thus, it's usually best to make any desired changes to the defaults at the top of scripts that contain hotkeys, hotstrings, timers, or custom menu items. Also note that each thread retains its own collection of the above settings. Changes made to those settings will not affect other threads. Escape Sequences AutoHotkey's default escape character is accent/backtick (`), which is at the upper left corner of most English keyboards. Using this character rather than backslash avoids the need for double blackslashes in file paths. Since commas and percent signs have special meaning in the AutoHotkey language, use `, to specify a literal comma and `% to specify a literal percent sign. One of the exceptions to this is MsgBox, which does not require commas to be escaped. Another exception is commas in the last parameter of any command: they do not need to be escaped. See #EscapeChar for a complete list of escape sequences. Certain special characters are also produced by means of an escape sequence. The most common ones are `t (tab), `n (linefeed), and `r (carriage return). Tip: The first comma of any command may be omitted (except when the first parameter is blank or starts with := or =, or the command is alone at the top of a continuation section). For example: MsgBox This is ok. MsgBox, This is ok too (it has an explicit comma). Comments in Scripts Scripts can be commented by using a semicolon at the beginning of a line. For example: ; This entire line is a comment. Comments may also be added to the end of a command, in which case the semicolon must have at least one space or tab to its left. For example: Run Notepad  ; This is a comment on the same line as a command. In addition, the /* and */ symbols can be used to comment out an entire section, but only if the symbols appear at the beginning of a line as in this example: /* MsgBox, This line is commented out (disabled). MsgBox, This one too.  */ Since comments are ignored when a script is launched, they do not impact performance or memory utilization. The default comment character (semicolon) can be changed to some other character or string via #CommentFlag. Splitting a Long Line into a Series of Shorter Ones Long lines can be divided up into a collection of smaller ones to improve readability and maintainability. This does not reduce the script's execution speed because such lines are merged in memory the moment the script launches. Method #1: A line that starts with ""and"", ""or"", ||, &&, a comma, or a period is automatically merged with the line directly above it (in v1.0.46+, the same is true for all other expression operators except ++ and --). In the following example, the second line is appended to the first because it begins with a comma: FileAppend, This is the text to append.`n   ; A comment is allowed here.     , %A_ProgramFiles%\SomeApplication\LogFile.txt  ; Comment. Similarly, the following lines would get merged into a single line because the last two start with ""and"" or ""or"": if (Color = ""Red"" or Color = ""Green""  or Color = ""Blue""   ; Comment.     or Color = ""Black"" or Color = ""Gray"" or Color = ""White"")   ; Comment.     and ProductIsAvailableInColor(Product, Color)   ; Comment. The ternary operator is also a good candidate: ProductIsAvailable := (Color = ""Red"")     ? false  ; We don't have any red products, so don't bother calling the function.     : ProductIsAvailableInColor(Product, Color) Although the indentation used in the examples above is optional, it might improve clarity by indicating which lines belong to ones above them. Also, it is not necessary to include extra spaces for lines starting with the words ""AND"" and ""OR""; the program does this automatically. Finally, blank lines or comments may be added between or at the end of any of the lines in the above examples. Method #2: This method should be used to merge a large number of lines or when the lines are not suitable for Method #1. Although this method is especially useful for auto-replace hotstrings, it can also be used with any command or expression. For example: ; EXAMPLE #1: Var = ( Line 1 of the text. Line 2 of the text. By default, a linefeed (`n) is present between lines. )  ; EXAMPLE #2: FileAppend,  ; The comma is required in this case. ( A line of text. By default, the hard carriage return (Enter) between the previous line and this one will be written to the file as a linefeed (`n).     By default, the tab to the left of this line will also be written to the file (the same is true for spaces). By default, variable references such as %Var% are resolved to the variable's contents. ), C:\My File.txt In the examples above, a series of lines is bounded at the top and bottom by a pair of parentheses. This is known as a continuation section. Notice that the bottom line contains FileAppend's last parameter after the closing parenthesis. This practice is optional; it is done in cases like this so that the comma will be seen as a parameter-delimiter rather than a literal comma. The default behavior of a continuation section can be overridden by including one or more of the following options to the right of the section's opening parenthesis. If more than one option is present, separate each one from the previous with a space. For example: ( LTrim Join| %. Join: Specifies how lines should be connected together. If this option is omitted, each line except the last will be followed by a linefeed character (`n). If the word Join is specified by itself, lines are connected directly to each other without any characters in between. Otherwise, the word Join should be followed immediately by as many as 15 characters. For example, Join`s would insert a space after each line except the last (""`s"" indicates a literal space -- it is a special escape sequence recognized only by Join). Another example is Join`r`n, which inserts CR+LF between lines. Similarly, Join| inserts a pipe between lines. To have the final line in the section also ended by a join-string, include a blank line immediately above the section's closing parenthesis. Known limitation: If the Join string ends with a colon, it must not be the last option on the line. For example, (Join: is treated as the label ""(Join"" and (LTrim Join: is unsupported, but (Join: C is okay. LTrim: Omits spaces and tabs at the beginning of each line. This is primarily used to allow the continuation section to be indented. Also, this option may be turned on for multiple continuation sections by specifying #LTrim on a line by itself. #LTrim is positional: it affects all continuation sections physically beneath it. The setting may be turned off via #LTrim Off. RTrim0 (RTrim followed by a zero): Turns off the omission of spaces and tabs from the end of each line. Comments (or Comment or Com or C) [v1.0.45.03+]: Allows semicolon comments inside the continuation section (but not /*..*/). Such comments (along with any spaces and tabs to their left) are entirely omitted from the joined result rather than being treated as literal text. Each comment can appear to the right of a line or on a new line by itself. % (percent sign): Treats percent signs as literal rather than as variable references. This avoids the need to escape each percent sign to make it literal. This option is not needed in places where percent signs are already literal, such as auto-replace hotstrings. , (comma): Treats commas as delimiters rather than as literal commas. This rarely-used option is necessary only for the commas between command parameters because in function calls, the type of comma does not matter. Also, this option transforms only those commas that actually delimit parameters. In other words, once the command's final parameter is reached (or there are no parameters), subsequent commas are treated as literal commas regardless of this option. ` (accent): Treats each backtick character literally rather than as an escape character. This also prevents commas and percent signs from being explicitly and individually escaped. In addition, it prevents the translation of any explicitly specified escape sequences such as `r and `t. ) [v1.1.01+]: If a closing parenthesis appears in the continuation section's options (except as a parameter of the Join option), the line is reinterpreted as an expression instead of the beginning of a continuation section. This allows expressions like (x.y)[z]() to work without the need to escape the opening parenthesis. Remarks Escape sequences such as `n (linefeed) and `t (tab) are supported inside the continuation section except when the accent (`) option has been specified. When the comment option is absent, semicolon and /*..*/ comments are not supported within the interior of a continuation section because they are seen as literal text. However, comments can be included on the bottom and top lines of the section. For example: FileAppend,   ; Comment. ; Comment. ( LTrim Join    ; Comment.      ; This is not a comment; it is literal. Include the word Comments in the line above to make it a comment. ), C:\File.txt   ; Comment. As a consequence of the above, semicolons never need to be escaped within a continuation section. A continuation section cannot produce a line whose total length is greater than 16,383 characters (if it tries, the program will alert you the moment the script is launched). One way to work around this is to do a series of concatenations into a variable. For example: Var = ( ... ) Var = %Var%`n  ; Add more text to the variable via another continuation section. ( ... ) FileAppend, %Var%, C:\My File.txt Since a closing parenthesis indicates the end of a continuation section, to have a line start with literal closing parenthesis, precede it with an accent/backtick: `). A continuation section can be immediately followed by a line containing the open-parenthesis of another continuation section. This allows the options mentioned above to be varied during the course of building a single line. The piecemeal construction of a continuation section by means of #Include is not supported. Convert a Script to an EXE (ahk2exe) A script compiler (courtesy of fincs) is included with the program. Once a script is compiled, it becomes a standalone executable; that is, AutoHotkey.exe is not required in order to run the script. The compilation process creates an executable file which contains the following: the AutoHotkey interpreter, the script, any files it includes, and any files it has incorporated via the FileInstall command. Ahk2Exe can be used in the following ways: GUI Interface: Run the ""Convert .ahk to .exe"" item in the Start Menu. Right-click: Within an open Explorer window, you can right-click any .ahk file and select ""Compile Script"" (only available if the script compiler option was chosen when AutoHotkey was installed). This creates an EXE file of the same base filename as the script, which appears after a short time in the same directory. Note: The EXE file is produced using the same custom icon, .bin file and use MPRESS setting that were last used by Method #1 above. Command Line: The compiler can be run from the command line with the following parameters: Ahk2Exe.exe /in MyScript.ahk [/out MyScript.exe] [/icon MyIcon.ico] [/bin AutoHotkeySC.bin] [/mpress 0or1] For example: Ahk2Exe.exe /in ""MyScript.ahk"" /icon ""MyIcon.ico"" Usage: Parameters containing spaces should be enclosed in double quotes. If the ""out"" file is omitted, the EXE will have the same base filename as the script itself. Notes: Compiling does not typically improve the performance of a script. As of v1.1.01, password protection and the /NoDecompile switch are not supported. The commands #NoTrayIcon and ""Menu, Tray, ShowMainWindow"" affect the behavior of compiled scripts. Custom version info (as seen in Explorer's file-properties dialog) can be added to your compiled scripts by using a utility such as Resource Hacker (freeware) to edit the file ""AutoHotkeySC.bin"". This file is contained in the ""Compiler"" subfolder where AutoHotkey was installed. Compile_AHK II can be used to facilitate this process. As of v1.1.01, the compiled script can be edited instead of AutoHotkeySC.bin. The method above can also be used to change existing icons or add new ones to all compiled scripts. The built-in variable A_IsCompiled contains 1 if the script is running in compiled form. Otherwise, it is blank. When parameters are passed to Ahk2Exe, a message indicating the success or failure of the compiling process is written to stdout. Although the message will not appear at the command prompt, it can be ""caught"" by means such as redirecting output to a file. [v1.0.43+] Additionally in the case of a failure, Ahk2Exe has exit codes indicating the kind of error that occurred. These error codes can be found at GitHub (ErrorCodes.md). [v1.1.22.03+] The compiler's source code and newer versions can be found at GitHub. Compressing Compiled Scripts Ahk2Exe optionally uses MPRESS (a freeware program by MATCODE Software) to compress compiled scripts. If mpress.exe is present in the ""Compiler"" subfolder where AutoHotkey was installed, it is used automatically unless it is disabled via /mpress 0 or the GUI setting. Official website (was offline in March 2016): http://www.matcode.com/mpress.htm Mirror (downloads and information): https://autohotkey.com/mpress/ Note: While compressing the script executable prevents casual inspection of the script's source code using a plain text editor like Notepad or a PE resource editor, it does not prevent the source code from being extracted by tools dedicated to that purpose. Passing Command Line Parameters to a Script Scripts support command line parameters. The format is: AutoHotkey.exe [Switches] [Script Filename] [Script Parameters] And for compiled scripts, the format is: CompiledScript.exe [Switches] [Script Parameters] Switches: Zero or more of the following: Switch Meaning /f or /force Launch unconditionally, skipping any warning dialogs. This has the same effect as #SingleInstance Off. /r or /restart Indicate that the script is being restarted (this is also used by the Reload command, internally). /ErrorStdOut Send syntax errors that prevent a script from launching to stderr rather than displaying a dialog. See #ErrorStdOut for details. This can be combined with /iLib to validate the script without running it. Not supported by compiled scripts: /Debug [AHK_L 11+]: Connect to a debugging client. For more details, see Interactive Debugging. /CPn [AHK_L 51+]: Overrides the default codepage used to read script files. For more details, see Script File Codepage. /iLib ""OutFile"" [v1.0.47+]: AutoHotkey loads the script but does not run it. For each script file which is auto-included via the library mechanism, two lines are written to the file specified by OutFile. These lines are written in the following format, where LibDir is the full path of the Lib folder and LibFile is the filename of the library: #Include LibDir\ #IncludeAgain LibDir\LibFile.ahk If the output file exists, it is overwritten. OutFile can be * to write the output to stdout. If the script contains syntax errors, the output file may be empty. The process exit code can be used to detect this condition; if there is a syntax error, the exit code is 2. The /ErrorStdOut switch can be used to suppress or capture the error message. Script Filename: This can be omitted if there are no Script Parameters. If omitted (such as if you run AutoHotkey directly from the Start menu), the program looks for a script file called AutoHotkey.ahk in the following locations, in this order: The directory which contains the AutoHotkey executable. The current user's Documents folder. The filename AutoHotkey.ahk depends on the name of the executable used to run the script. For example, if you rename AutoHotkey.exe to MyScript.exe, it will attempt to find MyScript.ahk. If you run AutoHotkeyU32.exe without parameters, it will look for AutoHotkeyU32.ahk. Note: In old versions prior to revision 51, the program looked for AutoHotkey.ini in the working directory or AutoHotkey.ahk in My Documents. [v1.1.17+]: Specify an asterisk (*) for the filename to read the script text from standard input (stdin). For an example, see ExecScript(). Script Parameters: The string(s) you want to pass into the script, with each separated from the next by a space. Any parameter that contains spaces should be enclosed in quotation marks. A literal quotation mark may be passed in by preceding it with a backslash (\""). Consequently, any trailing slash in a quoted parameter (such as ""C:\My Documents\"") is treated as a literal quotation mark (that is, the script would receive the string C:\My Documents""). To remove such quotes, use StringReplace, 1, 1, "",, All. The script sees incoming parameters as the variables %1%, %2%, and so on. In addition, %0% contains the number of parameters passed (0 if none). However, these variables cannot be referenced directly in an expression because they would be seen as numbers rather than variables. The following example exits the script when too few parameters are passed to it: if 0 < 3  ; The left side of a non-expression if-statement is always the name of a variable. {     MsgBox This script requires at least 3 incoming parameters but it only received %0%.     ExitApp } If the number of parameters passed into a script varies (perhaps due to the user dragging and dropping a set of files onto a script), the following example can be used to extract them one by one: Loop, %0%  ; For each parameter: {     param := %A_Index%  ; Fetch the contents of the variable whose name is contained in A_Index.     MsgBox, 4,, Parameter number %A_Index% is %param%.  Continue?     IfMsgBox, No         break } If the parameters are file names, the following example can be used to convert them to their case-corrected long names (as stored in the file system), including complete/absolute path: Loop %0%  ; For each parameter (or file dropped onto a script): {     GivenPath := %A_Index%  ; Fetch the contents of the variable whose name is contained in A_Index.     Loop %GivenPath%, 1         LongPath = %A_LoopFileLongPath%     MsgBox The case-corrected long path name of file`n%GivenPath%`nis:`n%LongPath% } Known limitation: dragging files onto a .ahk script may fail to work properly if 8-dot-3 (short) names have been turned off in an NTFS file system. One work-around is to compile the script then drag the files onto the resulting EXE. Script File Codepage [AHK_L 51+] The characters a script file may contain are restricted by the codepage used to load the file. If the file begins with a UTF-8 or UTF-16 (LE) byte order mark, the appropriate codepage is used and the /CPn switch is ignored. If the /CPn switch is passed on the command-line, codepage n is used. For a list of valid numeric codepage identifiers, see MSDN. In all other cases, the system default ANSI codepage is used. Note that this applies only to script files loaded by AutoHotkey, not to file I/O within the script itself. FileEncoding controls the default encoding of files read or written by the script, while IniRead and IniWrite always deal in UTF-16 or ANSI. As all text is converted (where necessary) to the native string format, characters which are invalid or don't exist in the native codepage are replaced with a placeholder: ANSI '?' or Unicode '�'. In Unicode builds, this should only occur if there are encoding errors in the script file or the codepages used to save and load the file don't match. RegWrite may be used to set the default for scripts launched from Explorer (e.g. by double-clicking a file): ; Uncomment the appropriate line below or leave them all commented to ;   reset to the default of the current build.  Modify as necessary: ; codepage = 0        ; System default ANSI codepage ; codepage = 65001    ; UTF-8 ; codepage = 1200     ; UTF-16 ; codepage = 1252     ; ANSI Latin 1; Western European (Windows) if (codepage != """")     codepage := "" /CP"" . codepage cmd=""%A_AhkPath%""%codepage% ""`%1"" `%* key=AutoHotkeyScript\Shell\Open\Command if A_IsAdmin    ; Set for all users.     RegWrite, REG_SZ, HKCR, %key%,, %cmd% else            ; Set for current user only.     RegWrite, REG_SZ, HKCU, Software\Classes\%key%,, %cmd% This assumes AutoHotkey has already been installed. Results may be less than ideal if it has not. Debugging a Script Commands such as ListVars and Pause can help you debug a script. For example, the following two lines, when temporarily inserted at carefully chosen positions, create ""break points"" in the script: ListVars Pause When the script encounters these two lines, it will display the current contents of all variables for your inspection. When you're ready to resume, un-pause the script via the File or Tray menu. The script will then continue until reaching the next ""break point"" (if any). It is generally best to insert these ""break points"" at positions where the active window does not matter to the script, such as immediately before a WinActivate command. This allows the script to properly resume operation when you un-pause it. The following commands are also useful for debugging: ListLines, KeyHistory, and OutputDebug. Some common errors, such as typos and missing ""global"" declarations, can be detected by enabling warnings. Interactive Debugging [AHK_L 11+] Interactive debugging is possible with a supported DBGp client. Typically the following actions are possible: Set and remove breakpoints on lines - pause execution when a breakpoint is reached. Step through code line by line - step into, over or out of functions and subroutines. Inspect all variables or a specific variable. View the stack of running subroutines and functions. Note that this functionality is disabled for compiled scripts. To enable interactive debugging, first launch a supported debugger client then launch the script with the /Debug command-line switch. AutoHotkey.exe /Debug[=SERVER:PORT] ... SERVER and PORT may be omitted. For example, the following are equivalent: AutoHotkey /Debug ""myscript.ahk"" AutoHotkey /Debug=localhost:9000 ""myscript.ahk"" [AHK_L 59+]: To attach the debugger to a script which is already running, send it a message as shown below: ScriptPath = ; SET THIS TO THE FULL PATH OF THE SCRIPT DetectHiddenWindows On ifWinExist %ScriptPath% ahk_class AutoHotkey     ; Optional parameters:     ;   wParam  = the IPv4 address of the debugger client, as a 32-bit integer.     ;   lParam  = the port which the debugger client is listening on.     PostMessage DllCall(""RegisterWindowMessage"", ""str"", ""AHK_ATTACH_DEBUGGER"")  Once the debugger client is connected, it may detach without terminating the script by sending the ""detach"" DBGp command. Portability of AutoHotkey.exe The file AutoHotkey.exe is all that is needed to launch any .ahk script. [AHK_L 51+]: Renaming AutoHotkey.exe also changes which script it runs by default, which can be an alternative to compiling a script for use on a computer without AutoHotkey installed. For instance, MyScript.exe automatically runs MyScript.ahk if a filename is not supplied, but is also capable of running other scripts. Installer Options To silently install AutoHotkey into the default directory (which is the same directory displayed by non-silent mode), pass the parameter /S to the installer. For example: AutoHotkey110800_Install.exe /S A directory other than the default may be specified via the /D parameter (in the absence of /S, this changes the default directory displayed by the installer). For example: AutoHotkey110800_Install.exe /S /D=C:\Program Files\AutoHotkey If AutoHotkey was previously installed, the installer automatically detects which version of AutoHotkey.exe to set as the default. Otherwise, the default is Unicode 32-bit or Unicode 64-bit depending on whether the OS is 64-bit. To override which version of AutoHotkey.exe is set as the default, pass one of the following switches: /A32 or /ANSI: ANSI 32-bit. /U64 or /x64: Unicode 64-bit (only valid on 64-bit systems). /U32: Unicode 32-bit. For example, the following installs silently and sets ANSI 32-bit as the default: AutoHotkey110800_Install.exe /S /A32 To silently uninstall AutoHotkey, pass the /Uninstall parameter to Installer.ahk. For example: ""C:\Program Files\AutoHotkey\AutoHotkey.exe"" ""C:\Program Files\AutoHotkey\Installer.ahk"" /Uninstall For AutoHotkey versions older than 1.1.08.00, use uninst.exe /S. For example: ""C:\Program Files\AutoHotkey\uninst.exe"" /S Note: Installer.ahk must be run as admin to work correctly. Later versions of the installer include a link in the bottom-right corner to extract setup files without installing. If this function is present, the /E switch can be used to invoke it from the command line. For example: AutoHotkey110903_Install.exe /D=F:\AutoHotkey /E In silent install/uninstall mode, running scripts are closed automatically, where necessary. Pass the /R switch (requires v1.1.19.02+) to automatically reload these scripts using whichever EXE they were running on, without command line args. This option is currently not supported when using Installer.ahk to change settings. Script Showcase See this page for some useful scripts."	"null"	"null"	"for AHK 1.0 does not work with password or /nodecompile protected files."	"true"
"Integrated Development Environment"	"AHK Studio"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=300"	"SciLexer.dll based IDE for AutoHotkey."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"AHK Studio - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:31 All times are UTC-05:00 AHK Studio Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 672 posts Page 1 of 34 Jump to page: 1 2 3 4 5 … 34 Next maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 AHK Studio Report this post Quote 16 Oct 2013, 14:14 Special thanks to tidbit for the logo New GUI design and updated indent system. NOTICE! Requires AHK v1.1.23.03 or any version of 1.x greater than 23.03 I am still working on getting all of the functionality back into it from the previous version but it is stable enough to use. Download: Currently it is only in AHK 1.1 un-compiled. also a Zip can be downloaded here. Videos: A Short Demo Video tutorial on how to use the Personal Variable List Using Replacements The second two videos require plugins that can be downloaded from the Tools/Download Plugins menu If you are having trouble getting Studio to download I have a mirror on Github. Github Usage: If you wish to use this software, great. If you wish to use this as a part of your project I require payment. If you wish to donate to help me with my living expenses donations are always welcome PLEASE let me know if there is anything I should work on getting back in. Sorry I have been away and I will do what I can to update/add some screenshots. AHK Studio uses SciLexer.dll to provide a quick and easy way to program AutoHotkey scripts. Features: Run scripts from the File/Run or File/Run x64 (for those who use the 32 bit install). Easy customization of themes Edit/Theme with a few that have been created by users. I will gladly add any themes that are submitted to me. Automatic help text for most commands (eg MsgBox, Control, SplashText...etc). Code Vault for adding code snippets to the program. Version Tracker with Github upload. Gist post your scripts. Split up projects into Segments to keep things neat under File/New Segment. (makes an include file) Special functions (Move Selected Lines Down, Create Comment Block, Character Count...etc) Msgbox Creator for easily creating more complex msgboxs. Personal Variable List: You can add anything to this list and it will come up with the list of other commands as you type them. Custom Highlight List: You can add anything to this list as well and it will change the color that it appears in the program. Customize every action with a hotkey, many of them are already assigned but they can be changed under Edit/Settings. FTP integration. Auto Insert: by default it will add, <> for <, [] for [, {} for {, () for (, and '' for ' Quite a few more.Let me know what you think. I am always interested in hearing ideas to add to the script or any bugs. Thank you. Online Documentation Last edited by maestrith on 21 Apr 2016, 02:20, edited 33 times in total. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: AHK Studio Report this post Quote 16 Oct 2013, 19:03 welcome maestrith! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: AHK Studio Report this post Quote 16 Oct 2013, 19:34 joedf wrote:welcome maestrith! Thanks joedf. I have forgotten how to use the default forum AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top empardopo Posts: 326 Joined: 06 Oct 2013, 12:50 Location: Spain Contact: Contact empardopo Website Re: AHK Studio Report this post Quote 25 Oct 2013, 07:45 Very nice. I am going to take a look. Are working fine the themes? When I try download one I get this message Then, I get this when I select the downloaded theme For example, in what colour has the command msgbox appear? Thanks! Everything is possible! Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: AHK Studio Report this post Quote 03 Nov 2013, 09:14 In the theme Hat Of God I believe that all of the colors are the same. you can change them by clicking on any word in line 12 after Commands = and it will allow you to change the colors. Just be sure to use Save As and create a new theme or it will forget if you happen to click on the Hat Of God theme again. Thank you for trying out the program I hope that it is helpful. As far as the error, I will try to write the program not using the class. Thank you for pointing this out. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: AHK Studio Report this post Quote 03 Nov 2013, 09:50 Yeah, i think i have to update my themes for ahk studio also, They are a bit out of date i will make Monokai & PlasticCodeWrap available And functioning properly for the current version of AHK Studio. Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: AHK Studio Report this post Quote 03 Nov 2013, 09:54 joedf wrote:Yeah, i think i have to update my themes for ahk studio also, They are a bit out of date i will make Monokai & PlasticCodeWrap available And functioning properly for the current version of AHK Studio. Thank you for the help! I am always looking for new themes to use and also to add them to the list available to everyone to use. I think that I am going to re-write a bit of the download code so that it does not need to have an image preview, rather it will just change the currently used theme to the one on the server. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: AHK Studio Report this post Quote 03 Nov 2013, 09:55 Cool! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: AHK Studio Report this post Quote 03 Nov 2013, 11:06 0.001.52 Changed: Thanks to the bug reported by empardopo -Removed the preview for downloading themes and just made them automatically add when you click on them. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: AHK Studio Report this post Quote 03 Nov 2013, 13:58 The theme xml settings are so confusing Could i have a list of all the style numbers? eg. 33 is LineNumbers, etc. ? also i prefer saving the colors only as Hexadecimal , not Decimal... Thanks, also, why store the colors as BGR and not RGB that is also very confusing... Anyways, i did get it to sorta work, the closest possible that i could get .. Monokai: https://github.com/joedf/PlasticCodeWra ... onokai.xml PlasticCodeWrap: https://github.com/joedf/PlasticCodeWra ... deWrap.xml cheers Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top empardopo Posts: 326 Joined: 06 Oct 2013, 12:50 Location: Spain Contact: Contact empardopo Website Re: AHK Studio Report this post Quote 03 Nov 2013, 14:13 maestrith wrote:0.001.52 Changed: Thanks to the bug reported by empardopo -Removed the preview for downloading themes and just made them automatically add when you click on them. Oh Perfect! Congratulations! Very good job! Everything is possible! Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: AHK Studio Report this post Quote 03 Nov 2013, 15:27 joedf wrote:The theme xml settings are so confusing Could i have a list of all the style numbers? eg. 33 is LineNumbers, etc. ? also i prefer saving the colors only as Hexadecimal , not Decimal... Thanks, also, why store the colors as BGR and not RGB that is also very confusing... Anyways, i did get it to sorta work, the closest possible that i could get .. Monokai: https://github.com/joedf/PlasticCodeWra ... onokai.xml PlasticCodeWrap: https://github.com/joedf/PlasticCodeWra ... deWrap.xml cheers As far as the BGR rather than RGB storage goes SciLexer.dll uses the codes in BGR format and I guess I am lazy I love the new themes! They are now online to be downloaded through the program. I will see if I can make an easy way to add RGB colors with Hex codes. If it requires a total re-write to do so I do not know if I will be able to change it though. As far as the color codes I will have to compile a list because honestly I forget what they all are. I have been moving and under a lot of stress and that has pretty much triggered a reset in my brain so I will have to figure out what all of the codes are. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: AHK Studio Report this post Quote 03 Nov 2013, 17:16 rgb2bgr : vice versa (an old post by you: http://www.autohotkey.com/board/topic/6 ... rgb-issue/) here's a fork: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus color:=0xAABBCC msgbox % color:=FlipBlueAndRed(color) ;should print 0xCCBBAA msgbox % color:=FlipBlueAndRed(color) ;should print 0xAABBCC   FlipBlueAndRed(c) {    oldfrmt := A_FormatInteger    SetFormat integer , Hex    x:=(c&255)<<16 | (c&65280) | (c>>16)    SetFormat, Integer, %oldfrmt%    return x }Color codes : ill figure them out... one by one... if there's ever an issue Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: AHK Studio Report this post Quote 23 Jan 2014, 08:35 Sorry this took so long joedf. Code: [Select all] [Download] (rgb.ahk)GeSHi © Codebox Plus msgbox % rgb(0xff00cc) ;Displays 0xCC00FF msgbox % rgb(16711935) ;Displays 0xFF00FF rgb(c){ 	setformat,IntegerFast,H 	c:=(c&255)<<16|(c&65280)|(c>>16),c:=SubStr(c,1) 	SetFormat, integerfast,D 	return c } That was some old code that I had. Works the same as the one above just a bit smaller. Anyway I hope that it helps. I had my hard drive crash and I lost all of my scripts. I have spent the last few weeks re-writing a lot of what I had from scratch. :/ AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: AHK Studio Report this post Quote 23 Jan 2014, 11:34 I suggest backing up continuously to a flash drive using the script below: I had my hard drive crash and I lost all of my scripts. I have spent the last few weeks re-writing a lot of what I had from scratch. :/ Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; http://ahkscript.org/boards/viewtopic.php?f=6&t=1288   /* this is an old script, from the old forum, that allows to synchronize (mirroring or not) two directories. I ported it to Unicode adding support for long paths. It's FAST and has a lot of features:       Normal synchronization     Mirror synchronization (deleted source files are deleted on destination)     Gracefully stoppable synchronization     Exclusions of absolute paths and file/directory names for both the sync operations     Logging     Simulation     Stacking GUI for multiple scripts running     Low priority mode     Quiet mode   The ANSI CopyFileEx has a limit of MAX_PATH = 260 chars. With the Unicode version the limit is 32,767 chars.   This is the code, give it a couple of test run before using it for important stuff.   The copy should work correctly, but I don't know if commands like FileDelete, FileRemoveDir, etc. support it. I will do some tests... */   ; ---------------------------------------------------------------------------------------------------------------------- ; Name .........: SuperSynchronizer ; Description ..: A little script for incremental/mirror directory backup. ; AHK Version ..: AHK_L 1.1.13.01 x32 Unicode ; Author .......: Cyruz - http://ciroprincipe.info ; License ......: WTFPL - http://www.wtfpl.net/txt/copying/ ; Changelog ....: Oct. 20, 2011 - v0.1 - Fixed some inconsistences with reverse check exclusions. ; ..............: Oct. 26, 2011 - v0.2 - Fixed a parenthesis glitch and a problem with the reverse check routine where a ; ..............:                        file in destination side doesn't get updated if it's newer than the source side ; ..............:                        causing an incorrect mirroring. Adjusted some comments. ; ..............: May  25, 2013 - v1.0 - Code refactoring, improved logging, stacking gui, multiscript capabilities, ; ..............:                        large files handling. ; ..............: Jan. 06, 2014 - v1.1 - Code refactoring, Unicode and long path support, added simulation feature. ; ..............: Jan. 07, 2014 - v1.1 - Added exclusions by file extension. ; Functioning ..: The script is structured in two phases: ; ..............: 1. REPLICATION CHECK ; ..............:    The files on the DESTINATION SIDE are synchronized with the files on the SOURCE SIDE. ; ..............: 2. REVERSE CHECK ; ..............:    The files on the DESTINATION SIDE that don't exist on SOURCE SIDE are deleted. ; ..............:    The script can be instantiated multiple times, and the GUI will stack automatically starting from ; ..............:    the TOP-RIGHT corner. A detailed log file is createad by default in A_ScriptDir. ; How to use ...: [] Set the source and destination directory, set copy mode (enable/disable mirroring) and logging. ; ..............: [] To exclude files from the replication or reverse check, add them to the exclusion lists. ; ..............: [] Run the script. If you need to stop the script, flag ""Sure?"" checkbox and click ""Stop"" button. ; ..............: [] [] If you stop the script, the the actual processed file is deleted to allow a clean restart. ; ..............: [] The script can be run avoiding any user interaction passing the ""-quiet"" parameter on command line. ; ..............: [] [] If you close/exit/kill the script it will behave like if the script is stopped. ; ----------------------------------------------------------------------------------------------------------------------   ;#NoTrayIcon #Persistent #SingleInstance Off DetectHiddenWindows, On SetTitleMatchMode, 2   ; ====================================================================================================================== ; ===[ VARIABLES SECTION ]============================================================================================== ; ======================================================================================================================   ; SOURCE DIRECTORY ; [ STRING, ABSOLUTE PATH, NO QUOTES ] SOURCE_DIR = D:\Test   ; DESTINATION DIRECTORIES ; [ STRING, ABSOLUTE PATH, NO QUOTES ] DESTIN_DIR = D:\TestDest   ; MIRRORING - DELETE DESTINATION FILE NOT PRESENT ON SOURCE ; [ 1: ENABLED, 0: DISABLED ] MIRRORING := 1   ; SIMULATION - JUST SIMULATE THE SYNC AND UPDATE THE LOG FILE ; [ 1: ENABLED, 0: DISABLED ] SIMULATION := 1   ; LOGGING ; [ 1: ENABLED, 0: DISABLED ] LOG_ENABLED := 1   ; LOG FILE - ONLY IF LOG_ENABLED == 1, DEFAULT TO %A_ScriptDir%\%A_ScriptName%.log ; [ STRING, ABSOLUTE PATH, NO QUOTES ] LOG_FILE =   ; INTERACTIVE FLAG - USER INTERACTIVE GUI, OVERRIDE WITH ""-quiet"" PARAMETER ; [ 1: ENABLED, 0: DISABLED ] INTERACTIVE := 1   ; LOW PRIORITY ; [ 1: ENABLED, 0: DISABLED ] LOW_PRIORITY := 0   ; REPLICATION CHECK GLOBAL EXCLUSIONS - ITEMS NOT TO BE COPIED ON DESTINATION SIDE ; [ CONTINUATION SECTION, NEWLINE SEPARATED, NO QUOTES, SURROUNDED BY <>, FULL PATH OR NAME ] ; Excluded directories. EX_REPLICATION_DIRS = ( LTrim ) ; Excluded files. EX_REPLICATION_FILES = ( LTrim ) ; Excluded extensions. EX_REPLICATION_EXT = ( LTrim )   ; REVERSE CHECK GLOBAL EXCLUSIONS - ITEMS NOT TO BE DELETED ON DESTINATION SIDE ; [ CONTINUATION SECTION, NEWLINE SEPARATED, NO QUOTES, SURROUNDED BY <>, FULL PATH OR NAME ] ; Excluded directories. EX_REVERSE_DIRS = ( LTrim ) ; Excluded files. EX_REVERSE_FILES = ( LTrim ) ; Excluded extensions. EX_REVERSE_EXT = ( LTrim )   ; ====================================================================================================================== ; ===[ MAIN SECTION ]=================================================================================================== ; ======================================================================================================================   ; Parameters check. param0 = %0% param1 = %1% If ( param0 == 0 )     INTERACTIVE := 1 Else If ( param0 == 1 && param1 == ""-quiet"" )     INTERACTIVE := 0 Else {     MsgBox,, SuperSynchronizer, Usage:`t<AutoHotkey.exe SuperSynchronizer.ahk>`n`t-quiet :: Suppress any message     ExitApp }   ; Script start check. If ( INTERACTIVE ) {     Msgbox, 0x4, SuperSynchronizer, FROM:`t%SOURCE_DIR%`nTO:`t%DESTIN_DIR%`n`nStart Synchronizing?     IfMsgBox, No         ExitApp }   ; Source folder check. If ( !InStr(FileExist(SOURCE_DIR), ""D"") ) {     If ( INTERACTIVE )         MsgBox,, SuperSynchronizer, Source folder doesn't exists!     ExitApp ; Fail if source folder doesn't exists. }   ; Destination folder check. If ( !InStr(FileExist(DESTIN_DIR), ""D"") ) {     If ( SIMULATION )     {             MsgBox,, SuperSynchronizer, Cannot simulate if destination directory is not existing.             ExitApp     }     If (INTERACTIVE)     {         Msgbox, 0x4, SuperSynchronizer, Destination folder doesn't exists, create it?         IfMsgBox, No             ExitApp         FileCreateDir, %DESTIN_DIR%     }     Else ExitApp ; Fail silently if destination folder doesn't exists and !INTERACTIVE. }   ; If SIMULATION == 1, force the LOGGING to 1. (SIMULATION) ? LOG_ENABLED := 1   ; Modify the OnExit so that the ""Stop"" feature is correctly handled. OnExit, STOPSYNC   ; Adjust the priority of the current process. nPid := DllCall(""GetCurrentProcessId"") Process, Priority, %nPid%, % (LOW_PRIORITY) ? ""L"" : ""N""   ; Create the callback for the stop feature. COPY_CALLBACK := RegisterCallback(""CopyCallback"", ""Fast"")   ; Set STOP_SYNC = 0 to start the copy operation (flag ""Sure?"" and press ""Stop"" to turn STOP_SYNC = 1). STOP_SYNC := 0   If ( INTERACTIVE ) {   ; Get monitor resolution and previous windows to calculate the coordinates.     SysGet, Mon, Monitor     _X := MonRight - 388     WinGet, hWndList, LIST, SuperSynchronizer ahk_class AutoHotkeyGUI     _Y := (75 * hWndList) + 1       ; Gui management.     Gui, +LastFound +Hwndh_GUI     WinSet, Transparent, 240, ahk_id %h_GUI%     Gui, Margin, 10, 10     Gui, Add, Text, vSyncText Left w300 h55, Replicating...`n`nFROM:`t%SOURCE_DIR%`nTO:`t%DESTIN_DIR%     GuiControl, -Wrap, SyncText     Gui, Add, Checkbox, vAreYouSure x+15 y22, Sure?     Gui, Add, Button, gSTOPSYNC vSyncButton w50 h20 y+10, &Stop     Gui, -Caption +Border     Gui, Show, X%_X% Y%_Y% Autosize, SuperSynchronizer }   ; Get start timestamp. START_TIMESTAMP = %A_Now%   ; !!! REPLICATION CHECK START !!! ; ---------------------------------------------------------------------------------------------------------------------- If ( LOG_ENABLED ) ; Log management.     WriteLog(1, ""REPLICATION CHECK STARTED`n****************************************************************`n"")   SetWorkingDir, %SOURCE_DIR% bSyncStopped := ReplicationCheck(""*.*"") ; ----------------------------------------------------------------------------------------------------------------------   ; !!! REVERSE CHECK START !!! ; ---------------------------------------------------------------------------------------------------------------------- If ( MIRRORING && !bSyncStopped ) {     If ( INTERACTIVE )         GuiControl,, SyncText, Mirroring...`n`nFROM:`t%SOURCE_DIR%`nTO:`t%DESTIN_DIR%       If ( LOG_ENABLED ) ; Log management.         WriteLog(0, ""`n"")       , WriteLog(1, ""REVERSE CHECK STARTED`n****************************************************************`n"")       SetWorkingDir, %DESTIN_DIR%     bSyncStopped := ReverseCheck(""*.*"") } ; ----------------------------------------------------------------------------------------------------------------------   ; Get end timestamp and calculate elapsed time. END_TIMESTAMP = %A_Now% EnvSub, END_TIMESTAMP, START_TIMESTAMP, Seconds VarSetCapacity(TIME_ELAPSED, 18) ; XX:XX:XX + string terminator = 9 chars (UNICODE: 9*2 bytes). DllCall( ""msvcrt\swprintf"", Str,TIME_ELAPSED, Str,""%02d:%02d:%02d"", Int,Floor(END_TIMESTAMP/3600)                          , Int,Mod(END_TIMESTAMP/60,60), Int,Mod(END_TIMESTAMP,60) )   If ( INTERACTIVE ) {   ; Gui management.     Gui, Cancel     GuiControl,, SyncText, % ((bSyncStopped) ? ""Synchronization Stopped!""                                              : ""Done!"") ""`n`nTime Elapsed: "" TIME_ELAPSED     GuiControl, Hide, AreYouSure     GuiControl,, SyncButton, &Ok     GuiControl, +Default -g gGUIDESTROY, SyncButton     Gui, Show, X%_X% Y%_Y% Autosize, SuperSynchronizer     WinWaitClose, ahk_id %h_GUI% }   If ( LOG_ENABLED ) {   ; Log management - append log to the file.     If ( !LOG_FILE )         LOG_FILE := A_ScriptDir ""\"" SubStr(A_ScriptName, 1, -3) ""log""     SplitPath, LOG_FILE,, sFilePath, sFileExt, sFileName     Loop     {   ; If file exists loop until it finds a not existing filename.         If ( FileExist(LOG_FILE) )             LOG_FILE = %sFilePath%\%sFileName%_%A_Index%.%sFileExt%         Else Break     }     WriteLog(0, ""`n****************************************************************`n"")     WriteLog(1, ""SINCHRONIZATION FINISHED IN "" TIME_ELAPSED, LOG_FILE) }   ; Restore correct OnExit behaviour and exit from the script. OnExit, REALQUIT ExitApp   ; ====================================================================================================================== ; ===[ LABELS SECTION ]================================================================================================= ; ======================================================================================================================    STOPSYNC: GUICLOSE:     If ( !INTERACTIVE )     {   ; Stop synchronization if the script is not interactive.         STOP_SYNC := 1         Return     }     If ( A_GuiControl == ""SyncButton"" )     {   ; ""Stop"" button pressed, check the ""AreYouSure"" flag before stopping sync.         GuiControlGet, AreYouSure,, AreYouSure         STOP_SYNC := (AreYouSure) ? 1 : 0     }     Else     {   ; Script or GUI closed, stop synchronization.         STOP_SYNC := 1     }     Return ;GUICLOSE ;STOPSYNC    GUIDESTROY:     Gui, Destroy     Return ;GUIDESTROY    REALQUIT:     ExitApp ;REALQUIT   ; ====================================================================================================================== ; ===[ FUNCTIONS SECTION ]============================================================================================== ; ======================================================================================================================   ReplicationCheck(sPattern) {     Global SOURCE_DIR, DESTIN_DIR, EX_REPLICATION_DIRS, EX_REPLICATION_FILES, SIMULATION, LOG_ENABLED, COPY_CALLBACK          , STOP_SYNC       Loop, %sPattern%, 1     {         ; Return 1 if STOP_SYNC is set.         If ( STOP_SYNC )             Return 1           If ( InStr(FileExist(A_LoopFileFullPath), ""D"") )         {   ; It's a directory.             If ( !InStr(EX_REPLICATION_DIRS, ""<"" A_LoopFileLongPath "">"") )             && ( !InStr(EX_REPLICATION_DIRS, ""<"" A_LoopFileName     "">"") )             {   ; If directory isn't in exlusion list.                 If ( !InStr(FileExist(DESTIN_DIR ""\"" A_LoopFileFullPath), ""D"") )                 {   ; If source directory doesn't exists on destination, create it.                     If ( !SIMULATION )                     {   ; If SIMULATION is disabled.                         ; Try to delete an ""eventually present"" file that has the same name of the source directory.                         FileDelete, %DESTIN_DIR%\%A_LoopFileFullPath%                         ; Create the source directory on destination.                         FileCreateDir, %DESTIN_DIR%\%A_LoopFileFullPath%                     }                     If ( LOG_ENABLED ) ; Log management                         WriteLog( 1, (!SIMULATION && ErrorLevel)                                 ? ""ERROR >> Could not create directory: <"" DESTIN_DIR ""\"" A_LoopFileFullPath ""> $`n""                                 : ""SUCCESS >> Directory created: <"" DESTIN_DIR ""\"" A_LoopFileFullPath ""> $`n"" )                 }                 ; Recursion into current directory.                 bStopFlag := ReplicationCheck(A_LoopFileFullPath ""\*.*"")                 ; If bStopFlag is set, return 1 (it means that STOP_SYNC == 1).                 If ( bStopFlag )                     Return 1             }             Else             {   ; Directory skipped.                 If ( LOG_ENABLED ) ; Log management.                     WriteLog(1, ""SKIPPED >> Directory excluded: <"" A_LoopFileLongPath ""> $`n"")             }         }         Else         {   ; It's a file.             bCopyFlag := 0             If ( !InStr(EX_REPLICATION_FILES, ""<"" A_LoopFileLongPath "">"") )             && ( !InStr(EX_REPLICATION_FILES, ""<"" A_LoopFileName     "">"") )             && ( !InStr(EX_REPLICATION_EXT,   ""<"" A_LoopFileExt      "">"") )             {   ; If file isn't in exlusion lists.                 If ( !sFileAttr := FileExist(DESTIN_DIR ""\"" A_LoopFileFullPath) || InStr(sFileAttr, ""D"") )                 {   ; If it doesn't exists on destination or it exists and is a directory on destination, set copy flag.                     If ( !SIMULATION )                     {   ; If SIMULATION is disabled.                         ; Try to delete an ""eventually present"" directory that has the same name of the source file.                         FileRemoveDir, %DESTIN_DIR%\%A_LoopFileFullPath%, 1                     }                     ; Set copy flag.                     bCopyFlag := 1                 }                 Else                 {   ; Else it exists and is a file with the same name of the source file.                     ; Get modification time of the destination file.                     FileGetTime, sFileTime, %DESTIN_DIR%\%A_LoopFileFullPath%                     ; Calculate the difference with the modification time of the source file.                     EnvSub, sFileTime, %A_LoopFileTimeModified%, seconds                     If ( sFileTime < 0 )                     {   ; If source file is more recent than destination file.                         If ( !SIMULATION )                         {   ; If SIMULATION is disabled.                             ; Remove attributes to destination file, because CopyFileEx fails if readonly or hidden.                             FileSetAttrib, -RH, %DESTIN_DIR%\%A_LoopFileFullPath%                         }                         ; Set copy flag.                         bCopyFlag := 1                     }                 }             }             Else             {   ; File skipped.                 If ( LOG_ENABLED ) ; Log management.                     WriteLog(1, ""SKIPPED >> File excluded: <"" A_LoopFileLongPath ""> $`n"")             }             If ( bCopyFlag )             {   ; File copy.                 sDestFileLongPath = %DESTIN_DIR%\%A_LoopFileFullPath%                 If ( !SIMULATION )                 {   ; If SIMULATION is disabled.                     nReturn := DllCall( ""CopyFileEx"", Str,""\\?\"" A_LoopFileLongPath, Str,""\\?\"" sDestFileLongPath                                                     , UInt,COPY_CALLBACK, UInt,0, UInt,0, UInt,0 )                     If ( !nReturn && A_LastError == 1235 )                     {   ; If CopyFileEx failed and GetLastError == ERROR_REQUEST_ABORTED == 1235.                         If ( LOG_ENABLED ) ; Log management.                             WriteLog(1, ""STOPPED >> Copy stopped: <"" A_LoopFileLongPath ""> not copied $`n"" )                         ; Return 1 (it means that STOP_SYNC == 1).                         Return 1                     }                 }                 If ( LOG_ENABLED ) ; Log management.                     WriteLog( 1, (!SIMULATION && !nReturn)                             ? ""ERROR >> Error copying <"" A_LoopFileLongPath ""> to <"" sDestFileLongPath ""> $`n""                             : ""SUCCESS >> Copied <"" A_LoopFileLongPath ""> to <"" sDestFileLongPath ""> $`n"" )             }         }     }     Return 0 }   ReverseCheck(sPattern) {     Global SOURCE_DIR, DESTIN_DIR, EX_REVERSE_DIRS, EX_REVERSE_FILES, SIMULATION, LOG_ENABLED, COPY_CALLBACK, STOP_SYNC       bDontDeleteDirFlag := 0     Loop, %sPattern%, 1     {         ; Return 1 if STOP_SYNC is set.         If ( STOP_SYNC )             Return 1           If ( InStr(FileExist(A_LoopFileFullPath), ""D"") )         {   ; It's a directory.             If ( !FileExist(SOURCE_DIR ""\"" A_LoopFileFullPath) )             {   ; If directory doesn't exist on source side.                 If ( !InStr(EX_REVERSE_DIRS, ""<"" A_LoopFileLongPath "">"") )                 && ( !InStr(EX_REVERSE_DIRS, ""<"" A_LoopFileName     "">"") )                 {   ; If directory isn't in exlusion lists.                     ; Recurse into the directory.                     ReverseCheck(A_LoopFileFullPath ""\*.*"")                     If ( !FileExist(A_LoopFileFullPath ""\*"") )                     {   ; Remove directory only if empty.                         If ( !SIMULATION )                         {   ; If SIMULATION is disabled.                             FileRemoveDir,  %A_LoopFileFullPath%                         }                         If ( LOG_ENABLED ) ; Log management.                             WriteLog( 1, (!SIMULATION && ErrorLevel)                                     ? ""ERROR >> Could not remove <"" A_LoopFileLongPath ""> $`n""                                     : ""SUCCESS >> Directory removed: <"" A_LoopFileLongPath ""> $`n"" )                     }                     Else                     {   ; Directory excluded because not empty.                         If ( LOG_ENABLED ) ; Log management.                             WriteLog(1, ""SKIPPED >> Directory excluded because not empty: <"" A_LoopFileLongPath ""> $`n"")                     }                 }                 Else                 {   ; Directory skipped.                     If ( LOG_ENABLED ) ; Log management.                         WriteLog(1, ""SKIPPED >> Directory excluded: <"" A_LoopFileLongPath ""> $`n"")                 }             }             Else             {   ; Else directory exists in source side.                 bStopFlag := ReverseCheck(A_LoopFileFullPath ""\*.*"")                 ; If bStopFlag is set, return 1 (it means that STOP_SYNC == 1).                 If ( bStopFlag )                     Return 1             }         }         Else         {   ; It's a file.             If ( !FileExist(SOURCE_DIR ""\"" A_LoopFileFullPath) )             {   ; If file doesn't exists on source side.                 If ( !InStr(EX_REVERSE_FILES, ""<"" A_LoopFileLongPath "">"") )                 && ( !InStr(EX_REVERSE_FILES, ""<"" A_LoopFileName     "">"") )                 && ( !InStr(EX_REVERSE_EXT,   ""<"" A_LoopFileExt      "">"") )                 {   ; If file isn't in exclusion lists.                     If ( !SIMULATION )                     {   ; If SIMULATION is disabled.                         FileDelete, %A_LoopFileFullPath%                     }                     If ( LOG_ENABLED ) ; Log management.                         WriteLog( 1, (!SIMULATION && ErrorLevel)                                 ? ""ERROR >> Could not delete <"" A_LoopFileLongPath ""> $`n""                                 : ""SUCCESS >> File deleted: <"" A_LoopFileLongPath ""> $`n"" )                 }                 Else                 {   ; File skipped                     If ( LOG_ENABLED ) ; Log management.                         WriteLog(1, ""SKIPPED >> File excluded: <"" A_LoopFileLongPath ""> $`n"")                 }             }             Else             {   ; Else file exists on source side.                 If ( !InStr(EX_REVERSE_FILES, ""<"" A_LoopFileLongPath "">"") )                 && ( !InStr(EX_REVERSE_FILES, ""<"" A_LoopFileName "">"") )                 {   ; If file isn't in exclusion lists.                     FileGetTime, sFileTime, %SOURCE_DIR%\%A_LoopFileFullPath%                     EnvSub, sFileTime, %A_LoopFileTimeModified%, seconds                     If ( sFileTime != 0 )                     {   ; Check if destination file differs from source file, if yes overwrite destination file.                         sSourceFileLongPath = %SOURCE_DIR%\%A_LoopFileFullPath%                         If ( !SIMULATION )                         {   ; If SIMULATION is disabled.                             ; Remove attributes to destination file, because CopyFileEx fails if readonly or hidden.                             FileSetAttrib, -RH, %A_LoopFileLongPath%                             nReturn := DllCall( ""CopyFileEx"", Str,""\\?\"" sSourceFileLongPath                                               , Str,""\\?\"" A_LoopFileLongPath, UInt,COPY_CALLBACK, UInt,0, UInt,0                                               , UInt,0 )                             If ( !nReturn && A_LastError == 1235 )                             {   ; If CopyFileEx failed and GetLastError == ERROR_REQUEST_ABORTED == 1235.                                 If ( LOG_ENABLED ) ; Log management.                                     WriteLog(1, ""STOPPED >> Copy stopped: <"" A_LoopFileLongPath ""> not copied $`n"" )                                 ; Return 1 (it means that STOP_SYNC == 1).                                 Return 1                             }                         }                         If ( LOG_ENABLED ) ; Log management.                             WriteLog( 1, (!SIMULATION && !nReturn)                             ? ""ERROR >> Error copying <"" sSourceFileLongPath ""> to <"" A_LoopFileLongPath ""> $`n""                             : ""SUCCESS >> Copied <"" sSourceFileLongPath ""> to <"" A_LoopFileLongPath ""> $`n"" )                     }                 }                 Else                 {   ; File skipped.                     If ( LOG_ENABLED ) ; Log management.                         WriteLog(1, ""SKIPPED >> File excluded: <"" A_LoopFileLongPath ""> $`n"")                 }             }         }     }     Return 0 }   WriteLog(bAppendTime, sLogEntry, sAppendLogTo:="""") {     Static sLogData     If ( bAppendTime )         sLogData .= ""["" A_YYYY ""."" A_MM ""."" A_DD ""]"" A_Hour "":"" A_Min "":"" A_Sec "" - "" sLogEntry     Else         sLogData .= sLogEntry     If ( sAppendLogTo )         FileAppend, %sLogData%, %sAppendLogTo% }   CopyCallback(var1lo, var1hi, var2lo, var2hi, var3lo, var3hi, var4lo, var4hi, var5, var6, var7, var8, var9) {     ; 13 dummy parameters to conform to the CopyProgressRoutine     ; http://msdn.microsoft.com/en-us/library/windows/desktop/aa363854%28v=vs.85%29.aspx     Global STOP_SYNC     Return STOP_SYNC } Top tomoe_uehara Posts: 161 Joined: 05 Oct 2013, 12:37 Re: AHK Studio Report this post Quote 23 Jan 2014, 12:16 The Cloud storage is your friend, Luke! [Emoticon Database] ---> Download the latest version of AutoHotkey from here <--- Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: AHK Studio Report this post Quote 23 Jan 2014, 12:18 tomoe_uehara wrote:The Cloud storage is your friend, Luke! LOL so true. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: AHK Studio Report this post Quote 23 Jan 2014, 12:42 Haha fff...rrrieeeeennnn...ddd Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top ahk7 Posts: 72 Joined: 06 Nov 2013, 16:35 Re: AHK Studio Report this post Quote 23 Jan 2014, 17:31 maestrith wrote:I had my hard drive crash and I lost all of my scripts. I have spent the last few weeks re-writing a lot of what I had from scratch. Why not try Git(Hub)? With windows.github.com it is very easy to update your repository - http://www.sourcetreeapp.com/ is also pretty neat (but does require registration to continue to use it after 30 days, remains free though) Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: AHK Studio Report this post Quote 23 Jan 2014, 17:33 ahk7 wrote: maestrith wrote:I had my hard drive crash and I lost all of my scripts. I have spent the last few weeks re-writing a lot of what I had from scratch. Why not try Git(Hub)? With windows.github.com it is very easy to update your repository - http://www.sourcetreeapp.com/ is also pretty neat (but does require registration to continue to use it after 30 days, remains free though) I will look into it. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 672 posts Page 1 of 34 Jump to page: 1 2 3 4 5 … 34 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"SciLexer.dll based IDE for AutoHotkey."	"true"
"Integrated Development Environment"	"AutoHotFlow"	"https://www.dropbox.com/s/99cwiqpzlx4mtuz/AutoHotFlow%20Installation.exe?dl=1"	"Draw your applications. Forum thread:. GitHub."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Draw your applications. Forum thread:. GitHub."	"false"
"Integrated Development Environment"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=6399"	"Draw your applications. Forum thread:. GitHub."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"AutoHotFlow - Simply draw your applications - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:31 All times are UTC-05:00 AutoHotFlow - Simply draw your applications Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 27 posts 1 2 Next bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website AutoHotFlow - Simply draw your applications Report this post Quote 13 Feb 2015, 14:52 This script is designed to make programming and automation easy as never before! Just pull in some elements in the graphical interface and set up some triggers. Ready! AutoHotFlow This project ist made for everyone who wants to make some automation, etc. without writing long codes. It's very easy to use. You need to pull an action or a condition, configurate them and connect them. You can optionally add some triggers, that will trigger the flow in certain cases. When the flow executes the currently running elements are highlighted red. Every element has settings. There is also flow manager. It has all basic functions. I'm working on it and its abilities are raising. My aim is to include many elements that would need many lines of ahk-code and thus to allow programming some complex things easier. It could also demontrate the broad possibilities of AutoHotkey. Those elements are available by now: Spoiler Triggers: User interaction: Hotkey Shortcut Clipboard changes User idle time Time: Periodic timer Time of day User idle time Window: Window opens Window closes Window gets active Window gets inactive Process: Process starts Process closes Power: Start up Actions: Variable: New variable Copy variable Get clipboard Set clipboard Absolute number Rounding a number Random number Exponentiation Square root Trigonometry Substring Trim a string Replace a string Search a string Get string length Change character case New date Date calculation New list Add to list Get from list Delete from list Get index of element in list Shuffle list User interaction Tooltip Traytip Message box Input box Speech output Select file Select folder Flow control Sleep Set flow status Execute flow Stop flow User simulation Send keystrokes Send keystrokes to a control Click Move mouse Drag with mouse Get mouse position Window Activate window Close window Kill window Move window Show window Hide window Minimize all windows Send keystrokes to a control Get control text Set control text Process Run Kill window Kill process Set process priority Files Write to file Download file Delete file Copy file Move file Rename file Read from file Recycle file Create folder Copy folder Move folder Rename folder Delete folder Write to ini Read from ini Delete from ini Get file size Get file time Set file time Get file attributes Set file attributes Select file Select folder Empty recycle bin Sound Play sound Stop sound Beep Set volume Get volume Internet Download file Power Lock computer Log off Shutdown computer Reboot computer Hibernate computer Suspend computer For experts AutoHotKey script Conditions Variable Expression String contains text List contains element Variable is empty User interaction Confirmation dialog Key is down Process Process is running Flow control Flow enables Flow is executing Files File exists File has attribute Folder exists I'd appreciate if you will use it, test it, help me programming and /or comment this project Download current version GitHub repository Last edited by bichlepa on 01 Sep 2015, 10:08, edited 8 times in total. Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top Coco Posts: 767 Joined: 29 Sep 2013, 20:37 GitHub: cocobelgica Re: AutoHotFlow - Simple creation of little applications Report this post Quote 13 Feb 2015, 15:55 Nice Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: AutoHotFlow - Simple creation of little applications Report this post Quote 13 Feb 2015, 16:10 Very cool! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Soft Posts: 147 Joined: 07 Jan 2015, 13:18 GitHub: visionary1 Location: Seoul Contact: Contact Soft Website Re: AutoHotFlow - Simple creation of little applications Report this post Quote 13 Feb 2015, 23:48 nice visual programmig tool! may I translate this into Korean? AutoHotkey & AutoHotkey_H v1.1.22.07 Top bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website Re: AutoHotFlow - Simple creation of little applications Report this post Quote 14 Feb 2015, 04:49 Of course you can translate it! I have just created a translation tool. You can find it in the folder ""language"". It will ask you for every translation that may be needed in AutoHotFlow and show the other existing translations. Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top Soft Posts: 147 Joined: 07 Jan 2015, 13:18 GitHub: visionary1 Location: Seoul Contact: Contact Soft Website Re: AutoHotFlow - Simple creation of little applications Report this post Quote 15 Feb 2015, 04:57 @bichlepa / AutoHotkey & AutoHotkey_H v1.1.22.07 Top bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website Re: AutoHotFlow - Simple creation of little applications Report this post Quote 17 Feb 2015, 09:29 New Update with some new elements. Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website Re: AutoHotFlow - Simply draw your applications Report this post Quote 12 Mar 2015, 04:44 New update. I have included many basic elements such as mathematical functions, sting and list management. Now there is evething that is needed to do create useful flows. Please test it, use it and give feedback. Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website Re: AutoHotFlow - Simply draw your applications Report this post Quote 09 Jun 2015, 11:26 A new update is available! It contains loop elements! There are following now loops: Simple loop, loop with condition, Work through a list, parse a string, loop through files Inside a loop there are some variables available. At least a_index and some others, depending on the loop type. Similar to the loops in ahk. I will try to implement a help that will explain each element and also list the available variables inside a loop. Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website Re: AutoHotFlow - Simply draw your applications Report this post Quote 20 Jun 2015, 11:10 New update! I have written a help that explains every action, condition, trigger and loop. If you like, you may help me improving the help and make it more comprehensive. I have written it with LibreOffice. Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website Re: AutoHotFlow - Simply draw your applications Report this post Quote 15 Aug 2015, 13:20 New Update! I have implemented a new Debug Dialogue. I've also made many internal improvements, which cost me much time. Main changes: Better communication between manager and flows Every element logs everything and shows dialogue on error.I tinkered a new example flow. It is a reminder to regularly make a break. It reminds you to make 10 minutes break every hour. It consieders every short break. So, two times 5 minutes will be okay, too. Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website Re: AutoHotFlow - Simply draw your applications Report this post Quote 21 Aug 2015, 13:32 New update! I have added two new action: Seach pixel Get pixel colorAdditionally there are two new assistants. The first is for getting RGB Color IDs (either by using the system dialogue or by importing a color from screen). The second helps to find out coordinates by moving mouse on the desired position. At last I have found my old translation tool. I have modified it for AutoHotFlow. Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website Re: AutoHotFlow - Simply draw your applications Report this post Quote 01 Sep 2015, 09:53 New update! In the settings of element I have made an improvement. Near to each edit field there is now an icon which shows the content type (string, expression or variable name). When clicking on it, it shows a tooltip with a short description and examples. Furthermore AHF tries to find errors while the user is editing the element. For example, if a field musn't be empty, but currently is, a red icon shows that there is an error. The second change is the improvement of the actions ""Message box"" and ""Input box"", and the condition ""Confirmation dialog"". Here you see an example showing the improvements: At last I have improved the action ""Play sound"". Now it is possible so select a system sound. Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website Re: AutoHotFlow - Simply draw your applications Report this post Quote 03 Sep 2015, 14:19 Again a new update! To make AHF interesting to AHK coder, I start to include actions which are not trivial to implement in AHK. I seek for solutions in forum and use the found libraries in AHF. These are the new actions: HTTP Request. It allows to send any HTTP request to any server. I've used the HTTP Request functions of VxE to implement that feature. Screenshot. It allows to make a screenshot either of the whole screen, part of a screen or of a window. The screenshot is saved to file. I've used GDI+ standard library of tic for that. Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website Re: AutoHotFlow - Simply draw your applications Report this post Quote 07 Sep 2015, 05:56 New update! I have added some new actions: Eject drive. There are three ejection methods: One of them is only for CD drives. The second is the alternative method descrined in the AHK help. The disadvantage is, that the drive is ejected, even if it is in use. The third method is safe. Thanks to SKAN for the Eject function which allows to eject a drive safely. Lock or unlock drive. Probably only for CD drives. Get drive informations. Allows to get informations like label, type, free space, ... of a drive. Change drive label. List drives. It is possible to get only one drive type.And there is a new trigger: File observer. Allows to monitor a folder for changes. It can be selected, which events should trigger it. Thanks to HotKeyIt for the WatchDirectory functionThanks to just me helping me with his ScrollGUI function. I could now make the important buttons alwasys visible in the settings of element window. Previously, if a the window was high, one needed to scroll down in order to reach the Save and Cancel buttons. Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website Re: AutoHotFlow - Simply draw your applications Report this post Quote 14 Sep 2015, 10:48 New Update! Thank to the Class Monitor of jNizM, which I have extended a bit, there are now two new actions: Set monitor settings Get monitor settingsWith this you can change the brightness, contrast, gamma, color gain and color temperature. A possible application would be to reduce the sleep-consuming proportion of blue in the evening. Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top Danielsan73 Posts: 5 Joined: 07 Nov 2014, 10:20 Re: AutoHotFlow - Simply draw your applications Report this post Quote 16 Sep 2015, 02:16 i have a heavy iusses with the windows dimensions: too big and not allineate controls have to maximize and resize all of them Window. 8.1 in 1920x1080 resolution see below: How to fix it? Attachments Top bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website Re: AutoHotFlow - Simply draw your applications Report this post Quote 18 Sep 2015, 12:55 Hello Danielsan73, Thank you very much for reporting this issue. Unfortunately, I can't reproduce the problem thoug I'm using windows 8.1, too. I've also tested it on three other devices. I guess, AutoHotFlow gets a wrong screen resolution. However this still does not explain the wrong positioning of controls in the settings window. Could you please execute this test script and tell me which resolutions it shows? Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top Danielsan73 Posts: 5 Joined: 07 Nov 2014, 10:20 Re: AutoHotFlow - Simply draw your applications Report this post Quote 25 Sep 2015, 00:33 bichlepa wrote:Hello Danielsan73, Thank you very much for reporting this issue. Unfortunately, I can't reproduce the problem thoug I'm using windows 8.1, too. I've also tested it on three other devices. I guess, AutoHotFlow gets a wrong screen resolution. However this still does not explain the wrong positioning of controls in the settings window. Could you please execute this test script and tell me which resolutions it shows? here the results: MonitorPrimary: 1 MonitorWorkAreaLeft: 0 MonitorWorkArearight: 1920 MonitorWorkAreatop: 0 MonitorWorkAreabottom: 1032 A_ScreenWidth: 1920 A_ScreenHeight: 1080 VirtualWidth: 1920 VirtualHeight: 1080 in the Other my PC it work fine. Thankyou Top bichlepa Posts: 111 Joined: 15 Aug 2014, 06:44 GitHub: bichlepa Contact: Contact bichlepa Website Re: AutoHotFlow - Simply draw your applications Report this post Quote 21 Oct 2015, 14:06 New update! I've improved the actions for getting and setting the monitor settings. There is a better window management. If a settings window is opened, the main window of the editor will not be deactivated anymore. Most of the function are deactivated then until the settings window is closed. Also the message boxes which appear when exiting the application were redesigned. I did not find the reason for the problem mentioned by Danielsan73. If anybody has this problem, too, please contact me. We'll find it out. Scripting is too complicated? Try AutoHotFlow, the graphical automation tool! Written in AutoHotkey. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 27 posts 1 2 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Bing [Bot] and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"Draw your applications. Forum thread:. GitHub."	"true"
"Integrated Development Environment"	"link"	"https://github.com/bichlepa/AutoHotFlow"	"Draw your applications. Forum thread:. GitHub."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"10"	"2"	"3"	"GitHub - bichlepa/AutoHotFlow: AutoHotFlow - Simply draw your applictaions Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 2 Star 10 Fork 3 bichlepa/AutoHotFlow Code Issues 0 Pull requests 0 Pulse Graphs AutoHotFlow - Simply draw your applictaions http://ahkscript.org/boards/viewtopic.php?f=6&t=6399 25 commits 2 branches 0 releases Fetching contributors AutoHotkey 58.4% HTML 39.2% CSS 1.9% JavaScript 0.5% AutoHotkey HTML CSS JavaScript Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags AutoHotFlow-1.0 master Nothing to show Nothing to show New pull request Fetching latest commit… Cannot retrieve the latest commit at this time. Permalink Failed to load latest commit information. Documentations Editor Elements External Scripts Generated Scripts Help Icons Manager Saved Flows language temp .gitattributes .gitignore AutoHotFlow.ahk Changelog.txt Checklist before publishing.txt Editor.ahk License.txt README.md settings - Kopie.ini settings.ini test.txt README.md This script is designed to make programming and automation easy as never before! Just pull in some elements in the graphical interface and set up some triggers. Ready! 😄 This project ist made for people who never have programmed before and for those who want to make some automation, etc. without writing long codes. It's very easy to use. You need to pull an action or a condition, configurate them and connect them. You can optionally add some triggers, that will trigger the flow in certain cases. When the flow executes the currently running elements are highlighted red. Every element has settings There is also flow manager It has all basic functions. I'm working on it and its abilities are raising. My aim is to include many elements that would need many lines of ahk-code and thus to allow programming some complex things easier. It could also demontrate the broad possibilities of AutoHotkey. I'd appreciate if you will use it, test it, help me programming and /or comment this project 👋 Those elements are available by now: Triggers User interaction Hotkey Shortcut Clipboard changes User idle time Time Periodic timer Time of day User idle time Window opens Window closes Window gets active Window gets inactive Process Process starts Process closes Power Start up Actions Variable New variable Copy variable Get clipboard Set clipboard Absolute number Rounding a number Random number Exponentiation Square root Trigonometry Substring Trim a string Replace a string Search a string Get string length Change character case New date Date calculation New list Add to list Get from list Delete from list Get index of element in list Shuffle list User interaction Tooltip Traytip Message box Input box Speech output Select file Select folder Flow control Sleep Set flow status Execute flow Stop flow User simulation Send keystrokes Send keystrokes to a control Click Move mouse Drag with mouse Get mouse position Window Activate window Close window Kill window Move window Show window Hide window Minimize all windows Send keystrokes to a control Get control text Set control text Process Run Kill window Kill process Set process priority Files Write to file Download file Delete file Copy file Move file Rename file Read from file Recycle file Create folder Copy folder Move folder Rename folder Delete folder Write to ini Read from ini Delete from ini Get file size Get file time Set file time Get file attributes Set file attributes Select file Select folder Empty recycle bin Sound Play sound Stop sound Beep Set volume Get volume Internet Download file Power Lock computer Log off Shutdown computer Reboot computer Hibernate computer Suspend computer For experts AutoHotKey script Conditions Variable Expression String contains text List contains element Variable is empty User interaction Confirmation dialog Key is down Process Process is running Flow control Flow enables Flow is executing Files File exists File has attribute Folder exists Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/bichlepa/AutoHotFlow"	"Draw your applications. Forum thread:. GitHub."	"true"
"Integrated Development Environment"	"DRAKON Editor"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=3108"	"Visual programming (with DRAKON diagrams) for AutoHotkey."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"DRAKON-AutoHotkey: Visual programming with AutoHotkey - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:31 All times are UTC-05:00 DRAKON-AutoHotkey: Visual programming with AutoHotkey Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 36 posts 1 2 Next vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia DRAKON-AutoHotkey: Visual programming with AutoHotkey Report this post Quote 28 Mar 2014, 06:37 DRAKON-AutoHotkey: Visual programming with AutoHotkey What is DRAKON DRAKON is a is an algorithmic visual programming system for making complex and at the same time easy to understand algorithms. DRAKON is made for easy understanding for humans, not machines. DRAKON is used for programming software (including programming software for various space projects). Also DRAKON is used in medicine, law, business processes and in other non-programming related fields. Why DRAKON is better then any other visual programming solutions? In DRAKON clarity is above all. DRAKON is made as much ergonomic as possible, as much human readable as possible. DRAKON is very powerful and easy way for making complex algorithms. DRAKON rules for creating diagrams are cognitively optimized for easy comprehension, making it a tool for intelligence augmentation. Some facts about DRAKON: No line intersections. You will never find in DRAKON diagram two or more lines intersecting each other! Not seen in other diagramming systems! Silhouette structure. It allows to break one diagram in to several logical parts. Not seen in other diagramming systems! No slanting or curved lines. Only straight lines with right angles. Icons are placed only on vertical lines. Branching is done in a simple, visible and consistent way. Each diagram has one entry and one exit. History of DRAKON Spoiler DRAKON (Russian: ДРАКОН, backronym for Дружелюбный Русский Алгоритмический язык, Который Обеспечивает Наглядность, ""friendly Russian algorithmic language that provides clarity"") is an algorithmic visual programming language developed within the Buran space project. Its development started in 1986 and was directed by Vladimir Parondzhanov with the participation of Russian Federal Space Agency (Academician Pilyugin Center, Moscow) and Russian Academy of Sciences (Keldysh Institute of Applied Mathematics). The language was constructed by formalization, ergonomization and nonclassical structurization of flowcharts described in the ISO 5807-85 standard and Russian standard «Гост 19.701-90» and for the development of real time programs. The goal was to replace specialised languages PROL2 (ПРОЛ2) (assigned for developing onboard complex software for embedded computer system Biser-4 (Бисер-4) on board of Buran), DIPOL (ДИПОЛЬ) (assigned for developing software for ground maintenance computer system of Buran) and LAKS (ЛАКС) (assigned for modelling) used in the Buran project with one universal programming language. The work was finished in 1996 (3 years after the Buran project was officially closed), when an automated CASE programming system called ""Grafit-Floks"" was developed. This CASE is used since 1996 in many major space programs: an international project Sea Launch, Russian orbit insertion upper stage Fregat (Russian: Фрегат, frigate), upgraded heavy launch vehicle (carrier rocket) Proton-M, etc. What is DRAKON-AutoHotkey? DRAKON-AutoHotkey is a hybrid visual programming language which consists of visual part of DRAKON and textual part of AutoHotkey. You can make diagrams in DRAKON and use AutoHotkey code in icons of that diagram. More about DRAKON here: http://drakon-editor.sourceforge.net/DRAKON.pdf http://drakon-editor.sourceforge.net/language.html http://en.wikipedia.org/wiki/DRAKON What is DRAKON Editor? DRAKON Editor is free, open source and multiplatform tool for creating DRAKON diagrams and generating code from them. In most part DRAKON Editor is developed using DRAKON system. There are several software for creating DRAKON diagrams. Currently generation of AutoHotkey code from DRAKON diagrams is possible only with DRAKON Editor. DRAKON Editor main developer is Stepan Mitkin. AutoHotkey code generator for DRAKON Editor is created by me. Warning: At the moment code generation for AutoHotkey is on beta stage of development and some details is subject to change! DRAKON Editor also supports code generation for other programming languages: Java, Processing.org, D, C#, C/C++ (with Qt support), Python, Tcl, Javascript, Lua, Erlang and Verilog. Homepage of DRAKON Editor: http://drakon-editor.sourceforge.net/ GitHub of DRAKON Editor: http://github.com/stepan-mitkin/drakon_editor/ How to install DRAKON Editor: 1. Download and install latest version of ActiveTcl Free version from here: http://www.activestate.com/activetcl 2. Download DRAKON Editor from http://drakon-editor.sourceforge.net/editor.html#downloads and unpack in any location. 3. Double click drakon_editor.tcl file (is located in DRAKON Editor folder) to launch DRAKON Editor. Documentations and examples for DRAKON-AutoHotkey: Documentations for using DRAKON-AutoHotkey are located in docs\AutoHotkey folder. Read it before using AutoHotkey! If you read old version of documentation from attachment of this post then you need to read documentation from current version of DRAKON Editor, because there are substantial changes in a new AutoHotkey code generator. Examples of DRAKON-AutoHotkey are located in examples\AutoHotkey Known bugs: There is no working Foreach loop in AutoHotkey code generator. Don't try to use it until it officially added to prevent unexpected behaviour! I mean the Foreach loop of DRAKON here, not the Foreach loops of AutoHotkey! The main thread of DRAKON-AutoHotkey is this current thread. But there is also another thread about DRAKON-AutoHotkey: http://www.autohotkey.com/board/topic/1 ... utohotkey/ Please give me your feedback about AutoHotkey code generation. What you think about it? What you think need to be changed? What you think need to be added? Is there any bugs? Ask any questions you want related to DRAKON, using DRAKON Editor and AutoHotkey code generation in current thread. I will be glad to help you as much as I can. Don't Use AutoHotkey code generator and documentation from attachment of this post! They are outdated and are here only if you have diagrams that need that version of code generator! To use this old version of code generator: 1. Download and install latest version of ActiveTcl Free version from here: http://www.activestate.com/activetcl 2. Download DRAKON Editor 1.22 from here: http://sourceforge.net/projects/drakon-editor/files/ . Unpack anywhere you want. 3. Download AutoHotkey code generator.zip from the attachment and unpack it to \generators folder of DRAKON Editor. Attachments Documentation.zip (115.69 KiB) Downloaded 189 times AutoHotkey code generator beta v1.5.zip (30.85 KiB) Downloaded 237 times Last edited by vasili111 on 29 Nov 2014, 11:36, edited 11 times in total. DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: DRAKON-AutoHotkey: Space programs programming technology Report this post Quote 29 Mar 2014, 02:56 There are two videos of DRAKON Editor: and In these two videos is used another programming language, not Autohotkey. Also these videos are form old version of DRAKON Editor and new versions have some improvments. Also some screenshots: Spoiler DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: DRAKON-AutoHotkey: Space programs programming technology Report this post Quote 29 Mar 2014, 15:17 I think this question will be interesting for users of DRAKON Editor at ahkscript.org . I was asked by ObiWanKenobi at http://www.autohotkey.com/board/topic/1 ... /?p=640232 Hello vasili how do you handle return? There is only one ""End"" allowed in charts, but how would i draw several returns like für example: function my_function(a) { if (a=0) { return ""zero"" } else if (a=1) { return ""one"" } else { return ""any other"" } } My answer: I do it that way: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus my_function(a) {     if (a=0) { 	b := ""zero""     } else if (a=1) { 	b := ""one""     } else { 	b := ""any other""     }     return b } Here is DRAKON diagram for that code: In attachment you can download that diagram in .drn format (DRAKON Editor format). Attachments 1.zip (1.6 KiB) Downloaded 100 times DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: DRAKON-AutoHotkey: Space programs programming technology Report this post Quote 30 Mar 2014, 15:22 At autohotkey.com thread there was interesting question from ObiWanKenobi: Hello Vasili, what does shelf icon and connector icon mean? Currently ahkscript.org does not supports large images in posts, so I will be putting here a links of my posts at autohotkey.com : Connector icon http://www.autohotkey.com/board/topic/1 ... /?p=640352 Shelf icon http://www.autohotkey.com/board/topic/1 ... /?p=640372 Last edited by vasili111 on 02 Apr 2014, 09:02, edited 2 times in total. DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: DRAKON-AutoHotkey: Space programs programming technology Report this post Quote 01 Apr 2014, 01:23 Here is an example of using AutoHotkey with DRAKON : http://www.autohotkey.com/board/topic/1 ... /?p=640550 DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: DRAKON-AutoHotkey: Space programs programming technology Report this post Quote 03 Apr 2014, 02:08 Generator for AutoHotkey updated, beta v1.5: Added extra return to end of header and beginning of footer. Some corrections of autogenerated comments for generated code. Download links are in the attachment of first post. DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: DRAKON-AutoHotkey: Space programs programming technology Report this post Quote 19 Apr 2014, 10:11 DRAKON Editor is now on GitHub: http://github.com/stepan-mitkin/drakon_editor/ DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top toralf Posts: 426 Joined: 27 Apr 2014, 21:08 Location: Germany Re: DRAKON-AutoHotkey: Space programs programming technology Report this post Quote 02 May 2014, 16:19 Drakon is very interesting. I read the PDF and looked on the Wikipedia info. The PDF mentions Drakon-2, but I Couldn't find any info on that. As far as I understood the language so far: you write the individual AHK commands as actions but the program flow is defined grafically. I can see the use when it is essential to be error free and maintain friendly. But how are GUI programmed? 1 start 2 build GUI 3 show GUI But how do you then programm the different options the user has? I guess the switch is not the right command? Is there a visual representation in Drakon to ""list/show"" all the possible actions? How do you distinguish in Drakon between subroutines and functions? How do you hand over parameters ? ciao toralf Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: DRAKON-AutoHotkey: Space programs programming technology Report this post Quote 04 May 2014, 11:47 toralf wrote:Drakon is very interesting. I read the PDF and looked on the Wikipedia info. The PDF mentions Drakon-2, but I Couldn't find any info on that. As far as I know author of DRAKON does not using term DRAKON-2. I think that term is used by pdf autor only. There are aditional icons for realtime programming. It is possible to draw diagrams using realtime icons with DRAKON editor, but at that time there is not code generation support from them. If you are interested in realtime icons I can explain them, but as I mention before code generation is not supported by DRAKON Editor at that time. If you need to use parallel process you can use Process icon to implement it. toralf wrote:As far as I understood the language so far: you write the individual AHK commands as actions but the program flow is defined grafically. I can see the use when it is essential to be error free and maintain friendly. Exactly. All program flow is graphical only and the code for script flow is generated by DRAKON Editor from diagrams. You dont wright any program flow code. You can only use goto and/or gosub command ONLY for calling Free type diagram (See more about Free type in documentation zip file). DRAKON is extensively used in Space programs, where clarity of algorithms is at first place, where errors in code have very dramatic consequences. It is made for making as less possible errors in code as possible. toralf wrote:But how are GUI programmed? 1 start 2 build GUI 3 show GUI You are writing all commands for GUI creation inside action icons. Here is one simple GUI script example: http://www.autohotkey.com/board/topic/1 ... /?p=640550 If you need to use non standard If statments like IfMsgBox the only way to use it is to write all statement it inside action icon. Also as far as I know the AutoHotkey v2 will get remove all nonstandard If statements. If you need some other example of creating GUI with DRAKON, then please give me the AutoHotkey code for it and I will try to make DRAKON diagram for it. toralf wrote:But how do you then programm the different options the user has? I guess the switch is not the right command You mean the case when there is several options to choose from and not only YES or NO ? You can implement that using several question icons or with Switch macroicon (read more in documentations.zip that is attached to the first post). Keep in mind that I have submitted patch for next version of DRAKON Editor code generation for Switch macroicon for all supported languages (you can get development version that supports improved version of Switch macroicon form http://github.com/stepan-mitkin/drakon_editor/ . Read readme.md how to use it. Also read updated documentation form examples\AutoHotkey folder. keep in mind also that in developmet version for parameter commenting we use ;) toralf wrote:Is there a visual representation in Drakon to ""list/show"" all the possible actions? Can you please explain that question more? toralf wrote:How do you distinguish in Drakon between subroutines and functions? How do you hand over parameters ? About using subroutins, functions and hotkeys and parameters for functions please read about them in documentations.zip that is attached to the first post. If my answers need some more clarification feel free to ask. If you have some other questions I will be glad to answer. DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top Awannaknow Posts: 45 Joined: 01 Oct 2013, 08:07 SOLVED: cannot generate AHK code Report this post Quote 27 Jun 2014, 04:30 *** UPDATE *** I found out: 1- After close/reopen Drakon, all is working 2- Found in the doc (your link in your 1rst post: Doc1.docx in Documentation.zip) :""DRAKON Editor is currently tested with only AutoHotkey_L"" *** UPDATE *** Hi Vasili111, I luckily found out your thread about DRAKON and wanted to try it, downloaded and installed: 1- ActiveTcl8.6.1.0.297577-win32-ix86-threaded.exe 2- drakon_editor1.22.zip 3- AutoHotkey code generator beta v1.5.zip Other details: 1- Win XP Pro 2- AutoHotkey Unicode 32-bit 1.1.11.02 I got an error: No generator for language 'AutoHotkey_L'. here is the pic Spoiler Apparently, this ahk version, which appear on the pic as AHK_L, is not the right one to try with Drakon, which version work with Drakon ? Thanks for this DRAKON EDITOR and for help, I think I'll use it if I can make it works. This Board Remove comments and blank lines in AHK code Old autohotkey.com Board Remove comments and blank lines in AHK code Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: SOLVED: cannot generate AHK code Report this post Quote 27 Jun 2014, 10:07 Awannaknow wrote:*** UPDATE *** I found out: 1- After close/reopen Drakon, all is working 2- Found in the doc (your link in your 1rst post: Doc1.docx in Documentation.zip) :""DRAKON Editor is currently tested with only AutoHotkey_L"" *** UPDATE *** Hi Vasili111, I luckily found out your thread about DRAKON and wanted to try it, downloaded and installed: 1- ActiveTcl8.6.1.0.297577-win32-ix86-threaded.exe 2- drakon_editor1.22.zip 3- AutoHotkey code generator beta v1.5.zip Other details: 1- Win XP Pro 2- AutoHotkey Unicode 32-bit 1.1.11.02 I got an error: No generator for language 'AutoHotkey_L'. here is the pic Spoiler Apparently, this ahk version, which appear on the pic as AHK_L, is not the right one to try with Drakon, which version work with Drakon ? Thanks for this DRAKON EDITOR and for help, I think I'll use it if I can make it works. Hi Awannaknow Did you unpacked the content of AutoHotkey code generator beta v1.5.zip in the \Drakon Editor\generators folder? DRAKON Editor 1.22 works fine with AutoHotkey code generator beta v1.5. OR You can use DRAKON Editor from github https://github.com/stepan-mitkin/drakon_editor/ . There is upcoming version of DRAKON Editor. In current state it is tested by me and I think it works fine. That version has improvements of code generation for all supported languages and also has built in the newest version of AutoHotkey code generator wich also has some improvements. To use that version follow these steps: 1. Download upcoming version from here: https://github.com/stepan-mitkin/drakon ... master.zip 2. Unzip archive. 3. If you need to launch English version of DRAKON Editor delete folder \msgs . If you need Russion version of DRAKON Editor skip step 3. 4. Run drakon_editor.tcl It the folder examples\AutoHotkey\ you will find updated documentation and some examples. Please read that documentation, becose it contains some changes of AutoHotkey code generator. If something dont works after following steps above or you have any question related to DRAKON or DRAKON Editor write them here and I will help you with them. DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top Awannaknow Posts: 45 Joined: 01 Oct 2013, 08:07 Write ShortcutGetHotkey ShortcutSetHotkey with DRAKON Report this post Quote 06 Nov 2014, 03:25 Hi vasili111, Thanks for Drakon, it easier with it. I wonder if it's possible to write this 2 functions with it, I tried but can't find how. I can't really 100% understand the code, because of lack of knowledge with com, object, dll . . . Maybe it's part of why I can't write it in Drakon. just me (ahk member) just created them to find a solution for a problem I had. I past the whole code, so if you or someone wants to test it it'll be easy, but only the 2 functions (ShortcutGetHotkey and ShortcutSetHotkey) are what I try to write with drakon. Here they are: Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #NoEnv Target := A_ScriptDir . ""\TestLnk.txt"" LnkFile := A_Desktop . ""\TestLnk.lnk"" FileOpen(Target, ""w"").Close() FileCreateShortcut, %Target%, %LnkFile%, , , LnkFile Test, , b MsgBox, 0, Hotkey, % ShortcutGetHotkey(LnkFile) ShortcutSetHotkey(LnkFile, ""A"", ""Ctrl+Alt+Shift"") MsgBox, 0, Hotkey, % ShortcutGetHotkey(LnkFile) ExitApp ; ====================================================================================================================== ShortcutGetHotkey(ShortcutPath) {    SplitPath, ShortcutPath, Name, Dir    Shell := ComObjCreate(""Shell.Application"")    ShellLink := Shell.NameSpace(Dir).ParseName(Name).GetLink    HK := ShellLink.Hotkey    Key := Chr(DllCall(""User32.dll\MapVirtualKey"", ""UInt"", HK & 0xFF, ""UInt"", 2, ""UInt""))    HK >>= 8    Mods := (HK & 2 ? ""Ctrl+"" : """") . (HK & 4 ? ""Alt+"" : """") . (HK & 1 ? ""Shift+"" : """")    Return (Mods . Key) } ; ====================================================================================================================== ShortcutSetHotkey(ShortcutPath, Key, Modifiers := """") {    Static ModValues := {Alt: 4, Ctrl: 2, Shift: 1}    Key := DllCall(""User32.dll\VkKeyScan"", A_IsUnicode ? ""UShort"" : ""UChar"", Asc(Key), ""Short"") & 0xFF    If (Key = 0xFF)       Return False    ModArray := StrSplit(Modifiers, ""+"")    If (ModArray.MaxIndex() < 2) || (ModArray.MaxIndex() >  3)       Return False    Mods := 0    For Each, Mod In ModArray       Mods |= (M := ModValues[Mod]) ? M : 0    If Mods In 0,1,2,4       Return False    SplitPath, ShortcutPath, Name, Dir    Shell := ComObjCreate(""Shell.Application"")    ShellLink := Shell.NameSpace(Dir).ParseName(Name).GetLink    ShellLink.Hotkey := (Key | (Mods << 8))    ShellLink.Save    Return True } This Board Remove comments and blank lines in AHK code Old autohotkey.com Board Remove comments and blank lines in AHK code Top Awannaknow Posts: 45 Joined: 01 Oct 2013, 08:07 yes no msgbox Report this post Quote 12 Nov 2014, 10:06 Any help appreciated. From example code in help file which is almost what I need to do, Code: [Select all] [Download] GeSHi © Codebox Plus MsgBox, 4,, Would you like to continue? (press Yes or No) IfMsgBox Yes     MsgBox You pressed Yes. else     MsgBox You pressed No. I tried this, and lots of variations, but not working: This is working, but surely not the correct way of doing it: Thanks in advance. This Board Remove comments and blank lines in AHK code Old autohotkey.com Board Remove comments and blank lines in AHK code Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: DRAKON-AutoHotkey: Space programs programming technology Report this post Quote 12 Nov 2014, 14:44 Hi Awannaknow I cant tell you anything about two AutoHotkey functions that you posted above because I don't understand it (I don't know how to use com, object, dll and etc. with AutoHotkey). But, actually any AutoHotkey code can be converted to DRAKON-AutoHotkey (hybrid language, AutoHotkey with DRAKON) with DRAKON Editor. But because AutoHotkey has several different If (IfXXX, like IfMsgBox and etc.) statements and currently AutoHotkey code generation with DRAKON Editor supports only regular If statement, we can't use directly not regular If statments (like IfMsgBox and etc). But there are two other ways we can use them: First, as you mentioned before: Just remember any code that is inside Action icon is always directly sent to generated .ahk file as is. Second: The idea above is that, in Action icon we put code with not regular If statement which will assign the result to the variable. After that we can use that variable in DRAKON If icon or in DRAKON Switch macroicone (Select/Case icons). So that way we can manage the result in DRAKON way. For, example we can: In above example, in any way we are not changing Action icon which assigns variable. We operate with the result of that action icon in DRAKON way. I understand that it is not really DRAKON way of making diagrams, because in DRAKON we should not need to use that Action icon and we should never use directly If or any other branching statements with DRAKON. But I think that because we can manage the result in DRAKON way Second method is better than First. Also, DRAKON-AutoHotkey code generator has improved and I will post last version in several days. If you have any other questions or you don't understand something that I wrote, ask and I will be glad to answer DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top Awannaknow Posts: 45 Joined: 01 Oct 2013, 08:07 Re: DRAKON-AutoHotkey: Space programs programming technology Report this post Quote 12 Nov 2014, 20:42 Everything is perfectly clear, the var=yes, var= no solution is what I will use until some new version comes out. Thanks a lot. It's perfectly usable like that, for what I want to do. I can't tell you anything about two AutoHotkey functions that you posted above because I don't understand it (I don't know how to use com, object, dll and etc. with AutoHotkey). Neither do I . . . I though I was unable to do anything concerning ahk and drakon. What a relief! About the functions, I will write them manually at the end of the code in created ahk file as I do when I code directly in an ahk file. I'm so curious to see how they looks like graphically in drakon, maybe one day . . . someone will know how to code it in drakon. And also, having them presented graphically may be helpful to understand them. This Board Remove comments and blank lines in AHK code Old autohotkey.com Board Remove comments and blank lines in AHK code Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: DRAKON-AutoHotkey: Space programs programming technology Report this post Quote 13 Nov 2014, 08:52 Awannaknow wrote:Everything is perfectly clear, the var=yes, var= no solution is what I will use until some new version comes out. As far as I know, AutoHotkey V2 will only have one If statement. All IfXXX (like IfMsgBox and etc.) will be replaced like: IfMsgBox replaced with A_MsgBoxResult. So it will be much easier to use AutoHotkey with DRAKON Editor. Awannaknow wrote:About the functions, I will write them manually at the end of the code in created ahk file as I do when I code directly in an ahk file. You dont need to add AutoHotkey code manually. Actually, you never have to edit .ahk file manually. You can put all that kind of code in Action icon in Free type diagram (look in Documentation.zip) and all code will go to generated .ahk file as is and you can call that functions from other diagrams. DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top Awannaknow Posts: 45 Joined: 01 Oct 2013, 08:07 Re: DRAKON-AutoHotkey: Space programs programming technology Report this post Quote 13 Nov 2014, 09:18 So it will be much easier to use AutoHotkey with DRAKON Editor. Good! It is already very helpful (for me). You can put all that kind of code in Action icon in Free type diagram Yes, of course! I didn't thought about doing it like that when I wrote my answer. This Board Remove comments and blank lines in AHK code Old autohotkey.com Board Remove comments and blank lines in AHK code Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: DRAKON-AutoHotkey: visual programming with AutoHotkey Report this post Quote 28 Nov 2014, 10:50 1. First post of this thread updated. 2. New version of DRAKON Editor with current version of AutoHotkey code generator added (see the section ""How to install DRAKON Editor"" of the first post of current thread). DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: DRAKON-AutoHotkey: Visual programming with AutoHotkey Report this post Quote 29 Nov 2014, 10:20 1. New version of DRAKON Editor released, v 1.24! It has built in correct version of AutoHotkey code generator. Download it from: http://drakon-editor.sourceforge.net/editor.html#downloads 2. If you read old version of documentation from attachment of first post of this thread, then you need to read documentation from current version of DRAKON Editor (located in docs\AutoHotkey folder), because there are substantial changes in a new AutoHotkey code generator. 3. You can check some examples of DRAKON-AutoHotkey from examples\AutoHotkey folder. DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: DRAKON-AutoHotkey: Visual programming with AutoHotkey Report this post Quote 03 Dec 2014, 09:09 Example Screenshot of the diagram for calculation Fibonacci numbers DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 36 posts 1 2 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Bing [Bot] and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"Visual programming (with DRAKON diagrams) for AutoHotkey."	"true"
"Integrated Development Environment"	"Notepad++ for AutoHotkey"	"https://autohotkey.com/boards/viewtopic.php?f=7&t=50"	"Setup for popular code editor Notepad++ for AutoHotkey."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Setup Notepad++ for AutoHotkey - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Tutorials Search It is currently 15 Jul 2016, 16:31 All times are UTC-05:00 Setup Notepad++ for AutoHotkey Helpful script writing tricks and HowTo's Post Reply Email topic Print view Search Advanced search 62 posts 1 2 3 4 Next jNizM Posts: 1581 Joined: 30 Sep 2013, 01:33 GitHub: jNizM Location: Germany Setup Notepad++ for AutoHotkey Report this post Quote 01 Oct 2013, 04:15 Setup Notepad++ for AutoHotkey (tested up to Notepad++ v6.9.1) [Syntax-Highlighting] 1. Download userDefineLang_AHK.xml as raw (Right-click and choosing save as target...) 2. Save it to the right location (C:\Program Files (x86)\Notepad++\userDefineLang_AHK.xml) 3. Start Notepad++ and click on Menu Language --> Define your language 4. Import your userDefineLang 5. Restart Notepad++ - Default Theme ( Download | Preview ) - Lazy Theme ( Download | Preview ) [Auto-Completion] 1. Download AutoHotkey.xml as raw (Right-click and choosing save as target...) 2. Save it to the right location (C:\Program Files (x86)\Notepad++\plugins\APIs\) 3. Start Notepad++ and click on Menu Settings --> Preferences 4. Click on Auto-Completion and activate Enable auto-completion on each input 5. (recommendation: From 2th character, Function completion, Function parameters hint on input) - Autocomplete ( Download | Preview ) [Plugins] If the Plug-In is not available throw the Plugin Manager (Menu Plugins --> Plugin Manager) use following steps to install a Plugin: 1. Download PlugIns 2. Save it to the right location (C:\Program Files (x86)\Notepad++\plugins\) Notepad++ loads plugins at startup. To load a new plugin, you can either close and restart Notepad++, or use the Settings --> Import --> Import plugin command. Useful Plug-in's * (AutoSave) allows to automatically save the currently open files based on a timer schedule (default is 1 min) and/or upon the application losing focus. * (RunMe) allows to execute the currently open file, based on its shell association. * (TextFX) brings a number of useful features * (Compare Plugin) A very useful diff plugin to show the difference between 2 files (side by side). * (DBGP plugin) This is a php debugger (XDebug) which talks DBGP protocol. Use this plugin to transform your Notepad++ to a php IDE. * (Function List) offers a list of functions (or sections) according of the language of current document, in order to access to the function or section you need quickly. * (LanguageHelp) allows to run a language specific help file (CHM, HLP, PDF) and search for the keyword under the cursor. More Plugins available here and here [Set Notepad++ as default Editor for AutoHotkey Scripts] (Right Click => Edit Script) Code: [Select all] [Download] (ahk_npp.reg)GeSHi © Codebox Plus Windows Registry Editor Version 5.00   [HKEY_CLASSES_ROOT\AutoHotkeyScript\Shell\Edit\Command] @=""C:\\Program Files (x86)\\Notepad++\\notepad++.exe %1"" Code: [Select all] [Download] (ahk_npp.ahk)GeSHi © Codebox Plus RegWrite REG_SZ, HKCR, AutoHotkeyScript\Shell\Edit\Command,, C:\Program Files (x86)\Notepad++\notepad++.exe `%1 Downloads: - AutoHotkey (Current Version) - Notepad++ (Current Version) Last edited by jNizM on 22 Oct 2014, 05:28, edited 7 times in total. [AHK] 1.1.24.00 x64 Unicode [WIN] 7 Ultimate x64 SP1 | 10 Pro (10.0.10586) x64 Dropbox referrals (earn 500 MB of bonus and support me) Top empardopo Posts: 326 Joined: 06 Oct 2013, 12:50 Location: Spain Contact: Contact empardopo Website Re: Setup Notepad++ for AutoHotkey Report this post Quote 25 Oct 2013, 11:45 I have two questions... 1.- Is it possible to define Autohotkey as Default Language in New Document. It's not possible to me. 2.- Is it possible when I select Autohotkey language, notepad++ save a file ahk? 3.- How can I change the default theme? In Style configurator It doesn't appear Autohotkey language... Thanks in advance! Everything is possible! Top vahju Posts: 19 Joined: 30 Sep 2013, 16:09 Re: Setup Notepad++ for AutoHotkey Report this post Quote 27 Oct 2013, 22:35 Looks like the links are missing for the Download and preview buttons under Syntax highlighting in the first post. Top jNizM Posts: 1581 Joined: 30 Sep 2013, 01:33 GitHub: jNizM Location: Germany Re: Setup Notepad++ for AutoHotkey Report this post Quote 28 Oct 2013, 01:33 All links in the first post work! [AHK] 1.1.24.00 x64 Unicode [WIN] 7 Ultimate x64 SP1 | 10 Pro (10.0.10586) x64 Dropbox referrals (earn 500 MB of bonus and support me) Top empardopo Posts: 326 Joined: 06 Oct 2013, 12:50 Location: Spain Contact: Contact empardopo Website Re: Setup Notepad++ for AutoHotkey Report this post Quote 28 Oct 2013, 08:21 The links are OK. Download it. Installed but I have problems I mention above. I think that I'm going to check with Sublime. Thanks! Everything is possible! Top vahju Posts: 19 Joined: 30 Sep 2013, 16:09 Re: Setup Notepad++ for AutoHotkey Report this post Quote 28 Oct 2013, 22:29 jNizm sorry for the false alarm. After seeing your response I finally figured it out. Chalk this up to user error. Top wernerml Posts: 3 Joined: 27 Nov 2013, 13:40 Facebook: wernerml@gmail.com Location: Brazil Re: Setup Notepad++ for AutoHotkey Report this post Quote 27 Nov 2013, 13:58 first of all: really nice, thanks man! but i'm having a little problem here... I use a theme (that came with NPP by default), it's: ""Ruby Blue"" and it's merged with this AutoHotkey style... http://img812.imageshack.us/img812/143/rq8x.png I want to continue using this theme for all files, except .ahk files maybe there's a way to do it.. but I don't know Notepad++ very much... Top jNizM Posts: 1581 Joined: 30 Sep 2013, 01:33 GitHub: jNizM Location: Germany Re: Setup Notepad++ for AutoHotkey Report this post Quote 28 Nov 2013, 09:35 try to change the bgColor=""FFFFFF"" to this ruby blue in userDefineLang_AHK.xml bgColor = BackgroundColor eg Code: [Select all] [Download] GeSHi © Codebox Plus <WordsStyle name=""KEYWORDS1"" styleID=""4"" fgColor=""0060FF"" bgColor=""FFFFFF"" fontName="""" fontStyle=""0"" nesting=""0""/>   [AHK] 1.1.24.00 x64 Unicode [WIN] 7 Ultimate x64 SP1 | 10 Pro (10.0.10586) x64 Dropbox referrals (earn 500 MB of bonus and support me) Top wernerml Posts: 3 Joined: 27 Nov 2013, 13:40 Facebook: wernerml@gmail.com Location: Brazil Re: Setup Notepad++ for AutoHotkey Report this post Quote 28 Nov 2013, 16:09 jNizM wrote:try to change the bgColor=""FFFFFF"" to this ruby blue it stayed the same... I guess I've not explained myself too well: the backgroud is ""ruby blue"" in autohotkey scripts... I want it to be ""white??"", I want your full style working... but this ""Ruby Blue Style"" is overriding your style.... I guess it's more complicated... Top wernerml Posts: 3 Joined: 27 Nov 2013, 13:40 Facebook: wernerml@gmail.com Location: Brazil Re: Setup Notepad++ for AutoHotkey Report this post Quote 28 Nov 2013, 22:32 Ok, I've found an explanation, but I didn't understand if this is possible or not... here: http://stackoverflow.com/questions/11574590/in-notepad-set-background-color-for-file-type EDIT: Here: https://sourceforge.net/p/notepad-plus/ ... /bd2bc405/ but, again, didn't understand if they implemented this yet... EDIT 2: OK, this is not possible after all... explained here: https://sourceforge.net/p/notepad-plus/discussion/331754/thread/0f0d47af (on the last post) Top AHKxx Posts: 50 Joined: 26 Feb 2014, 01:37 Re: Setup Notepad++ for AutoHotkey Report this post Quote 26 Feb 2014, 02:47 Hey thanks. This is what I was hoping to find here. I've been using SciTE but would prefer to use NPP. But I'm finding something odd. an ahk script that appears fine in SciTE, and that AHK loads without complaint, is showing up as an error in AHK. And it's a very simple thing too. This... ^':: Send {LEFT 1}""{RIGHT 1} ...is causing everything to the right of the quote mark to display in red. If I put a semicolon immediately in front of the quote, everything is good. Any idea why that might be? It's just a plain text quote mark, and again, AHK loads and runs it just fine: for example, here: "" Any insights would be appreciated. Thanks! Top RiseUp Posts: 7 Joined: 01 Oct 2013, 21:27 Re: Setup Notepad++ for AutoHotkey Report this post Quote 03 Mar 2014, 21:31 AHKxx wrote:This... ^':: Send {LEFT 1}""{RIGHT 1} ...is causing everything to the right of the quote mark to display in red. If I put a semicolon immediately in front of the quote, everything is good. Any idea why that might be? It's just a plain text quote mark, and again, AHK loads and runs it just fine: for example, here: "" Any insights would be appreciated. Thanks! AHKxx, Notepad++ is coloring everything after the double quotation mark ("") red because it thinks that's all a string in your code. It only stops the red coloring after it encounters another double quotation mark which would normally signify the end of a string. For your particular case where the quotes are not there to mark a string, it's a bug in NP's AHK language setup, and unfortunately I do not know how to fix it. However, I have a workaround that I use and maybe it will work for you. Change that line of code to: Code: [Select all] [Download] GeSHi © Codebox Plus ^':: Send {LEFT 1}""{RIGHT 1}  ;"" The second quotation mark will tell NP++ to stop coloring things red after it, and AHK will ignore it because it's commented out. Hope that helps! Top AHKxx Posts: 50 Joined: 26 Feb 2014, 01:37 Re: Setup Notepad++ for AutoHotkey Report this post Quote 07 Mar 2014, 00:30 RiseUp wrote:However, I have a workaround that I use and maybe it will work for you. Change that line of code to: Code: [Select all] [Download] GeSHi © Codebox Plus ^':: Send {LEFT 1}""{RIGHT 1}  ;"" The second quotation mark will tell NP++ to stop coloring things red after it, and AHK will ignore it because it's commented out. Hope that helps! Hey RiseUp. Thanks much for your reply and the explanation... and the workaround! It worked like a charm! I will watch out for that in the future. Top RiseUp Posts: 7 Joined: 01 Oct 2013, 21:27 Re: Setup Notepad++ for AutoHotkey Report this post Quote 19 Mar 2014, 18:25 AHKxx wrote:Hey RiseUp. Thanks much for your reply and the explanation... and the workaround! It worked like a charm! I will watch out for that in the future. You're welcome. Top vangogh Posts: 3 Joined: 16 May 2014, 06:05 Re: Setup Notepad++ for AutoHotkey Report this post Quote 16 May 2014, 06:09 hi there, Thanks for the scripts! on a related note, i'd like to check if there's a black/dark theme that can be adapted directly for use? currently, the styling is pretty illegible under a dark background as seen below: i'm hoping for styling that's similar to SciTe4AHK: Thank you.! Top alllala Posts: 13 Joined: 03 Apr 2014, 05:04 Re: Setup Notepad++ for AutoHotkey Report this post Quote 07 Aug 2014, 10:10 Does this work with NP++ 6.6.2? Could not get it to work. I´m still using NP++ 6.1.4 because I´m so used to the syntax Highlighting Top jNizM Posts: 1581 Joined: 30 Sep 2013, 01:33 GitHub: jNizM Location: Germany Re: Setup Notepad++ for AutoHotkey Report this post Quote 08 Aug 2014, 00:33 I use Notepad++ v6.6.8 and it works [AHK] 1.1.24.00 x64 Unicode [WIN] 7 Ultimate x64 SP1 | 10 Pro (10.0.10586) x64 Dropbox referrals (earn 500 MB of bonus and support me) Top raron Posts: 18 Joined: 11 Aug 2014, 00:50 Re: Setup Notepad++ for AutoHotkey Report this post Quote 12 Aug 2014, 22:41 Using Notepad++ 6.6.7. Nice links from OP, but the ""Function List"" plugin don't seem to work, unfortunately. Btw, attached is my dark themed AutoHotkey syntax highlighting atm. Bit of a mix from here and there and (tried to) fixed it up a bit now - OK, I might have gone a bit overboard with the colors maybe... (I like colors ) And it's not perfect, trouble with lines with a single percent sign in them for one. Also, using the font Consolas, obtainable from here: http://www.microsoft.com/en-us/download ... x?id=17879 I'm also liking the ""Lucida Console"", which I think I just had on my system (Win 7). Both monospaced. I didn't set the font in the AHK syntax coloring file. Just set it in the menu Settings - Style configurator - Global styles - Default style - Font style (And no global overrides). Attachments Notepad++ rarons AutoHotKey syntax highlighting.rar WIP - my current AutoHotkey syntax highlight colors. (3.19 KiB) Downloaded 725 times Top Congsinh Posts: 3 Joined: 02 Sep 2014, 03:58 Re: Setup Notepad++ for AutoHotkey Report this post Quote 02 Sep 2014, 12:15 It work, thank you! @}-;-- Close your eyes and your will find ... The passage out of the dark ~~~: Ahk e.g | Cheat Age 3 | Cheat Plants vs Zombies 2 Top berban Posts: 26 Joined: 14 Apr 2014, 03:20 Make default ahk editor (via ""edit"" context menu in explorer Report this post Quote 18 Oct 2014, 22:40 When SciTE4AutoHotkey installs, there's a prompt to ask if you want to set it as the default ahk editor. This means ahk files will open in SciTE instead of notepad when you right click > edit in windows explorer, or when you use the ""Edit"" command in ahk. I changed the following keys in the registry to mimic this behavior. I'm not sure what the difference between the two is but I changed both for good measure. Code: [Select all] [Download] GeSHi © Codebox Plus Computer\HKEY_CLASSES_ROOT\AutoHotkeyScript\Shell\Edit\Command Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AutoHotkeyScript\Shell\Edit\Command But do you know of any more user friendly way to accomplish this? Also... I have been unable to get the autocomplete to work. It only completes words that have been previously entered. I followed the steps in the first post - AutoHotkey.xml is in the right dir, the autocomplete setting is checked. Any ideas? :S Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 62 posts 1 2 3 4 Next Return to “Tutorials” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Xtra and 6 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"Setup for popular code editor Notepad++ for AutoHotkey."	"true"
"Integrated Development Environment"	"SciTE4AutoHotkey"	"http://fincs.ahk4.net/scite4ahk/"	"SciTE-based IDE for AutoHotkey."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"86"	"19"	"24"	"GitHub - fincs/SciTE4AutoHotkey: SciTE distribution for AutoHotkey Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 19 Star 86 Fork 24 fincs/SciTE4AutoHotkey Code Issues 7 Pull requests 0 Wiki Pulse Graphs SciTE distribution for AutoHotkey http://fincs.ahk4.net/scite4ahk/ 287 commits 2 branches 13 releases Fetching contributors AutoHotkey 86.9% HTML 8.5% Lua 4.6% AutoHotkey HTML Lua Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags edge master Nothing to show v3.0.06.01 v3.0.06 v3.0.05.01 v3.0.05 v3.0.04.01 v3.0.04 v3.0.03 v3.0.02 v3.0.01.01 v3.0.01 v3.0.00 v3.0.00-rc1 v3.0-beta5 Nothing to show New pull request Latest commit c4baf1e Nov 27, 2015 fincs Merge pull request #18 from hjhj3686/patch-1 … Korean Translate update Permalink Failed to load latest commit information. installer Setup: allow users to unmark the checkboxes after they've been marked Jun 26, 2015 scipatches Upgrade to SciTE/Scintilla 3.6.0 Aug 4, 2015 source Korean Translate update Nov 26, 2015 .gitignore v1.1.17: add Format() Dec 27, 2014 README.md Rewrite Active Window Info in script, remove AutoScriptWriter Jul 6, 2013 SciTEDirectory.properties General cleanup, see details Nov 3, 2012 README.md SciTE4AutoHotkey Introduction SciTE4AutoHotkey is a SciTE-based AutoHotkey script editor. It offers: Syntax highlighting Code folding Calltips (also known as IntelliSense) AutoComplete AutoIndent AutoHotkey help integration Abbreviations Debugging support Tools for AutoHotkey scripting A toolbar that enables easy access to the tools Some AutoHotkey scripting facilities Git importing status Complete. The recommended ""setup"" procedure is fetching the repository somewhere. *.exe, *.dll, *.chm, *.bak and *.db are already discarded by .gitignore. Building SciTE4AutoHotkey In order to do so, follow the instructions in the scipatches folder. When done building, copy SciTE.exe and SciLexer.dll to the /source folder. GenDocs v3.0 must be placed in a SciTE/tools/GenDocs/ folder. You must also build the documentation and place it in the source folder. The latest AutoHotkey Unicode 32-bit binary also needs to be placed in the source folder, as InternalAHK.exe. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/fincs/SciTE4AutoHotkey"	"SciTE-based IDE for AutoHotkey."	"true"
"Integrated Development Environment"	"SublimeAutoHotkey"	"https://github.com/ahkscript/SublimeAutoHotkey"	"AutoHotkey AHK language package for SublimeText including syntax highlighting, comments toggling, auto-completions, build system definitions, commands for ahkrun, ahkcompile, ahkrunpiped."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"81"	"44"	"13"	"GitHub - ahkscript/SublimeAutoHotkey: AutoHotkey AHK language package for SublimeText including syntax highlighting, comments toggling, auto-completions, build system definitions, commands for ahkrun, ahkcompile, ahkrunpiped. Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 44 Star 81 Fork 13 ahkscript/SublimeAutoHotkey Code Issues 5 Pull requests 0 Pulse Graphs AutoHotkey AHK language package for SublimeText including syntax highlighting, comments toggling, auto-completions, build system definitions, commands for ahkrun, ahkcompile, ahkrunpiped. 50 commits 1 branch 25 releases Fetching contributors JavaScript 93.0% Python 7.0% JavaScript Python Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show 1.7.1 1.7.0 1.6.0 1.5.3 1.5.2 1.5.1 1.3.4 1.3.3 1.3.2 1.3.1 1.3.0 1.2.9 1.2.8 1.2.7 1.2.6 1.2.5 1.2.4 1.2.3 1.2.2 1.2.1 1.2.0 1.1.2 1.1.1 1.1.0 1.0.0 Nothing to show New pull request Latest commit 6ba0aed May 18, 2016 robertcollier4 allow whitespace before comment.line.ahk and functionline.ahk Permalink Failed to load latest commit information. .gitignore Rewrite and optimize language file Jun 12, 2013 AHK-PerformanceHeader.sublime-snippet Fixes #3 Aug 22, 2013 AHK-TrayIcon.sublime-snippet AHK-TrayIcon snippet autodetects icon with name of file Jul 13, 2013 AutoHotkey.sublime-build Remove trailing JSON list comma in AutoHotkey.sublime-build May 3, 2016 AutoHotkey.sublime-completions Remove trailing JSON list comma in AutoHotkey.sublime-build May 4, 2016 AutoHotkey.sublime-settings Iterate over sequential list instead of using named keys from diction… May 3, 2016 AutoHotkey.tmLanguage allow whitespace before comment.line.ahk and functionline.ahk May 18, 2016 Comments.tmPreferences Added ahkcompile command and build variant Jun 20, 2013 Default.sublime-commands Added ahkcompile command and build variant Jun 19, 2013 Main.sublime-menu Remove trailing JSON list comma in AutoHotkey.sublime-build May 4, 2016 README.md Remove trailing JSON list comma in AutoHotkey.sublime-build May 4, 2016 UNLICENSE.txt Added UNLICENSE.txt Jan 7, 2015 ahkexec.py Iterate over sequential list instead of using named keys from diction… May 4, 2016 README.md SublimeAutoHotkey - Syntax Package for Sublime Text 2/3 AutoHotkey AHK language package for SublimeText including syntax highlighting, comments toggling, auto-completions, build system definitions, commands for ahkrun, ahkcompile, ahkrunpiped. Package Installation Manual method: Download ZIP from github. Extract the files to Sublime_Data_Dir\Packages\AutoHotkey Automatic method: Install AutoHotKey with Package Control. Key Bindings If you have the default Sublime keybindings intact, then: Ctrl+B will run the current file (with AutoHotkey.exe) Ctrl+Shift+B will compile the current file (with Ahk2Exe.exe) Advanced Configuration For the build system and ahkrun, ahkrunpiped, and ahkcompile commands, if you have a non-default installation then you will need to set your specific path to AutoHotkey.exe and Ahk2Exe.exe in a file named AutoHotkey.sublime-settings in your User folder. You can access these settings file from the Menu Preferences > Package Settings > AutoHotkey. You should make a copy of AutoHotkey Settings - Default at AutoHotkey Settings - User and modify there since then any settings defined in your User folder will take precedence and the package can still update itself without overwriting your custom settings. ahkrunpiped The ahkrunpiped command will allow you to run your code as a piped text string to AutoHotkey (this allows you to run snippets of code without having to save them to a file): If text is selected - ahkrunpiped will pipe and run the selected text only. If no text is selected - ahkrunpiped will pipe and run the entire contents of the current document. Goto-documentation Integration Instructions on how to configure goto-documentation plugin for AutoHotkey (F1 Hotkey will take you to documentation for word under cursor) http://www.autohotkey.com/board/topic/46447-sublime-text-editor-very-nice/page-3#entry540187 Credits S0und: http://www.autohotkey.com/board/topic/46447-sublime-text-editor-very-nice/page-2#entry529723 Misc: http://www.sublimetext.com/forum/viewtopic.php?f=2&t=4008 Misc: http://www.autohotkey.com/board/topic/44924-yatmb4ahk-yet-another-textmate-bundle-for-ahk/ ahkrunpiped, Coco: https://gist.github.com/cocobelgica/6296475 ahkrunpiped, greycode: https://gist.github.com/grey-code/4728413 ahkrunpiped, Lexikos: http://www.autohotkey.com/board/topic/23575-how-to-run-dynamic-script-through-a-pipe/ Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/ahkscript/SublimeAutoHotkey"	"AutoHotkey AHK language package for SublimeText including syntax highlighting, comments toggling, auto-completions, build system definitions, commands for ahkrun, ahkcompile, ahkrunpiped."	"true"
"Integrated Development Environment"	"Sublime 4 AutoHotkey"	"https://autohotkey.com/board/topic/91066-sublime-4-autohotkey-updated-1311/"	"Sublime 4 AutoHotkey is a patch for Sublime Text text editor which adds support for AutoHotkey. - (discontinued)"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"29"	"8"	"12"	"GitHub - aviaryan/AutoHotkey: (Discontinued) Sublime Text Autohotkey package. Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 8 Star 29 Fork 12 aviaryan/AutoHotkey Code Issues 0 Pull requests 0 Pulse Graphs 🔣 (Discontinued) Sublime Text Autohotkey package. https://github.com/ahkscript/SublimeAutoHotkey 22 commits 1 branch 0 releases Fetching contributors JavaScript 96.5% AutoHotkey 3.5% JavaScript AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit 51458eb Jun 18, 2015 aviaryan Discontinued Permalink Failed to load latest commit information. Auto-Complete Adder.ahk Package Restructured May 21, 2013 Autohotkey.sublime-build case correction and minor completions update. fixes #5 Oct 3, 2013 Autohotkey.sublime-completions case correction and minor completions update. fixes #5 Oct 3, 2013 Autohotkey.sublime-settings Autohotkey.tmLanguage case correction and minor completions update. fixes #5 Oct 3, 2013 Avis Autohotkey - Dark.tmTheme Avis Autohotkey - Light.tmTheme case correction and minor completions update. fixes #5 Oct 3, 2013 Comments.tmPreferences Package Restructured May 21, 2013 HatofGod.tmTheme Added more keywords + new theme Jul 24, 2013 Readme.md Discontinued Jun 18, 2015 Symbol List%3A Methods.tmPreferences Package Restructured May 21, 2013 Symbols.tmPreferences Readme.md AutoHotkey Sublime-Text Package (Discontinued) Important Note This project is discontinued. Please use AHKScript's official AutoHotkey package. It's also available on the Package Control. Installing If you have Package Control installed, in command palette type Package Control: Add Repository Then add https://github.com/Avi-Aryan/AutoHotKey to it. Now, the package will be available for Install. If you don't have Package control, you can download the zip and replace the package with the default Autohotkey Package if you have. Brief This is a Autohotkey package for Sublime Text. It has better Auto-Completes , Syntax-Highlighting and Language Files plus bonus custom themes and ahk scripts to make it even better. Tips Make sure to change AutoHotKey.sublime-build according to your requirements. Use Auto-Complete Adder to add custom Auto-completes. Dont worry about two Msgbox's in Autocomplete. <blank> is for Msgbox,text ;(used in testing) whereas other is for the whole long command. Similarly Loop has 5 variants each for general, reading files and folders , parsing a string ,registry reading and reading lines from file . Contributors denofle Ragnar budRich (Hat of God theme) Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/avi-aryan/autohotkey"	"Sublime 4 AutoHotkey is a patch for Sublime Text text editor which adds support for AutoHotkey. - (discontinued)"	"true"
"GUI WYSIWYG Builders"	"AutoGUI"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=10157"	"by alguimist - WYSIWIG GUI Designer and Script Editor"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"AutoGUI - GUI Designer and Script Editor - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:31 All times are UTC-05:00 AutoGUI - GUI Designer and Script Editor Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 140 posts Page 1 of 7 Jump to page: 1 2 3 4 5 … 7 Next Alguimist Posts: 43 Joined: 05 Oct 2015, 16:41 AutoGUI - GUI Designer and Script Editor Report this post Quote 05 Nov 2015, 15:15 AutoGUI is an integrated development environment for AutoHotkey which combines a GUI designer with a script editor. Usage: To insert a control, first choose the type of control in the toolbox and then click in the desired location in the child window. Hold Shift while dragging to resize the control. Use the arrow keys to make fine adjustments in the position of the control. Middle-click a control to access its properties. Right-click a control to show the context menu. Click and hold the left mouse button while dragging in an empty area of the window to draw a selection rectangle. To select a control, hold the Ctrl key while clicking on it. Press Ctrl+A to select all controls. To import a GUI script, use the Window Cloning Tool (F8). This is the preferred method. Press F9 to test the script. Press Ctrl+F9 to run the file from the saved location. Press F10 to open the properties dialog (incomplete). Press F11 to toggle the visibility of the child window. Press F12 to switch between Design Mode and Editor Mode.Remarks: This is a work in progress. Some features are partially implemented. The script generated by the GUI designer is output in the first tab only.Download Tested on Windows XP/7/8/10. AutoHotkey Unicode 32-bit. Top TheDewd Posts: 462 Joined: 19 Dec 2013, 11:16 Location: USA Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 05 Nov 2015, 15:52 Very Impressive! Looking forward to the advancement of this script!! Awesome! Windows 7 Enterprise SP1 64-bit, Intel i7-4810MQ @ 2.80GHz, 8GB DDR3 RAM Windows 10 Home 64-bit, Intel Celeron N2920 @ 1.86GHz, 4GB DDR3 RAM Windows 10 Home 64-bit, AMD Athlon II X4 630, 2.80GHz, 8GB DDR3 RAM Top Soft Posts: 147 Joined: 07 Jan 2015, 13:18 GitHub: visionary1 Location: Seoul Contact: Contact Soft Website Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 05 Nov 2015, 18:21 brilliant job, it's the true visual gui designer. btw, am I the only one having an error msg ?, had to change it manually 'AutoGUI-1.0.0-2\AutoGUI\Lib\Scintilla.ahk (246) : ==> Built-in variables must not be declared. Specifically: null:=0' AutoHotkey & AutoHotkey_H v1.1.22.07 Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 06 Nov 2015, 00:45 Looks impressive. @Soft: null is a built-in variable only for AutoHotkey_H, not AutoHotkey. Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 06 Nov 2015, 01:22 looks very well done, one of the most polished scripts ive seen Top Soft Posts: 147 Joined: 07 Jan 2015, 13:18 GitHub: visionary1 Location: Seoul Contact: Contact Soft Website Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 06 Nov 2015, 02:30 oh, thnx Lexikos! AutoHotkey & AutoHotkey_H v1.1.22.07 Top Run1e Posts: 83 Joined: 03 May 2014, 14:50 Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 07 Nov 2015, 08:55 Damn, looks pretty good, I'll follow the advancements for sure. Columbus - a fast program launcher (now with plugins!) Visit my website! Top tidbit Posts: 643 Joined: 29 Sep 2013, 17:15 Location: Minnesota, US Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 07 Nov 2015, 14:37 Looks great and works pretty good great job so far. rawr. fear me. *poke* Is it December 21, 2012 yet? Top Exaskryz Posts: 1078 Joined: 17 Oct 2015, 20:28 Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 07 Nov 2015, 17:41 Middle-click a control to access its properties. I haven't tried out your program yet, but it looks good. I just want to say here that you should try not to restrict any features to middle-clicking. You may have other ways to access the properties that weren't documented in this post, so I apologize if you've already taken care of this. As a laptop user, I need to plug in an external mouse to access middle click, or use AHK to remap a key to middle click. If you haven't included an alternative way to access the properties of a control (Beyond manual edits in the code), might I suggest including that in the context-menu from a right click? Top Alguimist Posts: 43 Joined: 05 Oct 2015, 16:41 Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 08 Nov 2015, 11:53 Exaskryz wrote:You may have other ways to access the properties that weren't documented in this post... The properties dialog can be accessed from the Control menu (which is also the context menu), from the toolbar, or by pressing F10. Top Alguimist Posts: 43 Joined: 05 Oct 2015, 16:41 Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 08 Nov 2015, 12:00 Version 1.0.1 fixes the following issue: a script cannot be run from the saved location if there are spaces in the filename. The keyboard shortcuts to run a script are: F9: runs the script from the Temp folder. Ctrl+F9: runs the script from the saved location. Shift+F9: runs the script with AHK x64. Alt+F9: runs the script through a named pipe. Top usser Posts: 84 Joined: 22 Oct 2014, 13:03 Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 08 Nov 2015, 16:52 thanks for this, it seems very useful can you give me some guidance via examples please? eg. how do I make a GUI with a button to click and do stuff? and a drop down menu that will list results from a list of possible results, as you type into the text box? Top Joe Glines Posts: 302 Joined: 30 Sep 2013, 20:49 Facebook: https://www.facebook.com/theAutomatorGuru/ Google: https://plus.google.com/105328929654286634910 GitHub: joetazz Location: Dallas Contact: Contact Joe Glines Website Twitter YouTube Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 09 Nov 2015, 21:35 the ""samples"" folder has some amazing examples! Great job Alguimist! I've yet to truly build a lot in depth but, overall, this is quite amazing! AutoHotkey User Survey Webinar AutoHotkey User Survey Webinar Results Web Scraping 101 Debugging AutoHotKey with SciTE Screen clipping + (Outlook, IMGUR,Local file…) How-to: Create a shortcut that automatically logs in to any website Top MJs Posts: 454 Joined: 23 Sep 2014, 03:29 Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 10 Nov 2015, 00:54 nice looking project, well done, even though I'm used to use a resource editor and ""CLONE"" as you call it I call it ""STEAL"". it's the best out there and the coding is very nice, and can be understood and followed to some extent, well done. thanks for sharing. would be you be interested in implementing a different sizing and moving technique like resource editors? Top aaffe Posts: 95 Joined: 16 Jan 2014, 04:23 Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 10 Nov 2015, 03:26 Sorry, Im having Problems with adding a menu bar. Top MJs Posts: 454 Joined: 23 Sep 2014, 03:29 Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 10 Nov 2015, 09:11 you could explain what you were doing exactly, and move the message dialog away from the menu widow to see what's going on since it's hard to reproduce the error. Top aaffe Posts: 95 Joined: 16 Jan 2014, 04:23 Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 10 Nov 2015, 09:27 I just added ""Add Menu"" Test. When then I clicked on Ok, the message was shown. [img=http://s16.postimg.org/gcm0vhu5h/test.jpg] Top Alguimist Posts: 43 Joined: 05 Oct 2015, 16:41 Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 10 Nov 2015, 10:23 Add at least one item to the menu. Please notice that the Menu Editor is at an early stage of implementation. It will probably be completely redesigned. Top aaffe Posts: 95 Joined: 16 Jan 2014, 04:23 Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 10 Nov 2015, 10:31 Yes I know that is in an early stage. I just wanted to tell. Btw. seems to become a great Editor! Top MJs Posts: 454 Joined: 23 Sep 2014, 03:29 Re: AutoGUI - GUI Designer and Script Editor Report this post Quote 10 Nov 2015, 11:17 MJs wrote:you could explain what you were doing exactly, and move the message dialog away from the menu widow to see what's going on since it's hard to reproduce the error. sorry about that since I just added items. Please notice that the Menu Editor is at an early stage of implementation. It will probably be completely redesigned. deleting separators must be handled differently since the delete the command requires the menu name, my be not deleting the items from the menu on editing but on submitting. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 140 posts Page 1 of 7 Jump to page: 1 2 3 4 5 … 7 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by alguimist - WYSIWIG GUI Designer and Script Editor"	"true"
"GUI WYSIWYG Builders"	"GUI Creator (formerly Basic GUI Creator)"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=303"	"WYSIWYG GUI Creator for AutoHotkey."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"GUI Creator (formerly Basic GUI Creator) - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:31 All times are UTC-05:00 GUI Creator (formerly Basic GUI Creator) Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 56 posts 1 2 3 Next maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 GUI Creator (formerly Basic GUI Creator) Report this post Quote 16 Oct 2013, 14:36 Sorry this took so long. This is a WYSIWYG GUI Creator for AutoHotkey. AHK L x32 version Let me know what you think. Last edited by maestrith on 11 Feb 2016, 13:23, edited 5 times in total. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top Alibaba Posts: 427 Joined: 29 Sep 2013, 16:15 Location: Germany Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 19 Oct 2013, 11:45 Great work! I really like it. But it'd be great if the controls size could be changed by dragging its borders. ""Nothing is quieter than a loaded gun."" - Heinrich Heine Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 03 Nov 2013, 09:17 Alibaba wrote:Great work! I really like it. But it'd be great if the controls size could be changed by dragging its borders. Thank you I will look into different re-sizing options but I have had horrible results using mouse tracking and cursor switching to show that you are over certain areas of a control. Hopefully I will have some free time to work on the script soon. Thanks for giving it a try AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top Coco Posts: 767 Joined: 29 Sep 2013, 20:37 GitHub: cocobelgica Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 03 Nov 2013, 12:45 Hi maestrith, is this a rewrite? Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 03 Nov 2013, 12:49 Coco wrote:Hi maestrith, is this a rewrite? Yes it is. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top Therobotmd Posts: 7 Joined: 06 Jan 2014, 03:50 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 11 Jan 2014, 23:51 Awesome! Can you post the code I the forum though? The formatting is all screwy for me. Missing all line breaks. Thanks! Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 13 Jan 2014, 11:16 Code: [Select all] [Expand] [Download] (GUI Creator.ahk)GeSHi © Codebox Plus #SingleInstance,Force DetectHiddenWindows,On if !A_IsCompiled{ 	if (A_PtrSize=4){ 		SplitPath,A_AhkPath,,apdir 		SplitPath,A_ScriptName,filename,dir 		run,%apdir%\AutoHotkeyU64.exe ""%A_ScriptName%"",%dir% 		ExitApp 	} } if !FileExist(""lib""){ 	FileCreateDir,lib 	firstrun:=1 } checkfiles() v:=[],gui:=new xml(""gui""),settings:=new xml(""settings"",""lib\settings.xml"") controls:=new xml(""controls"",""lib\controls.xml"") global settings,gui,v,controls file:=settings.ssn(""//last/@file"").text if !file gui() if settings.ssn(""//last/@file"").text load_GUI(1) WinSet,Redraw,,% hwnd([1]) mode_select(),snap() if firstrun help() edit(""GUI Settings"") return t(x*){ 	for a,b in x 	list.=b ""`n"" 	ToolTip,%list% } m(x*){ 	for a,b in x 	list.=b ""`n"" 	MsgBox,% list } tt(x*){ 	for a,b in x 	list.=b ""`n"" 	ToolTip,%list%,0,0,3 } getpos(con){ 	ControlGetPos,x,y,w,h,,ahk_id%con% 	x-=v.border,y-=v.border+v.caption 	return {x:x,y:y,w:w,h:h} } class xml{ 	k:=[] 	__New(root,file=""""){ 		temp:=ComObjCreate(""MSXML2.DOMDocument""),temp.setProperty(""SelectionLanguage"",""XPath"") 		this.xml:=temp 		If FileExist(file) 		temp.load(file),this.xml:=temp 		else 		this.xml:=this.CreateElement(temp,root) 		this.file:=file 		xml.k[root]:=this 	} 	CreateElement(doc,root){ 		return doc.AppendChild(this.xml.CreateElement(root)).parentnode 	} 	unique(p,att,check){ 		find:=IsObject(check)?""//"" p ""[text()='"" att.text ""']"":""//"" p ""[@"" check ""='"" att.att[check] ""']"" 		att[""dup""]:=this.xml.SelectSingleNode(find)?0:1,current:=this.xml.SelectSingleNode(find) 		if att.dup 		return this.add(p,att) 		for a,b in att.att 		current.SetAttribute(a,b) 		if att.text 		current.text:=att.text 		return current 	} 	under(info){ 		new:=info.under.appendchild(this.xml.createelement(info.node)) 		for a,b in info.att 		new.SetAttribute(a,b) 		new.text:=info.text 		return new 	} 	remove(path){ 		rem:=this.xml.SelectSingleNode(path),rem.ParentNode.RemoveChild(rem) 	} 	current(con){ 		return this.ssn(""//*[@hwnd='"" con ""']"") 	} 	control(control){ 		return this.ea(""//*[@hwnd='"" control ""']"") 	} 	__Get(x=""""){ 		return this.xml.xml 	} 	easy(node){ 		x:=node.SelectNodes(""@*""),ret:=[] 		while,xx:=x.item(A_Index-1) 		ret[xx.nodename]:=xx.text 		return ret 	} 	ea(path){ 		nodes:=this.xml.SelectNodes(path ""/@*""),obj:=[] 		while,n:=nodes.item(A_Index-1) 		obj[n.nodename]:=n.text 		return obj 	} 	sn(path){ 		return this.xml.SelectNodes(path) 	} 	ssn(path){ 		return this.xml.SelectSingleNode(path) 	} 	allsel(){ 		selected:=this.sn(""//selected/*"") 		while,sel:=selected.item(A_Index-1) 		list.=""@hwnd='"" sel.text ""' or "" 		list:=SubStr(list,1,InStr(list,""or"",0,0)-1) 		return list 	} 	save(x*){ 		if x.1=1 		this.Transform() 		filename:=this.file?this.file:x.1.1 		file:=fileopen(filename,""rw"") 		if (file.read()=this.xml.xml) 		return 		file.seek(0) 		file.write(this.xml.xml) 		file.length(file.position) 	} 	add(path,info=""""){ 		p:=""/"",dup:=this.ssn(""//"" path)?1:0 		next:=this.ssn(""//"" path)?this.ssn(""//"" path):this.ssn(""//*"") 		Loop,Parse,path,/ 		last:=A_LoopField,p.=""/"" last,next:=this.ssn(p)?this.ssn(p):next.appendchild(this.xml.CreateElement(last)) 		if (info.dup&&dup) 		next:=next.parentnode.appendchild(this.xml.CreateElement(last)) 		for a,b in info.att 		next.SetAttribute(a,b) 		if info.text!="""" 		next.text:=info.text 		return next 	} 	transform(){ 		static 		if !IsObject(xsl){ 			xsl:=ComObjCreate(""MSXML2.DOMDocument"") 			style= 			( 			<xsl:stylesheet version=""1.0"" xmlns:xsl=""http://www.w3.org/1999/XSL/Transform""> 			<xsl:output method=""xml"" indent=""yes"" encoding=""UTF-8""/> 			<xsl:template match=""@*|node()""> 			<xsl:copy> 			<xsl:apply-templates select=""@*|node()""/> 			<xsl:for-each select=""@*""> 			<xsl:text/> 			</xsl:for-each> 			</xsl:copy> 			</xsl:template> 			</xsl:stylesheet> 			) 			xsl.loadXML(style),style:=null 		} 		this.xml.transformNodeToObject(xsl,this.xml) 	} } sn(node,path){ 	return node.SelectNodes(path) } ssn(node,path){ 	return node.SelectSingleNode(path) } hwnd(number,wnd=""""){ 	static hwnd:=[] 	if number.remove{ 		uu:=settings.unique(""window/position"",{att:{win:number.remove},text:winpos(number.remove).text},""win"") 		Gui,% number.remove "":Destroy"" 		return hwnd[number.remove]:="""" 	} 	if IsObject(number) 	return hwnd[number.1].h 	if !wnd 	return hwnd[number].n 	hwnd[number]:={n:wnd,h:""ahk_id "" wnd+0} } LButton(){ 	LButton: 	MouseGetPos,x,y,win,con,2 	if !(win=hwnd(1)) 	return 	gui.remove(""//templist"") 	Sleep,0 ;IMPORTANT!!!!! 	if (v.currentmode=""interact""){ 		if !con 		return edit(""gui settings"") 		Gui.remove(""//selected""),Gui.Add(""gui/selected/hwnd"").text:=married(con) 		edit(""controls""),v.last:=con 		return 	} 	if (con){ 		GuiControl,2:Choose,SysTabControl321,1 		married(con) 		con:=married(con),v.last:=con 		Grid(x,y) 		changesel:=1 		con+=0 		selected:=gui.ssn(""//selected/*[text()='"" con ""']"")?gui.sn(""//gui/selected/*[text()]""):gui.sn(""//*[@hwnd='"" con ""']/@hwnd"") 		if !(v.currentmode=""Resize""||GetKeyState(""Shift"",""P"")){ 			while,ss:=selected.item(A_Index-1).Text{ 				des:=sn(gui.current(ss),""descendant-or-self::*[@hwnd]"") 				while,dd:=des.item(A_Index-1){ 					ea:=xml.easy(dd) 					if (v.currentmode=""Move"") 					Gui.unique(""templist/control"",{att:{x:ea.x-x,y:ea.y-y,control:ea.hwnd,type:ea.type}},""control"") 				} 			} 		} 		if (v.currentmode=""Resize""||GetKeyState(""Shift"",""P"")) 		while,ss:=selected.item(A_Index-1).Text{ 			ea:=gui.ea(""//*[@hwnd='"" ss ""']"") 			uu:=Gui.unique(""templist/control"",{att:{w:ea.w,h:ea.h,control:ea.hwnd,type:ea.type}},""control"") 		} 		templist:=gui.sn(""//templist/*"") 		while,GetKeyState(""LButton"",""P""){ 			MouseGetPos,xx,yy 			Grid(xx,yy) 			sleep,1 			if !(Abs(xx-x)>3||abs(yy-y)>3) 			continue 			changesel:=0 			killhighlight() 			if (v.currentmode=""Resize""||GetKeyState(""Shift"",""P"")) 			resize(templist,x,y) 			if (v.currentmode=""Move"") 			move(templist,x,y) 		} 		;if things are in remove list just move them back to the main <window> 		;move the GroupBox last and have it check for inside stuff 		;no tabs! 		v.removelist:=[] 		if Abs(xx-x)>3||abs(yy-y)>3{ 			templist:=gui.ssn(""//templist"") 			for a,b in [sn(templist,""*[@type!='GroupBox' and @type!='Tab' and @type!='Tab2']""),sn(templist,""*[@type='GroupBox' or @type='Tab' or @type='Tab2']"")] 			while,qq:=b.item(A_Index-1) 			top(ssn(qq,""@control"").text) 		} 		for a,b in v.removelist{ 			current:=gui.current(b) 			des:=sn(current,""descendant::*"") 			while,dd:=des.item(A_Index-1).SelectSingleNode(""@hwnd"").text{ 				if WinExist(""ahk_id"" dd){ 					move:=Gui.current(dd) 					place(move) 				} 			} 			current.ParentNode.RemoveChild(current) 		} 		v.removelist:="""" 		if changesel{ 			if !(GetKeyState(""Shift"",""P"")=1||GetKeyState(""Control"",""P"")=1) 			gui.remove(""//gui/selected"") 			current:=gui.ssn(""//selected/hwnd[text()='"" con ""']"") 			if current&&GetKeyState(""Control"",""P"") 			current.ParentNode.RemoveChild(current) 			else 			gui.unique(""selected/hwnd"",{text:con},[""hwnd""]) 		} 		sleep,0 		highlight() 		if (sn(gui.ssn(""//selected""),""*"").length&&con) 		edit() 	} 	else 	{ 		list:=select(x,y) 		if !(GetKeyState(""Shift"",""P"")=1||GetKeyState(""Control"",""P"")=1) 		gui.remove(""//gui/selected"") 		selected:=gui.add(""gui/selected"") 		while,ll:=list.item(A_Index-1){ 			current:=gui.ssn(""//selected/hwnd[text()='"" ll.text ""']"") 			if current&&GetKeyState(""Control"",""P"") 			current.ParentNode.RemoveChild(current) 			current:=!current?gui.add(""selected/hwnd"",{text:ll.text,dup:1}):"""" 			Gui.unique(""templist/control"",{att:{control:ll.text}},""control"") 		} 		highlight() 		if sn(selected,""*"").length{ 			GuiControl,2:Choose,SysTabControl321,1 			edit() 		} 		if gui.sn(""//selected/*"").length 		edit(""controls"") 		else 		edit(""gui settings"") 	} 	return 	notactive: 	sleep,1 	MouseGetPos,,,win,con,2 	if (win=hwnd(1)){ 		v.last:=con+0 		WinActivate,% hwnd([1]) 		WinWaitActive,% hwnd([1]) 		LButton() 	} 	return } place(move){ 	while,move.ParentNode.nodename=""control"" 	move.ParentNode.ParentNode.AppendChild(move) 	if move.ParentNode.nodename=""GroupBox""&&ssn(move,""@type"").text!=""GroupBox"" 	win:=gui.ssn(""//window""),win.AppendChild(move) } top(con){ 	current:=gui.ssn(""//*[@hwnd='"" con ""']""),att:=gui.ea(""//*[@hwnd='"" con ""']"") 	if InStr(att.type,""Tab"") 	return 	if tab:=gui.ssn(""//*[@x<'"" att.x ""' and @x+@w>'"" att.x ""' and @y<'"" att.y ""' and @y+@h>'"" att.y ""' and (@type='Tab2' or @type='Tab')]""){ 		if !ssn(tab,""descendant::*[@hwnd='"" con ""']""){ 			DllCall(""DestroyWindow"",uint,att.hwnd),att.tab:="""" 			newcon:=add_control(att.type,att) 			current:=gui.current(newcon.hwnd) 			v.removelist.Insert(con) 			gui.add(""selected/hwnd"",{text:newcon.hwnd}) 			v.last:=newcon.hwnd 		} 	} 	else if att.tab{ 		DllCall(""DestroyWindow"",uint,att.hwnd) 		att.remove(""tab"") 		newcon:=add_control(att.type,att) 		current:=gui.current(newcon.hwnd) 		v.last:=newcon.hwnd 		gui.add(""selected/hwnd"",{text:newcon.hwnd}) 		v.removelist.Insert(con) 	} 	else if (att.type=""GroupBox""){ 		current:=gui.current(att.hwnd) 		list:=gui.sn(""//*[@x>"" att.x "" and @x<"" att.x+att.w "" and @y>"" att.y "" and @y<"" att.y+att.h "" and @tab='"" att.tab ""' and @hwnd!='"" ea.hwnd ""']"") 		Loop,% list.length{ 			ll:=list.item(A_Index-1) 			if !ssn(current,""descendant::ll"") 			current.AppendChild(list.item(A_Index-1)) 		} 	} 	if list:=gui.ssn(""//*[@x<"" att.x "" and @x+@w>"" att.x "" and @y<"" att.y "" and @y+@h>"" att.y "" and @tab='"" att.tab ""' and @type='GroupBox']""){ 		if !ssn(list,""descendant::*[@hwnd='"" att.hwnd ""']"") 		list.AppendChild(gui.current(att.hwnd)) 	} 	if ancestor:=ssn(current,""ancestor::*[@type='GroupBox']""){ 		if !list:=gui.ssn(""//*[@x<"" att.x "" and @x+@w>"" att.x "" and @y<"" att.y "" and @y+@h>"" att.y "" and @tab='"" att.tab ""' and @type='GroupBox']"") 		place(Gui.current(att.hwnd)) 	} 	return } gui(hide=""""){ 	Gui,1:Destroy 	Gui,+Resize -0x30000 +hwndhwnd 	OnMessage(0x231,""killhighlight"") 	OnMessage(0x136,""display_grid""),OnMessage(0x232,""snap"") 	SysGet,border,32 	SysGet,caption,4 	Gui,Margin,10,10 	Hotkey,IfWinActive,ahk_id%hwnd% 	Hotkey,*~LButton,LButton,On 	Hotkey,!~LButton,interact,On 	Hotkey,IfWinNotActive,ahk_id%hwnd% 	Hotkey,*~LButton,notactive,On 	v.border:=border,v.caption:=caption 	hwnd(1,hwnd) 	hide:=hide?""Hide"":"""" 	Gui,Show,% size(1,""w500 h500 Center"") "" "" hide,GUI Creator : Right Click For The Menu 	gui_hotkey() 	return 	GuiEscape: 	GuiClose: 	MsgBox,259,GUI Creator,Save your current GUI? 	IfMsgBox,Yes 	save_gui() 	IfMsgBox,Cancel 	return 	if hwnd(2) 	hwnd({remove:2}) 	hwnd({remove:1}) 	settings.save(1) 	ExitApp 	return } interact: return new_gui(x=""""){ 	gui(x),gui:=new xml(""gui""),snap() } gui_hotkey(){ 	static personal:=[{hotkey:{label:""modesel"",main:""LButton Mode Change""},keys:[[""Next Mode"",""+up""],[""Previous Mode"",""+down""]]} 	,{hotkey:{label:""adjust"",main:""Adjust Selected Controls Position""},keys:[[""Up"",""Up""],[""Down"",""Down""],[""Left"",""Left""],[""Right"",""Right""]]} 	,{hotkey:{label:""allkeys"",main:""Hotkeys""},keys:[[""Copy GUI to Clipboard"",""^E""],[""Export GUI"",""!E""] 	,[""Show Code"",""S""],[""Reorder GUI"",""!R""],[""Test GUI"",""^T""],[""Edit Labels"",""F1""]]}] 	v.personal:=personal 	for a,b in personal{ 		if !main:=settings.ssn(""//actions/hotkey[@label='"" b.hotkey.label ""']"") 		main:=settings.add(""actions/hotkey"",{att:{label:b.hotkey.label,main:b.hotkey.main},dup:1}) 		for c,d in b.keys{ 			if !ssn(main,""//actions/hotkey/key[@desc='"" d.1 ""']"") 			settings.under({under:main,node:""key"",att:{desc:d.1,value:d.2}}) 		} 	} 	list:=settings.sn(""//hotkeys/*"") 	Hotkey,IfWinActive,% hwnd([1]) 	while,ll:=list.item(A_Index-1) 	if ll.text 	hotkey,% ll.text,addcontrol,On 	for a,b in personal{ 		for c,d in b.keys{ 			key:=settings.ssn(""//hotkey[@label='"" b.hotkey.label ""']/key[@desc='"" d.1 ""']/@value"").text 			key:=key?key:d.2 			Hotkey,%key%,% b.hotkey.label,On 		} 	} 	Hotkey,^a,selectall,On 	Hotkey,Delete,delete,On 	return 	addcontrol: 	MouseGetPos,x,y,win 	if (win!=hwnd(1)) 	return m(""Please have your mouse over the GUI Creator window"") 	x-=v.Border,y-=v.Border+v.Caption 	grid(x,y) 	cl:=settings.ssn(""//hotkeys/*[text()='"" A_ThisHotkey ""']"").nodename 	if (cl=""Picture""){ 		FileSelectFile,picture,,,Select an image.,*.gif;*.jpg;*.png 		if ErrorLevel||picture="""" 		return 	} 	value:=picture?picture:cl 	add_control(cl,{x:x,y:y,value:value,type:cl}) 	return 	allkeys: 	ea:=clean(casessn(settings.xml,""value"",A_ThisHotkey,""@desc"").text) 	if IsFunc(ea) 	%ea%() 	return } casessn(node,attribute,find,att=""""){ 	StringLower,find,find 	att:=att?""/"" att:"""" 	return ssn(node,""//*[translate(@"" attribute "",'ABCDEFGHIJKLMNOPQRSTUVWXYZ','abcdefghijklmnopqrstuvwxyz')='"" find ""']"" att) } add_control(type,att){ 	static tt:={Button:""Button"",Checkbox:""Checkbox"",ComboBox:""ComboBox"",DateTime:""DateTime"",DropDownList:""DropDownList"",Edit:""Edit"",GroupBox:""GroupBox"",Hotkey:""Hotkey"",Listbox:""Listbox"",ListView:""ListView"",MonthCal:""MonthCal"",Picture:""Picture"",Progress:""Progress"",Radio:""Radio"",Slider:""Slider"",Tab:""Tab"",Tab2:""Tab2"",Text:""Text"",Treeview:""Treeview"",UpDown:""UpDown""} 	static controllist:=[] 	position:="""" 	if (type=""DateTime"") 	att.value:=""LongDate"" 	if !att.tab 	att.tab:="""" ;required 	att.type:=tt[att.type] 	if RegExMatch(att.type,""(ComboBox|DDL|DropDownList)"") 	att.h:=500 	if InStr(att.options,""Password"") 	att.remove(""h""),att.options:=RegExReplace(att.options,""i)Multi"") 	list:=att.r?""x,y,w"":""x,y,w,h"" 	for a,b in att 	if a in %list% 	if b 	position.=a b "" "" 	if att.r 	position.="" r"" att.r "" "" 	options.=type=""ListView""?"" -Multi"":"""" 	type:=type=""Tab""?""Tab2"":type 	if !InStr(type,""tab"") 	tab:=whichtab(att) 	if tab.tab 	att.tab:=tab.tab 	options.="" "" att.options 	if att.Background 	options.="" Background"" att.Background 	value:=RegExReplace(att.value,""(``r|``n)"",""`n"") 	value:=value?value:att.value 	Gui,1:Font,% compilefont(att),% att.font 	border:=settings.ssn(""//options/Borders"").text?""Border"":"""" 	Gui,1:Add,%type%,%position% hwndhwnd %options% %border%,% value 	if type=TreeView 	root:=TV_Add(""Treeview"",0,""Expand""),TV_Add(""This will not be in your compiled version"",root) 	Gui,1:Font 	Gui,1:Tab 	att.type:=tt[att.type] 	married() 	for a,b in getpos(hwnd) 	att[a]:=b 	if RegExMatch(att.type,""(ComboBox|DDL|DropDownList)"") 	att.remove(""h"") 	att[""hwnd""]:=hwnd+0,att[""type""]:=att.type 	if tab.ctrl{ 		SplashTextOff 		root:=gui.ssn(""//*[@hwnd='"" tab.hwnd ""']"") 		if !current:=ssn(root,""tab[@tab='"" tab.tab ""']"") 		current:=gui.under({under:root,node:""tab"",att:{tab:tab.tab},dup:1}) 		if before:=ssn(root,""tab[@tab='"" tab.tab+1 ""']"") 		current:=root.insertbefore(current,before) 		current:=gui.under({under:current,node:""control"",att:att}) 	} 	else 	current:=Gui.add(""window/control"",{att:att,dup:1}) 	if GroupBox:=gui.ssn(""//*[@x<'"" att.x ""' and @x+@w>'"" att.x ""' and @y<'"" att.y ""' and @y+@h>'"" att.y ""' and @hwnd!='"" ea.hwnd ""'  and @type='GroupBox']""){ 		if ssn(GroupBox,""@tab"").text=att.tab&&current 		GroupBox.AppendChild(current) 	} 	if (att.type=""GroupBox""){ 		list:=gui.sn(""//*[@x>"" att.x "" and @x<"" att.x+att.w "" and @y>"" att.y "" and @y<"" att.y+att.h "" and @tab='"" att.tab ""']/@hwnd"") 		Loop,% list.length 		gui.current(att.hwnd).AppendChild(gui.current(list.item(A_Index-1).text)) 	} 	if (att.type=""ListView""){ 		Loop,2 		LV_Add("""",""Test Item"" A_Index) 	} 	if InStr(att.type,""Tab"") 	Gui.Add(""tablist/tab"",{text:att.hwnd,att:{num:gui.sn(""//tablist/*"").length+1},dup:1}) 	lastcl:=cl 	return att } grid(ByRef x,ByRef y,adjust=""""){ 	if adjust 	x-=v.Border,y-=v.border+v.caption 	if settings.ssn(""//options/Snap_To_Grid"").text 	x:=Round(x,-1),y:=Round(y,-1) } married(byref info=""""){ 	static married:=[],list 	if info 	return info:=married[info]?married[info]+0:info+0 	WinGet,cl,ControlListHWND,% hwnd([1]) 	out:=RegExReplace(cl,(RegExReplace(list,""\n"",""|""))) 	if RegExMatch(out,""O)(\w+)\s+(\w+)"",found) 	married[found.2+0]:=found.1+0 	list:=cl } ;check the ideas debug(info=""""){ 	if v.loading 	return 	info:=info?info:gui 	if (WinExist(hwnd([98]))!=0&&hwnd(98)=""""){ 		Gui,98:+hwndhwnd 		hwnd(98,hwnd) 		Gui,98:Add,Edit,w800 h500 -Wrap 		Gui,98:Show,x0 y0,Debug 		WinActivate,% hwnd([1]) 	} 	info.Transform() 	ll:=info.sn(""//@hwnd"") 	GuiControl,98:,Edit1,% info[] ""`n`ncount: "" ll.length 	Gui,1:Default 	return 	98GuiEscape: 	98GuiClose: 	hwnd({remove:98}) 	return } winpos(win){ 	VarSetCapacity(size,A_PtrSize*4,0),DllCall(""user32\GetClientRect"",""uint"",hwnd(win),""uint"",&size),w:=NumGet(size,8),h:=NumGet(size,12) 	WinGetPos,x,y,,,% hwnd([win]) 	if x&&y&&w&&h 	return {text:""x"" x "" y"" y "" w"" w&0xffff "" h"" h,obj:{x:x,y:y,w:w&0xffff,h:h}} } select(xx,yy){ 	Random,color,0xaaaaaa,0xeeeeee 	gui,59:-caption +alwaysontop +E0x20 +hwndselect +Owner1 	WinGetPos,wx,wy,ww,wh,% hwnd([1]) 	gui,59:show,% ""x"" wx "" y"" wy "" w"" ww "" h"" wh  "" noactivate hide"" 	gui,59:color,%color% 	gui,59:show,NoActivate 	WinSet,Transparent,20,ahk_id %select% 	while,GetKeyState(""LButton"",""P""){ 		mousegetpos,x,y 		winset,region,%xx%-%yy% %x%-%yy% %x%-%y% %xx%-%y% %xx%-%yy%,ahk_id %select% 	} 	Gui,59:Destroy 	xsub:=v.border,ysub:=v.Border+v.Caption,inside:=[] 	for a,b in {x:x-xsub,xx:xx-xsub,y:y-ysub,yy:yy-ysub}{ 		inside[InStr(a,""x"")?""x"":""y"",b]:=1 	} 	return inside(inside) } inside(control){ 	/* 		if !IsObject(control){ 			cc:=control+0,ea:=gui.control(cc),control:=[] 			if !RegExMatch(ea.type,""(GroupBox|Tab|Tab2)"") 			return 			control[""x"",ea.x]:=1,control[""x"",ea.x+ea.w]:=1 			control[""y"",ea.y]:=1,control[""y"",ea.y+ea.h]:=1 		} 		if ea.type=""GroupBox"" 		list:=gui.sn(""//*[@x>"" control.x.MinIndex() "" and @x<"" control.x.MaxIndex() "" and @y>"" control.y.MinIndex() "" and @y<"" control.y.MaxIndex() ""  and @tab='"" ea.tab ""']/@hwnd"") 		else 		m(control.x.minindex(),control.x.MaxIndex(),control.y.MinIndex(),control.y.MaxIndex()) 	*/ 	list:=gui.xml.SelectNodes(""//*[@x>'"" control.x.MinIndex() ""' and @x<'"" control.x.MaxIndex() ""' and @y>'"" control.y.MinIndex() ""' and @y<'"" control.y.MaxIndex() ""']/@hwnd"") 	return list } highlight(){ 	if (v.currentmode=""interact"") 	return killhighlight() 	WinGetPos,x,y,w,h,% hwnd([1]) 	Gui,98:Destroy 	Gui,98:+LastFound +Owner1 +E0x20 -Caption +hwndsh +ToolWindow 	hwnd(98,sh) 	WinSet,TransColor,0xF0F0F0 100 	Gui,98:Color,0xF0F0F0,0xFF 	for a,b in Pos 	p.=a b "" "" 	Gui,98:Default 	x+=v.Border,y+=v.Border+v.Caption,w-=(v.border*2),h-=(v.Border*2)+v.Caption 	ll:=gui.sn(""//selected/hwnd"") 	plain:=[],group:=[],tab:=[] 	while,l:=ll.item(A_Index-1){ 		ea1:=xml.easy(gui.ssn(""//*[@hwnd='"" married(l.text) ""']"")) 		ea:=getpos(married(l.text)) 		if !(ea.x&&ea.y&&ea.w&&ea.h) 		continue 		info:=""c"" color "" x"" ea.x "" y"" ea.y "" w"" ea.w "" h"" ea.h 		if InStr(ea.type,""Tab"") 		tab[ea1.hwnd]:=info 		else if InStr(ea1.type,""GroupBox"") 		group[ea1.hwnd]:=info 		else 		plain[ea1.hwnd]:=info 	} 	for a,b in plain 	Gui,Add,Progress,%b%,100 	for a,b in group 	Gui,Add,Progress,%b%,100 	for a,b in tab 	Gui,Add,Progress,%b%,100 	Gui,98:Show,x%x% y%y% w%w% h%h% NoActivate 	if hwnd(2) 	WinSet,Top,,% hwnd([2]) 	if hwnd(3) 	WinSet,Top,,% hwnd([3]) } killhighlight(a*){ 	if a.1!="""" 	ToolTip,,,,3 	Gui,98:Destroy 	if hwnd(44) 	hwnd({remove:44}) } load_gui(file=""""){ 	v.loading:=1 	if (file=1) 	file:=settings.ssn(""//last/@file"").text 	if (file=""""||file=1){ 		FileSelectFile,file,,,Select the GUI file to load,*.xml 		if ErrorLevel||FileExist(file)="""" 		return 	} 	if !FileExist(file) 	return m(""can't find the file""),gui() 	SplashTextOn,200,50,Loading File,Please wait... 	settings.add(""last"",{att:{file:file}}) 	gui(1),gui:=new xml(""gui"") 	Gui,1:Default 	temp:=new xml(""temp"") 	temp.xml.load(file),tabcount:=0 	ctrl:=temp.sn(""//@hwnd/.."") 	while,ct:=ctrl.item(A_Index-1){ 		ea:=xml.easy(ct) 		if ea.tabnum&&!ea.tab	;<---This is for 		ea.tab:=ea.tabnum		;<---backward compatibility. 		add_control(ea.type,ea) 	} 	splitpath,file,filename,dir 	filename:=temp.ssn(""//file/filename"").text 	dir:=temp.ssn(""//file/dir"").text 	gui.add(""file/filename"").text:=filename 	Gui.add(""file/dir"").text:=dir 	ea:=temp.ea(""//show"") 	ea.options:=RegExReplace(ea.options,""i)(Hide|Minimize|NA|NoActivate)"") 	ss:=temp.ssn(""//show"") 	if ss 	gui.ssn(""*"").AppendChild(ss) 	for a,b in ea 	if a in x,y,w,h 	if b 	position.=a b "" "" 	SplashTextOff 	Gui,Show,% position "" "" ea.options 	v.loading:=0 	WinSetTitle,GUI Creator,,GUI Creator : %filename% 	if temp.ssn(""//labels"") 	gui.ssn(""//*"").AppendChild(temp.ssn(""//labels"")) 	snap(1) } save_gui(filename=""""){ 	option:=settings.ssn(""//options/Warn_Overwrite"").text?""S16"":"""" 	if !filename{ 		file:=gui.ssn(""//file/filename"").text,dir:=gui.ssn(""//file/dir"").text 		if file&&dir 		if FileExist(dir ""\"" file) 		filename:=dir ""\"" file 	} 	if !filename 	FileSelectFile,filename,%option%,,Save Current GUI,*.xml 	if ErrorLevel||filename="""" 	return 	filename:=InStr(filename,"".xml"")?filename:filename "".xml"" 	SplitPath,filename,filename,dir 	gui.add(""file/filename"").text:=filename 	Gui.add(""file/dir"").text:=dir 	Gui.Transform() 	gui.save([dir ""\"" filename]) 	settings.add(""last"",{att:{file:dir ""\"" filename}}) } snap(a*){ 	WinGetPos,,,w,h,% hwnd([1]) 	Grid(w,h) 	w-=4,h-=1 	WinMove,% hwnd([1]),,,,% w,% h 	highlight() 	gui.add(""show"",{att:winpos(1).obj,text:winpos(1).text}) 	if hwnd(2) 	edit(""gui settings"") 	if hwnd(3) 	WinSet,Top,,% hwnd([3]) } display_grid(x=""""){ 	Static wBrush 	if x=removebrush 	wbrush:="""" 	if A_Gui!=1 	return 	if settings.ssn(""//options/Grid"").text 	tile:=""tile.bmp"" 	else 	return 	If !wBrush 	hBM:=DllCall(""LoadImage"",Int,0,Str,""tile.bmp"",Int,0,Int,0,Int,0,UInt,0x2010,""cdecl""),wBrush:=DllCall(""CreatePatternBrush"",UInt,hBM,""cdecl"") 	Return wBrush } size(win,default=""""){ 	pos:=settings.ssn(""//window/position[@win='"" win ""']"").text 	pos:=pos?pos:default 	return pos } whichtab(att){ 	if !tab:=gui.ssn(""//*[@x<'"" att.x ""' and @x+@w>'"" att.x ""' and @y<'"" att.y ""' and @y+@h>'"" att.y ""' and @type='Tab2']/@hwnd"").text 	tab:=gui.ssn(""//*[@x<'"" att.x ""' and @x+@w>'"" att.x ""' and @y<'"" att.y ""' and @y+@h>'"" att.y ""' and @type='Tab']/@hwnd"").text 	if !tab return 	sleep,1 	hwnd:=tab 	ControlGet,tabnum,tab,,,ahk_id%tab% 	tt:=Gui.sn(""//*[contains(@type,'Tab')]"") 	ctrl:=gui.ssn(""//tablist/tab[text()='"" tab ""']/@num"").text 	if att.tab 	tabnum:=att.tab 	if tabnum&&ctrl{ 		tab:=[] 		Gui,1:Tab,%tabnum%,%ctrl% 		tab.tab:=tabnum,tab.ctrl:=ctrl,tab.hwnd:=hwnd 		return tab 	} } edit(switch=""""){ 	tabswitch: 	if WinExist(hwnd([2]))=0&&hwnd(2) 	hwnd({remove:2}) 	if (hwnd(2)=""""){ 		static tab 		Gui,2:Default 		Menu,Edit,Add,Help,editmenu 		Gui,2:Menu,Edit 		Gui,+Owner1 		Gui,-0x30000 +hwndhwnd 		Gui,Add,Tab,Buttons w300 h100 hwndtab gtabswitch vtab,Controls|GUI Settings|Settings 		v.tab:=tab 		Gui,Tab 		Gui,Add,StatusBar,,foo 		hwnd(2,hwnd),VarSetCapacity(rect,A_PtrSize*4) 		SendMessage,(0x1300|10),1,&rect,,ahk_id%tab% ;TCM_GETITEMRECT 		height:=NumGet(rect,12) 		SysGet,h,55 		height+=h-3 		ControlMove,SysTabControl321,,,,% height-h+3,% hwnd([2]) 		Gui,Add,TreeView,w300 h600 xm y%height% AltSubmit geditsort Section hwndhwnd Checked 		Gui,Show,% size(2,""x5"") "" AutoSize NA"",Edit Control 		mode_select() 	} 	Gui,2:Submit,Nohide 	tab:=switch?switch:tab 	GuiControl,2:ChooseString,SysTabControl321,%Tab% 	Gui,2:Default 	GuiControl,2:-Redraw,SysTreeView321 	TV_Delete() 	v.editvalue:=[],v.tvrem:=[] 	if (tab=""settings""){ 		roots:=[] 		con:=controls.sn(""//controls/*"") 		root:=TV_Add(""Hotkeys"",0,""Expand"") 		v.tvrem[root]:=1 		while,cc:=con.item(a_index-1) 		child:=TV_Add(cc.nodename "" : "" settings.ssn(""//hotkeys/"" cc.nodename).text,root),v.editvalue[child]:={desc:cc.nodename,control:cc.nodename,hotkey:1},v.tvrem[child]:=1 		for a,b in v.personal{ 			root:=TV_Add(b.hotkey.main,0,""Expand"") 			v.tvrem[root]:=1 			for c,d in b.keys{ 				key:=settings.ssn(""//hotkey[@label='"" b.hotkey.label ""']/key[@desc='"" d.1 ""']/@value"").text 				key:=key?key:d.2 				child:=TV_Add(d.1 "" : "" key,root),v.editvalue[child]:={value:key,desc:d.1,gui:1,parent:""settings"",root:cc.nodename} 				v.tvrem[child]:=1 			} 		} 		root:=TV_Add(""Quick Options"",0,""Expand""),v.quick:=root 		for a,b in [""Snap To Grid"",""Grid"",""Borders"",""Warn Overwrite""] 		child:=TV_Add(b,root,settings.ssn(""//options/"" clean(b)).text?""Check"":""""),v.editvalue[child]:={quick_options:1,value:b} 		v.tvrem[root]:=1 		GuiControl,2:+Redraw,SysTreeView321 		hidecheck() 		return 	} 	if (tab=""GUI Settings""){ 		info:=controls.sn(""//window/*""),stop:=[] 		style:=TV_Add(""GUI"",0,""Expand""),oo:=TV_Add(""Options"",0,""Expand"") 		constants:=TV_Add(""Constants"",0,""Expand"") 		for a,b in [style,constants,oo] 		v.tvrem[b]:=1 		qa:=gui.ea(""//show"") 		while,in:=info.item(A_Index-1){ 			ea:=xml.easy(in),options:=qa[in.nodename],options:=RegExReplace(options,"" "","",""),value:=ea.value 			if value in %options% 			{ 				check=Check 				if value in center,xcenter,ycenter 				stop[value]:=1 			} 			else 			check= 			if (in.nodename=""gui"") 			child:=TV_Add(ea.value "" : "" ea.desc,style,Check),v.editvalue[child]:={value:ea.value,desc:ea.desc,gui:2,parent:""gui""} 			if in.nodename=""options"" 			child:=TV_Add(ea.value "" : "" ea.desc,oo,Check),v.editvalue[child]:={value:ea.value,desc:ea.desc,gui:2,parent:""options""} 			if (in.nodename=""constants""){ 				if (ea.value=""x""||ea.value=""y"")&&(stop[ea.value ""center""]||stop.center) 				continue 				child:=TV_Add(ea.desc "" : "" qa[ea.value],constants,Check),v.editvalue[child]:={value:ea.value,desc:ea.desc,gui:2,parent:""constants"",start:qa[ea.value]} 				v.tvrem[child]:=1 			} 		} 		GuiControl,2:+Redraw,SysTreeView321 		hidecheck() 		return 	} 	; all of these are to use the v.editvalue[child]:={value:ea.value,desc:ea.desc} structure 	; ^----type:=type of control 	if (tab=""Controls""){ 		selected:=gui.sn(""//selected/*""),typecount:=0,types:=[],expand:=selected.length>1?"""":"" Expand"" 		search:=selected.length>1?""//multi/Constants/*"":""//constants/Constants/*"" 		while,sel:=selected.item(A_Index-1){ 			ea:=xml.easy(gui.current(sel.text)),options:=RegExReplace(ea.options,"" "",""|"") 			if !ea.Type 			continue 			if types[ea.type] 			continue 			root:=TV_Add(ea.type,0,""Sort"" expand),style:=TV_Add(""Style"",root,""expand""),constants:=TV_Add(""Constants"",root,""expand""),v.tvrem[root]:=1 			v.tvrem[style]:=1,v.tvrem[constants]:=1 			info:=controls.sn(""//"" ea.type ""/*|"" search) 			while,in:=info.item(A_Index-1){ 				ee:=xml.easy(in),check:="""" 				if (in.nodename=""style""&&options) 				check:=RegExMatch(ee.value,""("" options "")\b"")?""Check"":"""" 				if (in.nodename=""style"") 				child:=TV_Add(ee.value "" : "" ee.desc,style,check),v.editvalue[child]:={value:ee.value,desc:ee.desc,type:ea.type,parent:""style""} 				if (in.nodename=""constants"") 				child:=TV_Add(selected.length=1?ee.desc "" : "" ea[ee.value]:ee.desc,constants),v.editvalue[child]:={value:ee.value,desc:ee.desc,type:ea.type,parent:""constants""},v.tvrem[child]:=1 			} 			types[ea.type]:=1 		} 		if !(Expand){ 			root:=TV_Add(""All Selected"",0,""Expand"") 			for a,b in {Font:""font"",Color:""color""} 			child:=TV_Add(a,root),v.editvalue[child]:={value:b,desc:b,type:""All"",parent:""All Selected""},v.tvrem[child]:=1 			v.tvrem[root]:=1 		} 		hidecheck() 	} 	GuiControl,2:+Redraw,SysTreeView321 	return 	editsort: 	if !A_EventInfo 	return 	if !v.editvalue[A_EventInfo] 	return 	ev:=v.editvalue[A_EventInfo],v.lastev:=ev 	if (ev.quick_options){ 		option:=settings.add(""options/"" clean(ev.value)) 		option.text:=check:=TV_Get(A_EventInfo,""Check"")?1:0 		if (ev.value=""Borders""){ 			reload(),Edit(""Settings"") 			ControlSend,SysTreeView321,^{End},% hwnd([2]) 			WinActivate,% hwnd([2]) 		} 			TV_Modify(v.quick,""Select Vis Focus"") 		if (ev.value=""warn overwrite"") 		return 		refresh: 		WinSet,Redraw,,% hwnd([1]) 		return 	} 	if (ev.parent=""settings""){ 		smalledit(ev.desc,ev.value) 		return 	} 	if (ev.hotkey){ 		ea:=[],ea[ev.desc]:=settings.ssn(""//hotkeys/"" ev.desc).text 		smalledit(ev.desc,ea) 		return 	} 	if (ev.desc=""grid color""||ev.desc=""dot color""){ 		type:=ev.desc=""grid color""?""grid"":""dot"" 		ea:=settings.ea(""//settings/grid"") 		color:=RGB(dlg_color(RGB(ea[type]))) 		settings.add(""grid"").SetAttribute(type,color) 		makeblock() 		return 	} 	if (ev.gui){ 		return guiedit(ev) 	} 	if (ev.gui){ 		current:=gui.ssn(""//show""),options:=ssn(current,""@options"").text,new:="""" 		if (ev.parent=""styles""){ 			check:=TV_Get(A_EventInfo,""Check"")?ev.value:"""" 			if Check 			options.="" "" check 			if (Check=""""){ 				Loop,Parse,options,%A_Space%,%A_Space% 				if (A_LoopField!=ev.value) 				new.=A_LoopField "" "" 			} 			options:=new?new:options 			current.SetAttribute(""options"",Trim(options)) 			options:=RegExReplace(options,""i)(Hide|Minimize)"") 			Gui,1:Show,%options% 			mode_select() 		} 		if (ev.parent=""constants"") 		smalledit(ev.value,gui.ea(""//show"")) 		return 	} 	if (ev.type=""Picture""&&InStr(ev.desc,""name of control"")){ 		current:=gui.current(v.last),ea:=xml.easy(current) 		FileSelectFile,file,,% ea.value,Select a new file.,*.png;*.gif;*.jpg 		if ErrorLevel||file="""" 		return 		current.SetAttribute(""value"",file) 		update(current),edit() 		if (v.currentmode!=""interact"") 		highlight() 		return 	} 	if (ev.desc=""font""){ 		if !gui.allsel() 		return 		if ev.parent=""all selected"" 		list:=gui.ssn(""//*[("" gui.allsel() "") and @font]""),ea:=xml.easy(list) 		else 		list:=gui.ssn(""//*[("" gui.allsel() "") and @font and @type='"" ev.type ""']""),ea:=xml.easy(list) 		if !ea.font 		ea:={font:""Tahoma""} 		dlg_font(ea) 		if (ev.parent=""all selected""){ 			selected:=gui.sn(""//selected/*"") 			while,sel:=selected.item(A_Index-1){ 				current:=gui.current(sel.text) 				if !RegExMatch(ssn(current,""@type"").text,""(Picture|Slider|Progress)"") 				for a,b in ea 				current.SetAttribute(a,b) 				update(current) 			} 		} 		else if (ev.parent=""constants""){ 			list:=gui.allsel() 			list:=gui.sn(""//*[("" list "") and @type='"" ev.type ""']"") 			while,ll:=list.item(A_Index-1){ 				for a,b in ea 				ll.SetAttribute(a,b) 				update(ll) 			} 		} 		edit() 		return 	} 	if (ev.desc=""color""||ev.desc=""background color""){ 		selected:=gui.sn(""//selected/*""),allsel:=gui.allsel() 		if allsel{ 			allsel:=""("" allsel "") and @"" ev.value 			color:=gui.ssn(""//*["" allsel ""]/@"" ev.value).text 			color:=RGB(dlg_color(RGB(color))) 			while,sel:=selected.item(a_index-1){ 				current:=gui.current(sel.text),current.SetAttribute(ev.value,color) 				update(current) 			} 			highlight() 		} 		return 	} 	if (ev.parent=""style"") 	return styles() 	;messed up 	if ev.value 	hwnd({remove:44}),smalledit(ev.value,gui.ea(""//*[@hwnd='"" v.last ""']"")) 	return 	2GuiEscape: 	2GuiClose: 	hwnd({remove:2}) 	return 	editgo: 	Gui,2:Default 	ControlGetText,newval,Edit2,% hwnd([44]) 	hwnd({remove:44}) 	ev:=v.lastev 	if ev.Gui=2 	return guiedit(ev,newval) 	if (ev.parent=""settings""){ 		TV_Modify(TV_GetSelection(),"""",ev.desc "" : "" newval) 		settings.ssn(""//actions/hotkey/key[@desc='"" ev.desc ""']"").SetAttribute(""value"",newval) 		gui_hotkey() 		return 	} 	if (ev.gui){ 		current:=gui.ssn(""//show"") 		current.SetAttribute(ev.value,newval) 		ea:=xml.easy(current) 		if RegExMatch(ev.value,""(x|y|w|h)"") 		WinMove,% hwnd([1]),,% ea.x,% ea.y,% ea.w+(v.Border*2),% ea.h+(v.Border*2)+v.Caption 		edit(),dupcheck() 		return 	} 	if (ev.hotkey){ 		TV_Modify(TV_GetSelection(),"""",ev.desc "" : "" newval) 		settings.add(""hotkeys/"" ev.desc).text:=newval 		gui_hotkey() 		return 	} 	list:=gui.sn(""//*[("" gui.allsel() "") and @type='"" ev.type ""']"") 	TV_Modify(TV_GetSelection(),""Select Vis Focus"",ev.desc "" : "" newval) 	current:=gui.current(v.last),old:=xml.easy(current) 	if ev.value=""g"" 	newval:=clean(newval) 	current.SetAttribute(ev.value,newval) 	att:=xml.easy(current) 	;do a reload of a single control here. 	if (att.type=""ListView""&&ev.value=""value""){ 		gui.remove(""//*[@hwnd='"" att.hwnd ""']"") 		DllCall(""DestroyWindow"",uint,att.hwnddd) 		newcon:=add_control(att.type,att) 		current:=gui.current(newcon.hwnd) 		v.removelist.Insert(con) 		gui.add(""selected/hwnd"",{text:newcon.hwnd}) 		v.last:=newcon.hwnd 	} 	update(current,ev.value,old[ev.value]),highlight() 	if InStr(ev.desc,""will reload"") 	reload() 	hwnd({remove:44}),edit() 	dupcheck() 	return } smalledit(ll,last){ 	num:=ssn(controls.ssn(""//*[@value='"" ll ""']""),""@type"").text?""number"":"""" 	VarSetCapacity(rect,A_PtrSize*4),NumPut(A_EventInfo,rect,0,""UPtr"") 	SendMessage,(0x1100|4),true,&rect,SysTreeView321,% hwnd([2]) 	y:=NumGet(rect,4)&0xffff 	ControlGet,hwnd,hwnd,,SysTreeView321,% hwnd([2]) 	WinGetPos,x,yy,,,ahk_id%hwnd% 	if hwnd(44) 	hwnd({remove:44}) 	Gui,44:Default 	Gui,44:-Caption +hwndhwnd Owner2 	Gui,44:Margin,0,0 	text:=controls.ssn(""//*[@value='"" ll ""']/@desc"").text,hwnd(44,hwnd) 	Gui,Add,Edit,Disabled,% v.editvalue[A_EventInfo].desc "" :"" 	Gui,Add,Edit,%num% x+0 w150,% IsObject(last)?last[ll]:last 	Gui,Add,Button,x+0 y-1 Default geditgo,Done 	x:=x+2+NumGet(rect,0)&0xffff,y:=y+yy 	Gui,Show,x%x% y%y% 	v.editing:=A_EventInfo 	return 	44GuiEscape: 	hwnd({remove:44}) 	return } hidecheck(){ 	Gui,2:Default 	for id in v.tvrem{ 		VarSetCapacity(tvitem,A_PtrSize*4) 		info:=A_PtrSize=4?{0:8,4:id,12:0xf000}:{0:8,8:id,20:0xf000} 		for a,b in info 		NumPut(b,tvitem,a) 		SendMessage,4415,0,&tvitem,SysTreeView321,% hwnd([2]) 	} } update(node,change="""",old="""",noredraw=""""){ 	ea:=xml.easy(node) 	if (RegExMatch(change,""i)(w|h)"")&&ea.type=""Picture""){ 		MsgBox,4,Resize Image,Keep Aspect Ratio? 		IfMsgBox,Yes 		{ 			other:=change=""w""?""h"":""w"",ea[other]:=ea[other]*ea[change]/old,ea[other]:=Floor(ea[other]) 			node.SetAttribute(other,ea[other]) 		} 		WinActivate,% hwnd([1]) 		WinSet,Redraw,,% hwnd([1]) 		GuiControl,1:movedraw,% ea.hwnd,% ""w"" ea.w "" h"" ea.h 		GuiControl,1:,% ssn(node,""@hwnd"").text,% ""*w-1 "" ssn(node,""@value"").text 	} 	else if (ea.Type=""Picture""){ 		current:=gui.current(ea.hwnd) 		GuiControl,1:,% ssn(node,""@hwnd"").text,% ""*w-1 "" ea.value 		GuiControl,1:movedraw,% ea.hwnd 		for a,b in getpos(ea.hwnd) 		if a not in x,y 		current.SetAttribute(a,b) 		ea:=xml.easy(current) 	} 	value:=RegExMatch(ea.type,""i)(ComboBox|Tab|Tab2|DropDownList|ListBox)"")?""|"" ea.value:ea.value 	GuiControl,1:,% ea.hwnd,%value% 	for a,b in ea 	if a in x,y,w,h 	pos.=a b "" "" 	ea.x+=v.Border,ea.y+=v.Border+v.Caption 	grid(ea.x,ea.y,1) 	Gui,1:Default 	Gui,1:Font,% compilefont(ea),% ea.font 	GuiControl,1:Font,% ea.hwnd 	GuiControl,1:movedraw,% ea.hwnd,%pos%	 	Gui,1:Font 	return } checkfiles(){ 	temp:=ComObjCreate(""MSXML2.DOMDocument"") 	if !fileexist(""lib"") 	FileCreateDir,lib 	list:=[] 	for a,b in {""controls.xml"":{path:""lib\controls.xml"",version:""0.001.5""},""tile.bmp"":{path:""tile.bmp""}}{ 		temp.load(b.path),vers:=ssn(temp,""//version"").text,verver:=b.version 		if b.version 		{ 			if instr(vers,""auto_version"") 			continue 			if (vers<verver) 			FileDelete,% b.path 		} 		if !FileExist(b.path) 		list[a]:=b.path 	} 	for a,b in list{ 		if (InStr(a,"".xml"")){ 			con:=URLDownloadToVar(""http://files.maestrith.com/NewGUICreator/"" a,400,50,""Downloading controls.xml"",""Please wait..."") 			FileAppend,%con%,% b 		} 		else 		{ 			FileDelete,%b% 			UrlDownloadToFile,http://www.maestrith.com/files/GUICreator/%a%,%b% 		} 	} 	SplashTextOff 	temp:="""" } rcm(){ 	GuiContextMenu: 	MouseGetPos,x,y,,con,2 	Grid(x,y,1),con:=married(con),v.last:=con 	current:=gui.current(con) 	ancestor:=ssn(current,""ancestor::*[@type='Tab' or @type='Tab2']/@hwnd"") 	SendMessage, 0x1304,,,,% ""ahk_id"" ancestor.text 	tabcount:=ErrorLevel 	c:=controls.sn(""//controls/*"") 	while,b:=c.item(A_Index-1).nodename 	Menu,Add,Add,%b%,Add 	Menu,rcm,Add,&Add,:Add 	if (tabcount>1&&tabcount!=""FAIL""){ 		Loop,%tabcount% 		Menu,movetab,Add,%A_Index%,movetab 		Menu,rcm,Add,Move to tab,:movetab 	} 	Menu,rcm,Add 	menu:=[{[""File"",""menu""]:[""New GUI"",""Load GUI"",""Save GUI"",""Save GUI As"",""Export GUI"",""Reload"",""Test GUI""]} 	,{[""Edit"",""menu""]:[""Copy GUI to Clipboard"",""Remove Selected"",""Reorder GUI""]} 	,{[""About"",""menu""]:[""GUI Creator Version""]} 	,{[""Settings"",""settings""]:[""GUI Settings"",""Settings""]} 	,{[""Refresh""]:[""Refresh"",""split""]} 	,{[""Help""]:[""editmenu""]}] 	for a,b in menu 	for c,d in b{ 		menu:=c.1 2 		if c.2 		for e,f in d{ 			Menu,%menu%,Add,%f%,% c.2 			Menu,rcm,Add,% c.1,:%menu% 			lastmenu:=c.2 		} 		else 		{ 			if d.2=""split"" 			Menu,rcm,Add 			Menu,rcm,Add,% c.1,% d.1 		} 	} 	Menu,rcm,Show 	Menu,rcm,DeleteAll 	if (tabcount>1&&tabcount!=""FAIL""){ 		Menu,movetab,DeleteAll 		Menu,movetab,Delete 	} 	return 	menu: 	fun:=clean(A_ThisMenuItem) 	if IsFunc(fun) 	%fun%() 	return 	add: 	value:="""" 	if (A_ThisMenuItem=""Picture""){ 		FileSelectFile,file,,,Select an image,*.jpg;*.png;*.gif 		if ErrorLevel||file="""" 		return 		value:=file 	} 	value:=value?value:A_ThisMenuItem 	add_control(A_ThisMenuItem,{x:x,y:y,value:value,type:A_ThisMenuItem}) 	return 	settings: 	select:=A_ThisMenuItem=""settings""?3:2 	edit(A_ThisMenuItem) 	return 	editmenu: 	mm:=A_ThisMenuItem 	if (mm=""help"") 	help() 	return } clean(info,options=""""){ 	if !options 	return RegExReplace(info,"" "",""_"") 	return RegExReplace(info,""_"","" "") } save_gui_as(){ 	option:=settings.ssn(""//options/Warn_Overwrite"").text?""S16"":"""" 	FileSelectFile,save,%option%,,Save GUI As:,*.xml 	if (ErrorLevel||save="""") 	return 	save:=InStr(save,"".xml"")?save:save "".xml"" 	save_gui(save) } Dlg_Font(ByRef Style,window="""",effects=1){ 	window:=window?window:hwnd(2) 	style.color:=RGB(style.color) 	VarSetCapacity(logfont,60),LogPixels:=DllCall(""GetDeviceCaps"",""uint"",DllCall(""GetDC"",""uint"",0),""uint"",90),Effects:=0x041+(Effects?0x100:0) 	for a,b in fontval:={16:style.bold?700:400,20:style.italic,21:style.underline,22:style.strikeout,0:style.size?Floor(style.size*logpixels/72):16} 	NumPut(b,logfont,a) 	cap:=VarSetCapacity(choosefont,A_PtrSize=8?103:60,0) 	NumPut(hwnd,choosefont,A_PtrSize) 	for index,value in [[cap,0,""Uint""],[&logfont,A_PtrSize=8?24:12,""Uptr""],[effects,A_PtrSize=8?36:20,""Uint""],[style.color,A_PtrSize=4?6*A_PtrSize:5*A_PtrSize,""Uint""]] 	NumPut(value.1,choosefont,value.2,value.3) 	if (A_PtrSize=8) 	strput(style.font,&logfont+28),r:=DllCall(""comdlg32\ChooseFont"",""uptr"",&CHOOSEFONT,""cdecl""),name:=strget(&logfont+28) 	else 	strput(style.font,&logfont+28,32,""utf-8""),r:=DllCall(""comdlg32\ChooseFontA"",""uptr"",&CHOOSEFONT,""cdecl""),name:=strget(&logfont+28,32,""utf-8"") 	if !r 	return 0 	st:=[] 	for a,b in {bold:16,italic:20,underline:21,strikeout:22} 	st[a]:=NumGet(logfont,b,""UChar"") 	st.bold:=st.bold<188?0:1 	st.color:=RGB(NumGet(choosefont,A_PtrSize=4?6*A_PtrSize:5*A_PtrSize)) 	st.size:=NumGet(CHOOSEFONT,A_PtrSize=8?32:16,""UChar"")//10 	st.font:=name 	style:=st } rgb(c){ 	setformat,IntegerFast,H 	c:=(c&255)<<16 | (c&65280) | (c>>16),c:=SubStr(c,1) 	SetFormat, integerfast,D 	return c } Dlg_Color(Color,hwnd=""""){ 	static 	if !cc{ 		VarSetCapacity(cccc,16*A_PtrSize,0),cc:=1,size:=VarSetCapacity(CHOOSECOLOR,9*A_PtrSize,0) 		Loop,16{ 			IniRead,col,color.ini,color,%A_Index%,0 			NumPut(col,cccc,(A_Index-1)*4,""UInt"") 		} 	} 	NumPut(size,CHOOSECOLOR,0,""UInt""),NumPut(hwnd,CHOOSECOLOR,A_PtrSize,""UPtr"") 	,NumPut(Color,CHOOSECOLOR,3*A_PtrSize,""UInt""),NumPut(3,CHOOSECOLOR,5*A_PtrSize,""UInt"") 	,NumPut(&cccc,CHOOSECOLOR,4*A_PtrSize,""UPtr"") 	ret:=DllCall(""comdlg32\ChooseColorW"",""UPtr"",&CHOOSECOLOR,""UInt"") 	if !ret 	exit 	Loop,16 	IniWrite,% NumGet(cccc,(A_Index-1)*4,""UInt""),color.ini,color,%A_Index% 	IniWrite,% Color:=NumGet(CHOOSECOLOR,3*A_PtrSize,""UInt""),color.ini,default,color 	return Color } compilefont(ea){ 	if ea.size 	font.=""s"" ea.size 	if ea.color!="""" 	font.="" c"" ea.color 	for a,b in {Bold:ea.bold,Italic:ea.italic,Strikeout:ea.strikeout,Underline:ea.underline} 	if b 	font.="" "" a "" "" 	return Trim(font) }   styles(){ 	styles: 	if A_GuiEvent!=Normal 	return 	if !A_EventInfo 	return 	ControlGet,tab,tab,,SysTabControl321,% hwnd([2]) 	if Tab>1 	goto styleend 	if !v.editvalue[A_EventInfo].value 	return 	check:=TV_Get(A_EventInfo,""Check"")?1:0 	value:=v.editvalue[A_EventInfo].value 	current:=gui.current(v.last),ea:=xml.easy(current),option:=A_EventInfo 	op:=ea.options,contain:=0 	Loop,Parse,op,%A_Space%,%A_Space% 	if (A_LoopField==value) 	contain:=1 	if check&&contain=0 	ea.options.="" "" value 	if (check=0&&contain){ 		op:=ea.options,list:="""" 		Loop,Parse,op,%A_Space%,%A_Space% 		if (A_LoopField!=value) 		list.=A_LoopField "" "" 		ea.options:=Trim(list) 	} 	if InStr(value,""-"") 	flip:=check=0?RegExReplace(value,""\-"",""+""):value 	if !InStr(value,""-"") 	flip:=check=0?""-"" value:""+"" value 	sel:=gui.sn(""//selected/*"") 	TV_GetText(parent,TV_GetParent(TV_GetParent(A_EventInfo))) 	while,hwnd:=sel.item(A_Index-1).text{ 		current:=gui.current(hwnd) 		type:=ssn(current,""@type"").text 		if (type!=parent) 		continue 		current.SetAttribute(""options"",Trim(ea.options)) 		if (InStr(flip,""Multi"")&&type=""ListView"") 		continue 		GuiControl,1:%flip%,% hwnd 		GuiControl,1:movedraw,% hwnd 	} 	if InStr(v.editvalue[A_EventInfo].desc,""GUI Will Reload"") 	reload() 	return 	styleend: 	if (tab=2){ 		check:=TV_Get(A_EventInfo,""Check"")?1:0 		setting:=v.windowoptions[A_EventInfo],new:="""" 		show:=gui.ssn(""//show/@options"") 		ss:=show.text 		if check 		new:=Trim(ss "" "" setting) 		else 		Loop,Parse,ss,%A_Space%,%A_Space% 		if (A_LoopField!=setting) 		new:=Trim(new "" "" A_LoopField) 		gui.add(""gui/show"",{att:{options:new}}) 	} 	return } reload(){ 	current:=gui.xml.xml 	v.loading:=1 	Gui,1:Default 	gui(1),gui:=new xml(""gui"") 	temp:=new xml(""temp"") 	temp.xml.loadxml(current),tabcount:=0 	ctrl:=temp.sn(""//@hwnd/.."") 	while,ct:=ctrl.item(A_Index-1){ 		ea:=xml.easy(ct) 		if ea.tabnum&&!ea.tab	;<---This is for 		ea.tab:=ea.tabnum		;<---backward compatibility. 		add_control(ea.type,ea) 	} 	filename:=temp.ssn(""//file/filename"").text 	dir:=temp.ssn(""//file/dir"").text 	gui.add(""gui/file/filename"").text:=filename 	Gui.add(""gui/file/dir"").text:=dir 	gui.Transform() 	ea:=temp.ea(""//show""),gui.ssn(""*"").AppendChild(temp.ssn(""//show"")) 	ea.options:=RegExReplace(ea.options,""i)(Hide|Minimize|NA|NoActivate)"") 	for a,b in ea 	if a in x,y,w,h 	if b 	position.=a b "" "" 	Gui,Show,% position "" "" ea.options 	v.loading:=0 	WinSetTitle,% hwnd([1]),,GUI Creator : %filename% 	snap(1),gui_hotkey() } select_all(){ 	selectall: 	gui.remove(""//gui/selected"") 	selected:=gui.add(""gui/selected"") 	all:=gui.sn(""//*[@hwnd]/@hwnd"") 	while,aa:=all.item(A_Index-1){ 		gui.add(""gui/selected/hwnd"",{dup:1}).text:=aa.text 		Gui.unique(""templist/control"",{att:{control:aa.text}},""control"") 	} 	highlight(),edit() 	return } compile_gui(ret=""""){ 	gui.Transform() 	compile:=[] 	find_duplicates() 	www:=gui.sn(""//*[@font='' or @type='Picture' or @type='MonthCal']/@hwnd"") 	while,ww:=www.item(A_Index-1){ 		current:=gui.current(ww.text) 		for a,b in [""bold"",""italic"",""underline"",""strikeout"",""font"",""size""] 		current.RemoveAttribute(b) 	} 	temp:=new xml(""temp""),list:=[] 	biglist:=gui.sn(""//*[@hwnd]"") 	if gg:=gui.ssn(""//show/@gui"").Text 	total:=""Gui,"" gg ""`n"" 	while,bl:=biglist.item(A_Index-1){ 		ea:=xml.easy(bl),position:="""" 		list:=att.r?[""x"",""y"",""w""]:[""x"",""y"",""w"",""h""] 		for a,b in list 		if ea[b] 		position.=b ea[b] "" "" 		if ea.r 		position.=""r"" ea.r "" "" 		cf:=compilefont(ea) 		fm:=ea.font?cf:"""" 		if (ea.tab!=lasttab) 		total.=""Gui,Tab,"" ea.tab ""`r`n"" 		if (lastfont&&ea.font="""") 		total.=""Gui,Font`r`n"" 		if (lastfont!=cf ea.font&&ea.font) 		total.=""Gui,Font,Normal "" compilefont(ea) "","" ea.font ""`r`n"" 		color:=ea.color?""c"" ea.color:"""" 		options:=ea.options?ea.options "" "":"""" 		glabel:=ea.g?"" g"" ea.g:"""" 		var:=ea.v?"" v"" ea.v:"""" 		back:=ea.background?"" Background"" ea.background:"""" 		toption:=Trim(RegExReplace(position options color var glabel back,""\s\s"","" "")) 		total.=""Gui,Add,"" ea.type "","" toption "","" ea.value ""`r`n"" 		lastfont:=cf ea.font 		lasttab:=ea.tab 		var:=glabel:=back:="""" 		if InStr(ea.type,""Tab"") 		lasttab:="""" 	} 	winoptions:="" "" gui.ssn(""//show/@options"").Text 	ea:=gui.ea(""//show""),position:="""" 	if !InStr(ea.gui,""Resize"") 	ea.x+=Round(v.border/2),ea.y+=Round(v.border/2) 	if !RegExMatch(ea.options,""i)\bcenter\b""){ 		if !InStr(ea.options,""xcenter"") 		position.=""x"" ea.x 		if !InStr(ea.options,""ycenter"") 		position.="" y"" ea.y 	} 	position.="" w"" ea.w "" h"" ea.h 	total.=""Gui,Show,"" position winoptions "","" gui.ssn(""//show/@title"").text ""`r`nReturn`r`n"" 	labels:=gui.sn(""//*[@g!='']""),one:=[] 	while,lab:=labels.item(a_index-1){ 		ea:=xml.easy(lab) 		if !one[ea.g]{ 			total.=ea.g "":`r`n"" 			if prog:=gui.ssn(""//labels/"" ea.g).text 			total.=RegExReplace(prog,""\n"",""`r`n"") ""`r`n"" 			total.=""Return`r`n"" 		} 		one[ea.g]:=1 	} 	total.=""GuiClose:`r`nExitApp`r`nReturn"" 	if ret 	return total 	show_code() } find_duplicates(){ 	dup:=gui.sn(""//*[@v!='']""),duplicate:=[] 	while,dd:=dup.item(A_Index-1){ 		ea:=gui.easy(dd) 		check:=sn(dd,""//*[@v='"" ea.v ""']"") 		if check.length>1 		while,cc:=check.item(A_Index-1) 		duplicate[ea.hwnd]:=1 	} 	if duplicate.MinIndex(){ 		hwnd({remove:2}) 		gui.remove(""//gui/selected"") 		for a,b in duplicate 		gui.add(""gui/selected/hwnd"",{text:a,dup:1}),highlight() 		m(""The highlighted controls have duplicate variables."",""Please fix this."") 		Exit 	} } /* edithotkey(){ 	edithotkey: 	global hot 	if A_GuiEvent!=Normal 	return 	WinGetPos,xx,yy,,,% hwnd([2]) 	Gui,2:ListView,SysListView322 	ControlGetPos,x,y,w,h,SysListView322,% hwnd([2]) 	VarSetCapacity(rect,16) 	SendMessage,(0x1000|14),LV_GetNext()-1,&rect,SysListView322,% hwnd([2]) 	Gui,44:+Owner2 +hwndhwnd -Caption 	LV_GetText(control,LV_GetNext(),2),y:=NumGet(rect,4)+y+yy,x:=xx+x+1,LV_GetText(key,LV_GetNext()) 	Gui,44:Add,Hotkey,ghotkey vhot,%key% 	Gui,44:Add,Edit,x+0 Disabled,%control% 	Gui,44:Add,Button,x+0 gehk,Done 	Gui,44:Add,Button,x+0 gehk,Clear 	Gui,44:Show,x%x% y%y% 	return 	ehk: 	if (A_GuiControl=""Done"") 	goto 44GuiEscape 	if (A_GuiControl=""Clear"") 	settings.remove(""//hotkeys/"" control),LV_Modify(LV_GetNext(),""Col1"","""") 	44GuiEscape: 	Gui,44:Destroy 	gui_hotkey() 	return 	hotkey: 	Gui,44:Submit,Nohide 	Gui,2:Default 	Gui,2:ListView,SysListView322 	settings.add(""hotkeys/"" control).text:=hot 	LV_Modify(LV_GetNext(),""Col1"",hot) 	return } */ mode_select(){ 	static modes:={0:""Move"",1:""Resize"",2:""Interact""},mode=0 	modesel: 	if A_ThisHotkey 	ea:=settings.ssn(""//key[@value='"" A_ThisHotkey ""']/@desc"").text 	if (ea=""previous mode""){ 		if mode>0 		mode-- 		else if mode=0 		mode:=2 	} 	if (ea=""next mode""){ 		mode++ 		mode:=Mod(mode,3) 	} 	sleep,1 	Gui,2:Default 	SB_SetText(""LButton mode : "" modes[mode]) 	v.currentmode:=modes[mode] 	Gui,1:Default 	if !hwnd(2) 	TrayTip,GUI Creator,% ""LButton mode : "" modes[mode] 	else 	TrayTip 	return } resize(templist,x,y){ 	Grid(x,y) 	while,GetKeyState(""LButton"",""P""){ 		MouseGetPos,xx,yy 		Grid(xx,yy) 		offw:=xx-x,offh:=yy-y 		change:=lastx=xx?""h"":""w"",other:=change=""w""?""h"":""w"",oo:=[] 		if !(lastx=xx&&lasty=yy) 		while,tl:=templist.item(A_Index-1){ 			ea:=xml.easy(tl),w:=ea.w+offw,h:=ea.h+offh 			if (ea.type=""Picture"") 			w:=ea.w*h/ea.h,picture:=1 			GuiControl,1:movedraw,% ea.control,% ""w"" w "" h"" h 			ct:=gui.current(ea.control),ct.SetAttribute(""w"",w),ct.SetAttribute(""h"",h) 		} 		sleep,30 		lastx:=xx,lasty:=yy 	} 	if (picture){ 		while,tl:=templist.item(a_index-1) 		if (ssn(tl,""@type"").Text=""Picture"") 		update(gui.current(ssn(tl,""@control"").text)) 	} } help(){ 	help= 	( 	GUI Creator Help,Help: 	Press Ctrl+A to select all controls 	Hold Ctrl+LButton to toggle an items select state 	Hold Shift+LButton to add a control to the selection 	Hold Alt+LButton to interact with the control 	Scroll your mouse wheel to change LButton mode 	-(Current mode is on the bottom of the edit window) 	Delete deletes all selected controls. 	) 	MsgBox,32,GUI Creator,% RegExReplace(help,""\t"") } remove_selected(){ 	delete: 	selected:=gui.sn(""//selected/*"") 	while,sel:=selected.item(a_index-1){ 		con:=sel.text 		WinGetClass,out,ahk_id%con% 		if InStr(out,""SysTabControl""){ 			current:=gui.ssn(""//*[@hwnd='"" con ""']"") 			current.SetAttribute(""deleted"",1) 			gui.remove(""//*[@hwnd='"" con ""']"") 			ControlMove,,-55,-44,0,0,ahk_id%con% 			del:=sn(current,""descendant::*[@hwnd]"") 			while,dd:=del.item(a_index-1){ 				con:=ssn(dd,""@hwnd"").text 				DllCall(""DestroyWindow"",uint,con) 				gui.remove(""//*[@hwnd='"" con ""']"") 			} 			continue 		} 		DllCall(""DestroyWindow"",uint,con) 		WinGet,cl,ControlList,% hwnd([1]) 		Gui,1:Tab 		gui.remove(""//*[@hwnd='"" con ""']"") 	} 	highlight() 	WinSet,Redraw,,% hwnd([1]) 	return } gui_creator_version(){ 	Gui,88:Destroy 	Gui,88:Default 	Gui,88:+hwndhwnd 	hwnd(88,hwnd) 	Gui,Add,Edit,w500 h500,% URLDownloadToVar(""http://files.maestrith.com/NewGUICreator/GUI Creator.text"",250,50,""Downloading latest version info"",""Please wait..."") 	Gui,Add,Button,gvupd,Update Script 	Gui,Show,,Version=0.001.26 	ControlSend,Edit1,^{Home},% hwnd([88]) 	return 	vupd: 	Version=0.001.26 	ext:=A_IsCompiled?"".exe"":"".ahk"" 	FileMove,%A_ScriptName%,Backup-%version%-%A_ScriptName%,1 	SplashTextOn,200,50,Downloading,Please wait 	URLDownloadToFile,http://files.maestrith.com/NewGUICreator/GUI Creator%ext%,%A_ScriptName% 	SplashTextOff 	Run,%A_ScriptName% 	ExitApp 	return 	88GuiEscape: 	88GuiClose: 	hwnd({remove:88}) 	return } URLDownloadToVar(url,info*){ 	if info.1 	SplashTextOn,% info.1,% info.2,% info.3,% info.4 	hObject:=ComObjCreate(""WinHttp.WinHttpRequest.5.1"") 	hObject.Open(""GET"",url) 	hObject.Send() 	SplashTextOff 	return hObject.ResponseText } Copy_GUI_to_Clipboard(){ 	Copy_GUI_to_Clipboard: 	Clipboard:=compile_gui(1) 	TrayTip,GUI Creator,Script copied to your Clipboard 	return } makeblock(){ 	ea:=settings.ea(""//settings/grid"") 	dot:=ea.dot?ea.dot:0,grid:=ea.grid!=""""?ea.grid:0xEEEEEE 	image:=ComObjCreate(""WIA.ImageFile"") 	vector:=ComObjCreate(""WIA.Vector"") 	dot+=0,grid+=0 	vector.add(dot) 	loop,99 	vector.add(grid) 	image:=vector.imagefile(10,10) 	FileDelete,tile.bmp 	image.savefile(""tile.bmp"") 	display_grid(""removebrush"") 	WinSet,Redraw,,% hwnd([1]) } adjust(){ 	adjust: 	templist:=gui.sn(""//templist/*"") 	Gui.Transform() 	if !templist.length 	return 	killhighlight(),grid:=settings.ssn(""//options/Snap_To_Grid"").text 	direction:=settings.ssn(""//key[@value='"" A_ThisHotkey ""']/@desc"").text 	while,tl:=templist.item(A_Index-1){ 		ea:=xml.easy(tl) 		pos:=getpos(ea.control) 		if direction=Left 		pos.x-=grid?10:1 		if direction=Right 		pos.x+=grid?10:1 		if direction=up 		pos.y-=grid?10:1 		if direction=down 		pos.y+=grid?10:1 		grid(pos.x,pos.y) 		GuiControl,1:movedraw,% ea.control,% ""x"" pos.x "" y"" pos.y 		ct:=gui.current(ea.control),ct.SetAttribute(""x"",pos.x),ct.SetAttribute(""y"",pos.y) 	} 	highlight() 	return } Export_GUI(){ 	option:=settings.ssn(""//options/Warn_Overwrite"").text?""S16"":"""" 	FileSelectFile,file,%option%,,Choose a file to save the GUI.,*.ahk 	if ErrorLevel||file="""" 	return 	file:=InStr(file,"".ahk"")?file:file "".ahk"" 	gg:=compile_gui(1) 	FileDelete,%file% 	FileAppend,%gg%,%file% } show_code(){ 	info:=compile_gui(1) 	Gui,58:Destroy 	Gui,58:Add,Edit,w800 h800 -Wrap,% info 	Gui,58:Show 	return 	58GuiEscape: 	Gui,58:Destroy 	return } dupcheck(){ 	vars:=gui.sn(""//*[@v!='']""),list:=[] 	while vv:=vars.item(a_index-1){ 		ea:=xml.easy(vv) 		count:=gui.sn(""//*[@v='"" ea.v ""']"") 		if RegExReplace(gui[],""i)v="" Chr(34) ea.v Chr(34),,count)&&count>1 		list[ea.hwnd]:=1 	} 	if list.maxindex(){ 		gui.remove(""//selected"") 		for a in list 		gui.add(""gui/selected/hwnd"",{dup:1}).text:=a 		highlight() 		MsgBox,48,Variable Conflict!,The selected controls share the same Variable.  Please change them 	} } move(templist,x,y){ 	while,GetKeyState(""LButton"",""P""){ 		MouseGetPos,xx,yy 		Grid(xx,yy) 		if !(lastx=xx&&lasty=yy) 		while,tl:=templist.item(A_Index-1){ 			ea:=xml.easy(tl),x:=ea.x+xx,y:=ea.y+yy 			grid(x,y) 			GuiControl,1:movedraw,% ea.control,% ""x"" x "" y"" y 			ct:=gui.current(ea.control),ct.SetAttribute(""x"",x),ct.SetAttribute(""y"",y) 		} 		sleep,30 		lastx:=xx,lasty:=yy 	} } reorder_gui(){ 	static clist,tvlist 	Gui,3:Destroy 	Gui,3:Default 	Gui,+Owner1 +hwndhwnd 	hwnd(3,hwnd) 	Hotkey,IfWinActive,% hwnd([3]) 	Hotkey,+up,moveit,On 	Hotkey,+down,moveit,On 	Gui,Add,Text,,Usage: Press either Shift+Up or Shift+Down to move a control`nControls may be re-ordered if`n1.You move a control from a tab to the main GUI`n2.If you move a control from a GroupBox to the main Gui 	Gui,Add,TreeView,w300 h500 AltSubmit greorder 	reorderpop: 	gg:=gui.sn(""//*[@hwnd]""),clist:=[],tvlist:=[],tablist:=[] 	while,control:=gg.item(a_index-1){ 		if ssn(control,""@tab"").text{ 			node:=control 			while,node.nodename!=""tab"" 			node:=node.ParentNode 			last:=node.xml 			if (!tablist[node.xml]){ 				lasttab:=TV_Add(""Tab "" ssn(control,""@tab"").text,lastcontrol,""Expand"") 				parent:=lastcontrol 				tablist[node.xml]:=lasttab 			} 			parent:=tablist[node.xml] 			if ssn(control.ParentNode,""@type"").text=""GroupBox"" 			parent:=lastgroup 		} 		else if (control.ParentNode.nodename!=""window"") 		parent:=lastgroup 		else 		parent:=0 		con:=TV_Add(ssn(control,""@type"").text,parent,""Expand"") 		clist[con]:=ssn(control,""@hwnd"").text 		tvlist[ssn(control,""@hwnd"").text]:=con 		if InStr(ssn(control,""@type"").text,""Tab"") 		lastcontrol:=con 		if InStr(ssn(control,""@type"").text,""GroupBox"") 		lastgroup:=con 	} 	TV_Modify(TV_GetNext(),""Select Focus"") 	if A_ThisLabel=menu 	gosub high 	Gui,Show,,Reorder GUI 	return 	3GuiEscape: 	3GuiClose: 	Gui,3:Destroy 	return 	reorder: 	if A_GuiEvent not in normal,k 	return 	if A_GuiEvent=k 	if A_EventInfo=16 	return 	high: 	if !hwnd:=clist[TV_GetSelection()] 	return 	Gui.remove(""//selected""),Gui.Add(""gui/selected/hwnd"").text:=hwnd 	highlight() 	current:=gui.ssn(""//*[@hwnd='"" hwnd ""']"") 	if tab:=ssn(current,""@tab"").text{ 		phwnd:=ssn(current,""ancestor::*[@type='Tab' or @type='Tab2']/@hwnd"").text 		GuiControl,1:Choose,%phwnd%,%tab% 	} 	Gui,3:Default 	WinSet,Top,,% hwnd([3]) 	return 	moveit: 	Gui,3:Default 	TV_GetText(tt,TV_GetSelection()) 	if InStr(tt,""tab "") 	return m(""Can not move tabs"") 	nextitem:=A_ThisHotkey=""+up""?TV_GetPrev(TV_GetSelection()):TV_GetNext(TV_GetSelection()) 	first:=gui.ssn(""//*[@hwnd='"" clist[TV_GetSelection()] ""']"") 	second:=gui.ssn(""//*[@hwnd='"" clist[nextitem] ""']"") 	if !second 	return 	first.SetAttribute(""reorder"",1) 	top:=first.ParentNode 	if A_ThisHotkey=+up 	top.insertbefore(first,second) 	else 	top.insertbefore(second,first) 	GuiControl,-Redraw,SysTreeView321 	TV_Delete() 	gosub reorderpop 	select:=gui.ssn(""//@reorder/.."") 	select.RemoveAttribute(""reorder"") 	TV_Modify(tvlist[ssn(select,""@hwnd"").text],""Select Vis Focus"") 	GuiControl,+Redraw,SysTreeView321 	return } /* 	Move_Selected_Item_Up(){ 		GuiControl,-Redraw,SysTreeView321 		current:=current() 		if b4:=current.previousSibling{ 			current.SetAttribute(""here"",1) 			new:=b4.parentnode.insertBefore(current,b4) 			load_menu(x) 			clear_here() 		} 		GuiControl,+Redraw,SysTreeView321 	} 	Move_Selected_Item_Down(){ 		GuiControl,-Redraw,SysTreeView321 		current:=current() 		if b4:=current.nextSibling{ 			current.SetAttribute(""here"",1) 			new:=b4.parentnode.insertBefore(b4,current) 			load_menu(x) 			clear_here() 		} 		GuiControl,+Redraw,SysTreeView321 	} */ move_to_tab(){ 	movetab: 	current:=gui.current(v.last) 	current.SetAttribute(""tab"",A_ThisMenuItem) 	ea:=xml.easy(current),hwnd:=ea.hwnd 	add_control(ea.type,ea) 	DllCall(""DestroyWindow"",uint,gui.ea(""//*[@hwnd='"" hwnd ""']"").hwnd) 	current.ParentNode.RemoveChild(current),highlight() 	return } guiedit(ev,value=""""){ 	if A_GuiEvent!=Normal 	return 	if (value){ 		gui.ssn(""//show/@"" ev.value).text:=value 		edit(""GUI Settings""),vv:=ev.value,ea:=gui.ea(""//show"") 		if vv in x,y,w,h 		WinMove,% hwnd([1]),,% ea.x,% ea.y,% ea.w+(v.Border*2),% ea.h+(v.Border*2+v.Caption) 		return 	} 	if ev.parent=""constants"" 	return smalledit(ev.desc,ev.start) 	if !gui.ssn(""//show/@"" ev.parent) 	Gui.ssn(""//show"").SetAttribute(ev.parent,"""") 	toggle(gui.ssn(""//show/@"" ev.parent),ev.value,TV_Get(A_EventInfo,""Check"")) 	if ev.parent=""options"" 	Gui,1:Show,% RegExReplace(gui.ssn(""//show/@options"").text,""i)(Hide|Minimize|NA|NoActivate)"") 	edit(""GUI Settings"") } toggle(node,value,check){ 	values:=[],vv:=node.text "" "" value 	Loop,Parse,vv,%A_Space%,%A_Space% 	values[A_LoopField]:=1 	if !check 	values.remove(value) 	for a in values 	list.=a "" "" 	node.text:=Trim(list) } test_gui(){ 	static pid 	info:=""#SingleInstance,Force`n"" compile_gui(1) 	pid:=dynarun(info) 	ea:=gui.ea(""//show"") 	x:=ea.x,y:=ea.y 	if InStr(gui.ssn(""//show/@gui"").text,""-Caption""){ 		Gui,33:Destroy 		Gui,33:+AlwaysOnTop 		Gui,33:Add,Text,,This window pops up when you select no caption 		Gui,33:Add,Button,gshow,Show Window 		Gui,33:Add,Button,gkill,Kill Window 		Gui,33:Show,Center,Window control 	} 	return 	show: 	WinActivate,ahk_pid%pid% 	return 	33GuiClose: 	33GuiEscape: 	kill: 	WinKill,ahk_pid%pid% 	Gui,33:Destroy 	Gui,1:Default 	return } edit_labels(){ 	static 	labels:=gui.sn(""//*[@g!='']/@g"") 	Gui,4:Destroy 	Gui,4:+hwndhwnd 	hwnd(4,hwnd) 	Gui,4:Add,ListView,w150 h300 AltSubmit gpop,Labels 	Gui,4:Add,Edit,x+10 w500 h300 geditlabel veditlabel 	Gui,4:Default 	while,ll:=labels.item(a_index-1) 	LV_Add("""",ll.text) 	Gui,4:Show,,Label Editor 	LV_Modify(1,""Focus Vis Select"") 	return 	editlabel: 	Gui,4:Submit,Nohide 	LV_GetText(label,LV_GetNext()) 	gui.add(""labels/"" label).text:=editlabel 	return 	pop: 	Gui,4:Default 	LV_GetText(label,LV_GetNext()) 	ControlSetText,Edit1,% RegExReplace(gui.ssn(""//labels/"" label).text,""\n"",""`r`n""),% hwnd([4]) 	return 	4GuiClose: 	4GuiEscape: 	hwnd({remove:4}) 	return } ;http://www.autohotkey.com/community/viewtopic.php?t=63916 DynaRun(TempScript){ 	static _:=""uint"" 	@:=A_PtrSize?""Ptr"":_ 	name := ""GUI Creator Test"" 	__PIPE_GA_ := DllCall(""CreateNamedPipe"",""str"",""\\.\pipe\"" name,_,3,_,0,_,255,_,0,_,0,@,0,@,0) 	__PIPE_    := DllCall(""CreateNamedPipe"",""str"",""\\.\pipe\"" name,_,3,_,0,_,255,_,0,_,0,@,0,@,0) 	if (__PIPE_=-1 or __PIPE_GA_=-1) 	Return 0 	Run, %A_AhkPath% ""\\.\pipe\%name%"",,UseErrorLevel HIDE,PID 	If ErrorLevel 	MsgBox, 262144, ERROR,% ""Could not open file:`n"" __AHK_EXE_ """"""\\.\pipe\"" name """""""" 	DllCall(""ConnectNamedPipe"",@,__PIPE_GA_,@,0) 	DllCall(""CloseHandle"",@,__PIPE_GA_) 	DllCall(""ConnectNamedPipe"",@,__PIPE_,@,0) 	script := (A_IsUnicode ? chr(0xfeff) : (chr(239) . chr(187) . chr(191))) . TempScript 	if !DllCall(""WriteFile"",@,__PIPE_,""str"",script,_,(StrLen(script)+1)*(A_IsUnicode ? 2 : 1),_ ""*"",0,@,0) 	Return A_LastError 	DllCall(""CloseHandle"",@,__PIPE_) 	Return PID } This will not always be updated but this is the code as it is today. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 13 Jan 2014, 19:45 when running the script (above code), i receive an error that refers to AutoHotKeyU64.exe. Top Therobotmd Posts: 7 Joined: 06 Jan 2014, 03:50 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 18 Jan 2014, 17:39 Thank you sir! Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 19 Jan 2014, 21:04 Therobotmd wrote:Thank you sir! You are welcome Just so you know I am horrible at keeping up with code posts, I will do my best to remember. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 19 Jan 2014, 21:06 Guest10 wrote:when running the script (above code), i receive an error that refers to AutoHotKeyU64.exe. If you are trying to run the x32 code using an x64 install there will be issues. I rarely code in x64. Give this a try. Add the code below to the beginning of the code and try it. This should clear up the issues. Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus if (A_PtrSize=8){ 	SplitPath,A_AhkPath,,dir 	correct:=dir ""\AutoHotkeyU32.exe"" 	run,""%correct%"" ""%A_ScriptName%"",%A_ScriptDir% 	ExitApp 	return } AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top Bugs Posts: 3 Joined: 21 Jan 2014, 12:26 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 21 Jan 2014, 12:55 I tried to download the compiled version but its not at the link you provided. Are there examples I can check out that used GUI Creator ? Thanks Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 21 Jan 2014, 13:20 Bugs wrote:I tried to download the compiled version but its not at the link you provided. Are there examples I can check out that used GUI Creator ? Thanks I am so sorry. I am between web hosts at the moment. Click here Website is back online with a new host. Everything should work as it did before. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 23 Jan 2014, 08:12 i confirm hereby that this cleared/resolved my issue! maestrith wrote: Guest10 wrote:when running the script (above code), i receive an error that refers to AutoHotKeyU64.exe. If you are trying to run the x32 code using an x64 install there will be issues. I rarely code in x64. Give this a try. Add the code below to the beginning of the code and try it. This should clear up the issues. Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus if (A_PtrSize=8){ 	SplitPath,A_AhkPath,,dir 	correct:=dir ""\AutoHotkeyU32.exe"" 	run,""%correct%"" ""%A_ScriptName%"",%A_ScriptDir% 	ExitApp 	return } Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 23 Jan 2014, 08:16 Guest10 wrote:i confirm hereby that this cleared/resolved my issue! maestrith wrote: Guest10 wrote:when running the script (above code), i receive an error that refers to AutoHotKeyU64.exe. If you are trying to run the x32 code using an x64 install there will be issues. I rarely code in x64. Give this a try. Add the code below to the beginning of the code and try it. This should clear up the issues. Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus if (A_PtrSize=8){ 	SplitPath,A_AhkPath,,dir 	correct:=dir ""\AutoHotkeyU32.exe"" 	run,""%correct%"" ""%A_ScriptName%"",%A_ScriptDir% 	ExitApp 	return } Wow, so official I am glad to hear that it is now working properly for you. Hopefully the program has been helpful. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top huyaowen Posts: 96 Joined: 28 Jul 2014, 01:15 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 14 Sep 2014, 10:35 fc when click ""simple"" .check pls,thanks ps.Compiled version cannt download. Attachments Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 22 Oct 2014, 15:56 huyaowen wrote:fc when click ""simple"" .check pls,thanks ps.Compiled version cannt download. I would say to try to update your version of Autohotkey to the latest version (unicode) AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top TheDewd Posts: 462 Joined: 19 Dec 2013, 11:16 Location: USA Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 24 Oct 2014, 10:45 The download links aren't working for me.. Might be the office firewall. Can you confirm? Windows 7 Enterprise SP1 64-bit, Intel i7-4810MQ @ 2.80GHz, 8GB DDR3 RAM Windows 10 Home 64-bit, Intel Celeron N2920 @ 1.86GHz, 4GB DDR3 RAM Windows 10 Home 64-bit, AMD Athlon II X4 630, 2.80GHz, 8GB DDR3 RAM Top maestrith Posts: 539 Joined: 16 Oct 2013, 13:52 Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 25 Oct 2014, 07:29 TheDewd wrote:The download links aren't working for me.. Might be the office firewall. Can you confirm? I had some old links but they were still active. I updated the link so let me know if it works or not. AHK Studio OSD GUI Creator Donations All code is done on a Windows 10 PC Running x64 and AutoHotkey x32 Top TheDewd Posts: 462 Joined: 19 Dec 2013, 11:16 Location: USA Re: GUI Creator (formerly Basic GUI Creator) Report this post Quote 27 Oct 2014, 07:46 maestrith wrote:I updated the link so let me know if it works or not. It's working! Thanks! Windows 7 Enterprise SP1 64-bit, Intel i7-4810MQ @ 2.80GHz, 8GB DDR3 RAM Windows 10 Home 64-bit, Intel Celeron N2920 @ 1.86GHz, 4GB DDR3 RAM Windows 10 Home 64-bit, AMD Athlon II X4 630, 2.80GHz, 8GB DDR3 RAM Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 56 posts 1 2 3 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"WYSIWYG GUI Creator for AutoHotkey."	"true"
"Script Recorders and Writers"	"Pulover’s Macro Creator"	"http://www.macrocreator.com/"	"a Free Automation Tool and Script Generator. Recommended for beginners. Forum thread:. GitHub."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Pulover's Macro Creator – The Complete Automation Tool Menu Pulover's Macro Creator The Complete Automation Tool Search for: Primary Menu Skip to content Home Download Features Screenshots Help & Tutorials Forum Donate Project Contact Search Search for: Slide1 Posted on November 28, 2015By Pulover Slide2 Posted on November 28, 2015By Pulover Slide3 Posted on November 28, 2015By Pulover Slide4 Posted on November 28, 2015By Pulover Features Pulover's Macro Creator is a full featured automation tool for Windows and it's free for everyone! Get started watching the Video Tutorials! Featured1 Record your keystrokes and mouse movements and clicks relative to window or screen. Reproduce your macros with automatic window activation. Pause and play them step-by-step. Get long repetitive tasks done in instants. All using customizable Hotkeys that will work at any time. Featured2 Create multiple macros on a single project. Run programs. Read, copy and delete files. Send texts. Execute image searches. Show message boxes. Add loops, goto, and much more. PMC features nearly 200 commands and functions from basic to advanced automation needs. Featured3 Use Control Commands to click and type on background windows. Define and modify variables. Use functions to perform string and math operations. Set If Statements to control the flow of your macros. Simplified and advanced automation of Internet Explorer. Export your macros to working AHK scripts. Home Pulover’s Macro Creator is a Free Automation Tool and Script Generator. It is based on AutoHotkey language and provides users with multiple automation functions, as well as a built-in recorder. “Pulover’s Macro Creator is very handy as a means of automating various tasks without possessing  programming knowledge.” –Softpedia.com It’s more than a Macro Recorder! You can add not only keystrokes and mouse actions to your scripts but also manage windows, controls, files, strings, search images/pixels and even create If/Else Statements to control the flow of your macros! From simple repetitive tasks to complex automation projects, Pulover’s Macro Creator will save you hours of monotonous work. Everything with a friendly and intuitive interface. Check out the video tutorials and see how. [continue reading] News Version Update: 5.0.3 June 10, 2016 Version Update: 5.0.2 May 7, 2016 Software of the day on SOFTPEDIA April 30, 2016 Version Update: 5.0.1 April 23, 2016 Major update: v5.0.0 + New Video Tutorials April 14, 2016 Copyright © 2016 Pulover's Macro Creator. All Rights Reserved. | Catch Responsive by Catch Themes Scroll Up Home Download Features Screenshots Help & Tutorials Forum Donate Project Contact Translate »"	"null"	"null"	"a Free Automation Tool and Script Generator. Recommended for beginners. Forum thread:. GitHub."	"true"
"Script Recorders and Writers"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=143"	"a Free Automation Tool and Script Generator. Recommended for beginners. Forum thread:. GitHub."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Pulover's Macro Creator v5.0.3 - The Complete Automation Tool - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:32 All times are UTC-05:00 Pulover's Macro Creator v5.0.3 - The Complete Automation Tool Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 665 posts Page 1 of 34 Jump to page: 1 2 3 4 5 … 34 Next Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Pulover's Macro Creator v5.0.3 - The Complete Automation Tool Report this post Quote 04 Oct 2013, 08:27 Create Macros & Scripts Faster and Easily! Pulover's Macro Creator is a Free Automation Tool and Script Generator. It is based on AutoHotkey language and provides users with multiple automation functions, as well as a built-in recorder. Macros can be executed from the program itself or you can export them to AutoHotkey Script format or a standalone executable. “Pulover’s Macro Creator is very handy as a means of automating various tasks without possessing  programming knowledge.” -Softpedia.com   It’s more than a Macro Recorder! You can add not only keystrokes and mouse actions to your scripts but also manage windows, controls, files, strings, search images/pixels and even create If/Else Statements to control the flow of your macros! From simple repetitive tasks to complex automation projects, Pulover’s Macro Creator will save you hours of monotonous work. Everything with a friendly and intuitive interface. Check out the video tutorials and see how. [continue reading] www.macrocreator.com Current Version: 5.0.3 (also on GitHub) More Screenshots Features Help & TutorialsKeywords: Free Macro Recorder, Macro Program, Keyboard Macro, Mouse Macro, Mouse Recorder, Macro Builder, Macro Generator, Macro Maker, Macro Editor, Automate Hot Key, Automate Tasks, Automation Utility, Auto Keyboard Last edited by Pulover on 09 Jun 2016, 22:25, edited 15 times in total. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Sergio Posts: 21 Joined: 29 Sep 2013, 16:36 Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 09 Oct 2013, 17:02 Wow! I discovered your software fairly recently and it's grown by leaps and bounds! In the past I had suggested it to absolute AHK beginners who don't know code, but it's definitely more than that. Needless to say, you're an asset to the community. My one suggestion, if you'll bear it, is more tutorial videos. Your software already grew to point that it too is daunting for newbies and I don't think it needs to be. It does so much with very little & it's user friendly Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 09 Oct 2013, 18:50 Hey Sergio, (it's getting kinda hot in here! ) Thanks for all your comments and support! I did put a lot of effort in this project and it's really nice to have always been praised for it. When I found AutoHotkey I was amazed by how powerful it is and very happy that it's a freeware... I just thought it could use an interface. I'll be working on more tutorials. I already have one recorded that I must finish editing, and I have plans for many others. Unfortunately they might take a little longer to be released because of my lack of time for the fact that I have a desktop and a laptop malfunctioning at home atm... But there will be more versions and more videos. And I'm always open for suggestions! Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Guest10 Posts: 578 Joined: 01 Oct 2013, 02:50 Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 12 Oct 2013, 12:44 it's nice to have Macro Creator débuted over to this venue. Top SgtGooba Posts: 1 Joined: 17 Oct 2013, 16:45 Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 17 Oct 2013, 17:42 Pulover, I want to start by thanking you, i've found your creator rather simple to use and it has done almost everything i wanted perfectly. I have ran into 2 issues though so far. One of them has been a bit of a major hurdle. It fails to click alot. I'm not sure why but I have it set in place to find an image if it finds the image then i want it to move the mouse there and then click on it. I have tried doing the if found click option within the image search and that hasn't worked once, so instead i chose to use the move option and input a click right after. So i go into the mouse option choose click, and it won't click. I have tried doing the click down click up as well and that hasn't worked either. the other issue is i'm using the pixel search part of the image search and i have noticed if i add additional items into the macro i have to go back to the original pixel search and open to edit it click apply then ok and then the macro will run fine. if i don't do this then the macro just sits there not doing anything. even though it was working perfectly fine before i added the item. and the item can be something as simple as a pause. so not sure if either of these things can be fixed or you can tell me what i'm doing wrong but it would be greatly appareciated. Here is my current script... Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus Loop  ; Start Big Loop { 	CoordMode, Pixel, Window 	PixelSearch, FoundX, FoundY, 569, 555, 990, 672, 0x940000, 0, Fast RGB 	If ErrorLevel = 0 	Click, %FoundX%, %FoundY%, 0  ; Find Start button 	If ErrorLevel = 0 	{ 		Click, Left, , Down 		Sleep, 10 		Click, Left, , Up 		Sleep, 10 		Sleep, 2000 		Click, Left, , Down 		Sleep, 10 		Click, Left, , Up 		Sleep, 10 		Sleep, 2000 		Click, Left, , Down 		Sleep, 10 		Click, Left, , Up 		Sleep, 10 		Sleep, 2000 		Click, Left, , Down 		Sleep, 10 		Click, Left, , Up 		Sleep, 10 		Sleep, 2000 		Click, Left, , Down 		Sleep, 10 		Click, Left, , Up 		Sleep, 10 	} 	CoordMode, Pixel, Window 	PixelSearch, FoundX, FoundY, 1468, 781, 1617, 952, 0xB37547, 0, Fast RGB  ; Start Battle Loop Check for Auto 	If ErrorLevel = 0 	{ 		Loop, 2  ; Skill Star Loop 		{ 			Star: 			Loop 			{ 				CoordMode, Pixel, Window 				PixelSearch, FoundX, FoundY, 279, 554, 1330, 845, 0xFFFE54, 5, Fast RGB 				If ErrorLevel = 0 				Click, %FoundX%, %FoundY%, 0  ; Find Skill Star 			} 			Until ErrorLevel = 0 			If ErrorLevel = 0 			{ 				Sleep, 1000 				Click, Left, , Down 				Sleep, 10 				Click, Left, , Up 				Sleep, 10 				CoordMode, Pixel, Window 				PixelSearch, FoundX, FoundY, 827, 561, 1130, 670, 0x23741D, 0, Fast RGB 				If ErrorLevel = 0 				Click, %FoundX%, %FoundY%, 0 				If ErrorLevel = 0 				{ 					Click, Left, , Down 					Sleep, 10 					Click, Left, , Up 					Sleep, 10 				} 				Else 				{ 					Goto, Star 				} 			} 		} 		Else 		{ 			CoordMode, Pixel, Window 			PixelSearch, FoundX, FoundY, 1440, 804, 1597, 952, 0xB87D51, 1, Fast RGB 			If ErrorLevel = 0 			Click, %FoundX%, %FoundY%, 0  ; Find Auto Button 			If ErrorLevel = 0 			{ 				Click, Left, , Down 				Sleep, 10 				Click, Left, , Up 				Sleep, 10 				Sleep, 6000 				CoordMode, Pixel, Window 				PixelSearch, FoundX, FoundY, 1440, 804, 1597, 952, 0xB87D51, 1, Fast RGB 				If ErrorLevel = 0 				Click, %FoundX%, %FoundY%, 0 				If ErrorLevel = 0 				{ 					Goto, Star 				} 				Else 				{ 				} 			} 		} 	}   } Last edited by SgtGooba on 19 Oct 2013, 07:22, edited 1 time in total. Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 18 Oct 2013, 06:23 You're welcome, SgtGooba! Thanks for the feedback. A common source of confusion for the ImageSearch command is that it doesn't click at the center of the found image, but at the top left part of, and this usually causes errors. I explain that, as well as a workaround, in the video tutorial I've recorded for this command but I haven't finished editing it yet. I'll see if I can have some time today to post it. About the bug with pixel search, I could not reproduce it here. Can you tell me the exact steps so I can check if there's a bug? Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top chris114 Posts: 6 Joined: 20 Oct 2013, 14:36 Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 20 Oct 2013, 16:14 Yea my problem is it not finding the image I want it to find it just say image not found. maybe it's because the image capture saves as .png not .bmp? Also it would be great if the image/pixle finder could also do send keys when the image is found. Edit* got it to work but it wont keep looking for the images in loop it just looks 1 time and wont loop Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 23 Oct 2013, 07:18 chris114 wrote:Yea my problem is it not finding the image I want it to find it just say image not found. maybe it's because the image capture saves as .png not .bmp? Also it would be great if the image/pixle finder could also do send keys when the image is found. Edit* got it to work but it wont keep looking for the images in loop it just looks 1 time and wont loop Hi Chris, Sorry for the late reply, I've been very busy at work these days. I'll try to finish the tutorial for image search this week, but you can find some help in the FAQ. About the loop, you can use the Loop command, the Repeat counter in the ImageSearch window or the 'Repeat until' option. Post here if you still have problems. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 25 Oct 2013, 12:22 Well, I finally finished the Image and Pixel Search tutorial! Not the best tutorial ever, but I hope it will help with the concepts. http://www.macrocreator.com/new-tutoria ... el-search/ Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top chris114 Posts: 6 Joined: 20 Oct 2013, 14:36 Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 25 Oct 2013, 18:47 Hey thx I got it working Top jimson Posts: 6 Joined: 26 Oct 2013, 02:33 Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 26 Oct 2013, 11:59 I need some help as I am totally unfamiliar with writing scripts or adding commands etc. What I want to do is use a macro to calculate the routes in a games mission editor. It looks like this: When I open a route it looks like this: I recorded a macro for the first route and played it back and it will do the required mouse movements and clicks, but each route will open in a different vertical position. I would like to be able to somehow designate what position the macro will run from each time and I am guessing the actions would have to be offset from the first mouse position rather than coordinates. This is what it would look like: http://www.youtube.com/watch?v=1sGSZtfF4r4&feature=youtu.be Is this possible and can someone help me figure out how to do it? Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 28 Oct 2013, 05:47 jimson wrote:I need some help as I am totally unfamiliar with writing scripts or adding commands etc. What I want to do is use a macro to calculate the routes in a games mission editor. I recorded a macro for the first route and played it back and it will do the required mouse movements and clicks, but each route will open in a different vertical position. I would like to be able to somehow designate what position the macro will run from each time and I am guessing the actions would have to be offset from the first mouse position rather than coordinates. Is this possible and can someone help me figure out how to do it? Hello, jimson! The best way I see for you to do that is using Relative mouse movements. This option is in the mouse command window, below the coordinate boxes, it makes the values in the X and Y become an offset from the current position. The static clicks on the other screen will make it a little more difficult, but you can save the coords and move the mouse to the position where it was before you entered that screen. Here's an example for you to follow: Code: [Select all] [Expand] [Download] (RelativeClicks.pmc)GeSHi © Codebox Plus [PMC Code]|F3||1|Window|1|Macro1 1|[Assign Variable]|MousePosX := 90|1|0|Variable|||Set initial coordinates.|| 2|[Assign Variable]|MousePosY := 100|1|0|Variable|||Set initial coordinates.|| 3|[LoopStart]|LoopStart|10|0|Loop||||| 4|Move|%MousePosX%, %MousePosY%, 0|1|500|Click|||Move to starting coordinates.|| 5|Left Move & Click|Rel -40, 25 Left, 1|1|500|Click|||First click to unfold line (relative to the last position).|| 6|Left Move & Click|Rel 40, 25 Left, 1|1|500|Click|||Second click to select item (relative to last position).|| 7|MouseGetPos|MousePosX, MousePosY|1|500|MouseGetPos|||Save current coordinates on the same initial variables.|| 8|Left Move & Click|225, 433 Left, 1|1|500|Click|||Clicks inside the other screen.|| 9|Left Move & Click|485, 463 Left, 1|1|500|Click|||Clicks inside the other screen.|| 10|Left Move & Click|317, 558 Left, 1|1|500|Click|||Clicks inside the other screen.|| 11|[LoopEnd]|LoopEnd|1|0|Loop|||||   And how it looks in AHK.: Code: [Select all] [Expand] [Download] (RelativeClicks.ahk)GeSHi © Codebox Plus MousePosX := 90  ; Set initial coordinates. MousePosY := 100  ; Set initial coordinates. Loop, 10 { 	Click, %MousePosX%, %MousePosY%, 0  ; Move to starting coordinates. 	Sleep, 500 	Click, Rel -40, 25 Left, 1  ; First click to unfold line (relative to the last position). 	Sleep, 500 	Click, Rel 40, 25 Left, 1  ; Second click to select item (relative to last position). 	Sleep, 500 	MouseGetPos, MousePosX, MousePosY  ; Save current coordinates on the same initial variables. 	Sleep, 500 	Click, 225, 433 Left, 1  ; Clicks inside the other screen. 	Sleep, 500 	Click, 485, 463 Left, 1  ; Clicks inside the other screen. 	Sleep, 500 	Click, 317, 558 Left, 1  ; Clicks inside the other screen. 	Sleep, 500 }   Of course you'll have to adjust coordinates, sleeps and loop count, but you get the idea. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top jimson Posts: 6 Joined: 26 Oct 2013, 02:33 Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 28 Oct 2013, 11:06 Thanks I'll check it out. I have something almost finished that will work while I learn how to do the things suggested. Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 28 Oct 2013, 13:48 Version update! Version 4.1.0 Added tool to schedule macros in Windows Task Scheduler. Added shortcuts to insert built-in variables in command windows context-menu. Added Filter by type button in Run command window. Added Right-Click-Drag Move/Copy menu. Added Play Sound option to Image/Pixel Search result actions. Added Launcher to portable version (automatically updates INI and selects between x86 and x64 based on Windows version). Fixed issues with command line parameters. Fixed bugs. Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top jimson Posts: 6 Joined: 26 Oct 2013, 02:33 Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 29 Oct 2013, 18:29 BUG REPORT Version 4.1.0. When you attempt to stop a playing macro with hotkey F8 or when you attempt to pause it F12, the editor closes completely. When a macro playback finishes, editor closes completely. Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 29 Oct 2013, 18:45 jimson wrote:BUG REPORT Version 4.1.0. When you attempt to stop a playing macro with hotkey F8 or when you attempt to pause it F12, the editor closes completely. When a macro playback finishes, editor closes completely. Hello, jimson! Can't reproduce this bug here. Does it happen with any macro played or a specif one? There's an option in the shutdown options to close the application but it should start off on every launch. It's the button on the options toolbar that looks like windows shutdown icon, it turns red when it's active. Can you give me more details, please? Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top jimson Posts: 6 Joined: 26 Oct 2013, 02:33 Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 30 Oct 2013, 00:43 Ah, My mistake. Just checked and it doesn't close it just minimizes totally off my toolbar, it's still open in my tray. Top click-click Posts: 12 Joined: 18 Oct 2013, 06:35 Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 30 Oct 2013, 06:50 I noticed that MacroCreatorPortable.exe has been added to 4.1 and was not included with 4.0 portable version. What is the purpose of this since there is already macrocreator.exe in x86/x64? Also, previously -s was not working and it now works with the new macrocreator.exe in x86, but it does not work with MacroCreatorPortable.exe. It is so silent that nothing is displayed at all.. If I run MacroCreatorPortable.exe without the -s the gui pops up displaying the macro. If I use -s the macro doesn't run. I see the icon in the systray and when I open it, the gui is empty. I'm still not sure why you have the two versions. Top Pulover Posts: 348 Joined: 29 Sep 2013, 19:51 Location: Brazil Contact: Contact Pulover Website Re: Macro Creator v4.0.0 - Automation Tool (Recorder & Write Report this post Quote 30 Oct 2013, 07:51 jimson wrote:Ah, My mistake. Just checked and it doesn't close it just minimizes totally off my toolbar, it's still open in my tray. No problem! click-click wrote:I noticed that MacroCreatorPortable.exe has been added to 4.1 and was not included with 4.0 portable version. What is the purpose of this since there is already macrocreator.exe in x86/x64? I apologize, I should have given some more explanation about it. MacroCreatorPortable (it was named Launcher.exe on the time of release but I've renamed to avoid it being mistaken for a trojan or virus) launches MacroCreator.exe x86 or x64 based on the version of the OS, also updating the ini file to the last one used. It simply selects the suitable version for the computer you're running it on, and also allows you to use a program to associate a pmc file with one single portable executable. click-click wrote:Also, previously -s was not working and it now works with the new macrocreator.exe in x86, but it does not work with MacroCreatorPortable.exe. It is so silent that nothing is displayed at all.. If I run MacroCreatorPortable.exe without the -s the gui pops up displaying the macro. If I use -s the macro doesn't run. I see the icon in the systray and when I open it, the gui is empty. I did program the portable launcher to forward all parameters to the target executable, but I must confess I didn't test all command line parameters. I've been very busy lately and with little time to dedicate to this project. I did this update without enough tests because it had some bug fixes and new features I had added so I didn't want to postpone it for too long. But I'll test the command line parameters with the portable launcher and release a fix in the next version. I'll just wait a week or two to see if any other bug shows up. All reports are wellcome! Rodolfo U. Batista Pulover's Macro Creator - Automation Tool (Recorder & Script Writer) Top click-click Posts: 12 Joined: 18 Oct 2013, 06:35 Re: Macro Creator v4.1.0 - Automation Tool (Recorder & Write Report this post Quote 03 Nov 2013, 08:02 Okay, thanks. If I were you, I wouldn't bother with the launcher. Anyone downloading the portable version should know if he wants to use x86 or x64. It's just an additional front-end program that needs to be tested and IMHO isn't worth the trouble for what it does. Now that I know its purpose, I will just use the macrocreator.exe in x86/x64. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 665 posts Page 1 of 34 Jump to page: 1 2 3 4 5 … 34 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"a Free Automation Tool and Script Generator. Recommended for beginners. Forum thread:. GitHub."	"true"
"Script Recorders and Writers"	"link"	"https://github.com/Pulover/PuloversMacroCreator"	"a Free Automation Tool and Script Generator. Recommended for beginners. Forum thread:. GitHub."	"null"	"null"	"null"	"null"	"null"	""	"null"	"138"	"12"	"27"	"GitHub - Pulover/PuloversMacroCreator: Automation Utility - Recorder & Script Generator Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 12 Star 138 Fork 27 Pulover/PuloversMacroCreator Code Issues 2 Pull requests 0 Pulse Graphs Automation Utility - Recorder & Script Generator http://www.macrocreator.com 482 commits 2 branches 26 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags Dev master Nothing to show v5.0.3 v5.0.2 v5.0.1 v5.0.0 v4.1.3 v4.1.2 v4.1.1 v4.1.0 v4.0.0 v4.0b3 v4.0b1 v4.0a1 v3.8.4 v3.8.3 v3.8.2 v3.8.1 v3.8.0 v3.7.9 v3.7.8 v3.7.7 v3.7.6 v3.7.5 v3.7.4 v3.7.3 v3.7.2 v3.7.1 Nothing to show New pull request Latest commit 545739f Jun 9, 2016 Pulover Updated version info. Permalink Failed to load latest commit information. Documentation * Fixed wrong rows executed in loops after gosub or goto. Jun 9, 2016 LIB * Fixed wrong rows executed in loops after gosub or goto. Jun 10, 2016 Lang * Fixed missing value field in exported `Control` and `ControlGet` co… Jun 8, 2016 Resources Implemented Download, Zip and Unzip files. Mar 1, 2016 .gitignore Included demonstration macro. Apr 12, 2016 BuildFiles.ahk * Fixed some fields of *Send Email*, *Download Files* and *Zip/Unzip … Apr 30, 2016 Compile.ahk * Fixed some fields of *Send Email*, *Download Files* and *Zip/Unzip … Apr 30, 2016 CompileResources.ahk Fixed documentation and small bugs. Apr 6, 2016 ExtractLangFiles.ahk * Fixed expressions being executed twice in commands. May 6, 2016 Languages.xlsx * Fixed missing value field in exported `Control` and `ControlGet` co… Jun 9, 2016 License.txt Updating documentation. Apr 10, 2016 MacroCreator.ahk * Fixed wrong rows executed in loops after gosub or goto. Jun 10, 2016 README.md Updated version info. Jun 9, 2016 Resources.dll Implemented Download, Zip and Unzip files. Mar 1, 2016 SciLexer-x64.dll * Fixed variables cleared after user-defined function calls inside ex… Apr 28, 2016 SciLexer-x86.dll * Fixed variables cleared after user-defined function calls inside ex… Apr 29, 2016 README.md Pulover's Macro Creator Pulover's Macro Creator is a Free Automation Tool and Script Generator based on AutoHotkey language. It features a large range of automation commands, has a built-in recorder and can capture inputs in its interface. The macros can be executed from the program itself or you can export them to AutoHotkey Script format. www.macrocreator.com Current Version: 5.0.3 Supported platforms Windows 7, 8, 8.1, 10 (NOT tested on Windows XP, Vista) Translations You can make corrections to the Interface Language translations inside the application itself (Settings > Language editor). You can submit your corrections or new translations from there too. To translate the help file, use Documentation\MacroCreator_Help.ahk and the .md files in there. Follow the compile instructions below to create a chm file. The application is prepared to recognize a help file in the same directory of MacroCreator.exe, if named according to the .lang file of the currently selected language. For example, if the help file is for Chinese Simplified it must be named MacroCreator_Help_Zh_CN.chm or MacroCreator_Help_Zh.chm. Compile Instructions Source requires the latest version of AutoHotkey to run. The source for SciLexer.dll can be found at fincs/SciTE4AutoHotkey. Installer is created with Inno Setup. If you need to compile you may run the Compile.ahk script which generates the necessary files locally to create MacroCreator.exe, MacroCreator-x64.exe, MacroCreator_Help.chm and MacroCreator-setup.exe. To compile you'll need: The latest version of Auto-Hotkey installed. hhc.exe and hha.dll in Documentation\MacroCreator_Help-doc directory. Inno Setup (5.5.2 or higher) installed. Notes: Execute MacroCreator.ahk at least once to create the .ini file with the current version. You might need to copy it from %AppData% to the script folder. Setup and Help project files are maintained and created by BuildFiles.ahk. Language files may be edited in Languages.xls. Run ExtractLangFiles.ahk to create the .lang files in the Lang directory. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/Pulover/PuloversMacroCreator"	"a Free Automation Tool and Script Generator. Recommended for beginners. Forum thread:. GitHub."	"true"
"Others"	"GoTo"	"https://autohotkey.com/board/topic/95009-"	"Addon for any text editor that helps you jump to labels, hotkeys, hotstrings and functions in the active file."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"47"	"8"	"19"	"GitHub - aviaryan/autohotkey-scripts: A collection of Autohotkey scripts and functions authored by me (Avi Aryan). Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 8 Star 47 Fork 19 aviaryan/autohotkey-scripts Code Issues 0 Pull requests 0 Pulse Graphs 👌 A collection of Autohotkey scripts and functions authored by me (Avi Aryan). http://aviaryan.in/ahk/ 132 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit 4abad9e Mar 9, 2016 aviaryan Merge pull request #4 from D4D3VD4V3/patch-1 … Indented and more in DayofDate.ahk Permalink Failed to load latest commit information. Example_files Functions Others Tools NOTICE.txt README.md README.md Avi's Autohotkey Scripts and Functions Repository See my AHK script listing Copyright 2014 Avi Aryan    Licensed under the Apache License, Version 2.0 (the ""License"");   you may not use this file except in compliance with the License.   You may obtain a copy of the License at    http://www.apache.org/licenses/LICENSE-2.0    Unless required by applicable law or agreed to in writing, software   distributed under the License is distributed on an ""AS IS"" BASIS,   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.   See the License for the specific language governing permissions and   limitations under the License.    Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/aviaryan/autohotkey-scripts"	"Addon for any text editor that helps you jump to labels, hotkeys, hotstrings and functions in the active file."	"true"
"Others"	"GoToTilla"	"https://gist.github.com/hoppfrosch/4b4943b1311fd6a92f02"	"Addon which allows jumping to tokens within AHK sourcecode."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"GoToTilla - jump to tokens within AHK sourcecode #ahk #script · GitHub Skip to content All gists GitHub Sign up for a GitHub account Sign in Create a gist now Instantly share code, notes, and snippets. Star 2 Fork 0 hoppfrosch/GoToTilla.ahk forked from budRich/GoToTilla.ahk Last active Mar 17, 2016 Embed What would you like to do? Embed Embed this gist in your website. Embed Share Copy sharable URL for this gist. Share Clone via HTTPS Clone with Git or checkout with SVN using the repository's web address. HTTPS Learn more about clone URLs Download ZIP Code Revisions 9 Stars 2 GoToTilla - jump to tokens within AHK sourcecode #ahk #script Raw GoToTilla.ahk /* ##################### GoToTilla v0.22 by hoppfrosch - Added parsing of properties (AHK > 1.1.16.*) http://www.autohotkey.com/board/topic/95536-gototilla-a-combination-of-goto-and-tillagoto/ GoToTilla v0.21 by budRich http://www.autohotkey.com/board/topic/95536-gototilla-a-combination-of-goto-and-tillagoto/ A combination of: GoTo by Avi Aryan http://www.autohotkey.com/board/topic/95009-goto-hotkeys-hotstrings-functions-and-labels-in-any-editor/ and TillaGoto by TheGood http://www.autohotkey.com/forum/viewtopic.php?t=41575 TheGood was inspired by Rajats Active GoTo http://www.autohotkey.com/board/topic/10936-active-goto-v4/ ##################### Go To functions, labels, hotkeys and hotstrings in any editor. The only requirement is that the Editor shows file full path in Title Bar and has a Goto (Ctrl+G) option. Examples of such editors - Notepad++, Sublime Text, PSPad, ConTEXT Ctrl+Space to show a list of all functions,hotkeys,hotstrings and labels. Type to narrow list down, navigate with mouse or arrowkeys, select with doubleclick or Enter. */ ;------- CONFIGURE ------------------- GoTo_AutoExecute() ;1 = Gui is movable, A_temp = Working Directory +F7::Reload #if GetActiveFile() ;If ahk window is active ^Space:: Activefileindex := fileiscached( GetActiveFile() ) if ( Activefile_old != Activefileindex ) FreshList(""-all"", activefileindex) GuiControl,, txtSearch,% """" WinShow, GoToTilla WinActivate, GoToTilla ControlFocus,, ahk_id %htxtSearch% Activefile_old := Activefileindex return #if #IfWinActive, GoToTilla ^Space::WinHide, GoToTilla Up::ControlSend,, {Up}, ahk_id %hlblList% Down::ControlSend,, {Down}, ahk_id %hlblList% Enter::Gosub, SelectItem #IfWinActive GoTo_AutoExecute(resizable=true, WorkingDir=""""){ global #SingleInstance force SetTitleMatchMode, 3 SetWorkingDir,% ( WorkingDir == """" ) ? A_scriptdir : WorkingDir SetBatchLines, -1 FileCreateDir, gotoCache FileDelete, gotoCache\*.gotolist SetTimer, filecheck, 200 goto_cache := {} if resizable OnMessage(0x201, ""DragGotoGui"") ; WM_LBUTTONDOWN Gosub, NewGui } NewGui: Gui, +AlwaysOnTop -Caption +ToolWindow Gui, Margin, 3, 3 Gui, Font, s11, Consolas Gui, Add, Edit, h20 w200 vtxtSearch hwndhtxtsearch gtxtSearch_Event Gui, Add, ListBox, sort w200 h275 vlblList glblList_Event hwndhlblList -HScroll +256 ;LBS_NOINTEGRALHEIGHT Gui, Show, Hide AutoSize, GoToTilla return GoTo_Readfile(File) { Critical, On static filecount , commentneedle := A_space "";|"" A_tab "";"" if ( filecount_N := fileiscached(File) ) Filename := filecount_N else { Filename := filecount := filecount ? filecount+1 : 1 FileAppend,% file ""`n"",gotoCache\filelist.gotolist } FileDelete, gotoCache\%Filename%-* loop, read, %file% { readline := Trim( A_LoopReadLine ) if block_comments if Instr(readline, ""*/"") = 1 { block_comments := 0 continue } else continue if Instr(readline, "";"") = 1 continue if Instr(readline, ""/*"") = 1 { block_comments := 1 continue } readline := Trim( Substr(readline, 1, SuperInstr(readline, commentneedle, 1) ? SuperInstr(readline, commentneedle, 1)-1 : Strlen(readline)) ) if ( readline_temp := Check4Hotkey(readline) ) CreateCache(filename, ""hotkey"", readline_temp, A_index) else if ( Instr(readline, "":"") = 1 ) and ( Instr(readline, ""::"", 0, 0) > 1 ) CreateCache(filename, ""hotstr"", Substr(readline, 1, Instr(readline, ""::"", 0, 0)-1), A_index ) else if !SuperInstr(readline, ""``|`t| |,"", 0) and Substr(readline,0) == "":"" CreateCache(filename, ""label"", readline, A_index) else if Check4func(readline, A_index, file) CreateCache(filename, ""func"", Substr(readline, 1, Instr(readline, ""("")) "")"", A_index) else if Check4prop(readline, A_index, file) CreateCache(filename, ""prop"", Substr(readline, 1, Instr(readline, ""["")) ""]"", A_index) } } CreateCache(hostfile, type, data, linenum){ if type = func if ( Substr( data, 1, SuperInstr(data, "" |`t|,|("", 1)-1 ) == ""while"" ) return ;Exceptions are listed above FileAppend,% data "">"" linenum ""`n"",% ""Gotocache\"" hostfile ""-all.gotolist"" } Check4Hotkey(line) { ;The function assumes line is trimmed using Trim() and then checked for ; comment if ( Instr(line, ""::"") = 1 ) and ( Instr(line, "":"", false, 0) = 3 ) ;hotstring return """" hK := Substr( line, 1, ( Instr(line, "":::"") ? Instr(line, "":::"")+2 : ( Instr(line, ""::"") ? Instr(line, ""::"")+1 : Strlen(line)+2 ) ) - Strlen(line) - 2) if hK = return if !SuperInstr(hK, "" | "", 0) if !SuperInstr(hK, ""^|!|+|#"", 0) And RegExMatch(hK, ""[a-z]+[,(]"") return else return hK else if Instr(hK, "" & "") or ( Substr(hK, -1) == ""UP"" ) return hK } Check4func(readline, linenum, file){ if RegExmatch(readline, ""i)[A-Z0-9#_@\$\?\[\]]+\(.*\)"") != 1 return if ( Substr(readline, 0) == ""{"" ) return 1 loop, { FileReadLine, cl, %file%,% linenum+A_index if Errorlevel = 1 return cl := Trim( Substr(cl, 1, Instr(cl, "";"") ? Instr(cl, "";"")-1 : Strlen(cl)) ) if cl = continue if block_comments if Instr(readline, ""*/"") = 1 { block_comments := 0 continue } else continue if Instr(readline, ""/*"") = 1 { block_comments := 1 continue } return Instr(cl, ""{"") = 1 ? 1 : 0 } } Check4prop(readline, linenum, file){ if A_AhkVersion < ""1.1.16.0"" return if RegExmatch(readline, ""i)[A-Z0-9#_@\$\?]+\[.*\]"") != 1 return if ( Substr(readline, 0) == ""{"" ) return 1 loop, { FileReadLine, cl, %file%,% linenum+A_index if Errorlevel = 1 return cl := Trim( Substr(cl, 1, Instr(cl, "";"") ? Instr(cl, "";"")-1 : Strlen(cl)) ) if cl = continue if block_comments if Instr(readline, ""*/"") = 1 { block_comments := 0 continue } else continue if Instr(readline, ""/*"") = 1 { block_comments := 1 continue } return Instr(cl, ""{"") = 1 ? 1 : 0 } } filecheck: FileGetTime, Timeforfile,% goto_tempfile := GetActiveFile(), M if ( goto_cache[goto_tempfile] != Timeforfile ) goto_cache[goto_tempfile] := Timeforfile , Goto_Readfile(goto_tempfile) return fileiscached(file){ loop, read, gotoCache\filelist.gotolist if ( file == A_LoopReadLine ) return A_index } GUIEscape: WinHide, GoToTilla return FreshList(mode, fileindex){ global aLst,lblList aLst := Object() lblList := """" GuiControl,, lblList,| if !fileindex return loop, read, gotoCache\%fileIndex%%Mode%.gotolist { StringSplit, toadd, A_LoopReadLine, > aLst.Insert(toadd1, toadd2) lblList .= ""|"" toadd1 } GuiControl, -Redraw, lblList Guicontrol, ,lblList,% !lblList ? ""|"" : lblList GuiControl, +Redraw, lblList } GetActiveFile(){ WinGetActiveTitle, Title if !( Instr(title, "".ahk"") and Instr(title, "":\"") ) return """" return Trim( Substr( Title, temp := Instr(Title, "":\"")-1, Instr(Title, "".ahk"", 0, 0)-temp+4 ) ) } DragGotoGui(){ ;Thanks Pulover PostMessage, 0xA1, 2,,, A } /* SuperInstr() Returns min/max position for a | separated values of Needle(s) return_min = true ; return minimum position return_min = false ; return maximum position */ SuperInstr(Hay, Needles, return_min=true, Case=false, Startpoint=1, Occurrence=1){ pos := return_min*Strlen(Hay) if return_min { loop, parse, Needles,| if ( pos > (var := Instr(Hay, A_LoopField, Case, startpoint, Occurrence)) ) pos := var ? var : pos if ( pos == Strlen(Hay) ) return 0 } else { loop, parse, Needles,| if ( (var := Instr(Hay, A_LoopField, Case, startpoint, Occurrence)) > pos ) pos := var } return pos } lblList_Event: If (A_GuiEvent <> ""DoubleClick"") Return SelectItem: ;Get selected item index. LB_GETCURSEL SendMessage, 0x188, 0, 0,, ahk_id %hlblList% ;Check for error. LB_ERR If (ErrorLevel = 0xFFFFFFFF) Return ;Get the associated item data i := GetListBoxItem(hlblList, ErrorLevel) BlockInput, On WinHide, GoToTilla SendInput, ^g sleep, 100 SendInput,% aLst[i] ""{Enter}"" BlockInput, Off Return GetListBoxItem(hLB, i) { ;Get length of item. LB_GETTEXTLEN SendMessage 394, %i%, 0,, ahk_id %hLB% ;Check for error If (ErrorLevel = 0xFFFFFFFF) Return """" ;Prepare variable VarSetCapacity(sText, ErrorLevel * (1 + !!A_IsUnicode), 0) ;Retrieve item. LB_GETTEXT SendMessage 393, %i%, &sText,, ahk_id %hLB% ;Check for error If (ErrorLevel = 0xFFFFFFFF) Return """" Return sText } ;Incremental searching txtSearch_Event: GuiControlGet, s,, txtSearch CreateList(s) Return CreateList(filter = """") { Global hlblList, bShowing, aLst, activefileindex Static sLastfilter := ""`n"" ;Initialize on an impossible filter ;Trim the right side While (SubStr(filter, 0) = A_Space) StringTrimRight, filter, filter, 1 ;Trim right side if it ends in "" !"" since it changes nothing If (StrLen(filter) > 2) And (SubStr(filter, -1) = "" !"") And (SubStr(filter, -2, 1) <> A_Space) StringTrimRight, filter, filter, 2 ;Check if the filter is different If (filter = sLastfilter) ;And bShowing Return sLastfilter := filter GuiControl, -Redraw, lblList GuiControl,, lblList,| lblList := """" If (filter = """") FreshList(""-all"", activefileindex) Else { For k, v in aLst If (InStr(k, filter) = 1) lblList .= ""|"" k Guicontrol, ,lblList,% !lblList ? ""|"" : lblList } ;Select the first item. LB_SETCURSEL SendMessage 390, 0, 0,, ahk_id %hlblList% ;Redraw GuiControl, +Redraw, lblList } Sign up for free to join this conversation on GitHub. Already have an account? Sign in to comment Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://gist.github.com/hoppfrosch/4b4943b1311fd6a92f02"	"Addon which allows jumping to tokens within AHK sourcecode."	"true"
"Others"	"Context sensitive help in any editor"	"https://autohotkey.com/board/topic/94493-"	"Addon for any text editor that provides context sensitive help by pressing F1."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"47"	"8"	"19"	"GitHub - aviaryan/autohotkey-scripts: A collection of Autohotkey scripts and functions authored by me (Avi Aryan). Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 8 Star 47 Fork 19 aviaryan/autohotkey-scripts Code Issues 0 Pull requests 0 Pulse Graphs 👌 A collection of Autohotkey scripts and functions authored by me (Avi Aryan). http://aviaryan.in/ahk/ 132 commits 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit 4abad9e Mar 9, 2016 aviaryan Merge pull request #4 from D4D3VD4V3/patch-1 … Indented and more in DayofDate.ahk Permalink Failed to load latest commit information. Example_files Functions Others Tools NOTICE.txt README.md README.md Avi's Autohotkey Scripts and Functions Repository See my AHK script listing Copyright 2014 Avi Aryan    Licensed under the Apache License, Version 2.0 (the ""License"");   you may not use this file except in compliance with the License.   You may obtain a copy of the License at    http://www.apache.org/licenses/LICENSE-2.0    Unless required by applicable law or agreed to in writing, software   distributed under the License is distributed on an ""AS IS"" BASIS,   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.   See the License for the specific language governing permissions and   limitations under the License.    Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/avi-aryan/Avis-Autohotkey-Repo"	"Addon for any text editor that provides context sensitive help by pressing F1."	"true"
"Others"	"CodeQuickTester"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=6113"	"by GeekDude - A lightweight dynamic code tester."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"CodeQuickTester - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:32 All times are UTC-05:00 CodeQuickTester Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 78 posts 1 2 3 4 Next GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 CodeQuickTester Report this post Quote 26 Jan 2015, 11:37 And the output of the example script shown: Spoiler Features: Dynamic script execution Multiple instances ahkbin (IRC pastebin) integration Save and load from file Download code from any given URL RichEdit Dark theme 4-space tab width Consolas Able to pass parameters to the script Drop file onto GUI to open it Can be registered as the service handler for ahk: links Automatically re-indent your code AlwaysOnTop toggle Notes: The run button changes to a kill button while the script is running It will attempt to close the script nicely for a second or two before killing the scripts process Requires AHK v1.1 Due to the nature of tab widths, attempting to change the font from Consolas could result in messed up tabs The dynamic script's name will be AHK_CQT_%A_TickCount% Here's a user script for adding ahk: service handler links to the ahkscript forum code boxes and gist boxes: Spoiler Code Last edited by GeekDude on 05 Oct 2015, 15:11, edited 7 times in total. AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: CodeQuickTester Report this post Quote 26 Jan 2015, 15:44 Nice you finally posted it! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: CodeQuickTester Report this post Quote 26 Jan 2015, 16:24 Original thread is here http://www.autohotkey.com/board/topic/8 ... tereditor/ AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: CodeQuickTester Report this post Quote 26 Jan 2015, 18:58 But i mean your updated version Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: CodeQuickTester Report this post Quote 26 Jan 2015, 19:06 Well I'm glad you like it, though! Interesting thing about running scripts dynamically. File loops get $CONIN and $CONOUT as listed in the script's directory. AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top enthused Posts: 94 Joined: 27 Dec 2014, 03:28 Re: CodeQuickTester Report this post Quote 26 Jan 2015, 23:11 Now this is very nice and very compact too. Thank you GeekDude Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: CodeQuickTester Report this post Quote 26 Jan 2015, 23:41 WARNING: It will throw errors if you try to run a script with unicode characters in it. See here. Edit: Fixed Last edited by GeekDude on 17 Feb 2015, 14:16, edited 1 time in total. AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: CodeQuickTester Report this post Quote 26 Jan 2015, 23:49 Lol Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: CodeQuickTester Report this post Quote 27 Jan 2015, 15:47 Now works with unicode (in theory). Thanks, Coco! AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top Coco Posts: 767 Joined: 29 Sep 2013, 20:37 GitHub: cocobelgica Re: CodeQuickTester Report this post Quote 28 Jan 2015, 10:39 Simple wish: perhaps add another edit control to allow passing of command line parameters. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: CodeQuickTester Report this post Quote 28 Jan 2015, 10:40 I'll throw in a floating dialog for it. Edit: Dialog created AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top cyruz Posts: 241 Joined: 30 Sep 2013, 13:31 Re: CodeQuickTester Report this post Quote 28 Jan 2015, 13:59 Very nice! I can finally stop creating tmp.ahk & test.ahk everywhere ABCza on the old forum. My GitHub. Top boiler Posts: 857 Joined: 21 Dec 2014, 02:44 Re: CodeQuickTester Report this post Quote 28 Jan 2015, 15:32 ^ Yes, now I can out of the habit of littering my desktop with all these little test scripts I write and try from from forum posts. Love this. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: CodeQuickTester Report this post Quote 28 Jan 2015, 15:45 Nevermind about my mention of $CONIN and $CONOUT. I'm just an idiot who was using those instead of CONIN$ and CONOUT$, thus causing files to actually be created and my print function to not work. AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top Soft Posts: 147 Joined: 07 Jan 2015, 13:18 GitHub: visionary1 Location: Seoul Contact: Contact Soft Website Re: CodeQuickTester Report this post Quote 28 Jan 2015, 23:25 I really like this! good work AutoHotkey & AutoHotkey_H v1.1.22.07 Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: CodeQuickTester Report this post Quote 29 Jan 2015, 10:33 Thanks for the compliment! AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: CodeQuickTester Report this post Quote 29 Jan 2015, 11:20 Update: Removed /ErrorStdOut. Interestingly I hadn't noticed the implications of having it in there without actually handling the errors until now. AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top cyruz Posts: 241 Joined: 30 Sep 2013, 13:31 Re: CodeQuickTester Report this post Quote 29 Jan 2015, 11:29 What about an integration with your console class so that the user can redirect the output there? ABCza on the old forum. My GitHub. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: CodeQuickTester Report this post Quote 29 Jan 2015, 11:33 Because that would ruin the lightweight single-file thing I'm going for. Besides, you don't actually need the console class unless you want to do crazy stuff. Simple console output can be done in two lines: Code: [Select all] [Download] GeSHi © Codebox Plus DllCall(""AttachConsole"") ; Top of script FileOpen(""CONOUT$"", ""w"").Write(""Some text"") ; Wherever you want to print However, this wouldn't really help much, seeing as there's already a pretty good built-in method of showing the user error messages. AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top boiler Posts: 857 Joined: 21 Dec 2014, 02:44 Re: CodeQuickTester Report this post Quote 29 Jan 2015, 11:49 What's the script directory? What if an app creates .ini files or something in the script directory. Where do they go? Sorry if you said that already. I couldn't find that mentioned. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 78 posts 1 2 3 4 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Bing [Bot] and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"by GeekDude - A lightweight dynamic code tester."	"true"
"(Use in) other programming languages"	".NET Framework Interop (CLR, C#, VB)"	"https://dl.dropbox.com/u/20532918/Lib/CLR-1.2.zip"	"Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Forum thread:."	"false"
"(Use in) other programming languages"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=4633"	"Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	".NET Framework Interop (CLR, C#, VB) - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:32 All times are UTC-05:00 .NET Framework Interop (CLR, C#, VB) Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 37 posts 1 2 Next lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos .NET Framework Interop (CLR, C#, VB) Report this post Quote 19 Sep 2014, 19:10 Microsoft Common Language Runtime / .NET Framework Interop CLR v1.2, for AutoHotkey v1.1 License: public domain / CC0 Key Features: Load the Common Language Runtime into the script's process. Load .NET assemblies (dll files) by full name, partial name, or path. Instantiate objects and call instance methods or properties. Compile C# or VB code on the fly or to file. Functions CLR_Start( [ RuntimeVersion ] ) Loads the Common Language Runtime. RuntimeVersion specifies the exact version to load - for example, ""v2.0.50727"" or ""v4.0.30319"". If omitted, the latest version is loaded. If this function is not called and another CLR function requires the runtime to be loaded, the latest version will be loaded. CLR_StartDomain( ByRef AppDomain [, BaseDirectory ] ) Starts a new AppDomain and stores a pointer or reference to it in AppDomain. This can be passed to CLR_LoadLibrary() to load an assembly into the AppDomain. BaseDirectory defines the base search path used when loading assemblies into the AppDomain. CLR_StopDomain( AppDomain ) Stops the specified AppDomain and attempts to unload any assemblies that were loaded into it. CLR_LoadLibrary( AssemblyName [, AppDomain ] ) Loads an assembly, where AssemblyName is its full name, partial name or path. Optionally loads the assembly into the given AppDomain instead of the default AppDomain. Returns a pointer or reference to the Assembly, which can be used with CLR_CreateObject. Note: Once an assembly is loaded, it can only be unloaded by stopping the AppDomain which contains it. CLR_CreateObject( Assembly, sType [, Arg1, Arg2 ... ] ) Instantiates an object of the specified type from the specified assembly. Optionally accepts a list of arguments to pass to the object's constructor. Use ComObject(Type, Arg) to pass a typed value. A list of type codes can be found here. Alternatively, you can call Assembly.CreateInstance(sType) directly if you do not need to pass parameters. CLR_CompileC#( Code, References [, AppDomain, FileName, CompilerOptions ] ) CLR_CompileVB( Code, References [, AppDomain, FileName, CompilerOptions ] ) Compile the specified C# or VB code. If FileName is omitted, the assembly is compiled ""in-memory"" and automatically loaded. DLL and EXE files may be generated. Specify for References a pipe (|) delimited list of assemblies that the code requires. If FileName is omitted and compilation is successful, returns a pointer or reference to the compiled Assembly, which can be used with CLR_CreateObject; otherwise returns FileName on success or 0 on failure. Note: Some versions of .NET may require an explicit reference to the appropriate language dll, such as Microsoft.CSharp.dll. Additional command-line arguments can be passed to the compiler via CompilerOptions. For instance, if FileName specifies an .exe file, a console app is generated unless CompilerOptions includes ""/target:winexe"". See the original thread for AutoHotkey v1.0 support. Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 21 Sep 2014, 02:14 Simple C# example: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus c# = (     using System.Windows.Forms;     class Foo {         public void Test() {             MessageBox.Show(""Hello, world, from C#!"");         }     } ) asm := CLR_CompileC#(c#, ""System.dll | System.Windows.Forms.dll"") obj := CLR_CreateObject(asm, ""Foo"") obj.Test() Simple VB example: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus vb = (     Imports System.Windows.Forms     Class Foo         Public Sub Test()             MessageBox.Show(""Hello, world, from VB!"")         End Sub     End Class ) asm := CLR_CompileVB(vb, ""System.dll | System.Windows.Forms.dll"") obj := CLR_CreateObject(asm, ""Foo"") obj.Test() Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 21 Sep 2014, 02:32 Event Handling Handling events can be a little easier with AutoHotkey v1.1 than in AutoHotkey v1.0 thanks to SAFEARRAY support. There are also some techniques that I've learnt about since writing CLR.ahk v1.0, or that were introduced in later .NET Framework versions. These are demonstrated in the C# code below. There are two methods of handling an event demonstrated below: For events of type EventHandler, MakeHandler can be used. This simply wraps our callback pointer in a delegate, then creates and returns an anonymous function which wraps the parameters in an array and passes them to our callback via the delegate. Since this only covers events which use the EventHandler delegate type, you would need to basically copy the MakeHandler method for each event type. For other events, we can call AddHandler, passing the target object, event name and callback pointer. AddHandler dynamically generates a CLR delegate similar to MakeHandler's anonymous function, but matching the signature of the event. This method is quite a bit longer. In both cases, parameters are passed to our callback via a pointer to a SAFEARRAY, to make things easy. The callback pointer is passed as a string, since COM automation/IDispatch does not support 64-bit integers. Code: [Select all] [Expand] [Download] (Event_handling.ahk)GeSHi © Codebox Plus ; Compile the helper class. This could be pre-compiled. FileRead c#, EventHelper.cs helperAsm := CLR_CompileC#(c#) helper := helperAsm.CreateInstance(""EventHelper"")   ; Create our test object, which simply exposes a single event. c# = (     public class ObjectWithEvent {         public void RaiseEvent() {             if (OnEvent != null)                 OnEvent(this, System.EventArgs.Empty);         }         public event System.EventHandler OnEvent;     } ) asm := CLR_CompileC#(c#) obj := asm.CreateInstance(""ObjectWithEvent"")   ; Add an event handler for the ""OnEvent"" event.  Use """" to pass the ; address as a string, since IDispatch doesn't support 64-bit integers. helper.AddHandler(obj, ""OnEvent"", """" RegisterCallback(""EventHandler"",,, 1))   ; Make an event handler (event must be of the EventHandler type). handler := helper.MakeHandler("""" RegisterCallback(""EventHandler"",,, 2)) obj.add_OnEvent(handler)   ; Test the event handlers. obj.RaiseEvent()     ; Our event handler is called with a SAFEARRAY of parameters.  This ; makes it much easier to get the type and value of each parameter. EventHandler(pprm) {     ; Wrap the SAFEARRAY pointer in an object for easy access.     prm := ComObject(0x200C, pprm)     ; Show parameters:     MsgBox, 0, Event Raised, % ""Callback #"" A_EventInfo         . ""`nSender: "" prm[0].ToString()         . ""`nEventArgs: "" prm[1].ToString() } Code: [Select all] [Expand] [Download] (EventHelper.cs)GeSHi © Codebox Plus using System; using System.Reflection; using System.Reflection.Emit; using System.Runtime.InteropServices;   public class EventHelper {     // Delegate type for the AutoHotkey callback.     public delegate void CallbackType([MarshalAs(UnmanagedType.SafeArray)] object[] argv);     // AddHandler: Adds a callback as a handler for the given event of the given object.     public void AddHandler(object target, string eventName, string pcb) {         var cb = ParseCB(pcb);         // Reference: http://msdn.microsoft.com/en-us/library/ms228976         EventInfo evt = target.GetType().GetEvent(eventName);         Type handlerType = evt.EventHandlerType;         MethodInfo handlerSig = handlerType.GetMethod(""Invoke"");         ParameterInfo[] parameters = handlerSig.GetParameters();         Type[] parameterTypes = new Type[parameters.Length+1];         parameterTypes[0] = typeof(CallbackType);         for (int i = 0; i < parameters.Length; i++)             parameterTypes[i+1] = parameters[i].ParameterType;           var handler = new DynamicMethod("""", handlerSig.ReturnType, parameterTypes, true);           var il = handler.GetILGenerator();         var loc = il.DeclareLocal(typeof(object[]));         il.Emit(OpCodes.Ldc_I4_2);         il.Emit(OpCodes.Newarr, typeof(object));         il.Emit(OpCodes.Stloc_0);           il.Emit(OpCodes.Ldloc_0);         il.Emit(OpCodes.Ldc_I4_0);         il.Emit(OpCodes.Ldarg_1);         il.Emit(OpCodes.Stelem_Ref);           il.Emit(OpCodes.Ldloc_0);         il.Emit(OpCodes.Ldc_I4_1);         il.Emit(OpCodes.Ldarg_2);         il.Emit(OpCodes.Stelem_Ref);           il.Emit(OpCodes.Ldarg_0);         il.Emit(OpCodes.Ldloc_0);         il.Emit(OpCodes.Call, typeof(CallbackType).GetMethod(""Invoke""));         il.Emit(OpCodes.Ret);           var delg = handler.CreateDelegate(handlerType, cb);         var adder = evt.GetAddMethod();         adder.Invoke(target, new object[] { delg });     }     // Much simpler method, restricted to a specific delegate type.     public EventHandler MakeHandler(string pcb) {         var cb = ParseCB(pcb);         return (sender, e) => cb(new object[]{ sender, e });     }     public CallbackType ParseCB(string cb) {         // For 32-bit, simply marking the parameter of AddHandler/MakeHandler with:         //   [MarshalAs(UnmanagedType.FunctionPtr)] CallbackType cb         // is adequate, but since IDispatch doesn't support 64-bit integers,         // we have to pass the callback address as a string for x64 builds.         return (CallbackType) Marshal.GetDelegateForFunctionPointer(             (IntPtr)Int64.Parse(cb), typeof(CallbackType));     } } Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 13 Oct 2014, 22:12 Thanks for this. You should put this on GitHub too. Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top BGM Posts: 315 Joined: 20 Nov 2013, 20:56 GitHub: bgmCoder Contact: Contact BGM ICQ Website Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 31 Oct 2014, 14:10 This looks interesting! I know some c#. The basic demo does indeed produce the messagebox! I am impressed! So I decided to try using c# to navigate xml, so I hooked up this code, and it gives me this error: Compilation Failed Error CS0006 on line 0: Metadata file 'System.Xml.Linq' could not be found How do I resolve *that*? I am guessing I need an explicit reference to the assembly. How do I add that? Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus   ;http://stackoverflow.com/questions/7119806/c-sharp-reading-data-from-xml   #include clr.ahk   c# = (     using System;     using System.Windows.Forms;     using System.Xml.Linq;     class Foo {         public void Test() {             MessageBox.Show(""Ready for XML from C# via Autohotkey?"");         }   		public void ahkxml(){ 			XDocument doc = XDocument.Load( ""polycom-test-cfg.cfg"" ); 			var info = doc.Descendants( ""reg"" ); 			foreach ( var thisinfo in info ){ 				MessageBox.Show(thisinfo.Value); 			}     		}       } ) asm := CLR_CompileC#(c#, ""System.dll | System.Windows.Forms.dll | System.Xml.Linq"") obj := CLR_CreateObject(asm, ""Foo"") obj.Test() obj.ahkxml() My Stuff: mousey; volume; ahkinfo; instantbirder; npp highlighter; Dynamic File Menu; tv - a treeview library; Top TLM Posts: 703 Joined: 01 Oct 2013, 07:52 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 05 Apr 2015, 19:19 Simple examples for creating/declaring variable types and return their values from C# to AHk All of my examples assume you've used #include for the CLR library. Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; Return a string type cSharp = (     class MainReturnValTest     {         public string Main()         {             string var = ""some string"";             return var;         }     } )   obj := CLR_CreateObject( CLR_CompileC#( cSharp ), ""MainReturnValTest"") msgbox % obj.Main() Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; Return an integer type cSharp = (     class MainReturnValTest     {         public int Main()         {             int n = 5;             return n;         }     } )   obj := CLR_CreateObject( CLR_CompileC#( cSharp ), ""MainReturnValTest"") msgbox % obj.Main() Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; Return both string and integer types cSharp = (     class MainReturnValTest     {         private int Integer()         {             int n = 5;             return n;         }           public string Main()         {             string str = ""High "";             return str + Integer();         }     } )   obj := CLR_CreateObject( CLR_CompileC#( cSharp ), ""MainReturnValTest"") msgbox % obj.Main() Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; Return string and decimal types cSharp = (     class MainReturnValTest     {         private decimal Decimal()         {             decimal d = 5.3m; // decimals must be appended with M or m suffix             return d;         }           public string Main()         {             string str = ""Decimal "";             return str + Decimal();         }     } )   obj := CLR_CreateObject( CLR_CompileC#( cSharp ), ""MainReturnValTest"") msgbox % obj.Main() I will keep posting simple examples as I learn more. Hope this helps people out some. Top IMEime Posts: 222 Joined: 20 Sep 2014, 06:15 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 05 Apr 2015, 20:18 Wow, Looks good. I am going to give it a try. Thanks, nice post. (So, Main method returns ""string""? interesting..) Top TLM Posts: 703 Joined: 01 Oct 2013, 07:52 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 06 Apr 2015, 12:37 Compile an executable in C# Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; Compile an executable in C# cSharp = (     using System;     namespace HelloWorld     {         class Hello         {             static void Main()             {                 Console.WriteLine(""Hello World!"");                   // Keep the console window open in debug mode.                 Console.WriteLine(""Press any key to exit."");                 Console.ReadKey();             }         }     } )   FileName := A_ScriptDir ""\HelloWorld.exe""   CLR_CompileC#( cSharp, ""System.dll"",, FileName )   Run % FileNameCreating a console application will be of use to display many examples found on msdn. Top TLM Posts: 703 Joined: 01 Oct 2013, 07:52 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 06 Apr 2015, 15:02 Compiling executable that excepts arguments Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; Pass arguments to compiled executable cSharp = (     using System;     namespace HelloWorld     {         class Hello         {             static void Main(string[] arr)             {                 for (int i = 0; i < arr.Length; i++)                 {                     Console.Write(arr[i] + ""{0}"", i < arr.Length - 1 ? "" "" : """");                 }                 Console.WriteLine();                   // Keep the console window open in debug mode.                 Console.WriteLine(""Press any key to exit."");                 Console.ReadKey();             }         }     } )   FileName := A_ScriptDir ""\HelloWorld.exe""   CLR_CompileC#( cSharp, ""System.dll"",, FileName )   RunWait % FileName "" arg1 arg2"" Run % FileName "" Some more arguments""Note: The Using keyword directive allows for each use of Console to only need the class rather than having to attach System also. For more info see Directives htms Top IMEime Posts: 222 Joined: 20 Sep 2014, 06:15 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 06 Apr 2015, 19:02 I tried two codes. This one is fine. Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus Kodes = (     class Tecting     {         public string Main()         {             int ABC = 123 ;             return ABC.ToString( ""000###"" )  ;         }     } ) Ovject := CLR_CreateObject( CLR_CompileC#( Kodes ), ""Tecting"") Msgbox % Ovject.Main() And, the second one, I had namespace error. Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus Sample = ( using System.Windows.Forms;     class Testing     {         public void Main()         {             MessageBox.Show( ""a"" ) ;         }     } ) Ovject := CLR_CreateObject( CLR_CompileC#( Sample ), ""Testing"") Ovject.Main() (And, This one also.. using System.Text.RegularExpressions; ) Top HotKeyIt Posts: 993 Joined: 29 Sep 2013, 18:35 Contact: Contact HotKeyIt Website Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 06 Apr 2015, 19:32 This is an example from old forum: Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus c# = (     using System.Windows.Forms;     class Foo {         public void Test() {             MessageBox.Show(""Hello, world, from C#!"");         }     } ) CLR_Start()   asm := CLR_CompileC#(c#, ""System.dll | System.Windows.Forms.dll"") obj := CLR_CreateObject(asm, ""Foo"") obj.Test() Top IMEime Posts: 222 Joined: 20 Sep 2014, 06:15 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 06 Apr 2015, 20:36 Ho, you made it without using ""Main"" method. (Looks like some difficult to me though) I will give it a try. Thanks. Top TLM Posts: 703 Joined: 01 Oct 2013, 07:52 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 06 Apr 2015, 22:46 IMEime wrote:I tried two codes.... the second one, I had namespace error.Its because you need to reference the System.Windows.Forms assembly System.Windows.Forms.dll to use messagebox HotKeyIt wrote:This is an example from old forum: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus ;... CLR_Start() ;...only needed to specify the runtime version of .net Top IMEime Posts: 222 Joined: 20 Sep 2014, 06:15 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 07 Apr 2015, 04:14 Hmm.. How about this ? My final goal is to make some Excel & Word Ribbon handling codes. It has bunch of usings. Do I need to wirte down all and every usings and dlls somewhere else? Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus using System; using System.Collections.Generic; using System.ComponentModel; using System.Drawing; using System.Data; using System.Linq; using System.Text; using System.IO;										 using System.Diagnostics;								 using System.Windows.Forms;				 using System.Runtime.InteropServices;			 using System.Text.RegularExpressions;		 using aEXL = Microsoft.Office.Interop.Excel ; using aWRD = Microsoft.Office.Interop.Word ; using aCOR = Microsoft.Office.Core;			   Something like this ? Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus asm := CLR_CompileC#(c#, ""System.dll | System.Collections.Generic.dll | System.ComponentModel.dll | ... | ...dll"") Top TLM Posts: 703 Joined: 01 Oct 2013, 07:52 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 07 Apr 2015, 09:47 Manipulate console colors Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; Change Fore/Background console colors c# = ( using System; class ChangeColors {     public static void Main()     {         ConsoleColor[] colors = (ConsoleColor[]) ConsoleColor.GetValues(typeof(ConsoleColor));         foreach (var color in colors)         {             if ( color == colors[ 0 ] ) continue;             else             {                 Console.BackgroundColor = colors[ 0 ]; Console.ForegroundColor = color;                 Console.WriteLine( ""ForegroundColor: {0}"", color );                   Console.ForegroundColor = colors[ 0 ]; Console.BackgroundColor = color;                 Console.WriteLine( ""BackgroundColor: {0}"", color );             }         }         Console.ReadKey();     } } )   CLR_CompileC#( c#,,, FileName := A_ScriptDir ""\Colors.exe"" ) Run % FileName Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ; Change entire background color c# = ( using System; class ChangeBackgroundColor {     public static void Main()     {         ConsoleColor[] colors = (ConsoleColor[]) ConsoleColor.GetValues(typeof(ConsoleColor));         int ColorsLeft = ( colors.Length-2 );           foreach (var color in colors)         {             if ( color != colors[ 0 ] )             {                 Console.ForegroundColor = colors[ 0 ]; Console.BackgroundColor = color;                 Console.Clear();   // Used to color the entire buffer                 Console.WriteLine( ""BackgroundColor: {0}"",  color );                 Console.WriteLine( ""Colors left: {0}. Press any key to continue..."", ColorsLeft-- );                 Console.ReadKey();            }         }     } } )   CLR_CompileC#( c#,,, FileName := A_ScriptDir ""\BGColors.exe"" ) Run % FileName Top TLM Posts: 703 Joined: 01 Oct 2013, 07:52 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 08 Apr 2015, 17:30 pass a string to SendWait() ( C# Send ) Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus c# = ( using System.Windows.Forms; class KeyStrokes {     public void Main(string var)     {         Keys( var );     }       private void Keys(string var) // recommeded approach     {         SendKeys.SendWait( var );     } } )   csObj := CLR_CreateObject( CLR_CompileC#( c#, ""System.dll | System.Windows.Forms.dll"" ), ""KeyStrokes"" )   csObj.Main( ""Send this string.."" ) Top IMEime Posts: 222 Joined: 20 Sep 2014, 06:15 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 09 Apr 2015, 19:31 RegEx. Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus Kodes = (     using System.Windows.Forms;     using System.Linq;                              using System.Collections.Generic;                       using System.Text.RegularExpressions;                   class Klass     {         public void Mesod()         {             string KnTs = @""             abc123def             abc1234def             abc1def             abc12def             "";              var Arrey = Regex.Matches( KnTs, @"".*?(\d+).*?"")                         .Cast<Match>()                         .Select( a => a.Groups[1].Value)                         .OrderByDescending( a => a.Length);             MessageBox.Show ( string.Join(""\n"", Arrey )) ;          }     } ) Leferences = (	Join| 	System.Windows.Forms.dll 	System.Core.dll 	mscorlib.dll 	System.dll ) CLR_CreateObject( CLR_CompileC#( Kodes, Leferences), ""Klass"").Mesod() Top TLM Posts: 703 Joined: 01 Oct 2013, 07:52 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 23 May 2015, 18:28 Return character descriptions Top IMEime Posts: 222 Joined: 20 Sep 2014, 06:15 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 23 May 2015, 19:07 TLM> Thanks for the nice codes. I have errors for a Chinese string; ""一二三"" 0x4E00 一 (One) 0x4E8C 二 (Two) 0x4E09 三 (Three) Any good tips ? Error descriptions is something like this; ""There are not resource name in image file."" Top TLM Posts: 703 Joined: 01 Oct 2013, 07:52 Re: .NET Framework Interop (CLR, C#, VB) Report this post Quote 23 May 2015, 20:25 Only the 1st character is available from that resource. CharSet.Unicode does nothing.. I'm trying to figure where to get other character descriptions. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 37 posts 1 2 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"Forum thread:."	"true"
"(Use in) other programming languages"	"ActiveScript - Host VBScript and JScript in-process"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=4555"	"Provides an interface to Active Scripting languages like VBScript and JScript, without relying on Microsoft's ScriptControl, which is not available to 64-bit programs."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"ActiveScript - Host VBScript and JScript in-process - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:32 All times are UTC-05:00 ActiveScript - Host VBScript and JScript in-process Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 19 posts • Page 1 of 1 lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos ActiveScript - Host VBScript and JScript in-process Report this post Quote 13 Sep 2014, 04:09 ActiveScript for AutoHotkey v1.1 Provides an interface to Active Scripting languages like VBScript and JScript, without relying on Microsoft's ScriptControl, which is not available to 64-bit programs. License: Use, modify and redistribute without limitation, but at your own risk. More information, examples and downloads ComObject := ComDispatch0(Object) - not needed in AutoHotkey v1.1.17+ Wraps an AutoHotkey object in an IDispatch interface, allowing COM clients such as the VBScript or JScript engines to call methods and set and get values. See Example_Dispatch0.ahk for examples. ComDispatch0 is based on fincs' ComDispatch, modified by Coco. Top Coco Posts: 767 Joined: 29 Sep 2013, 20:37 GitHub: cocobelgica Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 13 Sep 2014, 05:16 Very cool, thanks lexikos. How much tweaking does it need to make it work for v2? I noticed a couple of parsing loops and a .Remove() somewhere. Other than that most parts are v2 compatible... unless I missed something. Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 13 Sep 2014, 05:36 I would have to review the code closely and test to answer that. I didn't bother since there are some things it uses that I'm planning on changing soon, like meta-functions. If you're interested in this topic, you should read Support for passing objects to COM APIs - Wish List. Top fincs Posts: 484 Joined: 30 Sep 2013, 14:17 GitHub: fincs Location: Seville, Spain Contact: Contact fincs Website Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 13 Sep 2014, 05:52 This is very nice & much more elegant than my previous ScriptControl marshaling workaround. I'm also glad to see that my old ComDispatch lib is deemed useful by others and is updated/enhanced. lexikos wrote:there are some things it uses that I'm planning on changing soon, like meta-functions. Huh? I thought the new property syntax was introduced in order to minimize the need to use meta-functions and such avoid having to change how they work? fincs Windows 10 x64 Build 10240 / AutoHotkey v1.1.22.02 Get SciTE4AutoHotkey v3.0.06.01 - [My project list] Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 13 Sep 2014, 08:30 Very Nice! Just one thing tho... Is it just me or is this file not supposed to be on github? ?? https://github.com/Lexikos/ActiveScript ... properties Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 13 Sep 2014, 08:53 fincs: The idea was to minimize the cost in terms of any inconvenience that might be caused by making the meta-functions less quirky. It's still true that (as I said) ""the rules for how meta-functions work are complicated and error-prone,"" and that needs to be changed even if meta-functions aren't needed as much. By eliminating properties from the things meta-functions are commonly used for, there's less need to have them tied into the inheritance chain as they are now. joedf: It's just you. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 13 Sep 2014, 09:54 :0 ok Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Coco Posts: 767 Joined: 29 Sep 2013, 20:37 GitHub: cocobelgica Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 11 Oct 2014, 07:45 Edit: Ok, I got it, the same interface pointer is used for subsequent instance(s). So, say for SetWBClientSite(), can I recycle the same IOleClientSite, IServiceProvider and IInternetSecurityManager interface pointers(previously used) for subsequent WebBrowser control(s). @lexikos: I noticed that when you called .vftable() you used the class object itself (ActiveScriptSite), hence, the buffer is stored in the class object's member(s). Is this OK, since it gets overridden every time a new instance of ActiveScriptSite is created? Or it's OK since IActiveScript::SetScriptSite is only needed one-time? I'm currently writing a mod for your SetWBClientSite() routine and would like to base it on your ActiveScriptSite class, e.g.: the way you stored a weak reference to the instance of ActiveScript etc.. PS: It would be nice if you(or anyone knowledgeable) can do a tutorial on how to implement COM interfaces. I did learn/understand a few things, (while updating ComDispatch, etc.) Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 11 Oct 2014, 18:56 Coco wrote:Edit: Ok, I got it, the same interface pointer is used for subsequent instance(s).No. It's not an interface pointer, but a virtual function table. Normally in compiled languages, there is one table per class (per super-class/interface if it inherits multiple), and this is constructed at compile time, since the functions don't change at run-time. An interface pointer is a pointer to a pointer to the virtual function table. This is why you can compare NumGet(&obj) between objects to identify whether they're the same type of object. The interface pointer either points at the beginning of the object, or math can be used to locate the beginning of the object (the compiler handles this). For example, the second field of my ActiveScriptSite is a pointer to the IActiveScriptSiteWindow vtable, hence this line: Code: [Select all] [Download] GeSHi © Codebox Plus this -= A_PtrSize     ; Cast to IActiveScriptSiteNumGet(&this) returns the address of the vftable. Is this OK, since it gets overridden every time a new instance of ActiveScriptSite is created?It doesn't get overridden. Each vftable (_vft and _vft_w) is constructed only once; the first two lines of _vftable() ensure this. Top Coco Posts: 767 Joined: 29 Sep 2013, 20:37 GitHub: cocobelgica Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 12 Oct 2014, 02:31 lexikos wrote:An interface pointer is a pointer to a pointer to the virtual function table. I see that's why: func_addr := NumGet(NumGet(interface_ptr + 0), zero_based_index * A_PtrSize) Edit: Ok, after carefully reviewing it, I think I got it. So given the code below, is it OK to implement AddRef and Release? You do have a comment about avoiding circular references, does it apply in this case?: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus class WBClientSite { 	__New(self) 	{ 		ObjSetCapacity(this, ""__Site"", 3*A_PtrSize) 		NumPut(&self 		, NumPut(this.base._vftable(""_vft_IInternetSecurityManager"", ""11348733"") 		, NumPut(this.base._vftable(""_vft_IServiceProvider"", ""3"") 		, NumPut(this.base._vftable(""_vft_IOleClientSite"", ""031010"") 		    , this.__Ptr := ObjGetAddress(this, ""__Site"") ) ) ) ) 	}   	_vftable(name, args) 	{ 		if ( ptr := ObjGetAddress(this, name) ) 			return ptr   		static IUnknown 		if !IUnknown 		{ 			IUnknown := { 			(Join, Q C 				""QueryInterface"": RegisterCallback(this._QueryInterface, ""Fast"") 				""AddRef"":         RegisterCallback(this._AddRef, ""Fast"") 				""Release"":        RegisterCallback(this._Release, ""Fast"") 			)} 		}   		sizeof_VFTABLE := (3 + StrLen(args)) * A_PtrSize 		ObjSetCapacity(this, name, sizeof_VFTABLE) 		ptr := ObjGetAddress(this, name)   		NumPut(IUnknown.QueryInterface, ptr + 0*A_PtrSize) 		NumPut(IUnknown.AddRef,         ptr + 1*A_PtrSize) 		NumPut(IUnknown.Release,        ptr + 2*A_PtrSize)   		for i, argc in StrSplit(args) 		{ 			vfunc := RegisterCallback(this[SubStr(name, 6)], ""Fast"", argc+1, i) 			NumPut(vfunc, ptr + (3+i-1)*A_PtrSize) 		}   		return ptr 	}   	_QueryInterface(riid, ppvObject) 	{ 		static IID_IUnknown := ""{00000000-0000-0000-C000-000000000046}"" 		     , IID_IOleClientSite := ""{00000118-0000-0000-C000-000000000046}"" 		     , IID_IServiceProvider := ""{6d5140c1-7436-11ce-8034-00aa006009fa}""   		iid := WBClientSite._GUID2String(riid) 		if (iid = IID_IOleClientSite || iid = IID_IUnknown) 		{ 			NumPut(this, ppvObject+0) ;// IOleClientSite 			return 0 ;// S_OK 		} 		if (iid = IID_IServiceProvider) 		{ 			NumPut(this + A_PtrSize, ppvObject+0) ;// IServiceProvider 			return 0 ;// S_OK 		} 		NumPut(0, ppvObject+0) 		return 0x80004002 ;// E_NOINTERFACE 	}   	_AddRef() 	{ 		return 1 	}   	_Release() 	{ 		return 1 	}   	IOleClientSite(p1:="""", p2:="""", p3:="""") 	{ 		if (A_EventInfo == 3) ;// GetContainer 		{ 			NumPut(0, p1+0) ;// *ppContainer := NULL 			return 0x80004002 ;// E_NOINTERFACE 		} 		return 0x80004001 ;// E_NOTIMPL 	}   	IServiceProvider(guidService, riid, ppv) ;// QueryService 	{ 		static IID_IUnknown := ""{00000000-0000-0000-C000-000000000046}"" 		     , IID_IInternetSecurityManager := ""{79eac9ee-baf9-11ce-8c82-00aa004ba90b}""   		if (WBClientSite._GUID2String(guidService) = IID_IInternetSecurityManager) 		{ 			iid := WBClientSite._GUID2String(riid) 			if (iid = IID_IInternetSecurityManager || iid = IID_IUnknown) 			{ 				NumPut(this + A_PtrSize, ppv+0) ;// IInternetSecurityManager 				return 0 ;// S_OK 			} 			NumPut(0, ppv+0) 			return 0x80004002 ;// E_NOINTERFACE 		} 		NumPut(0, ppv+0) 		return 0x80004001 ;// E_NOTIMPL 	}   	IInternetSecurityManager(p1:="""", p2:="""", p3:="""", p4:="""", p5:="""", p6:="""", p7:="""", p8:="""") 	{ 		if (A_EventInfo == 5) ;// ProcessUrlAction 		{ 		 	if (p2 == 0x1400) ;// dwAction = URLACTION_SCRIPT_RUN 		 	{ 		 		NumPut(0x00, p3+0) ;// *pPolicy := URLPOLICY_ALLOW = 0x00 		 		return 0 ;// S_OK 		 	} 		} 		return 0x800C0011 ;// INET_E_DEFAULT_ACTION 	}   	_GUID2String(pGUID) 	{ 		VarSetCapacity(string, 38*2) 		DllCall(""ole32\StringFromGUID2"", ""ptr"", pGUID, ""str"", string, ""int"", 39) 		return string 	} } Another thing when you store a reference to the instance of ActiveScript, how come you were able to retrieve it using Object(NumGet(this + A_PtrSize*2)) , I believe &Script is the third field, however it's stored in ObjGetAddress(this, ""_site""). The pointers to vftable are also stored in ObjGetAddress(this, ""_site""). So if I understand correctly, ObjGetAddress(this, ""_site"") is IActiveScriptSite, right? Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 12 Oct 2014, 19:40 The comment was: Code: [Select all] [Download] GeSHi © Codebox Plus     ; AddRef and Release don't do anything because we want to avoid circular references.     ; The site and IActiveScript are both released when the AHK script releases its last     ; reference to the ActiveScript object. The references are: your ahk script -> ActiveScript -> IActiveScript -> site -> ActiveScript -> IActiveScript ... If the references were counted, there would be a circular reference. If your interface might be called after the ahk script releases all references to its WBClientSite instance, you need to implement reference counting to keep the interface alive until the WebBrowser no longer needs it. Otherwise, you don't need to implement reference counting. Another thingI guess you figured out this is the interface pointer, not the object. Top Relayer Posts: 72 Joined: 30 Sep 2013, 13:09 Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 16 Jan 2015, 17:25 lexikos, I see your vbscript example... is there a way to pass parameters into the vbscript. You show how to access variables to get them out but what if the vbscript function accepts and requires parameters? I tried: vb.variable := ""blah"" before executing vb.exec(code) but that didn't work Relayer Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 17 Jan 2015, 23:09 Relayer wrote:vb.variable := ""blah"" before executing vb.exec(code) but that didn't workThat's not passing a parameter... The example uses vb.GetAnswer() to call the GetAnswer function which was defined via Exec. If you want to pass a parameter, just do it. Code: [Select all] [Download] GeSHi © Codebox Plus vb.GetAnswer(42) You can only set a VBScript variable if it's already been declared: Example.ahk wrote:vb.Answer := 42 ; Set a previously-declared global variable. However, in AutoHotkey v1.1.18+ this requirement doesn't apply to JScript. Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 23 Jan 2015, 05:15 I've updated the script: JScript 5.8 (IE8) features such as JSON.parse() and JSON.stringify() are enabled automatically when using JScript. AddObject() now supports normal AutoHotkey objects on AutoHotkey v1.1.17+. Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 12 Feb 2016, 06:38 I've added a method for enabling the use of WinRT (the framework used by Windows 10 apps) with JsRT.Edge, and an example for displaying a toast notification. There's a list of WinRT APIs which can be used from desktop apps: https://msdn.microsoft.com/en-au/library/dn554295 Top jNizM Posts: 1581 Joined: 30 Sep 2013, 01:33 GitHub: jNizM Location: Germany Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 12 Feb 2016, 06:59 Looks great. Thank you lexikos. [AHK] 1.1.24.00 x64 Unicode [WIN] 7 Ultimate x64 SP1 | 10 Pro (10.0.10586) x64 Dropbox referrals (earn 500 MB of bonus and support me) Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 12 Feb 2016, 08:42 Ohhh fancy! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Coco Posts: 767 Joined: 29 Sep 2013, 20:37 GitHub: cocobelgica Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 20 Mar 2016, 04:02 @lexikos, not sure if you've seen it already, I submitted a PR - mainly to provide v2.0-a compatibility. Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: ActiveScript - Host VBScript and JScript in-process Report this post Quote 20 Mar 2016, 04:20 Merged, thanks. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 19 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"Provides an interface to Active Scripting languages like VBScript and JScript, without relying on Microsoft's ScriptControl, which is not available to 64-bit programs."	"true"
"(Use in) other programming languages"	"Exo-Javascript"	"https://github.com/Aurelain/Exo"	"Write AHK with JavaScript - Forum thread:, Exo-CLI (Interactive Command-line)."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"26"	"6"	"1"	"GitHub - Aurelain/Exo: Write AHK with JavaScript Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 6 Star 26 Fork 1 Aurelain/Exo Code Issues 3 Pull requests 0 Pulse Graphs Write AHK with JavaScript 9 commits 1 branch 0 releases Fetching contributors AutoHotkey 99.6% JavaScript 0.4% AutoHotkey JavaScript Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Latest commit 06b2e7e May 11, 2015 Aurelain v0.97 - Improved keyboard support + cosmetics … - Implemented a WebBrowser patch to allow the ""keydown"" and ""keyup"" events in JS - A_ScriptDir, A_ScriptFullPath and A_ScriptName now return the location of the JS file - removed padding around the WebBrowser element Permalink Failed to load latest commit information. lib v0.97 - Improved keyboard support + cosmetics May 11, 2015 Exo.ahk v0.97 - Improved keyboard support + cosmetics May 11, 2015 README.md demo.js v0.97 - Improved keyboard support + cosmetics May 11, 2015 README.md Exo: JavaScript unleashed! Imagine the power of AHK (File/OS/Keyboard/Mouse/GUI Management) in the hands of JavaScript. Imagine the ecosystem of JavaScript libraries (jQuery, CreateJS, etc.) in the hands of AHK. Exo makes this happen! Description Exo exposes most built-in commands/functions/variables of AHK to JavaScript, allowing you to practically write AHK inside JS (with JS syntax). There are several advantages to using JS, rather than AhkScript: A lot of people are already familiar with JS, so there's no need to learn the peculiarities of the AhkScript-syntax. Gain access to a huge repository of libraries written in JS. You can use JS-specific constructs (eval, anonymous functions, prototype, etc.). You get to code in your favorite JS editor (IDE). ... and more. It does all this by embedding a browser (Internet Explorer) and hooking into it with ComObject. It then bridges the JS global functions to their AHK counterpart. Goals While migrating the keywords, the following goals were set: try to port 100% of the functionality (89% achieved) try as much as possible to conform with the AHK documentation provide useful typing (i.e. we shouldn't return String types everywhere only because it's easy) Usage Launch Exo with a "".js"" file argument (either through drag-and-drop, or from the command-line). > Exo.ahk ""demo.js""  Sample code: alert(A_Now); FileAppend('Hello, World!', 'hello.txt') var list = Loop('*.txt'); for (var i = 0; i < list.length; i++) {     var fileProperties = list[i];     MsgBox(fileProperties.LongPath); } Sleep(1000); ExitApp(); About Authors: Aurelain (aurelain@gmail.com), with major contributions from Lexikos License: WTFPL Version: 0.96 Minimum requirements: AutoHotkey v1.1.17.01 Internet Explorer 8 Windows XP Migration Guide This section lists all relevant AHK keywords (Commands, Function, Directives and Variables) and illustrates their counterpart in JS. In most cases, there is no significant change and everything is intuitive. The breakdown for the following 470 keywords: 0) 13% were disregarded because they provided duplicate functionality 1) 37% were directly migrated (AHK Functions became JS Functions, AHK Variables became JS Variables) 2) 33% were migrated through subtle conversion (AHK Commands became JS Functions) 3) 6% were migrated through minor adjustment (AHK multiple-OutputVars became JS return Objects) 4) 7% could not be migrated, but there are alternatives or future prospects of being implemented. 5) 4% will never be migrated (mainly Directives and some very specific AHK Commands) Keywords that were not migrated (categories 0, 4 and 5) are marked bold. AHK Keyword JS Implementation JS Type 1, 2, 3, etc. Replacement: ""A_Args"" Array A_AhkPath Identical String A_AhkVersion Identical String A_AppData Identical String A_AppDataCommon Identical String A_AutoTrim Not needed (AHK specific) N/A A_BatchLines Identical String A_CaretX Identical String A_CaretY Identical String A_ComputerName Identical String A_ControlDelay Identical Number A_Cursor Identical String A_DD Identical String A_DDD Identical String A_DDDD Identical String A_DefaultMouseSpeed Identical Number A_Desktop Identical String A_DesktopCommon Identical String A_DetectHiddenText Identical String A_DetectHiddenWindows Identical String A_EndChar Cannot use yet N/A A_EventInfo Identical String A_ExitReason Identical String A_FileEncoding Identical String A_FormatFloat Identical String A_FormatInteger Identical String A_Gui Identical String A_GuiControl Identical String A_GuiControlEvent Identical String A_GuiEvent Identical String A_GuiHeight Identical Number A_GuiWidth Identical Number A_GuiX Identical Number A_GuiY Identical Number A_Hour Identical String A_IconFile Identical String A_IconHidden Identical Number A_IconNumber Identical String A_IconTip Identical String A_Index Not needed (AHK specific) N/A A_IPAddress1 Identical String A_IPAddress2 Identical String A_IPAddress3 Identical String A_IPAddress4 Identical String A_Is64bitOS Identical Number A_IsAdmin Identical Number A_IsCompiled Identical String A_IsCritical Identical Number A_IsPaused Identical Number A_IsSuspended Identical Number A_IsUnicode Identical String A_KeyDelay Identical Number A_Language Identical String A_LastError Identical String A_LineFile Cannot use yet N/A A_LineNumber Cannot use yet N/A A_LoopField Not needed as such (Returned by ""Loop()""). N/A A_LoopFileAttrib Not needed as such (Returned by ""Loop()""). N/A A_LoopFileDir Not needed as such (Returned by ""Loop()""). N/A A_LoopFileExt Not needed as such (Returned by ""Loop()""). N/A A_LoopFileFullPath Not needed as such (Returned by ""Loop()""). N/A A_LoopFileLongPath Not needed as such (Returned by ""Loop()""). N/A A_LoopFileName Not needed as such (Returned by ""Loop()""). N/A A_LoopFileShortName Not needed as such (Returned by ""Loop()""). N/A A_LoopFileShortPath Not needed as such (Returned by ""Loop()""). N/A A_LoopFileSize Not needed as such (Returned by ""Loop()""). N/A A_LoopFileSizeKB Not needed as such (Returned by ""Loop()""). N/A A_LoopFileSizeMB Not needed as such (Returned by ""Loop()""). N/A A_LoopFileTimeAccessed Not needed as such (Returned by ""Loop()""). N/A A_LoopFileTimeCreated Not needed as such (Returned by ""Loop()""). N/A A_LoopFileTimeModified Not needed as such (Returned by ""Loop()""). N/A A_LoopReadLine Not needed as such (Returned by ""Loop()""). N/A A_LoopRegKey Not needed as such (Returned by ""Loop()""). N/A A_LoopRegName Not needed as such (Returned by ""Loop()""). N/A A_LoopRegSubKey Not needed as such (Returned by ""Loop()""). N/A A_LoopRegTimeModified Not needed as such (Returned by ""Loop()""). N/A A_LoopRegType Not needed as such (Returned by ""Loop()""). N/A A_MDay Identical String A_Min Identical String A_MM Identical String A_MMM Identical String A_MMMM Identical String A_Mon Identical String A_MouseDelay Identical Number A_MSec Identical String A_MyDocuments Identical String A_Now Identical String A_NowUTC Identical String A_NumBatchLines Identical String A_OSType Identical String A_OSVersion Identical String A_PriorHotkey Identical String A_PriorKey Identical String A_ProgramFiles Identical String A_Programs Identical String A_ProgramsCommon Identical String A_PtrSize Identical Number A_RegView Identical String A_ScreenDPI Identical Number A_ScreenHeight Identical Number A_ScreenWidth Identical Number A_ScriptDir Identical String A_ScriptFullPath Identical String A_ScriptHwnd Identical String A_ScriptName Identical String A_Sec Identical String A_Space Identical String A_StartMenu Identical String A_StartMenuCommon Identical String A_Startup Identical String A_StartupCommon Identical String A_StringCaseSense Identical String A_Tab Identical String A_Temp Identical String A_ThisFunc Not needed (AHK specific) N/A A_ThisHotkey Identical String A_ThisLabel Not needed (AHK specific) N/A A_ThisMenu Identical String A_ThisMenuItem Identical String A_ThisMenuItemPos Identical String A_TickCount Identical Number A_TimeIdle Identical Number A_TimeIdlePhysical Identical Number A_TimeSincePriorHotkey Identical Number A_TimeSinceThisHotkey Identical Number A_TitleMatchMode Identical String A_TitleMatchModeSpeed Identical String A_UserName Identical String A_WDay Identical String A_WinDelay Identical Number A_WinDir Identical String A_WorkingDir Identical String A_YDay Identical String A_Year Identical String A_YWeek Identical String A_YYYY Identical String Abs() Identical Number ACos() Identical Number Array() Not needed (AHK specific) N/A Asc() Identical Number ASin() Identical Number ATan() Identical Number AutoTrim Not needed (AHK specific) N/A BlockInput Normalization Empty Ceil() Identical Number Chr() Identical String Click Normalization Empty Clipboard Identical String ClipboardAll Identical String ClipWait Normalization Empty ComObjActive() Cannot use yet N/A ComObjArray() Cannot use yet N/A ComObjConnect() Cannot use yet N/A ComObjCreate() Cannot use yet N/A ComObject() Cannot use yet N/A ComObjEnwrap() Not needed (Deprecated) N/A ComObjError() Cannot use yet N/A ComObjFlags() Cannot use yet N/A ComObjGet() Cannot use yet N/A ComObjMissing() Not needed (Deprecated) N/A ComObjParameter() Cannot use yet N/A ComObjQuery() Cannot use yet N/A ComObjType() Cannot use yet N/A ComObjUnwrap() Not needed (Deprecated) N/A ComObjValue() Cannot use yet N/A ComSpec Identical String Control Normalization Empty ControlClick Normalization Empty ControlFocus Normalization Empty ControlGet Normalization String ControlGetFocus Normalization String ControlGetPos Minor change (returns Object) {} ControlGetText Normalization String ControlMove Normalization Empty ControlSend Normalization Empty ControlSendRaw Normalization Empty ControlSetText Normalization Empty CoordMode Normalization Empty Cos() Identical Number Critical Normalization Empty DetectHiddenText Normalization Empty DetectHiddenWindows Normalization Empty DllCall() Identical String Drive Normalization Empty DriveGet Normalization String DriveSpaceFree Normalization Number Edit Cannot use yet N/A EnvAdd Not needed (Feature duplication) N/A EnvDiv Not needed (Feature duplication) N/A EnvGet Normalization String EnvMult Not needed (Feature duplication) N/A EnvSet Normalization Empty EnvSub Not needed (Feature duplication) N/A EnvUpdate Normalization Empty ErrorLevel Identical N/A Exception Not needed (AHK specific) N/A Exit Not needed (AHK specific) N/A ExitApp Normalization Empty Exp() Identical Number FileAppend Normalization Empty FileCopy Normalization Empty FileCopyDir Normalization Empty FileCreateDir Normalization Empty FileCreateShortcut Normalization Empty FileDelete Normalization Empty FileEncoding Normalization Empty FileExist() Identical String FileGetAttrib Normalization String FileGetShortcut Minor change (returns Object) {} FileGetSize Normalization Number FileGetTime Normalization String FileGetVersion Normalization String FileInstall Cannot use compile-time features. N/A FileMove Normalization Empty FileMoveDir Normalization Empty FileOpen() Minor change (RawRead() multiple output) File FileRead Normalization String FileReadLine Normalization String FileRecycle Normalization Empty FileRecycleEmpty Normalization Empty FileRemoveDir Normalization Empty FileSelectFile Normalization String FileSelectFolder Normalization String FileSetAttrib Normalization Empty FileSetTime Normalization Empty Floor() Identical Number FormatTime Normalization String Func() Not needed (AHK specific) N/A GetKeyName() Identical String GetKeySC() Identical Number GetKeyState Not needed (occluded by homonym) String GetKeyState() Identical Number GetKeyVK() Identical Number Gosub Cannot use (AHK specific) N/A Goto Cannot use (AHK specific) N/A GroupActivate Normalization Empty GroupAdd Normalization Empty GroupClose Normalization Empty GroupDeactivate Normalization Empty Gui Normalization Empty GuiClose Minor change (built-in label becomes built-in function) Empty GuiContextMenu Minor change (built-in label becomes built-in function) Empty GuiControl Normalization Empty GuiControlGet Normalization String GuiDropFiles Minor change (built-in label becomes built-in function) Empty GuiEscape Minor change (built-in label becomes built-in function) Empty GuiSize Minor change (built-in label becomes built-in function) Empty Hotkey Minor change (target label becomes closure) Empty IL_Add() Identical Number IL_Create() Identical Number IL_Destroy() Identical Number ImageSearch Minor change (returns Object) {} IniDelete Normalization Empty IniRead Normalization String IniWrite Normalization Empty Input Normalization String InputBox Normalization String InStr() Identical Number IsByRef() Not needed (AHK specific) N/A IsFunc() Not needed (AHK specific) N/A IsLabel() Not needed (AHK specific) N/A IsObject() Not needed (AHK specific) N/A KeyHistory Normalization Empty KeyWait Normalization Empty ListHotkeys Normalization Empty ListLines Cannot implement for JS N/A ListVars Cannot implement for JS N/A Ln() Identical Number Log() Identical Number Loop Major change {} LTrim() Identical String LV_Add() Identical Number LV_Delete() Identical Number LV_DeleteCol() Identical Number LV_GetCount() Identical Number LV_GetNext() Identical Number LV_GetText() Major change String/{} LV_Insert() Identical Number LV_InsertCol() Identical Number LV_Modify() Identical Number LV_ModifyCol() Identical Number LV_SetImageList() Identical Number Menu Normalization Empty Mod() Identical Number MouseClick Normalization Empty MouseClickDrag Normalization Empty MouseGetPos Minor change (returns Object) {} MouseMove Normalization Empty MsgBox Normalization Empty NumGet() Cannot use yet N/A NumPut() Cannot use yet N/A ObjAddRef() Not needed (AHK specific) N/A ObjClone() Not needed (AHK specific) N/A Object() Not needed (AHK specific) N/A ObjGetAddress() Not needed (AHK specific) N/A ObjGetCapacity() Not needed (AHK specific) N/A ObjHasKey() Not needed (AHK specific) N/A ObjInsert() Not needed (AHK specific) N/A ObjMaxIndex() Not needed (AHK specific) N/A ObjMinIndex() Not needed (AHK specific) N/A ObjNewEnum() Not needed (AHK specific) N/A ObjRelease() Not needed (AHK specific) N/A ObjRemove() Not needed (AHK specific) N/A ObjSetCapacity() Not needed (AHK specific) N/A OnClipboardChange Minor change (built-in label becomes built-in function) Empty OnExit Minor change (target label becomes closure) Empty OnMessage() Minor change (target function becomes closure) Empty OutputDebug Normalization Empty Pause Normalization Empty PixelGetColor Normalization String PixelSearch Minor change (returns Object) {} PostMessage Normalization Empty Process Normalization Empty ProgramFiles Identical String Progress Normalization Empty Random Major change Num/Empty RegDelete Normalization Empty RegExMatch() Major change Number/{} RegExReplace() Major change String/{} RegisterCallback() Cannot use yet N/A RegRead Normalization String RegWrite Normalization Empty Reload Normalization Empty Round() Identical Number RTrim() Identical String Run Normalization Empty RunAs Normalization Empty RunWait Major change (doesn't return exit code) String SB_SetIcon() Identical Number SB_SetParts() Identical Number SB_SetText() Identical Number Send Normalization Empty SendEvent Normalization Empty SendInput Normalization Empty SendLevel Normalization Empty SendMessage Normalization Empty SendMode Normalization Empty SendPlay Normalization Empty SendRaw Normalization Empty SetBatchLines Normalization Empty SetCapslockState Normalization Empty SetControlDelay Normalization Empty SetDefaultMouseSpeed Normalization Empty SetEnv Not needed (AHK specific) N/A SetFormat Normalization Empty SetKeyDelay Normalization Empty SetMouseDelay Normalization Empty SetNumLockState Normalization Empty SetRegView Normalization Empty SetScrollLockState Normalization Empty SetStoreCapslockMode Normalization Empty SetTimer Cannot use yet Empty SetTitleMatchMode Normalization Empty SetWinDelay Normalization Empty SetWorkingDir Normalization Empty Shutdown Normalization Empty Sin() Identical Number Sleep Normalization Empty Sort Major change String SoundBeep Normalization Empty SoundGet Normalization Str/Num SoundGetWaveVolume Normalization Number SoundPlay Normalization Empty SoundSet Normalization Empty SoundSetWaveVolume Normalization Empty SplashImage Normalization Empty SplashTextOff Normalization Empty SplashTextOn Normalization Empty SplitPath Minor change (returns Object) {} Sqrt() Identical Number StatusBarGetText Normalization String StatusBarWait Normalization Empty StrGet() Identical String StringCaseSense Normalization Empty StringGetPos Normalization Number StringLeft Normalization String StringLen Normalization String StringLower Normalization String StringMid Normalization String StringReplace Normalization String StringRight Normalization String StringSplit Not needed (deprecated by StrSplit) N/A StringTrimLeft Normalization String StringTrimRight Normalization String StringUpper Normalization String StrLen() Identical Number StrPut() Identical Str/Num StrSplit() Identical Array SubStr() Identical String Suspend Normalization Empty SysGet Minor change (returns Object) Str/Num/{} Tan() Identical Number Thread Normalization Empty ToolTip Normalization Empty Transform Normalization Str/Num TrayTip Normalization Empty Trim() Identical String TV_Add() Identical Number TV_Delete() Identical Number TV_Get() Identical Number TV_GetChild() Identical Number TV_GetCount() Identical Number TV_GetNext() Identical Number TV_GetParent() Identical Number TV_GetPrev() Identical Number TV_GetSelection() Identical Number TV_GetText() Major change String/{} TV_Modify() Identical Number TV_SetImageList() Identical Number UrlDownloadToFile Normalization Empty VarSetCapacity() Cannot use yet N/A WinActivate Normalization Empty WinActivateBottom Normalization Empty WinActive() Identical String WinClose Normalization Empty WinExist() Identical String WinGet Minor change (returns Object) Str/Num/{} WinGetActiveStats Minor change (returns Object) {} WinGetActiveTitle Normalization String WinGetClass Normalization String WinGetPos Minor change (returns Object) {} WinGetText Normalization String WinGetTitle Normalization String WinHide Normalization Empty WinKill Normalization Empty WinMaximize Normalization Empty WinMenuSelectItem Normalization Empty WinMinimize Normalization Empty WinMinimizeAll Normalization Empty WinMinimizeAllUndo Normalization Empty WinMove Normalization Empty WinRestore Normalization Empty WinSet Normalization Empty WinSetTitle Normalization Empty WinShow Normalization Empty WinWait Normalization Empty WinWaitActive Normalization Empty WinWaitClose Normalization Empty WinWaitNotActive Normalization Empty #ClipboardTimeout Cannot use directives N/A #CommentFlag Not needed (AHK specific) N/A #ErrorStdOut Not needed (AHK specific) N/A #EscapeChar Not needed (AHK specific) N/A #HotkeyInterval Cannot use directives N/A #HotkeyModifierTimeout Cannot use directives N/A #Hotstring Cannot use directives. TODO: implement ""Hotstring()"" by Menixator N/A #If Cannot use directives. Try ""Hotkey()""+""if"" instead. N/A #IfTimeout Cannot use directives. Try ""Hotkey()""+""if"" instead. N/A #IfWinActive Cannot use directives. Try ""Hotkey()""+""if"" instead. N/A #IfWinExist Cannot use directives. Try ""Hotkey()""+""if"" instead. N/A #Include Cannot use yet. N/A #InputLevel Cannot use directives N/A #InstallKeybdHook Cannot use directives N/A #InstallMouseHook Cannot use directives N/A #KeyHistory Cannot use directives N/A #LTrim Not needed (AHK specific) N/A #MaxHotkeysPerInterval Cannot use directives N/A #MaxMem Cannot use directives N/A #MaxThreads Cannot use directives N/A #MaxThreadsBuffer Cannot use directives N/A #MaxThreadsPerHotkey Cannot use directives N/A #MenuMaskKey Cannot use directives N/A #NoEnv Not needed (AHK specific) N/A #NoTrayIcon Cannot use directives. Try ""Menu()"" instead. N/A #Persistent Cannot use directives. Try creating a (dummy) ""hotkey()"". N/A #SingleInstance Cannot use directives. Try ""Run"" and ""/restart"" instead. N/A #UseHook Cannot use directives. Try ""Hotkey($)"" instead. N/A #Warn Not needed (AHK specific) N/A #WinActivateForce Cannot use directives N/A ~ Addition: ""Require()"" (a globally scoped #Include) Empty TODO Test every keyword Accept/Provide URI paths in all transactions (not DOS-style paths) Allow ""Include"" to use online URL Implement ""IncludeAgain"" Implement ""DateAdd"" and ""DateDiff"" Implement some of the Directives (especially ""#SingleInstance"") Maybe implement a console (Firebug lite has some issues) Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/Aurelain/Exo"	"Write AHK with JavaScript - Forum thread:, Exo-CLI (Interactive Command-line)."	"true"
"(Use in) other programming languages"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=5714"	"Write AHK with JavaScript - Forum thread:, Exo-CLI (Interactive Command-line)."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Exo: JavaScript unleashed! - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:32 All times are UTC-05:00 Exo: JavaScript unleashed! Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 70 posts 1 2 3 4 Next Aurelain Posts: 29 Joined: 02 Sep 2014, 15:37 Exo: JavaScript unleashed! Report this post Quote 25 Dec 2014, 09:19 Exo License: WTFPL Imagine the power of AHK (File/OS/Keyboard/Mouse/GUI Management) in the hands of JavaScript. Imagine the ecosystem of JavaScript libraries (jQuery, CreateJS, etc.) in the hands of AHK. Exo makes this happen! Description Exo exposes most built-in commands/functions/variables of AHK to JavaScript, allowing you to practically write AHK inside JS (with JS syntax). There are several advantages to using JS, rather than AhkScript: A lot of people are already familiar with JS, so there's no need to learn the peculiarities of the AhkScript-syntax. Gain access to a huge repository of libraries written in JS. You can use JS-specific constructs (eval, anonymous functions, prototype, etc.). You get to code in your favorite JS editor (IDE).... and more. It does all this by embedding a browser (Internet Explorer) and hooking into it with ComObject. It then bridges the JS global functions to their AHK counterpart. Goals While migrating the keywords, the following goals were set: try to port 100% of the functionality (89% achieved) try as much as possible to conform with the AHK documentation provide useful typing (i.e. we shouldn't return String types everywhere only because it's easy) Usage Launch Exo with a "".js"" file argument (either through drag-and-drop, or from the command-line): > Exo.ahk ""demo.js"" Sample code: Code: [Select all] [Download] GeSHi © Codebox Plus alert(A_Now); FileAppend('Hello, World!', 'hello.txt') var list = Loop('*.txt'); for (var i = 0; i < list.length; i++) { 	var fileProperties = list[i]; 	MsgBox(fileProperties.LongPath); } Sleep(1000); ExitApp();   Migration Guide The GitHub readme lists all relevant AHK keywords (Commands, Function, Directives and Variables) and illustrates their counterpart in JS. In most cases, there is no significant change and everything is intuitive. The breakdown for the 470 keywords: 0) 13% were disregarded because they provided duplicate functionality 1) 37% were directly migrated (AHK Functions became JS Functions, AHK Variables became JS Variables) 2) 33% were migrated through subtle conversion (AHK Commands became JS Functions) 3) 6% were migrated through minor adjustment (AHK multiple-OutputVars became JS return Objects) 4) 7% could not be migrated, but there are alternatives or future prospects of being implemented. 5) 4% will never be migrated (mainly Directives and some very specific AHK Commands) Source: Exo on GitHub (you also need the items in the ""lib"" sub-folder). Last edited by Aurelain on 02 Jan 2015, 09:23, edited 1 time in total. Top Aurelain Posts: 29 Joined: 02 Sep 2014, 15:37 Re: Exo: JavaScript unleashed! Report this post Quote 25 Dec 2014, 09:38 Notes: Shared credits: lexikos, for putting me on the right track in this thread Coco, for the ComDispatch library GeekDude, for the FixIE function SKAN, for the Args function The RegEx is faster in JS than in AHK. For certain kinds of scenarios, it might be better to write your script in JS, and output the results with Exo. However, the overhead of moving large chunks of data in and out of JS usually is larger than the gains of the faster RegEx. Besides, I find it hard to think of a circumstances where these speed differences matter. Errors thrown in AHK produce warnings in JS and can be caught with try/catch in JS (I couldn't believe it when I saw it). However, Exo denies this mechanism by enclosing the AHK code in a try/catch of its own. It does this to stop JS producing popups for errors that are normally silent (e.g. a FileDelete that fails). Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: Exo: JavaScript unleashed! Report this post Quote 25 Dec 2014, 11:11 Very Nice! Gives like a feeling for Node.js or PhantomJS... Nicknames : ahk.js or js.ahk Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: Exo: JavaScript unleashed! Report this post Quote 25 Dec 2014, 18:01 Looks good. I'll be interested to see how much this is taken up. It does all this by embedding a browser (Internet Explorer) and hooking into it with ComObject.That seems a bit... heavy. Why not use the ScriptControl object or ActiveScript? You wouldn't get functions like eval(), I suppose. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: Exo: JavaScript unleashed! Report this post Quote 25 Dec 2014, 18:45 Yes, I actually thought of that too, but wasn't sure... By the way, happy holidays! (@lexikos it's alright, no need to respond ) Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: Exo: JavaScript unleashed! Report this post Quote 25 Dec 2014, 21:31 You've marked EnvAdd and EnvSub as ""Not needed (Feature duplication)"", but does JS have date math? If not, I suppose you could implement v2's DateAdd and DateDiff using EnvAdd and EnvSub respectively, rather than duplicating those commands exactly. Aurelain wrote:The RegEx is faster in JS than in AHK.They have slightly different syntax and features, though. Using AutoHotkey's RegEx (PCRE) within JS would probably be inconvenient, due to the need to escape backslashes, which doesn't apply to /this syntax/. Top Aurelain Posts: 29 Joined: 02 Sep 2014, 15:37 Re: Exo: JavaScript unleashed! Report this post Quote 26 Dec 2014, 03:26 joedf wrote:Gives like a feeling for Node.js Indeed, it was Node.js that put me on this path. However, I disliked its emphasis on asynchronous operations (they do offer synchronous file operations, but they're like an afterthought). Anyway, AHK (and by extension Exo) is richer, leaner and no-nonsense . lexikos wrote:Why not use the ScriptControl object or ActiveScript? Because I bulled through with development and did not investigate alternatives . I'll research ActiveScript now, but if I were to defend the embedded browser, here's a quick argument: You can also build actual HTML UI and ""sprinkle"" it with Exo. I'm also curious to see how much Exo is taken up. I can say one thing for sure: I'll convince people at my workplace to use it. Top vasili111 Posts: 639 Joined: 21 Jan 2014, 02:04 Location: Georgia Re: Exo: JavaScript unleashed! Report this post Quote 26 Dec 2014, 03:59 Very good idea. JavaScript is very powerful language with lots of libraries. By the way, DRAKON Editor suppurts JavaScript too. DRAKON-AutoHotkey: Visual programming for AutoHotkey. Top Aurelain Posts: 29 Joined: 02 Sep 2014, 15:37 Re: Exo: JavaScript unleashed! Report this post Quote 26 Dec 2014, 04:08 About EnvAdd and EnvSub... JS does allow operations with dates. They are a bit cumbersome and don't support the YYYYMMDDHH24MISS format, so there is a loss of functionality here. I'll add DateAdd and DateDiff on the TODO list. About the RegEx... I've attached a quick comparison. I used a large XML file (80MB, needed to add #MaxMem 1000), and used the following test units: Spoiler Code: [Select all] [Download] GeSHi © Codebox Plus FileRead, contents, large_file.xml time := A_TickCount output := RegExReplace(contents, ""<.*?>"", """") Msgbox % A_TickCount - time ; 1200   Code: [Select all] [Download] GeSHi © Codebox Plus var contents = FileRead(""large_file.xml""); var time = new Date().getTime(); contents = contents.replace(/<.*?>/g,''); alert(new Date().getTime() - time); // 1400   Code: [Select all] [Download] GeSHi © Codebox Plus var contents = FileRead(""large_file.xml""); var time = new Date().getTime(); contents = RegExReplace(contents, ""<.*?>"", """"); alert(new Date().getTime() - time); // 1800   Conclusions: I was wrong about JS RegEx being faster than AHK RegEx (or at least it's not clear cut) Escaping is not annoying in Exo RegEx. As a side-note, escaping DOS-style paths in Exo is annoying (FileRead(""C:\\Windows\\system.ini"")). That is why I added the following TODO note: ""Accept/Provide URI paths in all transactions (not DOS-style paths)"" Attachments regex_comparison.png (4.48 KiB) Viewed 3402 times Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: Exo: JavaScript unleashed! Report this post Quote 27 Dec 2014, 04:39 It looks like you've worked around a number of limitations which actually don't exist. Exo.send stores closures and instead passes an ID to AutoHotkey. This is unnecessary: you can simply pass the closure, and later call closure.call(...) from AutoHotkey. That also allows you to specify this (or if you pass ComObject(0,0), it automatically gets replaced with the window object). trigger (in Exo.ahk) has an if-else-if ladder to handle varying number of parameters. Instead, you can do this: Code: [Select all] [Download] GeSHi © Codebox Plus result := ExoObj.trigger(closureId, args*) The description of Exo.receive reads: * This function gets called by AHK to store values in ""_result"". * It was needed because we want the result to have a native type, not just ""String"". * The ""_result"" that gets set here will be returned by ""send()"". This is not true: ComDispatch is capable of returning not just strings, but also numbers and COM objects. However, your inject and receive functions still have a purpose: they convert AutoHotkey arrays to JavaScript arrays, and likewise for Objects. One alternative would be for the API functions to create JavaScript arrays/objects (via some helper JS) and return those directly. I'm not really sure what you mean by ""attempt to mitigate the race condition by speeding up the registering"", but I always wait for the document to load (even about:blank): Code: [Select all] [Download] GeSHi © Codebox Plus while wb.ReadyState != 4     Sleep 100 fixIE (or your usage of it) has problems: It writes to the registry, then later deletes the value, with no regard to whether the value already existed (i.e. perhaps the user already set a value for AutoHotkey.exe to cover all of their scripts). Your script never gets to call fixIE(false) if the js called ExitApp. You could work around that by calling fixIE(false) before writing the mainContent script. (By this time, the rendering mode is already locked in, so the registry setting is no longer needed.) I'm not sure if it's completely equivalent, but at least going by document.documentMode (and the fact that Exo works), using the X-UA-Compatible tag is an alternative. To use it, you must load the document from a file (see below). I think it's bad form to document.write things before and after the <html> tags, or at all. You can eliminate fixIE and one document.write call by using a HTML file: Code: [Select all] [Download] (Exo.htm)GeSHi © Codebox Plus <!doctype html> <html> <head>   <meta http-equiv=""X-UA-Compatible"" content=""IE=edge"">   <script src=""lib/Exo.js""></script> </head> <body> </body> </html>If Exo was compiled, this HTML could be embedded in the EXE as a resource and loaded via the res:// protocol. The same could be done for Exo.js, so no external files would be needed. (Personally, I'd prefer not to compile Exo.) Instead of writing <script>__AHK = {}</script>, you can just include var __AHK in Exo.js and set __AHK after the document finishes loading. Instead of writing ""<script>"" . mainContent . ""</script>"", you can call wb.document.parentWindow.eval(mainContent). With AutoHotkey v1.1.17 (released today), ComDispatch is not needed. You can replace the first line below with the second: Code: [Select all] [Download] GeSHi © Codebox Plus wb.document.parentWindow.__AHK := ComDispatch("""", ""bridge"") wb.document.parentWindow.__AHK := {bridge: Func(""bridge"")}It's also possible to pass Func objects to JS directly. So for instance: Code: [Select all] [Download] GeSHi © Codebox Plus ; Put this in Exo.js: var bridge   ; After the document loads, initialize bridge like so: wb.document.parentWindow.bridge := Func(""bridge"")   ; Also remove 'this' from the parameter list of bridge: bridge(name,args*){ Top Aurelain Posts: 29 Joined: 02 Sep 2014, 15:37 Re: Exo: JavaScript unleashed! Report this post Quote 27 Dec 2014, 10:42 Lexikos, thank you so much for the review. To sum-up your post: Exo could pass native closures (JS functions) directly to AHK so they can be triggered at a later time by AHK. I've tested it and you're right. It's pretty close to magic how something like this can be achieved . I will soon implement it, but first let's debate an issue. The current setup relies on a single function (""send()"") to communicate with AHK, by passing arguments through ""eval()"". Basically, it stringifies the arguments, which is something that prevents us sending actual closures. We should therefore ""apply()"" the ""bridge()"". But we can't, because in JS the ""bridge()"" has a strange existance: With ""ComDispatch"": typeof bridge -> ""unknown"", JSON.stringify(bridge) -> ""undefined"" With ""Func(bridge)"" (new in v1.1.17.00): typeof bridge -> ""Object"", JSON.stringify(bridge) -> ""{}"" So I think we're left with 2 options: A. either I rethink the whole JS API and no longer use a centralized ""send()"", but instead each JS API function directly calls ""bridge()"" with whatever arguments it needs B. or I create an if-else-if ladder (better yet, a switch) and make 10 direct calls to ""bridge()"" inside ""send()"", based on the number of arguments. I'd strongly go with option B. What's your take on this? AHK is capable to return not just strings, but also numbers. However, as you've mentioned, inject/receive still have a role in returning Array/Object. We should wait for the browser's ReadyState. You're right about it. Will do. FixIE is used somewhat crudely. Will solve it. The current usage of document.write could be replaced through more conventional methods. Will investigate, I think I tried X-UA-Compatible a month ago and failed. Either way, writing outside the <html> tag is something I also hate. AutoHotkey v1.1.17 adds some syntactic sugar . I'd implement it in a heartbeat, but I'm worried not enough people have it. Should I go for it? Top Coco Posts: 767 Joined: 29 Sep 2013, 20:37 GitHub: cocobelgica Re: Exo: JavaScript unleashed! Report this post Quote 27 Dec 2014, 11:04 Here's a mod of FixIE() (works on v2 as well): Code: [Select all] [Expand] [Download] (BrowserEmulation.ahk)GeSHi © Codebox Plus /* Function: BrowserEmulation  *     FEATURE_BROWSER_EMULATION -> http://goo.gl/V01Frx  * Syntax:  *     BrowserEmulation( [ version ] )  * Parameter(s):  *     version  [in, opt] - IE version(7+). Integer between 7 - 11, value can be  *                          negative. If omitted, current setting is returned.  *                          If 'version' is the word ""edge"", installed IE version  *                          is used. See table below for possible values:  * Parameter ""version"" values table:  * (values that are negative ignore !DOCTYPE directives, see http://goo.gl/V01Frx)  *     7:  7000               ; 0x1B58           - IE7 Standards mode.  *     8:  8000,  -8:  8888   ; 0x1F40  | 0x22B8 - IE8 mode, IE8 Standards mode  *     9:  9000,  -9:  9999   ; 0x2328  | 0x270F - IE9 mode, IE9 Standards mode  *     10: 10000, -10: 10001  ; 0x02710 | 0x2711 - IE10 Standards mode  *     11: 11000, -11: 11001  ; 0x2AF8  | 0x2AF9 - IE11 edge mode  * Remarks:  *     This function modifes the registry.  */ BrowserEmulation(version:=""*"") ;// FEATURE_BROWSER_EMULATION -> http://goo.gl/V01Frx { 	static key := ""HKCU\Software\"" . ( A_Is64bitOS ? ""Wow6432Node\"" : """" ) 	. ""Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BROWSER_EMULATION\"" 	. ( A_IsCompiled ? A_ScriptName : StrGet(DllCall(""Shlwapi\PathFindFileName"", ""Str"", A_AhkPath)) )   	static WshShell := ComObjCreate(""WScript.Shell"")   	static prev := ""*"" 	if (prev == ""*"") ;// init 		try prev := WshShell.RegRead(key) 		catch ;// value does not exist 			prev := """"   	;// __Get() 	if (version == ""*"") 	{ 		try val := WshShell.RegRead(key) 		catch ;// value does not exist 			val := """" ;// throw Exception()?? 		finally 			return val 	}   	;// __Set() 	ie_version := Round(WshShell.RegRead(""HKLM\SOFTWARE\Microsoft\Internet Explorer\svcVersion"")) 	if (ie_version < 8) ;// unsure of this but I read it somewhere... 		throw Exception(""FEATURE_BROWSER_EMULATION is only available for IE8 and later."")   	if version 	{ 		if !(version ~= ""i)^7|-?(8|9|1[01])|edge$"") 			throw Exception(Format(""Invalid argument: '{1}'"", version)) 		if (version = ""edge"") 			version := ie_version 		version := Round(version * (version>0 ? 1000 : -(version>=-9 ? 1111 : 1000.1))) 	}   	try version? WshShell.RegWrite(key, version, ""REG_DWORD"") 	           : (prev != """" ? WshShell.RegWrite(key, prev, ""REG_DWORD"") : WshShell.RegDelete(key)) 	catch error 		throw error 	finally 		return BrowserEmulation() ;// OR return the value itself } Specify the version(7-11) for the argument, if version is negative (such as -11), the function will use the value w/c ignore !DOCTYPE directives. If version is the word edge, value is set based on the version of IE installed. Specify 0 or """" to disable(if the registry value already exists as pointed out by lexikos) OR delete the registry value. Last edited by Coco on 28 Dec 2014, 07:58, edited 1 time in total. Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: Exo: JavaScript unleashed! Report this post Quote 27 Dec 2014, 18:04 Aurelain wrote:The current setup relies on a single function (""send()"") to communicate with AHK, by passing arguments through ""eval()"". Basically, it stringifies the arguments, which is something that prevents us sending actual closures.No, that's not the case. It does not stringify the arguments; it writes a string of expressions: a[0], a[1], etc. When these are evaluated, they return the actual value of each array element, which is then passed on to the function. They can most certainly be objects. We should therefore ""apply()"" the ""bridge()"". But we can't, because in JS the ""bridge()"" has a strange existanceSimply put, bridge is an AutoHotkey Func object, not a JavaScript Function object. With ComDispatch it was more strange: __AHK.bridge wasn't an object at all, but a member of an object. This seems to work, even though bridge is not a JavaScript Function: Code: [Select all] [Download] GeSHi © Codebox Plus Function.prototype.apply.call(bridge, null, [""MsgBox"", ""Hello, world!""]) Coco wrote:Specify 0 or """" to disable(if the registry value already exists as pointed out by lexikos) OR delete the registry value.It will not restore the previous setting, will it? Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: Exo: JavaScript unleashed! Report this post Quote 27 Dec 2014, 18:57 There's a bug in OnMessage: mapOnMessageClosures.Remove(MsgNumber) When used like this, Remove interprets MsgNumber like an array index. If you have {100:a, 101:b} and you call Remove(100), you'll end up with {100:b}. You need to write Remove(MsgNumber, """") in v1.1 (not v2). Top Coco Posts: 767 Joined: 29 Sep 2013, 20:37 GitHub: cocobelgica Re: Exo: JavaScript unleashed! Report this post Quote 28 Dec 2014, 08:00 lexikos wrote:It will not restore the previous setting, will it?Oops, fixed now. Thanks. Top Aurelain Posts: 29 Joined: 02 Sep 2014, 15:37 Speed tests Report this post Quote 28 Dec 2014, 12:41 The following post is mostly of interest to lexikos. I've tested the performance of large data transfers between AHK and JS. The results are somewhat non-statistical, but there might be some usefull data here. Basically, there are 3 ways of hooking into the ActiveX Internet Explorer: 1) Using ComDispatch (the way Exo currently uses) wb.document.parentWindow.dummy := ComDispatch("""", ""bridge"") 2) Registering an AHK object, with the newly added feature of v1.1.17.00: wb.document.parentWindow.dummy := {bridge:Func(""bridge"")} 3) Registering an AHK function, with the newly added feature of v1.1.17.00: wb.document.parentWindow.dummy.bridge := Func(""bridge"") Also, there are 3 ways of obtaining data from AHK A) The direct way: by using the return value. var result = dummy.bridge(); B) The indirect way: AHK doesn't return anything, but instead sets a global variable in JS. var result; dummy.bridge(); // AHK sets ""result"" like this: wb.document.parentWindow.result = ""foobar""; C) The convoluted way: AHK doesn't return anything, but instead calls a global function in JS that sets a global variable in JS. var result; var store = function(param){result = param;} dummy.bridge(); // AHK calls ""store()"" like this: wb.document.parentWindow.store(""foobar""); The test script is attached (not really interesting for anyone). Large files can be found here The results are attached. They vary from one run to another, but some things are constant: Using the return value is twice as slow as the other options The return value of ComDispatch has an atrocious performance Apparently, using Func() (combination C3) is best for Exo's purposes, but I'm not absolutely sure about this. Attachments Bridge_test.zip (4.58 KiB) Downloaded 47 times Bridge_test.png (11.02 KiB) Viewed 3218 times Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: Exo: JavaScript unleashed! Report this post Quote 29 Dec 2014, 03:43 lexikos wrote:Why not use the ScriptControl object or ActiveScript? You wouldn't get functions like eval(), I suppose.That was a bad example; eval() is actually part of the JScript engine, not the IE object model. alert() is a better example. However, I've found that ScriptControl and ActiveScript aren't just lacking the alert function, they're also stuck with an older version of the JScript language. Passing {16d51579-a30b-4c8b-a276-0ff4dc41e755} to ActiveScript or cscript.exe gets version 11 of the engine (according to ScriptEngineMajorVersion()), but it doesn't act like it. Date.now() (IE9) is available, yet JSON (IE8) is not. let and const (IE11) don't work. These all work with your script, so using the WebBrowser control appears to be a good choice. An alternative would be to use the JavaScript Runtime Host, which: Has less overhead (no WebBrowser control or MSHTML). Doesn't need workarounds like fixIE or X-UA-Compatible. Requires IE11. Top Aurelain Posts: 29 Joined: 02 Sep 2014, 15:37 Data flow Report this post Quote 29 Dec 2014, 07:09 I analyzed lexikos's suggestion of flowing data directly between JS and AHK. Metod A (the current way) 1. JS: an Exo function is called (e.g. FileRead()) 2. JS: FileRead() calls a centralized send() function 3. JS: send() calls a centralized bridge() function, which is in fact a registered AHK function 4. AHK: bridge() calls the FileRead() AHK function 5. AHK: FileRead() calls the FileRead command. It then calls the inject() AHK function. 6. AHK: inject() calls the receive() JS function 7. JS: receive() writes the value into _result 8. JS: send() returns the value of _result 9. JS: FileRead() returns the value of send() Advantages: It satisfies all typing requirementsDisadvantages: It requires a large ammount of boilerplate code It's difficult to understand It impacts performance by ~10% Metod B (proposed by lexikos) 1. JS: an Exo function is called (e.g. FileRead()) which is in fact a registered AHK function 2. AHK: FileRead() calls the FileRead command and returns the Output if it is String or Number. However, there are 15 functions that need to return Object or Array (ImageSearch, Loop, RegExMatch, etc.). In such cases, we have to go through some extra steps: (3.) AHK: Call an utility function in JS (let's say getNativeObject()) (4.) JS: getNativeObject() returns an native Object (5.) AHK: FileRead() returns the native Object. Advantages: It's easy to understandDisadvantages: We must actually register all supported AHK keywords (350). Currently, we're only handling 180 keywords, the rest being dynamically handled by bridge(). That means: We have to create 170 extra functions in AHK We have to register 350 AHK functions (currently only 1 is registered, the bridge()) Using the return value is a bit slower than injecting values (see my previous post about this) Not having the centralized bridge(), we can't easily set the thread defaults. We cannot return undefined (!). This is close to a dealbreaker. The only thing we could do is to accept the situation and know that all functions that should return undefined will in fact return """". It's obvious Method A is pretty strange, but I think I'll stick with . Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: Exo: JavaScript unleashed! Report this post Quote 29 Dec 2014, 08:24 ComObject(0,0) corresponds to undefined, and ComObject(1,0) corresponds to null. Regarding registering lots of functions, if you register the AutoHotkey functions directly with JavaScript, you won't need the 240 boiler-plate functions in Exo.js. I'm not sure why you think 170 extra functions would need to be created; are you talking about the ones that are handled dynamically by bridge()? Built-in functions can just be registered with JS directly, like so: Code: [Select all] [Download] GeSHi © Codebox Plus w := wb.document.parentWindow functions = Chr,Asc Loop Parse, functions, `, 	w.eval(""var x"" A_LoopField), w[""x"" A_LoopField] := Func(A_LoopField) ; (I've added x so as not to conflict with those defined in Exo.js)  The eval/var declaration is due to AutoHotkey's lack of support for IDispatchEx. Calling IDispatchEx via DllCall is one alternative. Utilizing a JavaScript helper function is another. Creating a native JavaScript Object doesn't require creating a helper function in JavaScript; one already exists. However, window.Object.create(ComObject(1,0)) is a bit verbose, and once you get the object, you still can't assign values to it without using IDispatchEx or a helper function. Why do you set the thread defaults every time bridge() is called? Are they even thread-specific anymore? In AutoHotkey v2, since all commands also exist as functions, you would only need to wrap them when you want to change the parameters or return value. Top Aurelain Posts: 29 Joined: 02 Sep 2014, 15:37 Re: Exo: JavaScript unleashed! Report this post Quote 29 Dec 2014, 09:06 The arguments start to pile-up in favor of your suggested Method B. For example: lexikos wrote:Why do you set the thread defaults every time bridge() is called? Are they even thread-specific anymore? I just tested it and with the old ComDispatch, each function was indeed a new thread. Now, with the new direct ""Func()"", everything works properly! Code: [Select all] [Expand] [Download] (ThreadTest.ahk)GeSHi © Codebox Plus Gui Add, ActiveX, vwb, Shell.Explorer wb.Navigate(""about:blank"") wb.document.parentWindow.eval(""var Exo = {change:'', verify:''};"")   old := false if (old) { 	#Include %A_ScriptDir%\lib\ComDispatch.ahk 	#Include %A_ScriptDir%\lib\ComDispTable.ahk 	#Include %A_ScriptDir%\lib\ComVar.ahk 	wb.document.parentWindow.Exo := ComDispatch("""", ""change,verify"") } else { 	wb.document.parentWindow.Exo.change := Func(""change"") 	wb.document.parentWindow.Exo.verify := Func(""verify"") }   wb.document.parentWindow.eval(""Exo.change(1);Exo.verify(1);"") ; The output with old: 1 (the thread default, meaning the previous ""change()"" was lost) ; The output with new: 2 (""change()"" worked!) ExitApp   change(t){ 	SetTitleMatchMode, 2 } verify(t){ 	MsgBox % A_TitleMatchMode }     Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 70 posts 1 2 3 4 Next Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Bing [Bot] and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"Write AHK with JavaScript - Forum thread:, Exo-CLI (Interactive Command-line)."	"true"
"(Use in) other programming languages"	"link"	"https://github.com/joedf/Exo-CLI.ahk"	"Write AHK with JavaScript - Forum thread:, Exo-CLI (Interactive Command-line)."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"4"	"1"	"0"	"GitHub - joedf/Exo-CLI.ahk: Command line interface for AHK-Exo Lang Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 1 Star 4 Fork 0 joedf/Exo-CLI.ahk Code Issues 0 Pull requests 0 Pulse Graphs Command line interface for AHK-Exo Lang 35 commits 1 branch 0 releases Fetching contributors JavaScript 60.7% AutoHotkey 39.3% JavaScript AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Fetching latest commit… Cannot retrieve the latest commit at this time. Permalink Failed to load latest commit information. Resources .gitignore Compile.ahk Exo-CLI.js README.md README.md Exo-CLI Command line interface for AHK-Exo Lang Released under the MIT License Requires [Exo] https://github.com/Aurelain/Exo Screenshot How to Compile Copy Compile.ahk, Resources/ and Exo-CLI.js in to a folder with all the Exo files. Then, Simply run Compile.ahk and it will create Exo-CLI.exe. NB : AutoHotkey needs to be Installed to be able to compile. Once compiled, Exo-CLI.exe will be a standalone application. Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/joedf/Exo-CLI.ahk"	"Write AHK with JavaScript - Forum thread:, Exo-CLI (Interactive Command-line)."	"true"
"(Use in) other programming languages"	"LibLua"	"https://autohotkey.com/board/topic/40690-ahk-lua-interop-stdlib-proof-of-concept/"	"."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"AHK + LUA Interop (stdlib), proof of concept - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. AHK + LUA Interop (stdlib), proof of concept Started by Thrawn , May 12 2009 06:33 PM Page 1 of 2 1 2 Next Please log in to reply 17 replies to this topic Thrawn Members 30 posts Last active: Apr 05 2011 06:07 PM Joined: 12 May 2008 LibLua What is Lua? Lua is a powerful, fast, lightweight, embeddable scripting language. Lua combines simple procedural syntax with powerful data description constructs based on associative arrays and extensible semantics. Lua is dynamically typed, runs by interpreting bytecode for a register-based virtual machine, and has automatic memory management with incremental garbage collection, making it ideal for configuration, scripting, and rapid prototyping. I've just started wrapping LUA for AHK. So far i've implemented the needed functions to: - call ahk-functions from lua - call lua-functions from ahk - read lua-variables with ahk - run a lua-script from within ahk For now this is merely a proof of concept, but if you want to try it - get the required libs from here (lua5.1.dll, lua51.dll) - and examples + lua-ahk stdlib from here (zip) Example 1.1: Calling an ahk-command from lua hDll := lua_loadDll(""lua51.dll"") l := luaL_newstate() luaL_openlibs(l)  AverageAddress := RegisterCallback(""average"",""C"")  lua_register(l, ""average"", AverageAddress)  code = (    -- Start    file = io.open (""example_callAhkFromLua.txt"",""w"")    avg, sum = average(10, 20, 30, 40, 50)    file:write(""The average is "", avg)    file:write(""\nThe sum is "", sum)     file:write(""\n"")     avg, sum = average(1, 2, 3, 4, 5)    file:write(""\nThe average is "", avg)    file:write(""\nThe sum is "", sum)     file:close()    -- End )  luaL_doString(l, code)  lua_close(l) lua_UnloadDll(hDll)  return  average(L) {    ; get number of arguments    n := lua_gettop(L)    sum := 0     ; loop through each argument    loop, %n%    {      ; total the arguments      sum += lua_tonumber(L, A_Index)    }     ; push the average    lua_pushnumber(L, sum / n)     ; push the sum    lua_pushnumber(L, sum)     ; return the number of results    return 2 } Example 1.2: Calling an ahk-command from lua #include lua_ahkfunctions.ahk  hDll := lua_loadDll(""lua51.dll"") l := luaL_newstate()  luaL_openlibs(l) lua_registerAhkFunction(l)  code = (    -- Start    step = 0    while (step <= 100) do       Tooltip(step)       Sleep(20)       step = step + 1    end    Tooltip("""")    Msgbox(""Done!"")     Gui(""Add"", ""Text"",""x5 y5"", ""Please enter your name:"")    Gui(""Add"", ""Edit"",""vNameEdit"")    Gui(""Add"", ""Button"",""gOnExit"",""Exit"")    Gui(""Show"")    -- End )  luaL_dostring(l, code)  return  OnExit:    lua_close(l)    lua_UnloadDll(hDll)    ExitApp Example 2: Calling an lua-function from ahk example_callLuaFromAhk.ahk hDll := lua_loadDll(""lua51.dll"") l := lua_newstate() lua_openlibs(l)  lua_dofile(l, ""example_callLuaFromAhk.lua"")  sum := luaadd(10,15)  msgbox, The sum is %sum%  lua_close(l)  lua_UnloadDll(hDll)   return  luaadd(x,y) {    Global l     ; the function name    lua_getglobal(L, ""add"")     ; the first argument    lua_pushnumber(L, x)     ; the second argument    lua_pushnumber(L, y)     ; call the function with 2 arguments, return 1 result    lua_call(L, 2, 1)     ; get the result    sum := lua_tointeger(L, -1)     lua_pop(L, 1)     return % sum }example_callLuaFromAhk.lua function add ( x, y )     return x + y  end Example 3: Read a variable from lua example_getVarFromLuaToAhk.ahk hDll := lua_loadDll(""lua51.dll"")  l := lua_newstate()  if(lua_loadfile(L,""example_getVarFromLuaToC.lua"") || lua_pcall(L,0,0,0))    msgbox % ""Error failed to load "" lua_tostring(L,-1) else {    lua_getglobal(L,""screenWidth"")    screenWidth := lua_tonumber(L,-1)    out := ""Screen Width := "" screenWidth ""`n""     lua_getglobal(L,""appName"")    appName := lua_tostring(l, -1)    out := out ""Screen Name := "" appName     msgbox % out }  lua_close(L) lua_UnloadDll(hDll)example_getVarFromLuaToAhk.lua appName = ""Firefox""  screenWidth = 400 Example 4: creating a hotkey in lua #include lua_ahkfunctions.ahk  hDll := lua_loadDll(""lua51.dll"") l := luaL_newstate()  luaL_openlibs(l) lua_registerAhkFunction(l)  code = (    -- Start    Hotkey(""#3"",""boxy"")    Hotkey(""#6"",""endme"")     function endme()        Gosub(""OnExit"")    end     function boxy ()        Msgbox(""this lua-function has been called by hotkey"")    end    -- End ) luaL_dostring(l, code)  return   OnExit:    lua_close(l)    lua_UnloadDll(hDll)    ExitApp lua.ahk lua_LoadDLL(dll) {    return, DllCall(""LoadLibrary"", ""str"", dll) }  lua_UnloadDLL(hDll) {    DllCall(""FreeLibrary"", ""UInt"", hDll) }  lua_atPanic(ByRef l, panicf) {    Return, DllCall(""lua51\lua_atPanic"", ""UInt"", L, ""UInt"", panicF, ""Cdecl"") }  lua_call(ByRef l, nargs, nresults) {    Return, DllCall(""lua51\lua_pcall"", ""UInt"", l, ""Int"", nargs, ""Int"", nresults, ""Cdecl"") }  lua_checkstack(ByRef l, extra) {    Return, DllCall(""lua51\lua_checkstack"", ""UInt"", l, ""Int"", extra, ""Cdecl Int"") }  lua_close(ByRef l) {    Return, DllCall(""lua51\lua_close"", ""UInt"", l, ""Cdecl"") }  lua_concat(ByRef l, extra) {    Return, DllCall(""lua51\lua_concat"", ""UInt"", l, ""Int"", extra, ""Cdecl"") }  lua_cpcall(ByRef l, func, ByRef ud) {    Return, DllCall(""lua51\lua_cpcall"", ""UInt"", l, ""UInt"", func, ""UInt"", ud, ""Cdecl Int"") }  lua_createtable(ByRef l, narr, nrec) {    Return, DllCall(""lua51\lua_createtable"", ""UInt"", l, ""Int"", narr, ""Int"", nrec, ""Cdecl"") }  lua_dump(ByRef l, writer, ByRef data) {    Return, DllCall(""lua51\lua_dump"", ""UInt"", l, ""UInt"", writer, ""UInt"", data, ""Cdecl Int"") }  lua_equal(ByRef l, index1, index2) {    Return, DllCall(""lua51\lua_equal"", ""UInt"", l, ""Int"", index1, ""Int"", index2, ""Cdecl Int"") }  lua_error(ByRef l) {    Return, DllCall(""lua51\lua_error"", ""UInt"", l, ""Cdecl Int"") }  lua_gc(ByRef l, what, data) {    Return, DllCall(""lua51\lua_gc"", ""UInt"", l, ""Int"", what, ""Int"", data, ""Cdecl Int"") }  ;lua_getallofc(lua_State *L, void **ud) ; Returns the memory-allocation function of a given state. ; If ud is not NULL, Lua stores in *ud the opaque pointer passed to lua_newstate.  lua_getfenv(ByRef l, index) {    Return, DllCall(""lua51\lua_getfenv"", ""UInt"", l, ""Int"", index, ""Cdecl"") }  lua_getfield(ByRef L, index, name) {    Return, DllCall(""lua51\lua_getfield"", ""UInt"", L, ""Int"", index, ""Str"", name, ""Cdecl"") }  lua_getglobal(ByRef L, name) {    ;Return, DllCall(""lua51\lua_getfield"", ""UInt"", L, ""Int"", -10002, ""Str"", name, ""Cdecl"")    Return, lua_getfield(L, -10002, name) }  lua_getmetatable(ByRef L, index) {    Return, DllCall(""lua51\lua_getmetatable"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_gettable(ByRef L, index) {    Return, DllCall(""lua51\lua_gettable"", ""UInt"", L, ""Int"", index, ""Cdecl"") }  lua_gettop(ByRef l) {    Return, DllCall(""lua51\lua_gettop"", ""UInt"", l, ""Cdecl Int"") }  lua_insert(ByRef l, index) {    Return, DllCall(""lua51\lua_insert"", ""UInt"", l, ""Int"", index, ""Cdecl"") }  lua_isboolean(ByRef l, index) {    Return, DllCall(""lua51\lua_isboolean"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_iscfunction(ByRef l, index) {    Return, DllCall(""lua51\lua_iscfunction"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_isfunction(ByRef l, index) {    Return, DllCall(""lua51\lua_isfunction"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_islightuserdata(ByRef l, index) {    Return, DllCall(""lua51\lua_islightuserdata"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_isnil(ByRef l, index) {    Return, DllCall(""lua51\lua_isnil"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_isnone(ByRef l, index) {    Return, DllCall(""lua51\lua_isnone"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_isnoneornil(ByRef l, index) {    Return, DllCall(""lua51\lua_isnoneornil"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_isnumber(ByRef l, index) {    Return, DllCall(""lua51\lua_isnumber"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_isstring(ByRef l, index) {    Return, DllCall(""lua51\lua_isstring"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_istable(ByRef l, index) {    Return, DllCall(""lua51\lua_istable"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_isthread(ByRef l, index) {    Return, DllCall(""lua51\lua_isthread"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_isuserdata(ByRef l, index) {    Return, DllCall(""lua51\lua_isuserdata"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_lessthan(ByRef l, index) {    Return, DllCall(""lua51\lua_lessthan"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_load(ByRef l, reader, ByRef data, ByRef chunkname) {    Return, DllCall(""lua51\lua_load"", ""UInt"", L, ""UInt"", reader, ""UInt"", data, ""UInt"", chunkname, ""Cdecl Int"") }  lua_newstate(f, ByRef ud) {    Return, DllCall(""lua51\lua_newstate"", ""UInt"", f, ""UInt"", ud, ""Cdecl UInt"") }  lua_newtable(ByRef l) {    ;Return, DllCall(""lua51\lua_newtable"", ""UInt"", l, ""Cdecl"")    Return, lua_createTable(l, 0, 0) }  lua_newthread(ByRef l) {    Return, DllCall(""lua51\lua_newthread"", ""UInt"", l, ""Cdecl UInt"") }  ;void *lua_newuserdata (lua_State *L, size_t size) ; This function allocates a new block of memory with the given size, pushes onto the ; stack a new full userdata with the block address, and returns this address.  lua_next(ByRef l, index) {    Return, DllCall(""lua51\lua_next"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  /* ;-------------------------------------------- ;--- A typical traversal looks like this: --- ;--------------------------------------------    ;table is in the stack at index 't'    ;first key    lua_pushnil(L)    while (lua_next(L, t) != 0)    {     ;uses 'key' (at index -2) and 'value' (at index -1)     msgbox % lua_typename(L, lua_type(L, -2)) "" - "" lua_typename(L, lua_type(L, -1))      ;removes 'value'; keeps 'key' for next iteration     lua_pop(L, 1);    } */   lua_objlen(ByRef l, index) {    Return, DllCall(""lua51\lua_objlen"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_pcall(ByRef l, nargs, nresults, errfunc) {    Return, DllCall(""lua51\lua_pcall"", ""UInt"", l, ""Int"", nargs, ""Int"", nresults, ""UInt"", errfunc, ""Cdecl"") }  lua_pop(ByRef l, no) {    Return, DllCall(""lua51\lua_pop"", ""UInt"", l, ""Int"", no, ""Cdecl"") }  lua_pushboolean(ByRef l, bool) {    Return, DllCall(""lua51\lua_pushboolean"", ""UInt"", l, ""Int"", bool, ""Cdecl"") }  lua_pushcclosure(ByRef L, funcAddr, n) {    Return, DllCall(""lua51\lua_pushcclosure"", ""UInt"", L, ""UInt"", funcAddr, ""Int"", n, ""Cdecl"") }  lua_pushcfunction(ByRef L, funcAddr) {    Return, DllCall(""lua51\lua_pushcclosure"", ""UInt"", L, ""UInt"", funcAddr, ""Int"", 0, ""Cdecl"")    ;Return, lua_pushcclosure(L, funcAdd, 0) }  ;const char *lua_pushfstring (lua_State *L, const char *fmt, ...); ; Pushes onto the stack a formatted string and returns a pointer to this string. ; It is similar to the C function sprintf. also: lua_pushvfstring()  lua_pushinteger(ByRef l, int) {    Return, DllCall(""lua51\lua_pushinteger"", ""UInt"", l, ""Int"", int, ""Cdecl"") }  lua_pushlightuserdata(ByRef l, ByRef p) {    Return, DllCall(""lua51\lua_pushlightuserdata"", ""UInt"", l, ""UInt"", p, ""Cdecl"") }  lua_pushliteral(ByRef l, ByRef str) {    Return, DllCall(""lua51\lua_pushliteral"", ""UInt"", l, ""UInt"", str, ""Cdecl"") }  lua_pushlstring(ByRef l, ByRef str, len) {    Return, DllCall(""lua51\lua_pushlstring"", ""UInt"", l, ""UInt"", str, ""Int"", len, ""Cdecl"") }  lua_pushnil(ByRef l) {    Return, DllCall(""lua51\lua_pushnil"", ""UInt"", l, ""Cdecl"") }  lua_pushnumber(ByRef l, no) {    Return, DllCall(""lua51\lua_pushnumber"", ""UInt"", l, ""Double"", no, ""Cdecl"") }  lua_pushstring(ByRef l, ByRef str) {    Return, DllCall(""lua51\lua_pushstring"", ""UInt"", l, ""Str"", str, ""Cdecl"") }  lua_pushthread(ByRef l) {    Return, DllCall(""lua51\lua_pushthread"", ""UInt"", l, ""Cdecl"") }  lua_pushvalue(ByRef l, index) {    Return, DllCall(""lua51\lua_pushvalue"", ""UInt"", l, ""Int"", index, ""Cdecl"") }  lua_rawequal(ByRef l, index1, index2) {    Return, DllCall(""lua51\lua_rawequal"", ""UInt"", l, ""Int"", index1, ""Int"", index2, ""Cdecl Int"") }  lua_rawget(ByRef l, index) {    Return, DllCall(""lua51\lua_rawget"", ""UInt"", l, ""Int"", index, ""Cdecl"") }  lua_rawgeti(ByRef l, index, n) {    Return, DllCall(""lua51\lua_rawgeti"", ""UInt"", l, ""Int"", index, ""Int"", n, ""Cdecl"") }  lua_rawset(ByRef l, index) {    Return, DllCall(""lua51\lua_rawset"", ""UInt"", l, ""Int"", index, ""Cdecl"") }  lua_rawseti(ByRef l, index, n) {    Return, DllCall(""lua51\lua_rawseti"", ""UInt"", l, ""Int"", index, ""Int"", n, ""Cdecl"") }  lua_register(ByRef l, name, funcAddr) {    ;Return, DllCall(""lua51\lua_register"", ""UInt"", l, ""Str"", name, ""UInt"", funcAddr, ""Cdecl"")    lua_pushcfunction(l, funcAddr)    lua_setglobal(l, name) }  lua_remove(ByRef l, index) {    Return, DllCall(""lua51\lua_remove"", ""UInt"", l, ""Int"", index, ""Cdecl"") }  lua_replace(ByRef l, index) {    Return, DllCall(""lua51\lua_replace"", ""UInt"", l, ""Int"", index, ""Cdecl"") }  lua_resume(ByRef l, narg) {    Return, DllCall(""lua51\lua_resume"", ""UInt"", l, ""Int"", narg, ""Cdecl Int"") }  lua_setallocf(ByRef l, f, ByRef ud) {    Return, DllCall(""lua51\lua_setallocf"", ""UInt"", l, ""UInt"", f, ""UInt"", ud, ""Cdecl"") }  lua_setfenv(ByRef l, index) {    Return, DllCall(""lua51\lua_setfenv"", ""UInt"", l, ""Int"", index, ""Cdecl Int"") }  lua_setfield(ByRef L, index, name) {    Return, DllCall(""lua51\lua_setfield"", ""UInt"", L, ""Int"", index, ""Str"", name, ""Cdecl"") }  lua_setglobal(ByRef L, name) {    ;Return, DllCall(""lua51\lua_setfield"", ""UInt"", L, ""Int"", -10002, ""Str"", name, ""Cdecl"")    Return, lua_setfield(L, -10002, name) }  lua_setmetatable(ByRef L, index) {    Return, DllCall(""lua51\lua_setmetatable"", ""UInt"", L, ""Int"", index, ""Cdecl Int"") }  lua_settable(ByRef L, index) {    Return, DllCall(""lua51\lua_settable"", ""UInt"", L, ""Int"", index, ""Cdecl"") }  lua_settop(ByRef l, index) {    Return, DllCall(""lua51\lua_settop"", ""UInt"", l, ""Int"", index, ""Cdecl"") }  lua_status(ByRef l) {    Return, DllCall(""lua51\lua_status"", ""UInt"", l, ""Cdecl"") }  lua_toboolean(ByRef l, no) {    Return, DllCall(""lua51\lua_toboolean"", ""UInt"", l, ""Int"", no, ""Cdecl Int"") }  lua_tocfunction(ByRef l, no) {    Return, DllCall(""lua51\lua_tocfunction"", ""UInt"", l, ""Int"", no, ""Cdecl UInt"") }  lua_tointeger(ByRef l, no) {    Return, DllCall(""lua51\lua_tointeger"", ""UInt"", l, ""Int"", no, ""Cdecl Int"") }  lua_tolstring(ByRef l, no, size) {    Return, DllCall(""lua51\lua_tolstring"", ""UInt"", l, ""Int"", no, ""Int"", size, ""Cdecl Str"") }  lua_tonumber(ByRef l, no) {    Return, DllCall(""lua51\lua_tonumber"", ""UInt"", l, ""Int"", no, ""Cdecl Double"") }  lua_topointer(ByRef l, no) {    Return, DllCall(""lua51\lua_topointer"", ""UInt"", l, ""Int"", no, ""Cdecl UInt"") }  lua_tostring(ByRef l, no) {    ;Return, DllCall(""lua51\lua_tostring"", ""UInt"", l, ""Int"", no, ""Cdecl Str"")    Return, lua_tolstring(l, no, 0) }  lua_tothread(ByRef l, no) {    Return, DllCall(""lua51\lua_tothread"", ""UInt"", l, ""Int"", no, ""Cdecl UInt"") }  lua_touserdata(ByRef l, no) {    Return, DllCall(""lua51\lua_touserdata"", ""UInt"", l, ""Int"", no, ""Cdecl UInt"") }  lua_type(ByRef l, no) {    Return, DllCall(""lua51\lua_type"", ""UInt"", l, ""Int"", no, ""Cdecl Int"") }  lua_typename(ByRef l, tp) {    Return, DllCall(""lua51\lua_typename"", ""UInt"", l, ""Int"", tp, ""Cdecl Str"") }  lua_xmove(ByRef from, ByRef to, n) {    Return, DllCall(""lua51\lua_xmove"", ""UInt"", from, ""UInt"", to, ""Int"", n, ""Cdecl"") }  lua_yield(ByRef l, nresults) {    Return, DllCall(""lua51\lua_yield"", ""UInt"", l, ""Int"", nresults, ""Cdecl Int"") }    ;--------------------------------------------- ; Load the standard Lua libraries ;--------------------------------------------- luaopen_base(ByRef l) {    Return, DllCall(""lua51\luaopen_base"", ""UInt"", l, ""Cdecl"") }  luaopen_package(ByRef l) {    Return, DllCall(""lua51\luaopen_package"", ""UInt"", l, ""Cdecl"") }  luaopen_string(ByRef l) {    Return, DllCall(""lua51\luaopen_string"", ""UInt"", l, ""Cdecl"") }  luaopen_table(ByRef l) {    Return, DllCall(""lua51\luaopen_table"", ""UInt"", l, ""Cdecl"") }  luaopen_math(ByRef l) {    Return, DllCall(""lua51\luaopen_math"", ""UInt"", l, ""Cdecl"") }  luaopen_io(ByRef l) {    Return, DllCall(""lua51\luaopen_io"", ""UInt"", l, ""Cdecl"") }  luaopen_os(ByRef l) {    Return, DllCall(""lua51\luaopen_os"", ""UInt"", l, ""Cdecl"") }  luaopen_debug(ByRef l) {    Return, DllCall(""lua51\luaopen_debug"", ""UInt"", l, ""Cdecl"") }  ;--------------------------------------------- ;luaL ;--------------------------------------------- luaL_buffinit(ByRef l, ByRef Buffer) {    Return, DllCall(""lua51\luaL_buffinit"", ""UInt"", l, ""UInt"", Buffer, ""Cdecl"") }  luaL_callmeta(ByRef l, obj, ByRef e) {    Return, DllCall(""lua51\luaL_callmeta"", ""UInt"", l, ""Int"", obj, ""Str"", e, ""Cdecl Int"") }  luaL_checkany(ByRef l, narg) {    Return, DllCall(""lua51\luaL_checkany"", ""UInt"", l, ""Int"", narg, ""Cdecl"") }  luaL_checkint(ByRef l, no) {    Return, DllCall(""lua51\luaL_checkint"", ""UInt"", l, ""Int"", no, ""Cdecl Int"") }  luaL_checkinteger(ByRef l, no) {    Return, DllCall(""lua51\luaL_checkinteger"", ""UInt"", l, ""Int"", no, ""Cdecl Int"") }  luaL_checklong(ByRef l, no) {    Return, DllCall(""lua51\luaL_checklong"", ""UInt"", l, ""Int"", no, ""Cdecl Int"") }  luaL_checklstring(ByRef l, no, ByRef len) {    Return, DllCall(""lua51\luaL_checklstring"", ""UInt"", l, ""Int"", no, ""UInt"", len, ""Cdecl Str"") }  luaL_checknumber(ByRef l, no) {    Return, DllCall(""lua51\luaL_checknumber"", ""UInt"", l, ""Int"", no, ""Cdecl Int"") }  luaL_checkoption(ByRef l, no, ByRef def, ByRef lst) {    Return, DllCall(""lua51\luaL_checkoption"", ""UInt"", l, ""Int"", no, ""UInt"", def, ""UInt"", lst, ""Cdecl Int"") }  luaL_checkstack(ByRef l, no, ByRef msg) {    Return, DllCall(""lua51\luaL_checkstack"", ""UInt"", l, ""Int"", no, ""Str"", msg, ""Cdecl"") }  luaL_checkstring(ByRef l, narg) {    Return, DllCall(""lua51\luaL_checkstring"", ""UInt"", l, ""Int"", narg, ""Cdecl"") }  luaL_checktype(ByRef l, no, t) {    Return, DllCall(""lua51\luaL_checktype"", ""UInt"", l, ""Int"", no, ""Int"", t, ""Cdecl"") }  luaL_checkudata(ByRef l, no, ByRef tname) {    Return, DllCall(""lua51\luaL_checkudata"", ""UInt"", l, ""Int"", no, ""Str"", tname, ""Cdecl"") }  luaL_dofile(ByRef l, file) {    ;Return, DllCall(""lua51\luaL_dofile"", ""UInt"", l, ""Str"", file, ""Cdecl Int"")    luaL_loadfile(l, file)    Return % lua_pCall(l, 0, -1, 0) }  luaL_dostring(ByRef l, ByRef str) {    ;Return, DllCall(""lua51\luaL_dostring"", ""UInt"", l, ""Str"", str, ""Cdecl Int"")    luaL_loadstring(l, str)    Return % lua_pCall(l, 0, -1, 0) }  luaL_error(ByRef l, ByRef str) {    Return, DllCall(""lua51\luaL_error"", ""UInt"", l, ""Str"", str, ""Cdecl Int"") }  luaL_getmetafield(ByRef l, no, ByRef e) {    Return, DllCall(""lua51\luaL_getmetafield"", ""UInt"", l, ""Int"", no, ""Str"", e, ""Cdecl Int"") }  luaL_getmetatable(ByRef l, ByRef tname) {    Return, DllCall(""lua51\luaL_getmetatable"", ""UInt"", l, ""Str"", tname, ""Cdecl"") }  luaL_gsub(ByRef l, ByRef s, ByRef p, ByRef r) {    Return, DllCall(""lua51\luaL_gsub"", ""UInt"", l, ""UInt"", s, ""UInt"", p, ""UInt"", r, ""Cdecl Str"") }  luaL_loadbuffer(ByRef l, ByRef buff, sz, ByRef name) {    Return, DllCall(""lua51\luaL_loadbuffer"", ""UInt"", l, ""UInt"", buff, ""Int"", sz, ""Str"", name, ""Cdecl Int"") }  luaL_loadfile(ByRef l, file) {    Return, DllCall(""lua51\luaL_loadfile"", ""UInt"", l, ""Str"", file, ""Cdecl Int"") }  luaL_loadstring(ByRef l, ByRef s) {    Return, DllCall(""lua51\luaL_loadstring"", ""UInt"", l, ""Str"", s, ""Cdecl Int"") }  luaL_newmetatable(ByRef l, ByRef tname) {    Return, DllCall(""lua51\luaL_newmetatable"", ""UInt"", l, ""Str"", tname, ""Cdecl Int"") }  luaL_newstate() {    Return, DllCall(""lua51\luaL_newstate"", ""Cdecl"") }  luaL_openlibs(ByRef l) {    Return, DllCall(""lua51\luaL_openlibs"", ""UInt"", l, ""Cdecl"") }  ;int luaL_optint (lua_State *L, int narg, int d); ;lua_Integer luaL_optinteger (lua_State *L, int narg, lua_Integer d); ;long luaL_optlong (lua_State *L, int narg, long d); ;const char *luaL_optlstring (lua_State *L, int narg, const char *d, size_t *l); ;lua_Number luaL_optnumber (lua_State *L, int narg, lua_Number d); ;const char *luaL_optstring (lua_State *L, int narg, const char *d); ;char *luaL_prepbuffer (luaL_Buffer *B); ;void luaL_pushresult (luaL_Buffer *B); ;int luaL_ref (lua_State *L, int t); ;void luaL_register (lua_State *L, const char *libname, const luaL_Reg *l) ;const char *luaL_typename (lua_State *L, int index); ;int luaL_typerror (lua_State *L, int narg, const char *tname); ;void luaL_unref (lua_State *L, int t, int ref); ;void luaL_where (lua_State *L, int lvl);  lua_ahkfunctions.ahk, to big to post. read here. #1 - Posted 12 May 2009 - 06:33 PM Back to top harry.liang Members 3 posts Last active: May 13 2009 02:14 PM Joined: 10 May 2009 It's great! what if someone can do the same thing with python! I am dreaming of that for a long time! #2 - Posted 13 May 2009 - 03:08 AM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 Impressive! A few functions I found useful during random experimentation (which don't seem to be in the current Lua.ahk): lua_pushstring(ByRef l, s) {     Return, DllCall(""lua51\lua_pushstring"", ""UInt"", l, ""UInt"", &s, ""Cdecl"") }  lua_loadstring(ByRef l, s) {     Return, DllCall(""lua51\luaL_loadstring"", ""UInt"", l, ""UInt"", &s, ""Cdecl"") }  ; Typically more useful to AutoHotkey scripts than lua_type, I suppose. lua_typename(ByRef l, no) {      Return, DllCall(""lua51\lua_typename"", ""UInt"", l, ""Int"", lua_type(l, no), ""Cdecl Str"") } ""Cdecl"" should be used with any functions in lua51.dll which have parameters, otherwise ErrorLevel is set to An. (It should be safe as is due to the design of DllCall, but the non-zero ErrorLevels could be misleading.) Off-topic: Hosting Python probably wouldn't be difficult with a bit of DllCall experience. It's covered in the Python documentation. #3 - Posted 13 May 2009 - 10:39 AM Back to top hughman Members 192 posts Last active: Feb 14 2016 06:59 AM Joined: 11 Feb 2007 Wow~~~ Lua is my favorite scripting language. I like lua's succinct syntax and flexible table. If ahk can realize table natively, it'll be very very very much wonderful. #4 - Posted 13 May 2009 - 12:15 PM Back to top majkinetor Moderators 4512 posts Last active: Oct 02 2013 02:33 PM Joined: 24 May 2006 Thx for the interop. One of the good things about this system is that you can actually experiment with Lua C Binding without compiling it. A few functions I found useful during random experimentation (which don't seem to be in the current Lua.ahk):You can see about the entire API here, or if you prefer it in dotNet, here #5 - Posted 13 May 2009 - 01:01 PM Back to top Lexikos Administrators 9844 posts AutoHotkey Foundation Last active: Joined: 17 Oct 2006 You can see about the entire API here, or if you prefer it in dotNet, hereThanks. I had been using this, turned up by a quick Google. #6 - Posted 13 May 2009 - 01:39 PM Back to top Thrawn Members 30 posts Last active: Apr 05 2011 06:07 PM Joined: 12 May 2008 I'm using this and this as reference. I'm planning on implementing all functions exposed by the api - most importantly luaL_dostring(). Currently I'm binding all ahk commands to lua: -- Start Msgbox(FileGetSize(FileSelectFile())) -- End #7 - Posted 13 May 2009 - 02:39 PM Back to top majkinetor Moderators 4512 posts Last active: Oct 02 2013 02:33 PM Joined: 24 May 2006 I am more interested in doing oposite thing. Implementing as Lua modules automation things that exist in AHK - Window manipulation for start, then hotkeys/strings... #8 - Posted 13 May 2009 - 02:43 PM Back to top Thrawn Members 30 posts Last active: Apr 05 2011 06:07 PM Joined: 12 May 2008 I've updated the first post and the zip file. The library is almost complete; missing C-Functions in lua.ahk: ;int luaL_optint (lua_State *L, int narg, int d); ;lua_Integer luaL_optinteger (lua_State *L, int narg, lua_Integer d); ;long luaL_optlong (lua_State *L, int narg, long d); ;const char *luaL_optlstring (lua_State *L, int narg, const char *d, size_t *l); ;lua_Number luaL_optnumber (lua_State *L, int narg, lua_Number d); ;const char *luaL_optstring (lua_State *L, int narg, const char *d); ;char *luaL_prepbuffer (luaL_Buffer *B); ;void luaL_pushresult (luaL_Buffer *B); ;int luaL_ref (lua_State *L, int t); ;void luaL_register (lua_State *L, const char *libname, const luaL_Reg *l) ;const char *luaL_typename (lua_State *L, int index); ;int luaL_typerror (lua_State *L, int narg, const char *tname); ;void luaL_unref (lua_State *L, int t, int ref); ;void luaL_where (lua_State *L, int lvl); ;const char *lua_pushfstring (lua_State *L, const char *fmt, ...); + lua_pushvfstring() ;void *lua_newuserdata (lua_State *L, size_t size) ;lua_getallofc(lua_State *L, void **ud)And a lot of missing commands in lua_ahkfunctions.ahk (like WinActivate, MouseMove etc) #9 - Posted 13 May 2009 - 06:12 PM Back to top Thrawn Members 30 posts Last active: Apr 05 2011 06:07 PM Joined: 12 May 2008 I've just finished wrapping most of the autohotkey functionality to lua - i'm still missing some 'run that lua-function, when that label gets called'-stuff, but finally it will look like this (working example): #include lua_ahkfunctions.ahk    hDll := lua_loadDll(""lua51.dll"")  l := luaL_newstate()    luaL_openlibs(l)  lua_registerAhkFunction(l)    code =  (     -- Start     Hotkey(""#3"",""boxy"")     Hotkey(""#6"",""endme"")       function endme()         Gosub(""OnExit"")     end       function boxy ()         Msgbox(""this lua-function has been called by hotkey"")     end     -- End  )  luaL_dostring(l, code)    return      OnExit:     lua_close(l)     lua_UnloadDll(hDll)     ExitApp #10 - Posted 14 May 2009 - 04:04 PM Back to top Thrawn Members 30 posts Last active: Apr 05 2011 06:07 PM Joined: 12 May 2008 A very (very very) basic IDE demonstration realized in ahk (uses HiEdit): zip containing everything #11 - Posted 18 May 2009 - 09:42 PM Back to top m2mm4m Guests Last active: Joined: -- Big Thank you… -- Sig _Christopher (M2M) RefCode:444CcdTCcdds p3v4b04 void DeadEnds() {for(;;} // £-) #12 - Posted 15 November 2009 - 05:34 AM Back to top entropic Members 181 posts Last active: Nov 27 2011 03:15 AM Joined: 21 Dec 2008 Thank you very much for your work :-) #13 - Posted 16 November 2009 - 04:11 AM Back to top Guest_AutoHotkey_L Guests Last active: Joined: -- Very nice! I encountered a few stumbling blocks in example_callLuaFromAhk.ahk via the lua.zip file in the original post. The first was an issue with function names. Making the following changes seemed to fix things: lua_newstate -> luaL_newstate lua_openlibs -> luaL_oepnlibs lua_dofile -> luaL_dofile Another issue was that just the 2 lua dlls were not enough to get things working in the local environment. I copied the Microsoft.VC80.CRT directory (which comes with lua -- try looking in lua5_1_4_Win32_bin.zip off of Lua Binaries Download) into the directory where lua.zip was unzipped. I think that's all that was necessary here. FWIW, below is a modified version of example_callLuaFromAhk.ahk that seems to be working here.  #NoEnv #Include lua.ahk ; hDll := lua_loadDll(""lua51.dll"") l := luaL_newstate() luaL_openlibs(l) luaL_dofile(l, ""example_callLuaFromAhk.lua"") sum := luaadd(10, 15) MsgBox, % ""The sum is "" . sum lua_close(l) lua_UnloadDll(hDll) Return  luaadd(x, y) {   global l   ; the function name   lua_getglobal(L, ""add"")   ; the first argument   lua_pushnumber(L, x)   ; the second argument   lua_pushnumber(L, y)   ; call the function with 2 arguments, return 1 result   lua_call(L, 2, 1)   ; get the result   sum := lua_tointeger(L, -1)   lua_pop(L, 1)   Return, sum }  #14 - Posted 16 May 2010 - 05:49 AM Back to top Guest_AutoHotkey_L Guests Last active: Joined: -- ...but finally it will look like this (working example):Prepending:    #include lua.ahk to the top of the code helped to get the working example working here #15 - Posted 16 May 2010 - 06:06 AM Back to top Page 1 of 2 1 2 Next Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"."	"true"
"(Use in) other programming languages"	"here"	"https://code.google.com/archive/p/wow-vending-machine/source"	"."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Google Code Archive - Long-term storage for Google Code Project Hosting. Code Archive Skip to content Search Google About Google Privacy Terms"	"null"	"null"	"."	"true"
"(Use in) other programming languages"	"Machine code functions: Bit Wizardry"	"https://autohotkey.com/board/topic/19483-machine-code-functions-bit-wizardry/"	"Tutorial, C/C++ to MCode Generator forum."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Machine code functions: Bit Wizardry - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. Machine code functions: Bit Wizardry Started by Laszlo , Jul 16 2007 03:31 AM Page 1 of 10 1 2 3 Next » Please log in to reply 144 replies to this topic Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 In AHK v1.0.46.08+, the 1st parameter of a DllCall can be an integer, the address of a function to call. If we copy the binary machine code of a function into an AHK variable, its addresses can be used in DllCalls, executing our machine code function. For convenience we use hex digits for the code, and write a simple function, which allocates also the necessary memory: MCode(ByRef code, hex) { ; allocate memory and write Machine Code there    VarSetCapacity(code,StrLen(hex)//2)    Loop % StrLen(hex)//2       NumPut(""0x"" . SubStr(hex,2*A_Index-1,2), code, A_Index-1, ""Char"") }For example, the following line stores the code of the function swapping the bytes of short (16-bit) value. MCode(BSwap16,""8AE18AC5C3"")We can call it the ususal way: MsgBox % dllcall(&BSwap16, ""short"",0x1234, ""cdecl ushort"")The result is 0x3412 in hex form. These do not involve any external dll's, so swapping bytes is almost as fast as if it was a built-in function. We can extend the list of built-in function arbitrarily. There is a slight difficulty: the function has to be programmed in i386 machine code. However, any programming language can be used, which exports (C or standard call) functions in a dll or static library, or get the function from a public dll file. I used Visual C++ 2005 and gcc vers. 3.4.2, under MinGW. (Sometimes one, sometimes the other produces better code.) Follow this link for information on converting C functions to machine code using Microsoft's free Visual C++ Express compilers. Look at Jamie's mod of the script helping to extract machine code from the assembler listing. Of course, one can use a disassembler, too, to get the machine code in hex format, to be copied into the AHK script. Here is a collection of low level bit manipulation functions, which I used for experimenting with random number generator designs. MCode(MSb32,""5589E58B45085D0FBDC0C3"") MCode(LSb32,""5589E58B45085D0FBCC0C3"") MCode(SHR32,""8B4424048B4C2408D3F8C3"") MCode(SRL64,""8B4C240C83E13F83F92073108B4424048B5424080FADD0D3EAC20C00"") ; 64-bit Shift-Right-Logical (unsigned,standard call) MCode(ROL32,""5589E58B45088B4D0C5DD3C0C3"") ; Rotate Left  32 bits (unsigned) MCode(ROR32,""5589E58B45088B4D0C5DD3C8C3"") ; Rotate Right 32 bits (unsigned) MCode(ROL64,""5589E583EC0C891C248B5D08897424048B750C89D8897C24088B7D1089F289F9D3E00FA5DAF6C120740489C231C0B94"" . ""000000029F90FADF3D3EEF6C120740489F331F609D809F28B1C248B7424048B7C240889EC5DC3"") MCode(ROR64,""5589E583EC0C891C248B5D08897424048B750C89D8897C24088B7D1089F289F9D3EA0FADF0F6C120740489D031D2B94"" . ""000000029F90FA5DED3E3F6C120740489DE31DB09D809F28B1C248B7424048B7C240889EC5DC3"") MCode(BSwap16,""8AE18AC5C3"") MCode(BSwap32,""8BC10FC8C3"") ; Byte Swap (little <--> big endian) MCode(BSwap64,""8B5424088B4424040FCA0FC88BC88BC28BD1C3"") MCode(Parity64,""8B4C2408334C24048BC1D1E833C88BC1C1E80233C88BC1C1E80433C88BC1C1E80833C88BC1C1E81033C183E001C3"") MCode(Parity32,""8B4C24048BC1D1E833C88BC1C1E80233C88BC1C1E80433C88BC1C1E80833C88BC1C1E81033C183E001C3"") MCode(Parity16,""5589E50FB755085D89D0D1E831D089C1C1E90231C189C8C1E80431C889C2C1EA0831D083E001C3"") MCode(Parity8,""8A4424048AC8D0E932C18AC8C0E90232C10FB6C88BC1C1E80433C183E001C3"") MCode(BitRev32,""5589E58B4D085D89C8255555555581E1AAAAAAAA01C0D1E909C889C281E23333333325CCCCCCCCC1E202C1E80209"" . ""C289D0250F0F0F0F81E2F0F0F0F0C1E004C1EA0409D00FC8C3"") MCode(BitCnt32,""8B4C24048BC1D1E825555555552BC88BC1C1E802BA3333333323C223CA03C18BC8C1E90403C881E10F0F0F0F8BC1"" . ""C1E80803C88BC1C1E81003C125FF000000C3"") MCode(BitZip32,""8B44240433C98A6C24068BD025FF0000FF81E200FF000056C1E2080BCA0BC88BC18BF1C1E804BAF000F00023F223"" . ""C2C1E6040BC681E10FF00FF00BC18BC88BF0BA0C0C0C0C23F2C1E902C1E60223CA0BCE25C3C3C3C30BC88BC1BA222222228BF1D1E823F223C203F60BC681E1999999990BC15EC3"") MCode(BitUnZip32,""8B4C2404568BC18BF1D1E881E199999999BA2222222223C223F203F60BC60BC18BC88BF0C1E902BA0C0C0C0C23"" . ""F223CA25C3C3C3C3C1E6020BCE0BC88BC18BF1C1E804BAF000F00023C223F2C1E6040BC681E10FF00FF00BC18944240833C98A6C240A8BD081E200FF0000C1E20825FF0000FF5E0BCA0BC1C3"") MCode(I2Gray32,""8B442404D1E833442404C3"") MCode(Gray2I32,""8B4C24048BC1D1E833C88BC1C1E80233C88BC1C1E80433C88BC1C1E80833C88BC1C1E81033C1C3"") MCode(NextGray32,""5589E58B4D085389C88D1C09D1E831C889C2C1EA0231C289D0C1E80431D089C2C1EA0831C289D0C1E81031D031"" . ""D2A8010F94C209DA5B89D0F7D821D031C85DC3"")The functions: MSb32: finds the index of the most significant bit in a 32-bit unsigned integer LSb32: finds the index of the least significant bit in a 32-bit unsigned integer SHR32: arithmetic shift-right of a 32-bit signed integer (keeping negative results) SRL64: 64-bit Shift-Right-Logical (unsigned), which shifts in 0's from the left ROL32: Rotate Left 32 bits (unsigned) ROR32: Rotate Right 32 bits (unsigned) ROL64: Rotate Left 64 bits (unsigned) ROR64: Rotate Right 64 bits (unsigned) BSwap16: Swaps the two bytes of a 16-bit number BSwap32: Reverse the byte order of 32-bit numbers (little <--> big endian) BSwap64: Reverse the byte order of 64-bit numbers Parity8/16/32/64: Computes the parity (0 if there is an even number of 1-bits, 1 is otherwise) BitRev32: Reverses the sequence of bits in a 32-bit number BitCnt32: Counts the number of 1-bits in a 32-bit number BitZip32/BitUnZip32: UnZip: Moves the odd indexed bits to the MS bytes, the even indexed bits to the LS bytes / Zip: reverses this I2Gray32/ Gray2I32: converts a 32-bit integer to the corresponding Gray code or back NextGray32: gives the next Gray code (Gray counter) Another important application of the machine code functions is array searching and sorting. The C runtime library (msvcrt.dll) exports the necessary procedures: _lsearch, _lfind, bsearch and qsort. They require a callback function for the comparison. If we use an AHK function, it will be several hundred times slower than with machine code. For the most common case here are the comparison callbacks: MCode(LI8,""8B4424048A008B4C24088A0933D23AC1530F9FC233DB3AC10F9CC32BD38BC25BC3"") MCode(GI8,""8B4424048A008B4C24088A0933D23AC1530F9CC233DB3AC10F9FC32BD38BC25BC3"") MCode(LU8,""8B4424040FB6088B4424088A103AD11BC0F7D83ACA1BC9F7D92BC1C3"") MCode(GU8,""8B4424040FB6088B4424088A103ACA1BC0F7D83AD11BC9F7D92BC1C3"")  MCode(LI16,""5589E58B55088B450C5D0FB70A0FB71031C06639D10F9FC06639D10F9CC10FB6D129D0C3"") MCode(GI16,""5589E58B55088B450C5D0FB70A0FB71031C06639D10F9CC06639D10F9FC10FB6D129D0C3"") MCode(LU16,""8B4424040FB7088B4424080FB710663BD11BC0F7D8663BCA1BC9F7D92BC1C3"") MCode(GU16,""8B4424040FB7088B4424080FB710663BCA1BC0F7D8663BD11BC9F7D92BC1C3"")  MCode(LI32,""5589E58B55088B450C5D8B0A8B1031C039D10F9FC039D10F9CC10FB6D129D0C3"") MCode(GI32,""5589E58B55088B450C5D8B0A8B1031C039D10F9CC039D10F9FC10FB6D129D0C3"") MCode(LU32,""8B4424048B088B4424088B103BD11BC0F7D83BCA1BC9F7D92BC1C3"") MCode(GU32,""8B4424048B088B4424088B103BCA1BC0F7D83BD11BC9F7D92BC1C3"")  MCode(LI64,""8B4424048B4C24088B108B4004568B318B49043BC1577C0B7F043BD6760533FF47EB0233FF3BC17F0B7C043BD6730533"" . ""C941EB0233C98BC75F2BC15EC3"") MCode(GI64,""8B4424048B4C24088B108B4004568B318B49043BC1577F0B7C043BD6730533FF47EB0233FF3BC17C0B7F043BD6760533"" . ""C941EB0233C98BC75F2BC15EC3"") MCode(LU64,""8B4424048B4C24088B108B4004568B318B49043BC157720B77043BD6760533FF47EB0233FF3BC1770B72043BD6730533"" . ""C941EB0233C98BC75F2BC15EC3"") MCode(GU64,""8B4424048B4C24088B108B4004568B318B49043BC157770B72043BD6730533FF47EB0233FF3BC1720B77043BD6760533"" . ""C941EB0233C98BC75F2BC15EC3"")Here the first letter tells that Less-than or Greater-than type of comparison is used. The second letter tells if (signed) Integer or Unsigned comparisons are used, and the trailing number tells the precision, the width of the elements in the array. Here is an example: dllcall(""msvcrt\qsort"", ""UInt"",&Array, ""UInt"",10, ""UInt"",1, ""UInt"",&GI8)We sort an array of 10 signed bytes, such that greater values come first (GI8). Below is a list of test cases, with the expected result in the comment: a0 := 0, NumPut( 0,a0,0,""Char"") a5 := 0, NumPut( 5,a5,0,""Char"") af := 0, NumPut(-1,af,0,""Char"") MsgBox % dllcall(&LU8, ""uint"",&a0, ""uint"",&a5, ""cdecl int"") ; -1 MsgBox % dllcall(&LU8, ""uint"",&a5, ""uint"",&af, ""cdecl int"") ; -1 MsgBox % dllcall(&LU8, ""uint"",&a5, ""uint"",&a5, ""cdecl int"") ;  0  MsgBox % dllcall(&LI8, ""uint"",&a0, ""uint"",&a5, ""cdecl int"") ; -1 MsgBox % dllcall(&LI8, ""uint"",&a5, ""uint"",&af, ""cdecl int"") ;  1 MsgBox % dllcall(&LI8, ""uint"",&a5, ""uint"",&a5, ""cdecl int"") ;  0  MsgBox % dllcall(&GI8, ""uint"",&a0, ""uint"",&a5, ""cdecl int"") ;  1 MsgBox % dllcall(&GI8, ""uint"",&a5, ""uint"",&af, ""cdecl int"") ; -1 MsgBox % dllcall(&GI8, ""uint"",&a5, ""uint"",&a5, ""cdecl int"") ;  0  VarSetCapacity(a0,8,0), NumPut( 0,a0,0,""Int64"") VarSetCapacity(a5,8,0), NumPut(55,a5,0,""Int64"") VarSetCapacity(af,8,0), NumPut(-1,af,0,""Int64"") MsgBox % dllcall(&GI64, ""uint"",&a0, ""uint"",&a5, ""cdecl int"") ;  1 MsgBox % dllcall(&GI64, ""uint"",&a5, ""uint"",&a0, ""cdecl int"") ; -1 MsgBox % dllcall(&GI64, ""uint"",&a0, ""uint"",&a0, ""cdecl int"") ;  0 MsgBox % dllcall(&GU64, ""uint"",&a5, ""uint"",&af, ""cdecl int"") ;  1  VarSetCapacity(Array,10,0) Loop 8    NumPut(88-9*A_Index,Array,A_Index,""Char"") NumPut(-1,Array,5,""Char"")  dllcall(""msvcrt\qsort"", ""UInt"",&Array, ""UInt"",10, ""UInt"",1, ""UInt"",&GI8) ; decending-signed order  s := NumGet(Array,0,""Char"") Loop 9    s .= "", "" . NumGet(Array,A_Index,""Char"") MsgBox %s%     ; 79, 70, 61, 52, 34, 25, 16, 0, 0, -1  VarSetCapacity(Array,80,0) Loop 9    NumPut(100000000000-10000000000*A_Index,Array,8*A_Index,""Int64"") NumPut(-1,Array,5*8,""Int64"")  dllcall(""msvcrt\qsort"", ""UInt"",&Array, ""UInt"",10, ""UInt"",8, ""UInt"",&LU64) ; ascending-unsigned order  s := NumGet(Array,0,""Int64"") Loop 9    s .= "","" . NumGet(Array,8*A_Index,""Int64"") MsgBox %s% ;0,10000000000,20000000000,30000000000,40000000000,60000000000,70000000000,80000000000,90000000000,-1  SetFormat Integer, HEX  MsgBox % x:=dllcall(&NextGray32, ""uint"", 8, ""cdecl uint"") ; 0x18 MsgBox % x:=dllcall(&NextGray32, ""uint"", x, ""cdecl uint"") ; 0x19 MsgBox % x:=dllcall(&NextGray32, ""uint"", x, ""cdecl uint"") ; 0x1B MsgBox % x:=dllcall(&NextGray32, ""uint"", x, ""cdecl uint"") ; 0x1A  MsgBox % dllcall(&Gray2I32, ""uint"", 0x08, ""cdecl uint"") ; 0x0f MsgBox % dllcall(&Gray2I32, ""uint"", 0x18, ""cdecl uint"") ; 0x10 MsgBox % dllcall(&Gray2I32, ""uint"", 0x19, ""cdecl uint"") ; 0x11 MsgBox % dllcall(&Gray2I32, ""uint"", 0x1B, ""cdecl uint"") ; 0x12  MsgBox % dllcall(&I2Gray32, ""uint"", 0x0f, ""cdecl uint"") ; 0x08 MsgBox % dllcall(&I2Gray32, ""uint"", 0x10, ""cdecl uint"") ; 0x18 MsgBox % dllcall(&I2Gray32, ""uint"", 0x11, ""cdecl uint"") ; 0x19 MsgBox % dllcall(&I2Gray32, ""uint"", 0x12, ""cdecl uint"") ; 0x1B  MsgBox % dllcall(&BitZip32, ""uint"", 0x0000ffff, ""cdecl uint"") ; 0x55555555 Merge MS and LS half words (bit0 stays) MsgBox % dllcall(&BitUnZip32,""uint"",0xaaaaaaaa, ""cdecl uint"") ; 0xffff0000 Odd index bits . Even index bits  MsgBox % dllcall(&BitCnt32, ""uint"", 0, ""cdecl uint"")          ; 0 MsgBox % dllcall(&BitCnt32, ""uint"", 0x01010101, ""cdecl uint"") ; 4 MsgBox % dllcall(&BitCnt32, ""uint"", 0xffffffff, ""cdecl uint"") ; 32  MsgBox % dllcall(&BitRev32, ""uint"", 0x12345678, ""cdecl uint"") ; 0x1E6A2C48  MsgBox % dllcall(&Parity64, ""int64"", 0x0800000010001234, ""cdecl uint"") ; 1 MsgBox % dllcall(&Parity64, ""int64"", 0x0200000010001235, ""cdecl uint"") ; 0  MsgBox % dllcall(&Parity32, ""uint"", 0x10001234, ""cdecl uint"") ; 0 MsgBox % dllcall(&Parity32, ""uint"", 0x10001235, ""cdecl uint"") ; 1  MsgBox % dllcall(&Parity16, ""ushort"", 0x1234, ""cdecl uint"") ; 1 MsgBox % dllcall(&Parity16, ""ushort"", 0x1235, ""cdecl uint"") ; 0  MsgBox % dllcall(&Parity8, ""uchar"", 0, ""cdecl uint"")    ; 0 MsgBox % dllcall(&Parity8, ""uchar"", 1, ""cdecl uint"")    ; 1 MsgBox % dllcall(&Parity8, ""uchar"", 7, ""cdecl uint"")    ; 1 MsgBox % dllcall(&Parity8, ""uchar"", 0x12, ""cdecl uint"") ; 0  MsgBox % dllcall(&ROL32, ""uint"", 0x12345678, ""UInt"",4, ""cdecl uint"") ; 0x23456781 MsgBox % dllcall(&ROR32, ""uint"", 0x12345678, ""UInt"",4, ""cdecl uint"") ; 0x81234567  MsgBox % dllcall(&ROL64, ""int64"", 0x2000000000000020, ""UInt"",1, ""cdecl int64"") ; 0x400..0040 MsgBox % dllcall(&ROL64, ""int64"",-4, ""UInt"",2, ""cdecl int64"")                  ; -13 = -0xD (-4*4 + 3(MS)) MsgBox % dllcall(&ROL64, ""int64"", 0x34567890abcdef12, ""UInt"",4, ""cdecl int64"") ; 0x4567890abcdef123  MsgBox % dllcall(&ROR64, ""int64"", 0x4000000000000020, ""UInt"",1, ""cdecl int64"") ; 0x200..0010 MsgBox % dllcall(&ROR64, ""int64"",-4, ""UInt"",2, ""cdecl int64"")                  ; 0x3fffffffffffffff MsgBox % dllcall(&ROR64, ""int64"", 0x34567890abcdef12, ""UInt"",4, ""cdecl int64"") ; 0x234567890abcdef1  MsgBox % dllcall(&LSb32, ""Int"",0x81234567, ""cdecl UInt"") ; 0 MsgBox % dllcall(&LSb32, ""Int"",0x01234560, ""cdecl UInt"") ; 5 MsgBox % dllcall(&LSb32, ""Int"",16, ""cdecl UInt"")         ; 4 MsgBox % dllcall(&LSb32, ""Int"",0, ""cdecl UInt"")          ; 0  MsgBox % dllcall(&MSb32, ""Int"",0x81234567, ""cdecl UInt"") ; 31 (0x1f) MsgBox % dllcall(&MSb32, ""Int"",0x01234567, ""cdecl UInt"") ; 24 (0x18) MsgBox % dllcall(&MSb32, ""Int"",1, ""cdecl UInt"")          ; 0 MsgBox % dllcall(&MSb32, ""Int"",0, ""cdecl UInt"")          ; 0  MsgBox % dllcall(&SHR32, ""Int"",0x81234567, ""UInt"",1, ""cdecl UInt"")    ; 0xC091a2b3  MsgBox % dllcall(&BSwap16, ""short"",0x1234, ""cdecl ushort"")            ; 0x3412 MsgBox % dllcall(&BSwap32, ""int"",  0x12345678, ""cdecl uint"")          ; 0x78563412 MsgBox % dllcall(&BSwap64, ""int64"",0x34567890abcdef12, ""cdecl int64"") ; 0x12efcdab90785634  MsgBox % dllcall(&SRL64, ""int64"", 0x34567890abcdef12, ""UInt"",4, ""int64"") ; 0x034567890abcdef1 (standard call) MsgBox % dllcall(&SRL64, ""int64"",-0x8000000000000000, ""UInt"",2, ""int64"") ; 0x2000000000000000 There is an excellent collection of useful C functions collected by Jörg Arndt: The FXT library: Fast transforms and low level algorithms. Some of the functions above were adapted from the FXT book. Below you find Bin2Hex, another small machine code function. It converts binary data to hex strings. See here the CPUID function, which is a 27 byte AHK machine code wrapper for the CPUID command of Intel compatible processors. It tells everything about the CPU, its capabilities, version number, unique ID, etc. See here the returned values for different first parameter (the info selector). Please post here your favorite machine code functions, so we can put together a large collection of useful ones! Edit 20070903: added references to Bin2Hex and CPUID Edit 20100621: removed reference to a now obsolete disassembler #1 - Posted 16 July 2007 - 03:31 AM Back to top SKAN Administrators 9115 posts Last active: Joined: 26 Dec 2005 Amazing! #2 - Posted 16 July 2007 - 04:50 AM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 Thanks! If someone has a need for very fast, short functions, post the request here, with proper description. There could be a volunteer, who might code it. #3 - Posted 16 July 2007 - 05:27 AM Back to top Washboard Guests Last active: Joined: -- Seems to be very usefull, but very far of my knowledge... I think that binary tree and data sorting functions would be interesting to implement. Thanks for the hard work. #4 - Posted 16 July 2007 - 08:30 AM Back to top Sean Members 2462 posts Last active: Feb 07 2012 04:00 AM Joined: 12 Feb 2007 What more to say? BTW, I'm proud of being the one who requested the function pointer support in DllCall. #5 - Posted 16 July 2007 - 08:48 AM Back to top SKAN Administrators 9115 posts Last active: Joined: 26 Dec 2005 If someone has a need for very fast, short functions, post the request here, with proper description. Sir, I would like to know whether BinToHex.DLL ( 3KB - Assembly ) can be absorbed into a script to avoid dependency. Function call - working example: FileGetSize, dataSz , %A_AhkPath% FileRead   , binData, %A_AhkPath% VarSetCapacity( hexData, dataSz*3[color=red]+1[/color] )  DllCall( ""[color=red]BINTOHEX.DLL\BinToHex[/color]"", Str,binData, Str,hexData, UInt,dataSz ) StringReplace, hexData, hexData, % A_Space,, All ; Remove all spaces MsgBox, % hexData Disassembled with DisAsm : BinToHex.TXT ( 6.4KB ) Snapshot: :roll: #6 - Posted 16 July 2007 - 08:54 AM Back to top SKAN Administrators 9115 posts Last active: Joined: 26 Dec 2005 I'm proud of being the one who requested the function pointer support in DllCall. .. and I am grateful to you for that #7 - Posted 16 July 2007 - 08:54 AM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 I compiled the following C code (with the obvious typedefs) void Bin2Hex0(UInt8 *hex, UInt8 *bin, UInt32 len) { // in hex room for 2*len+1 bytes      UInt8 c, d, *end = bin+len;      while (bin < end) {          c = *(bin++);          d = c >> 4;          *(hex++) = d + (d>9 ? 55 : 48);          d = c & 15;          *(hex++) = d + (d>9 ? 55 : 48);      }      *hex = 0;  }The resulting machine code function with the calling example: MCode(Bin2Hex,""8B44240C568B742408578B7C24108D14073BFA7332538A07478AC8C0E904B3093AD91ADB80E30780C3"" . ""3002D9240F881E46B1093AC81AC980E10780C13002C8880E463BFA72D05B5FC606005EC3"")  bin := ""123"", VarSetCapacity(hex,9) dllcall(&Bin2Hex, ""uint"",&hex, ""uint"",&bin, ""uint"",4, ""cdecl"") VarSetCapacity(hex,-1) ; update StrLen MsgBox %hex%           ; 31323300 Edit: fixed constants #8 - Posted 16 July 2007 - 04:30 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 Here is a standalone (wrapper) version, which does not even need the MCode function: Bin2Hex(addr,len) {    Static fun    If (fun = """") {       h=8B4C2404578B7C241085FF7E30568B7424108A168AC2C0E804463C0976040437EB02043080E20F88018AC2413C0976040437EB0204308801414F75D65EC601005FC3       VarSetCapacity(fun,StrLen(h)//2)       Loop % StrLen(h)//2          NumPut(""0x"" . SubStr(h,2*A_Index-1,2), fun, A_Index-1, ""Char"")    }    VarSetCapacity(hex,2*len+1)    dllcall(&fun, ""uint"",&hex, ""uint"",addr, ""uint"",len, ""cdecl"")    VarSetCapacity(hex,-1) ; update StrLen    Return hex }  bin = 123 MsgBox %  Bin2Hex(&bin,4)At the very first call to the Bin2Hex function, it creates the binary machine code in the static variable fun. Later calls just use this already stored code, so all the dirty details remain hidden from the user. #9 - Posted 16 July 2007 - 04:52 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 I had to deviate from Skan's dll code above, because it contains a non-portable data reference: BB00300010              mov ebx, 10003000It is hard to guess, what an optimizing compiler (VS'05) does with different code versions. I tried a few variants, and the following (longer) C function resulted in 11 bytes shorter machine code: void Bin2Hex(UInt8 *hex, UInt8 *bin, Int32 len) { // in hex room for 2*len+1 bytes    Int32 i; UInt8 c, d;    for (i=0; i<len; ++i) {        c = *(bin++);        d = c >> 4;        if (d > 9) *(hex++) = d + 55;        else       *(hex++) = d + 48;        d = c & 15;        if (d > 9) *(hex++) = d + 55;        else       *(hex++) = d + 48;    }    *hex = 0; }The machine code is: 8B4C2404578B7C241085FF7E30568B7424108A168AC2C0E804463C0976040437EB02043080E20F88018AC2413C0976040437EB0204308801414F75D65EC601005FC3 #10 - Posted 16 July 2007 - 08:34 PM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 If you are after speed, not code size, the following C code could be faster: void Bin2Hex(UInt8 *hex, UInt8 *bin, Int32 len) { // in hex room for 2*len+1 bytes     Int32 i; UInt8 c, d;     for (i=0; i<len; ++i) {          c = *(bin++);          d = c >> 4;          *(hex++) = d+48 + (7 & -(d>9));          d = c & 15;          *(hex++) = d+48 + (7 & -(d>9));      }      *hex = 0;  }It trades conditional statements to arithmetic and logic instructions, which can prevent a pipeline flush in the processor. Indexing an array may also prevent parallel execution of some instructions. The corresponding machine code (generated by VS'05) is: 8B54240C85D2568B7424087E3A53578B7C24148A07478AC8C0E90480F9090F97C3F6DB80E30702D980C330240F881E463C090F97C1F6D980E10702C880C130880E464A75CE5F5BC606005EC3 #11 - Posted 16 July 2007 - 11:10 PM Back to top SKAN Administrators 9115 posts Last active: Joined: 26 Dec 2005 Thanks Sir!. The standalone version works great, but I have trouble in adapting to the MCode() : FileGetSize, dataSz , %A_AhkPath% FileRead   , bin    , %A_AhkPath% VarSetCapacity( hex, dataSz*2+1 )  Bin2Hex_v1:=""8B4C2404578B7C241085FF7E30568B7424108A168AC2C0E804463C0976040437EB02043080E20F88018AC2413C0976040437EB0204308801414F75D65EC601005FC3"" Bin2Hex_v2:=""8B54240C85D2568B7424087E3A53578B7C24148A07478AC8C0E90480F9090F97C3F6DB80E30702D980C330240F881E463C090F97C1F6D980E10702C880C130880E464A75CE5F5BC606005EC3""  MCode( Bin2Hex, Bin2Hex_v1  ) DllCall( &Bin2Hex, ""uint"",&hex, ""uint"",&bin, ""uint"",dataSz, ""cdecl"" )  MsgBox, %hex%  Return  MCode(ByRef code, hex) { ; allocate memory and write Machine Code there    VarSetCapacity(code,StrLen(hex)//2)    Loop % StrLen(hex)//2       NumPut(""0x"" . SubStr(hex,2*A_Index-1,2), code, A_Index-1, ""Char"") } I am missing something obvious . Please point it out. PS: Any particular reason that the function accepts parameters different from the DLL ? #12 - Posted 17 July 2007 - 04:35 AM Back to top SKAN Administrators 9115 posts Last active: Joined: 26 Dec 2005 This is where I got the BinToHex.DLL : <!-- m -->http://www.softcircu...om/sw_tools.htm<!-- m --> Edit: 20080305 That link is broken Working one : <!-- m -->http://www.softcircu...m/sw_tools.aspx<!-- m --> #13 - Posted 17 July 2007 - 05:02 AM Back to top Laszlo Moderators 4713 posts Last active: Mar 31 2012 03:17 AM Joined: 14 Feb 2005 It works for me. What is the problem you get? #14 - Posted 17 July 2007 - 05:09 AM Back to top SKAN Administrators 9115 posts Last active: Joined: 26 Dec 2005 What is the problem you get? %Hex% appears to be null. errorlevel is 0 after the DllCall() OS: Win XP SP2 AHK : 1.0.47.00 :roll: #15 - Posted 17 July 2007 - 05:15 AM Back to top Page 1 of 10 1 2 3 Next » Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"Tutorial, C/C++ to MCode Generator forum."	"true"
"MCode (machine code)"	"MCode Tutorial"	"https://autohotkey.com/boards/viewtopic.php?f=7&t=32"	"MCode (machine code) tutorial."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"MCode Tutorial (Compiled Code in AHK) - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Tutorials Search It is currently 15 Jul 2016, 16:32 All times are UTC-05:00 MCode Tutorial (Compiled Code in AHK) Helpful script writing tricks and HowTo's Post Reply Email topic Print view Search Advanced search 62 posts 1 2 3 4 Next nnnik Posts: 1409 Joined: 30 Sep 2013, 01:01 Location: Germany MCode Tutorial (Compiled Code in AHK) Report this post Quote 30 Sep 2013, 12:00 This is a Tutorial I had been looking for. It takes hours and hours to figure out all of this by yourself. That's why I'll make a Tutorial here. That all of you can easily understand what MCode is and what it is used for. First of all I'm going to talk about what MCode is and why it is being used. After that we'll have a look at some practical examples. While doing this I'll tell you about the Problems. 1. Introduction:What is MCode ? MCode is compiled code. For example if you make a C++ program it'll result in this kind of code. AHK Scripts form the opposite of compiled code. In an AHK script the interpreter looks at the script text and then executes the corresponding code. In an compiled language (e.g. C++) the compiler creates such Code directly. The CPU is directly able to read such code. MCode is such compiled code that can be used inside an AHK script. We are able to execute this code via DllCall. For Example the example MCode of the compiler I use is: 2,x86:aipYww==,x64:uCoAAADD This is a Function that simply return 42 (The answer to all questions and everything.). 1. Introduction:What is MCode good for? MCode is one of the various ways to increase the speed of your Script/Program. Especially if you're calculating with a huge amount of Data. For example you can make functions that can change a GDI+ picture. MCode also gives you the possibility to execute code on a very low level (Assembly). 1. Introduction:Sounds nice. What is needed? 1. Knowledge about C++ and DllCalls: If you don't think you're good enough in DllCalls forget it. You can find an super nice C++ here: http://www.cplusplus.com/doc/tutorial/ 2. A compiler: The compiler I use can be found at: http://ahkscript.org/boards/viewtopic.php?f=6&t=4642 You need to install GCC http://www.autohotkey.com/board/topic/5 ... nto-mcode/ You need to install Visual C++ I'll add any other suggestions here. 3. an MCode Function: I use this one: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus MCode(mcode) {   static e := {1:4, 2:1}, c := (A_PtrSize=8) ? ""x64"" : ""x86""   if (!regexmatch(mcode, ""^([0-9]+),("" c "":|.*?,"" c "":)([^,]+)"", m))     return   if (!DllCall(""crypt32\CryptStringToBinary"", ""str"", m3, ""uint"", 0, ""uint"", e[m1], ""ptr"", 0, ""uint*"", s, ""ptr"", 0, ""ptr"", 0))     return   p := DllCall(""GlobalAlloc"", ""uint"", 0, ""ptr"", s, ""ptr"")   if (c=""x64"")     DllCall(""VirtualProtect"", ""ptr"", p, ""ptr"", s, ""uint"", 0x40, ""uint*"", op)   if (DllCall(""crypt32\CryptStringToBinary"", ""str"", m3, ""uint"", 0, ""uint"", e[m1], ""ptr"", p, ""uint*"", s, ""ptr"", 0, ""ptr"", 0))     return p   DllCall(""GlobalFree"", ""ptr"", p) } 2. Beispiele After you've added the function to your stdli directory you are ready to program your own functions. The example code, of the compiler I mentioned above is this one: Code: [Select all] [Download] (42.mcode)GeSHi © Codebox Plus int MyFunction() {   return 42; } As stated above it always returns 42. When you press the Create Machine Code button, the online compiler will create this code. Code: [Select all] [Download] (42.ahk)GeSHi © Codebox Plus MyFunction := MCode(""2,x86:uCoAAADD,x64:uCoAAADD"") After you've added it to your script you can call it via DllCall. Your Script should look like this. Code: [Select all] [Download] (42Call.ahk)GeSHi © Codebox Plus MyFunction := MCode(""2,x86:uCoAAADD,x64:uCoAAADD"") Msgbox % DllCall(MyFunction,""cdecl"") Note: You have to specify cdecl in the DllCall function in order to execute it because it is the standard calling convention in C/C++. But now a more complex function. It searches for the end of an string: The 0-Char: Code: [Select all] [Download] (strlen.mcode)GeSHi © Codebox Plus int stringlen(char *str) {   int i=0;   for (; str[i]!=0; i++);   return i; } The result is the following code: Code: [Select all] [Download] (strlen.ahk)GeSHi © Codebox Plus stringlen := MCode(""2,x86:i0wkBDPAOAF0B0CAPAgAdfnD,x64:M8A4AXQKSP/B/8CAOQB19vPD"") MsgBox, % DllCall(stringlen, ""astr"", ""test"",""cdecl"") Now an even more complex function. Code: [Select all] [Download] (Fakultät.mcode)GeSHi © Codebox Plus unsigned int MyFunction(unsigned int a,unsigned int b) { if (a>0)  return MyFunction(a-1,b*a); else return b; } This function calculates the factulty of the nr. a. In order to do so it calls itself. Now the AHK code. Code: [Select all] [Download] (Fakultät.ahk)GeSHi © Codebox Plus MyFunction := MCode(""2,x86:i0wkBItEJAiFyXQKjWQkAA+vwUl1+sM=,x64:hcl0Bw+v0f/JdfmLwsM="") Msgbox % DllCall(MyFunction,""int"",3,""int"",1,""cdecl"") The result is 6 as expected. But you have to write too much.(Yes I'm lazy) Actually you dont need this part: ,""int"",1,""cdecl"") We could create a caller function that does the thing we want. In order to use the stdcall convention(Wich is the standard for the DllCall function) you have to put a _stdcall before the function. Your C++ code will look like this: Code: [Select all] [Expand] [Download] (Fakultätcallfunc.mcode)GeSHi © Codebox Plus unsigned int MyFunction(unsigned int a,unsigned int b) { if (a>0)  return MyFunction(a-1,b*a); else return b; }   unsigned int _stdcall MyFunctionCaller(unsigned int a) { return MyFunction(a,1); }   The result: Code: [Select all] [Download] (Fakultätcallfunc.ahk)GeSHi © Codebox Plus MyFunction := MCode(""2,x86:i0wkBItEJAiFyXQKjWQkAA+vwUl1+sM=,x64:hcl0Bw+v0f/JdfmLwsM="") MyFunctionCaller := MCode("" (LTrim Join 2,x86:i0QkBIXAdA5QSFDoAAAAAIPECMIEALgBAAAAwgQA,x64:i9GFyXQH/8npAAAAALgBAAAAww== )"") Msgbox % DllCall(MyFunctionCaller,""uint"",3) But the Messagebox is empty. No we didn't make a mistake. The Problems name is MCode: OK Lets imagine you have a AHK script, but you have to call every function by its position: (e.g. call Char nr. 144.). This is where your function starts at Char 144. Now lets imagine we put some new code in front of your function. Your function will be moved backwards e.g. 20 Chars. If you don't change the starting nr. of your function you wont be able to call it properly. In Machine Code it is exactly like this: A function is called by calling the start address of the function. But the function is added after the AHK stuff. That's why your function is calling something else. This leads to errors. The compiler is able to tell you the starting address it expected: (Note: Not for 64 bit PCs) Code: [Select all] [Expand] [Download] (AddressTest.ahk)GeSHi © Codebox Plus /* unsigned int MyFunction(unsigned int a,unsigned int b) { if (a>0)  return MyFunction(a-1,b*a); else return b; }   unsigned int MyFunctionaddress() { return (unsigned int)(&MyFunction); } */ MyFunction := MCode(""2,x86:i0wkBItEJAiFyXQKjWQkAA+vwUl1+sM=,x64:hcl0Bw+v0f/JdfmLwsM="") MyFunctionaddress := MCode(""2,x86:uAAAAADD,x64:SI0FAAAAAMM="") Msgbox % ""The expected Address of the function is :"" DllCall(MyFunctionaddress) Msgbox % ""The actual address of the function is :"" MyFunction   So you cant call functions in a normal way. So what do we do now The answer is function pointers. ... Functionpointers are documented here: http://www.cplusplus.com/doc/tutorial/pointers/ Please read through the site mentioned before reading further. To call our function in MCode we have to give it the pointer to our function. Code: [Select all] [Expand] [Download] (Fakultätcaller.mcode)GeSHi © Codebox Plus unsigned int MyFunction(unsigned int a,unsigned int b) { if (a>0)  return MyFunction(a-1,b*a); else return b; }   unsigned int _stdcall MyFunctionCaller(unsigned int a,unsigned int(*MyFunction)(unsigned int,unsigned int) ) { return (*MyFunction)(a,1); } Results in: Code: [Select all] [Download] (Fakultätcaller.ahk)GeSHi © Codebox Plus MyFunction := MCode(""2,x86:i0wkBItEJAiFyXQKjWQkAA+vwUl1+sM=,x64:hcl0Bw+v0f/JdfmLwsM="") MyFunctionCaller := MCode(""2,x86:i0QkBGoBUP9UJBCDxAjCCAA=,x64:SIvCugEAAABI/+A="") When we call the new function we also have to add the Function pointer. Code: [Select all] [Download] (Fakultätcaller2.ahk)GeSHi © Codebox Plus MyFunction := MCode(""2,x86:i0wkBItEJAiFyXQKjWQkAA+vwUl1+sM=,x64:hcl0Bw+v0f/JdfmLwsM="") MyFunctionCaller := MCode(""2,x86:i0QkBGoBUP9UJBCDxAjCCAA=,x64:SIvCugEAAABI/+A="") Msgbox % DllCall(MyFunctionCaller,""uint"", 3,""UPtr"",MyFunction) 6 was expected and if you did everything right it should be the result. There are also other things that wont work in autohotkey: Global&Static Variables Objects(thiscall konvention) Sometimes even calling the own function Preset Floats can cause difficulties cause compiler rather sores them at a specific address than in a code. Also feel free to share any MCode function you've created here. I might need some good examples for further chapters. I am not afraid of many things. But I do fear fear. Top Alibaba Posts: 427 Joined: 29 Sep 2013, 16:15 Location: Germany Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 30 Sep 2013, 12:36 Great idea! I already had some serious problems with it. ""Nothing is quieter than a loaded gun."" - Heinrich Heine Top nnnik Posts: 1409 Joined: 30 Sep 2013, 01:01 Location: Germany Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 01 Oct 2013, 00:11 I think I'll finish it today. I thought I could do it without thinking much, but that isn't the case. I am not afraid of many things. But I do fear fear. Top Alibaba Posts: 427 Joined: 29 Sep 2013, 16:15 Location: Germany Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 01 Oct 2013, 11:17 One does not simply write a tutorial without thinking much. ""Nothing is quieter than a loaded gun."" - Heinrich Heine Top nnnik Posts: 1409 Joined: 30 Sep 2013, 01:01 Location: Germany Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 01 Oct 2013, 13:01 And I'm not simply one I am not afraid of many things. But I do fear fear. Top Alibaba Posts: 427 Joined: 29 Sep 2013, 16:15 Location: Germany Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 01 Oct 2013, 17:41 nnnik wrote:And I'm not simply one Best answer. +1 ""Nothing is quieter than a loaded gun."" - Heinrich Heine Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 01 Oct 2013, 20:14 fix the BBcode!!!! ahhhh BBcode apocalypse! BBcolypse. Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top nnnik Posts: 1409 Joined: 30 Sep 2013, 01:01 Location: Germany Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 02 Oct 2013, 02:10 Yeah I know but somehow im too lazy. ...Done I am not afraid of many things. But I do fear fear. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 02 Oct 2013, 02:24 nnnik wrote:Yeah I know but somehow im too lazy. ...Done same here... lol i feel your pain. Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top nnnik Posts: 1409 Joined: 30 Sep 2013, 01:01 Location: Germany Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 02 Oct 2013, 03:39 Well the current Problem is that Bentschi has shut down his MCode generator. So you'll all have to install Visual C++ Express 2010 and compile your MCode that way. Since I have no copy of the Script Bentschi use it'll take some time until I'm finished with this. I am not afraid of many things. But I do fear fear. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 02 Oct 2013, 10:26 What if I simply compile my source lets say ""hello.c"", And the open it in a hex reader? And take that binary code? Oh wait will it have like stack memory initialization that will not be needed? ""mov ax"" etc. ? Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top nnnik Posts: 1409 Joined: 30 Sep 2013, 01:01 Location: Germany Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 02 Oct 2013, 10:36 Yeah you have a lot of stuff that you don't need. I am not afraid of many things. But I do fear fear. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 02 Oct 2013, 10:39 Ok, thats what I thought, other than that, it should be essentially the same. well I'll search the net, for a ""MCODE"" compiler, If I find one, I'll post it. Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top nnnik Posts: 1409 Joined: 30 Sep 2013, 01:01 Location: Germany Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 02 Oct 2013, 11:22 Bentschi build one from Visual C++ and an AHK file, but the Link to the AHK file is dead. I am not afraid of many things. But I do fear fear. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 02 Oct 2013, 15:44 Craaap...es! .... Yes. I said crapes Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Alibaba Posts: 427 Joined: 29 Sep 2013, 16:15 Location: Germany Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 02 Oct 2013, 19:21 nnnik wrote:Well the current Problem is that Bentschi has shut down his MCode generator. So you'll all have to install Visual C++ Express 2010 and compile your MCode that way. Since I have no copy of the Script Bentschi use it'll take some time until I'm finished with this. Since when it's shut down? That's very unfortunate. ""Nothing is quieter than a loaded gun."" - Heinrich Heine Top nnnik Posts: 1409 Joined: 30 Sep 2013, 01:01 Location: Germany Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 03 Oct 2013, 02:32 The MCode generator works again. I'll be working on the Tutorial now. I am not afraid of many things. But I do fear fear. Top nnnik Posts: 1409 Joined: 30 Sep 2013, 01:01 Location: Germany Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 03 Oct 2013, 02:39 If you have Visual Studio or Express(free) installed you can modify this script: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus /*! Adapted by TheGood http://www.autohotkey.com/forum/viewtopic.php?p=364922 Last updated: August 17th, 2010 Rewrite for AHK 1.1+ Bentschi 2013 */   #SingleInstance, off   installdir := ""C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\"" ;HKCU\HKEY_CURRENT_USER\Software\Microsoft\VCExpress\11.0_Config\Setup\VC ;ProductDir   if (!fileexist(vcvarsall := installdir ""vcvarsall.bat""))   exitapp, -1 opt := {opt:""x"", lang:1, comp:1, enc:1, warn:1} pcount = %0% if (!fileexist(srcfile := AbsolutePath(%pcount%)))   exitapp, -2 fileinfo := SplitPath(srcfile) Loop, % pcount {   p := %A_Index%   if (p=""-minsize"")     opt.opt := 1   else if (p=""-maxspeed"")     opt.opt := 2   else if (p=""-noopt"")     opt.opt := ""d""   else if (p=""-c"")     opt.lang := 1   else if (p=""-cpp"")     opt.lang := 2   else if (p=""-x86"")     opt.comp := 1   else if (p=""-x64"")     opt.comp := 2   else if (p=""-x86x64"")     opt.comp := 3   else if (p=""-hex"")     opt.enc := 1   else if (p=""-base64"")     opt.enc := 2   else if (regexmatch(p, ""^-warn([1-4])$"", m))     opt.warn := m1 }   bat := ""@echo off`r`n"" outfiles := {} for k,v in {1:""x86"", 2:""x86_amd64""} {   if (opt.comp&k)   {     outfiles[v] := fileinfo.dir fileinfo.filename ""_"" v "".cod""     FileDelete, % fileinfo.dir fileinfo.filename ""_"" v "".cod""     bat .= ""echo COMPILER: "" v ""`r`n""     bat .= ""echo OPTIONS: "" ((opt.lang=1) ? ""/TC"" : ""/TP"") "" /c /FAc /Facode.cod /O"" opt.opt "" /W"" opt.warn ""`r`n""     bat .= ""call """""" vcvarsall """""" "" v ""`r`n""     bat .= ""cl "" ((opt.lang=1) ? ""/TC"" : ""/TP"") "" /c /FAc /Facode.cod /O"" opt.opt "" /W"" opt.warn "" """""" srcfile """"""`r`n""     bat .= ""echo ERRORLEVEL: %ERRORLEVEL%`r`n""     bat .= ""echo STRIP BEGIN MOVE`r`n""     bat .= ""move /Y """""" fileinfo.dir ""code.cod"""" """""" fileinfo.dir fileinfo.filename ""_"" v "".cod""""`r`n""     bat .= ""echo STRIP END MOVE`r`n""     bat .= ""echo ---`r`n""   } } SetWorkingDir, % fileinfo.dir batfile := fileinfo.dir fileinfo.filename "".bat"" logfile := fileinfo.dir fileinfo.filename "".log"" FileDelete, % batfile FileAppend, % bat, % batfile FileDelete, % logfile RunWait, % batfile "" >> "" logfile,, Hide FileDelete, % fileinfo.dir ""code.cod"" err := 0 Loop, read, % logfile {   if (regexmatch(A_LoopReadLine, ""ERRORLEVEL: (.*)"", m))     err += m1 } if (err) {   CleanLog()   exitapp, -3 } functions := {} log := """" for k,v in outfiles {   Loop, 10   {     if (!fileexist(v))     {       if (A_Index=10)       {         CleanLog()         exitapp, -4       }       sleep, 200     }     else       break   }   FileRead, code, % v   f := {}   while (RegExMatch(code, ""ms)_?([^\s]+?)\s+PROC\s*(.*?)\s*[^\s]+\s*ENDP(.*)"", m))   {     f.name := regexreplace(m1, ""\?(.*?)@@.*"", ""$1"")     f.code := regexreplace(regexreplace(m2, ""m)^[^\t]*\t([^\t\r\n]+)[^\r\n]*"", ""$1""), ""\s+"")     log .= ""Extract function: "" f.name "" ["" k ""] ["" (strlen(f.code)//2) "" bytes]`r`n""     if (opt.enc!=1)     {       binlength := StringToBinary(4, f.code, bin)       if (opt.enc=2)         f.code := BinaryToString(1, &bin, binlength)     } 		functions[f.name, k] := f.code     code := m3   } } out := """" width := 100 for name,info in functions {   c := name "" := MCode(""""""   d := opt.enc   for comp,code in info   {     if (comp=""x86"")       d .= "",x86:""     else if (comp=""x86_amd64"")       d .= "",x64:""     else       continue     d .= code   }   if (strlen(c)+strlen(d)+2<width)     out .= c d """""")`r`n""   else   {     out .= c ""`r`n(LTrim Join`r`n""     while (strlen(d)>width)     {       out .= substr(d, 1, width) ""`r`n""       d := substr(d, width+1)     }     if (d)       out .= d ""`r`n""     out .= "")"""")`r`n""   } } outfile := fileinfo.dir fileinfo.filename "".mcode"" FileDelete, % outfile FileAppend, % out, % outfile FileAppend, % log, % logfile CleanLog() ExitApp, 0   CleanLog() {   global   FileRead, xlog, % logfile   FileDelete, % logfile   xlog := regexreplace(xlog, ""im)^"" regexreplace(fileinfo.filename ((fileinfo.ext) ? ""."" fileinfo.ext : """"), ""(\\|[.*?+[{|()^$])"", ""\$1"") ""\s*"")   xlog := regexreplace(xlog, ""i)"" regexreplace(srcfile, ""(\\|[.*?+[{|()^$])"", ""\$1""), ""source"")   xlog := regexreplace(xlog, ""s)STRIP BEGIN MOVE.*?STRIP END MOVE[\r\n]+"")   FileAppend, % xlog, % logfile } SplitPath(filename) {   if (regexmatch(filename, ""^(.*\\)?([^.\\]*)\.?([^\\]*)$"", m))     return {filename:m2, dir:AbsolutePath(m1), ext:m3} } AbsolutePath(filename) {   if (!DllCall(""shlwapi\PathIsRelativeW"", ""wstr"", filename))     return filename   s := DllCall(""GetFullPathNameW"", ""wstr"", filename, ""uint"", 0, ""ptr"", 0, ""ptr"", 0)   VarSetCapacity(buf, s*2, 0)   DllCall(""GetFullPathNameW"", ""wstr"", filename, ""uint"", s, ""ptr"", &buf, ""ptr"", 0)   return StrGet(&buf, s, ""utf-16"") } StringToBinary(type, str, byref buf) {   if (!DllCall(""crypt32\CryptStringToBinary"", ""str"", str, ""uint"", 0, ""uint"", type, ""ptr"", 0, ""uint*"", sout, ""ptr"", 0, ""ptr"", 0))     return """"   VarSetCapacity(buf, sout, 0)   if (!DllCall(""crypt32\CryptStringToBinary"", ""str"", str, ""uint"", 0, ""uint"", type, ""ptr"", &buf, ""uint*"", sout, ""ptr"", 0, ""ptr"", 0))     return """"   return sout } BinaryToString(type, ptr, size) {   if (!DllCall(""crypt32\CryptBinaryToStringW"", ""ptr"", ptr, ""uint"", size, ""uint"", type, ""ptr"", 0, ""uint*"", sout))     return   VarSetCapacity(bout, sout<<1, 0)   if (!DllCall(""crypt32\CryptBinaryToStringW"", ""ptr"", ptr, ""uint"", size, ""uint"", type, ""ptr"", &bout, ""uint*"", sout))     return   return regexreplace(StrGet(&bout, sout<<1, ""utf-16""), ""\s+"") } I am not afraid of many things. But I do fear fear. Top nnnik Posts: 1409 Joined: 30 Sep 2013, 01:01 Location: Germany Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 03 Oct 2013, 03:26 I have added another part I think I'll finish it today I am not afraid of many things. But I do fear fear. Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: MCode Tutorial (Compiled Code in AHK) Report this post Quote 03 Oct 2013, 04:08 Cool! hooray! Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 62 posts 1 2 3 4 Next Return to “Tutorials” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Xtra and 6 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"MCode (machine code) tutorial."	"true"
"(Use in) other programming languages"	"link"	"https://autohotkey.com/boards/viewtopic.php?f=6&t=4642"	"Tutorial, C/C++ to MCode Generator forum."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"MCode4GCC -- C/C++ to MCode Generator - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Scripts and Functions Search It is currently 15 Jul 2016, 16:32 All times are UTC-05:00 MCode4GCC -- C/C++ to MCode Generator Post your working scripts, libraries and tools Post Reply Email topic Print view Search Advanced search 11 posts • Page 1 of 1 joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter MCode4GCC -- C/C++ to MCode Generator Report this post Quote 20 Sep 2014, 21:09 MCode4GCC MCode4GCC is an MCode generator using the GCC Compiler. More about MCode here : viewtopic.php?f=7&t=32 Info & downloads here: https://github.com/joedf/MCode4GCC Questions? Don't be shy to post your questions. Just ask away! Credits Special thanks to IsNull, fincs, Laszlo, SKAN, Bentschi and kon Written by joedf (joedf@ahkscript.org) Released under the [MIT License](http://opensource.org/licenses/MIT) Information and Downloads here : https://github.com/joedf/MCode4GCC Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Elduke Re: MCode4GCC -- C/C++ to MCode Generator Report this post Quote 24 Oct 2014, 13:49 dumb question... is visual c++ needed? Top kon Posts: 1252 Joined: 29 Sep 2013, 17:11 Re: MCode4GCC -- C/C++ to MCode Generator Report this post Quote 24 Oct 2014, 14:07 Elduke wrote:dumb question... is visual c++ needed? Nope! GCC is an open source compiler. You just need GCC and an editor of your choosing. Setting Up GCC on this script's GitHub page lists some of the recommended distributions. Top fincs Posts: 484 Joined: 30 Sep 2013, 14:17 GitHub: fincs Location: Seville, Spain Contact: Contact fincs Website Re: MCode4GCC -- C/C++ to MCode Generator Report this post Quote 24 Oct 2014, 15:36 I use TDM-GCC. The 'normal' one just loves to link in dependencies to all sorts of hefty runtime DLLs. fincs Windows 10 x64 Build 10240 / AutoHotkey v1.1.22.02 Get SciTE4AutoHotkey v3.0.06.01 - [My project list] Top Relayer Posts: 72 Joined: 30 Sep 2013, 13:09 Re: MCode4GCC -- C/C++ to MCode Generator Report this post Quote 24 Oct 2014, 15:42 Is there a repository of MCode functions with docs? I'd be interested in previous work since I'm not that proficient at writing my own C code. Relayer Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: MCode4GCC -- C/C++ to MCode Generator Report this post Quote 24 Oct 2014, 20:18 See here https://github.com/joedf/MCode4GCC/blob ... ng-started Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Sam_ Posts: 12 Joined: 20 Mar 2014, 20:24 Re: MCode4GCC -- C/C++ to MCode Generator Report this post Quote 14 Nov 2014, 20:24 I'm not a c++ programmer, but there are a couple MCode functions from the old forum that I need x64 version for, so I decided to give this a try. I think I got everything set up correctly as I successfully got the test TheAnswerToEverything() function to compile to MCode. I added it as a function in my script and it works. Now I try compiling the Bin2Hex and Hex2Bin functions, and I am getting errors like: SOURCEFILE:1:14: error: unknown type name 'UInt8' void Bin2Hex(UInt8 *hex, UInt8 *bin, Int32 len) { // in hex room for 2*len+1 bytes ^ SOURCEFILE:1:26: error: unknown type name 'UInt8' void Bin2Hex(UInt8 *hex, UInt8 *bin, Int32 len) { // in hex room for 2*len+1 bytes ^ SOURCEFILE:1:38: error: unknown type name 'Int32' void Bin2Hex(UInt8 *hex, UInt8 *bin, Int32 len) { // in hex room for 2*len+1 bytes ^ What is happening here? Do I need to adjust the jargon of the data types or something? For convenience, these are the two functions I need MCode for: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus void Bin2Hex(UInt8 *hex, UInt8 *bin, Int32 len) { // in hex room for 2*len+1 bytes    Int32 i; UInt8 c, d;    for (i=0; i<len; ++i) {         c = *(bin++);         d = c >> 4;         *(hex++) = d+48 + (7 & -(d>9));         d = c & 15;         *(hex++) = d+48 + (7 & -(d>9));     }     *hex = 0; }   void Hex2Bin(UInt8 *bin, UInt8 *hex) { // in bin room for ceil(strlen(hex)/2) bytes    UInt8 b, c, d;    for(;;) {       c = *hex++; if (c == 0) break;       b = c >> 6;       *bin = ((c & 15) + b + (b << 3)) << 4;       d = *hex++; if (d == 0) break;       b = d >> 6;       *bin++ |= (d & 15) + b + (b << 3);    } Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: MCode4GCC -- C/C++ to MCode Generator Report this post Quote 15 Nov 2014, 11:01 yes Top joedf Posts: 4451 Joined: 29 Sep 2013, 17:08 Facebook: J0EDF Google: +joedf GitHub: joedf Location: Canada, Quebec Contact: Contact joedf Website Skype Twitter Re: MCode4GCC -- C/C++ to MCode Generator Report this post Quote 15 Nov 2014, 11:28 Yup Windows 10 x64 Home Premium, Intel i5 Gen 1 @ 2.40 GHz, 4GB DDR3 RAM | [About Me] | [ASPDM - StdLib Distribution] [Populate the AHK MiniCity!] | [LibCon - Autohotkey Console Library] | [About the AHK Foundation] Top Sam_ Posts: 12 Joined: 20 Mar 2014, 20:24 Re: MCode4GCC -- C/C++ to MCode Generator Report this post Quote 18 Nov 2014, 04:37 Thank you both! I have now gotten both functions to compile nicely, and everything works great in the ANSI build of AHK_L, less so in the Unicode builds. Here is my original test script: Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus GenerateMCodeFunctions() data:="""" HexRead(A_ScriptFullPath,data,4,0) 	MsgBox ""%data%"" HexWrite(A_ScriptDir ""\!HexWrite.bin"",data,4,0) 	MsgBox ""%data%"" ExitApp     GenerateMCodeFunctions(){ 	Global 	_Bin2Hex:=MCode(""2,x86:VVdWU4tEJByLbCQUi1QkGIXAflGLfCQciekB1410JgCDwgEPtkL/icPA6wSA+wmJ3g+Xw4PgD/fbg8ECg+MHjVweMIhZ/jwJicMPl8D32IPgBzn6jUQDMIhB/3XDi0QkHI1sRQDGRQAAW15fXcOQkA==,x64:U0iD7EAPKTQkDyl8JBBEDylEJCBEDylMJDBFhcAPjpwBAABJY8BMjQxBTDnKQQ+TwUgB0Eg5wQ+TwEEIwQ+EnQEAAEGD+A8PhpMBAABFicFmD+/JQcHpBGYPbz0AAAAARYnKMcBFMdtmD281EAAAAEHB4gRmD28tIAAAAGYPbyUwAAAAZkQPbwVAAAAA8w9vFAJBg8MBZg9v2mYPYNlmD2/DZg9v2mZBD9vQZg9x0ARmRA9vyGYPaNlmD3HTBGZED2jLZg9gw2YPb9hmQQ9gwWZBD2jZZkQPb8hmD2DDZkQPaMtmQQ9gwWZED2/JZg9v2GYP2MZmD3TBZg/832YP38VmRA/4yGZBD2/BZkQPb8lmD9vEZg/82GYPb8JmD/zXZg/YxmYPdMFmD9/FZkQP+MhmQQ9vwWYP28RmD/zQZg9vw2YPaNpmD2DC8w9/XEEQ8w9/BEFIg8AQRTnLD4Ir////RYnTTo0MWUkB00U50HRFSYPDAUEPtkP/icPA6wSA+wkPl8KD4A9Jg8EC99qD4geNVBMwQYhR/jwJicIPl8BBg8IB99iD4AdFOdCNRAIwQYhB/3+7QY1Y/0iNTFkCxgEADyg0JA8ofCQQRA8oRCQgRA8oTCQwSIPEQFvDDx8AQY1Y/0mJyYnYTI1cAgFmkEiDwgFED7ZS/0SJ0MDoBDwJQQ+XwEGD4g9Jg8ECQffYQYPgB0KNRAAwQYhB/kGA+gkPl8D32IPgB0w52kGNRAIwQYhB/3W564GQkJCQkJCQMDAwMDAwMDAwMDAwMDAwMAkJCQkJCQkJCQkJCQkJCQkBAQEBAQEBAQEBAQEBAQEBBwcHBwcHBwcHBwcHBwcHBw8PDw8PDw8PDw8PDw8PDw8="") 	_Hex2Bin:=MCode(""2,x86:V1ZTi0wkFIt8JBAPthmE23RaidiD4w/A6AYBw40Ew8HgBIgHjVkCD7ZJAYTJdR/rO4nIg+EPwOgGg8MCAcGNBMHB4ASIBw+2S/+EyXQeicqD4Q/A6gaDxwGJ1gHxjQzxCcGIT/8PtguEyXXFW15fww==,x64:RA+2AkWEwHRtRYnBQYPgD0HA6QZDjQQBTI1CAkKNBMjB4ASIAQ+2UgGE0nUn60mQQYnRg+IPSYPAAkHA6QZCjQQKQo0EyMHgBIgBQQ+2UP+E0nQiQYnRg+IPSIPBAUHA6QZEAcpCjRTKCcKIUf9BD7YQhNJ1uvPD88OQkJCQkJA="") }   HexRead(file,ByRef data,n=0,offset=0){ 	close:="""", bin:="""" 	If !IsObject(file){ 		close:=1 		file:=FileOpen(file,""r-d"") 		} 	file.Seek(offset) 	If (n=0) 		n:=file.Length	; If n=0 then all bytes will be read!!! 	NumRead:=file.RawRead(bin,n) 	Bin2Hex(data,&bin,NumRead) 	If (close=1) 		file.Close() 	Return NumRead }   HexWrite(file,ByRef data,n=0,offset=0){ 	close:="""", bin:="""" 	Hex2Bin(bin,data) 	If !IsObject(file){ 		close:=1 		file:=FileOpen(file,""w-d"") 		} 	file.Seek(offset) 	NumWritten:=file.RawWrite(bin,n)	; If n=0 then no bytes will be written!!! 	If (close=1) 		file.Close() 	Return NumWritten }   Bin2Hex(ByRef hex,addr,len){ 	VarSetCapacity(hex,(2*len+1)) 	Global _Bin2Hex 	DllCall(_Bin2Hex,""UInt"",&hex,""UInt"",addr,""UInt"",len,""CDECL"") 	Return VarSetCapacity(hex,-1)//2 }   Hex2Bin(ByRef bin,ByRef hex){ 	VarSetCapacity(bin,0) 	VarSetCapacity(bin,(StrLen(hex)+1)//2) 	Global _Hex2Bin 	DllCall(_Hex2Bin,""UInt"",&bin,""UInt"",&hex,""CDECL"") 	Return (StrLen(hex)+1)//2 }   MCode(mcode){ 	Static e:={1:4, 2:1}, c:=(A_PtrSize=8)?""x64"":""x86"" 	s:="""", op:="""" 	If (!RegExMatch(mcode, ""^([0-9]+),("" c "":|.*?,"" c "":)([^,]+)"", m)) 		Return 	If (!DllCall(""crypt32\CryptStringToBinary"", ""str"", m3, ""uint"", 0, ""uint"", e[m1], ""ptr"", 0, ""uint*"", s, ""ptr"", 0, ""ptr"", 0)) 		Return 	p:=DllCall(""GlobalAlloc"", ""uint"", 0, ""ptr"", s, ""ptr"") 	If (c=""x64"") 		DllCall(""VirtualProtect"", ""ptr"", p, ""ptr"", s, ""uint"", 0x40, ""uint*"", op) 	If (DllCall(""crypt32\CryptStringToBinary"", ""str"", m3, ""uint"", 0, ""uint"", e[m1], ""ptr"", p, ""uint*"", s, ""ptr"", 0, ""ptr"", 0)) 		Return p 	DllCall(""GlobalFree"", ""ptr"", p) }   Notice that it works as expected in the ANSI build of AHK_L, but the hex data is not displayed properly in Unicode builds. This can be remedied by: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus Bin2Hex(ByRef hex,addr,len){ 	VarSetCapacity(hex,(2*len+1)*(A_IsUnicode?2:1)) 	Global _Bin2Hex 	DllCall(_Bin2Hex,""UInt"",&hex,""UInt"",addr,""UInt"",len,""CDECL"") 	If (A_IsUnicode=1) 		hex:=StrGet(&hex,len*(A_IsUnicode?2:1),""cp0"") ; Without this, it only works properly in the AHK_L ANSI build 	Return VarSetCapacity(hex,-1)//2 }   But now the hex data is not properly converted back to binary (in Unicode builds of AHK_L) and so is not written back to the file properly. My problem is I can't figure out how to undo the codepage manipulation: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus Hex2Bin(ByRef bin,ByRef hex){ 	VarSetCapacity(bin,0) 	;~ VarSetCapacity(bin,((StrLen(hex)+1)//2)/(A_IsUnicode?2:1)) 	VarSetCapacity(bin,(StrLen(hex)+1)//2) 	If (A_IsUnicode=1){ 		; Some way to undo the Unicode compatability stuff 		} 	Global _Hex2Bin 	DllCall(_Hex2Bin,""UInt"",&bin,""UInt"",&hex,""CDECL"") 	Return (StrLen(hex)+1)//2 } I apologize if this is straying too far off topic, but if anyone can help me out, I'd really appreciate it! Top nnnik Posts: 1409 Joined: 30 Sep 2013, 01:01 Location: Germany Re: MCode4GCC -- C/C++ to MCode Generator Report this post Quote 21 Nov 2014, 02:43 TDM-GCC wrote:>>>>> USAGE NOTES *** 32-bit or 64-bit compilation *** In this edition of TDM-GCC, you can use ""-m32"" and ""-m64"" to control whether 32-bit or 64-bit binaries are generated. By default (if neither -m32 nor -m64 is specified), 64-bit binaries will be generated. In a 64-bit binary, all pointer math is 64-bit by default, and the built-in ""size_t"" and ""ptrdiff_t"" types are 64 bits in size (some other types are larger also). Additionally, the following preprocessor definitions will be in effect: * #define _WIN64 1 (also WIN64, __WIN64, and __WIN64__) * #define __MINGW64__ 1 * #define __x86_64 1 (also __x86_64__) * #define __amd64 1 (also __amd64__) Be sure to use ""-m32"" or ""-m64"" at both the compile stage and the link stage. Just saying I am not afraid of many things. But I do fear fear. Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 11 posts • Page 1 of 1 Return to “Scripts and Functions” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: No registered users and 13 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"Tutorial, C/C++ to MCode Generator forum."	"true"
"(Use in) other programming languages"	"Embed Perl"	"http://thomaslauer.com/comp/Calling_Perl_from_AHK_or_AU3"	"Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"thomasl.comp: Calling Perl from AHK or AU3   Sections Start Books Travel Computer Idle Lua Related Stuff Calling Perl Free Software Miscellanea Map Index Music DIY Contact Translate & Share What's this? Version française Deutsche Version         Path: Computer > Calling Perl > Calling Perl from AHK or AU3 Calling Perl from AHK or AU3 If you want to embed live Perl code into your AutoIt3 or AutoHotkey scripts, then this page is for you. I have stitched together an interface library that allows calling Perl from both these script languages. If you already have Perl 5.8.x installed on your machine, you can simply download and unzip the file for the language you use: the zip file for AutoIt3 or the zip file for AutoHotkey. For the examples to work, the embedding DLL (PERLEMBED.DLL) must be either in the AutoIt3 (or AutoHotkey) installation directory or somewhere in the path. My embedding DLL expects the Perl interpreter DLL (PERL58.DLL) to be somewhere in the path. Those poor souls who have no Perl installed (how on earth did you survive all these years? No, just kiddin') will additionally need to download a further ZIP file with the Perl DLL (which contains the stand-alone Perl interpreter core). Perl58dll.zip won't give you a full installation of Perl, though: you certainly get the basic Perl functionality, but none of the many additional modules (that means, among other things, no dynamic loading of stuff). Having said that, the core is in itself a pretty powerful beast: check a good book on Perl. Here are the contents of the readme file:  The following files are in the package: PERLEMBED.C       source code for the interface DLL, straightforward C PERLEMBED.DEF     list of functions exported by PERLEMBED.DLL PERLEMBED.DLL     the DLL itself PERL.AU3/AHK      an include file (for AutoIt3 and AutoHotkey, respectively)                   with the wrapper functions CALLPERL.AU3/AHK  a simple example script (for AutoIt3 and AutoHotkey,                   respectively) README            that which people never read:-) Details about installing the DLLs, calling the functions etc. can be found in PERLEMBED.C and the example scripts. Und tschuess.  Comments please to thomas.lauer@gmail.com or via the contacts page. $updated from: Calling Perl from AHK or AU3.htxt Sat 18 Jan 2014 13:14:24 thomasl (By Thomas Lauer)$"	"null"	"null"	"Forum thread:."	"true"
"(Use in) other programming languages"	"link"	"https://autohotkey.com/board/topic/11249-embedding-perl/"	"Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Embedding Perl - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. Embedding Perl Started by thomasl , Sep 04 2006 09:57 AM Page 1 of 2 1 2 Next Please log in to reply 15 replies to this topic thomasl Members 92 posts Last active: Sep 28 2006 09:55 AM Joined: 16 Jun 2005 I have posted an updated version of my Perl interface library. Three main changes: * supports AHK (as before) and now also AutoIT3 * has direct functions for initialising Perl variables * supports the current 5.8.8.817 Perl buildSee http://thomaslauer.c...mp/Calling_Perl NB: I had to re-register for autohotkey.net, though the files themselves were intact. Strange. #1 - Posted 04 September 2006 - 09:57 AM Back to top BoBo Guests Last active: Joined: -- That could be a live saver (well, not for a BF2 geek :lol:). I've to say it again: ""Man, I should start learning Perl today, unfortunately i've to go for lunch in a minute..."" :cry::wink::lol: Thx for your effort & for sharing this. Much appreciated. 8) #2 - Posted 04 September 2006 - 11:19 AM Back to top _Chris_ Guests Last active: Joined: -- [Moderator's note: moved back from the splitted thread to here] Thomas, thanks for the updated package. I read through the contents and was impressed at the professionalism, such as good interface scripts it includes and their internal comments. I've updated your old topic Calling Perl from AHK to link to this new topic. #3 - Posted 12 September 2006 - 08:20 PM Back to top _thomasl_ Guests Last active: Joined: -- [Moderator's note: moved back from the splitted thread to here] And yet another version I added some error checking, both in the C code and the AHK stuff, and split off the interface code (ie the wrapper functions) into a separate include file. Give it a whirl. URL is as ever: http://thomaslauer.c...mp/Calling_Perl #4 - Posted 12 September 2006 - 08:21 PM Back to top OlifromGermany Guests Last active: Joined: -- I'm interested in the script, could you please fix yout web presence? #5 - Posted 22 December 2006 - 06:31 PM Back to top urlwolf Members 150 posts Last active: Feb 26 2012 07:56 PM Joined: 16 Mar 2006 I'm interested in the script, could you please fix yout web presence? Me too. I cannot get any content from that url. Thanks! #6 - Posted 22 December 2006 - 09:02 PM Back to top automaticman Members 658 posts Last active: Nov 20 2012 06:10 PM Joined: 27 Oct 2006 What does this mean, e.g. if I convert an .ahk script to an .exe file, using your Perl extension, does another user have to have perl on their machines installed? Or would it work there also without having Perl installed? #7 - Posted 14 January 2007 - 07:15 AM Back to top PhiLho Moderators 6850 posts Last active: Jan 02 2012 10:09 PM Joined: 27 Dec 2005 From what I understand, that's a Perl interface, ie. probably a mean to communicate with or use Perl scripts. That mean that even if the AHK script is compiled, Perl has to be installed to be used. A mere 9MB install... ;-) #8 - Posted 14 January 2007 - 08:46 AM vPhiLho := RegExReplace(""Philippe Lhoste"", ""^(\w{3})\w*\s+\b(\w{3})\w*$"", ""$1$2"") Back to top jonny Members 2951 posts Last active: Feb 24 2008 04:22 AM Joined: 13 Nov 2004 A mere 9MB install... It seems like when such questions are asked, they are more concerned with distribution of the scripts they make. It seems we attract a lot of entrepeneurs. Personally, I make scripts for myself, hardcoding nearly everything for my computer, and using what I have installed. #9 - Posted 14 January 2007 - 10:36 AM Back to top automaticman Members 658 posts Last active: Nov 20 2012 06:10 PM Joined: 27 Oct 2006 No, I'm not an entrepreneur (yet). But then I don't understand the ""great thing"" of this tool. If I install normal perl (as e.g. in my case already) then I can simply start it with RUN.... in .ahk, so who needs such an extra tool? #10 - Posted 14 January 2007 - 12:10 PM Back to top Dewi Morgan Members 191 posts Last active: Jun 07 2015 04:02 AM Joined: 03 Oct 2005 Looks like this allows perl to be called from ahk. Is there a way to do this the other way? To access AHK's cool GUI and hookage functionality, from within another scripting language? #11 - Posted 05 June 2007 - 06:04 PM Yet another hotkeyer. Back to top Helpy Guests Last active: Joined: -- I see two ways: use the 'system' (can recall exact name, might be 'os.execute') call to run AutoHotkey.exe; or bite the bullet and hack the source to extract the functionnality in a DLL... A quite frequently asked request... #12 - Posted 06 June 2007 - 09:27 AM Back to top luvan Members 25 posts Last active: Feb 11 2011 09:22 PM Joined: 17 Mar 2007 I can not find Perl58dll.zip The link is broken #13 - Posted 13 December 2009 - 01:26 PM Back to top haichen Members 200 posts Last active: Oct 20 2013 01:14 PM Joined: 05 Feb 2007 Looking around at the site i found Thomas Lauers download folder. http://thomaslauer.com/download/ There you can find perlahk.zip #14 - Posted 13 December 2009 - 01:58 PM Back to top tinypig Members 16 posts Last active: Aug 29 2014 12:36 AM Joined: 12 Mar 2005 Please also see my solution which requires no additional libraries: http://www.autohotke.../topic2869.html #15 - Posted 04 June 2010 - 01:49 AM Back to top Page 1 of 2 1 2 Next Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"Forum thread:."	"true"
"(Use in) other programming languages"	"PAHK"	"https://code.google.com/archive/p/pahk"	"Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Google Code Archive - Long-term storage for Google Code Project Hosting. Code Archive Skip to content Search Google About Google Privacy Terms"	"null"	"null"	"Forum thread:."	"true"
"(Use in) other programming languages"	"link"	"https://autohotkey.com/board/topic/89022-pahk-python-package-to-extend-python-with-autohotkey/"	"Forum thread:."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"PAHK - Python package to extend python with autohotkey - Scripts and Functions - AutoHotkey Community Jump to content Sign In Create Account Sky Slate Blueberry Blackcurrant Watermelon Strawberry Orange Banana Apple Emerald Chocolate AutoHotkey Forums Members Search Advanced Search section: This topic Forums Members Help Files FacebookTwitter AutoHotkey Community AutoHotkey Scripts and Functions View New Content Javascript Disabled Detected You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality. PAHK - Python package to extend python with autohotkey Started by dberube4 , Jan 11 2013 04:28 AM Please log in to reply 5 replies to this topic dberube4 Members 1 posts Last active: Jan 14 2013 10:32 PM Joined: 11 Jan 2013 http://code.google.com/p/pahk/   PAHK make possible the use of .ahk (autohotkey script) script within python in a fully threaded way. It also let python interact with the script at runtime. You might find it most useful for task involving macro,hotkeys or windows functions (such as getclipboard data). Everything that you need to know his on the project page above. Look at the wiki to get a very complete overview of the methods ==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--== Here's one picture for the insecure: http://i.minus.com/jxOQvygR3F6YO.PNG ==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--== ==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--== How to install a python package: 1: Unpack the version you downloaded in a folder 2: Create a new .bat file in the folder 3:Write this inside it ""C:\PythonXX\python.exe setup.py install"" where PythonXX is you python directory (ex: Python27). 4:Execute the bat 5:Enjoy ==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==   #1 - Posted 11 January 2013 - 04:28 AM Back to top ewerybody Members 70 posts Last active: Jun 18 2015 02:36 PM Joined: 18 Sep 2006 That sounds useful!1 No one else interested?!   I'm currently writing something Autohotkey and Python related... Using Python only for the interface.   What is your usecase dberube4? have more examples? #2 - Posted 25 March 2013 - 06:49 PM Back to top Armagedoom Members 20 posts Last active: May 07 2015 06:54 PM Joined: 25 Dec 2012 Thank you so much for this awesome piece of work!!!   I found it and one minute after I was running my ahk scripts from python, its so amazing, I really dont understand how no one else commented or thanked, thanks again!! #3 - Posted 05 December 2013 - 04:54 PM Back to top hunghung Members 2 posts Last active: Mar 05 2014 05:47 PM Joined: 22 Feb 2014 I hate to resurrect older threads, but I'm having trouble turning up information... I am running into an error after following all the above steps to install everything into the Python27 directory.  I confirmed the files wrote to: C:\Python27\Lib\site-packages I'm currently running Python 2.7.6.  Traceback (most recent call last):   File ""C:\Users\blahblah\Desktop\tester.py"", line 7, in <module>     i.execute_script(msg)   File ""C:\Python27\lib\site-packages\pahk.py"", line 66, in execute_script     _execute_script = self.ahk_dll.ahktextdll AttributeError: Interpreter instance has no attribute 'ahk_dll'  The code I'm attempting to run is literally what is linked in the initial post's image.   Did anyone else run into anything like this?   Thanks in advance! #4 - Posted 22 February 2014 - 01:27 AM Back to top Guest10 Members 1216 posts Last active: Oct 30 2015 05:12 PM Joined: 27 Oct 2012 In this regard, I would like to present you with this: http://www.autohotke...ube-downloader/ #5 - Posted 23 February 2014 - 04:54 PM Back to top hunghung Members 2 posts Last active: Mar 05 2014 05:47 PM Joined: 22 Feb 2014 Thank you for the response, I ended up going a different route since I couldn't solve the PAHK implementation specifically.  Much appreciated though! #6 - Posted 05 March 2014 - 05:52 PM Back to top Back to Scripts and Functions Reply to quoted posts     Clear     AutoHotkey Community → AutoHotkey → Scripts and Functions Community Forum Software by IP.Board Licensed to: AutoHotkey Foundation LLC Change Theme IP.Board IP.Board Mobile Ortem English (USA) English (USA) Deutsch Privacy Policy Help Sign In   Use Facebook   Use Twitter Register now! Username or email: I've forgotten my password Forum Password Remember me This is not recommended for shared computers Sign in anonymously Don't add me to the active users list"	"null"	"null"	"Forum thread:."	"true"
"(Use in) other programming languages"	"PYAHK"	"https://bitbucket.org/kitsu/pyahk/downloads"	"Documentation."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"kitsu / pyahk / Downloads — Bitbucket  Bitbucket Features Pricing owner/repository English English 日本語 Sign up Log in pyahk Actions Clone Compare Fork Navigation Overview Source Commits Branches Pull requests Downloads Settings HTTPS HTTPS SSH Need help cloning? Learn how to clone a repository. Clone in SourceTree Atlassian SourceTree is a free Git and Mercurial client for Windows. Atlassian SourceTree is a free Git and Mercurial client for Mac. Ed Blake pyahk Downloads Downloads Tags Branches Name Size Uploaded by Downloads Date Download repository 117.3 KB Tag Commit Date Download tip 53e2b07 Aug. 21, 2015, 1:29 p.m. zip gz bz2 remove 8d90228 Aug. 31, 2012, 12:13 a.m. zip gz bz2 Branch Commit Date Download default 53e2b07 2015-08-21 zip gz bz2 Blog Support Plans & pricing Documentation API Site status Version info Terms of service Privacy policy English Git 2.7.4.1.g5468f9e Mercurial 3.6.3 Django 1.7.11 Python 2.7.3 b7520e3d05e9 / b7520e3d05e9 @ app-106 JIRA Software Confluence Bamboo SourceTree HipChat Atlassian Help Online help Learn Git Keyboard shortcuts Latest features Bitbucket tutorials Site status Support"	"null"	"null"	"Documentation."	"true"
"(Use in) other programming languages"	"link"	"https://pyahk.readthedocs.io/en/latest/"	"Documentation."	"null"	"null"	"null"	"null"	"null"	""	"null"	"null"	"null"	"null"	"PYAHK AutoHotKey via Python — pyahk 0.2.2 documentation pyahk latest Function wrappers Function and Script wrappers Control wrapper pyahk Docs » PYAHK AutoHotKey via Python Edit on Bitbucket PYAHK AutoHotKey via Python¶ Description: Python ctypes wrapper around AutoHotKey dll. License: BSD-style, see LICENSE.txt Author: Ed Blake <kitsu.eb@gmail.com> Date: Dec 30 2014 Revision: 14 Introduction¶ AutoHotKey is a powerful task automator with a terrible scripting language built-in. Python is a powerful scripting language with old, unmaintained, and incomplete automation modules. Combining the two creates a powerful automation tool with a powerful scripting back-end with access to all the power of the Python standard library. This is made possible by the amazing Python ctypes module and the AutoHotKey.dll project. Together they allow exchange of data between both scripting engines, and the execution of AHK commands from Python. Requirements¶ Written for Python2.7, not currently py3k compatible. Written against AutoHotkey_H ANSI 32-bit Version 1.1.8.1 (on WinXP). A copy of the ANSI 32-bit dll must be provided either in the system location of your version of Windows, or in the same folder as the ahk.py file. (The required dll is not provided as part of this distribution, see the AutoHotKey.dll site for download instructions (alternate link AutoHotKey_H).) Installation¶ Get the version from PyPI using pip: pip install pyahk  Or download the latest commit from bitbucket and: `python setup.py install`  Testing¶ A helper script “runtests.py” is provided in the project root to run the entire test suite. Runnable test scripts are provided for each sub-module in the test folder. Tests require Michael Foord’s mock library. Usage¶ First import the ahk module: import ahk  Lower level function wrappers provide more direct access to the underlaying dll: ahk.start() # Ititializes a new script thread ahk.ready() # Waits until status is True ahk.execute('a := WinActive(""Notepad"")') # Sets a to the return value of WinActive print ahk.get('a') # prints the HWND of the found window or 0x0 as a string  Object wrappers are also provided which have a somewhat cleaner interface: script = ahk.Script() # Initializes with start and ready commands as above a = script.winActive(""Notepad"") # Sets a to the return value of the method print a # prints the HWND of the found window as an int, or None script.variable('b', float) # Creates a transparent variable attribute ahk.execute(""Random, b, 0.0, 1.0"") # Stores value in `b` print 100*script.b # b is retrieved and converted to its saved type (float)  See the Docs for further details. ToDo¶ Re-write script.Function to use the now working ahk.call function. Extend setup script with options to download/install the correct dll? Add remaining Control commands to Control class. Add doc-tests? Extend Script class with something to replace ahk.execute (maybe some kind of subroutine wrapper?). Add examples directory. Add optional unicode support. Sections¶ Function wrappers Function and Script wrappers Control wrapper Next © Copyright 2012, Ed Blake. Revision 53e2b0727aad+. Built with Sphinx using a theme provided by Read the Docs. Read the Docs v: latest Versions latest Downloads pdf htmlzip epub On Read the Docs Project Home Builds Free document hosting provided by Read the Docs. Served by Bottle"	"null"	"null"	"Documentation."	"true"
"Classes"	"Classes in AHK, Basic tutorial"	"https://autohotkey.com/boards/viewtopic.php?f=7&t=6033"	"AutoHotkey classes basic tutorial."	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"null"	"Classes in AHK, Basic tutorial. - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Tutorials Search It is currently 15 Jul 2016, 16:33 All times are UTC-05:00 Classes in AHK, Basic tutorial. Helpful script writing tricks and HowTo's Post Reply Email topic Print view Search Advanced search 10 posts • Page 1 of 1 samardac Posts: 207 Joined: 30 Nov 2014, 13:36 Classes in AHK, Basic tutorial. Report this post Quote 20 Jan 2015, 12:24 Hello everybody, I spend a couple of days trying to understand how Classes in AHK works. Thanks to a forum community I manage to get basic representation of it. Unfortunately in Help file Classes described in very complicated way without examples. So I decided to make basic tutorial for beginners. Looks like it is big Tutorial and I could make mistakes so if you find them pleas let me know and I'll fix them. We will discuss, Classes, Instances, Variables, Methods, Nested Classes, Class Inheritance, __New, __Delete. Using Classes in programming is Calling Object Oriented Programming (O.O.P.) hope you here about it. In Classes there are two main definitions: Class Instance So what is class? Imagine that you want to build a Car. To make it you have to have Plan of it. This plane is Class. In AHK it looks like this: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus Class ClassName{ }   So what is Instance? Imagine that you build Car using Plan, and this Car is Instance. So Plan is Class and Car is Instance. In AHK creating Instance from Class looks like this: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus InstanceName:= New ClassName   Every Class has Variables and Methods. So what is Class Variables? Imagine you car has name for example BMW - this is property and it looks like - CarName:=BMW. Also it has 4 wheels it is also property. For example WheelsAmount:=4 So what is Class Method? Imagine when turn the steering wheel the car turns - this is method, and it looks like - TurnSteerWheel(). Also when you use key to open car this is also method for example CarOpenKey(). So imagine you made plane where all that Variables and Methods was defined, now you want to build a car. This is how it looks in AHK: Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus ;First we have to declare class: Class Car{ 	CarName:=""BMW"" 	WheelsAmount:=4 	TurnSteerWheel() 	{ 		Some Commands here... 	} 	CarOpenKey(){ 		Some Commands here... 	} } ; Then create Instane of that class with name BMWConcept BMWConcept:=New Car   This was very basics, so lets make something with Classes in AHK. Lets make simple Class of Window. Window has a lot of properties like Windows Title, Windows ID, Position, Size, e.t.c. these will be Class Variables. Also we can make with window a lot of actions for example Activate it, Get its Title, Get its ID, Get it's position e.t.c. Actions like this will be our Class Methods. So lets make simple Class for Notepad of one Variable and one Method. Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #SingleInstance force   ;Declare Class Class Window{ 	Title:= ""Untitled - Notepad"" ;Variable Title 	Activate() ;Activates window with Title - This.Title 	{ 		IfWinExist, % This.Title 			WinActivate 		else 			MsgBox % ""There is no Window: ""This.Title ""`nPleas Run Notepad!""   	}  	 }   ;Create Instance SomeWin:= New Window Return   !^a:: ;Hotkey to run Instance Method SomeWin.Activate() Return     So now lets make method that will automatically get for us Windows properties and also add some more methods: Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #SingleInstance force   ;Declare Class Class Window{   	Get() 	{ 		WingetTitle TitleVar, A ; Get title from Active window. 		This.Title:=TitleVar ; Set TitleVar to This.Title   		WinGet IDVar,ID,A ; Get ID from Active window. 		This.ID:=IDVar ; Set IDVar to This.ID 	} 	Activate() ;Activates window with Title - This.Title 	{ 		;MsgBox % This.ID 		WinActivate % ""ahk_id ""This.ID ;Use word ""This"" when you reffer to variable of this Class. 		Return This.ID 	}   	AnnounceWinProps() ;Create message box with title and ID 	{ 		MsgBox % ""Title is: "" This.Title ""`n ID is: "" This.ID 	} } ;Create Instance SomeWin:= New Window return   ^!a:: ;Hotkey to run Instance Method   IfWinExist, ahk_class Notepad 	WinActivate ahk_class Notepad else { 	MsgBox % ""There is no Window: Notepad.`nPleas Run Notepad!"" 	exit }   SomeWin.get() SomeWin.AnnounceWinProps() Return   ^!s:: If SomeWin.ID 	SomeWin.Activate() else 	MsgBox Instance SomeWindow has no ID setted, pleas run SomeWin.get() first! return     So what was added? 1. Was added methot - Get(). This method retrieves Window Title and Window ID from Active window. 2. Variable title was removed, because we will use method Get() to get Title. 2. Method Activate was modified and now it use not Window Title but Window ID. 3. Method AnnounceWinProps() was added, that show us Title and ID that was retrieved by Get() 4. Hotkey ^!a was modified now it activates Notepad, than run Get() Method. 5. Hotkey ^!s was added. This hotkey activates Window with Method Activate() if ID is True(was retrieved). Now lets add nested Class to our Class Window with couple of variables. So what is Nested Class? Nested Class is just Class inside another Class and you can access it like this BaseClass.NestedClass To acces variable from Nested class use this: BaseClass.NestedClass.Var or Method - BaseClass.NestedClass.Method(). Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #SingleInstance force   ;Declare Class Class Window{   	Class Tmp{ 		A:=1 		Static B:=1 	}   	Get() 	{ 		WingetTitle TitleVar, A ; Get title from Active window. 		This.Title:=TitleVar ; Set TitleVar to This.Title   		WinGet IDVar,ID,A ; Get ID from Active window. 		This.ID:=IDVar ; Set IDVar to This.ID 	} 	Activate() ;Activates window with Title - This.Title 	{ 		IfWinExist, % ""ahk_id ""This.ID 			WinActivate % ""ahk_id "" This.ID 		else 			MsgBox % ""There is no Window with ID: ""This.ID 	}  	AnnounceWinProps() ;Create message box with title and ID 	{ 		MsgBox % ""Title is: "" This.Title ""`n ID is: "" This.ID 	} } ;Create Instance SomeWin:= New Window return   ^!a:: ;Hotkey to run Instance Method WinActivate ahk_class Notepad SomeWin.get() SomeWin.AnnounceWinProps() Return   ^!s:: If SomeWin.ID 	SomeWin.Activate() else 	MsgBox Instance SomeWindow has no ID setted, pleas run SomeWin.get() first! return   ^!d:: MsgBox % ""SomeWin.Tmp.A = ""SomeWin.Tmp.A ""`nSomeWin.Tmp.B = ""SomeWin.Tmp.B return       Now if you press ""^!d"", you will see message where SomeWin.Tmp.A = Nothing. Why? Lets look how our variables was declared: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus Class Tmp{ 		A:=1 		Static B:=1 	}   As you can see A is declared like simple variable and this kind of variable has name - Instance Variable. Instance variables assigns to instance only when they was created. We do bot create Instance from Window.Tmp, but if we decide to do it it will look like this: SomeWin1:= New Window.Tmp. After we created instance this Variable A will be available here: SomeWin1.A Let's move to variable B, it has word ""Static"" this kind of variables calls - Static Variables. This variables belong to Class itself, so that is why we could access it, and our message showed us that B:=1. Now let's talk about Class Inheritance. So what is it? Imagine you have Class A and it has Var1 and Var2. You created Class B and you want this Class to derive everything from A. Another words you want Class B have the same variables and Methods that has Class A. Let's make it: Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus Class A{ 	Static Var1:=1 	Static Var2:=2 }   Class B extends A{ 	Var3:=3 }   NewClass:= New B MsgBox % ""Var1="" NewClass.Var1 ""`nVar2="" NewClass.Var2 ""`nVar3="" NewClass.Var3 return   As you can see Class B Inherit everything from Class A and add their own Instance Variable Var3. This is calling Class Inheritance. Let's back to our Notepad project. Let's create new Class Notepad and make it inherit everything from Class Window and add to it some new Methods. Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #SingleInstance force   ;Declare Class Class Window{   	Class Tmp{ 		A:=1 		Static B:=1 	}   	Get() 	{ 		WingetTitle TitleVar, A ; Get title from Active window. 		This.Title:=TitleVar ; Set TitleVar to This.Title   		WinGet IDVar,ID,A ; Get ID from Active window. 		This.ID:=IDVar ; Set IDVar to This.ID 	} 	Activate() ;Activates window with Title - This.Title 	{ 		IfWinExist, % ""ahk_id ""This.ID 			WinActivate % ""ahk_id "" This.ID 		else 			MsgBox % ""There is no Window with ID: ""This.ID 	}  	AnnounceWinProps() ;Create message box with title and ID 	{ 		MsgBox % ""Title is: "" This.Title ""`n ID is: "" This.ID 	} }   Class Notepad extends Window{   	Run() 	{ 		IfWinNotExist ahk_class Notepad 			Run Notepad 		Else 			WinActivate 	}	 }   ;Create Instance SomeWin:= New Window SomeNot:= New Notepad return   ^!a:: ;Hotkey to run Instance Method SomeNot.Run() SomeNot.get() SomeNot.AnnounceWinProps() Return   ^!s:: If SomeWin.ID 	SomeWin.Activate() else 	MsgBox Instance SomeWindow has no ID setted, pleas run SomeWin.get() first! return   ^!d:: MsgBox % ""SomeWin.Tmp.A = ""SomeWin.Tmp.A ""`nSomeWin.Tmp.B = ""SomeWin.Tmp.B return     As you can see we add New Class Notepad that extends Window Class and create Instance - SomeNot. Also take a look at Hotkey - ^!a. As you can see Instanse SomeNote use all inherited methods from Class Window. And last... Let's imagine that we want some actions occurs when we create Instance. To initialize that actions we will use: __New, this is how it look like: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus Class A{ 	__New(){ 		Some commands here...	 	} }   So let's back to our Script, this is how it looks now check Notepad Class: Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #SingleInstance force   ;Declare Class Class Window{     	Class Tmp{ 		A:=1 		Static B:=1 	}   	Get() 	{ 		WingetTitle TitleVar, A ; Get title from Active window. 		This.Title:=TitleVar ; Set TitleVar to This.Title   		WinGet IDVar,ID,A ; Get ID from Active window. 		This.ID:=IDVar ; Set IDVar to This.ID 	} 	Activate() ;Activates window with Title - This.Title 	{ 		IfWinExist, % ""ahk_id ""This.ID 			WinActivate % ""ahk_id "" This.ID 		else 			MsgBox % ""There is no Window with ID: ""This.ID 	}  	AnnounceWinProps() ;Create message box with title and ID 	{ 		MsgBox % ""Title is: "" This.Title ""`n ID is: "" This.ID 	} }   Class Notepad extends Window{   	__New() 	{	 		This.Run() 		This.get() 	}   	Run() 	{ 		IfWinNotExist ahk_class Notepad 			Run Notepad 		Else 			WinActivate 	}	   } ;Create Instance SomeWin:= New Window SomeNot:= New Notepad return   ^!a:: ;Hotkey to run Instance Method ;SomeNot.Run() ;SomeNot.get() ;SomeNot.AnnounceWinProps() Return   ^!s:: If SomeNot.ID 	SomeNot.Activate() else 	MsgBox Instance SomeWindow has no ID setted, pleas run SomeWin.get() first! return   ^!d:: MsgBox % ""SomeWin.Tmp.A = ""SomeWin.Tmp.A ""`nSomeWin.Tmp.B = ""SomeWin.Tmp.B return As you can see __New was added in Notepad Class. In this section When we create Instance SomeNot it execute method Run() and Get() now we do not need to run them from hotkey, look at hotkey ^!a::, we do not need those action any more. Also now we can use ^!s to activate Notepad. Also there is __Del like __New it works when Instance deletes but now I'm not sure how it works, I'll back to it later. So lets make final touch, lets create Class Calc that will inherit Class Window also we will add to it method Run() Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus #SingleInstance force   ;Declare Class Class Window{     	Class Tmp{ 		A:=1 		Static B:=1 	}   	Get() 	{ 		WingetTitle TitleVar, A ; Get title from Active window. 		This.Title:=TitleVar ; Set TitleVar to This.Title   		WinGet IDVar,ID,A ; Get ID from Active window. 		This.ID:=IDVar ; Set IDVar to This.ID 	} 	Activate() ;Activates window with Title - This.Title 	{ 		IfWinExist, % ""ahk_id ""This.ID 			WinActivate % ""ahk_id "" This.ID 		else 			MsgBox % ""There is no Window with ID: ""This.ID 	}  	AnnounceWinProps() ;Create message box with title and ID 	{ 		MsgBox % ""Title is: "" This.Title ""`n ID is: "" This.ID 	} }   Class Notepad extends Window{   	__New() 	{	 		This.Run() 		This.get() 	}   	Run() 	{ 		IfWinNotExist ahk_class Notepad 			Run Notepad 		Else 			WinActivate 	}	   }   Class Calc extends Window{   	__New() 	{	 		This.Run() 		This.get() 	}   	Run() 	{ 		IfWinNotExist ahk_class CalcFrame 			Run Calc 		Else 			WinActivate 	}	   } ;Create Instance SomeWin:= New Window SomeNot:= New Notepad SomeCalc:= New Calc return   ^!a:: ;Hotkey to run Instance Method ;SomeNot.Run() ;SomeNot.get() ;SomeNot.AnnounceWinProps() Return   ^!s:: If SomeNot.ID 	SomeNot.Activate() else 	MsgBox Instance SomeWindow has no ID setted, pleas run SomeWin.get() first! return   ^!d:: If SomeCalc.ID 	SomeCalc.Activate() else 	MsgBox Instance SomeWindow has no ID setted, pleas run SomeWin.get() first! return As you can see we add method Run() so now it starts Calculator when we create Instance SomeCalc. So this was basics that I hope will allow you to work with AHK Classes. Top jethrow Posts: 180 Joined: 30 Sep 2013, 19:52 Location: Iowa Re: Classes in AHK, Basic tutorial. Report this post Quote 20 Jan 2015, 14:01 samardac wrote:So what is class? Imagine that you want to build a Car. To make it you have to have Plan of it. This plane is Class. In AHK it looks like this: ... So what is Instance? Imagine that you build Car using Plan, and this Car is Instance. So Plan is Class and Car is Instance. In AHK creating Instance from Class looks like this: ... Every Class has Variables and Methods. It's good to see someone creating some basic tutorials on objects. Honestly, I didn't examine the entire post, but it appears your teaching is targeted at the noobie crowd. I wanted to make sure it is understood that a class is not only a plan (or blueprint) for an Instance, but the class is an object itself. See Keyword Prototype instead of Class for more discussion. Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus class MyClass { 	SayHello() { 		MsgBox Hello 	} }   MyClass.SayHello() Also, in your first code example, ClassName is a valid class that doesn't have any Variables nor Methods. Basic Webpage Controls • Com Object Reference Receive Window Shell Messages • Detect New Child Window Top samardac Posts: 207 Joined: 30 Nov 2014, 13:36 Re: Classes in AHK, Basic tutorial. Report this post Quote 20 Jan 2015, 15:35 jethrow, Yep it's for noobie, I found that in Help File explanation is complicated, but people have to start from something. Class is not only a plan (or blueprint) for an Instance, but the class is an object itself Thanx for thise remark. I preffer that beginers think about Classes as blueprint for better understanding at the begining. When they becom familiar with classes they can follow your link for fother studing. Also, in your first code example, ClassName is a valid class that doesn't have any Variables nor Methods. Yes I just wanted to show how declare Class in AHK. Top empardopo Posts: 326 Joined: 06 Oct 2013, 12:50 Location: Spain Contact: Contact empardopo Website Re: Classes in AHK, Basic tutorial. Report this post Quote 21 Jan 2015, 03:21 Thanks! Everything is possible! Top ahkDustVorteX Posts: 27 Joined: 14 May 2014, 12:08 Re: Classes in AHK, Basic tutorial. Report this post Quote 30 Jan 2015, 14:01 Yep it's for noobie, I found that in Help File explanation is complicated, but people have to start from something. This is the tutorial I needed! Thanks so much samardac! Great job! Very well explained! Editor: Notepad++ ""Those who wait and persist, always achieve."" Top Guest Re: Classes in AHK, Basic tutorial. Report this post Quote 02 May 2015, 05:44 This post has been very helpful... thank you! Top -_+ Posts: 66 Joined: 06 Dec 2014, 12:43 Re: Classes in AHK, Basic tutorial. Report this post Quote 08 Oct 2015, 15:37 Poor English is so poor Top niczoom Posts: 33 Joined: 09 Mar 2016, 22:17 Re: Classes in AHK, Basic tutorial. Report this post Quote 20 Jun 2016, 09:22 Thanks for the time and effort. Now I need to figure out what/where/why I need to use a class for ...!!! [AHK] 1.1.23.05 x32 Unicode [WIN] 10 Pro x64 Version 5111 (Build 10586.218) Top nnnik Posts: 1409 Joined: 30 Sep 2013, 01:01 Location: Germany Re: Classes in AHK, Basic tutorial. Report this post Quote 20 Jun 2016, 14:51 niczoom wrote:Thanks for the time and effort. Now I need to figure out what/where/why I need to use a class for ...!!! A lot of libraries here in the forum are classes you could try one of them and compare it to other types of programming to achieve that I am not afraid of many things. But I do fear fear. Top evilC Posts: 1445 Joined: 27 Feb 2014, 12:30 Re: Classes in AHK, Basic tutorial. Report this post Quote 28 Jun 2016, 07:22 Whilst I agree with Jethrow's comment that a class is not just a blueprint, I also agree with samardac that it would needlessly confuse newbies: Code: [Select all] [Expand] [Download] GeSHi © Codebox Plus msgbox % ""var1: "" MyClass.var1 msgbox % ""var2: "" MyClass.var2 msgbox % ""var3: "" MyClass.var3   Class MyClass {    var1 := ""One""    static var2 := ""Two""      __New(){       this.var3 := ""Three""    } }   For the scope of this tutorial, I think code like the above would only confuse them. GitHub page Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 10 posts • Page 1 of 1 Return to “Tutorials” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Xtra and 5 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"AutoHotkey classes basic tutorial."	"true"
"Classes"	"Classes in AHK, a Dissection (Advanced)"	"https://autohotkey.com/boards/viewtopic.php?f=7&t=6177"	"AutoHotkey classes advanced tutorial."	"null"	"null"	"null"	"null"	"null"	""	"null"	"null"	"null"	"null"	"Classes in AHK, a Dissection (Advanced) - AutoHotkey Community AutoHotkey Community Let's help each other out Skip to content Home Quick links Unanswered posts Active topics Search Forums Members The team IRC Channel Commands Tutorial Download - 1.1.24.00 FAQ Login Register Search Login Register Search Advanced search Home Board index AutoHotkey Tutorials Search It is currently 15 Jul 2016, 16:33 All times are UTC-05:00 Classes in AHK, a Dissection (Advanced) Helpful script writing tricks and HowTo's Post Reply Email topic Print view Search Advanced search 46 posts 1 2 3 Next GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Classes in AHK, a Dissection (Advanced) Report this post Quote 30 Jan 2015, 16:54 This ""tutorial""/explanation requires the knowledge of how objects (aka arrays) work in AutoHotkey. If I got something wrong, please point it out. What is a class? wiktionary wrote:class /klɑːs/ n. A group, collection, category or set sharing characteristics or attributes. In the case of AutHotkey, most commonly an object. In this post, we will be talking about the syntax of making custom object classes that have methods, and how it works. Understanding function references Lets start off with the concept of functions in AutoHotkey. Originally in AutoHotkey, functions were accessible only by using their name. However, Lexikos got his hands on this and added a brand new way of accessing functions. This way, called Function References meant that you can save a (representation of a) function to a variable, and use that variable in place of the function name. To get a function reference, the new (actually pretty old now) MyReference := Func(""MyFunctionName"") syntax must be used. To call a function using a reference, RetVal := MyReference.Call(Params...) or RetVal := %MyReference%(Params...) must be used, though the latter is preferred since it also supports function names in addition to references. Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus MyReference := Func(""MyMsgBox"") %MyReference%(""Hello World!"")   MyMsgBox(MyString) { 	MsgBox, % MyString } A nice ""side-effect"" (see: intentional) of this is that not only can function references be stored in variables, but they can also be stored in objects. Suddenly, you can collect all your related functions into a single object, MyObj := {Key: Func(""MyMsgBox"")} and MyObj.Fish := Func(""GoFishing""). After storing your function references in an object, you can call them using MyObj.Key.Call(""Hello World!"") and MyObj.Fish.Call(). Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus MyObj := {Key: Func(""MyMsgBox"")} MyObj.Fish := Func(""GoFishing"")   Tmp := MyObj.Key, %Tmp%(""Brb, Going fishin'"") ; or MyObj.Key.Call(""Brb, going fishin'"")   MyObj.Fish.Call()   GoFishing() { 	; Lock the screen, we're going fishing 	DllCall(""LockWorkStation"") }   MyMsgBox(MyString) { 	MsgBox, % MyString } There are other ways of calling function references (especially from objects), and one of these is MyObj.Key(Params...) (I removed .Call]). This passes in the object containing the function reference as the first parameter, shifting all the others over. Now your function (if set up with the correct number of parameters) knows in what context it is being called from, allowing it to access other things in the object. If you had the code MyObj := {MyMethod: Func(""MyFunction""), Apples: 5}, MyFunction could take in its first parameter as the variable this and do MsgBox, % ""Johnny has "" this.Apples "" apples"". Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus MyObj := {MyMethod: Func(""MyFunction""), Apples: 5} MyObj.MyMethod(""Johnny"", 123)   MyFunction(this, Param1, Param2) { 	MsgBox, % Param1 "" has "" this.Apples "" apples for "" Param2 "" customers"" } In this code MyObj is what is known in the documentation as a prototype object or base object. Base/Prototype objects are what ""class"" instances are created from. Creating a base object like this can get unwieldy with size, but luckily there is a better way. The following is effectively the equivalent of previous example: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus MyObj.MyMethod(""Johnny"", 123)   class MyObj { 	static Apples := 5   	MyMethod(Param1, Param2) 	{ 		MsgBox, % Param1 "" has "" this.Apples "" apples for "" Param2 "" customers"" 	} } There are a few key differences in the second example that are important to notice. MyObj is automatically created and made into a super-global variable regardless of where in the code it's defined. Also, the first parameter of the method (this) is added behind the scenes so you don't have to define it explicitly for every method. Finally, MyMethod never exists as a separate function MyFunction. Understanding class instances (and the new keyword). An instance of a class is just another object, with its base attribute set to the prototype (base) object. For example, you can create an instance with the code Instance := {base: MyClass} (though this doesn't call the instantiation routines). When the ""base"" attribute is set to something, AutoHotkey knows to pull information from there if it doesn't already exist in the instance. This applies to calling methods and retrieving attribute values, but not to setting attribute values. The keyword new is used to easily create an instance of a class/base object, as well as automatically instantiate it. I'm not completely sure how it works internally, but here's to the best of my knowledge. It starts off by creating a new object as in the previous paragraph. Then it calls the (reserved by AutoHotkey, do not define it yourself) __Init() meta-function on it which handles things like non-static class variables. Once it finishes with that it checks for and calls the user defined __New initiation meta-function. If it exists and there is a return value, that is what is returned by new. If it doesn't exist or there isn't a return value, new returns the new instance. Here is some code demonstrating the __New meta-function: Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus MyInstance := new MyClass(""MyDefault"") MyInstance.MyMethod()   class MyClass { 	__New(Default) 	{ 		InputBox, OutputVar,, Enter a value for your new attribute,,,,,,,, %Default% 		this.Attribute := OutputVar 	}   	MyMethod() 	{ 		MsgBox, % this.Attribute 	} } Understanding inheritance When AutoHotkey goes to find a attribute in your object, it first does the meta-function object.base.__Get check, then it moves on to ""Does attribute exist in the object?"". If it does, it uses it. If not it checks ""Does it exist in the object's base?"". If it does, it uses it. If not, it checks the base's base, and then the base's base's base, and so on until there are no more base objects. When AutoHotkey goes to set a attribute in your object, it just creates the attribute in the original object. Consider closely what the following code will do: Code: [Select all] [Expand] [Download] (Script.ahk)GeSHi © Codebox Plus x := new y MsgBox, % x.Attribute y.Attribute := 3 MsgBox, % x.Attribute x.Attribute -= 1 y.Attribute := 7 MsgBox, % x.Attribute   class Y { 	static Attribute := 5 } On line one, it creates an instance of y (think x := {base: y}). On line two, it tries to get x.Attribute. Seeing that x doesn't have a Attribute, and that x.base does, it returns x.base.Attribute (5) instead. On line three, it changes y.Attribute to 3. x still doesn't have a Attribute, and y is still the base of x, so on line 4 it sees when it sees that x doesn't have a Attribute it returns x.base.Attribute (aka y.Attribute, with the value of 3) instead. On line 5 it pulls the value of x.Attribute, but sees that it doesn't have a Attribute and instead uses x.base.Attribute, then it subtracts 1 from that and gives x a Attribute of 2. Since x now has a Attribute, any further changes to y.Attribute are not inherited, and the value 2 will be shown on line 7. How meta-functions work Two sections ago I explained the use of the new keyword, and by extension the __New meta-function. A meta-function is a class method that doesn't get explicitly called, but gets called when something happens to the object. Meta-functions are called from the base object not the instance. If you create an object {__Call: Func(""MyCallA""), base: {__Call: Func(""MyCallB"")}}, MyCallB would be used as the meta-function. Note that inheritance applies to meta-functions, so when object.base.Meta doesn't exist (or returns nothing), it checks for object.base.base.Meta, then object.base.base.base.Meta and so on. There are several meta-functions, and they're listed below along with the context in which they are called: __New(Params...) - This gets called as MyObject.base.__Delete.(MyObject, ""Banana"", ""Sandwich"") when an an instance is created using new BaseObject(""Banana"", ""Sandwich""). __Delete() - This gets called as MyObject.base.__Delete.(MyObject) when the instance gets deleted, such as at the end of the script/function or when you do this to the last reference: MyInstance := AnythingElse __Get(Key) - This gets called as MyObject.base.__Get.(MyObject, ""Pizza"") when something does Var := MyObject.Pizza or Var := MyObject[""Pizza""] __Set(Key, Value) - This gets called as MyObject.base.__Set.(MyObject, ""Pizza"", ""Cheez"") when something does MyObject.Pizza := ""Cheez"" or MyObject[""Pizza""] := ""Cheez"" __Call(Name, Params...) - This gets called as MyObject.base.__Set.(MyObject, ""DoSomething"", ""P1"", ""P2"", ""P3"") when something does MyObject.DoSomething(""P1"", ""P2"", ""P3""). Note that you can pass an arbitrary number of parameters to it. You can handle this using Variadic Functions, but that is outside the scope of this explanation. __Init() - This is reserved by AutoHotkey and should never be defined. --- More coming --- See post source bbcode and revisions here: Spoiler Last edited by GeekDude on 09 Aug 2015, 22:02, edited 13 times in total. AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Classes in AHK, a dissection Report this post Quote 30 Jan 2015, 16:54 Reserved AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: Classes in AHK, a dissection Report this post Quote 31 Jan 2015, 17:30 GeekDude wrote: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus MyObj := {MyMethod: Func(""MyFunction""), Property: 5} MyObj.MyMethod(""MonkeyTacos"", 123)   MyFunction(this, Param1, Param2) { 	MsgBox, % this.Property "", "" Param1 "", "" Param2 } Congratulations, this qualifies as a class with a single method! Now, this might feel like a bit of a strange way to make a class. Afaik, that is not a ""class"" in AHK terms. Its an object. In AHK, a ""class"" is simply an object that is defined with the class syntax sugar, which allows a more common/popular way of working with objects. GeekDude wrote:Thankfully, there's a prettier way! This is equivalent to the above code block: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus MyObj.MyMethod(""MonkeyTacos"", 123)   class MyObj { 	static Property := 5   	MyMethod(Param1, Param2) 	{ 		MsgBox, % this.Property "", "" Param1 "", "" Param2 	} } As you can see in your usage above, the ""class"" MyObj is already an ""object"". In most other languages (class-based OOP), you cannot use a class until you instantiate it (usually with a new keyword). In AHK (a prototype-based OOP), you can use a class without needing to instantiate it, because using the class keyword is actually creating an object, which can then be be used as a prototype or base for other objects. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Classes in AHK, a dissection Report this post Quote 31 Jan 2015, 17:39 The documentation refers to it as a prototype/base object, and says: The documentation wrote:For convenience and familiarity, the ""class"" keyword can be used to construct a base object AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: Classes in AHK, a dissection Report this post Quote 31 Jan 2015, 18:15 Indeed, thats exactly what I said. I was just pointing out that the reverse (which you stated) is not true: an object is not necessary a class in AHK Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Classes in AHK, a dissection Report this post Quote 31 Jan 2015, 18:23 ""class"" is a convention, not an actual thing (at least, behind the scenes). I suppose I should point this out and change my terminology slightly AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: Classes in AHK, a dissection Report this post Quote 31 Jan 2015, 18:36 yes exactly, right here: GeekDude wrote: Code: [Select all] [Download] (Script.ahk)GeSHi © Codebox Plus MyObj := {MyMethod: Func(""MyFunction""), Property: 5} MyObj.MyMethod(""MonkeyTacos"", 123)   MyFunction(this, Param1, Param2) { 	MsgBox, % this.Property "", "" Param1 "", "" Param2 } Congratulations, this qualifies as a class with a single method! Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Classes in AHK, a dissection Report this post Quote 01 Feb 2015, 12:51 Updated, check the changelog on the gist to see what has changed AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: Classes in AHK, a dissection Report this post Quote 01 Feb 2015, 23:35 I hope I'm not being a pain hehe. I think your tutorial is very good and valuable and I just want to help. Perhaps Lexikos should chime in and clarify on this stuff GeekDude wrote:What is a class? In AutoHotkey, a ""class"" is an object containing function references. I don't think that this is true. Afaik in AHK a ""class"" is simply an object that is defined with the class syntax, rather than other syntaxes. It doesn't have to contain any function references. Last edited by guest3456 on 01 Feb 2015, 23:39, edited 1 time in total. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Classes in AHK, a dissection Report this post Quote 01 Feb 2015, 23:39 I can see the argument being made for the __Class property being what makes an object a class, and the argument that containing function references makes an object a class, or even having the __Init (reserved) meta-function making an object a class. However, using the sugar syntax instead of writing your base property from scratch is an argument I find difficult to understand. AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: Classes in AHK, a dissection Report this post Quote 01 Feb 2015, 23:50 GeekDude wrote:I can see the argument being made for the __Class property being what makes an object a class I suppose. But you could manually assign a __Class key yourself. Code: [Select all] [Download] GeSHi © Codebox Plus thing := {} thing.foo := ""bar"" thing.__Class := ""classclass"" thing.test := Func(""thing_test"") thing.test()   thing_test(this) {    MsgBox % this.foo . ""`n"" . this.__Class }   You're saying the thing object above is a ""class"" since it has both a __Class property as well as a function reference? GeekDude wrote:and the argument that containing function references makes an object a class, Where are you getting this idea from? But I guess it explains why you wrote the original thing that I posted about, where your object had a method linked to a function reference, and you called it a ""class"" GeekDude wrote:However, using the sugar syntax instead of writing your base property from scratch is an argument I find difficult to understand. Well the docs pretty much say it: http://ahkscript.org/docs/Objects.htm#Custom_Classes wrote:Classes For convenience and familiarity, the ""class"" keyword can be used to construct a base object. A basic class definition might look like this.. Not to mention the fact that the class syntax was added way after the introduction of objects into AHK_L for the reasons described in the quote above. There were long discussions on autohotkey.com forum about the syntax. But I could be wrong thats why prob best to get Lex's input Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Classes in AHK, a dissection Report this post Quote 02 Feb 2015, 00:01 guest3456 wrote:Where are you getting this idea from? Because that's one of the major differences between traditional object usage and ""class"" usage. guest3456 wrote:Not to mention the fact that the class syntax was added way after the introduction of objects into AHK_L for the reasons described in the quote above. There were long discussions on autohotkey.com forum about the syntax ""Classes"" and function references were added together in the same update. Before ""classes"" I suppose you still could've made an object {__Class: ""name""}, but you couldn't have created an object with function references in it. That's one of the reasons I find the existence of function reference in an object to be a compelling definition, seeing as the class keyword is nothing special (you can do the things it does without actually using it). If the class keyword is what makes a class, then the term ""class"" should (in my mind) only be used when referring to the definition, and base object or prototype object should be used in all other cases. However, that gives the question about what class instances should be called, just normal objects? Objects that are created using the new keyword? Objects that are created using the new keyword from base objects that were created using the class keyword? AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: Classes in AHK, a dissection Report this post Quote 02 Feb 2015, 00:42 GeekDude wrote: guest3456 wrote:Where are you getting this idea from? Because that's one of the major differences between traditional object usage and ""class"" usage. Says who? GeekDude wrote:""Classes"" and function references were added together in the same update. Before ""classes"" I suppose you still could've made an object {__Class: ""name""}, but you couldn't have created an object with function references in it. Are you sure you aren't confused between function references and object methods? If Func references didn't exist, then yes obviously you couldn't add them to an object. The Func object was added later. But even before Func refs were introduced, you could add a method to an object very easily: Code: [Select all] [Download] GeSHi © Codebox Plus thing := {}                 ;// create object thing.foo := ""bar""           ;// define a property thing.test := ""thing_test""   ;// define a method without using Func ref thing.test(thing)              ;// call the method   thing_test(this) {    MsgBox % this.foo }   GeekDude wrote:That's one of the reasons I find the existence of function reference in an object to be a compelling definition, seeing as the class keyword is nothing special (you can do the things it does without actually using it). Indeed the class keyword ISN'T anything special, which is what I've been getting at. GeekDude wrote:If the class keyword is what makes a class, then the term ""class"" should (in my mind) only be used when referring to the definition, and base object or prototype object should be used in all other cases. However, that gives the question about what class instances should be called, just normal objects? Objects that are created using the new keyword? Objects that are created using the new keyword from base objects that were created using the class keyword? This confusion might stem from the difference between class-based OOP and prototype-based OOP. The term 'base object' or 'prototype object' should only be used in we are talking about the relationship between a parent object and a child object, or an object that derives or inherits from another. It would be rare to use these terms, but I guess you could use 'base object' as the object created with the class syntax and all derived objects as those created with new. Afaik, in AHK, there are normal variables, which can be assigned a singular value such as a string or an integer. And then there are objects, which are associative arrays which hold multiple key:value pairs. Thats it. The [] array syntax allows you an easier and more convenient way to create an object with only integer keys. The class syntax allows you an easier way to create an object with properties and methods all defined inside one block. Using the class keyword creates an object that is usable. Using the new keyword you can create another instance of that object. I guess you could also say its another instance of the ""class"" if you want.. Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: Classes in AHK, a dissection Report this post Quote 02 Feb 2015, 04:24 ""Class"" in a programming context is just a concept stemming from the plain old word: class klɑːs noun 1. a set or category of things having some property or attribute in common and differentiated from others by kind, type, or quality. It doesn't matter whether you use the ""syntax sugar"" to define a class of objects. If you define behaviour or structure for a common set of objects, you have a class. guest3456 wrote:In most other languages (class-based OOP), you cannot use a class until you instantiate it (usually with a new keyword).Yes you can. You can use static methods, properties and data. In some languages which retain meta-data about the code after compilation (such as .NET based languages), you can essentially get a reference to a class, and use it to instantiate objects or access static members. guest3456 wrote:yes exactly, right here:Didn't you say that's not a class? Did you change your mind? Well the docs pretty much say it:The docs do not define what a class is, or what can be considered a class and what cannot. Those kinds of considerations, like this discussion, don't have much practical value in my opinion. GeekDude wrote:""Classes"" and function references were added together in the same update.FYI, a ""function reference"" is just a pointer to a Func object. Func objects have existed ever since functions and function-calls were added to AutoHotkey, since AutoHotkey is a scripting language and each element of the language is generally represented by an object (in the C++ sense). They just weren't always accessible to scripts in that way. However, that gives the question about what class instances should be called, just normal objects? All objects are instances of a class. They all have properties and attributes in common. guest3456 wrote:aik, in AHK, there are normal variables, which can be assigned a singular value such as a string or an integer. And then there are objects, which are associative arrays which hold multiple key:value pairs. Thats it. Normal variables can be assigned objects, too, and array elements can be assigned singular values such as a string or integer. I don't see what your purpose is in comparing a variable to an associative array. That all objects have some attributes in common (i.e. they are associative arrays) shows that they are all instances of a broad class; it does not mean that they are not also instances of more specific classes. For objects, there's also File, Func, Enumerator, Property, RegExMatchObject, ComObject, ComEnum and ComArrayEnum. These objects are not associative arrays. Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Classes in AHK, a dissection Report this post Quote 02 Feb 2015, 08:34 guest3456 wrote:Are you sure you aren't confused between function references and object methods? But even before Func refs were introduced, you could add a method to an object very easily: I wasn't aware, and that is a good thing to know. Thanks for telling me! guest3456 wrote:Indeed the class keyword ISN'T anything special, which is what I've been getting at. By saying ""Afaik in AHK a ""class"" is simply an object that is defined with the class syntax"", which would mean that class would have some intrinsic uniqueness? I got the opposite impression of what you meant by what you said. lexikos wrote:It doesn't matter whether you use the ""syntax sugar"" to define a class of objects. If you define behaviour or structure for a common set of objects, you have a class. That's a pretty broad statement, but I like it. lexikos wrote: Well the docs pretty much say it:The docs do not define what a class is, or what can be considered a class and what cannot. Those kinds of considerations, like this discussion, don't have much practical value in my opinion. I'm not saying your point of view is a bad one, but I think it's important to be well informed about what terminology should be used to make sure you're getting your point across correctly. I also think this is especially important when you're writing a guide for other people to learn from and use as reference. lexikos wrote:FYI, a ""function reference"" is just a pointer to a Func object. Func objects have existed ever since functions and function-calls were added to AutoHotkey, since AutoHotkey is a scripting language and each element of the language is generally represented by an object (in the C++ sense). They just weren't always accessible to scripts in that way. Cool, I wasn't sure if functions were stored the same way before you could reference them or not, now I know. Wow, forums pack a lot of information into tiny posts AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: Classes in AHK, a dissection Report this post Quote 02 Feb 2015, 12:37 lexikos wrote: guest3456 wrote:yes exactly, right here:Didn't you say that's not a class? Did you change your mind? No. He said he should change his terminology, I agreed, and said, ""yes change this right here:"" lexikos wrote: Well the docs pretty much say it:The docs do not define what a class is, or what can be considered a class and what cannot. Those kinds of considerations, like this discussion, don't have much practical value in my opinion. I pretty much agree with that, calling something a 'class' or 'object' seems trivial. Just, given the history of AHK and the order in which things were added, it just seemed more appropriate what I was saying before. To call everything an 'object' and then call objects created with the class keyword ""classes"" GeekDude wrote: guest3456 wrote:Indeed the class keyword ISN'T anything special, which is what I've been getting at. By saying ""Afaik in AHK a ""class"" is simply an object that is defined with the class syntax"", which would mean that class would have some intrinsic uniqueness? I got the opposite impression of what you meant by what you said. Yeah this whole thing is only semantics, but I do agree that its important especially when trying to write an explanation for others. The only uniqueness that I meant is that a class is created with the class syntax. Thats just my opinion I suppose Top lexikos Posts: 4170 Joined: 30 Sep 2013, 04:07 GitHub: Lexikos Re: Classes in AHK, a dissection Report this post Quote 02 Feb 2015, 14:04 GeekDude wrote:That's a pretty broad statement, but I like it.""Class"" has a pretty broad meaning, despite what guest3456 thinks. Top bobc119 Posts: 22 Joined: 10 Jan 2014, 17:02 Re: Classes in AHK, a dissection Report this post Quote 02 Feb 2015, 14:09 Thank you GeekDude! This has cleared up a lot of questions I had. I've avoided learning about classes because they are overwhelming, like learning a whole new way to program, and you've made them seem pretty simple. One question I have that you didn't mention about inheritance: Does the same thing apply to methods as you described for properties? If I define a method() in the base class, and then define the same method() in a class that extends the base class, does it always use the new non-base version? Top GeekDude Posts: 690 Joined: 02 Oct 2013, 22:13 Re: Classes in AHK, a dissection Report this post Quote 02 Feb 2015, 14:15 methods and properties follow the same rules, since methods are just properties with function references as the values. As for extending objects, a extends b makes a new object a with b as the base object. Therefore, due to the rules of inheritance, it'd use the ones defined in a before using the ones defined in b. AHKonsole - Class Based Console Library - Tetris! | CodeQuickTester | AppsKeyMenu | MyRC - The AHK IRC Framework | Simple GDI class Top guest3456 Posts: 1043 Joined: 09 Oct 2013, 10:31 Re: Classes in AHK, a dissection Report this post Quote 02 Feb 2015, 15:13 lexikos wrote: GeekDude wrote:That's a pretty broad statement, but I like it.""Class"" has a pretty broad meaning, despite what guest3456 thinks. lol I don't dispute that statement. I think my point was pretty clear. My post that you quoted, which had GeekDude's object with a single method, would you call that object a ""class"", in AHK terms? If you want to use object/class interchangeably thats fine. Is it just semantics? In a way yes. But there are things to be aware of when using the class keyword in AHK which are different than in other class-based OOP languages. You yourself warned about this stuff years back in the thread linked and elsewhere on the other forum, and were initially opposed to the class syntax for that very reason. Anyway I think this has been beaten to death Top Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year Sort by AuthorPost timeSubject AscendingDescending Post Reply Email topic Print view 46 posts 1 2 3 Next Return to “Tutorials” Jump to AutoHotkey Foundation    About This Community    Forum Issues AutoHotkey    Ask For Help       Gaming    Scripts and Functions       Gaming    Tutorials    Wish List    Bug Reports    AutoHotkey v2 Development    Announcements General    Other Utilities & Resources    Other Programming Languages    Offtopic Other languages    Deutsch (German)       Ich brauche Hilfe          Spiele       Skripte und Funktionen       Tutorials       Tooltime       Allgemeines    中文 (Chinese)       请求帮助       脚本函数       教程资料       相关工具       其他    Español (Spanish)       Pedir Ayuda          Automatización de Juegos       Scripts y Funciones       Tutoriales       Otras Utilidades y Recursos       General    Русский (Russian)       Помощь          Скрипты для Игр       Скрипты и библиотеки       Статьи и руководства       Прочие ресурсы и ПО.       Свободное общение    Français (French)       J'ai besoin d'aide       Scripts et Fonctions       Tutoriels       Autres Utilitaires et Ressources       Hors Sujet Who is online Users browsing this forum: Xtra and 5 guests Home Board index All times are UTC-05:00 Delete all board cookies The team Contact us Powered by phpBB® Forum Software © phpBB Limited Style by Arty    "	"null"	"null"	"AutoHotkey classes advanced tutorial."	"true"
"GUI"	"Use HTML and CSS for your GUIs!"	"https://autohotkey.com/boards/viewtopic.php?f=7&t=4588"	"Using HTML and CSS for creating GUIs."	"null"	"null"	"null"	"null"	"null"	""	"null"	"3"	"2"	"3"	"GitHub - cocobelgica/AutoHotkey-CWebView: Shell.Explorer WebBrowser control wrapper class Skip to content Personal Open source Business Explore Sign up Sign in Pricing Blog Support Search GitHub This repository Watch 2 Star 3 Fork 3 cocobelgica/AutoHotkey-CWebView Code Issues 1 Pull requests 1 Pulse Graphs Shell.Explorer WebBrowser control wrapper class 1 commit 1 branch 0 releases Fetching contributors AutoHotkey 100.0% AutoHotkey Clone or download Use SSH Clone with HTTPS Use Git or checkout with SVN using the web URL. Use HTTPS Clone with SSH Use an SSH key and passphrase from account. Open in Desktop Download ZIP Find file Branch: master Switch branches/tags Branches Tags master Nothing to show Nothing to show New pull request Fetching latest commit… Cannot retrieve the latest commit at this time. Permalink Failed to load latest commit information. CWebView.ahk Contact GitHub API Training Shop Blog About © 2016 GitHub, Inc. Terms Privacy Security Status Help Something went wrong with that request. Please try again. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session."	"null"	"https://github.com/cocobelgica/AutoHotkey-CWebView"	"Using HTML and CSS for creating GUIs."	"true"
